import{m as n,e as t}from"./@tresjs.C4A766dl1736129093919.js";import{_ as o,M as e,cr as r,cs as i,ct as u,C as c,a0 as a,cQ as s}from"./three.ES53pcRR1736129093919.js";import{z as f}from"./three-custom-shader-material.LMK2zh-z1736129093919.js";import{T as l}from"./3d-tiles-renderer.o252qzJW1736129093919.js";import{d as p,b as d,a3 as m,o as h,D as g,J as w,u as v}from"./@vue.uQKhJ3x71736129093919.js";import{P as y,U as x,M as _,T as I,a as b}from"./index.DDln0pNB1736129093919.js";import"./mapBoxShow.vue_vue_type_script_setup_true_lang.C7dlrvJx1736129093919.js";import"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.DBHJXufE1736129093919.js";import"./utils.DnVXwVkk1736129093919.js";!function(n,t){const o=C,e=T();for(;;)try{if(176693===parseInt(o(483))/1*(parseInt(o(499))/2)+parseInt(o(505))/3*(parseInt(o(510))/4)+-parseInt(o(497))/5+parseInt(o(521))/6*(parseInt(o(519))/7)+parseInt(o(512))/8+parseInt(o(502))/9+parseInt(o(520))/10*(-parseInt(o(508))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const M=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function C(n,t){const o=T();return(C=function(n,t){return o[n-=481]})(n,t)}!function(){M(this,(function(){const n=C,t=new RegExp("function *\\( *\\)"),o=new RegExp(n(511),"i"),e=B(n(518));t[n(524)](e+"chain")&&o[n(524)](e+"input")?B():e("0")}))()}();const z=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[C(523)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function T(){const n=["getOrientedBounds","10461sfENzV","string","12RhqduX","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","70520WTwHBc","getBoundingSphere","log","position",'{}.constructor("return this")( )',"exception","init","31199eRYVWA","4390ylUCqm","30RScTUw","Vector3","apply","test","action","__proto__","Quaternion","info","1KJwNGa","crossVectors","bind","length","constructor","console","group","while (true) {}","dot","setFromMatrixPosition","clone","toString","normalize","Box3","7030tFnWYN","call","89296YnEIqX","return (function() ","quaternion","2078487zSxkEW","prototype","error","288897nrtPoz","Sphere"];return(T=function(){return n})()}z(void 0,(function(){const n=C;let t;try{t=Function(n(500)+n(516)+");")()}catch(r){t=window}const o=t.console=t[n(488)]||{},e=[n(514),"warn",n(482),n(504),n(517),"table","trace"];for(let i=0;i<e[n(486)];i++){const t=z[n(487)][n(503)][n(485)](z),r=e[i],u=o[r]||t;t[n(526)]=z[n(485)](z),t[n(494)]=u.toString[n(485)](u),o[r]=t}}))();const j=n=>{n.onLoadTileSet=t=>{const r=C,i=new(o[r(496)]),u=new(o[r(506)]),c=new e;let a=null,s=0;n[r(507)](i,c)?(a=(new(o[r(522)]))[r(492)](c),s=a[r(486)]()):n[r(513)](u)&&(a=u.center[r(493)](),s=a[r(486)]());const f=((n,t)=>{const e=C,r=new(o[e(481)]),i=(new(o[e(522)]))[e(484)](n,t);return r.x=i.x,r.y=i.y,r.z=i.z,r.w=1+n[e(493)]()[e(491)](t),r[e(495)](),r})(null==a?void 0:a[r(495)](),new(o[r(522)])(0,1,0));n[r(489)][r(501)].x=f.x,n[r(489)][r(501)].y=f.y,n[r(489)][r(501)].z=f.z,n[r(489)].quaternion.w=f.w,n.group[r(515)].z=-s}};function B(n){function t(n){const o=C;if(typeof n===o(509))return function(n){}.constructor(o(490))[o(523)]("counter");1!==(""+n/n)[o(486)]||n%20==0?function(){return!0}.constructor("debugger")[o(498)](o(525)):function(){return!1}[o(487)]("debugger")[o(523)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(o){}}const S=P;!function(n,t){const o=P,e=W();for(;;)try{if(682816===parseInt(o(426))/1*(-parseInt(o(429))/2)+parseInt(o(454))/3+-parseInt(o(481))/4*(-parseInt(o(469))/5)+parseInt(o(439))/6*(-parseInt(o(461))/7)+-parseInt(o(476))/8*(-parseInt(o(467))/9)+-parseInt(o(427))/10*(-parseInt(o(477))/11)+-parseInt(o(475))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[P(438)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function W(){const n=["9mibUxG","console","541465hBPsap","parent","chain","width","bind","call","14436276ZKiSMX","5324056LIzUpE","121NdbUtn","string","add","init","44bjBIHY","opacity","matrix","topColor","camera","isMesh",'{}.constructor("return this")( )',"trace","scene","receiveShadow","castShadow","computeBoundingSphere","computeBoundingBox","debu","prototype","https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json","warn","515qSEklB","1078940HvVNMI","update","3540iJjaJV","#ffffff","return (function() ","info","MeshPhongMaterial","innerWidth","dispose","input","error","apply","30blrvhO","table","EdgesGeometry","length","gradient","constructor","material","test","setCamera","value","clone","Color","group","bulidingsColor","fromEdgesGeometry","41205pIlmke","#ffff00","innerHeight","boundingBox","counter","#e523ff","toString","363874GoYCTW","function *\\( *\\)","primitive","geometry","stateObject","gger"];return(W=function(){return n})()}!function(){E(this,(function(){const n=P,t=new RegExp(n(462)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=k(n(480));t[n(446)](e+n(471))&&o[n(446)](e+n(436))?k():e("0")}))()}();const Z=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[P(438)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();Z(void 0,(function(){const n=P;let t;try{t=Function(n(431)+n(487)+");")()}catch(r){t=window}const o=t.console=t[n(468)]||{},e=["log",n(425),n(432),n(437),"exception",n(440),n(488)];for(let i=0;i<e[n(442)];i++){const t=Z.constructor[n(423)][n(473)](Z),r=e[i],u=o[r]||t;t.__proto__=Z[n(473)](Z),t[n(460)]=u[n(460)][n(473)](u),o[r]=t}}))();const O=["object"];function P(n,t){const o=W();return(P=function(n,t){return o[n-=419]})(n,t)}const R=p({__name:"tilesBuildings",props:{bulidingsColor:{default:S(459)},topColor:{default:S(455)},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(e){const s=S,p=e,y=d(0),x=new l(s(424));x.errorTarget=2,x.onLoadModel=n=>{const t=s;n[t(489)].traverse((n=>{const e=t;if(n[e(486)]){(n=>{const t=P,{geometry:e}=n;e[t(421)](),e[t(420)]();const{max:r,min:i}=e[t(457)],u=new f({baseMaterial:new(o[t(433)]),vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor; // 顶部颜色\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main() {\n  // 转世界坐标\n  uMax_world = modelMatrix * vec4(uMax, 1.);\n  uMin_world = modelMatrix * vec4(uMin, 1.);\n  vec3 distColor = uColor;\n  float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n  float rate = residue / uCircleTime;\n  float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n  if (uMin_world.y + lightOffset < vPosition.y &&\n      uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n    csm_DiffuseColor = vec4(uLightColor, uOpacity);\n  } else {\n    csm_DiffuseColor = vec4(distColor, uOpacity);\n  }\n\n  // 根据高度计算颜色\n  if (uGradient) {\n    float rateHight =\n        (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y);\n    // vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight * 0.6);\n    float mixNumber = clamp(rateHight * 2.3 - 1.5, 0., 1.);\n    vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, mixNumber);\n\n    csm_DiffuseColor = vec4(outColor, uOpacity);\n  }\n}",silent:!0,uniforms:{uMax:{value:r},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(p[t(452)])},uOpacity:{value:p[t(482)]},uLightColor:{value:new(o[t(450)])(t(430))},uTopColor:{value:new(o[t(450)])(p[t(484)])},uTime:y,uGradient:{value:p[t(443)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:a});n[t(445)][t(435)](),n.material=u})(n),n[e(490)]=!1,n[e(419)]=!1;const t=new(o[e(441)])(n[e(464)][e(449)]());let s=(new r)[e(453)](t),l=new i({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});l.resolution.set(window[e(434)],window[e(456)]);const d=new u(s,l);d.applyMatrix4(n[e(483)][e(449)]()),n[e(470)][e(479)](d)}}))},j(x);const{renderer:_,sizes:I}=n();m((()=>{const n=s;I[n(472)][n(448)]&&(x[n(447)](p[n(485)]),x.setResolutionFromRenderer(p[n(485)],_[n(448)]))}));const{onBeforeLoop:b}=t();return b((({delta:n})=>{const t=s;y.value+=2*n,p.camera&&I[t(472)].value&&(p.camera.updateMatrixWorld(),x[t(428)]())})),(n,t)=>{const o=s;return h(),g("TresGroup",null,[w(o(463),{object:v(x)[o(451)]},null,8,O)])}}});function k(n){function t(n){const o=P;if(typeof n===o(478))return function(n){}[o(444)]("while (true) {}")[o(438)](o(458));1!==(""+n/n).length||n%20==0?function(){return!0}[o(444)](o(422)+o(466))[o(474)]("action"):function(){return!1}[o(444)](o(422)+o(466)).apply(o(465)),t(++n)}try{if(n)return t;t(0)}catch(o){}}const A=D;function D(n,t){const o=N();return(D=function(n,t){return o[n-=396]})(n,t)}!function(n,t){const o=D,e=N();for(;;)try{if(412233===-parseInt(o(454))/1*(-parseInt(o(419))/2)+-parseInt(o(435))/3*(parseInt(o(426))/4)+parseInt(o(449))/5*(parseInt(o(410))/6)+parseInt(o(413))/7+-parseInt(o(397))/8+-parseInt(o(428))/9*(-parseInt(o(401))/10)+-parseInt(o(437))/11*(parseInt(o(459))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[D(424)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function N(){const n=["object","maxZoom","while (true) {}","function *\\( *\\)",'{}.constructor("return this")( )',"5kfjBms","bbox","coordType","position","warn","137782tXLRWD","rotation","primitive","stateObject","value","444wNdTAu","test","counter","far","trace","5006664IWlkwB","gger","error","call","302930KSKfSj","return (function() ","Vector3","__proto__","input","https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}","source","minDistance","target","4119954ulsTHk","tileMapBuildingsMesh","update","5052075EMwgpS","camera","debu","dampingFactor","flatShading","string","8vjYDdF","position0","filter","bind","render","apply","useWorker","332tKTasb","lookAt","198WPEViO","monochrome","set","constructor","provider","mapCenter","Color","13653sJJxIo","exception","359777rfxZfe","prototype","length","chain","enableDamping","console","action"];return(N=function(){return n})()}!function(){F(this,(function(){const n=D,t=new RegExp(n(447)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=L("init");t[n(460)](e+n(440))&&o.test(e+n(405))?L():e("0")}))()}();const q=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[D(424)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();q(void 0,(function(){const n=D,t=function(){const n=D;let t;try{t=Function(n(402)+n(448)+");")()}catch(o){t=window}return t}(),o=t.console=t[n(442)]||{},e=["log",n(453),"info",n(399),n(436),"table",n(396)];for(let r=0;r<e[n(439)];r++){const t=q[n(431)][n(438)][n(422)](q),i=e[r],u=o[i]||t;t[n(404)]=q[n(422)](q),t.toString=u.toString[n(422)](u),o[i]=t}}))();const G=[A(444),A(455)],H=p({__name:A(411),props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(e,{expose:r}){const i=A,u=e,{renderer:c,scene:a}=n(),f=new y;f[i(451)]=x;const l=new _;l[i(407)]=i(406),l.showTileNo=!1,l[i(425)]=!0;const p=new I(f,l);p.showBoundingBox=!1,p.wireframe=!1,p[i(417)]=!1,p[i(421)]={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let d=new(o[i(434)])("#4688b5");p[i(421)][i(429)]={r:d.r,g:d.g,b:d.b};const w=new b;w[i(432)]=p,w[i(450)]=u[i(450)],w[i(445)]=u[i(445)],u[i(414)].up=new(o[i(403)])(0,1,0),u.camera.position.set(u[i(433)][0],u[i(433)][2],2e3-u[i(433)][1]),u.camera[i(427)](new(o[i(403)])(u.camera.position.x,0,u.camera.position.z-3e3)),w[i(414)]=u.camera;let M=null;m((()=>{const n=i;c[n(458)]&&(M=new s(u[n(414)],c.value.domElement),M[n(441)]=!0,M[n(416)]=.05,M[n(408)]=600,M[n(420)].set(u[n(414)][n(452)].x,u[n(414)][n(452)].y,u[n(414)][n(452)].z),M[n(409)][n(430)](u.camera[n(452)].x,0,u[n(414)][n(452)].z-2e3))}));const{onLoop:C}=t();return C((()=>{const n=i;if(c[n(458)]){const t=50*Math.abs(u[n(414)][n(452)].y);u[n(414)][n(462)]=t+5e3,u[n(414)].updateProjectionMatrix(),M&&(M.update(),M[n(409)].y=0),w[n(412)](),c[n(458)][n(423)](a[n(458)],u.camera)}})),r({camera:u[i(414)],map:w}),(n,t)=>{const o=i;return h(),g(o(456),{object:v(w),rotation:[-Math.PI/2,0,0]},null,8,G)}}});function L(n){function t(n){const o=D;if(typeof n===o(418))return function(n){}.constructor(o(446))[o(424)](o(461));1!==(""+n/n)[o(439)]||n%20==0?function(){return!0}[o(431)]("debu"+o(398))[o(400)](o(443)):function(){return!1}[o(431)](o(415)+"gger")[o(424)](o(457)),t(++n)}try{if(n)return t;t(0)}catch(o){}}!function(n,t){for(var o=V,e=Y();;)try{if(890590===-parseInt(o(458))/1*(parseInt(o(470))/2)+-parseInt(o(481))/3+parseInt(o(482))/4+parseInt(o(467))/5*(parseInt(o(463))/6)+-parseInt(o(479))/7*(-parseInt(o(452))/8)+parseInt(o(477))/9*(parseInt(o(460))/10)+parseInt(o(480))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();var X=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();!function(){X(this,(function(){var n=V,t=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=$(n(462));t[n(465)](e+n(459))&&o[n(465)](e+n(453))?$():e("0")}))()}();var J=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[V(457)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function V(n,t){var o=Y();return(V=function(n,t){return o[n-=451]})(n,t)}function Y(){var n=["2630ecjddq","log","init","29784EDxpnw","constructor","test","prototype","1785fNdlJf","exception","table","6FRXZYq","counter","gger","while (true) {}","warn","info","bind","5364IeFkxQ","trace","266WNXTcM","11670846ErUZWw","5225970foKbYx","2262368rXtqGF","call","console","debu","toString",'{}.constructor("return this")( )',"171560XhHrol","input","string","length","error","apply","579268eZElQZ","chain"];return(Y=function(){return n})()}function $(n){function t(n){var o=V;if(typeof n===o(454))return function(n){}.constructor(o(473))[o(457)](o(471));1!==(""+n/n)[o(455)]||n%20==0?function(){return!0}[o(464)](o(485)+"gger")[o(483)]("action"):function(){return!1}[o(464)](o(485)+o(472))[o(457)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(o){}}J(void 0,(function(){for(var n=V,t=function(){var n,t=V;try{n=Function("return (function() "+t(451)+");")()}catch(o){n=window}return n}(),o=t[n(484)]=t[n(484)]||{},e=[n(461),n(474),n(475),n(456),n(468),n(469),n(478)],r=0;r<e.length;r++){var i=J.constructor[n(466)][n(476)](J),u=e[r],c=o[u]||i;i.__proto__=J[n(476)](J),i[n(486)]=c[n(486)].bind(c),o[u]=i}}))();export{R as _,H as a};
