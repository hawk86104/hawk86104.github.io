{"version":3,"file":"explode.7LMUl7o61767105581793.js","sources":["../../src/plugins/operationTool/pages/explode.vue"],"sourcesContent":["<template>\n    <TresCanvas clearColor=\"#201919\" window-size v-bind=\"state\"  @loop=\"onLoop\">\n        <TresPerspectiveCamera :fov=\"60\" :near=\"0.1\" :far=\"2000\" :position=\"[0, 10, -28]\" />\n        <TresAmbientLight :intensity=\"1\" />\n        <OrbitControls />\n        <Suspense>\n            <primitive :object=\"pState?.scene\" v-if=\"pState\"/>\n        </Suspense>\n    </TresCanvas>\n</template>\n\n<script setup lang=\"ts\">\nimport { reactive, onMounted ,watch} from 'vue'\nimport { OrbitControls, useGLTF } from '@tresjs/cientos'\nimport { useLoop  } from '@tresjs/core'\nimport { Pane } from 'tweakpane'\nimport * as TWEEN from '@tweenjs/tween.js'\nimport _ from 'lodash'\nimport * as THREE from 'three'\n\nconst { state: pState } =  useGLTF(`${process.env.NODE_ENV === 'development' ? 'resource.cos' : 'https://opensource.cdn.icegl.cn' }/model/operationTool/湖中小亭/湖中小亭.gltf`)\n\nconst state = reactive({\n    alpha: true,\n    antialias: true,\n \n})\nconst twGroup = new TWEEN.Group()\nconst disintegrate = function () {\n    pState?.value.scene.children.forEach((child, index) => {\n        if (child.isMesh) {\n            const boundingBox = new THREE.Box3().setFromObject(child)\n            const childCenter = new THREE.Vector3()\n            boundingBox.getCenter(childCenter)\n            // let pos = childCenter.multiplyScalar(2);\n            twGroup.add(new TWEEN.Tween(childCenter)\n                .to(new THREE.Vector3(0, 0, 0), 3000)\n                .onUpdate((val) => {\n                    child.position.copy(val)\n                })\n                .start()\n                .onComplete((val) => {}))\n        }\n    })\n}\nconst explode = function () {\n    pState?.value.scene.children.forEach((child, index) => {\n        const origin = _.cloneDeep(child.position)\n        child.userData.explode = {\n            state: false,\n            explode: origin,\n        }\n        if (child.isMesh) {\n            const boundingBox = new THREE.Box3().setFromObject(child)\n            const childCenter = new THREE.Vector3()\n            boundingBox.getCenter(childCenter)\n            const pos = childCenter.multiplyScalar(2)\n            twGroup.add(new TWEEN.Tween(origin)\n                .to(pos, 3000)\n                .onUpdate((val) => {\n                    child.position.copy(val)\n                })\n                .start()\n                .onComplete((val) => {}))\n        }\n    })\n}\nonMounted(() => {\n    const paneControl = new Pane({\n        title: '炸开与还原',\n        expanded: true,\n    })\n    // paneControl.containerElem_.style.top = '54px'\n\n    const f1 = paneControl.addFolder({\n        title: '参数',\n    })\n\n    f1.addButton({\n        title: '炸开',\n        label: '炸开', // optional\n    }).on('click', () => {\n        explode()\n    })\n    f1.addButton({\n        title: '还原',\n        label: '还原', // optional\n    }).on('click', () => {\n        disintegrate()\n    })\n})\nwatch(\n  () => pState.value,\n  (state) => {\n    if (!state?.scene) return\n    state.scene.updateMatrixWorld(true) // 强制更新\n  }\n)\n\nconst onLoop =function() {\n \n    twGroup?.update()\n\n}\n// const { onBeforeRender  } = useLoop()\n\n</script>\n\n<style scoped></style>\n"],"names":["useGLTF","TWEEN.Group","TWEEN.Tween","state","OrbitControls"],"mappings":"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"}