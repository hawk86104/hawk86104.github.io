import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.sWTY8Kgg1726740218347.js";import{b_ as n,o as e,bY as o,c8 as r,_ as i,C as u,cj as s}from"./three.MbBECAu81726740218347.js";import{p as c,U as a}from"./@tresjs.C5O8roW51726740218347.js";import{d as l,a3 as p,r as f,o as d,f as m,g as v,j as h,aj as x,ak as w}from"./@vue.JNsx1iN61726740218347.js";import{P}from"./tweakpane.yHWGBmom1726740218347.js";import"./three-custom-shader-material.hw4Mip3d1726740218347.js";import"./object-hash.rW_XvzOw1726740218347.js";import"./@amap.bfr68PX11726740218347.js";import"./jszip.Axb7QGa61726740218347.js";import"./glsl-tokenizer.37TL9LuE1726740218347.js";import"./glsl-token-string.AVYfh4t_1726740218347.js";import"./glsl-token-functions.cO5bFsqa1726740218347.js";import"./@vueuse.18lbrd2F1726740218347.js";const S=j;!function(t,n){const e=j,o=y();for(;;)try{if(813819===-parseInt(e(348))/1+parseInt(e(371))/2+parseInt(e(336))/3*(parseInt(e(342))/4)+parseInt(e(339))/5+-parseInt(e(354))/6*(parseInt(e(388))/7)+parseInt(e(376))/8+-parseInt(e(359))/9*(-parseInt(e(335))/10))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const g=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[j(351)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){g(this,(function(){const t=j,n=new RegExp(t(337)),e=new RegExp(t(356),"i"),o=I(t(363));n[t(346)](o+"chain")&&e[t(346)](o+t(338))?I():o("0")}))()}();const b=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[j(351)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function y(){const t=["bind","Vector2","gger","debu","uPosition","129700TqOfpP",'{}.constructor("return this")( )',"material","table","call","4173424mUeeyY","uWidth","uColor","console","height","constructor","string","depthTexture","uScalenum","trace","toString","uScaleone","59493BorYae","error","warn","3247780KLNuIe","533934xZquAt","function *\\( *\\)","input","5348980HDMDXV","addPass","action","8ZSmZec","while (true) {}","log","exception","test","width","1290715zxzmhW","depthBuffer","set","apply","buildingsPassA","speed","852SwixJP","readBuffer","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","color","projectionMatrixInverse","36uTnyDL","value","Color","ShaderMaterial","init","length","uniforms"];return(y=function(){return t})()}function j(t,n){const e=y();return(j=function(t,n){return e[t-=335]})(t,n)}b(void 0,(function(){const t=j,n=function(){const t=j;let n;try{n=Function("return (function() "+t(372)+");")()}catch(e){n=window}return n}(),e=n[t(379)]=n[t(379)]||{},o=[t(344),t(390),"info",t(389),t(345),t(374),t(385)];for(let r=0;r<o.length;r++){const n=b[t(381)].prototype[t(366)](b),i=o[r],u=e[i]||n;n.__proto__=b[t(366)](b),n[t(386)]=u.toString[t(366)](u),e[i]=n}}))();const _=l({__name:S(352),props:{color:{default:"#FFF"},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const l=t,{renderer:f,scene:d,camera:m,sizes:v}=c();let h,x=0,w=null,P=null;p((()=>{const t=j;v.width[t(360)]&&(h=v[t(347)][t(360)],x=v[t(380)][t(360)],(()=>{const t=j;w=new n(f.value);const c=new e(h,x);w[t(355)][t(349)]=!0,w.readBuffer[t(383)]=c;const a=new o(d[t(360)],m[t(360)]);w[t(340)](a),P=new r(new(i[t(362)])({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:c},uProjectionInverse:{value:m.value[t(358)]},uMatrixWorld:{value:m[t(360)].matrixWorld},uColor:{value:new u(l[t(357)])},uScalenum:{value:l.uScalenum},uScaleone:{value:l[t(387)]},uWidth:{value:l[t(377)]},uPosition:{value:new(i[t(367)])(l[t(370)].x,l.uPosition.y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),w[t(340)](P);const p=new r(s);w[t(340)](p)})())}));const{onLoop:S}=a();return S((({elapsed:t})=>{const n=j;w&&(w.render(),P[n(365)].time.value+=l[n(353)]/60)})),p((()=>{const t=j;P&&(l[t(357)]&&(P[t(373)][t(365)][t(378)][t(360)]=new(i[t(361)])(l[t(357)])),l[t(384)]&&(P.material[t(365)][t(384)][t(360)]=l[t(384)]),l[t(387)]&&(P[t(373)].uniforms[t(387)][t(360)]=l[t(387)]),l[t(377)]&&(P.material.uniforms[t(377)][t(360)]=l.uWidth),l[t(370)]&&P[t(373)][t(365)][t(370)][t(360)][t(350)](l.uPosition.x,l[t(370)].y))})),(t,n)=>null}});function I(t){function n(t){const e=j;if(typeof t===e(382))return function(t){}[e(381)](e(343))[e(351)]("counter");1!==(""+t/t)[e(364)]||t%20==0?function(){return!0}[e(381)]("debu"+e(368))[e(375)](e(341)):function(){return!1}.constructor(e(369)+e(368)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}const W=C;function D(){const t=["debu","buildingsPassA","后期效果","1868526xSaDaH","action","warn","table","最大范围","test","addBinding","__proto__","trace","150fPGtKt","uScaleone","17202yiDpAZ","return (function() ","uPosition","length","stateObject","47712TLNrAC","圈颜色","init","单条圈间距","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor",'{}.constructor("return this")( )',"prototype","string","1148012NdfKLG","call","console","248mhgnKB","toString","uWidth","input","318705Lhwjso","gger","#00b4fb","log","1653984SrWWbo","apply","while (true) {}","counter","644905mWDdIt","info","speed","error","bind","color"];return(D=function(){return t})()}!function(t,n){const e=C,o=D();for(;;)try{if(220988===parseInt(e(131))/1+parseInt(e(157))/2*(-parseInt(e(159))/3)+parseInt(e(124))/4+parseInt(e(139))/5+parseInt(e(148))/6+-parseInt(e(164))/7*(parseInt(e(127))/8)+-parseInt(e(135))/9)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const z=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[C(136)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){z(this,(function(){const t=C,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(119),"i"),o=M(t(117));n[t(153)](o+"chain")&&e[t(153)](o+t(130))?M():o("0")}))()}();const A=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[C(136)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function C(t,n){const e=D();return(C=function(t,n){return e[t-=117]})(t,n)}A(void 0,(function(){const t=C,n=function(){const t=C;let n;try{n=Function(t(160)+t(121)+");")()}catch(e){n=window}return n}(),e=n[t(126)]=n.console||{},o=[t(134),t(150),t(140),t(142),"exception",t(151),t(156)];for(let r=0;r<o.length;r++){const n=A.constructor[t(122)][t(143)](A),i=o[r],u=e[i]||n;n[t(155)]=A.bind(A),n.toString=u[t(128)][t(143)](u),e[i]=n}}))();const F=l({__name:W(146),setup(n){const e=W,o=f({color:e(133),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new P({title:e(147),expanded:!0});return r[e(154)](o,e(144),{label:e(165)}),r[e(154)](o,"uScalenum",{label:e(152),min:1,max:500,step:10}),r[e(154)](o,e(158),{label:e(118),min:1,max:100,step:1}),r[e(154)](o,e(129),{label:"单条圈宽度",min:0,max:1,step:.01}),r[e(154)](o,e(141),{label:"速度",min:1,max:20,step:1}),r[e(154)](o,e(161),{picker:"inline",label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(d(),m(t,{disableRender:!0,showAxesHelper:!1},{ability:v((()=>[h(_,x(w(o)),null,16)])),_:1}))}});function M(t){function n(t){const e=C;if(typeof t===e(123))return function(t){}[e(120)](e(137))[e(136)](e(138));1!==(""+t/t)[e(162)]||t%20==0?function(){return!0}[e(120)](e(145)+e(132))[e(125)](e(149)):function(){return!1}.constructor("debu"+e(132))[e(136)](e(163)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{F as default};
