import{a6 as t,cb as n,cc as o,cd as e,ce as r,C as i,k as u,bS as s,ab as c,ad as a}from"./three.fnkrvySq1721721076264.js";import{f as l,$ as f,d as p}from"./@tresjs.tWkmYPO61721721076264.js";import{C as d}from"./three-custom-shader-material.UAECXI501721721076264.js";import"./object-hash.n-lQHd521721721076264.js";import"./@amap.b3gYyCW_1721721076264.js";import"./glsl-tokenizer.rVSxTaVo1721721076264.js";import{d as h,b as m,a1 as g,w as y,o as w,D as v,u as b,r as _,a4 as I,e as x,f as C,g as M,J as T,j,aj as A,ak as O,F as S,I as B,G as R,m as F}from"./@vue.Q1VpS3901721721076264.js";function z(t,n){const o=G();return(z=function(t,n){return o[t-=118]})(t,n)}!function(t,n){const o=z,e=G();for(;;)try{if(322046===-parseInt(o(122))/1*(-parseInt(o(156))/2)+-parseInt(o(129))/3+parseInt(o(124))/4*(parseInt(o(152))/5)+-parseInt(o(118))/6+-parseInt(o(139))/7*(parseInt(o(137))/8)+parseInt(o(141))/9*(parseInt(o(148))/10)+parseInt(o(135))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(131)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=z,n=new RegExp(t(144)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=E(t(132));n[t(150)](e+"chain")&&o[t(150)](e+t(146))?E():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(131)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(){const t=["stateObject","1twsTKJ","table","50588veGcal","CITY_UNTRIANGULATED","counter","warn","name","1646487eawhzk","return (function() ","apply","init","info","length","5757576YaTrXx","console","216rswOpb","error","23464XSvzbC","trace","4071087jTRocl",'{}.constructor("return this")( )',"LANDMASS","function *\\( *\\)","log","input","constructor","10GKmLjl","debu","test","prototype","130FgpbgD","call","while (true) {}","ROADS","450134bbwWLb","3409614tMTSpr","toString","bind"];return(G=function(){return t})()}D(void 0,(function(){const t=z;let n;try{n=Function(t(130)+t(142)+");")()}catch(r){n=window}const o=n[t(136)]=n[t(136)]||{},e=[t(145),t(127),t(133),t(138),"exception",t(123),t(140)];for(let i=0;i<e.length;i++){const n=D[t(147)][t(151)].bind(D),r=e[i],u=o[r]||n;n.__proto__=D.bind(D),n[t(119)]=u[t(119)][t(120)](u),o[r]=n}}))();const L=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=z;t[r(128)]===r(125)&&(n=t),t.name===r(143)&&(o=t),t[r(128)]===r(155)&&(e=t)})),{model:t,city:n,land:o,roads:e}};function E(t){function n(t){const o=z;if("string"==typeof t)return function(t){}.constructor(o(154))[o(131)](o(126));1!==(""+t/t)[o(134)]||t%20==0?function(){return!0}.constructor(o(149)+"gger")[o(153)]("action"):function(){return!1}[o(147)](o(149)+"gger").apply(o(121)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const H=Z;!function(t,n){const o=Z,e=W();for(;;)try{if(959905===parseInt(o(435))/1*(parseInt(o(441))/2)+parseInt(o(400))/3*(parseInt(o(437))/4)+parseInt(o(405))/5+-parseInt(o(410))/6*(-parseInt(o(406))/7)+-parseInt(o(392))/8+parseInt(o(396))/9*(parseInt(o(394))/10)+-parseInt(o(430))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(403)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(t,n){const o=W();return(Z=function(t,n){return o[t-=390]})(t,n)}!function(){P(this,(function(){const t=Z,n=new RegExp(t(445)),o=new RegExp(t(391),"i"),e=J(t(421));n[t(440)](e+t(399))&&o[t(440)](e+"input")?J():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(403)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function W(){const t=["apply","action","3267800HHrJig","4571371mYFcpV","computeBoundingSphere","model","#ffff00","6MKasnO","while (true) {}","object","gger","constructor","console","trace","info","toString","renderOrder","side","init","counter","uniforms","material","value","string","__proto__","call","error","34369973yCqLkZ","prototype","buildingsModelCustomShader","__csm","city","613YjBslM","setStyle","132ZZliRu","return (function() ","land","test","3866fUtlcu","dispose","debu","landColor","function *\\( *\\)","primitive","table","color","#ffffff","Color","DoubleSide","bind","#112233",'{}.constructor("return this")( )',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","13698064QvtpGX","length","830luRkmn","#e523ff","154431IJNiOn","warn","bulidingsColor","chain","170997DbMQZK","opacity","gradient"];return(W=function(){return t})()}$(void 0,(function(){const t=Z;let n;try{n=Function(t(438)+t(390)+");")()}catch(r){n=window}const o=n[t(415)]=n.console||{},e=["log",t(397),t(417),t(429),"exception",t(447),t(416)];for(let i=0;i<e[t(393)];i++){const n=$[t(414)][t(431)][t(452)]($),r=e[i],u=o[r]||n;n[t(427)]=$[t(452)]($),n[t(418)]=u.toString[t(452)](u),o[r]=n}}))();const Y=[H(412)],K=h({__name:H(432),props:{model:{},bulidingsColor:{default:H(395)},landColor:{default:H(453)},topColor:{default:H(409)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=H,e=n,r=m(0),i=e[o(408)][o(434)];i[o(419)]=1001;const u=e[o(408)][o(439)];(()=>{const n=o,{geometry:u}=i;u.computeBoundingBox(),u[n(407)]();const{max:s,min:c}=u.boundingBox;if(i.material[n(433)])return;const a=new d({baseMaterial:i.material,vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:c},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(450)])(e[n(398)])},uOpacity:{value:e[n(401)]},uLightColor:{value:new(t[n(450)])(n(449))},uTopColor:{value:new(t[n(450)])(e.topColor)},uTime:r,uGradient:{value:e[n(402)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(451)]});i[n(424)][n(442)](),i.material=a})();const{onLoop:s}=f();s((({delta:t})=>{r.value+=t})),g((()=>{const n=o;e[n(398)]&&i[n(424)].uniforms.uColor[n(425)][n(436)](e[n(398)]),e[n(444)]&&((n,r)=>{const i=o;let s;"cu"===n||n===i(439)&&(s=Array.isArray(u.material)?u[i(424)]:[u[i(424)]],s.forEach((n=>{const o=i;n[r].setStyle(e[o(444)]),n[o(420)]=t[o(451)]})))})(n(439),n(448)),e[n(401)]&&(i[n(424)][n(423)].uOpacity[n(425)]=e.opacity)})),y(e,((t,n)=>{const e=o;i.material[e(423)].uGradient[e(425)]=t[e(402)]}));const c=e.model.model.clone();return(t,n)=>{const e=o;return w(),v(e(446),{object:b(c)},null,8,Y)}}});function J(t){function n(t){const o=Z;if(typeof t===o(426))return function(t){}[o(414)](o(411))[o(403)](o(422));1!==(""+t/t).length||t%20==0?function(){return!0}[o(414)]("debu"+o(413))[o(428)](o(404)):function(){return!1}[o(414)](o(443)+"gger")[o(403)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const N=U;!function(t,n){const o=U,e=Q();for(;;)try{if(518414===-parseInt(o(161))/1*(parseInt(o(171))/2)+-parseInt(o(157))/3*(-parseInt(o(151))/4)+parseInt(o(152))/5*(-parseInt(o(136))/6)+parseInt(o(132))/7*(parseInt(o(148))/8)+parseInt(o(168))/9*(-parseInt(o(166))/10)+parseInt(o(145))/11+parseInt(o(144))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[U(182)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){X(this,(function(){const t=U,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=nt(t(137));n[t(165)](e+"chain")&&o[t(165)](e+t(128))?nt():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[U(182)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function U(t,n){const o=Q();return(U=function(t,n){return o[t-=125]})(t,n)}q(void 0,(function(){const t=U;let n;try{n=Function(t(179)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(149)]=n[t(149)]||{},e=[t(163),"warn",t(140),"error",t(164),t(126),t(135)];for(let i=0;i<e[t(150)];i++){const n=q[t(134)][t(127)].bind(q),r=e[i],u=o[r]||n;n[t(188)]=q[t(173)](q),n[t(129)]=u[t(129)].bind(u),o[r]=n}}))();const V=[N(178)];function Q(){const t=["primitive","log","exception","test","2230tAAsYB","material","41031ogBqTi","Wireframe","uColor","2xxEalq","value","bind","innerWidth","string","width","resolution","object","return (function() ","gger","fromEdgesGeometry","apply","action","style","uOpacity","uniforms","opacity","__proto__","set","table","prototype","input","toString","Shader","linewidth","230951vwKzhd"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","constructor","trace","954xAzAem","init","clone","stateObject","info","while (true) {}","geometry","innerHeight","22344972NhXhou","5846940YIMOEW","color","#FFF","112MNFpFt","console","length","158408IuVzyS","22790yxtuID","matrix","debu","builds","call","21FJUEIY","applyMatrix4","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","renderOrder","872944stefOQ"];return(Q=function(){return t})()}const tt=h({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:N(147)},opacity:{default:1},style:{default:N(169)}},setup(t){const s=N,c=t;let a=null,l=null;if(c[s(184)]===s(169)){const t=new n(c[s(155)][s(142)]);let i=(new o)[s(181)](t),u=new e({color:c.color,linewidth:c[s(176)],opacity:c[s(187)],transparent:!0,depthWrite:!0,depthTest:!0});u[s(177)][s(125)](window[s(174)],window[s(143)]),a=new r(i,u),a[s(158)](c.builds[s(153)][s(138)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(c[s(146)])},uOpacity:{value:c[s(187)]}},vertexShader:s(159),fragmentShader:s(133)};const t=new n(c.builds[s(142)]),o=new u(l);a=new LineSegments(t,o),a.applyMatrix4(c[s(155)][s(153)][s(138)]()),a[s(167)][s(131)]=c[s(176)],a[s(160)]=1e3}return g((()=>{const t=s;c[t(184)]===t(130)&&(c[t(146)]&&(l[t(186)][t(170)].value=new i(c[t(146)])),c[t(187)]&&(l[t(186)][t(185)][t(172)]=c[t(187)])),c.style===t(169)&&(c[t(146)]&&(a[t(167)].color=new i(c[t(146)])),c[t(187)]&&(a[t(167)][t(187)]=c[t(187)])),c[t(176)]&&(a.material[t(131)]=c.width)})),(t,n)=>{const o=s;return w(),v(o(162),{object:b(a)},null,8,V)}}});function nt(t){function n(t){const o=U;if(typeof t===o(175))return function(t){}.constructor(o(141))[o(182)]("counter");1!==(""+t/t)[o(150)]||t%20==0?function(){return!0}.constructor(o(154)+o(180))[o(156)](o(183)):function(){return!1}[o(134)]("debu"+o(180))[o(182)](o(139)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=at;!function(t,n){const o=at,e=lt();for(;;)try{if(551285===-parseInt(o(228))/1*(-parseInt(o(225))/2)+-parseInt(o(223))/3*(-parseInt(o(209))/4)+parseInt(o(201))/5*(parseInt(o(215))/6)+parseInt(o(232))/7*(parseInt(o(239))/8)+-parseInt(o(248))/9+-parseInt(o(214))/10+-parseInt(o(219))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(197)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=at,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(204),"i"),e=pt(t(211));n[t(244)](e+t(235))&&o[t(244)](e+t(236))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(197)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=at,n=function(){const t=at;let n;try{n=Function(t(243)+t(206)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(212)]||{},e=[t(208),t(216),t(203),t(200),t(217),t(220),t(198)];for(let r=0;r<e[t(237)];r++){const n=rt[t(207)][t(233)][t(242)](rt),i=e[r],u=o[i]||n;n[t(230)]=rt[t(242)](rt),n.toString=u[t(231)].bind(u),o[i]=n}}))();const it=T(ot(196),{color:"#ffffff"},null,-1),ut=T(ot(218),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),st={key:1,args:[1e3],position:[0,19,0]},ct={key:2,args:[6e3,100],position:[0,19,0]};function at(t,n){const o=lt();return(at=function(t,n){return o[t-=195]})(t,n)}function lt(){const t=["call","TresAmbientLight","apply","trace","TresCanvas","error","5zKtVPM","gger","info","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter",'{}.constructor("return this")( )',"constructor","log","2780584UHyFpK","while (true) {}","init","console","showGridHelper","1625430xKArpj","2592966rxzhBA","warn","exception","TresDirectionalLight","13295304DBxYFy","table","pagesShow","TresGridHelper","3bvXaPx","autoRotate","2rBbCOP","TresPerspectiveCamera","city","132390AJYgef","perspectiveCameraRef","__proto__","toString","7GGJrqt","prototype","#000","chain","input","length","action","8478696MVeMgq","tcRef","debu","bind","return (function() ","test","showBuildings","showAxesHelper","string","3573378MuFxjF"];return(lt=function(){return t})()}const ft=h({__name:ot(221),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:c,toneMapping:a,disableRender:r.disableRender}),u=_({autoRotate:r[n(224)],enableDamping:!0});let l=null;r[n(245)]&&([o,e]=I((()=>L())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,s=x(e(199));return w(),C(s,F({ref_key:e(240),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(226),{ref_key:e(229),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),A(O(u)),null,16),it,ut,r.showBuildings&&b(l)?(w(),v(S,{key:0},[j(K,{model:b(l)},null,8,["model"]),j(tt,{builds:b(l)[e(227)],color:e(234)},null,8,["builds"])],64)):B("",!0),R(t.$slots,"ability"),r[e(246)]?(w(),v("TresAxesHelper",st)):B("",!0),r[e(213)]?(w(),v(e(222),ct)):B("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=at;if(typeof t===o(247))return function(t){}[o(207)](o(210)).apply(o(205));1!==(""+t/t)[o(237)]||t%20==0?function(){return!0}[o(207)](o(241)+o(202))[o(195)](o(238)):function(){return!1}[o(207)](o(241)+"gger")[o(197)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{K as _,tt as a,ft as b,L as l};
