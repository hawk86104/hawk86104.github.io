import{K as t}from"./@tresjs.DqJWjmrH1761100244891.js";import{P as e}from"./tweakpane.CqZAnw7f1761100244891.js";import{z as a,q as s,a6 as o,j as n,$ as i,A as r}from"./three.DvmzhRS91761100244891.js";import"./vanilla.esm.5.5.0.CsbunUBT1761100244891.js";import"./Resource.mX5inOAT1761100244891.js";import{u as l}from"./index.wJolfAi41761100244891.js";import{h as p}from"./heatmap.js-fix.Cffp2fsj1761100244891.js";import{d as u,ac as d,a3 as m,G as c,o as h,ad as v,u as f,r as g,g as y,b as j,e as b,I as x,h as w,ap as _,a9 as C,aa as B,m as M}from"./@vue.CKlgtJke1761100244891.js";import"./postprocessing.CYU4Fj-U1761100244891.js";import"./@vueuse.mZcBai3M1761100244891.js";import"./object-hash.zo7S6bgL1761100244891.js";import"./@amap.fjyZdsU91761100244891.js";import"./jszip.DTlig5CR1761100244891.js";import"./three-stdlib.Bkbtr8od1761100244891.js";import"./useLoader.DWT9Jk041761100244891.js";const z=["object"],T=u({__name:"heatmapClickCom",props:{show2dCanvas:{type:Boolean,default:!0},radius:{default:20}},async setup(t){let e,i;const r=t,{nodes:u}=([e,i]=d(()=>l("https://opensource.cdn.icegl.cn/model/heatmap/test.glb")),e=await e,i(),e);u.mesh_0.position.set(-5088.96,-3.08,39374.7),u.mesh_0.scale.setScalar(.01);let g=null,y=null,j=null;y=new a((j=document.createElement("heatmap-canvas"),j.style.position="absolute",j.style.top="40px",j.style.left="0",document.body.appendChild(j),g=p.create({container:j,width:256,height:256,blur:"0.8",radius:r.radius}),g._renderer.canvas.style.border="1px solid #5384ff",g._renderer.canvas.onclick=function(t){g.addData({x:t.layerX,y:t.layerY,value:1,radius:r.radius}),g.setDataMax(1),y&&(y.needsUpdate=!0)},g)._renderer.canvas);const b=new s({vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\tvUv = uv;\n\t}\n\t",fragmentShader:"\n\tuniform sampler2D heightMap;\n\tuniform float uOpacity;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_FragColor = vec4(texture2D(heightMap, vUv.xy).rgb, uOpacity);\n\t}\n\t",uniforms:{uOpacity:{value:1},heightMap:{type:"t",value:y}},depthWrite:!0,depthTest:!0,transparent:!0,side:o});u.mesh_0.material=b;return(t=>{t.computeBoundingBox();const{max:e,min:a}=t.boundingBox;t.deleteAttribute("uv");const s=e.x-a.x,o=e.z-a.z,i=[];for(let n=0;n<t.attributes.position.count;n++)i.push((t.attributes.position.getX(n)-a.x)/s),i.push((t.attributes.position.getZ(n)-a.z)/o);const r=new Float32Array(i);t.setAttribute("uv",new n(r,2))})(u.mesh_0.geometry),m(()=>{j.style.display=""+(r.show2dCanvas?"block":"none")}),(t,e)=>(h(),c("primitive",{object:v(f(u).mesh_0)},null,8,z))}}),k=u({__name:"heatmapClick",setup(a){const s={clearColor:"#030311",shadows:!0,alpha:!0,outputColorSpace:r,shadowMapType:i,useLegacyLights:!0,antialias:!0},o=g({show2dCanvas:!0,radius:20}),n=new e({title:"参数",expanded:!0});return n.addBinding(o,"show2dCanvas",{label:"显示二维图"}),n.addBinding(o,"radius",{label:"圆圈的大小",min:.1,max:30,step:.1}),n.addButton({title:"点击左侧蓝色画框"}),(e,a)=>{const n=y("TresCanvas");return h(),j(n,M(s,{"window-size":""}),{default:b(()=>[a[0]||(a[0]=x("TresPerspectiveCamera",{position:[21,34,55],fov:60,near:1,far:1e5},null,-1)),w(f(t),{autoRotate:!1,autoRotateSpeed:2}),a[1]||(a[1]=x("TresDirectionalLight",{position:[5,10,7.5],color:"#ffffff",intensity:5},null,-1)),a[2]||(a[2]=x("TresGridHelper",{args:[50,25]},null,-1)),(h(),j(_,null,{default:b(()=>[w(T,C(B(o)),null,16)]),_:1}))]),_:1},16)}}});export{k as default};
