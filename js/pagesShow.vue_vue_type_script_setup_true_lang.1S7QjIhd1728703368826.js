import{_ as t,cc as n,cd as o,ce as e,cf as r,C as i,m as u,bU as c,ak as s,am as a}from"./three.VoknrmS61728703368826.js";import{c as l,U as f,Y as p}from"./@tresjs.JhHPALEY1728703368826.js";import{C as d}from"./three-custom-shader-material.3rBk2L9x1728703368826.js";import"./object-hash.gPx1SZYa1728703368826.js";import"./@amap.LlG4vVLC1728703368826.js";import"./glsl-tokenizer.N1Ao8h3g1728703368826.js";import{d as h,b as m,a3 as y,w as g,o as w,E as v,u as b,r as _,a4 as C,e as I,f as x,g as M,L as O,j as T,aj as S,ak as j,F as A,J as E,H as B,m as R}from"./@vue.JNsx1iN61728703368826.js";function L(t,n){const o=H();return(L=function(t,n){return o[t-=426]})(t,n)}!function(t,n){const o=L,e=H();for(;;)try{if(313297===parseInt(o(436))/1*(parseInt(o(434))/2)+-parseInt(o(435))/3*(parseInt(o(445))/4)+parseInt(o(438))/5*(parseInt(o(447))/6)+-parseInt(o(459))/7*(parseInt(o(426))/8)+-parseInt(o(451))/9+parseInt(o(431))/10+-parseInt(o(448))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(458)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["length","apply","101374OVpATN","while (true) {}","toString","traverse",'{}.constructor("return this")( )',"104PisWKM","log","name","exception","constructor","3785250WEJGEm","table","error","503218jrEpqz","3vdzgVI","2WhYemI","init","4280Vtkoqf","__proto__","chain","string","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","input","action","1214108XiLMYE","CITY_UNTRIANGULATED","3930XfXVEM","6098851EyXTls","test","function *\\( *\\)","746028oySEqP","ROADS","LANDMASS","console","debu","gger"];return(H=function(){return t})()}!function(){k(this,(function(){const t=L,n=new RegExp(t(450)),o=new RegExp(t(442),"i"),e=z(t(437));n[t(449)](e+t(440))&&o[t(449)](e+t(443))?z():e("0")}))()}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(458)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();P(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function("return (function() "+t(463)+");")()}catch(o){n=window}return n}(),o=n[t(454)]=n.console||{},e=[t(427),"warn","info",t(433),t(429),t(432),"trace"];for(let r=0;r<e[t(457)];r++){const n=P[t(430)].prototype.bind(P),i=e[r],u=o[i]||n;n[t(439)]=P.bind(P),n[t(461)]=u[t(461)].bind(u),o[i]=n}}))();const W=async()=>{const t=L,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(462)]((n=>{const i=t;n[i(428)]===i(446)&&(o=n),n[i(428)]===i(453)&&(e=n),n[i(428)]===i(452)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function z(t){function n(t){const o=L;if(typeof t===o(441))return function(t){}[o(430)](o(460))[o(458)]("counter");1!==(""+t/t)[o(457)]||t%20==0?function(){return!0}[o(430)](o(455)+o(456)).call(o(444)):function(){return!1}[o(430)]("debu"+o(456))[o(458)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=F;function F(t,n){const o=$();return(F=function(t,n){return o[t-=223]})(t,n)}!function(t,n){const o=F,e=$();for(;;)try{if(338286===parseInt(o(230))/1*(-parseInt(o(229))/2)+parseInt(o(250))/3*(-parseInt(o(279))/4)+parseInt(o(256))/5+-parseInt(o(255))/6+parseInt(o(283))/7+-parseInt(o(275))/8+parseInt(o(234))/9*(parseInt(o(286))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(237)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=F,n=new RegExp(t(271)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=X("init");n[t(259)](e+t(284))&&o[t(259)](e+t(262))?X():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(237)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(){const t=["landColor","__proto__","error","9UKZBOU","#112233","buildingsModelCustomShader","apply","constructor","stateObject","bulidingsColor","forEach","counter","DoubleSide","opacity","value","toString","city","isArray","gradient","735729LVIFcp",'{}.constructor("return this")( )',"bind","computeBoundingBox","string","3119244RCcHUB","2794030HNxdWU","clone","uGradient","test","action","material","input","while (true) {}","uniforms","dispose","gger","uOpacity","setStyle","color","#ffff00","function *\\( *\\)","uColor","model","renderOrder","3304240aJltdl","topColor","debu","prototype","4PCCDWw","warn","return (function() ","call","1227436ziFPCd","chain","length","13235960bcHJwf","__csm","object","Color","#e523ff","land","console","6PbOxFy","180439ggNbic"];return($=function(){return t})()}G(void 0,(function(){const t=F,n=function(){const t=F;let n;try{n=Function(t(281)+t(251)+");")()}catch(o){n=window}return n}(),o=n[t(228)]=n[t(228)]||{},e=["log",t(280),"info",t(233),"exception","table","trace"];for(let r=0;r<e[t(285)];r++){const n=G[t(238)][t(278)][t(252)](G),i=e[r],u=o[i]||n;n[t(232)]=G[t(252)](G),n[t(246)]=u[t(246)][t(252)](u),o[i]=n}}))();const U=[D(224)],V=h({__name:D(236),props:{model:{},bulidingsColor:{default:D(226)},landColor:{default:D(235)},topColor:{default:D(270)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=D,e=n,r=m(0),i=e[o(273)][o(247)];i[o(274)]=1001;const u=e[o(273)][o(227)];(()=>{const n=o,{geometry:u}=i;u[n(253)](),u.computeBoundingSphere();const{max:c,min:s}=u.boundingBox;if(i[n(261)][n(223)])return;const a=new d({baseMaterial:i[n(261)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(225)])(e[n(240)])},uOpacity:{value:e.opacity},uLightColor:{value:new(t[n(225)])("#ffffff")},uTopColor:{value:new(t[n(225)])(e[n(276)])},uTime:r,uGradient:{value:e[n(249)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(243)]});i[n(261)][n(265)](),i[n(261)]=a})();const{onLoop:c}=f();c((({delta:t})=>{r[o(245)]+=t})),y((()=>{const n=o;e.bulidingsColor&&i[n(261)][n(264)][n(272)][n(245)].setStyle(e.bulidingsColor),e[n(231)]&&((n,r)=>{const i=o;let c;"cu"===n||n===i(227)&&(c=Array[i(248)](u[i(261)])?u.material:[u[i(261)]],c[i(241)]((n=>{const o=i;n[r][o(268)](e[o(231)]),n.side=t[o(243)]})))})(n(227),n(269)),e.opacity&&(i[n(261)][n(264)][n(267)].value=e[n(244)])})),g(e,((t,n)=>{const e=o;i.material[e(264)][e(258)][e(245)]=t[e(249)]}));const s=e.model[o(273)][o(257)]();return(t,n)=>(w(),v("primitive",{object:b(s)},null,8,U))}});function X(t){function n(t){const o=F;if(typeof t===o(254))return function(t){}[o(238)](o(263))[o(237)](o(242));1!==(""+t/t).length||t%20==0?function(){return!0}[o(238)](o(277)+o(266))[o(282)](o(260)):function(){return!1}[o(238)]("debu"+o(266))[o(237)](o(239)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const q=Q;!function(t,n){const o=Q,e=N();for(;;)try{if(281435===-parseInt(o(142))/1+-parseInt(o(114))/2*(-parseInt(o(161))/3)+parseInt(o(133))/4*(parseInt(o(107))/5)+-parseInt(o(135))/6+-parseInt(o(139))/7+-parseInt(o(159))/8+parseInt(o(156))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(143)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){K(this,(function(){const t=Q,n=new RegExp(t(149)),o=new RegExp(t(126),"i"),e=nt(t(132));n[t(137)](e+t(118))&&o.test(e+t(140))?nt():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Y(void 0,(function(){const t=Q;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(146)]=n[t(146)]||{},e=[t(147),t(145),t(131),"error",t(158),t(136),t(124)];for(let i=0;i<e[t(121)];i++){const n=Y.constructor[t(152)][t(113)](Y),r=e[i],u=o[r]||n;n[t(110)]=Y.bind(Y),n[t(154)]=u[t(154)][t(113)](u),o[r]=n}}))();const J=[q(117)];function N(){const t=["style","21qJEWTM","3365XdJrrZ","linewidth","constructor","__proto__","opacity","uColor","bind","72302nDtZkH","resolution","counter","object","chain","innerHeight","call","length","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","width","trace","applyMatrix4","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","innerWidth","Shader","material","clone","info","init","2452BtgkPY","value","1431774KHeVOI","table","test","string","1450981kHGsAY","input","buildingsLines","301903dBeskY","apply","set","warn","console","log"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","function *\\( *\\)","geometry","gger","prototype","color","toString","Wireframe","5133798LjOKZW","matrix","exception","1654224EzcdQf"];return(N=function(){return t})()}function Q(t,n){const o=N();return(Q=function(t,n){return o[t-=107]})(t,n)}const tt=h({__name:q(141),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:q(155)}},setup(t){const c=q,s=t;let a=null,l=null;if("Wireframe"===s[c(160)]){const t=new n(s.builds[c(150)]);let i=(new o).fromEdgesGeometry(t),u=new e({color:s[c(153)],linewidth:s[c(123)],opacity:s[c(111)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(115)][c(144)](window[c(127)],window[c(119)]),a=new r(i,u),a.applyMatrix4(s.builds[c(157)][c(130)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(s[c(153)])},uOpacity:{value:s[c(111)]}},vertexShader:c(122),fragmentShader:c(148)};const t=new n(s.builds[c(150)]),o=new u(l);a=new LineSegments(t,o),a[c(125)](s.builds[c(157)].clone()),a.material.linewidth=s[c(123)],a.renderOrder=1e3}return y((()=>{const t=c;s[t(160)]===t(128)&&(s[t(153)]&&(l.uniforms[t(112)][t(134)]=new i(s[t(153)])),s[t(111)]&&(l.uniforms.uOpacity[t(134)]=s[t(111)])),s[t(160)]===t(155)&&(s.color&&(a[t(129)][t(153)]=new i(s[t(153)])),s[t(111)]&&(a.material[t(111)]=s.opacity)),s.width&&(a[t(129)][t(108)]=s[t(123)])})),(t,n)=>(w(),v("primitive",{object:b(a)},null,8,J))}});function nt(t){function n(t){const o=Q;if(typeof t===o(138))return function(t){}.constructor("while (true) {}").apply(o(116));1!==(""+t/t)[o(121)]||t%20==0?function(){return!0}[o(109)]("debu"+o(151))[o(120)]("action"):function(){return!1}[o(109)]("debu"+o(151))[o(143)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=lt;function et(){const t=["disableRender","chain","action","error","#000000","showGridHelper","city","49aKlMqP","counter","model","constructor","gger","5876590iBDCge","TresPerspectiveCamera","pagesShow","info","warn","#ffffff","29169VVDTBq","call","apply","toString","console","table","TresCanvas","865008AoOnEr","string","TresDirectionalLight","2oLCKPS","autoRotate","function *\\( *\\)","test","perspectiveCameraRef","debu","prototype","1369822ztOALI","56WAdXbj",'{}.constructor("return this")( )',"#000","tcRef","showAxesHelper","length","TresAmbientLight","1166005EOWDiw","return (function() ","stateObject","4SKcnqX","builds","bind","trace","TresAxesHelper","init","showBuildings","5021489tZIHUi","3424581vDhMpE"];return(et=function(){return t})()}!function(t,n){const o=lt,e=et();for(;;)try{if(905609===parseInt(o(311))/1*(-parseInt(o(318))/2)+parseInt(o(337))/3+parseInt(o(329))/4*(parseInt(o(326))/5)+parseInt(o(308))/6*(parseInt(o(345))/7)+parseInt(o(319))/8*(parseInt(o(301))/9)+-parseInt(o(295))/10+parseInt(o(336))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(303)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=lt,n=new RegExp(t(313)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=pt(t(334));n[t(314)](e+t(339))&&o[t(314)](e+"input")?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(303)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=lt;let n;try{n=Function(t(327)+t(320)+");")()}catch(r){n=window}const o=n[t(305)]=n[t(305)]||{},e=["log",t(299),t(298),t(341),"exception",t(306),t(332)];for(let i=0;i<e.length;i++){const n=it.constructor[t(317)][t(331)](it),r=e[i],u=o[r]||n;n.__proto__=it[t(331)](it),n[t(304)]=u.toString[t(331)](u),o[r]=n}}))();const ut=O(ot(325),{color:ot(300)},null,-1),ct=O(ot(310),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(t,n){const o=et();return(lt=function(t,n){return o[t-=294]})(t,n)}const ft=h({__name:ot(297),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(342),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(338)]}),u=_({autoRotate:r[n(312)],enableDamping:!0});let l=null;r[n(335)]&&([o,e]=C((()=>W())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I(e(307));return w(),x(c,R({ref_key:e(322),ref:d},i,{"window-size":""}),{default:M((()=>[O(e(296),{ref_key:e(315),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),T(b(p),S(j(u)),null,16),ut,ct,r[e(335)]&&b(l)?(w(),v(A,{key:0},[T(V,{model:b(l)},null,8,[e(347)]),T(tt,{builds:b(l)[e(344)],color:e(321)},null,8,[e(330)])],64)):E("",!0),B(t.$slots,"ability"),r[e(323)]?(w(),v(e(333),st)):E("",!0),r[e(343)]?(w(),v("TresGridHelper",at)):E("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=lt;if(typeof t===o(309))return function(t){}.constructor("while (true) {}")[o(303)](o(346));1!==(""+t/t)[o(324)]||t%20==0?function(){return!0}[o(348)](o(316)+o(294))[o(302)](o(340)):function(){return!1}[o(348)](o(316)+o(294))[o(303)](o(328)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as _,tt as a,ft as b,W as l};
