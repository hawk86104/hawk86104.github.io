import{importShared as a}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{Fs as I,Kk as k}from"./index.DTe2qqjO1767148983502.js";import{scaleImg as P,pt as D,en as S,controlsEvents as F,showLocation as M,informationDiv as V}from"./informationDiv.AUpsPnLl1767148983502.js";import{useTexture$1 as N}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.B7dQ_CiZ1767148983502.js";import"./index.vue_vue_type_script_setup_true_lang.CjsHShHS1767148983502.js";import{Pane as G}from"./tweakpane.BQRZXf8M1767148983502.js";const{withAsyncContext:L,defineComponent:b}=await a("vue"),{unref:g,createElementVNode:w,openBlock:R,createElementBlock:A}=await a("vue"),H=["position"],W=["scale","material","rotateX","position-y"],_=await a("three"),{watch:O}=await a("vue"),z=b({__name:"cloundSateShow",props:{map:{},height:{default:100},color:{default:"#cccccc"},opacity:{default:.6}},async setup(h){let n,c;const t=h,o=new _.MeshPhongMaterial({displacementMap:new _.Texture,transparent:!0,side:_.DoubleSide,opacity:t.opacity,color:new _.Color(t.color)});o.onBeforeCompile=e=>{e.vertexShader=`uniform sampler2D map;
		`+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","transformed += normalize( objectNormal ) * ( texture2D(map, vMapUv ).a * 0.5 + 0.0 );"),e.fragmentShader=e.fragmentShader.replace("#include <alphamap_fragment>",`
            #include <alphamap_fragment>
            float h = texture2D(map, vMapUv ).a;
            diffuseColor.rgb *= h;
            diffuseColor.a = clamp(diffuseColor.a * 2.0, 0.0, 1.0);
            `)};const i=t.map.geo2map(new _.Vector3(105,34,0));i.applyMatrix4(t.map.matrix);const s=P(t.map,{x:67,y:11},{x:140,y:57},t.height*1e3),d=["https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171300.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171400.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171500.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171600.HDF.png"];let r=0;const l=([n,c]=L(()=>N(d)),n=await n,c(),n);o.map=l[r],O(()=>[t.color,t.opacity],([e,u])=>{o.color.setStyle(e),o.opacity=u});let p=null,m=!1;return(()=>{m?(clearInterval(p),p=null,m=!1):(p=setInterval(()=>{r=r<d.length-1?r+1:0,o.map=l[r],o.needsUpdate=!0,console.log(r)},1e3),m=!0)})(),(e,u)=>(R(),A("TresGroup",{position:[...g(i)]},[w("TresMesh",{scale:[g(s).x,g(s).y,e.height*1e3],material:g(o),rotateX:-Math.PI/2,renderOrder:9999,"position-y":e.height*1e3/5},[...u[0]||(u[0]=[w("TresPlaneGeometry",{args:[1,1,529,420]},null,-1)])],8,W)],8,H))}}),{defineComponent:j}=await a("vue"),{createElementVNode:x,unref:y,mergeProps:U,createVNode:X,Suspense:K,withCtx:q,openBlock:B,createBlock:J,Fragment:Q,createElementBlock:Y}=await a("vue"),Z=["object"],{watch:C,ref:ee,reactive:te}=await a("vue"),E=await a("three"),oe=j({__name:"mapBoxShow2",setup(h){const n=te({height:500,color:"#cccccc",opacity:.6}),c=new G({title:"参数"});c.addBinding(n,"color",{label:"颜色"}),c.addBinding(n,"height",{label:"高度",min:10,max:5e3,step:10}),c.addBinding(n,"opacity",{label:"透明度",min:0,max:1,step:.1});const t=D.create({imgSource:[new S({style:"6"}),new S({style:"8"})],minLevel:2,maxLevel:18,lon0:90});t.rotateX(-Math.PI/2);const o=new E.Vector3(105,34,0),i=new E.Vector3(110,0,1e7),s=t.localToWorld(t.geo2map(o)),d=t.localToWorld(t.geo2map(i)),r=ee(),{camera:l,controls:p,scene:m,renderer:v}=I();return l.value&&l.value.position.copy(d),C(()=>p.value,e=>{e&&(e.target.copy(s),F(e,l.value,m.value))}),C(()=>r.value,e=>{e&&e.target.position.copy(s)}),M(l.value,v.domElement,t),(e,u)=>(B(),Y(Q,null,[x("TresDirectionalLight",{ref_key:"tdLight",ref:r,position:[0,2e3,1e3],intensity:1},null,512),x("primitive",{object:y(t)},null,8,Z),(B(),J(K,null,{default:q(()=>[X(z,U({map:y(t)},n),null,16,["map"])]),_:1}))],64))}}),{defineComponent:ne}=await a("vue"),{createElementVNode:T,unref:ae,normalizeProps:re,guardReactiveProps:ce,createVNode:f,resolveComponent:le,mergeProps:ie,withCtx:se,Fragment:pe,openBlock:me,createElementBlock:ue}=await a("vue"),{reactive:$}=await a("vue"),Se=ne({__name:"cloundSate",setup(h){const n=$({clearColor:"#dbf0ff",alpha:!0,antialias:!1,logarithmicDepthBuffer:!0,precision:"highp"}),c=$({enableDamping:!0,makeDefault:!0,screenSpacePanning:!1,keyPanSpeed:5});return(t,o)=>{const i=le("TresCanvas");return me(),ue(pe,null,[f(i,ie(n,{"window-size":""}),{default:se(()=>[o[0]||(o[0]=T("TresPerspectiveCamera",{position:[0,12,0],fov:70,near:1,far:4e10},null,-1)),f(ae(k),re(ce(c)),null,16),o[1]||(o[1]=T("TresAmbientLight",{intensity:1},null,-1)),f(oe)]),_:1},16),f(V)],64)}}});export{Se as default};
