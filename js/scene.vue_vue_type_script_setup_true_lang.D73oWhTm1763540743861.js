import{z as e}from"./index.Crdf3MNx1763540743861.js";import{B as a}from"./three-custom-shader-material.C6taB_aY1763540743861.js";import{bL as n,be as i,af as t,b1 as r,am as s,ae as l,ek as o}from"./three.rXKzP9fQ1763540743861.js";import{P as m}from"./tweakpane.CqZAnw7f1763540743861.js";import{u as d}from"./colorList.DbCLsRg71763540743861.js";import{d as p,a8 as c,r as u,w as h,H as x,o as w,F as f,J as g,u as b}from"./@vue.Co_gxueH1763540743861.js";const S=["object"],T=["object"],v=["object"],j=["object"],y=p({__name:"scene",async setup(p){let y,A;const D=d(),z=([y,A]=c(()=>e(o,"./plugins/tvtVolumeRendering/rawData/ll.nrrd")),y=await y,A(),y),B=new n(new i(new t(z.xLength,z.yLength,z.zLength)),new r({color:6710886}));B.applyMatrix4(z.matrix);const L=u({x:Math.floor(z.RASDimensions[0]/2),y:Math.floor(z.RASDimensions[1]/2),z:Math.floor(z.RASDimensions[2]/4)}),M=z.extractSlice("x",L.x);M.geometryNeedsUpdate=!0;const R=z.extractSlice("y",L.y);R.geometryNeedsUpdate=!0;const _=z.extractSlice("z",L.z);_.geometryNeedsUpdate=!0,z.windowHigh=1760,z.repaintAllSlices();const F={vertexShader:"\n\t\tvoid main() {\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:"\n        uniform sampler2D eTexture;     //纹理图像\n        void main() {\n            csm_DiffuseColor = texture2D( eTexture, vec2(csm_DiffuseColor.r*1.,0.5));\n        }\n    ",uniforms:{eTexture:{value:D.updateTransferFunction()}},silent:!0,flatShading:!0,side:l,transparent:!0,depthTest:!0,depthWrite:!0,blending:s};M.mesh.material=new a({baseMaterial:M.mesh.material,...F}),R.mesh.material=new a({baseMaterial:R.mesh.material,...F}),_.mesh.material=new a({baseMaterial:_.mesh.material,...F});const H=new m;return H.addBinding(L,"x",{label:"x面",min:0,max:z.RASDimensions[0],step:1}),H.addBinding(L,"y",{label:"y面",min:0,max:z.RASDimensions[1],step:1}),H.addBinding(L,"z",{label:"z面",min:0,max:z.RASDimensions[2],step:1}),H.addBinding(z,"lowerThreshold",{label:"lowerThreshold",min:z.min,max:z.max,step:1}).on("change",()=>{z.repaintAllSlices()}),H.addBinding(z,"upperThreshold",{label:"upperThreshold",min:z.min,max:z.max,step:1}).on("change",()=>{z.repaintAllSlices()}),H.addBinding(z,"windowLow",{label:"windowLow",min:z.min,max:z.max,step:1}).on("change",()=>{z.repaintAllSlices()}),H.addBinding(z,"windowHigh",{label:"windowHigh",min:z.min,max:z.max,step:1}).on("change",()=>{z.repaintAllSlices()}),h(()=>L,e=>{M.index=e.x,M.repaint.call(M),R.index=e.y,R.repaint.call(R),_.index=e.z,_.repaint.call(_)},{deep:!0}),h(()=>D.colorsStops,()=>{M.mesh.material.uniforms.eTexture.value=D.updateTransferFunction(),R.mesh.material.uniforms.eTexture.value=D.updateTransferFunction(),_.mesh.material.uniforms.eTexture.value=D.updateTransferFunction()},{deep:!0,immediate:!0}),(e,a)=>(w(),x(f,null,[g("TresGroup",null,[g("primitive",{object:b(M).mesh,renderOrder:1},null,8,S),g("primitive",{object:b(R).mesh,renderOrder:2},null,8,T),g("primitive",{object:b(_).mesh,renderOrder:3},null,8,v)]),g("primitive",{object:b(B)},null,8,j)],64))}});export{y as _};
