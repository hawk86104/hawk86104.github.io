import"./axios.BTiLLHcy1763540743861.js";import"./global.BBGVMLjY1763540743861.js";import{m as e,c as a}from"./lodash.CybtBilg1763540743861.js";import{u as t}from"./useChartDataFetch.hook.DFkwif_P1763540743861.js";import"./echarts.1o70n-tX1763540743861.js";import{u as n}from"./chartEditStore.CHAh6jvI1763540743861.js";import{d as i,x as r,r as o,q as s,w as l,W as d,H as g,o as h,I as c,O as m,F as u,X as f,u as p}from"./@vue.Co_gxueH1763540743861.js";import{_ as w}from"./@fesjs.BEMFm_yJ1763540743861.js";const C={class:"dv-scroll-board"},x=["align","innerHTML"],y=["align","innerHTML"],v=i({__name:"index",props:{chartConfig:{type:Object,required:!0}},setup(i){const w=i,{w:v,h:H}=r(w.chartConfig.attr),$=o({defaultConfig:{header:[],dataset:[],rowNum:5,headerBGC:"#00BAFF",oddRowBGC:"#003B51",evenRowBGC:"#0A2732",waitTime:2,headerHeight:35,columnWidth:[],align:[],index:!1,indexHeader:"#",carousel:"single",hoverPause:!0},mergedConfig:w.chartConfig.option,header:[],rowsData:[],rows:[{ceils:[],rowIndex:0,scroll:0}],widths:[],heights:[0],avgHeight:0,aligns:[],animationIndex:0,animationHandler:0,updater:0,needCalc:!1}),b=()=>{j(),T(),B(),_(),k(),I(),A(!0)};s(()=>{b()});const j=()=>{$.mergedConfig=e(a($.defaultConfig),w.chartConfig.option)},T=()=>{let{header:e,index:a,indexHeader:t}=$.mergedConfig;e.length?(e=[...e],a&&e.unshift(t),$.header=e):$.header=[]},B=()=>{let{dataset:e,index:a,headerBGC:t,rowNum:n}=$.mergedConfig;a&&(e=e.map((e,a)=>{e=[...e];const n=`<span class="index" style="background-color: ${t};border-radius: 3px;padding: 0px 3px;">${a+1}</span>`;return e.unshift(n),e})),e=e.map((e,a)=>({ceils:e,rowIndex:a}));const i=e.length;i>n&&i<2*n&&(e=[...e,...e]),e=e.map((e,a)=>({...e,scroll:a})),$.rowsData=e,$.rows=e},_=()=>{const{mergedConfig:a,rowsData:t}=$,{columnWidth:n,header:i}=a,r=n.reduce((e,a)=>e+a,0);let o=0;t[0]?o=t[0].ceils.length:i.length&&(o=i.length);const s=(v.value-r)/(o-n.length),l=new Array(o).fill(s);$.widths=e(l,n)},k=(e=!1)=>{const{mergedConfig:a,header:t}=$,{headerHeight:n,rowNum:i,dataset:r}=a;let o=H.value;t.length&&(o-=n);const s=o/i;$.avgHeight=s,e||($.heights=new Array(r.length).fill(s))},I=()=>{const{header:a,mergedConfig:t}=$,n=a.length;let i=new Array(n).fill("left");const{align:r}=t;$.aligns=e(i,r)},A=async(e=!1)=>{const{needCalc:a}=$;a&&(B(),k(),$.needCalc=!1);let{avgHeight:t,animationIndex:n,mergedConfig:i,rowsData:r,updater:o}=$;const{waitTime:s,carousel:l,rowNum:d}=i,g=r.length;if(d>=g)return;if(e&&(await new Promise(e=>setTimeout(e,1e3*s)),o!==$.updater))return;const h="single"===l?1:d;let c=r.slice(n);if(c.push(...r.slice(0,n)),$.rows=c.slice(0,"page"===l?2*d:d+1),$.heights=new Array(g).fill(t),await new Promise(e=>setTimeout(e,300)),o!==$.updater)return;$.heights.splice(0,h,...new Array(h).fill(0)),n+=h;const m=n-g;m>=0&&(n=m),$.animationIndex=n,$.animationHandler=setTimeout(A,1e3*s-300)},G=()=>{$.updater=($.updater+1)%999999,$.animationHandler&&clearTimeout($.animationHandler)},D=async()=>{try{if(!$.mergedConfig)return;G(),b()}catch(e){console.log(e)}};return l(()=>v.value,()=>{D()}),l(()=>H.value,()=>{D()}),l(()=>w.chartConfig.option,()=>{D()},{deep:!0}),t(w.chartConfig,n,e=>{w.chartConfig.option.dataset=e,D()}),d(()=>{G()}),(e,a)=>(h(),g("div",C,[$.header.length&&$.mergedConfig?(h(),g("div",{key:0,class:"header",style:m(`background-color: ${$.mergedConfig.headerBGC};`)},[(h(!0),g(u,null,f($.header,(e,a)=>(h(),g("div",{class:"header-item",key:`${e}${a}`,style:m(`\n        height: ${$.mergedConfig.headerHeight}px;\n        line-height: ${$.mergedConfig.headerHeight}px;\n        width: ${$.widths[a]}px;\n      `),align:$.aligns[a],innerHTML:e},null,12,x))),128))],4)):c("",!0),$.mergedConfig?(h(),g("div",{key:1,class:"rows",style:m(`height: ${p(H)-($.header.length?$.mergedConfig.headerHeight:0)}px;`)},[(h(!0),g(u,null,f($.rows,(e,a)=>(h(),g("div",{class:"row-item",key:`${e.toString()}${e.scroll}`,style:m(`\n        height: ${$.heights[a]}px;\n        line-height: ${$.heights[a]}px;\n        background-color: ${$.mergedConfig[e.rowIndex%2==0?"evenRowBGC":"oddRowBGC"]};\n      `)},[(h(!0),g(u,null,f(e.ceils,(e,t)=>(h(),g("div",{class:"ceil",key:`${e}${a}${t}`,style:m(`width: ${$.widths[t]}px;`),align:$.aligns[t],innerHTML:e},null,12,y))),128))],4))),128))],4)):c("",!0)]))}}),H=w(v,[["__scopeId","data-v-0c3cd2e1"]]),$=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{$ as _};
