import{P as t}from"./tweakpane.yDiyAAkA1741583630766.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.LU_e6BD61741583630766.js";import{e}from"./@tresjs.ZmhvXhx31741583630766.js";import{z as r}from"./three-custom-shader-material.fHkqEbki1741583630766.js";import{_ as i,a0 as u,C as c,cm as a,l as s,b9 as l}from"./three.sQDbNBks1741583630766.js";import{d as f,a2 as d,w as p,o as m,H as v,u as g,a3 as h,r as y,f as w,g as _,j as C,m as b}from"./@vue.NRI7TcgI1741583630766.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741583630766.js";import"./postprocessing.7Yq_IN-m1741583630766.js";import"./@vueuse.Z9_WSajh1741583630766.js";const x=S;!function(t,n){const o=S,e=O();for(;;)try{if(775558===parseInt(o(329))/1+-parseInt(o(399))/2*(parseInt(o(397))/3)+parseInt(o(370))/4+-parseInt(o(371))/5*(parseInt(o(344))/6)+parseInt(o(375))/7+parseInt(o(361))/8*(-parseInt(o(372))/9)+-parseInt(o(362))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=S,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(340),"i"),e=B(t(333));n.test(e+t(398))&&o[t(378)](e+t(389))?B():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function S(t,n){const o=O();return(S=function(t,n){return o[t-=329]})(t,n)}M(void 0,(function(){const t=S,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(394)]=n[t(394)]||{},e=["log","warn",t(342),t(373),"exception",t(391),t(366)];for(let r=0;r<e.length;r++){const n=M[t(337)][t(376)][t(380)](M),i=e[r],u=o[i]||n;n[t(341)]=M.bind(M),n[t(374)]=u[t(374)].bind(u),o[i]=n}}))();const j=[x(360)],T=f({__name:x(348),props:{model:{},bulidingsColor:{default:x(350)},landColor:{default:"#112233"},topColor:{default:x(367)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,a=o[n(352)][n(385)];o[n(352)][n(352)][n(388)][0][n(353)]=new(i[n(359)])({color:n(367)}),a[n(384)]=1001;const s=o[n(352)].land;(()=>{const t=n,{geometry:e}=a;e[t(387)](),e[t(334)]();const{max:u,min:s}=e[t(349)];if(a[t(353)][t(351)])return;const l=new r({baseMaterial:a[t(353)],vertexShader:t(343),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:u},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(o[t(383)])},uOpacity:{value:o[t(338)]},uLightColor:{value:new(i[t(335)])(t(369))},uTopColor:{value:new(i[t(335)])(o[t(357)])},uTime:{value:0},uGradient:{value:o[t(400)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(332)]});a[t(353)][t(381)](),a[t(353)]=l})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a[o(353)].uniforms[o(355)][o(395)]+=t})),d((()=>{const t=n;o[t(383)]&&a[t(353)][t(347)][t(330)][t(395)][t(392)](o[t(383)]),o[t(363)]&&((t,e)=>{const r=n;let i;"cu"===t||t===r(379)&&(i=Array[r(382)](s[r(353)])?s[r(353)]:[s[r(353)]],i[r(339)]((t=>{const n=r;t[e][n(392)](o[n(363)]),t.side=u})))})("land",t(345)),o[t(338)]&&(a[t(353)][t(347)][t(358)].value=o[t(338)])})),p(o,((t,o)=>{const e=n;a[e(353)][e(347)][e(365)].value=t[e(400)]}));const f=o[n(352)][n(352)][n(346)]();return(t,o)=>{const e=n;return m(),v(e(368),{object:g(f)},null,8,j)}}});function B(t){function n(t){const o=S;if(typeof t===o(396))return function(t){}[o(337)](o(364))[o(354)](o(393));1!==(""+t/t)[o(377)]||t%20==0?function(){return!0}[o(337)](o(331)+o(390))[o(336)](o(356)):function(){return!1}[o(337)](o(331)+o(390))[o(354)](o(386)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function O(){const t=["trace","#ffff00","primitive","#ffffff","3775440OTDhTL","19760EkWXrT","459387olBtxz","error","toString","7631393rgQtvu","prototype","length","test","land","bind","dispose","isArray","bulidingsColor","renderOrder","city","stateObject","computeBoundingBox","children","input","gger","table","setStyle","counter","console","value","string","3ANCcvr","chain","1445968RLScyB","gradient","1467478zegYlg","uColor","debu","DoubleSide","init","computeBoundingSphere","Color","call","constructor","opacity","forEach","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__proto__","info","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","1908JusVsy","color","clone","uniforms","bModel","boundingBox","#e523ff","__csm","model","material","apply","uTime","action","topColor","uOpacity","MeshBasicMaterial","object","56inImgm","3889580LxcPnU","landColor","while (true) {}","uGradient"];return(O=function(){return t})()}const P=L;!function(t,n){const o=L,e=D();for(;;)try{if(218430===parseInt(o(448))/1+parseInt(o(428))/2*(parseInt(o(414))/3)+-parseInt(o(429))/4+parseInt(o(415))/5*(parseInt(o(427))/6)+-parseInt(o(422))/7*(-parseInt(o(458))/8)+parseInt(o(445))/9+parseInt(o(457))/10*(-parseInt(o(464))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(413)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=L,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(423),"i"),e=G(t(453));n[t(436)](e+t(410))&&o[t(436)](e+t(451))?G():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(413)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(){const t=["prototype","length","return (function() ","linewidth","176LyqUyN","__proto__","error","gger","chain","console","builds","apply","4542DdAreM","195KAHmIz","value","warn","call","toString","applyMatrix4","log","119DWupJY","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","width","counter","gradual","12918RzAWDP","26ekcRjZ","1405340GBIDsE","color","string","uScale","debu","bLine","clone","test","geometry","table","#000","action",'{}.constructor("return this")( )',"uTime","info","trace","3629151DSvMtV","stateObject","object","278644HWwznb","speed","constructor","input","uniforms","init","while (true) {}","bind","srcColor","208730vjtOmA","55624LgGIDp","scale"];return(D=function(){return t})()}z(void 0,(function(){const t=L;let n;try{n=Function(t(462)+t(441)+");")()}catch(r){n=window}const o=n.console=n[t(411)]||{},e=[t(421),t(417),t(443),t(408),"exception",t(438),t(444)];for(let i=0;i<e[t(461)];i++){const n=z[t(450)][t(460)][t(455)](z),r=e[i],u=o[r]||n;n[t(407)]=z[t(455)](z),n[t(419)]=u[t(419)].bind(u),o[r]=n}}))();const F=[P(447)];function L(t,n){const o=D();return(L=function(t,n){return o[t-=407]})(t,n)}const E=f({__name:P(434),props:{builds:{},color:{default:"#FFF"},srcColor:{default:P(439)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o[n(430)])},uSrcColor:{value:new c(o[n(456)])},uScale:{value:o[n(459)]},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o[n(412)][n(437)])[n(435)]();u=u[n(420)](o[n(412)].matrix);const f=new s(i);r=new l(u,f),r.material[n(463)]=o[n(424)],r.renderOrder=1e3,d((()=>{const t=n;o.color&&(i.uniforms.uColor[t(416)]=new c(o[t(430)])),o[t(456)]&&(i[t(452)].uSrcColor.value=new c(o.srcColor)),o[t(459)]&&(i[t(452)][t(432)][t(416)]=o[t(459)]),o[t(426)]&&(i[t(452)].uGradual[t(416)]=o[t(426)])}));const{onLoop:p}=e();return p((({delta:t})=>{const e=n;i[e(452)][e(442)].value+=t*o[e(449)],i[e(452)][e(442)].value%=1})),(t,n)=>(m(),v("primitive",{object:g(r)},null,8,F))}});function G(t){function n(t){const o=L;if(typeof t===o(431))return function(t){}[o(450)](o(454))[o(413)](o(425));1!==(""+t/t)[o(461)]||t%20==0?function(){return!0}[o(450)]("debu"+o(409))[o(418)](o(440)):function(){return!1}.constructor(o(433)+o(409))[o(413)](o(446)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const R=H;!function(t,n){const o=H,e=W();for(;;)try{if(389818===parseInt(o(502))/1+-parseInt(o(481))/2+parseInt(o(468))/3+-parseInt(o(503))/4+-parseInt(o(461))/5+parseInt(o(487))/6+-parseInt(o(483))/7*(parseInt(o(476))/8))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(477)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function W(){const t=["string","model","scale","console","314790jnJUjQ","392292TSqbmZ","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","speed","color","gger","init","278400YlxQfx","exception","constructor","city","stateObject","test","#112233","1348728uhwoJx","addBinding","debu","warn","#999","log","action","counter","8zBAYZy","apply","prototype",'{}.constructor("return this")( )',"线原颜色","1205378QUiHrQ","#000","1675471OdXKVq","chain","info","最大扩散","3727482QyxOLN","length","buildingsEffectA","while (true) {}","return (function() ","toString","gradual","#FFF","效果参数","error","bind"];return(W=function(){return t})()}!function(){Z(this,(function(){const t=H,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(504),"i"),e=$(t(460));n[t(466)](e+t(484))&&o[t(466)](e+"input")?$():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(477)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(t,n){const o=W();return(H=function(t,n){return o[t-=458]})(t,n)}k(void 0,(function(){const t=H;let n;try{n=Function(t(491)+t(479)+");")()}catch(r){n=window}const o=n.console=n[t(501)]||{},e=[t(473),t(471),t(485),t(496),t(462),"table","trace"];for(let i=0;i<e[t(488)];i++){const n=k.constructor[t(478)][t(497)](k),r=e[i],u=o[r]||n;n.__proto__=k[t(497)](k),n[t(492)]=u[t(492)][t(497)](u),o[r]=n}}))();const Q=f({__name:R(489),async setup(e){const r=R;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(494),srcColor:r(482),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(495),expanded:!0});return s[r(469)](a,"srcColor",{label:r(480)}),s.addBinding(a,r(458),{label:"线扫颜色"}),s.addBinding(a,r(505),{label:"速度",min:.1,max:1,step:.1}),s[r(469)](a,r(500),{label:r(486),min:10,max:2e3,step:10}),s.addBinding(a,r(493),{label:"扩散系数",min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:_((()=>[C(T,{model:g(c),bulidingsColor:"#000000",landColor:e(467),topColor:e(472)},null,8,[e(499)]),C(E,b({builds:g(c)[e(464)]},a),null,16,["builds"])])),_:1})}}});function $(t){function n(t){const o=H;if(typeof t===o(498))return function(t){}[o(463)](o(490))[o(477)](o(475));1!==(""+t/t).length||t%20==0?function(){return!0}[o(463)](o(470)+o(459)).call(o(474)):function(){return!1}[o(463)](o(470)+o(459))[o(477)](o(465)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Q as default};
