import{_ as t,cf as n,cg as o,ch as e,ci as r,C as i,m as u,bU as s,ak as c,am as a}from"./three.0W5n8UBO1729820105274.js";import{c as l,U as f,Y as p}from"./@tresjs.S6PXiQcG1729820105274.js";import{C as d}from"./three-custom-shader-material.WIBIoaCk1729820105274.js";import"./object-hash.O5Web0p21729820105274.js";import"./@amap.UuvR34pR1729820105274.js";import"./glsl-tokenizer.fZI0jxNo1729820105274.js";import{d as h,b as m,a3 as y,w as g,o as w,E as v,u as b,r as _,a4 as C,e as I,f as x,g as M,L as S,j as O,aj as T,ak as j,F as A,J as R,H as B,m as L}from"./@vue.bvMz0l_u1729820105274.js";!function(t,n){const o=F,e=D();for(;;)try{if(307810===-parseInt(o(134))/1*(-parseInt(o(133))/2)+parseInt(o(156))/3*(parseInt(o(150))/4)+-parseInt(o(144))/5*(-parseInt(o(164))/6)+-parseInt(o(125))/7+parseInt(o(148))/8+-parseInt(o(153))/9+-parseInt(o(163))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(135)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=F,n=new RegExp(t(160)),o=new RegExp(t(161),"i"),e=H(t(143));n.test(e+"chain")&&o[t(141)](e+"input")?H():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(135)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();E(void 0,(function(){const t=F;let n;try{n=Function(t(145)+t(132)+");")()}catch(r){n=window}const o=n[t(159)]=n[t(159)]||{},e=[t(152),t(130),t(158),t(137),t(127),"table","trace"];for(let i=0;i<e[t(155)];i++){const n=E.constructor[t(147)][t(142)](E),r=e[i],u=o[r]||n;n[t(138)]=E[t(142)](E),n.toString=u[t(146)][t(142)](u),o[r]=n}}))();const k=async()=>{const t=F,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(154)]((n=>{const i=t;n[i(140)]===i(162)&&(o=n),"LANDMASS"===n[i(140)]&&(e=n),n.name===i(136)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function F(t,n){const o=D();return(F=function(t,n){return o[t-=125]})(t,n)}function D(){const t=["bind","init","80rvsfcl","return (function() ","toString","prototype","396232EkUSXj","call","37084MLhZyW","action","log","3621753tVcZqG","traverse","length","126oPfVML","while (true) {}","info","console","function *\\( *\\)","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","CITY_UNTRIANGULATED","4005790CyRalW","155658AUUzHg","1485197MURMoS","counter","exception","string","gger","warn","constructor",'{}.constructor("return this")( )',"2pukKAa","468978UTmcPt","apply","ROADS","error","__proto__","debu","name","test"];return(D=function(){return t})()}function H(t){function n(t){const o=F;if(typeof t===o(128))return function(t){}[o(131)](o(157))[o(135)](o(126));1!==(""+t/t)[o(155)]||t%20==0?function(){return!0}.constructor(o(139)+o(129))[o(149)](o(151)):function(){return!1}[o(131)](o(139)+"gger")[o(135)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=Z;function Z(t,n){const o=U();return(Z=function(t,n){return o[t-=417]})(t,n)}!function(t,n){const o=Z,e=U();for(;;)try{if(140638===-parseInt(o(467))/1*(parseInt(o(442))/2)+parseInt(o(425))/3*(-parseInt(o(476))/4)+parseInt(o(459))/5+parseInt(o(457))/6*(-parseInt(o(422))/7)+parseInt(o(446))/8+parseInt(o(418))/9*(-parseInt(o(460))/10)+-parseInt(o(436))/11*(-parseInt(o(439))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(471)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function U(){const t=["chain","bulidingsColor","2622dEpfOK","model","159130LYzOrq","70nEDUOM","setStyle","trace","material","#112233","input","prototype","1BOrSQx","test","return (function() ","toString","apply","opacity","primitive","exception","boundingBox","896684Inpmld","side","log","debu","land","#ffff00","276021qAWflz","value","#ffffff","init","2226ErcGhS","renderOrder","console","3gtQxYg","function *\\( *\\)","constructor","clone","color","counter","gradient","uOpacity","length","Color","bind","6028gOzkDb","#e523ff","error","15084noSrSz","while (true) {}","object","213124iCLWzv","gger","info","DoubleSide","834864fbeSls","city","stateObject","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","forEach","landColor","uniforms","action","table"];return(U=function(){return t})()}!function(){G(this,(function(){const t=Z,n=new RegExp(t(426)),o=new RegExp(t(449),"i"),e=Y(t(421));n[t(468)](e+t(455))&&o.test(e+t(465))?Y():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(471)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();W(void 0,(function(){const t=Z,n=function(){const t=Z;let n;try{n=Function(t(469)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(424)]=n[t(424)]||{},e=[t(478),"warn",t(444),t(438),t(474),t(454),t(462)];for(let r=0;r<e[t(433)];r++){const n=W[t(427)][t(466)][t(435)](W),i=e[r],u=o[i]||n;n.__proto__=W[t(435)](W),n[t(470)]=u[t(470)][t(435)](u),o[i]=n}}))();const $=[P(441)],Q=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:P(437)},landColor:{default:P(464)},topColor:{default:P(417)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=P,e=n,r=m(0),i=e[o(458)][o(447)];i[o(423)]=1001;const u=e.model[o(480)];(()=>{const n=o,{geometry:u}=i;u.computeBoundingBox(),u.computeBoundingSphere();const{max:s,min:c}=u[n(475)];if(i[n(463)].__csm)return;const a=new d({baseMaterial:i[n(463)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:c},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(434)])(e[n(456)])},uOpacity:{value:e[n(472)]},uLightColor:{value:new(t[n(434)])(n(420))},uTopColor:{value:new(t[n(434)])(e.topColor)},uTime:r,uGradient:{value:e[n(431)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(445)]});i.material.dispose(),i[n(463)]=a})();const{onLoop:s}=f();s((({delta:t})=>{r.value+=t})),y((()=>{const n=o;e.bulidingsColor&&i[n(463)][n(452)].uColor.value.setStyle(e[n(456)]),e[n(451)]&&((n,r)=>{const i=o;let s;"cu"===n||n===i(480)&&(s=Array.isArray(u[i(463)])?u[i(463)]:[u[i(463)]],s[i(450)]((n=>{const o=i;n[r][o(461)](e[o(451)]),n[o(477)]=t[o(445)]})))})("land",n(429)),e.opacity&&(i[n(463)][n(452)][n(432)][n(419)]=e[n(472)])})),g(e,((t,n)=>{const e=o;i[e(463)][e(452)].uGradient.value=t[e(431)]}));const c=e.model.model[o(428)]();return(t,n)=>{const e=o;return w(),v(e(473),{object:b(c)},null,8,$)}}});function Y(t){function n(t){const o=Z;if("string"==typeof t)return function(t){}[o(427)](o(440)).apply(o(430));1!==(""+t/t)[o(433)]||t%20==0?function(){return!0}[o(427)]("debu"+o(443)).call(o(453)):function(){return!1}[o(427)](o(479)+o(443))[o(471)](o(448)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function N(){const t=["gger","570518OQuTcQ","width","test","__proto__","constructor","clone","matrix","58308EPAUZo","geometry","counter","fromEdgesGeometry","182LOKdrz","color","renderOrder","style","while (true) {}","7965EgjkkQ","bind","builds","apply","set","4LEcCfq","applyMatrix4","innerHeight","Shader","info","buildingsLines","3949qCjHQo","primitive","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","object","3234PrDahu","error","value","linewidth","stateObject","action","9040ODhFbw","Wireframe","toString","#FFF",'{}.constructor("return this")( )',"string","function *\\( *\\)","length","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","resolution","2076405CANxpO","debu","2259218jibFxs","console","opacity","136256SMdfdA","chain","material","uniforms","uColor","6120Xkoolx"];return(N=function(){return t})()}const q=J;!function(t,n){const o=J,e=N();for(;;)try{if(692080===parseInt(o(290))/1+-parseInt(o(280))/2+parseInt(o(278))/3*(-parseInt(o(311))/4)+parseInt(o(306))/5*(-parseInt(o(321))/6)+parseInt(o(301))/7*(parseInt(o(283))/8)+parseInt(o(288))/9*(parseInt(o(327))/10)+-parseInt(o(317))/11*(-parseInt(o(297))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const V=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(309)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){V(this,(function(){const t=J,n=new RegExp(t(333)),o=new RegExp(t(319),"i"),e=nt("init");n[t(292)](e+t(284))&&o[t(292)](e+"input")?nt():e("0")}))()}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(309)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function J(t,n){const o=N();return(J=function(t,n){return o[t-=278]})(t,n)}X(void 0,(function(){const t=J;let n;try{n=Function("return (function() "+t(331)+");")()}catch(r){n=window}const o=n.console=n[t(281)]||{},e=["log","warn",t(315),t(322),"exception","table","trace"];for(let i=0;i<e[t(334)];i++){const n=X[t(294)].prototype[t(307)](X),r=e[i],u=o[r]||n;n[t(293)]=X[t(307)](X),n.toString=u[t(329)].bind(u),o[r]=n}}))();const K=[q(320)],tt=h({__name:q(316),props:{builds:{},width:{default:1},color:{default:q(330)},opacity:{default:1},style:{default:q(328)}},setup(t){const s=q,c=t;let a=null,l=null;if(c[s(304)]===s(328)){const t=new n(c[s(308)].geometry);let i=(new o)[s(300)](t),u=new e({color:c[s(302)],linewidth:c[s(291)],opacity:c[s(282)],transparent:!0,depthWrite:!0,depthTest:!0});u[s(336)][s(310)](window.innerWidth,window[s(313)]),a=new r(i,u),a[s(312)](c.builds.matrix[s(295)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(c[s(302)])},uOpacity:{value:c[s(282)]}},vertexShader:s(335),fragmentShader:" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const t=new n(c[s(308)][s(298)]),o=new u(l);a=new LineSegments(t,o),a.applyMatrix4(c[s(308)][s(296)][s(295)]()),a[s(285)][s(324)]=c[s(291)],a[s(303)]=1e3}return y((()=>{const t=s;c.style===t(314)&&(c[t(302)]&&(l[t(286)][t(287)][t(323)]=new i(c[t(302)])),c[t(282)]&&(l[t(286)].uOpacity[t(323)]=c.opacity)),c.style===t(328)&&(c[t(302)]&&(a[t(285)][t(302)]=new i(c[t(302)])),c[t(282)]&&(a[t(285)][t(282)]=c.opacity)),c[t(291)]&&(a[t(285)][t(324)]=c[t(291)])})),(t,n)=>{const o=s;return w(),v(o(318),{object:b(a)},null,8,K)}}});function nt(t){function n(t){const o=J;if(typeof t===o(332))return function(t){}[o(294)](o(305))[o(309)](o(299));1!==(""+t/t)[o(334)]||t%20==0?function(){return!0}[o(294)](o(279)+o(289)).call(o(326)):function(){return!1}[o(294)](o(279)+"gger")[o(309)](o(325)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=et;function et(t,n){const o=it();return(et=function(t,n){return o[t-=318]})(t,n)}!function(t,n){const o=et,e=it();for(;;)try{if(317353===-parseInt(o(358))/1+parseInt(o(350))/2*(-parseInt(o(325))/3)+parseInt(o(332))/4*(-parseInt(o(342))/5)+-parseInt(o(357))/6*(-parseInt(o(340))/7)+-parseInt(o(323))/8*(-parseInt(o(344))/9)+parseInt(o(337))/10*(-parseInt(o(353))/11)+-parseInt(o(341))/12*(-parseInt(o(365))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[et(363)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(){const t=["#ffffff","showAxesHelper",'{}.constructor("return this")( )',"length","apply","warn","13zyYvVN","table","trace","showBuildings","string","log","ability","function *\\( *\\)","model","TresCanvas","gger","toString","8144VHtDFN","city","9TcUyrm","chain","tcRef","exception","return (function() ","info","call","1276sZbHAS","pagesShow","bind","while (true) {}","counter","190RcytSx","init","TresAmbientLight","7JlcFnB","5793924LAgjZS","150pJYcIm","console","3033ulOiBX","showGridHelper","TresAxesHelper","TresGridHelper","#000000","error","347394jQYFBI","$slots","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","70257HGTQiT","test","constructor","perspectiveCameraRef","3020622adROti","359963SasFxC"];return(it=function(){return t})()}!function(){rt(this,(function(){const t=et,n=new RegExp(t(318)),o=new RegExp(t(352),"i"),e=pt(t(338));n.test(e+t(326))&&o[t(354)](e+"input")?pt():e("0")}))()}();const ut=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();ut(void 0,(function(){const t=et,n=function(){const t=et;let n;try{n=Function(t(329)+t(361)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(343)]||{},e=[t(370),t(364),t(330),t(349),t(328),t(366),t(367)];for(let r=0;r<e[t(362)];r++){const n=ut.constructor.prototype[t(334)](ut),i=e[r],u=o[i]||n;n.__proto__=ut[t(334)](ut),n[t(322)]=u[t(322)][t(334)](u),o[i]=n}}))();const st=S(ot(339),{color:ot(359)},null,-1),ct=S("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]},ft=h({__name:ot(333),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(348),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:c,toneMapping:a,disableRender:r.disableRender}),u=_({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r.showBuildings&&([o,e]=C((()=>k())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,s=I(e(320));return w(),x(s,L({ref_key:e(327),ref:d},i,{"window-size":""}),{default:M((()=>[S("TresPerspectiveCamera",{ref_key:e(356),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),O(b(p),T(j(u)),null,16),st,ct,r[e(368)]&&b(l)?(w(),v(A,{key:0},[O(Q,{model:b(l)},null,8,[e(319)]),O(tt,{builds:b(l)[e(324)],color:"#000"},null,8,["builds"])],64)):R("",!0),B(t[e(351)],e(371)),r[e(360)]?(w(),v(e(346),at)):R("",!0),r[e(345)]?(w(),v(e(347),lt)):R("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=et;if(typeof t===o(369))return function(t){}.constructor(o(335))[o(363)](o(336));1!==(""+t/t)[o(362)]||t%20==0?function(){return!0}.constructor("debu"+o(321))[o(331)]("action"):function(){return!1}[o(355)]("debugger")[o(363)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Q as _,tt as a,ft as b,k as l};
