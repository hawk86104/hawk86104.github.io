var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;import{_ as r,bU as o,ak as s,am as i}from"./three.ZWd_rX7H1726563592429.js";import{p as c,U as a,Y as u,L as l}from"./@tresjs.Mu0zjs701726563592429.js";import{g as p,i as f,e as d}from"./utils.5evIC3Tp1726563592429.js";import{_ as m}from"./jszip.ZHd90Dyy1726563592429.js";import{F as h}from"./file-saver.kq15gbta1726563592429.js";import{P as g}from"./tweakpane.yHWGBmom1726563592429.js";import{d as v,q as y,r as w,Y as b,a3 as j,o as E,E as I,j as O,g as S,u as L,aj as T,ak as P,f as _,al as x,m as z,F as k,L as R}from"./@vue.bvMz0l_u1726563592429.js";import{w as C}from"./@fesjs.Kb69K-9r1726563592429.js";import"./@vueuse.a2m4N83v1726563592429.js";import"./@amap.JADYh6_E1726563592429.js";import"./vue-router.69lN8_NV1726563592429.js";import"./lodash-es.guXTxyfJ1726563592429.js";import"./@qlin.yHhFDldE1726563592429.js";import"./pinia.DLSH1Ooz1726563592429.js";import"./@floating-ui.BPbuo5Gx1726563592429.js";import"./@juggle.7yjBMqoW1726563592429.js";function J(){const t=["__proto__","APP.Player: Script without object.","trace","uuid",'{}.constructor("return this")( )',"function *\\( *\\)","constructor","stringify","length","init","string","error","stop","log","keydown","14jWPVeJ","3246103PyNXxV","width","test","addEventListener","1581296GDMsiV","player,renderer,scene,camera","value","action","11410578YiwWbk","apply","console","start","109085KcBugk","counter","update","call","table","pointermove","2069088CuVkcz","debu","168123OvQzUJ","pointerup","gger","130220gIhWGi","42aoKcYC","object","toString","stateObject","source","warn","bind","removeEventListener","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","pointerdown","keyup"];return(J=function(){return t})()}!function(t,n){const e=H,r=J();for(;;)try{if(259501===-parseInt(e(180))/1+-parseInt(e(156))/2*(-parseInt(e(177))/3)+-parseInt(e(161))/4+-parseInt(e(169))/5*(parseInt(e(181))/6)+-parseInt(e(157))/7+-parseInt(e(175))/8+parseInt(e(165))/9)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const F=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[H(166)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){F(this,(function(){const t=H,n=new RegExp(t(146)),e=new RegExp(t(137),"i"),r=Y(t(150));n[t(159)](r+t(138))&&e[t(159)](r+"input")?Y():r("0")}))()}();const N=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[H(166)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function M(t,n){for(let e=0,r=t[H(149)];e<r;e++)t[e](n)}N(void 0,(function(){const t=H;let n;try{n=Function("return (function() "+t(145)+");")()}catch(o){n=window}const e=n[t(167)]=n[t(167)]||{},r=[t(154),t(134),"info",t(152),"exception",t(173),t(143)];for(let s=0;s<r[t(149)];s++){const n=N[t(147)].prototype[t(135)](N),o=r[s],i=e[o]||n;n[t(141)]=N[t(135)](N),n[t(183)]=i[t(183)][t(135)](i),e[o]=n}}))(),window.THREE=r;const G={init:[],start:[],stop:[],keydown:[],keyup:[],pointerdown:[],pointerup:[],pointermove:[],update:[]},W=()=>{};function Z(t){M(G[H(155)],t)}function A(t){M(G[H(140)],t)}function U(t){M(G.pointerdown,t)}function H(t,n){const e=J();return(H=function(t,n){return e[t-=134]})(t,n)}function D(t){M(G[H(178)],t)}function B(t){M(G[H(174)],t)}function Y(t){function n(t){const e=H;if(typeof t===e(151))return function(t){}.constructor("while (true) {}")[e(166)](e(170));1!==(""+t/t)[e(149)]||t%20==0?function(){return!0}[e(147)](e(176)+e(179))[e(172)](e(164)):function(){return!1}[e(147)](e(176)+"gger")[e(166)](e(184)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function $(t,n){const e=Q();return($=function(t,n){return e[t-=338]})(t,n)}!function(t,n){const e=$,r=Q();for(;;)try{if(680807===parseInt(e(354))/1+parseInt(e(338))/2+-parseInt(e(360))/3+-parseInt(e(342))/4+parseInt(e(358))/5+parseInt(e(344))/6+parseInt(e(369))/7*(-parseInt(e(366))/8))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const K=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function Q(){const t=["error","187976ouHxgz","table","toString","371lcaNrC","debu","input","499080IMeMFD","gger","string","action","3254492BSfBdQ","/* eslint-disable prefer-rest-params */\n/* eslint-disable no-undefined */\n/* eslint-disable guard-for-in */\nimport * as THREE from 'three'\n\nwindow.THREE = THREE // Used by APP Scripts.\nconst Grscwh = { scene: null, renderer: null, camera: null, sizes: null }\nconst player = {\n\tget renderer() {\n\t\treturn Grscwh.renderer?.value\n\t},\n\tloader: new THREE.TextureLoader(),\n\tget scene() {\n\t\t\treturn Grscwh.scene?.value\n\t},\n\tget camera() {\n\t\t\treturn Grscwh.camera?.value\n\t},\n\tget width() {\n\t\t\treturn Grscwh.sizes?.width?.value\n\t},\n\tget height() {\n\t\t\treturn Grscwh.sizes?.height?.value\n\t},\n\tget dom() {\n\t\t\treturn Grscwh.renderer?.value.domElement.parentElement\n\t},\n\tget canvas() {\n\t\t\treturn Grscwh.renderer?.value.domElement\n\t},\n\tevents: {},\n\tinit(scene, renderer, camera, sizes) {\n\t\t\tGrscwh.scene = scene\n\t\t\tGrscwh.renderer = renderer\n\t\t\tGrscwh.camera = camera\n\t\t\tGrscwh.sizes = sizes\n\t},\n\tload(sceneObject) {\n\t\t","7707456pNluEg","call","console","apply","stringify","log","exception","return (function() ","warn","__proto__","1035932SHpwYY","function *\\( *\\)","test","const scriptsJson = \n","5925480TnuZpg","length","3046119mZTOWQ","constructor","bind","counter","while (true) {}"];return(Q=function(){return t})()}!function(){K(this,(function(){const t=$,n=new RegExp(t(355)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=X("init");n[t(356)](r+"chain")&&e[t(356)](r+t(371))?X():r("0")}))()}();const V=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[$(347)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();V(void 0,(function(){const t=$;let n;try{n=Function(t(351)+'{}.constructor("return this")( ));')()}catch(o){n=window}const e=n[t(346)]=n[t(346)]||{},r=[t(349),t(352),"info",t(365),t(350),t(367),"trace"];for(let s=0;s<r[t(359)];s++){const n=V.constructor.prototype[t(362)](V),o=r[s],i=e[o]||n;n[t(353)]=V[t(362)](V),n[t(368)]=i[t(368)][t(362)](i),e[o]=n}}))();function X(t){function n(t){const e=$;if(typeof t===e(340))return function(t){}[e(361)](e(364))[e(347)](e(363));1!==(""+t/t)[e(359)]||t%20==0?function(){return!0}[e(361)](e(370)+"gger")[e(345)](e(341)):function(){return!1}[e(361)]("debu"+e(339)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=et,r=nt();for(;;)try{if(457940===-parseInt(e(553))/1+-parseInt(e(528))/2+-parseInt(e(546))/3+-parseInt(e(487))/4+parseInt(e(450))/5+parseInt(e(506))/6+parseInt(e(526))/7*(parseInt(e(469))/8))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const q=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[et(513)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){q(this,(function(){const t=et,n=new RegExp(t(547)),e=new RegExp(t(531),"i"),r=at("init");n[t(499)](r+t(468))&&e[t(499)](r+t(488))?at():r("0")}))()}();const tt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[et(513)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function nt(){const t=["components/scene.vue","push","fileName","json/scene.json","forEach","config.js","apply","uuid","exception","common/eventScript.js","\n\nconst { scene: tresScene, renderer, camera, sizes } = useTresContext()\nplayer.init(tresScene, renderer, camera, sizes)\n\nconst loader = new THREE.ObjectLoader()\nconst scene = await loadJsonFile('./plugins/","bind",'\n<template>\n    <loading />\n\t<TresCanvas v-bind="state">\n\t\t',' :object="sceneObject.children[',"toneMapping","table","getDate","\n\t\t","scene","7tMVSdd","file","881302NxuUOi","name",'{}.constructor("return this")( )',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)",".json","/json/scene.json')\n\nif (scene.geometries) {\n    for (const geometry of scene.geometries) {\n        if (geometry.data && geometry.data.startsWith('url:')) {\n            let url = geometry.data.slice(4)\n            if (url.startsWith('geometries/')) {\n                url = `./plugins/","\n\t</TresCanvas>\n</template>\n<script setup lang=\"ts\">\nimport * as THREE from 'three'\nimport { reactive, watch, ref } from 'vue'\nimport { TresCanvas } from '@tresjs/core'\nimport { OrbitControls } from '@tresjs/cientos'\nimport sceneCom from '../components/scene.vue'\nimport { loading2 as loading } from 'PLS/UIdemo'\n\nconst state = reactive({\n\tclearColor: '#201919',\n\twindowSize:true,\n\tantialias: true,\n\tshadows: ","<OrbitControls />","scripts","object","info","data","counter","pluginName","call","project",'"/>\n    ','" type="',"280083bmrdTT","function *\\( *\\)","firstLevel","public/plugins/","padStart",'\n        <primitive :object="object[',".vue","142881diYYYI","toString","<Tres",'" uuid="','"/>\n        ',"geometries",",\n\ttoneMappingExposure:","2874530fWYOEQ","children","shadowType","url:geometries/","prototype","split","images","log","string","<template>\n        ","debu","false",'",\n\t\t"require": [],\n        "tvtstore": \'LOCAL\',\n\t\t"preview": [\n\t\t\t{ "src": "plugins/basic/base/preview/theBasic.png", "type": "img", "name": "index", "title": "实例" ,"disableFPSGraph": false, "disableSrcBtn": false},\n\t\t]\n\t}',"comName",",\n})\n\nconst cameraConfig = ","length","blob",";base64,","chain","5840056QomSEm",'" />',"type","src/plugins/","components/childComponent",']" name="',"gger","/${url}`\n            }\n            geometry.data = await loadJsonFile(url)\n        }\n    }\n}\nif (scene.images) {\n    for (const image of scene.images) {\n        if (image.url && image.url.startsWith('url:')) {\n            let url = image.url.slice(4)\n            if (url.startsWith('images/')) {\n                url = `./plugins/","folder",'\n    <primitive :object="sceneObject.children[',"parse","constructor","secondLevel","toneMappingExposure","console","trace","<Suspense>\n\t\t\t<sceneCom />\n\t\t</Suspense>","pages/index.vue","1639400wEUfGX","input",'",\n\t\t"updateTime": "',"true","stringify","import ","camera",'">\n    ','].children" />',"url","<template>\n    "," from './childComponent/","test",'" name="',"shadows",'\n\texport default {\n\t\t"name": "',"BufferGeometry","</template>\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue'\nimport * as THREE from 'three'\nimport { loadImageToBase64, loadJsonFile } from 'PLS/tresEditor'\nimport { useTresContext, useRenderLoop } from '@tresjs/core'\nimport player from '../common/eventScript'\n","pop","1438620nOLsZU"];return(nt=function(){return t})()}function et(t,n){const e=nt();return(et=function(t,n){return e[t-=447]})(t,n)}tt(void 0,(function(){const t=et;let n;try{n=Function("return (function() "+t(530)+");")()}catch(o){n=window}const e=n[t(483)]=n.console||{},r=[t(457),"warn",t(538),"error",t(515),t(522),t(484)];for(let s=0;s<r[t(465)];s++){const n=tt[t(480)][t(454)][t(518)](tt),o=r[s],i=e[o]||n;n.__proto__=tt.bind(tt),n[t(554)]=i[t(554)].bind(i),e[o]=n}}))();let rt=[];const ot=(r,o,s,i)=>{const c=et,a=s[c(537)],{uuid:u}=a,l=((r,o)=>{var s={};for(var i in r)n.call(r,i)&&o.indexOf(i)<0&&(s[i]=r[i]);if(null!=r&&t)for(var i of t(r))o.indexOf(i)<0&&e.call(r,i)&&(s[i]=r[i]);return s})(a,["uuid"]),p=JSON[c(479)](JSON[c(491)](s));return p.object=l,c(519)+(i.orbitControls?c(535):"")+"\n\t\t"+(s?c(555)+s[c(537)][c(471)]+'  ref="cameraRef" uuid="'+s[c(537)][c(514)]+c(500)+s.object[c(529)]+c(470):"")+c(524)+r+c(524)+(i.gridHelper?"<TresGridHelper />":"")+c(534)+(o[c(501)]?c(490):c(461))+",\n\tshadowMapType: "+(o[c(452)]?o[c(452)]:"THREE.PCFShadowMap")+",\n\ttoneMapping: "+(o[c(521)]?o[c(521)]:"THREE.NoToneMapping")+c(449)+(o[c(482)]?o[c(482)]:"1")+c(464)+(p?""+JSON[c(491)](p):"{}")+"\nconst loader = new THREE.ObjectLoader()\nconst cameraObject = loader.parse(cameraConfig)\nconst cameraRef = ref(null)\nwatch(\n\t() => cameraRef.value,\n\t(val) => {\n\t\t\tval.copy(cameraObject)\n\t},\n)\n<\/script>\n\t"},st=(t,n,e,r,o)=>{const s=et;n.childLevel;let i=s(478)+r+s(474)+e.name+s(556)+e[s(514)]+'" type="'+e[s(471)]+s(494);if(e[s(451)]&&e[s(451)][s(465)]){const n=((t,n)=>{const e=et,r=t-1,o=[e(548),e(481),"thirdLevel"],s=n.split("-")[e(505)]();return{fileName:o[r]+"-"+s+e(552),comName:""+o[r]+s}})(o,e[s(514)]);i+="<"+n[s(463)]+s(520)+r+s(495),((t,n,e)=>{const r=et;let o="";e[r(511)](((t,n)=>{const e=r;o+=e(551)+n+e(474)+t.name+e(556)+t.uuid+e(545)+t[e(471)]+e(447)}));const s=r(497)+o+'\n</template>\n\n<script setup lang="ts">\nconst props = withDefaults(\n    defineProps<{\n        object: any\n    }>(),\n    {},\n)\n<\/script>\n';t[r(527)](""+n[r(509)],s),rt[r(508)](n)})(t,n,e[s(451)])}return i+="\n    </primitive>\n",i},it=(t,n,e)=>{const r=et;let o="";const s=t[r(477)](r(473));return e[r(537)]&&e[r(537)][r(451)]&&e[r(537)][r(451)][r(465)]&&e[r(537)][r(451)][r(511)](((t,e)=>{const i=r;n.childLevel>0&&t.children&&t[i(451)][i(465)]?o+=st(s,n,t,e,1):o+='    \n    <primitive :object="sceneObject.children['+e+i(474)+t[i(529)]+i(556)+t[i(514)]+i(545)+t.type+i(544)})),t[r(527)](r(507),r(459)+o+r(504)+(()=>{const t=et;let n="";return rt[t(511)]((e=>{const r=t;n+=r(492)+e[r(463)]+r(498)+e[r(509)]+"'\n"})),n})()+r(517)+n[r(541)]+r(533)+n[r(541)]+r(476)+n[r(541)]+'/${url}`\n            }\n            if (url.endsWith(".json")) {\n                image.url = await loadJsonFile(url)\n            } else {\n                image.url = await loadImageToBase64(url)\n            }\n        }\n    }\n}\n\nconst sceneObject = loader.parse(scene) as any\nonMounted(() => {\n    tresScene.value.background = sceneObject.background\n    tresScene.value.environment = sceneObject.environment\n    tresScene.value.fog = sceneObject.fog\n    player.load(sceneObject)\n    player.play()\n})\nconst { onLoop } = useRenderLoop()\nonLoop(({ delta, elapsed }) => {\n    if (player.renderer) {\n        player.render(elapsed * 1000, delta * 1000)\n    }\n})\n<\/script>'),r(485)};function ct(t,n){const e=et;rt=[];const r=n[e(541)],o=new m;((t,n)=>{const e=et,r=[];n[e(448)]&&n[e(448)].forEach((t=>{const n=e;t[n(471)]===n(503)&&(r[n(508)]({uuid:t[n(514)],data:t[n(539)]}),t[n(539)]=n(453)+t[n(514)]+n(532))}));const o=[];if(n[e(456)]&&n[e(456)][e(511)]((t=>{const n=e;t[n(496)]&&(o[n(508)]({uuid:t[n(514)],url:t[n(496)]}),t.url.type?t[n(496)]="url:images/"+t[n(514)]+"."+t.url[n(471)]+n(532):t[n(496)]="url:images/"+t[n(514)]+"."+p(t[n(496)]))})),r[e(465)]){const n=t[e(477)](e(448));r.forEach((t=>{const r=e;n[r(527)](t.uuid+r(532),JSON[r(491)](t.data))}))}if(o[e(465)]){const n=t[e(477)]("images");o.forEach((t=>{const r=e;t[r(496)][r(471)]?n[r(527)](t[r(514)]+"."+t[r(496)].type+r(532),JSON.stringify(t[r(496)])):n[r(527)](t.uuid+"."+p(t.url),t[r(496)][r(455)](r(467))[r(505)](),{base64:!0})}))}t[e(527)](e(510),JSON[e(491)](n))})(o[e(477)](e(549)+r),t[e(525)]);const s=o.folder(e(472)+r);s[e(527)](e(512),(t=>{const n=et,e=new Date,r=e.getFullYear()+"-"+String(e.getMonth()+1)[n(550)](2,"0")+"-"+String(e[n(523)]())[n(550)](2,"0");return n(502)+t+'",\n\t\t"title": "编辑器导出的插件",\n\t\t"intro": "描述",\n\t\t"version": "0.0.1",\n\t\t"author": "作者名",\n\t\t"website": "站点地址",\n\t\t"state": "active",\n\t\t"creatTime": "'+r+n(489)+r+n(462)})(r));const i=ot(it(s,n,t.scene),t[e(543)],t[e(493)],n);return s.file(e(486),i),s[e(527)](e(516),(t=>{const n=$,e=n(357)+JSON[n(348)](t)+"\n";return n(343)+e+"\n\t\tthis.events = {\n\t\t\t\tinit: [],\n\t\t\t\tstart: [],\n\t\t\t\tstop: [],\n\t\t\t\tkeydown: [],\n\t\t\t\tkeyup: [],\n\t\t\t\tpointerdown: [],\n\t\t\t\tpointerup: [],\n\t\t\t\tpointermove: [],\n\t\t\t\tupdate: [],\n\t\t}\n\t\tlet scriptWrapParams = 'player,renderer,scene,camera'\n\t\tconst scriptWrapResultObj = {}\n\n\t\tfor (const eventKey in this.events) {\n\t\t\t\tscriptWrapParams += `,${eventKey}`\n\t\t\t\tscriptWrapResultObj[eventKey] = eventKey\n\t\t}\n\t\tconst scriptWrapResult = JSON.stringify(scriptWrapResultObj).replace(/\\\"/g, '')\n\t\tfor (const uuid in scriptsJson) {\n\t\t\t\tlet curUuid = uuid\n\t\t\t\t//这里解决一个问题 目前并没有把 主场景scene直接替换而是通过group 加进入的，所以 如果事件是基于主场景scene 那么替换这个uuid为现在tres主场景的uuid\n\t\t\t\tif (uuid === sceneObject.uuid) {\n\t\t\t\t\t\tcurUuid = this.scene.uuid\n\t\t\t\t}\n\t\t\t\tconst object = this.scene.getObjectByProperty('uuid', curUuid, true)\n\t\t\t\tif (object === undefined) {\n\t\t\t\t\t\tconsole.warn('player: Script without object.', curUuid)\n\t\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst scripts = scriptsJson[uuid]\n\t\t\t\tfor (let i = 0; i < scripts.length; i++) {\n\t\t\t\t\t\tconst script = scripts[i]\n\t\t\t\t\t\t// eslint-disable-next-line no-new-func\n\t\t\t\t\t\tconst functions = new Function(scriptWrapParams, `${script.source}\nreturn ${scriptWrapResult};`).bind(object)(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.renderer,\n\t\t\t\t\t\t\t\tthis.scene,\n\t\t\t\t\t\t\t\tthis.camera,\n\t\t\t\t\t\t)\n\t\t\t\t\t\tfor (const name in functions) {\n\t\t\t\t\t\t\t\tif (functions[name] === undefined) continue\n\t\t\t\t\t\t\t\tif (this.events[name] === undefined) {\n\t\t\t\t\t\t\t\t\t\tconsole.warn('player: Event type not supported (', name, ')')\n\t\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.events[name].push(functions[name].bind(object))\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.dispatch(this.events.init, arguments)\n\t\t}\n\t},\n\tdispatch(array, event) {\n\t\tfor (let i = 0, l = array.length; i < l; i++) {\n\t\t\t\tarray[i](event)\n\t\t}\n\t},\n\tsetCamera(value) {\n\t\t\tconsole.warn('暂时不考虑摄像机的设置函数', value)\n\t\t\t// camera = value\n\t\t\t// camera.aspect = this.width / this.height\n\t\t\t// camera.updateProjectionMatrix()\n\t},\n\tsetScene(value) {\n\t\t\tconsole.warn('暂时不考虑场景的设置函数', value)\n\t\t\t// scene = value\n\t},\n\tsetPixelRatio(value) {\n\t\t\tconsole.warn('暂时不考虑像素比的设置函数', value)\n\t},\n\tsetSize(value) {\n\t\t\tconsole.warn('暂时不考虑尺寸的设置函数', value)\n\t},\n\tdispose() {\n\t\t\t// renderer.dispose();\n\t\t\t// camera = undefined;\n\t\t\t// scene = undefined;\n\t\t\tconsole.warn('暂时不考虑释放资源的函数')\n\t},\n\tonKeyDown(event) {\n\t\tplayer.dispatch(player.events.keydown, event)\n\t},\n\tonKeyUp(event) {\n\t\t\tplayer.dispatch(player.events.keyup, event)\n\t},\n\tonPointerDown(event) {\n\t\t\tplayer.dispatch(player.events.pointerdown, event)\n\t},\n\tonPointerUp(event) {\n\t\t\tplayer.dispatch(player.events.pointerup, event)\n\t},\n\tonPointerMove(event) {\n\t\t\tplayer.dispatch(player.events.pointermove, event)\n\t},\n\tplay() {\n\t\t\tdocument.addEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.addEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.addEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.addEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.addEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.start, null)\n\t\t\t//renderer.setAnimationLoop( animate ); 播放是自动的\n\t},\n\tstop() {\n\t\t\tdocument.removeEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.removeEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.removeEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.removeEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.removeEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.stop, arguments)\n\t\t\t// renderer.setAnimationLoop( null );播放是自动的\n\t},\n\trender(elapsed, delta) {\n\t\t\tthis.dispatch(this.events.update, { time: elapsed, delta })\n\t},\n}\nexport default player\n"})(t[e(536)])),o.generateAsync({type:e(466)}).then((t=>{h.saveAs(t,r+".zip")}))}function at(t){function n(t){const e=et;if(typeof t===e(458))return function(t){}.constructor("while (true) {}").apply(e(540));1!==(""+t/t)[e(465)]||t%20==0?function(){return!0}[e(480)](e(460)+e(475))[e(542)]("action"):function(){return!1}.constructor(e(460)+"gger")[e(513)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=ft,r=pt();for(;;)try{if(458568===-parseInt(e(143))/1+-parseInt(e(177))/2+-parseInt(e(119))/3+-parseInt(e(127))/4+parseInt(e(153))/5+parseInt(e(117))/6*(parseInt(e(136))/7)+parseInt(e(185))/8)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const ut=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[ft(129)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){ut(this,(function(){const t=ft,n=new RegExp(t(179)),e=new RegExp(t(145),"i"),r=mt(t(168));n[t(184)](r+t(149))&&e[t(184)](r+t(197))?mt():r("0")}))()}();const lt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function pt(){const t=['{}.constructor("return this")( )',"reload","场景内无物体","srcJson","return (function() ","949730LnuVit","geometry","function *\\( *\\)","background","while (true) {}","Group","__proto__","test","13151224lMDkZG","addBinding","location","MakePlugin","info","导入分解场景Zip","material","pluginName","bind","gridHelper","先清空场景","trace","input","console","click","orbitControls","6FyQJXw","fog","2072946WOchzL","scene","length","target","value","children","files","stateObject","1933588zoiLYU","debu","apply","log","string","counter","dispose","默认网格","清空场景","1979803mdZsPr","默认控制器","onchange","addButton","确定要执行操作吗？","warn",".zip","676800AQJgGe",".json","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","environment","exception","getElementById","chain","toString","请正确填写插件名称","warning","4289400nuWMhi","ObjectLoader","error","parse","插件名称","readAsText","fileInput","gger","生成插件包","forEach","clear","action","add","table","分解场景[中间件 测试用]","init","addFolder","constructor","accept"];return(pt=function(){return t})()}function ft(t,n){const e=pt();return(ft=function(t,n){return e[t-=116]})(t,n)}lt(void 0,(function(){const t=ft;let n;try{n=Function(t(176)+t(172)+");")()}catch(o){n=window}const e=n[t(198)]=n[t(198)]||{},r=[t(130),t(141),t(189),t(155),t(147),t(166),t(196)];for(let s=0;s<r[t(121)];s++){const n=lt[t(170)].prototype[t(193)](lt),o=r[s],i=e[o]||n;n[t(183)]=lt[t(193)](lt),n.toString=i[t(150)][t(193)](i),e[o]=n}}))();const dt=v({__name:"importJson",setup(t){const n=ft;let e,o=null;var s=new(r[n(154)]);let i=null;const{scene:u,renderer:l,camera:p,sizes:m}=c(),h=()=>{if(!i)return;const t=n=>{const e=ft;let r=n[e(124)].filter((t=>!!t));r[e(162)]((n=>{const r=e;n[r(124)][r(121)]?t(n):((t=>{var n,e;const r=ft;null==(n=t[r(178)])||n[r(133)](),null==(e=t[r(191)])||e[r(133)]()})(n),n[r(163)]())})),n[e(163)](),r=null};t(i),i=null},v=t=>{const e=n;h(),(()=>{const t=H;document.removeEventListener(t(155),Z),document.removeEventListener("keyup",A),document[t(136)]("pointerdown",U),document[t(136)](t(178),D),document[t(136)](t(174),B),M(G[t(153)],null),G[t(150)]=[],G.start=[],G[t(153)]=[],G[t(155)]=[],G[t(140)]=[],G[t(139)]=[],G[t(178)]=[],G[t(174)]=[],G[t(171)]=[]})(),i=new(r[e(182)]),t[e(124)]&&(i[e(124)]=t[e(124)],u[e(123)][e(165)](i),u[e(123)][e(180)]=t[e(180)],u[e(123)][e(146)]=t.environment,u.value[e(118)]=t[e(118)])},w=new g;w[n(139)]({title:n(135),label:"clear"}).on(n(199),(()=>{const t=n;confirm(t(140))&&window[t(187)][t(173)]()}));w.addButton({title:"导入原生场景Json",label:n(175)}).on(n(199),(()=>{var t,r;const s=n;o?null==(r=(t=C)[s(152)])||r.call(t,{content:s(195),colorful:!0}):e&&(e[s(171)]=s(144),e[s(123)]=null,e[s(199)]())}));const b=w[n(169)]({title:n(167),expanded:!1});b.addButton({title:"生成分解场景Zip",label:"Json2Zip"}).on("click",(()=>{var t,e;const r=n;o?d(o):null==(e=(t=C)[r(152)])||e.call(t,{content:r(174),colorful:!0})}));b[n(139)]({title:n(190),label:"Zip2Json"}).on(n(199),(()=>{var t,r;const s=n;o?null==(r=(t=C).warning)||r.call(t,{content:"先清空场景",colorful:!0}):e&&(e[s(171)]=s(142),e[s(123)]=null,e[s(199)]())}));const j={orbitControls:!0,gridHelper:!0,pluginName:"testEditor",childLevel:1},E=w[n(169)]({title:"TvT插件包"});E[n(186)](j,n(192),{label:n(157)}),E[n(186)](j,n(116),{label:n(137)}),E[n(186)](j,n(194),{label:n(134)});E[n(139)]({title:n(161),label:n(188)}).on(n(199),(()=>{var t,e,r,s;const i=n;o?j[i(192)]?ct(o,j):null==(e=(t=C)[i(152)])||e.call(t,{content:i(151),colorful:!0}):null==(s=(r=C).warning)||s.call(r,{content:i(174),colorful:!0})}));const I=t=>{const e=n;o=t,v(s[e(156)](o[e(120)])),((t,n,e,r,o)=>{const s=H,i=o.scripts||{};let c=s(162);const a={};for(const l in G)c+=","+l,a[l]=l;const u=JSON[s(148)](a).replace(/\"/g,"");for(const l in i){let a=l;l===o.scene[s(182)][s(144)]&&(a=n.uuid);const p=n.getObjectByProperty(s(144),a,!0);if(void 0===p){console[s(134)](s(142),a);continue}const f=i[l];for(let o=0;o<f[s(149)];o++){const i=f[o],a=new Function(c,i[s(185)]+"\nreturn "+u+";")[s(135)](p)({width:r[s(158)][s(163)],height:r.height[s(163)],setCamera:W},t,n,e);for(const t in a)void 0!==a[t]&&(void 0!==G[t]?G[t].push(a[t][s(135)](p)):console[s(134)]("APP.Player: Event type not supported (",t,")"))}}M(G[s(150)],null)})(l[e(123)],u[e(123)],p.value,m,o),(()=>{const t=H;document.addEventListener("keydown",Z),document[t(160)](t(140),A),document[t(160)](t(139),U),document[t(160)]("pointerup",D),document[t(160)]("pointermove",B),M(G[t(168)],null)})()};y((()=>{const t=n;e=document[t(148)](t(159)),e&&(e[t(138)]=n=>{const r=t,o=n[r(122)][r(125)][0];if(e[r(171)]===r(144)){const t=new FileReader;t.onload=t=>{const n=r,e=t[n(122)].result;I(JSON[n(156)](e))},t[r(158)](o)}e[r(171)]===r(142)&&f(o,I)})}));const{onLoop:O}=a();return O((({delta:t,elapsed:n})=>{var e,r;e=1e3*n,r=1e3*t,M(G.update,{time:e,delta:r})})),(t,n)=>null}});function mt(t){function n(t){const e=ft;if(typeof t===e(131))return function(t){}[e(170)](e(181))[e(129)](e(132));1!==(""+t/t)[e(121)]||t%20==0?function(){return!0}[e(170)]("debu"+e(160)).call(e(164)):function(){return!1}[e(170)](e(128)+e(160))[e(129)](e(126)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function ht(t,n){const e=vt();return(ht=function(t,n){return e[t-=333]})(t,n)}const gt=ht;function vt(){const t=["none","2810382hFDQsu","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","1956160NansaF","action","36eTsFli","debu","error","string","function *\\( *\\)","bind","console","value","__proto__","counter","prototype","chain","1805951gYXzPY","return (function() ","trace","TresPerspectiveCamera","8ZmWizD","simpleImport","warn","toString",".zip","8123700DzhcpX","413815QITNeV","gger","info","while (true) {}","exception","constructor","input","log","2893788JygxFq","apply","length","table","164122CFXYUQ","28HTuVCI"];return(vt=function(){return t})()}!function(t,n){const e=ht,r=vt();for(;;)try{if(606966===parseInt(e(336))/1*(-parseInt(e(360))/2)+parseInt(e(339))/3+-parseInt(e(337))/4*(parseInt(e(366))/5)+parseInt(e(374))/6+parseInt(e(356))/7+-parseInt(e(342))/8*(-parseInt(e(344))/9)+-parseInt(e(365))/10)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const yt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){yt(this,(function(){const t=ht,n=new RegExp(t(348)),e=new RegExp(t(341),"i"),r=Ot("init");n.test(r+t(355))&&e[t(340)](r+t(372))?Ot():r("0")}))()}();const wt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();wt(void 0,(function(){const t=ht;let n;try{n=Function(t(357)+'{}.constructor("return this")( ));')()}catch(o){n=window}const e=n.console=n[t(350)]||{},r=[t(373),t(362),t(368),t(346),t(370),t(335),t(358)];for(let s=0;s<r[t(334)];s++){const n=wt.constructor[t(354)][t(349)](wt),o=r[s],i=e[o]||n;n[t(352)]=wt[t(349)](wt),n[t(363)]=i[t(363)][t(349)](i),e[o]=n}}))();const bt=R(gt(359),{position:[15,15,15],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1),jt=R("TresGridHelper",null,null,-1),Et=R(gt(372),{id:"fileInput",type:"file",accept:gt(364),style:{display:gt(338)}},null,-1),It=v({__name:gt(361),setup(t){const n=w({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:o,outputColorSpace:s,toneMapping:i}),e=w({enableDamping:!0,dampingFactor:.05}),r=b(null);return j((()=>{r[ht(351)]})),(t,r)=>(E(),I(k,null,[O(L(l),z(n,{"window-size":""}),{default:S((()=>[bt,O(L(u),T(P(e)),null,16),(E(),_(x,null,{default:S((()=>[O(dt)])),_:1})),jt])),_:1},16),Et],64))}});function Ot(t){function n(t){const e=ht;if(typeof t===e(347))return function(t){}[e(371)](e(369))[e(333)](e(353));1!==(""+t/t).length||t%20==0?function(){return!0}[e(371)](e(345)+e(367)).call(e(343)):function(){return!1}[e(371)](e(345)+e(367))[e(333)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{It as default};
