import{_ as e}from"./@fesjs.uDzWZsaX1758259351508.js";import"./Resource.DDopQ4j61758259351508.js";/* empty css                                                                             */import{l as t}from"./bubbleLoading.DePR09OY1758259351508.js";import{J as a,ba as o,ad as l,B as s,c as r,l as n,n as i,d as u,bV as c,C as m,u as p,_ as d,ac as v,cp as f,K as h,O as g,cq as x,cr as y,cs as w,a as j,r as _,ct as b}from"./three.CtgP63ME1758259351508.js";import"./three-mesh-ui.module.t9YwAzlx1758259351508.js";import"./global.DmBaWnKd1758259351508.js";/* empty css                                                              */import{P}from"./tweakpane.C0HtAJSg1758259351508.js";import{Q as z,m as S,Z as M,e as C,k as T}from"./@tresjs.CywMBpUh1758259351508.js";import{q as B,s as A,d as F}from"./@vueuse.C5HLo59K1758259351508.js";import{d as E,w as R,v as U,b as V,G as D,o as L,L as k,u as I,aa as Y,e as X,a2 as q,r as N,h as G,j as J,I as O,f as W,a5 as H,a7 as K,a8 as Z,F as $}from"./@vue.pEDXJ_3Z1758259351508.js";import{l as Q}from"./util.BTRj-dGq1758259351508.js";import"./vue-router.BT0ZZbwZ1758259351508.js";import"./lodash-es.C7pWAXPe1758259351508.js";import"./pinia.C_K98KJs1758259351508.js";import"./@qlin.q6OWdsQV1758259351508.js";import"./@babel.BPq7uOAK1758259351508.js";import"./@floating-ui.BFjFSAYt1758259351508.js";import"./@juggle.CcBCnTIR1758259351508.js";import"./utils.BQV0fxbj1758259351508.js";import"./color.BPoHtV0H1758259351508.js";import"./@amap.CGUF9xH41758259351508.js";import"./color-string.P-yvt9W21758259351508.js";import"./color-name.BQ5IbGbl1758259351508.js";import"./simple-swizzle.Xn8N6iLa1758259351508.js";import"./is-arrayish.CLsR9Wfx1758259351508.js";import"./color-convert.Btfsg-JE1758259351508.js";import"./lodash.Bo0I6nx61758259351508.js";import"./postprocessing.DJgHFhS91758259351508.js";const ee=E({__name:"ScrollControls",props:{pages:{default:4},distance:{default:4},smoothScroll:{default:.1},horizontal:{type:Boolean,default:!1},htmlScroll:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{expose:t,emit:a}){const o=e,l=a,{logWarning:s}=z();o.smoothScroll<0&&s("SmoothControl must be greater than zero"),o.pages<0&&s("Pages must be greater than zero");const{camera:r,controls:n,renderer:i,invalidate:u}=S();R(o,(()=>{u()}));const c=U(),m=document.createElement("div"),{y:p}=B(),{x:d,y:v,isScrolling:f}=A(m),{height:h,width:g}=F();let x=0;const y=V(!1),w=V(0),j=V(0),_=V(0),b=o.horizontal?"x":"y",P=R(r,(e=>{y.value?P():(x=o.horizontal?e?.position.x||0:e?.position.y||0,y.value=!0)}),{immediate:!0});R(f,(e=>{n.value&&(n.value.enabled=!e)}),{immediate:!0}),R(p,(e=>{(f.value||o.htmlScroll)&&(j.value=e/h.value/(_.value/h.value-1),w.value=-1*j.value,l("update:modelValue",j.value))})),R(v,(e=>{j.value=e/h.value/(_.value/h.value),w.value=-1*j.value,l("update:modelValue",j.value)})),R(d,(e=>{j.value=e/g.value/(_.value/g.value-1),w.value=+j.value,l("update:modelValue",j.value)})),R(i,(e=>{const t=e?.domElement;if(o.htmlScroll&&e?.domElement)t?.style.width&&t?.style.position&&t?.style.top&&t?.style.left&&(t.style.width="100%",t.style.position="fixed",t.style.top="0",t.style.left="0"),_.value=document.body.scrollHeight;else{const a=document.createElement("div"),l=document.createElement("div");m.style[o.horizontal?"overflowX":"overflowY"]="auto",m.style[o.horizontal?"overflowY":"overflowX"]="hidden",m.style.position="absolute",m.style.width="100%",m.style.height=" 100%",m.style.top="0",m.style.left="0",m.classList.add("scrollContainer"),a.style.position="sticky",a.style.top="0px",a.style.left="0px",a.style.width="100%",a.style.height="100%",a.style.overflow="hidden",m.appendChild(a),l.style.height=o.horizontal?"100%":h.value*o.pages+"px",l.style.width=o.horizontal?g.value*o.pages+"px":"100vw",l.style.pointerEvents="none",t.style.position="fixed",t.style.zIndex="0",t?.style.width&&(t.style.width="100%"),m.appendChild(l),e?.domElement.parentNode&&(e.domElement.parentNode.style.position="relative"),e?.domElement?.parentNode?.appendChild(m),_.value=o.horizontal?g.value*o.pages:h.value*o.pages}}),{immediate:!0});const{onBeforeRender:C}=M();return C((({invalidate:e})=>{if(r.value?.position){const t=(w.value*o.distance-r.value.position[b]+x)*o.smoothScroll;r.value.position[b]+=t,c.value.children.length>0&&(c.value.position[b]+=t),e()}})),t({instance:c}),(e,t)=>(L(),D("TresGroup",{ref_key:"wrapperRef",ref:c},[k(e.$slots,"default")],512))}});const te=e=>{let t=e.attributes.position.count,s=Math.ceil(Math.sqrt(t)),r=Math.ceil(t/s),n=new Float32Array(s*r*4);!function(e){for(let t=Math.floor(e.length/3)-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));for(let o=0;o<3;o++){let l=e[3*t+o];e[3*t+o]=e[3*a+o],e[3*a+o]=l}}}(e.attributes.position.array);for(let a=0;a<t;a++){const t=e.attributes.position.array[3*a+0],o=e.attributes.position.array[3*a+1],l=e.attributes.position.array[3*a+2],s=0;n[4*a+0]=t,n[4*a+1]=o,n[4*a+2]=l,n[4*a+3]=s}let i=new a(n,s,r,o,l);return i.needsUpdate=!0,i},ae=()=>{const e=new i({uniforms:{uTextureA:{value:null},uTextureB:{value:null},uTime:{value:0},uScroll:{value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUv = uv;\n}",fragmentShader:"uniform sampler2D uTextureA;\nuniform sampler2D uTextureB;\nprecision mediump float; \nuniform float uTime;\nuniform float uScroll;\nvarying vec2 vUv;\n\nmat3 rotationMatrix3(vec3 axis, float angle) {\n  axis = normalize(axis);\n  float s = sin(angle);\n  float c = cos(angle);\n  float oc = 1. - c;\n\n  return mat3(oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s,\n              oc * axis.z * axis.x + axis.y * s,\n              oc * axis.x * axis.y + axis.z * s, oc * axis.y * axis.y + c,\n              oc * axis.y * axis.z - axis.x * s,\n              oc * axis.z * axis.x - axis.y * s,\n              oc * axis.y * axis.z + axis.x * s, oc * axis.z * axis.z + c);\n}\n\nvoid main() {\n  vec3 textureA = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureA, vUv).xyz;\n  \n\n  vec3 textureB = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureB, vUv).xyz;\n  \n\n  float t = uScroll;\n  vec3 pos = mix(textureA, textureB, t);\n\n  gl_FragColor = vec4(pos, 1.);\n}"}),t=new s;return t.setAttribute("position",new r(new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]),3)),t.setAttribute("uv",new r(new Float32Array([0,1,1,1,1,0,0,1,1,0,0,0]),2)),new n(t,e)};const oe=["object"],le=E({__name:"particalMesh",props:{progress:{default:0},width:{default:256},height:{default:256}},setup(e,{expose:t}){const a=e;let o=((e,t)=>{const a=e*t;let o=new Float32Array(3*a);for(let s=0;s<a;s++){let a=3*s;o[a+0]=s%e/e,o[a+1]=s/e/t}const l=new s;return l.setAttribute("position",new r(o,3)),new u(l,new i({uniforms:{uPositions:{value:null},uSize:{value:12},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uColor:{value:new m("#ffaa00")}},vertexShader:"uniform sampler2D\n    uPositions; \nuniform float uSize;\nuniform float uPixelRatio;\nvarying vec3 vPos;\nvarying vec2 vUv;\nvoid main() {\n  vec3 pos = texture2D(uPositions, position.xy).xyz;\n\n  float customSize = uSize;\n\n  vec4 modelPosition = modelMatrix * vec4(pos, 1.0);\n  vec4 viewPosition = viewMatrix * modelPosition;\n  vec4 projectionPosition = projectionMatrix * viewPosition;\n\n  gl_Position = projectionPosition;\n  gl_PointSize = customSize * uPixelRatio;\n  gl_PointSize *= (1.0 / -viewPosition.z);\n\n  vPos = pos;\n}",fragmentShader:"precision mediump float;\nvarying vec3 vPos;\nuniform vec3 uColor; \nvoid main() {\n\n  float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n  float strength = 0.05 / distanceToCenter - 0.1;\n\n  \n\n  gl_FragColor = vec4(uColor, strength * length(vPos));\n}",transparent:!0,depthWrite:!1,blending:c}))})(a.width,a.height);return t({particles:o}),(e,t)=>(L(),D("primitive",{object:I(o)},null,8,oe))}}),se=E({__name:"particalFBO",props:{progress:{default:0},width:{default:256},height:{default:256},color:{default:"#ffaa00"}},async setup(e){let t,a;const s=e,r=V(),i=new p(s.width,s.height,{minFilter:v,magFilter:v,generateMipmaps:!1,colorSpace:d,depthBuffer:!1,stencilBuffer:!1,format:o,type:l}),u=e=>{const t=[];return e.traverse((e=>{e instanceof n&&(e.geometry.deleteAttribute("uv"),e.geometry.deleteAttribute("normal"),e.geometry.deleteAttribute("tangent"),t.push(e.geometry))})),x(t)},c=new f,m=u(([t,a]=Y((()=>Q("https://opensource.cdn.icegl.cn/model/medical/brainparts.OBJ",c))),t=await t,a(),t));m.scale(.01,.01,.01);const y=te(m),w=u(([t,a]=Y((()=>T("https://opensource.cdn.icegl.cn/model/eCommerce/guanYu.glb",{draco:!0,decoderPath:"./draco/"}))),t=await t,a(),t).scene.children[0]);w.rotateX(Math.PI/2),w.translate(0,-.9,0);const j=te(w),_=u(([t,a]=Y((()=>T("https://opensource.cdn.icegl.cn/model/industry4/modelDraco.glb",{draco:!0,decoderPath:"./draco/"}))),t=await t,a(),t).scene.children[0]);_.rotateX(-Math.PI/2),_.rotateY(Math.PI/3),_.translate(0,0,0);const b=te(_),P=ae(),z=new h,M=new g(-1,1,1,-1,1/Math.pow(2,53),1);z.add(P);const{onBeforeLoop:B}=C(),{camera:A,renderer:F}=S();return B((({elapsed:e})=>{F.value&&A.value&&r.value&&(F.value.setRenderTarget(i),F.value.clear(),F.value.render(z,M),F.value.setRenderTarget(null),s.progress<.5?(P.material.uniforms.uTextureA.value=j,P.material.uniforms.uTextureB.value=y,P.material.uniforms.uScroll.value=2*s.progress):(P.material.uniforms.uTextureA.value=y,P.material.uniforms.uTextureB.value=b,P.material.uniforms.uScroll.value=2*(s.progress-.5)),P.material.uniforms.uTime.value=e,r.value.particles.material.uniforms.uPositions.value=i.texture,r.value.particles.material.uniforms.uColor.value.setStyle(s.color))})),(e,t)=>(L(),X(le,{ref_key:"pMesh",ref:r,progress:e.progress},null,8,["progress"]))}}),re=E({__name:"particalPass",props:{use:{type:Boolean,default:!0}},setup(e){const t=e,{camera:a,renderer:l,scene:s,sizes:r}=S(),n=0,i=.472,u=1.61;let c=null;q((()=>{r.width.value&&((e,t,a,l,s)=>{const r=new y(e,t),m=new w(new j(l,s),i,u,n),v=new p(l,s,{generateMipmaps:!1,minFilter:_,magFilter:_,format:o,colorSpace:d,samples:0});c=new b(a,v),c.addPass(r),c.addPass(m)})(s.value,a.value,l.value,r.width.value,r.height.value)}));const{onLoop:m}=C();return m((()=>{t.use?c&&c.render():l.value&&a.value&&l.value.render(s.value,a.value)})),(e,t)=>null}}),ne=e(E({__name:"scrollPartical",setup(e){const a=V(0);q((()=>{console.log("jaime ~ progress:",a.value)}));const o={clearColor:"#000",outputColorSpace:d,windowSize:!0,renderMode:"manual",powerPreference:"high-performance",antialias:!1,alpha:!1,useLegacyLights:!1,physicallyCorrectLights:!0},l=N({pass:!1,color:"#ffaa00"}),s=new P({title:"参数",expanded:!0});return s.addBinding(l,"pass",{label:"后处理"}),s.addBinding(l,"color",{label:"颜色"}),(e,s)=>{const r=G("TresCanvas");return L(),D($,null,[J(I(t),{styleNum:4}),J(r,K(Z(o)),{default:W((()=>[s[1]||(s[1]=O("TresPerspectiveCamera",{position:[0,0,-4],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),J(re,{use:l.pass},null,8,["use"]),J(ee,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e),distance:10,"smooth-scroll":.1,htmlScroll:""},{default:W((()=>[(L(),X(H,null,{default:W((()=>[J(se,{progress:a.value,color:l.color},null,8,["progress","color"])])),_:1}))])),_:1},8,["modelValue"])])),_:1},16),s[2]||(s[2]=O("main",null,[O("section",null,[O("h1",null,"关羽 - GuanYu")]),O("section",null,[O("h1",{style:{"margin-left":"-11em","margin-bottom":"-10em"}},"大脑 - Brain")]),O("section",null,[O("h1",{style:{"margin-left":"11em","margin-bottom":"-10em"}},"设备 - Device")])],-1))],64)}}}),[["__scopeId","data-v-18b1351b"]]);export{ne as default};
