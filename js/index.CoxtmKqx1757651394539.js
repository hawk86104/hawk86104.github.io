import{M as e}from"./mqttTvt.CNbIBl0E1757651394539.js";import{_ as l}from"./@fesjs.Bp6K4IrA1757651394539.js";import{u as a,r as s,s as t,N as u,t as o,v as n,i as r,B as i,w as v,x as d,l as p,p as c}from"./naive-ui.Cycei-T41757651394539.js";import{r as m,b as f,V as j,G as b,o as _,j as h,f as w,u as g,x as y,F as T,W as k,e as x,M}from"./@vue.pEDXJ_3Z1757651394539.js";import"./events.CafAsz9H1757651394539.js";import"./mqtt.DxgoMxFx1757651394539.js";import"./vue-router.Dbyy8kqJ1757651394539.js";import"./lodash-es.C7pWAXPe1757651394539.js";import"./pinia.ByleU3mk1757651394539.js";import"./@qlin.q6OWdsQV1757651394539.js";import"./@babel.BPq7uOAK1757651394539.js";import"./@floating-ui.BFjFSAYt1757651394539.js";import"./@juggle.CcBCnTIR1757651394539.js";import"./date-fns.DXfinlbv1757651394539.js";import"./@css-render.D32GFB8L1757651394539.js";import"./css-render.C_DgdThB1757651394539.js";import"./@emotion.DFFAhID71757651394539.js";import"./seemly.BQc18TWx1757651394539.js";import"./vooks.CVZXqzMp1757651394539.js";import"./evtd.DVZ1YWiB1757651394539.js";import"./vueuc.tR7K0pVD1757651394539.js";import"./vdirs.O3k-gxw11757651394539.js";import"./treemate.CnlbqGMX1757651394539.js";import"./date-fns-tz.DJ78eYY01757651394539.js";import"./async-validator.D9c8kbAV1757651394539.js";const U={class:"w-full",style:{"background-color":"#ffffff"}},q=l({__name:"MqttTesterUI",setup(l){const c=a(),q=m({host:"a5183db3.ala.asia-southeast1.emqxsl.com",port:8084,protocol:"wss",clientId:`tvt-test-client-${Math.random().toString(16).slice(2,8)}`,username:"tvt.js",password:"test",topic:"tvtDevices/#"}),I=f("tvtDevices/uiDemo"),C=f('{ "hello": "world" }'),Q=f(null),$=f(!1),S=f([]),D=f(!1);function N(){Q.value&&(Q.value.removeAllListeners(),Q.value.disconnect(),Q.value=null,$.value=!1)}function J(){N(),D.value=!0,Q.value=new e(q),Q.value.on("connected",(()=>{$.value=!0,D.value=!1,c.success("MQTT 连接成功")})),Q.value.on("close",(()=>{$.value=!1,D.value=!1,c.warning("MQTT 连接关闭")})),Q.value.on("error",(e=>{D.value=!1,console.error(e),c.error(`MQTT 错误: ${e.message}`)})),Q.value.on("message",((e,l)=>{S.value.push(`[${e}] ${JSON.stringify(l)}`),S.value.length>100&&S.value.shift()})),Q.value.connect()}const O=f(new Set);function A(){if(Q.value)for(const e of O.value)Q.value.unsubscribe(e);O.value.clear(),N(),c.success("已断开连接")}function z(){if(!Q.value||!$.value)return void c.warning("尚未连接 MQTT");const e=q.topic?.trim();e?O.value.has(e)?c.info(`已订阅该主题：${e}`):(Q.value.subscribe(e),O.value.add(e),c.success(`订阅成功：${e}`)):c.warning("请输入订阅主题")}function B(){try{const e=JSON.parse(C.value);Q.value.publish(I.value,e),c.info("已发送消息")}catch(e){c.error("JSON 格式错误")}}return j((()=>{A()})),(e,l)=>(_(),b("div",U,[h(g(p),{title:"MQTT 调试面板",class:"max-w-4xl mx-auto"},{default:w((()=>[h(g(s),{model:q,"label-width":"100"},{default:w((()=>[h(g(t),{label:"地址"},{default:w((()=>[h(g(u),{value:q.host,"onUpdate:value":l[0]||(l[0]=e=>q.host=e),placeholder:"例如: broker.hivemq.com"},null,8,["value"])])),_:1}),h(g(t),{label:"端口"},{default:w((()=>[h(g(o),{value:q.port,"onUpdate:value":l[1]||(l[1]=e=>q.port=e),min:1},null,8,["value"]),h(g(n),{style:{"margin-left":"10px"},type:"info"},{default:w((()=>l[8]||(l[8]=[y("浏览器端只支持：wws方式 的 mqtt")]))),_:1})])),_:1}),h(g(t),{label:"Client ID"},{default:w((()=>[h(g(u),{value:q.clientId,"onUpdate:value":l[2]||(l[2]=e=>q.clientId=e),placeholder:"随机生成也可"},null,8,["value"])])),_:1}),h(g(t),{label:"用户名"},{default:w((()=>[h(g(u),{value:q.username,"onUpdate:value":l[3]||(l[3]=e=>q.username=e)},null,8,["value"])])),_:1}),h(g(t),{label:"密码"},{default:w((()=>[h(g(u),{value:q.password,"onUpdate:value":l[4]||(l[4]=e=>q.password=e)},null,8,["value"])])),_:1}),h(g(t),{label:"订阅主题"},{default:w((()=>[h(g(u),{value:q.topic,"onUpdate:value":l[5]||(l[5]=e=>q.topic=e),placeholder:"例如: tvt/demo"},null,8,["value"])])),_:1}),h(g(r),null,{default:w((()=>[h(g(i),{type:"primary",disabled:$.value||D.value,loading:D.value,onClick:J},{default:w((()=>l[9]||(l[9]=[y("连接")]))),_:1},8,["disabled","loading"]),h(g(i),{type:"warning",disabled:!$.value,onClick:A},{default:w((()=>l[10]||(l[10]=[y("断开")]))),_:1},8,["disabled"]),h(g(i),{type:"success",disabled:!$.value,onClick:z},{default:w((()=>l[11]||(l[11]=[y("订阅")]))),_:1},8,["disabled"])])),_:1})])),_:1},8,["model"]),h(g(v),null,{default:w((()=>l[12]||(l[12]=[y("已订阅主题")]))),_:1}),h(g(r),null,{default:w((()=>[(_(!0),b(T,null,k(Array.from(O.value),(e=>(_(),x(g(n),{key:e,type:"info",round:""},{default:w((()=>[y(M(e),1)])),_:2},1024)))),128))])),_:1}),h(g(v),null,{default:w((()=>l[13]||(l[13]=[y("发送消息 [主题/json消息]")]))),_:1}),h(g(u),{value:I.value,"onUpdate:value":l[6]||(l[6]=e=>I.value=e),placeholder:"主题",class:"mb-2"},null,8,["value"]),h(g(u),{value:C.value,"onUpdate:value":l[7]||(l[7]=e=>C.value=e),type:"textarea",placeholder:'{ "key": "value" }',rows:4},null,8,["value"]),h(g(i),{type:"info",class:"mt-2",disabled:!$.value,onClick:B},{default:w((()=>l[14]||(l[14]=[y("发送")]))),_:1},8,["disabled"]),h(g(v),null,{default:w((()=>l[15]||(l[15]=[y("收到的消息")]))),_:1}),h(g(d),{log:S.value.join("\n"),rows:12},null,8,["log"])])),_:1})]))}},[["__scopeId","data-v-0f64174d"]]),I={__name:"index",setup:e=>(e,l)=>(_(),x(g(c),null,{default:w((()=>[h(q)])),_:1}))};export{I as default};
