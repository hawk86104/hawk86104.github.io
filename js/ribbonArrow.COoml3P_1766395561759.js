import{_ as e}from"./@tresjs.BAA1xUmy1766395561759.js";import{w as t,G as r,o,I as a,u as n}from"./@vue.BxPWGdWw1766395561759.js";import{a6 as l,b as i,d as s,i as d,j as h,cG as c,r as u,aE as f,aG as p}from"./three.F31Lz30M1766395561759.js";const w=["geometry"],g=["color","transparent","opacity","side"],m=["geometry"],x=["map","side"],b={__name:"ribbonArrow",props:{length:{default:20},width:{default:1},bendPosition:{default:.5},curvature:{default:.4},backgroundColor:{default:"#00aaff"},backgroundAlpha:{default:.25},segments:{default:240},arrowColor:{default:"#ffffff"},arrowWidth:{default:.3},arrowHeight:{default:.5},arrowSpacing:{default:.5},arrowOffset:{default:0},arrowLineWidth:{default:2},arrowStyle:{default:"chevron"},speed:{default:.5},pixelWorldScale:{default:.03}},setup(b){const T=b,y=()=>{const e=Math.max(1e-4,T.length),t=i.clamp(T.bendPosition,0,1),r=e*t,o=e-r,a=Math.min(r,o),n=T.curvature>0&&t>0&&t<1?Math.min(.9*a,.2*e*T.curvature):0,l=Math.max(0,r-n),s=n>0?Math.PI*n/2:0;return{fullLen:l+s+Math.max(0,o-n),L1val:r,radius:n,len1:l,arcLen:s}};let{fullLen:P,L1val:M,radius:W,len1:v,arcLen:S}=y();const L=e=>{if((e=i.clamp(e,0,P))<=v)return new s(e,0);if(e<=v+S&&W>0){const t=(e-v)/S,r=-Math.PI/2+t*(Math.PI/2),o=W;return new s(M-W+Math.cos(r)*W,o+Math.sin(r)*W)}return new s(M,W+(e-(v+S)))};let k=[],A=[],C=0;const B=()=>{k=[],A=[];const e=Math.max(8,Math.floor(T.segments));let t=L(0),r=0;k.push(t),A.push(0),C=0;for(let o=1;o<=e;o++){const a=L(P*(o/e));r+=a.clone().sub(t).length(),k.push(a),A.push(r),t=a}C=r};B();let j=null;const F=()=>{const e=2*k.length,t=new Float32Array(3*e),r=new Float32Array(3*e),o=new Float32Array(2*e),a=[],n=T.width/2;function l(e){return 0===e?k[1].clone().sub(k[0]).normalize():e===k.length-1?k[e].clone().sub(k[e-1]).normalize():k[e+1].clone().sub(k[e-1]).normalize()}for(let i=0;i<k.length;i++){const e=k[i],a=l(i),d=new s(-a.y,a.x).normalize(),h=e.x-d.x*n,c=e.y-d.y*n,u=e.x+d.x*n,f=e.y+d.y*n;t[3*(2*i+0)+0]=h,t[3*(2*i+0)+1]=c,t[3*(2*i+0)+2]=0,t[3*(2*i+1)+0]=u,t[3*(2*i+1)+1]=f,t[3*(2*i+1)+2]=0,r[3*(2*i+0)+0]=0,r[3*(2*i+0)+1]=0,r[3*(2*i+0)+2]=1,r[3*(2*i+1)+0]=0,r[3*(2*i+1)+1]=0,r[3*(2*i+1)+2]=1;const p=A[i]/(T.arrowWidth+T.arrowSpacing);o[2*(2*i+0)+0]=p,o[2*(2*i+0)+1]=0,o[2*(2*i+1)+0]=p,o[2*(2*i+1)+1]=1}for(let i=0;i<k.length-1;i++){const e=2*i,t=2*i+1,r=2*(i+1),o=2*(i+1)+1;a.push(e,r,t),a.push(t,r,o)}j&&j.dispose(),j=new d,j.setAttribute("position",new h(t,3)),j.setAttribute("normal",new h(r,3)),j.setAttribute("uv",new h(o,2)),j.setIndex(a),j.computeBoundingBox(),j.computeBoundingSphere()};F();let H=null;const I=()=>{H&&H.dispose(),H=(({arrowWidthPx:e,arrowHeightPx:t,spacingPx:r,style:o,color:a,lineWidth:n,offset:l})=>{const i=r,s=e+2*i,d=t+2*i,h=Math.max(1,window.devicePixelRatio||1),w=document.createElement("canvas");w.width=s*h,w.height=d*h,w.style.width=s+"px",w.style.height=d+"px";const g=w.getContext("2d");g.scale(h,h),g.clearRect(0,0,s,d),g.strokeStyle=a,g.fillStyle=a,g.lineWidth=n,g.lineJoin="round",g.lineCap="round";const m=i,x=e,b=t,y=m+x/2,P=i+b/2+l;"chevron"===o?(g.beginPath(),g.moveTo(m,P-b/2),g.lineTo(m+x,P),g.lineTo(m,P+b/2),g.stroke()):"double"===o?(g.beginPath(),g.moveTo(m,P-b/2),g.lineTo(m+.7*x,P),g.lineTo(m,P+b/2),g.stroke(),g.beginPath(),g.moveTo(m+.8*x,P-b/2),g.lineTo(m+1.5*x,P),g.lineTo(m+.8*x,P+b/2),g.stroke()):"triangle"===o?(g.beginPath(),g.moveTo(m,P-b/2),g.lineTo(m+x,P),g.lineTo(m,P+b/2),g.closePath(),g.fill()):"diamond"===o?(g.beginPath(),g.moveTo(y,P-b/2),g.lineTo(y+x/2,P),g.lineTo(y,P+b/2),g.lineTo(y-x/2,P),g.closePath(),g.fill()):(g.beginPath(),g.moveTo(m,P-b/2),g.lineTo(m+x,P),g.lineTo(m,P+b/2),g.stroke());const M=new c(w);return M.generateMipmaps=!1,M.minFilter=u,M.magFilter=u,M.wrapS=f,M.wrapT=p,M.repeat.set(C/(T.arrowWidth+T.arrowSpacing),1),M.needsUpdate=!0,M})({arrowWidthPx:T.arrowWidth/T.pixelWorldScale,arrowHeightPx:T.arrowHeight/T.pixelWorldScale,spacingPx:T.arrowSpacing/T.pixelWorldScale,style:T.arrowStyle,color:T.arrowColor,lineWidth:T.arrowLineWidth,offset:T.arrowOffset})};I(),t(()=>[T.length,T.width,T.bendPosition,T.curvature,T.segments,T.arrowColor,T.arrowWidth,T.arrowHeight,T.arrowSpacing,T.arrowOffset,T.arrowLineWidth,T.arrowStyle,T.pixelWorldScale],()=>{({fullLen:P,L1val:M,radius:W,len1:v,arcLen:S}=y()),B(),F(),I()});const{onBeforeRender:z}=e();return z(()=>{if(H){const e=.01*T.speed;H.offset.x=(H.offset.x-e)%1,H.offset.x>1&&(H.offset.x-=1),H.needsUpdate=!0}}),(e,t)=>(o(),r("TresGroup",null,[a("TresMesh",{geometry:n(j)},[a("TresMeshBasicMaterial",{color:b.backgroundColor,transparent:b.backgroundAlpha<1,opacity:b.backgroundAlpha,side:l,depthWrite:""},null,8,g)],8,w),a("TresMesh",{geometry:n(j)},[a("TresMeshBasicMaterial",{map:n(H),transparent:"",side:l,depthWrite:"",renderOrder:1},null,8,x)],8,m)]))}};export{b as _};
