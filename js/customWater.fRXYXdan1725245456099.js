import{a6 as t,C as e,Z as n,a3 as r,a9 as a}from"./three.KG2-8r0_1725245456099.js";import{$ as s,T as o,d as i,x as l}from"./@tresjs.j5vdYITq1725245456099.js";import{a as u}from"./index.qrmSQE1-1725245456099.js";import"./index.Buxaly2d1725245456099.js";import{C as c}from"./three-custom-shader-material.1acQuOMU1725245456099.js";import"./object-hash.ycpyO56T1725245456099.js";import"./@amap.jyJWu-u51725245456099.js";import"./glsl-tokenizer.FsI169p21725245456099.js";import{p}from"./gl-noise.BrVtymbx1725245456099.js";import{d as f,b as g,a1 as h,w as m,o as v,D as d,J as _,j as b,u as w,r as M,f as j,g as y,aj as x,ak as C,m as I,al as z}from"./@vue.Q1VpS3901725245456099.js";import{P as T}from"./tweakpane.yHWGBmom1725245456099.js";import{_ as S}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.0buMYIOH1725245456099.js";import"./@vueuse.whMtq_7M1725245456099.js";import"./three-stdlib.7palOSci1725245456099.js";import"./@pmndrs.Ip0yUZ_e1725245456099.js";import"./reflectorDiffuse.vue_vue_type_script_setup_true_lang.8gYs8-ac1725245456099.js";import"./all.three.SEgg-d4C1725245456099.js";import"./oimophysics.x0jH7fze1725245456099.js";import"./reflectorDUDV.vue_vue_type_script_setup_true_lang.o-V9XzAX1725245456099.js";import"./reflectorShaderMesh.vue_vue_type_script_setup_true_lang.4IunBFYl1725245456099.js";import"./whiteFloorMesh.vue_vue_type_script_setup_true_lang.2Ls4HXo91725245456099.js";import"./videoFloor.vue_vue_type_script_setup_true_lang.Z9jLXgNg1725245456099.js";import"./glsl-token-string.rmbt9Jq91725245456099.js";import"./glsl-token-functions.66NgBKOU1725245456099.js";import"./jszip.Bn2AE-kY1725245456099.js";const k=G;function H(){const t=["action","debu","trace","flatShading","860250UKKieL","test","customWaterMesh","needsUpdate","call","12CHCIJM","8811yQSkjS","apply","dispose","vertex","bind","7568nMpomo","function *\\( *\\)","fragmentShader","gger","info","toString","18138835eVwEbj","material","brightness","Flatshading","length","rotation-x","6874VsgCra","error","args","value","warn","Color","string","height","9CjVEWF","convertLinearToSRGB","__proto__","1589652Hjqbtc","DoubleSide","input","return (function() ","#b3ffff","waterColor",'{}.constructor("return this")( )',"constructor","baseMaterial","side","console","waterHighlight","vertexShader","45NlWyrp","TresBoxGeometry","1660FJvhEG","MeshPhysicalMaterial","\nvarying float vHeight;\nuniform vec3 waterColor;\nuniform vec3 waterHighlight;\nuniform float offset;\nuniform float contrast;\nuniform float brightness;\n\nvec3 calcColor() {\n  float mask = (pow(vHeight, 2.) - offset) * contrast;\n  vec3 diffuseColor = mix(waterColor, waterHighlight, mask);\n  diffuseColor *= brightness;\n  return diffuseColor;\n}\n\nvoid main() {\n  csm_DiffuseColor = vec4(calcColor(), 1.0);\n}\n\t","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","fragment","707234sYSlnA","1197483IEzmVB","tmRef"];return(H=function(){return t})()}!function(t,e){const n=G,r=H();for(;;)try{if(766709===parseInt(n(350))/1+parseInt(n(349))/2+parseInt(n(325))/3*(-parseInt(n(328))/4)+-parseInt(n(341))/5*(-parseInt(n(356))/6)+-parseInt(n(379))/7*(-parseInt(n(367))/8)+parseInt(n(362))/9*(-parseInt(n(343))/10)+parseInt(n(373))/11*(-parseInt(n(361))/12))break;r.push(r.shift())}catch(a){r.push(r.shift())}}();const W=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[G(363)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();!function(){W(this,(function(){const t=G,e=new RegExp(t(368)),n=new RegExp(t(347),"i"),r=D("init");e.test(r+t(346))&&n[t(357)](r+t(330))?D():r("0")}))()}();const B=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[G(363)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function G(t,e){const n=H();return(G=function(t,e){return n[t-=320]})(t,e)}B(void 0,(function(){const t=G;let e;try{e=Function(t(331)+t(334)+");")()}catch(a){e=window}const n=e.console=e[t(338)]||{},r=["log",t(321),t(371),t(380),"exception","table",t(354)];for(let s=0;s<r[t(377)];s++){const e=B.constructor.prototype.bind(B),a=r[s],o=n[a]||e;e[t(327)]=B[t(366)](B),e[t(372)]=o[t(372)][t(366)](o),n[a]=e}}))();const P=[k(378)],O=[k(381)],F=f({__name:k(358),props:{height:{default:.2},Flatshading:{type:Boolean,default:!1},waterColor:{default:"#52a7f7"},waterHighlight:{default:k(332)},brightness:{default:1},baseMaterial:{default:t[k(344)]}},setup(a){const i=k,l=a,u=g(null),f={vertex:"\nuniform float uTime;\nuniform float uHeight;\nvarying float vHeight;\n\nvec3 displace(vec3 point) {\n  vec3 p = point;\n  p.y += uTime * 2.0;\n  gln_tFBMOpts fbmOpts = gln_tFBMOpts(1.0, 0.4, 2.3, 0.4, 1.0, 5, false, false);\n  gln_tGerstnerWaveOpts A = gln_tGerstnerWaveOpts(vec2(0.0, -1.0), 0.5, 2.0);\n  gln_tGerstnerWaveOpts B = gln_tGerstnerWaveOpts(vec2(0.0, 1.0), 0.25, 4.0);\n  gln_tGerstnerWaveOpts C = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.15, 6.0);\n  gln_tGerstnerWaveOpts D = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.4, 2.0);\n  vec3 n = vec3(0.0);\n  if(p.z >= uHeight / 2.0) {\n      n.z += gln_normalize(gln_pfbm(p.xy + (uTime * 0.5), fbmOpts));\n      n += gln_GerstnerWave(p, A, uTime).xzy;\n      n += gln_GerstnerWave(p, B, uTime).xzy * 0.5;\n      n += gln_GerstnerWave(p, C, uTime).xzy * 0.25;\n      n += gln_GerstnerWave(p, D, uTime).xzy * 0.2;\n  }\n  vHeight = n.z;\n  return point + n;\n}\n\nvec3 orthogonal(vec3 v) {\n  return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0)\n  : vec3(0.0, -v.z, v.y));\n}\n\nvec3 recalcNormals(vec3 newPos) {\n  float offset = 0.001;\n  vec3 tangent = orthogonal(normal);\n  vec3 bitangent = normalize(cross(normal, tangent));\n  vec3 neighbour1 = position + tangent * offset;\n  vec3 neighbour2 = position + bitangent * offset;\n\n  vec3 displacedNeighbour1 = displace(neighbour1);\n  vec3 displacedNeighbour2 = displace(neighbour2);\n\n  vec3 displacedTangent = displacedNeighbour1 - newPos;\n  vec3 displacedBitangent = displacedNeighbour2 - newPos;\n\n  return normalize(cross(displacedTangent, displacedBitangent));\n}\n\nvoid main() {\n  csm_Position = displace(position);\n  csm_Normal = recalcNormals(csm_Position);\n}\n\t",fragment:i(345)},M={uTime:{value:0},waterColor:{value:new(t[i(322)])(l[i(333)])[i(326)]()},waterHighlight:{value:new e(l[i(339)])[i(326)]()},offset:{value:.4},contrast:{value:3.1},brightness:{value:l[i(375)]},uHeight:{value:l[i(324)]}},{onLoop:j}=s();return j((({elapsed:t})=>{M.uTime.value=-t/5})),h((()=>{const n=i;l[n(324)]&&(M.uHeight[n(320)]=l.height),l[n(333)]&&(M.waterColor[n(320)]=new e(l[n(333)])[n(326)]()),l[n(339)]&&(M.waterHighlight.value=new(t[n(322)])(l.waterHighlight)[n(326)]()),l[n(375)]&&(M[n(375)][n(320)]=l.brightness)})),m((()=>l[i(376)]),(t=>{const e=i;u[e(320)][e(374)][e(359)]=!0})),m((()=>l[i(336)]),(e=>{const r=i,a=new c({baseMaterial:t[e],vertexShader:p(f[r(365)]),fragmentShader:f[r(348)],uniforms:M,flatShading:l[r(376)],side:n,roughness:.2,metalness:.1,silent:!0});u[r(320)][r(374)][r(364)](),u[r(320)][r(374)]=a})),(e,n)=>{const a=i;return v(),d("TresMesh",{ref_key:a(351),ref:u,"rotation-x":-Math.PI/2},[_(a(342),{args:[5,5,e.height,64,64,1]},null,8,O),b(w(o),{baseMaterial:r,vertexShader:w(p)(f[a(365)]),fragmentShader:f.fragment,uniforms:M,side:t[a(329)],roughness:.2,metalness:.1,flatShading:e[a(376)],silent:""},null,8,[a(336),a(340),a(369),a(337),a(355)])],8,P)}}});function D(t){function e(t){const n=G;if(typeof t===n(323))return function(t){}[n(335)]("while (true) {}")[n(363)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[n(335)]("debu"+n(370))[n(360)](n(352)):function(){return!1}[n(335)](n(353)+n(370))[n(363)]("stateObject"),e(++t)}try{if(t)return e;e(0)}catch(n){}}const N=A;function A(t,e){const n=U();return(A=function(t,e){return n[t-=450]})(t,e)}!function(t,e){const n=A,r=U();for(;;)try{if(816260===parseInt(n(516))/1+-parseInt(n(509))/2+parseInt(n(475))/3*(parseInt(n(500))/4)+parseInt(n(496))/5+-parseInt(n(458))/6*(-parseInt(n(456))/7)+-parseInt(n(476))/8*(-parseInt(n(478))/9)+-parseInt(n(487))/10*(parseInt(n(489))/11))break;r.push(r.shift())}catch(a){r.push(r.shift())}}();const E=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[A(506)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();!function(){E(this,(function(){const t=A,e=new RegExp(t(474)),n=new RegExp(t(467),"i"),r=J(t(464));e.test(r+t(491))&&n.test(r+"input")?J():r("0")}))()}();const R=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n.apply(e,arguments);return n=null,t}}:function(){};return t=!1,r}}();R(void 0,(function(){const t=A,e=function(){const t=A;let e;try{e=Function(t(495)+t(479)+");")()}catch(n){e=window}return e}(),n=e.console=e.console||{},r=[t(450),"warn",t(494),t(457),t(469),t(454),t(493)];for(let a=0;a<r[t(499)];a++){const e=R[t(453)][t(492)][t(502)](R),s=r[a],o=n[s]||e;e[t(451)]=R[t(502)](R),e[t(482)]=o[t(482)][t(502)](o),n[s]=e}}))();const Z=_(N(461),{position:[5,5,5],fov:45,near:.1,far:1e3},null,-1),L=_(N(481),{intensity:.5},null,-1),V=_(N(508),{position:[15,15,15],intensity:1},null,-1),q=f({__name:N(480),setup(t){const e=N,n=M({alpha:!0,toneMapping:a,windowSize:!0,clearColor:10066329}),r=M({enableDamping:!0,autoRotate:!1}),s=M({cellSize:.6,cellThickness:1.1,cellColor:"#627179",sectionColor:e(477),sectionSize:2.4,sectionThickness:1.8,fadeDistance:27,fadeStrength:.76,followCamera:!1,infiniteGrid:!0}),o=M({height:.2,Flatshading:!1,waterColor:e(503),waterHighlight:"#b3ffff",brightness:1,baseMaterial:e(460)}),c=new T;return c[e(513)](o,"height",{label:"高度",min:.1,max:5,step:.1}),c[e(513)](o,e(465),{label:e(463)}),c[e(513)](o,e(501),{label:e(462)}),c[e(513)](o,"brightness",{label:"亮度",min:0,max:1,step:.01}),c.addBinding(o,e(490),{label:e(490)}),c[e(484)]({view:e(504),label:"材质",options:[{text:e(460),value:"MeshPhysicalMaterial"},{text:e(510),value:"MeshBasicMaterial"},{text:e(483),value:"MeshNormalMaterial"},{text:e(452),value:e(452)},{text:"MeshPhongMaterial",value:"MeshPhongMaterial"},{text:e(505),value:"MeshToonMaterial"},{text:e(470),value:e(470)},{text:"MeshDepthMaterial",value:e(485)}],value:o[e(488)]}),c.on(e(507),(t=>{const n=e;"材质"===t.target[n(466)]&&(o.baseMaterial=t[n(459)])})),(t,a)=>{const c=e;return v(),j(w(l),I(n,{"window-size":""}),{default:y((()=>[Z,b(w(i),x(C(r)),null,16),L,V,b(F,x(C(o)),null,16),b(w(S),I({args:[3,3]},s,{position:[0,-.5,0]}),null,16),(v(),j(z,null,{default:y((()=>[b(w(u),{files:[c(511),"neg-x.jpg",c(455),"neg-y.jpg",c(515),c(486)],path:c(497)})])),_:1}))])),_:1},16)}}});function J(t){function e(t){const n=A;if("string"==typeof t)return function(t){}.constructor(n(473)).apply(n(514));1!==(""+t/t)[n(499)]||t%20==0?function(){return!0}[n(453)](n(471)+"gger")[n(498)](n(468)):function(){return!1}.constructor(n(471)+n(512))[n(506)](n(472)),e(++t)}try{if(t)return e;e(0)}catch(n){}}function U(){const t=["3493016oPWEjc","#3a78a2","9gCPdFK",'{}.constructor("return this")( )',"customWater","TresAmbientLight","toString","MeshNormalMaterial","addBlade","MeshDepthMaterial","neg-z.jpg","168290kkmnQu","baseMaterial","2299VZBWIW","Flatshading","chain","prototype","trace","info","return (function() ","4234645ZOgpqu","https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/images/skyBox/6jpg/","call","length","3090524uqJFeJ","waterHighlight","bind","#52a7f7","list","MeshToonMaterial","apply","change","TresDirectionalLight","1062974sIkkmh","MeshBasicMaterial","pos-x.jpg","gger","addBinding","counter","pos-z.jpg","1513641uRbUUd","log","__proto__","MeshStandardMaterial","constructor","table","pos-y.jpg","3657843KbowgV","error","6BZcNrQ","value","MeshPhysicalMaterial","TresPerspectiveCamera","浪头颜色","水体颜色","init","waterColor","label","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","action","exception","MeshLambertMaterial","debu","stateObject","while (true) {}","function *\\( *\\)","6AtTqiM"];return(U=function(){return t})()}export{q as default};
