import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.2JXDzzMt1721298764655.js";import{$ as o}from"./@tresjs.iXEJQd7J1721298764655.js";import{C as e}from"./three-custom-shader-material.wt6if9qU1721298764655.js";import"./object-hash.eR6rYsIK1721298764655.js";import{a6 as r,C as i,ca as u,k as c,b0 as a}from"./three.0bBjBDi41721298764655.js";import"./@amap.x_Go35DX1721298764655.js";import"./glsl-tokenizer.ZFLos1PC1721298764655.js";import{d as s,a1 as l,w as f,o as p,D as d,u as m,a4 as g,r as v,f as h,g as y,j as C,m as w}from"./@vue.Q1VpS3901721298764655.js";import{P as _}from"./tweakpane.yHWGBmom1721298764655.js";import"./@vueuse.hS-CVzal1721298764655.js";import"./glsl-token-string.BCXfLWyP1721298764655.js";import"./glsl-token-functions._ALfgfbj1721298764655.js";import"./jszip.-g-_Ii-P1721298764655.js";const b=j;!function(t,n){const o=j,e=I();for(;;)try{if(279469===parseInt(o(159))/1*(-parseInt(o(195))/2)+-parseInt(o(177))/3+-parseInt(o(143))/4+parseInt(o(188))/5+-parseInt(o(163))/6+parseInt(o(137))/7+parseInt(o(167))/8*(parseInt(o(173))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=j,n=new RegExp(t(131)),o=new RegExp(t(168),"i"),e=B(t(145));n[t(133)](e+t(196))&&o[t(133)](e+"input")?B():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function j(t,n){const o=I();return(j=function(t,n){return o[t-=131]})(t,n)}function I(){const t=["\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","city","computeBoundingSphere","uGradient","computeBoundingBox","1925829enMorT","boundingBox","apply","constructor","1157766ZjesTe","side","prototype","opacity","#ffffff","call","bulidingsColor","renderOrder","error","counter","clone","1918580wOZBcN","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","land","setStyle","color","__csm","isArray","2gEGDZF","chain","Color","uniforms","console","function *\\( *\\)","bind","test","length","__proto__","gger","2064888BdRSKS","uOpacity","landColor","forEach","MeshBasicMaterial","debu","1890984YEYBoQ","gradient","init","topColor","dispose","model","#112233","table","bModel","DoubleSide","material","#e523ff","uTime","return (function() ","children","#ffff00","527701BgSHYx","uColor","log","stateObject","1780488XiHQAw","toString","primitive","value","48hzCrvO"];return(I=function(){return t})()}M(void 0,(function(){const t=j;let n;try{n=Function(t(156)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(199)]=n[t(199)]||{},e=[t(161),"warn","info",t(185),"exception",t(150),"trace"];for(let i=0;i<e.length;i++){const n=M.constructor[t(179)][t(132)](M),r=e[i],u=o[r]||n;n[t(135)]=M[t(132)](M),n[t(164)]=u.toString[t(132)](u),o[r]=n}}))();const S=["object"],T=s({__name:b(151),props:{model:{},bulidingsColor:{default:b(154)},landColor:{default:b(149)},topColor:{default:b(158)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,i=t,u=i[n(148)][n(169)];i[n(148)][n(148)][n(157)][0][n(153)]=new(r[n(141)])({color:n(158)}),u[n(184)]=1001;const c=i[n(148)][n(190)];(()=>{const t=n,{geometry:o}=u;o[t(172)](),o[t(170)]();const{max:c,min:a}=o[t(174)];if(u[t(153)][t(193)])return;const s=new e({baseMaterial:u.material,vertexShader:t(189),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(197)])(i[t(183)])},uOpacity:{value:i.opacity},uLightColor:{value:new(r[t(197)])(t(181))},uTopColor:{value:new(r[t(197)])(i[t(146)])},uTime:{value:0},uGradient:{value:i[t(144)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(152)]});u[t(153)][t(147)](),u[t(153)]=s})();const{onLoop:a}=o();a((({delta:t})=>{const o=n;u[o(153)].uniforms[o(155)][o(166)]+=t})),l((()=>{const t=n;i.bulidingsColor&&u[t(153)][t(198)][t(160)][t(166)][t(191)](i[t(183)]),i[t(139)]&&((t,o)=>{const e=n;let u;"cu"===t||"land"===t&&(u=Array[e(194)](c[e(153)])?c.material:[c.material],u[e(140)]((t=>{const n=e;t[o][n(191)](i[n(139)]),t[n(178)]=r[n(152)]})))})(t(190),t(192)),i.opacity&&(u[t(153)][t(198)][t(138)][t(166)]=i[t(180)])})),f(i,((t,o)=>{const e=n;u[e(153)][e(198)][e(171)].value=t[e(144)]}));const s=i[n(148)][n(148)][n(187)]();return(t,o)=>{const e=n;return p(),d(e(165),{object:m(s)},null,8,S)}}});function B(t){function n(t){const o=j;if("string"==typeof t)return function(t){}[o(176)]("while (true) {}")[o(175)](o(186));1!==(""+t/t)[o(134)]||t%20==0?function(){return!0}[o(176)](o(142)+o(136))[o(182)]("action"):function(){return!1}[o(176)](o(142)+o(136))[o(175)](o(162)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=Z;!function(t,n){const o=Z,e=F();for(;;)try{if(631677===-parseInt(o(312))/1+-parseInt(o(320))/2*(parseInt(o(354))/3)+-parseInt(o(302))/4+parseInt(o(314))/5*(-parseInt(o(325))/6)+parseInt(o(348))/7+-parseInt(o(340))/8+parseInt(o(319))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const O=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(313)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){O(this,(function(){const t=Z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(349),"i"),e=G(t(334));n[t(304)](e+"chain")&&o[t(304)](e+t(309))?G():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=Z,n=function(){const t=Z;let n;try{n=Function(t(333)+t(310)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(332)]||{},e=["log",t(307),t(327),t(318),"exception",t(303),t(347)];for(let r=0;r<e[t(339)];r++){const n=z[t(317)][t(324)][t(353)](z),i=e[r],u=o[i]||n;n[t(315)]=z.bind(z),n[t(311)]=u.toString[t(353)](u),o[i]=n}}))();const A=["object"];function F(){const t=["test","material","gradual","warn","srcColor","input",'{}.constructor("return this")( )',"toString","74133TAsHku","apply","3019185NxiWPC","__proto__","uGradual","constructor","error","20669841KYMBYL","302168Gljjcb","#000","scale","string","prototype","12BRtMrr","builds","info","gger","linewidth","counter","uSrcColor","console","return (function() ","init","uScale","while (true) {}","matrix","speed","length","6786112sKlrzj","bLine","call","#FFF","value","width","uniforms","trace","6357792gsUihG","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","clone","applyMatrix4","geometry","bind","6TqUbVj","color","uTime","debu","renderOrder","563956zUTAnJ","table"];return(F=function(){return t})()}function Z(t,n){const o=F();return(Z=function(t,n){return o[t-=302]})(t,n)}const E=s({__name:P(341),props:{builds:{},color:{default:P(343)},srcColor:{default:P(321)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,e=t;let r=null;const s={transparent:!0,uniforms:{uColor:{value:new i(e[n(355)])},uSrcColor:{value:new i(e[n(308)])},uScale:{value:e[n(322)]},uTime:{value:0},uGradual:{value:e[n(306)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e[n(326)][n(352)])[n(350)]();f=f[n(351)](e[n(326)][n(337)]);const g=new c(s);r=new a(f,g),r[n(305)][n(329)]=e[n(345)],r[n(358)]=1e3,l((()=>{const t=n;e[t(355)]&&(s[t(346)].uColor[t(344)]=new i(e[t(355)])),e.srcColor&&(s.uniforms[t(331)][t(344)]=new i(e.srcColor)),e.scale&&(s[t(346)][t(335)].value=e[t(322)]),e[t(306)]&&(s[t(346)][t(316)][t(344)]=e[t(306)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;s.uniforms.uTime[o(344)]+=t*e[o(338)],s.uniforms[o(356)][o(344)]%=1})),(t,n)=>(p(),d("primitive",{object:m(r)},null,8,A))}});function G(t){function n(t){const o=Z;if(typeof t===o(323))return function(t){}[o(317)](o(336))[o(313)](o(330));1!==(""+t/t)[o(339)]||t%20==0?function(){return!0}[o(317)](o(357)+o(328))[o(342)]("action"):function(){return!1}[o(317)](o(357)+o(328))[o(313)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const R=D;!function(t,n){const o=D,e=$();for(;;)try{if(522206===parseInt(o(399))/1*(-parseInt(o(394))/2)+-parseInt(o(404))/3+-parseInt(o(413))/4*(parseInt(o(440))/5)+parseInt(o(416))/6*(-parseInt(o(393))/7)+-parseInt(o(407))/8*(-parseInt(o(434))/9)+-parseInt(o(392))/10*(parseInt(o(424))/11)+parseInt(o(430))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(398)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=D,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(401),"i"),e=U(t(436));n[t(400)](e+"chain")&&o[t(400)](e+t(432))?U():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(398)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(t,n){const o=$();return(D=function(t,n){return o[t-=387]})(t,n)}L(void 0,(function(){const t=D;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n[t(429)]||{},e=["log",t(418),t(427),t(426),t(414),"table",t(410)];for(let i=0;i<e.length;i++){const n=L[t(409)][t(405)][t(412)](L),r=e[i],u=o[r]||n;n[t(437)]=L[t(412)](L),n[t(388)]=u[t(388)][t(412)](u),o[r]=n}}))();const H=s({__name:R(395),async setup(o){const e=R;let r,i;const u=([r,i]=g((()=>n())),r=await r,i(),r),c=v({color:"#FFF",srcColor:e(390),scale:2e3,gradual:6.6,speed:.3}),a=new _({title:e(417),expanded:!0});return a[e(428)](c,e(420),{label:e(422)}),a[e(428)](c,e(389),{label:e(406)}),a.addBinding(c,e(438),{label:"速度",min:.1,max:1,step:.1}),a.addBinding(c,e(425),{label:e(435),min:10,max:2e3,step:10}),a.addBinding(c,e(421),{label:"扩散系数",min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[C(T,{model:m(u),bulidingsColor:r(415),landColor:r(433),topColor:"#999"},null,8,[r(419)]),C(E,w({builds:m(u)[r(391)]},c),null,16,[r(411)])])),_:1})}}});function U(t){function n(t){const o=D;if(typeof t===o(423))return function(t){}[o(409)](o(431))[o(398)](o(387));1!==(""+t/t)[o(396)]||t%20==0?function(){return!0}[o(409)](o(397)+o(439))[o(402)](o(408)):function(){return!1}.constructor(o(397)+"gger")[o(398)](o(403)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function $(){const t=["console","28811184ZLrcpj","while (true) {}","input","#112233","3094281XpUmBQ","最大扩散","init","__proto__","speed","gger","158190SPxUET","counter","toString","color","#000","city","20LzIZgM","3041066UgyPPV","6hppYhQ","buildingsEffectA","length","debu","apply","46813MVhKDd","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","call","stateObject","762396KaRZJx","prototype","线扫颜色","8HlzhmU","action","constructor","trace","builds","bind","60tBNrxA","exception","#000000","6WyTaIv","效果参数","warn","model","srcColor","gradual","线原颜色","string","5054258rsKOmQ","scale","error","info","addBinding"];return($=function(){return t})()}export{H as default};
