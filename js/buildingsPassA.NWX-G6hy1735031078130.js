import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.DbuurF0C1735031078130.js";import{c6 as n,_ as e,c4 as o,cg as r,cq as i}from"./three.bc6MLGU_1735031078130.js";import{m as u,e as s}from"./@tresjs.dTM0HLnZ1735031078130.js";import{d as c,a3 as a,r as l,o as p,f,g as d,j as v,aj as m,ak as h}from"./@vue.-THQH3GC1735031078130.js";import{P as x}from"./tweakpane.yHWGBmom1735031078130.js";import"./three-custom-shader-material.uc9Xgl3q1735031078130.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1735031078130.js";import"./@vueuse.COyzlgw71735031078130.js";const w=y;!function(t,n){const e=y,o=g();for(;;)try{if(426468===-parseInt(e(251))/1*(parseInt(e(292))/2)+-parseInt(e(283))/3+-parseInt(e(295))/4+parseInt(e(267))/5+parseInt(e(300))/6+parseInt(e(275))/7+-parseInt(e(289))/8)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const P=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[y(270)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function g(){const t=["function *\\( *\\)","exception","1984044iROLLM","debu","uScalenum","bind","material","prototype","1349216dLWJrW","init","uniforms","834826nTOVOO","set","toString","1507740OfqxnE","uScaleone","#FFF","chain","depthTexture","2757180wcuKAy","return (function() ","test","width","addPass","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uPosition","gger","depthBuffer","value","1upWQHC","buildingsPassA","length","uColor","DepthTexture","warn","ShaderMaterial","console","Color","time","action","trace","render","color","log","constructor","4174445iFsiyV","matrixWorld","speed","apply","uWidth","call","string","projectionMatrixInverse","5294779LlTfTk","error","height","__proto__","readBuffer","Vector2"];return(g=function(){return t})()}!function(){P(this,(function(){const t=y,n=new RegExp(t(281)),e=new RegExp(t(246),"i"),o=_(t(290));n[t(243)](o+t(298))&&e[t(243)](o+"input")?_():o("0")}))()}();const S=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[y(270)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function y(t,n){const e=g();return(y=function(t,n){return e[t-=243]})(t,n)}S(void 0,(function(){const t=y;let n;try{n=Function(t(301)+'{}.constructor("return this")( ));')()}catch(r){n=window}const e=n.console=n[t(258)]||{},o=[t(265),t(256),"info",t(276),t(282),"table",t(262)];for(let i=0;i<o[t(253)];i++){const n=S[t(266)][t(288)][t(286)](S),r=o[i],u=e[r]||n;n[t(278)]=S[t(286)](S),n[t(294)]=u.toString[t(286)](u),e[r]=n}}))();const b=c({__name:w(252),props:{color:{default:w(297)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const c=t,{renderer:l,scene:p,camera:f,sizes:d}=u();let v,m=0,h=null,x=null;a((()=>{const t=y;d[t(244)][t(250)]&&(v=d[t(244)][t(250)],m=d[t(277)].value,(()=>{const t=y;h=new n(l.value);const u=new(e[t(255)])(v,m);h[t(279)][t(249)]=!0,h[t(279)][t(299)]=u;const s=new o(p[t(250)],f[t(250)]);h[t(245)](s),x=new r(new(e[t(257)])({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:u},uProjectionInverse:{value:f[t(250)][t(274)]},uMatrixWorld:{value:f[t(250)][t(268)]},uColor:{value:new(e[t(259)])(c[t(264)])},uScalenum:{value:c[t(285)]},uScaleone:{value:c[t(296)]},uWidth:{value:c.uWidth},uPosition:{value:new(e[t(280)])(c[t(247)].x,c[t(247)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),h[t(245)](x);const a=new r(i);h[t(245)](a)})())}));const{onLoop:w}=s();return w((({elapsed:t})=>{const n=y;h&&(h[n(263)](),x.uniforms[n(260)][n(250)]+=c[n(269)]/60)})),a((()=>{const t=y;x&&(c[t(264)]&&(x.material[t(291)][t(254)].value=new(e[t(259)])(c.color)),c[t(285)]&&(x.material[t(291)][t(285)][t(250)]=c[t(285)]),c[t(296)]&&(x[t(287)][t(291)].uScaleone.value=c[t(296)]),c[t(271)]&&(x[t(287)].uniforms.uWidth[t(250)]=c.uWidth),c[t(247)]&&x.material[t(291)][t(247)][t(250)][t(293)](c[t(247)].x,c[t(247)].y))})),(t,n)=>null}});function _(t){function n(t){const e=y;if(typeof t===e(273))return function(t){}[e(266)]("while (true) {}")[e(270)]("counter");1!==(""+t/t)[e(253)]||t%20==0?function(){return!0}.constructor("debu"+e(248))[e(272)](e(261)):function(){return!1}[e(266)](e(284)+e(248))[e(270)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=D,o=j();for(;;)try{if(902879===parseInt(e(241))/1+-parseInt(e(223))/2+-parseInt(e(204))/3*(-parseInt(e(239))/4)+parseInt(e(219))/5*(parseInt(e(243))/6)+-parseInt(e(237))/7*(-parseInt(e(212))/8)+parseInt(e(228))/9+-parseInt(e(225))/10*(parseInt(e(213))/11))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const I=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){I(this,(function(){const t=D,n=new RegExp(t(232)),e=new RegExp(t(209),"i"),o=T(t(217));n.test(o+t(242))&&e[t(229)](o+t(211))?T():o("0")}))()}();const W=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[D(202)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function j(){const t=["input","639328BPGYjU","31766603eUBNDS","console","debu","圈颜色","init","gger","419830tsobQQ","call","uPosition","error","696040IdgJsv","toString","10ExfTPP","uScalenum","后期效果","3271338PpsdTN","test","bind","单条圈间距","function *\\( *\\)","while (true) {}","constructor","最大范围","单条圈宽度","119xNEzDD","color","453260UKDqpF","counter","972972AxtowH","chain","6yTnwJB","return (function() ","trace","exception","string","warn","uWidth","apply","table","36SrUbqP","__proto__","inline","addBinding","length","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","speed"];return(j=function(){return t})()}function D(t,n){const e=j();return(D=function(t,n){return e[t-=196]})(t,n)}W(void 0,(function(){const t=D,n=function(){const t=D;let n;try{n=Function(t(196)+'{}.constructor("return this")( ));')()}catch(e){n=window}return n}(),e=n[t(214)]=n[t(214)]||{},o=["log",t(200),"info",t(222),t(198),t(203),t(197)];for(let r=0;r<o[t(208)];r++){const n=W[t(234)].prototype[t(230)](W),i=o[r],u=e[i]||n;n[t(205)]=W[t(230)](W),n.toString=u[t(224)][t(230)](u),e[i]=n}}))();const z=c({__name:"buildingsPassA",setup(n){const e=D,o=l({color:"#00b4fb",uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new x({title:e(227),expanded:!0});return r.addBinding(o,e(238),{label:e(216)}),r[e(207)](o,e(226),{label:e(235),min:1,max:500,step:10}),r[e(207)](o,"uScaleone",{label:e(231),min:1,max:100,step:1}),r[e(207)](o,e(201),{label:e(236),min:0,max:1,step:.01}),r[e(207)](o,e(210),{label:"速度",min:1,max:20,step:1}),r.addBinding(o,e(221),{picker:e(206),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(p(),f(t,{disableRender:!0,showAxesHelper:!1},{ability:d((()=>[v(b,m(h(o)),null,16)])),_:1}))}});function T(t){function n(t){const e=D;if(typeof t===e(199))return function(t){}.constructor(e(233))[e(202)](e(240));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(e(215)+e(218))[e(220)]("action"):function(){return!1}[e(234)](e(215)+e(218)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{z as default};
