import{n as e}from"./index.Crdf3MNx1763540743861.js";import{_ as o}from"./floorsPanel.vue_vue_type_style_index_0_lang.YjnasdAa1763540743861.js";import{_ as s}from"./textBox.vue_vue_type_script_setup_true_lang.BSIEV7gF1763540743861.js";import{u as r}from"./commonData.BQ6HGNAS1763540743861.js";import{d as t,a as l,w as a,H as n,o as i,J as f,b as u,I as c,h as d,u as p,ac as m,ao as g,F as h,X as y}from"./@vue.Co_gxueH1763540743861.js";import{bS as _,B as x}from"./three.rXKzP9fQ1763540743861.js";const b=["rotate-x","scale"],v=["args"],T=["rotate-x","scale","position"],I=["args"],k=["color"],j=t({__name:"building",setup(t){const j=r(),E=["#ff33ff","#ffff33","#0066ff","#00ff33"],M=2,w={depth:.1,bevelEnabled:!1},F=j.buildingsPrimary;if(!F[0].properties["floors-id"])throw new Error("请正确配置楼层数据");j.floorIds=F[0].properties["floors-id"].split(",");const D={depth:j.floorIds.length,bevelEnabled:!1},G=new _;F[0].geometry.coordinates.forEach(e=>{for(let o=0;o<e.length;o++){const[s,r]=e[o];0===o&&G.moveTo(s,-r),G.lineTo(s,-r)}});const O=l(null),P=[0,0,0],S=[0,0,0];a(()=>O.value,e=>{if(e){const o=(new x).setFromObject(e),s=o.min,r=o.max;P[0]=s.x,P[1]=r.y/2,P[2]=s.z,console.log("顶部面左上角坐标:",P),S[0]=s.x+3,S[1]=-1,S[2]=r.z+2}},{immediate:!0});const B={color:"#ffffff",roughness:.05,reflectivity:1,attenuationColor:"#b7edf7",attenuationDistance:1.3,chromaticAberration:.37,anisotropicBlur:.65,distortion:.1,temporalDistortion:.92,backside:!1,thickness:.96,backsideThickness:.5};return(r,t)=>(i(),n("TresGroup",null,[f("TresMesh",{"rotate-x":-Math.PI/2,scale:M,"render-order":1,ref_key:"buildingRef",ref:O,visible:!0},[f("TresExtrudeGeometry",{args:[p(G),D]},null,8,v),d(p(e),m(g(B)),null,16)],8,b),f("TresGroup",null,[(i(!0),n(h,null,y(p(j).floorIds,(e,o)=>(i(),n("TresMesh",{"rotate-x":-Math.PI/2,scale:1.006*M,"render-order":2,position:[0,2*o,0],key:e},[f("TresExtrudeGeometry",{args:[p(G),w]},null,8,I),f("TresMeshStandardMaterial",{color:E[o],roughness:0,metalness:1,polygonOffset:"",polygonOffsetFactor:1,polygonOffsetUnits:1},null,8,k)],8,T))),128))]),O.value?(i(),u(o,{key:0,occlude:[O.value],position:P,styleScale:M,floorIds:p(j).floorIds,defaultFloor:p(F)[0].properties["default-floor"]},null,8,["occlude","styleScale","floorIds","defaultFloor"])):c("",!0),O.value?(i(),u(s,{key:1,position:S,text:p(F)[0].properties.name,scale:3},null,8,["text"])):c("",!0)]))}});export{j as _};
