import{a5 as t,C as e,Z as n,ab as r}from"./three.HEgnMaTu1721048663624.js";import{T as a,r as o,d as s,P as i}from"./@tresjs.Xiq_TH801721048663624.js";import{a as l}from"./index.3f2gHe7y1721048663624.js";import"./index.2meXtSIP1721048663624.js";import{C as u}from"./three-custom-shader-material.AmV1WVUo1721048663624.js";import"./object-hash.E5Z0NA4F1721048663624.js";import"./@amap.IXBtourJ1721048663624.js";import"./glsl-tokenizer.bhImRDDx1721048663624.js";import{p as c}from"./gl-noise.BrVtymbx1721048663624.js";import{d as p,b as f,a2 as g,w as h,o as m,D as v,J as d,j as _,u as b,r as w,f as M,g as y,aj as j,ak as x,m as T,al as z}from"./@vue.ApkyOKE71721048663624.js";import{P as C}from"./tweakpane.yHWGBmom1721048663624.js";import{_ as I}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.p7_2B-jb1721048663624.js";import"./@vueuse.2IVIyoVR1721048663624.js";import"./three-stdlib.Bcxn6yVp1721048663624.js";import"./@pmndrs.jxJ3fman1721048663624.js";import"./reflectorDiffuse.vue_vue_type_script_setup_true_lang.ssr8PtJY1721048663624.js";import"./all.three.iV40_XbL1721048663624.js";import"./oimophysics.x0jH7fze1721048663624.js";import"./reflectorDUDV.vue_vue_type_script_setup_true_lang.V9wWavgb1721048663624.js";import"./reflectorShaderMesh.vue_vue_type_script_setup_true_lang.5DNz-lxG1721048663624.js";import"./whiteFloorMesh.vue_vue_type_script_setup_true_lang.yyF0hivw1721048663624.js";import"./videoFloor.vue_vue_type_script_setup_true_lang.L9CntHVE1721048663624.js";import"./glsl-token-string.fSxiDrag1721048663624.js";import"./glsl-token-functions.tTTlKCMK1721048663624.js";import"./jszip.PK6xEuxJ1721048663624.js";const S=G;!function(t,e){const n=G,r=W();for(;;)try{if(353690===-parseInt(n(178))/1+parseInt(n(168))/2*(-parseInt(n(169))/3)+parseInt(n(180))/4*(parseInt(n(192))/5)+-parseInt(n(179))/6*(parseInt(n(214))/7)+parseInt(n(198))/8+parseInt(n(203))/9+parseInt(n(159))/10*(parseInt(n(207))/11))break;r.push(r.shift())}catch(a){r.push(r.shift())}}();const B=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[G(164)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();!function(){B(this,(function(){const t=G,e=new RegExp(t(194)),n=new RegExp(t(175),"i"),r=k("init");e.test(r+t(176))&&n.test(r+"input")?k():r("0")}))()}();const H=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n.apply(e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function W(){const t=["\nvarying float vHeight;\nuniform vec3 waterColor;\nuniform vec3 waterHighlight;\nuniform float offset;\nuniform float contrast;\nuniform float brightness;\n\nvec3 calcColor() {\n  float mask = (pow(vHeight, 2.) - offset) * contrast;\n  vec3 diffuseColor = mix(waterColor, waterHighlight, mask);\n  diffuseColor *= brightness;\n  return diffuseColor;\n}\n\nvoid main() {\n  csm_DiffuseColor = vec4(calcColor(), 1.0);\n}\n\t","DoubleSide","info","uTime","value","1408585sNxuBT","vertexShader","function *\\( *\\)","needsUpdate","constructor","MeshPhysicalMaterial","204280IPRWlm","fragment","string","__proto__","length","2143449KlpIee","#b3ffff","Flatshading","toString","311652BaPLtV","baseMaterial","exception","dispose","action","material","Color","2847684DyWppe","#52a7f7","while (true) {}","return (function() ","brightness","waterColor","410TvOvZS","stateObject","tmRef","bind","console","apply","vertex","uHeight","convertLinearToSRGB","2JHxNZE","1745733FIchLl","debu","gger","prototype","trace","customWaterMesh","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","flatShading","364612VXOTqB","6TSvRNl","4zQHDFt","height","waterHighlight","log","fragmentShader",'{}.constructor("return this")( )',"TresBoxGeometry"];return(W=function(){return t})()}function G(t,e){const n=W();return(G=function(t,e){return n[t-=159]})(t,e)}H(void 0,(function(){const t=G,e=function(){const t=G;let e;try{e=Function(t(217)+t(185)+");")()}catch(n){e=window}return e}(),n=e[t(163)]=e[t(163)]||{},r=[t(183),"warn",t(189),"error",t(209),"table",t(173)];for(let a=0;a<r.length;a++){const e=H.constructor[t(172)][t(162)](H),o=r[a],s=n[o]||e;e[t(201)]=H[t(162)](H),e[t(206)]=s[t(206)][t(162)](s),n[o]=e}}))();const O=["rotation-x"],P=["args"],D=p({__name:S(174),props:{height:{default:.2},Flatshading:{type:Boolean,default:!1},waterColor:{default:S(215)},waterHighlight:{default:S(204)},brightness:{default:1},baseMaterial:{default:t[S(197)]}},setup(r){const s=S,i=r,l=f(null),p={vertex:"\nuniform float uTime;\nuniform float uHeight;\nvarying float vHeight;\n\nvec3 displace(vec3 point) {\n  vec3 p = point;\n  p.y += uTime * 2.0;\n  gln_tFBMOpts fbmOpts = gln_tFBMOpts(1.0, 0.4, 2.3, 0.4, 1.0, 5, false, false);\n  gln_tGerstnerWaveOpts A = gln_tGerstnerWaveOpts(vec2(0.0, -1.0), 0.5, 2.0);\n  gln_tGerstnerWaveOpts B = gln_tGerstnerWaveOpts(vec2(0.0, 1.0), 0.25, 4.0);\n  gln_tGerstnerWaveOpts C = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.15, 6.0);\n  gln_tGerstnerWaveOpts D = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.4, 2.0);\n  vec3 n = vec3(0.0);\n  if(p.z >= uHeight / 2.0) {\n      n.z += gln_normalize(gln_pfbm(p.xy + (uTime * 0.5), fbmOpts));\n      n += gln_GerstnerWave(p, A, uTime).xzy;\n      n += gln_GerstnerWave(p, B, uTime).xzy * 0.5;\n      n += gln_GerstnerWave(p, C, uTime).xzy * 0.25;\n      n += gln_GerstnerWave(p, D, uTime).xzy * 0.2;\n  }\n  vHeight = n.z;\n  return point + n;\n}\n\nvec3 orthogonal(vec3 v) {\n  return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0)\n  : vec3(0.0, -v.z, v.y));\n}\n\nvec3 recalcNormals(vec3 newPos) {\n  float offset = 0.001;\n  vec3 tangent = orthogonal(normal);\n  vec3 bitangent = normalize(cross(normal, tangent));\n  vec3 neighbour1 = position + tangent * offset;\n  vec3 neighbour2 = position + bitangent * offset;\n\n  vec3 displacedNeighbour1 = displace(neighbour1);\n  vec3 displacedNeighbour2 = displace(neighbour2);\n\n  vec3 displacedTangent = displacedNeighbour1 - newPos;\n  vec3 displacedBitangent = displacedNeighbour2 - newPos;\n\n  return normalize(cross(displacedTangent, displacedBitangent));\n}\n\nvoid main() {\n  csm_Position = displace(position);\n  csm_Normal = recalcNormals(csm_Position);\n}\n\t",fragment:s(187)},w={uTime:{value:0},waterColor:{value:new(t[s(213)])(i[s(219)])[s(167)]()},waterHighlight:{value:new(t[s(213)])(i[s(182)])[s(167)]()},offset:{value:.4},contrast:{value:3.1},brightness:{value:i[s(218)]},uHeight:{value:i[s(181)]}},{onLoop:M}=o();return M((({elapsed:t})=>{const e=s;w[e(190)][e(191)]=-t/5})),g((()=>{const n=s;i[n(181)]&&(w[n(166)][n(191)]=i.height),i.waterColor&&(w[n(219)][n(191)]=new e(i.waterColor)[n(167)]()),i[n(182)]&&(w[n(182)][n(191)]=new(t[n(213)])(i[n(182)]).convertLinearToSRGB()),i.brightness&&(w[n(218)][n(191)]=i[n(218)])})),h((()=>i[s(205)]),(t=>{const e=s;l.value[e(212)][e(195)]=!0})),h((()=>i[s(208)]),(e=>{const r=s,a=new u({baseMaterial:t[e],vertexShader:c(p[r(165)]),fragmentShader:p[r(199)],uniforms:w,flatShading:i.Flatshading,side:n,roughness:.2,metalness:.1,silent:!0});l[r(191)].material[r(210)](),l[r(191)][r(212)]=a})),(e,n)=>{const r=s;return m(),v("TresMesh",{ref_key:r(161),ref:l,"rotation-x":-Math.PI/2},[d(r(186),{args:[5,5,e[r(181)],64,64,1]},null,8,P),_(b(a),{baseMaterial:t[r(197)],vertexShader:b(c)(p[r(165)]),fragmentShader:p[r(199)],uniforms:w,side:t[r(188)],roughness:.2,metalness:.1,flatShading:e[r(205)],silent:""},null,8,["baseMaterial",r(193),r(184),"side",r(177)])],8,O)}}});function k(t){function e(t){const n=G;if(typeof t===n(200))return function(t){}[n(196)](n(216))[n(164)]("counter");1!==(""+t/t)[n(202)]||t%20==0?function(){return!0}[n(196)]("debu"+n(171)).call(n(211)):function(){return!1}[n(196)](n(170)+n(171))[n(164)](n(160)),e(++t)}try{if(t)return e;e(0)}catch(n){}}const F=K;!function(t,e){const n=K,r=R();for(;;)try{if(653493===parseInt(n(198))/1+parseInt(n(190))/2+parseInt(n(168))/3+parseInt(n(141))/4*(parseInt(n(173))/5)+parseInt(n(192))/6*(-parseInt(n(166))/7)+parseInt(n(169))/8+-parseInt(n(196))/9)break;r.push(r.shift())}catch(a){r.push(r.shift())}}();const N=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[K(178)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();!function(){N(this,(function(){const t=K,e=new RegExp(t(182)),n=new RegExp(t(201),"i"),r=$(t(177));e[t(188)](r+"chain")&&n[t(188)](r+"input")?$():r("0")}))()}();const A=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[K(178)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function R(){const t=["toString","MeshNormalMaterial","__proto__","14jdRvrK","brightness","630735AbTXzo","6690216syGzKU","bind","Flatshading","#52a7f7","15FAXYDx","counter","pos-y.jpg","customWater","init","apply","TresPerspectiveCamera","浪头颜色","MeshBasicMaterial","function *\\( *\\)","action","waterColor","stateObject","pos-x.jpg","warn","test","MeshPhysicalMaterial","2273908AKVhFK","MeshLambertMaterial","3597978nlEMqx","log","files","addBlade","18287478ZqIHvd","水体颜色","1284600PYvkOi","#627179","gger","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","MeshToonMaterial","neg-x.jpg","TresAmbientLight","prototype","label","change","555580KANTWS","baseMaterial","length","waterHighlight","info","neg-z.jpg","value","neg-y.jpg","table","console","constructor","list","debu","addBinding","trace","return (function() ","MeshDepthMaterial","MeshPhongMaterial","MeshStandardMaterial","error","call","string"];return(R=function(){return t})()}A(void 0,(function(){const t=K,e=function(){const t=K;let e;try{e=Function(t(156)+'{}.constructor("return this")( ));')()}catch(n){e=window}return e}(),n=e[t(150)]=e[t(150)]||{},r=[t(193),t(187),t(145),t(160),"exception",t(149),t(155)];for(let a=0;a<r[t(143)];a++){const e=A[t(151)][t(138)].bind(A),o=r[a],s=n[o]||e;e[t(165)]=A[t(170)](A),e[t(163)]=s[t(163)][t(170)](s),n[o]=e}}))();const L=d(F(179),{position:[5,5,5],fov:45,near:.1,far:1e3},null,-1),Z=d(F(137),{intensity:.5},null,-1),E=d("TresDirectionalLight",{position:[15,15,15],intensity:1},null,-1);function K(t,e){const n=R();return(K=function(t,e){return n[t-=135]})(t,e)}const V=p({__name:F(176),setup(t){const e=F,n=w({alpha:!0,toneMapping:r,windowSize:!0,clearColor:10066329}),a=w({enableDamping:!0,autoRotate:!1}),o=w({cellSize:.6,cellThickness:1.1,cellColor:e(199),sectionColor:"#3a78a2",sectionSize:2.4,sectionThickness:1.8,fadeDistance:27,fadeStrength:.76,followCamera:!1,infiniteGrid:!0}),u=w({height:.2,Flatshading:!1,waterColor:e(172),waterHighlight:"#b3ffff",brightness:1,baseMaterial:e(189)}),c=new C;return c[e(154)](u,"height",{label:"高度",min:.1,max:5,step:.1}),c.addBinding(u,e(184),{label:e(197)}),c[e(154)](u,e(144),{label:e(180)}),c.addBinding(u,e(167),{label:"亮度",min:0,max:1,step:.01}),c[e(154)](u,e(171),{label:e(171)}),c[e(195)]({view:e(152),label:"材质",options:[{text:e(189),value:e(189)},{text:e(181),value:e(181)},{text:e(164),value:"MeshNormalMaterial"},{text:e(159),value:e(159)},{text:e(158),value:e(158)},{text:e(135),value:"MeshToonMaterial"},{text:e(191),value:"MeshLambertMaterial"},{text:e(157),value:"MeshDepthMaterial"}],value:u[e(142)]}),c.on(e(140),(t=>{const n=e;"材质"===t.target[n(139)]&&(u[n(142)]=t[n(147)])})),(t,r)=>{const c=e;return m(),M(b(i),T(n,{"window-size":""}),{default:y((()=>[L,_(b(s),j(x(a)),null,16),Z,E,_(D,j(x(u)),null,16),_(b(I),T({args:[3,3]},o,{position:[0,-.5,0]}),null,16),(m(),M(z,null,{default:y((()=>[_(b(l),{files:[c(186),c(136),c(175),c(148),"pos-z.jpg",c(146)],path:"https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/images/skyBox/6jpg/"},null,8,[c(194)])])),_:1}))])),_:1},16)}}});function $(t){function e(t){const n=K;if(typeof t===n(162))return function(t){}[n(151)]("while (true) {}")[n(178)](n(174));1!==(""+t/t)[n(143)]||t%20==0?function(){return!0}[n(151)](n(153)+n(200))[n(161)](n(183)):function(){return!1}[n(151)](n(153)+n(200))[n(178)](n(185)),e(++t)}try{if(t)return e;e(0)}catch(n){}}export{V as default};
