import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.gP9bIAYD1721721076264.js";import{$ as o}from"./@tresjs.tWkmYPO61721721076264.js";import{C as e}from"./three-custom-shader-material.UAECXI501721721076264.js";import"./object-hash.n-lQHd521721721076264.js";import{Y as r,a6 as i,C as u,cb as c,k as s,b0 as a}from"./three.fnkrvySq1721721076264.js";import"./@amap.b3gYyCW_1721721076264.js";import"./glsl-tokenizer.rVSxTaVo1721721076264.js";import{d as l,a1 as f,w as p,o as d,D as m,u as v,a4 as g,r as h,f as y,g as w,j as _,m as C}from"./@vue.Q1VpS3901721721076264.js";import{P as b}from"./tweakpane.yHWGBmom1721721076264.js";import"./@vueuse._hUvP73U1721721076264.js";import"./glsl-token-string.qKZvKI-H1721721076264.js";import"./glsl-token-functions.nzsekdRK1721721076264.js";import"./jszip.vimxEq251721721076264.js";const x=S;!function(t,n){const o=S,e=T();for(;;)try{if(342018===-parseInt(o(182))/1*(-parseInt(o(174))/2)+-parseInt(o(175))/3*(parseInt(o(145))/4)+-parseInt(o(130))/5+-parseInt(o(118))/6*(parseInt(o(125))/7)+-parseInt(o(178))/8+-parseInt(o(119))/9+parseInt(o(181))/10*(parseInt(o(169))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(128)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=S,n=new RegExp(t(129)),o=new RegExp(t(168),"i"),e=O(t(126));n.test(e+t(120))&&o.test(e+t(188))?O():e("0")}))()}();const j=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();j(void 0,(function(){const t=S;let n;try{n=Function(t(136)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(132)]=n[t(132)]||{},e=[t(180),"warn",t(170),t(176),"exception",t(167),t(146)];for(let i=0;i<e[t(155)];i++){const n=j.constructor[t(164)][t(183)](j),r=e[i],u=o[r]||n;n.__proto__=j[t(183)](j),n[t(189)]=u[t(189)][t(183)](u),o[r]=n}}))();const M=[x(158)];function S(t,n){const o=T();return(S=function(t,n){return o[t-=118]})(t,n)}function T(){const t=["table","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","22879637QmWghV","info","Color","string","gger","4WHtcJD","15PxTZiG","error","land","4939864DzMUaf","clone","log","10TmLbkd","156629jYjMoz","bind","primitive","side","computeBoundingSphere","landColor","input","toString","1646400LpvMVp","544230vzjTBT","chain","gradient","opacity","__csm","bModel","14VGdRwB","init","call","apply","function *\\( *\\)","780545QtWRIj","boundingBox","console","uOpacity","action","model","return (function() ","isArray","color","#ffff00","bulidingsColor","computeBoundingBox","topColor","#ffffff","renderOrder","534676OjAWlS","trace","#112233","material","setStyle","city","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","uGradient","uColor","length","DoubleSide","uTime","object","children","uniforms","counter","dispose","value","prototype","debu","constructor"];return(T=function(){return t})()}const P=l({__name:x(124),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:x(147)},topColor:{default:x(139)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,u=t,c=u[n(135)][n(150)];u[n(135)][n(135)][n(159)][0].material=new r({color:n(139)}),c[n(144)]=1001;const s=u[n(135)][n(177)];(()=>{const t=n,{geometry:o}=c;o[t(141)](),o[t(186)]();const{max:r,min:s}=o[t(131)];if(c.material[t(123)])return;const a=new e({baseMaterial:c.material,vertexShader:t(151),fragmentShader:t(152),silent:!0,uniforms:{uMax:{value:r},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(171)])(u[t(140)])},uOpacity:{value:u[t(122)]},uLightColor:{value:new(i[t(171)])(t(143))},uTopColor:{value:new(i[t(171)])(u[t(142)])},uTime:{value:0},uGradient:{value:u[t(121)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(156)]});c[t(148)][t(162)](),c[t(148)]=a})();const{onLoop:a}=o();a((({delta:t})=>{const o=n;c.material.uniforms[o(157)][o(163)]+=t})),f((()=>{const t=n;u[t(140)]&&c.material[t(160)][t(154)][t(163)][t(149)](u[t(140)]),u[t(187)]&&((t,o)=>{const e=n;let r;"cu"===t||t===e(177)&&(r=Array[e(137)](s[e(148)])?s[e(148)]:[s.material],r.forEach((t=>{const n=e;t[o][n(149)](u[n(187)]),t[n(185)]=i[n(156)]})))})(t(177),t(138)),u[t(122)]&&(c[t(148)].uniforms[t(133)].value=u[t(122)])})),p(u,((t,o)=>{const e=n;c[e(148)][e(160)][e(153)][e(163)]=t[e(121)]}));const l=u[n(135)][n(135)][n(179)]();return(t,o)=>{const e=n;return d(),m(e(184),{object:v(l)},null,8,M)}}});function O(t){function n(t){const o=S;if(typeof t===o(172))return function(t){}[o(166)]("while (true) {}")[o(128)](o(161));1!==(""+t/t)[o(155)]||t%20==0?function(){return!0}[o(166)](o(165)+"gger")[o(127)](o(134)):function(){return!1}[o(166)](o(165)+o(173))[o(128)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const z=F;function F(t,n){const o=G();return(F=function(t,n){return o[t-=209]})(t,n)}!function(t,n){const o=F,e=G();for(;;)try{if(576365===-parseInt(o(216))/1+parseInt(o(223))/2+-parseInt(o(229))/3*(-parseInt(o(214))/4)+-parseInt(o(262))/5*(parseInt(o(252))/6)+parseInt(o(212))/7+-parseInt(o(253))/8+-parseInt(o(257))/9*(-parseInt(o(254))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(244)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){R(this,(function(){const t=F,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(220),"i"),e=E("init");n.test(e+t(249))&&o[t(224)](e+t(234))?E():e("0")}))()}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(244)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=F,n=function(){const t=F;let n;try{n=Function("return (function() "+t(230)+");")()}catch(o){n=window}return n}(),o=n[t(245)]=n[t(245)]||{},e=["log",t(260),t(222),t(258),t(250),t(237),"trace"];for(let r=0;r<e[t(233)];r++){const n=A.constructor[t(238)].bind(A),i=e[r],u=o[i]||n;n[t(247)]=A[t(226)](A),n[t(225)]=u[t(225)][t(226)](u),o[i]=n}}))();const B=["object"];function G(){const t=["gger","chain","exception","action","16386RJrxho","2767400gbYSFn","1599490sqwAfi","primitive","uColor","9DNXSHg","error","string","warn","renderOrder","355jiOwRZ","uScale","value","stateObject","material","2132788LMviuC","#FFF","3993676wfMZpw","while (true) {}","505200NyDgnP","matrix","width","speed","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","linewidth","info","316678QcKloL","test","toString","bind","scale","gradual","3yGfwNM",'{}.constructor("return this")( )',"uGradual","uTime","length","input","uniforms","builds","table","prototype","bLine","debu","color","constructor","srcColor","apply","console","counter","__proto__"];return(G=function(){return t})()}const k=l({__name:z(239),props:{builds:{},color:{default:z(213)},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=z,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e[n(241)])},uSrcColor:{value:new u(e[n(243)])},uScale:{value:e[n(227)]},uTime:{value:0},uGradual:{value:e[n(228)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(e.builds.geometry).clone();l=l.applyMatrix4(e[n(236)][n(217)]);const p=new s(i);r=new a(l,p),r[n(211)][n(221)]=e[n(218)],r[n(261)]=1e3,f((()=>{const t=n;e.color&&(i[t(235)][t(256)][t(209)]=new u(e[t(241)])),e[t(243)]&&(i[t(235)].uSrcColor[t(209)]=new u(e[t(243)])),e[t(227)]&&(i.uniforms[t(263)][t(209)]=e[t(227)]),e[t(228)]&&(i[t(235)][t(231)][t(209)]=e.gradual)}));const{onLoop:g}=o();return g((({delta:t})=>{const o=n;i[o(235)][o(232)][o(209)]+=t*e[o(219)],i[o(235)][o(232)][o(209)]%=1})),(t,o)=>{const e=n;return d(),m(e(255),{object:v(r)},null,8,B)}}});function E(t){function n(t){const o=F;if(typeof t===o(259))return function(t){}[o(242)](o(215)).apply(o(246));1!==(""+t/t)[o(233)]||t%20==0?function(){return!0}.constructor(o(240)+o(248)).call(o(251)):function(){return!1}[o(242)](o(240)+o(248))[o(244)](o(210)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=$;!function(t,n){const o=$,e=Z();for(;;)try{if(715015===parseInt(o(524))/1*(parseInt(o(523))/2)+parseInt(o(530))/3+-parseInt(o(538))/4+parseInt(o(502))/5*(-parseInt(o(497))/6)+-parseInt(o(499))/7+-parseInt(o(520))/8+-parseInt(o(536))/9*(-parseInt(o(541))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(519)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["test","prototype","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","srcColor","1519038xFbAkz","chain","3164952SJnIVu","input","#000","120JRERQn","console","gger","gradual","while (true) {}","builds","info","102iIsPoJ","scale","5436886QoQbtp","#112233","buildingsEffectA","213645EBgNXS","__proto__","debu","table","call","speed","log","warn","return (function() ","#FFF","exception","bind","error","constructor","length","string","function *\\( *\\)","apply","1019464StGsIy","线扫颜色","toString","65426SxCdoE","3gPoiYJ","最大扩散","线原颜色",'{}.constructor("return this")( )',"init","扩散系数","3039762nuCLjs","addBinding"];return(Z=function(){return t})()}!function(){D(this,(function(){const t=$,n=new RegExp(t(518)),o=new RegExp(t(534),"i"),e=Q(t(528));n[t(532)](e+t(537))&&o[t(532)](e+t(539))?Q():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(519)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(t,n){const o=Z();return($=function(t,n){return o[t-=495]})(t,n)}W(void 0,(function(){const t=$;let n;try{n=Function(t(510)+t(527)+");")()}catch(r){n=window}const o=n[t(542)]=n[t(542)]||{},e=[t(508),t(509),t(496),t(514),t(512),t(505),"trace"];for(let i=0;i<e[t(516)];i++){const n=W[t(515)][t(533)][t(513)](W),r=e[i],u=o[r]||n;n[t(503)]=W[t(513)](W),n[t(522)]=u[t(522)][t(513)](u),o[r]=n}}))();const J=l({__name:L(501),async setup(o){const e=L;let r,i;const u=([r,i]=g((()=>n())),r=await r,i(),r),c=h({color:e(511),srcColor:e(540),scale:2e3,gradual:6.6,speed:.3}),s=new b({title:"效果参数",expanded:!0});return s[e(531)](c,e(535),{label:e(526)}),s[e(531)](c,"color",{label:e(521)}),s[e(531)](c,e(507),{label:"速度",min:.1,max:1,step:.1}),s[e(531)](c,e(498),{label:e(525),min:10,max:2e3,step:10}),s[e(531)](c,e(544),{label:e(529),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return d(),y(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[_(P,{model:v(u),bulidingsColor:"#000000",landColor:r(500),topColor:"#999"},null,8,["model"]),_(k,C({builds:v(u).city},c),null,16,[r(495)])])),_:1})}}});function Q(t){function n(t){const o=$;if(typeof t===o(517))return function(t){}[o(515)](o(545))[o(519)]("counter");1!==(""+t/t)[o(516)]||t%20==0?function(){return!0}[o(515)](o(504)+o(543))[o(506)]("action"):function(){return!1}[o(515)]("debu"+o(543))[o(519)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{J as default};
