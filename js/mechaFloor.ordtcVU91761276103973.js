import{P as e}from"./tweakpane.CqZAnw7f1761276103973.js";import{F as a,N as s,u as o,_ as t,K as r}from"./@tresjs.B_KjVy0E1761276103973.js";import"./OimoPhysicsBuffer.BXemNmye1761276103973.js";import{_ as n}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.DxF4X4Ny1761276103973.js";import"./vanilla.esm.5.5.0.CRlEbOMK1761276103973.js";import"./Resource.CSaxGSPI1761276103973.js";import"./PackedMipMapGenerator.CqP5a0bT1761276103973.js";import{o as i,k as l,cv as c,ct as u,cu as m,d as p,cO as d,d2 as v,d3 as f}from"./three.Bhn4-0ry1761276103973.js";import{d as j,c as g,w as h,q as b,G as w,H as _,o as y,I as P,u as M,r as D,g as x,b as U,e as k,h as G,ap as S,a9 as C,aa as F}from"./@vue.CKlgtJke1761276103973.js";import"./postprocessing.CeTFUAN_1761276103973.js";import"./@vueuse.wtfleElW1761276103973.js";import"./oimophysics.CfVKSiAm1761276103973.js";import"./dither.glsl.tNAdkJUa1761276103973.js";import"./Reflector.CqqiY7381761276103973.js";import"./vite-plugin-qiankun.B06WoCqG1761276103973.js";import"./utils.CNife3_q1761276103973.js";import"./object-hash.1qNYTrnD1761276103973.js";import"./@amap.fjyZdsU91761276103973.js";import"./jszip.y_yjJ09m1761276103973.js";import"./three-stdlib.tb53t5ki1761276103973.js";const T={key:0},q=["object"],z=["object"],B=["object"],I=j({__name:"mechaFloor",props:{color:{default:"#ffed00"}},setup(e){const{renderer:r,scene:n,camera:j,sizes:D}=a(),x=e;let U=null;const k={uniforms:{tDiffuse:{value:null},contrast:{value:1.8}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",fragmentShader:"\n        uniform sampler2D tDiffuse;\n        uniform float contrast;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb = (color.rgb - 0.5) * contrast + 0.8;\n            gl_FragColor = color;\n        }\n    "},{state:G}=s("https://opensource.cdn.icegl.cn/model/floor/baseModelJ.glb",{draco:!0,decoderPath:"./draco/"}),S=g(()=>G?.value?.scene),{state:C}=s("plugins/floor/models/topoBase/baseModelL.glb",{draco:!0,decoderPath:"./draco/"}),{state:F}=s("https://opensource.cdn.icegl.cn/model/floor/baseModelK.glb",{draco:!0,decoderPath:"./draco/"}),I=g(()=>F.value?.animations||[]),R=g(()=>F?.value?.scene),{actions:H}=o(I,R);h(H,e=>{e.Scene&&e.Scene.play()}),h(S,e=>{e&&e.traverse(e=>{e instanceof i&&(e.material.emissive=new l("#ffed00"),e.material.emissiveIntensity=20.5,e.material.toneMapped=!0,e.material.needsUpdate=!0)})});const{onRender:K}=t();return K(()=>{U&&U.render()}),b(()=>{(()=>{const e=new v(r),a=new f,s=e.fromScene(a).texture;n.value.environment=s,S.value&&S.value.traverse(e=>{e instanceof i&&e.material&&(e.material.envMap=s,e.material.needsUpdate=!0)}),a.dispose()})(),setTimeout(()=>{(()=>{if(!r||!j.value||!D.width.value)return;U=new c(r);const e=new u(n.value,j.value);U.addPass(e);const a=new m(new p(D.width.value,D.height.value),.1,.1,.1);U.addPass(a);const s=new d(k);s.uniforms.contrast.value=1.1,U.addPass(s)})()},200)}),h(()=>[x.color],([e])=>{S.value&&S.value.traverse(a=>{a instanceof i&&a.material&&(a.material.emissive=new l(e))})}),(e,a)=>S.value&&R.value?(y(),w("TresGroup",T,[P("primitive",{object:S.value,"position-y":.01},null,8,q),M(C)?(y(),w("primitive",{key:0,object:M(C)?.scene,"position-y":.1},null,8,z)):_("",!0),P("primitive",{object:R.value,"position-y":.1},null,8,B)])):_("",!0)}}),R=j({__name:"mechaFloor",setup(a){const s=D({color:"#ffed00"}),o=new e({expanded:!0}),t={reflectivity:1,showGridHelper:!1,scale:2,renderMode:"manual"};return o.addBinding(s,"color",{label:"颜色"}),(e,a)=>{const o=x("TresCanvas");return y(),U(o,{clearColor:"#000000","window-size":""},{default:k(()=>[a[0]||(a[0]=P("TresPerspectiveCamera",{position:[3,5,0],fov:45,near:.1,far:1e4},null,-1)),G(M(r),{enableDamping:""}),(y(),U(S,null,{default:k(()=>[G(M(I),C(F(s)),null,16)]),_:1})),G(n,C(F(t)),null,16)]),_:1})}}});export{R as default};
