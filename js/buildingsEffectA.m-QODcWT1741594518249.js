import{P as t}from"./tweakpane.yDiyAAkA1741594518249.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.KQMNCWkC1741594518249.js";import{e}from"./@tresjs.gjafZgVK1741594518249.js";import{z as r}from"./three-custom-shader-material.Bah0Myv81741594518249.js";import{_ as i,C as u,cn as c,l as a,b9 as s}from"./three.8y0_KTxz1741594518249.js";import{d as l,a2 as f,w as p,o as d,H as m,u as v,a3 as g,r as h,f as y,g as w,j as C,m as _}from"./@vue.NRI7TcgI1741594518249.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741594518249.js";import"./postprocessing.iiPTtJPW1741594518249.js";import"./@vueuse.8xnC6EWf1741594518249.js";const b=T;!function(t,n){const o=T,e=I();for(;;)try{if(534210===parseInt(o(227))/1+parseInt(o(241))/2+-parseInt(o(233))/3*(-parseInt(o(239))/4)+parseInt(o(231))/5*(-parseInt(o(224))/6)+-parseInt(o(212))/7+-parseInt(o(213))/8*(parseInt(o(248))/9)+parseInt(o(258))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(234)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function I(){const t=["uTime","MeshBasicMaterial","value","test","opacity","17924770iGAicF","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","input","uGradient","#ffff00","object","debu","color","setStyle","console","length","forEach","boundingBox","constructor","warn","computeBoundingSphere","#ffffff","uColor","material","children","7059199RhMBtT","4187352XTznkU","while (true) {}","bModel","bulidingsColor","bind","uOpacity","clone","city","model","prototype","__proto__","318pyzpvI","info","topColor","147991yWASyf","return (function() ","function *\\( *\\)","call","53435htyrZU","Color","13437rKwGaI","apply","string","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","primitive","132wvdLPV","toString","2135282UMYOgF","dispose","land","gger","#e523ff","uniforms","log","18AnkpKA",'{}.constructor("return this")( )',"DoubleSide","#112233","landColor"];return(I=function(){return t})()}!function(){x(this,(function(){const t=T,n=new RegExp(t(229)),o=new RegExp(t(237),"i"),e=P("init");n[t(256)](e+t(236))&&o.test(e+t(261))?P():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(234)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=T,n=function(){const t=T;let n;try{n=Function(t(228)+t(249)+");")()}catch(o){n=window}return n}(),o=n[t(201)]=n.console||{},e=[t(247),t(206),t(225),"error","exception","table","trace"];for(let r=0;r<e[t(202)];r++){const n=M[t(205)][t(222)].bind(M),i=e[r],u=o[i]||n;n[t(223)]=M[t(217)](M),n[t(240)]=u[t(240)].bind(u),o[i]=n}}))();const S=[b(197)];function T(t,n){const o=I();return(T=function(t,n){return o[t-=195]})(t,n)}const j=l({__name:b(215),props:{model:{},bulidingsColor:{default:b(245)},landColor:{default:b(251)},topColor:{default:b(196)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,c=o[n(221)][n(220)];o[n(221)][n(221)][n(211)][0][n(210)]=new(i[n(254)])({color:n(196)}),c.renderOrder=1001;const a=o[n(221)][n(243)];(()=>{const t=n,{geometry:e}=c;e.computeBoundingBox(),e[t(207)]();const{max:a,min:s}=e[t(204)];if(c.material.__csm)return;const l=new r({baseMaterial:c[t(210)],vertexShader:t(260),fragmentShader:t(259),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(o[t(216)])},uOpacity:{value:o.opacity},uLightColor:{value:new(i[t(232)])(t(208))},uTopColor:{value:new(i[t(232)])(o[t(226)])},uTime:{value:0},uGradient:{value:o.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(250)]});c[t(210)][t(242)](),c.material=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c.material[o(246)][o(253)].value+=t})),f((()=>{const t=n;o.bulidingsColor&&c.material.uniforms[t(209)][t(255)].setStyle(o.bulidingsColor),o[t(252)]&&((t,e)=>{const r=n;let u;"cu"===t||t===r(243)&&(u=Array.isArray(a[r(210)])?a.material:[a[r(210)]],u[r(203)]((t=>{const n=r;t[e][n(200)](o[n(252)]),t.side=i[n(250)]})))})("land",t(199)),o[t(257)]&&(c.material.uniforms[t(218)][t(255)]=o[t(257)])})),p(o,((t,o)=>{const e=n;c[e(210)][e(246)][e(195)][e(255)]=t.gradient}));const l=o[n(221)][n(221)][n(219)]();return(t,o)=>{const e=n;return d(),m(e(238),{object:v(l)},null,8,S)}}});function P(t){function n(t){const o=T;if(typeof t===o(235))return function(t){}[o(205)](o(214)).apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(205)](o(198)+"gger")[o(230)]("action"):function(){return!1}[o(205)](o(198)+o(244))[o(234)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=R;function B(){const t=["#000","110frTUvR",'{}.constructor("return this")( )',"return (function() ","2896gHuRTt","warn","primitive","uSrcColor","error","4321746AHLtLo","9326SpueKV","39190SsTdUZ","function *\\( *\\)","object","renderOrder","speed","gradual","call","linewidth","applyMatrix4","debu","console","4963BJVexK","srcColor","trace","uScale","apply","433296mxnwRp","constructor","chain","while (true) {}","matrix","2086040JneubN","uniforms","toString","225168FrCwuv","length","scale","action","gger","info","bind","1639avhCiY","init","builds","__proto__","value","log","string","70NzyfNz","prototype","color","width","clone","#FFF"];return(B=function(){return t})()}!function(t,n){const o=R,e=B();for(;;)try{if(442851===parseInt(o(325))/1*(-parseInt(o(316))/2)+parseInt(o(342))/3+-parseInt(o(347))/4+parseInt(o(364))/5*(parseInt(o(350))/6)+-parseInt(o(337))/7*(parseInt(o(319))/8)+parseInt(o(324))/9+-parseInt(o(326))/10*(-parseInt(o(357))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(341)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){F(this,(function(){const t=R,n=new RegExp(t(327)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=G(t(358));n.test(e+t(344))&&o.test(e+"input")?G():e("0")}))()}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(341)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=R,n=function(){const t=R;let n;try{n=Function(t(318)+t(317)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(336)]||{},e=[t(362),t(320),t(355),t(323),"exception","table",t(339)];for(let r=0;r<e[t(351)];r++){const n=A[t(343)][t(365)].bind(A),i=e[r],u=o[i]||n;n[t(360)]=A[t(356)](A),n[t(349)]=u[t(349)][t(356)](u),o[i]=n}}))();const L=[O(328)],z=l({__name:"bLine",props:{builds:{},color:{default:O(369)},srcColor:{default:O(315)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(366)])},uSrcColor:{value:new u(o[n(338)])},uScale:{value:o.scale},uTime:{value:0},uGradual:{value:o[n(331)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(359)].geometry)[n(368)]();l=l[n(334)](o[n(359)][n(346)]);const p=new a(i);r=new s(l,p),r.material[n(333)]=o[n(367)],r[n(329)]=1e3,f((()=>{const t=n;o[t(366)]&&(i.uniforms.uColor[t(361)]=new u(o[t(366)])),o[t(338)]&&(i[t(348)][t(322)][t(361)]=new u(o.srcColor)),o[t(352)]&&(i[t(348)][t(340)][t(361)]=o.scale),o[t(331)]&&(i[t(348)].uGradual[t(361)]=o[t(331)])}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(348)].uTime.value+=t*o[e(330)],i.uniforms.uTime[e(361)]%=1})),(t,o)=>{const e=n;return d(),m(e(321),{object:v(r)},null,8,L)}}});function R(t,n){const o=B();return(R=function(t,n){return o[t-=315]})(t,n)}function G(t){function n(t){const o=R;if(typeof t===o(363))return function(t){}.constructor(o(345))[o(341)]("counter");1!==(""+t/t)[o(351)]||t%20==0?function(){return!0}[o(343)]("debu"+o(354))[o(332)](o(353)):function(){return!1}[o(343)](o(335)+o(354))[o(341)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}!function(t,n){const o=H,e=k();for(;;)try{if(437096===-parseInt(o(182))/1*(-parseInt(o(207))/2)+parseInt(o(201))/3*(parseInt(o(200))/4)+parseInt(o(196))/5*(-parseInt(o(202))/6)+parseInt(o(221))/7+-parseInt(o(180))/8*(parseInt(o(188))/9)+parseInt(o(210))/10*(parseInt(o(215))/11)+-parseInt(o(181))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=H,n=new RegExp(t(232)),o=new RegExp(t(209),"i"),e=W(t(211));n[t(220)](e+t(186))&&o[t(220)](e+t(189))?W():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(229)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(){const t=["5MtIwCI","gradual","stateObject","扩散系数","3287636pVDECh","3vuLbOh","1788258LOFyPV","线扫颜色","speed","srcColor","gger","1035676oYsdlw","#000000","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","290jWKvYK","init","console","__proto__","toString","185515jkTcSP","scale","trace",'{}.constructor("return this")( )',"city","test","4225025oTyESG","#FFF","#999","constructor","warn","#000","length","color","apply","bind","prototype","function *\\( *\\)","效果参数","255336HorLrS","19984212xUtZRW","1hLjrIg","model","exception","error","chain","addBinding","9QLVYdk","input","counter","action","线原颜色","debu","string","while (true) {}"];return(k=function(){return t})()}function H(t,n){const o=k();return(H=function(t,n){return o[t-=180]})(t,n)}Z(void 0,(function(){const t=H;let n;try{n=Function("return (function() "+t(218)+");")()}catch(r){n=window}const o=n[t(212)]=n[t(212)]||{},e=["log",t(225),"info",t(185),t(184),"table",t(217)];for(let i=0;i<e[t(227)];i++){const n=Z[t(224)][t(231)][t(230)](Z),r=e[i],u=o[r]||n;n[t(213)]=Z[t(230)](Z),n.toString=u[t(214)].bind(u),o[r]=n}}))();const V=l({__name:"buildingsEffectA",async setup(e){const r=H;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:r(222),srcColor:r(226),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(233),expanded:!0});return s[r(187)](a,r(205),{label:r(192)}),s[r(187)](a,r(228),{label:r(203)}),s.addBinding(a,r(204),{label:"速度",min:.1,max:1,step:.1}),s.addBinding(a,r(216),{label:"最大扩散",min:10,max:2e3,step:10}),s.addBinding(a,r(197),{label:r(199),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(j,{model:v(c),bulidingsColor:e(208),landColor:"#112233",topColor:e(223)},null,8,[e(183)]),C(z,_({builds:v(c)[e(219)]},a),null,16,["builds"])])),_:1})}}});function W(t){function n(t){const o=H;if(typeof t===o(194))return function(t){}[o(224)](o(195))[o(229)](o(190));1!==(""+t/t)[o(227)]||t%20==0?function(){return!0}[o(224)](o(193)+"gger").call(o(191)):function(){return!1}.constructor(o(193)+o(206))[o(229)](o(198)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as default};
