{"version":3,"file":"smokeA.vue_vue_type_script_setup_true_lang.DU_w_c7I1767105581793.js","sources":["../../src/plugins/digitalCity/components/smoke/smokeA.vue"],"sourcesContent":["<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-03-18 10:12:36\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-26 13:12:33\n-->\n<script setup lang=\"ts\">\nimport { watch, ref, toRaw } from 'vue'\nimport { useTexture } from '@tresjs/cientos'\nimport { useLoop } from '@tresjs/core'\nimport * as THREE from 'three'\nimport SPE from '../../common/ShaderParticleEngine/build/SPE'\n\n// ---------- 纹理加载 ----------\nconst { state: pTexture } = useTexture('./plugins/digitalCity/image/smokeparticle.png')\nlet particleGroup = null as any\nconst objCloud = ref<THREE.Mesh | null>(null)\nwatch(\n  () => pTexture.value,\n  (mapv) => {\n    if (!mapv) return\n    particleGroup = new SPE.Group({\n      blending: THREE.NormalBlending,\n      texture: {\n        value: mapv\n      },\n      depthTest: true,\n      depthWrite: false,\n      // 先不传 texture，纹理加载后赋值\n    })\n\n\n    // ---------- 创建 Emitter ----------\n    const emitter = new SPE.Emitter({\n      type: SPE.distributions.BOX,\n      particleCount: 100,\n      maxAge: { value: 4 },\n      position: {\n        value: new THREE.Vector3(0, 0, 0),\n        spread: new THREE.Vector3(2, 0, 2),\n        radius: 1,\n      },\n      velocity: {\n        value: new THREE.Vector3(0, 16, 0),\n        spread: new THREE.Vector3(12, 40, 12),\n        distribution: SPE.distributions.BOX,\n      },\n      size: {\n        value: [200, 100, 100],\n        spread: [14, 10, 8],\n        randomise: true,\n      },\n      acceleration: {\n        value: new THREE.Vector3(0, 10, 0),\n      },\n      angle: {\n        value: 0,\n        spread: 120,\n      },\n      opacity: {\n        value: [0.5, 0.1],\n        spread: [0.1, 0],\n        randomise: true,\n      },\n      color: {\n        value: new THREE.Color('#333333'),\n      },\n    })\n\n    particleGroup.addEmitter(emitter)\n\n    objCloud.value = particleGroup.mesh\n\n  })\n\nconst { onBeforeRender } = useLoop()\n\nonBeforeRender(({ delta }) => {\n  if (particleGroup) {\n    particleGroup.tick(delta)\n  }\n})\n</script>\n\n<template>\n  <primitive v-if=\"objCloud\" :object=\"toRaw(objCloud)\" :position=\"[-130, 26, 20]\" :renderOrder=\"3000\" />\n</template>\n"],"names":["useTexture","useLoop"],"mappings":";;;;;;;;AASA,KAAA,CAAA,CAAA,KAAA,CAAA,GAAA,CAAA,KAAA,CAAA,CAAA,CAAA,CAAA,KAAA,CAAA,YAAA,CAAA,CAAA,GAAA,CAAA,CAAA;AAGA,KAAA,CAAA,KAAA,CAAA,CAAA,CAAA,KAAA,CAAA,YAAA,CAAA,OAAA,CAAA;;;;AAIA,CAAA,CAAA,CAAA,CAAA,KAAA,CAAM,CAAA,CAAE,KAAA,CAAA,CAAO,QAAA,EAAS,CAAA,CAAA,CAAIA,GAAW,CAAA,CAAA,CAAA,OAAA,CAAA,WAAA,CAAA,KAAA,CAAA,aAAA,CAAA,GAAA,CAA+C,CAAA;AACtF,CAAA,CAAA,CAAA,CAAA,GAAA,CAAI,aAAA,CAAA,CAAA,CAAgB,IAAA;AACpB,CAAA,CAAA,CAAA,CAAA,MAAM,QAAA,CAAA,CAAA,CAAW,IAAuB,IAAI,CAAA;AAC5C,CAAA,CAAA,CAAA,CAAA,KAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACE,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,QAAA,CAAS,KAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACf,CAAC,IAAA,CAAA,CAAA,CAAA,CAAA,CAAS;AACR,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAI,CAAC,IAAA,CAAA,CAAM,MAAA;AACX,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,aAAA,CAAA,CAAA,CAAgB,GAAA,CAAI,IAAI,KAAA,CAAM;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAC5B,UAAU,KAAA,CAAM,cAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAChB,OAAA,CAAA,CAAS;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACP,KAAA,CAAA,CAAO;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACT;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,SAAA,EAAW,IAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACX,UAAA,CAAA,CAAY;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,OAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAEb,CAAA;AAID,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,MAAM,OAAA,CAAA,CAAA,CAAU,IAAI,GAAA,CAAI,OAAA,CAAQ;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAC9B,IAAA,CAAA,CAAM,IAAI,aAAA,CAAc,GAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACxB,aAAA,EAAe,GAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACf,MAAA,CAAA,CAAQ,CAAA,CAAE,KAAA,CAAA,CAAO,CAAA,CAAA,CAAE;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACnB,QAAA,CAAA,CAAU;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACR,OAAO,GAAA,CAAI,KAAA,CAAM,OAAA,CAAQ,CAAA,CAAA,CAAG,GAAG,CAAC,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAChC,QAAQ,GAAA,CAAI,KAAA,CAAM,OAAA,CAAQ,CAAA,CAAA,CAAG,GAAG,CAAC,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACjC,MAAA,CAAA,CAAQ;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACV;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,QAAA,CAAA,CAAU;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACR,OAAO,GAAA,CAAI,KAAA,CAAM,OAAA,CAAQ,CAAA,CAAA,CAAG,IAAI,CAAC,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACjC,QAAQ,GAAA,CAAI,KAAA,CAAM,OAAA,CAAQ,EAAA,CAAA,CAAI,IAAI,EAAE,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACpC,YAAA,CAAA,CAAc,IAAI,aAAA,CAAc;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAClC;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,IAAA,CAAA,CAAM;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACJ,KAAA,EAAO,CAAC,GAAA,EAAK,GAAA,CAAA,CAAK,GAAG,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACrB,MAAA,EAAQ,CAAC,EAAA,EAAI,EAAA,CAAA,CAAI,CAAC,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAClB,SAAA,CAAA,CAAW;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACb;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,YAAA,CAAA,CAAc;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACZ,OAAO,GAAA,CAAI,KAAA,CAAM,OAAA,CAAQ,CAAA,CAAA,CAAG,IAAI,CAAC;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACnC;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,KAAA,CAAA,CAAO;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACL,KAAA,EAAO,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACP,MAAA,CAAA,CAAQ;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACV;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,OAAA,CAAA,CAAS;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACP,KAAA,CAAA,CAAO,CAAC,CAAA,CAAA,CAAA,CAAA,CAAK,GAAG,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAChB,MAAA,CAAA,CAAQ,CAAC,CAAA,CAAA,CAAA,CAAA,CAAK,CAAC,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACf,SAAA,CAAA,CAAW;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACb;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACA,KAAA,CAAA,CAAO;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACL,KAAA,CAAA,CAAO,GAAA,CAAI,KAAA,CAAM,KAAA,CAAM,CAAA,CAAA,MAAA,CAAS;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAClC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACD,CAAA;AAED,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,aAAA,CAAc,WAAW,OAAO,CAAA;AAEhC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,QAAA,CAAS,QAAQ,aAAA,CAAc,IAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAEjC;AAAA,CAAA,CAAA,CAAA,CAAA,CAAC;AAEH,CAAA,CAAA,CAAA,CAAA,MAAM,CAAA,CAAE,cAAA,CAAA,CAAe,CAAA,CAAA,CAAIC,EAAA,CAAA,CAAQ;AAEnC,CAAA,CAAA,CAAA,CAAA,cAAA,CAAe,CAAC,CAAA,CAAE,KAAA,EAAM,CAAA,CAAA,CAAA,CAAA,CAAM;AAC5B,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAI,aAAA,CAAA,CAAe;AACjB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,aAAA,CAAc,KAAK,KAAK,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAC1B;AAAA,CAAA,CAAA,CAAA,CACF,CAAC,CAAA;;aAIkB,QAAA,CAAA,KAAA,CAAA,CAAA,CAAA,eAAjB,oBAAsG,CAAA,SAAA,CAAA,CAAA,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAA1E,MAAA,CAAA,CAAQ,KAAA,CAAM,QAAA,CAAA,KAAQ,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAI,QAAA,EAAU,CAAA,CAAA,GAAA,EAAA,EAAA,CAAA,CAAA,EAAA,CAAA;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAiB,WAAA,CAAA,CAAa;AAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;;;;;"}