import{importShared as e,Ai as t}from"./3d-tiles-renderer.HXNTGnH81769411460564.js";import{useTres as o,useLoop as r}from"./index.KfH1904l1769411460564.js";import{applyTransform as i,alignmentCenter as a}from"./utils.C0_PBIOc1769411460564.js";const{defineComponent:s}=await e("vue"),{unref:l,createElementVNode:n,openBlock:u,createElementBlock:p}=await e("vue"),d=["object"],{watch:m,ref:c}=await e("vue"),f=s({__name:"obliquePhoto",props:{tilesUrl:{default:"./plugins/geokit/tiles/tileset.json"},isRotation:{type:Boolean,default:!1},isRranslation:{type:Boolean,default:!0}},setup(e,{expose:s}){const f=e,v=c(null),{camera:R,renderer:g,sizes:j}=o(),w=(e,t,o)=>{e.setCamera(t),e.setResolutionFromRenderer(t,o)},B=()=>{let e=new t(f.tilesUrl);return e.fetchOptions.mode="cors",e.addEventListener("load-tile-set",()=>{a(e,f.isRotation,f.isRranslation)}),e.addEventListener("dispose-model",({scene:e})=>{e.traverse(e=>{e.material&&e.material.dispose()})}),w(e,R.value,g),e};let h=B();m(()=>[f.isRotation,f.isRranslation],()=>{h.group&&i(h.group,f.isRotation,f.isRranslation)}),m(R,()=>{R.value&&w(h,R.value,g)},{immediate:!0});const{onBeforeRender:k}=r();return k(()=>{R.value&&j.width.value&&h.update&&(R.value.updateMatrixWorld(),h.update())}),m(()=>f.tilesUrl,e=>{e!==h.rootURL&&(h.dispose(),h=B())}),s({group:v,tilesGroup:h.group}),(e,t)=>(u(),p("TresGroup",{ref_key:"groupRef",ref:v},[n("primitive",{object:l(h).group},null,8,d)],512))}});export{f as _sfc_main};
