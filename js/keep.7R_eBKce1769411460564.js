import{importShared as e}from"./3d-tiles-renderer.HXNTGnH81769411460564.js";import{createInjectionKey as t,warn as n}from"./light.5onBk1LA1769411460564.js";import{off as o,on as r}from"./use-merged-state.BUfpY5Fh1769411460564.js";import{createId as i,getPreciseEventTarget as l,flatten as u}from"./Scrollbar.DcAqFYBN1769411460564.js";const{ref:s,readonly:a,watch:d}=await e("vue");function c(e){const t=s(!!e.value);if(t.value)return a(t);const n=d(e,e=>{e&&(t.value=!0,n())});return a(t)}const{getCurrentInstance:f}=await e("vue");function h(){return null!==f()}const p="undefined"!=typeof window,v=t("n-drawer-body"),m=t("n-drawer"),y=t("n-modal-body"),x=t("n-modal-provider"),g=t("n-modal"),b=t("n-popover-body"),{Fragment:w,createTextVNode:I,Comment:S}=await e("vue");function E(e,t,n="default"){const o=t[n];if(void 0===o)throw new Error(`[vueuc/${e}]: slot[${n}] is empty.`);return o()}function F(e,t=!0,n=[]){return e.forEach(e=>{if(null!==e)if("object"==typeof e)if(Array.isArray(e))F(e,t,n);else if(e.type===w){if(null===e.children)return;Array.isArray(e.children)&&F(e.children,t,n)}else e.type!==S&&n.push(e);else"string"!=typeof e&&"number"!=typeof e||n.push(I(String(e)))}),n}function T(e,t,n="default"){const o=t[n];if(void 0===o)throw new Error(`[vueuc/${e}]: slot[${n}] is empty.`);const r=F(o());if(1===r.length)return r[0];throw new Error(`[vueuc/${e}]: slot[${n}] should have exactly one child.`)}const $="@@coContext",z={mounted(e,{value:t,modifiers:n}){e[$]={handler:void 0},"function"==typeof t&&(e[$].handler=t,r("clickoutside",e,t,{capture:n.capture}))},updated(e,{value:t,modifiers:n}){const i=e[$];"function"==typeof t?i.handler?i.handler!==t&&(o("clickoutside",e,i.handler,{capture:n.capture}),i.handler=t,r("clickoutside",e,t,{capture:n.capture})):(e[$].handler=t,r("clickoutside",e,t,{capture:n.capture})):i.handler&&(o("clickoutside",e,i.handler,{capture:n.capture}),i.handler=void 0)},unmounted(e,{modifiers:t}){const{handler:n}=e[$];n&&o("clickoutside",e,n,{capture:t.capture}),e[$].handler=void 0}};const Z=new class{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(e,t){const{elementZIndex:n}=this;if(void 0!==t)return e.style.zIndex=`${t}`,void n.delete(e);const{nextZIndex:o}=this;if(n.has(e)){if(n.get(e)+1===this.nextZIndex)return}e.style.zIndex=`${o}`,n.set(e,o),this.nextZIndex=o+1,this.squashState()}unregister(e,t){const{elementZIndex:n}=this;var o,r;n.has(e)?n.delete(e):void 0===t&&(o="z-index-manager/unregister-element",r="Element not found when unregistering.",console.error(`[vdirs/${o}]: ${r}`)),this.squashState()}squashState(){const{elementCount:e}=this;e||(this.nextZIndex=2e3),this.nextZIndex-e>2500&&this.rearrange()}rearrange(){const e=Array.from(this.elementZIndex.entries());e.sort((e,t)=>e[1]-t[1]),this.nextZIndex=2e3,e.forEach(e=>{const t=e[0],n=this.nextZIndex++;`${n}`!==t.style.zIndex&&(t.style.zIndex=`${n}`)})}},N="@@ziContext",A={mounted(e,t){const{value:n={}}=t,{zIndex:o,enabled:r}=n;e[N]={enabled:!!r,initialized:!1},r&&(Z.ensureZIndex(e,o),e[N].initialized=!0)},updated(e,t){const{value:n={}}=t,{zIndex:o,enabled:r}=n,i=e[N].enabled;r&&!i&&(Z.ensureZIndex(e,o),e[N].initialized=!0),e[N].enabled=!!r},unmounted(e,t){if(!e[N].initialized)return;const{value:n={}}=t,{zIndex:o}=n;Z.unregister(e,o)}};function k(e){return"string"==typeof e?document.querySelector(e):e()||null}const{Teleport:C,h:j,toRef:B,computed:L,defineComponent:R}=await e("vue"),q=R({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup:e=>({showTeleport:c(B(e,"show")),mergedTo:L(()=>{const{to:t}=e;return null!=t?t:"body"})}),render(){return this.showTeleport?this.disabled?E("lazy-teleport",this.$slots):j(C,{disabled:this.disabled,to:this.mergedTo},E("lazy-teleport",this.$slots)):null}});function V(e){return e instanceof HTMLElement}function M(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if(V(n)&&(D(n)||M(n)))return!0}return!1}function O(e){for(let t=e.childNodes.length-1;t>=0;t--){const n=e.childNodes[t];if(V(n)&&(D(n)||O(n)))return!0}return!1}function D(e){if(!function(e){if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return"hidden"!==e.type&&"file"!==e.type;case"SELECT":case"TEXTAREA":return!0;default:return!1}}(e))return!1;try{e.focus({preventScroll:!0})}catch(t){}return document.activeElement===e}const{h:H,defineComponent:P,ref:U,Fragment:X,onMounted:G,onBeforeUnmount:J,watch:K}=await e("vue");let Q=[];const W=P({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:[String,Function],finalFocusTo:[String,Function],returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const t=i(),n=U(null),u=U(null);let s=!1,a=!1;const d="undefined"==typeof document?null:document.activeElement;function c(){return Q[Q.length-1]===t}function f(t){var n;"Escape"===t.code&&c()&&(null===(n=e.onEsc)||void 0===n||n.call(e,t))}function h(e){if(!a&&c()){const t=p();if(null===t)return;if(t.contains(l(e)))return;m("first")}}function p(){const e=n.value;if(null===e)return null;let t=e;for(;!(t=t.nextSibling,null===t||t instanceof Element&&"DIV"===t.tagName););return t}function v(){var n;if(e.disabled)return;if(document.removeEventListener("focus",h,!0),Q=Q.filter(e=>e!==t),c())return;const{finalFocusTo:o}=e;void 0!==o?null===(n=k(o))||void 0===n||n.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&d instanceof HTMLElement&&(a=!0,d.focus({preventScroll:!0}),a=!1)}function m(t){if(c()&&e.active){const e=n.value,o=u.value;if(null!==e&&null!==o){const n=p();if(null==n||n===o)return a=!0,e.focus({preventScroll:!0}),void(a=!1);a=!0;const r="first"===t?M(n):O(n);a=!1,r||(a=!0,e.focus({preventScroll:!0}),a=!1)}}}return G(()=>{K(()=>e.active,n=>{n?(!function(){var n;if(e.disabled)return;if(Q.push(t),e.autoFocus){const{initialFocusTo:t}=e;void 0===t?m("first"):null===(n=k(t))||void 0===n||n.focus({preventScroll:!0})}s=!0,document.addEventListener("focus",h,!0)}(),r("keydown",document,f)):(o("keydown",document,f),s&&v())},{immediate:!0})}),J(()=>{o("keydown",document,f),s&&v()}),{focusableStartRef:n,focusableEndRef:u,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:function(e){if(a)return;const t=p();null!==t&&(null!==e.relatedTarget&&t.contains(e.relatedTarget)?m("last"):m("first"))},handleEndFocus:function(e){a||(null!==e.relatedTarget&&e.relatedTarget===n.value?m("last"):m("first"))}}},render(){const{default:e}=this.$slots;if(void 0===e)return null;if(this.disabled)return e();const{active:t,focusableStyle:n}=this;return H(X,null,[H("div",{"aria-hidden":"true",tabindex:t?"0":"-1",ref:"focusableStartRef",style:n,onFocus:this.handleStartFocus}),e(),H("div",{"aria-hidden":"true",style:n,ref:"focusableEndRef",tabindex:t?"0":"-1",onFocus:this.handleEndFocus})])}});function Y(e,t="default",o=void 0){const r=e[t];if(!r)return n("getFirstSlotVNode",`slot[${t}] is empty`),null;const i=u(r(o));return 1===i.length?i[0]:(n("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)}function _(e,t,o){if(!t)return null;const r=u(t(o));return 1===r.length?r[0]:(n("getFirstSlotVNode",`slot[${e}] should have exactly one child`),null)}function ee(e,t=[],n){const o={};return t.forEach(t=>{o[t]=e[t]}),Object.assign(o,n)}export{W as FocusTrap,q as LazyTeleport,z as clickoutside,v as drawerBodyInjectionKey,m as drawerInjectionKey,Y as getFirstSlotVNode,_ as getFirstSlotVNodeWithTypedProps,T as getFirstVNode,E as getSlot,h as hasInstance,p as isBrowser,ee as keep,y as modalBodyInjectionKey,g as modalInjectionKey,x as modalProviderInjectionKey,b as popoverBodyInjectionKey,c as useFalseUntilTruthy,A as zindexable};
