import{P as t}from"./tweakpane.ivGeiIdz1743660816268.js";import{_ as n,l as e,b as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.YKMl6SIC1743660816268.js";import{h as r}from"./heatmap.js-fix.Aow_vbex1743660816268.js";import{a as i,a9 as s,c6 as a,M as c,l as u,B as p,n as l,ab as f}from"./three.2wx8FU0g1743660816268.js";import{r as m}from"./utils.G6Ajo17E1743660816268.js";import{d}from"./pinia.0dYyFDku1743660816268.js";import{b as h,d as g,a2 as y,o as v,H as w,N as b,u as _,F as j,q as x,W as I,P as D,R as M,L as P,O,a4 as R,r as U,j as S,g as E,m as z}from"./@vue.B5PFBfKs1743660816268.js";import{c as A,d as B,a as T}from"./three-mesh-bvh.HGLjHqG91743660816268.js";import{_ as V}from"./@fesjs.9AUNBPBQ1743660816268.js";import"./@tresjs.zc7faK4J1743660816268.js";import"./postprocessing.ApTwx-211743660816268.js";import"./@vueuse.jtbb8I7w1743660816268.js";import"./three-custom-shader-material.uMc5A1EX1743660816268.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1743660816268.js";import"./@amap.c8pGcSIC1743660816268.js";import"./vue-router.K4ys0Z-O1743660816268.js";import"./lodash-es.IJc9G_SW1743660816268.js";import"./@qlin.o0hjOMCg1743660816268.js";import"./@floating-ui.HzHndBae1743660816268.js";import"./@juggle.4EyLec-41743660816268.js";function k(t,n){const e=C();return k=function(t,n){return e[t-=437]},k(t,n)}!function(t,n){const e=k,o=C();for(;;)try{if(179384===-parseInt(e(447))/1+-parseInt(e(461))/2*(-parseInt(e(486))/3)+parseInt(e(451))/4*(-parseInt(e(465))/5)+parseInt(e(469))/6*(parseInt(e(459))/7)+parseInt(e(456))/8*(-parseInt(e(464))/9)+-parseInt(e(454))/10*(-parseInt(e(483))/11)+parseInt(e(471))/12)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const F=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[k(481)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){F(this,(function(){const t=k,n=new RegExp(t(476)),e=new RegExp(t(468),"i"),o=$("init");n[t(460)](o+t(470))&&e[t(460)](o+t(440))?$():o("0")}))()}();const L=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[k(481)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();L(void 0,(function(){const t=k,n=function(){const t=k;let n;try{n=Function(t(473)+'{}.constructor("return this")( ));')()}catch(e){n=window}return n}(),e=n[t(489)]=n[t(489)]||{},o=[t(449),t(467),"info","error","exception",t(484),"trace"];for(let r=0;r<o[t(448)];r++){const n=L.constructor.prototype[t(441)](L),i=o[r],s=e[i]||n;n[t(490)]=L[t(441)](L),n.toString=s[t(450)][t(441)](s),e[i]=n}}))();const Z=(t,n)=>t[k(455)](n)+-10;function C(){const t=["5PeyOyJ","height","warn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","176610CgiKjQ","chain","7452804DWczPR","_config","return (function() ","rgb(0,255,0)","while (true) {}","function *\\( *\\)","randInt","left","none","style","apply","gger","11PYdvBT","table","yellow","21KOdiCr","counter","push","console","__proto__","debu","action","top","input","bind","stateObject","setData","rgb(0,0,255)","rgb(255,0,0)","constructor","268215IDpzIt","length","log","toString","1240332ZyFVxR","call","string","1441850GeDsbv","getValueAt","1432168fMNVNk","body","heatmap-canvas","21UpAwos","test","23756UDyisU","create","absolute","9zIgVdp"];return(C=function(){return t})()}function $(t){function n(t){const e=k;if(typeof t===e(453))return function(t){}.constructor(e(475))[e(481)](e(487));1!==(""+t/t)[e(448)]||t%20==0?function(){return!0}[e(446)](e(437)+e(482))[e(452)](e(438)):function(){return!1}.constructor(e(437)+e(482)).apply(e(442)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function G(t,n){const e=W();return G=function(t,n){return e[t-=117]},G(t,n)}const H=G;!function(t,n){const e=G,o=W();for(;;)try{if(467409===parseInt(e(117))/1*(parseInt(e(127))/2)+parseInt(e(126))/3+parseInt(e(154))/4*(parseInt(e(140))/5)+-parseInt(e(149))/6+parseInt(e(143))/7*(parseInt(e(155))/8)+-parseInt(e(128))/9+-parseInt(e(153))/10)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const J=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[G(132)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){J(this,(function(){const t=G,n=new RegExp(t(139)),e=new RegExp(t(136),"i"),o=K(t(148));n[t(147)](o+t(131))&&e[t(147)](o+t(151))?K():o("0")}))()}();const N=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function W(){const t=['{}.constructor("return this")( )',"table","356283DUisxa","178130YVGJnF","321345RMeLJQ","toString","info","chain","apply","while (true) {}","debu","trace","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","value","function *\\( *\\)","20GuQPDr","bind","console","399GYDumc","error","warn","gger","test","init","1515168lfpNeO","buildingsHeatmap","input","prototype","12694320tAgmUM","93232mIxrPJ","129464lucZrc","10rHDmVL","counter","length","log","call","stateObject","constructor"];return(W=function(){return t})()}N(void 0,(function(){const t=G,n=function(){const t=G;let n;try{n=Function("return (function() "+t(124)+");")()}catch(e){n=window}return n}(),e=n[t(142)]=n.console||{},o=[t(120),t(145),t(130),t(144),"exception",t(125),t(135)];for(let r=0;r<o[t(119)];r++){const n=N[t(123)][t(152)][t(141)](N),i=o[r],s=e[i]||n;n.__proto__=N[t(141)](N),n[t(129)]=s[t(129)][t(141)](s),e[i]=n}}))();const Y=d(H(150),(()=>{const t=h(!1),n=h(0);return{showDiv:t,temperature:n,setShowDiv:function(n){t[G(138)]=n},setTemperature:function(t){n[G(138)]=t}}}));function K(t){function n(t){const e=G;if(typeof t===e(137))return function(t){}[e(123)](e(133))[e(132)](e(118));1!==(""+t/t).length||t%20==0?function(){return!0}[e(123)](e(134)+e(146))[e(121)]("action"):function(){return!1}[e(123)](e(134)+e(146)).apply(e(122)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const Q=["object","rotation-x"],q=["object"],X=g({__name:"buildingsHeatmap",props:{model:{},opacity:{default:1}},setup(t){p.prototype.computeBoundsTree=A,p.prototype.disposeBoundsTree=B,u.prototype.raycast=T;const n=t,e=((t=250,n=250,e=!0)=>{const o=k,i=document.createElement(o(458));return i[o(480)].position=o(463),!e&&(i.style.display=o(479)),i[o(480)][o(439)]="0",i.style[o(478)]="0",document[o(457)].appendChild(i),r[o(462)]({container:i,width:t,height:n,blur:".8",radius:10,gradient:{.25:o(444),.55:o(474),.85:o(485),1:o(445)}})})();((t,n)=>{const e=k;if(!n){let o=0;for(n=[];o<1e3;)n[e(488)]({x:i[e(477)](1,t._config.width),y:i[e(477)](1,t[e(472)][e(466)]),value:i.randInt(-10,36)}),o++}t[e(443)]({max:36,min:-10,data:n})})(e);const o=new s(e._renderer.canvas);o.needsUpdate=!0;const d=n.model.city.clone();delete d.geometry.attributes.normal,delete d.geometry.attributes.uv;const h=d.geometry.clone().applyMatrix4(d.matrix),g=n.model.land.clone();delete g.geometry.attributes.normal;const x=g.geometry.clone().applyMatrix4(g.matrix),I=a([h,x]);I.applyMatrix4((new c).makeRotationX(Math.PI/2)),m(I),I.computeBoundsTree();const D=(M=o,new l({vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\tvUv = uv;\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform sampler2D heightMap;\n\t\tuniform float uOpacity;\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tgl_FragColor = vec4(texture2D(heightMap, vUv.xy).rgb, uOpacity);\n    }\n\t\t",uniforms:{uOpacity:{value:n.opacity},heightMap:{type:"t",value:M}},depthWrite:!0,depthTest:!0,transparent:!0,side:f}));var M;const P=new u(I,D);y((()=>{n.opacity&&(D.uniforms.uOpacity.value=n.opacity)}));const O=Y(),R=t=>{if(t){const n={x:t.uv.x*e._config.width,y:(1-t.uv.y)*e._config.height};console.log("数值：",t),console.log("数值———：",Z(e,n)),O.setTemperature(Z(e,n))}},U=t=>{t&&O.$patch({showDiv:!0})},S=t=>{t&&O.setShowDiv(!1)};return(t,e)=>(v(),w(j,null,[b("primitive",{object:_(P),"rotation-x":-Math.PI/2,onPointerMove:R,onPointerEnter:U,onPointerLeave:S},null,40,Q),b("primitive",{object:n.model.model.children[0].clone()},null,8,q)],64))}}),tt=V({__name:"dataDiv",setup(t){const n=Y(),e=h({top:0,left:0});function o(t){e.value.left=t.clientX+5+"px",e.value.top=t.clientY-20+"px"}return x((()=>{window.addEventListener("mousemove",o)})),I((()=>{window.removeEventListener("mousemove",o)})),(t,o)=>D((v(),w("div",{class:"title",style:O(e.value)},"温度："+P(_(n).temperature)+"℃ ",5)),[[M,_(n).showDiv]])}},[["__scopeId","data-v-fac3e7fd"]]),nt=g({__name:"heatmap2",async setup(r){let i,s;const a=h(!1),c=([i,s]=R((()=>e())),i=await i,s(),i);a.value=!0;const u=U({width:1,color:"#000",opacity:1,show:!0}),p=U({opacity:.9});return new t({title:"参数",expanded:!0}).addBinding(p,"opacity",{label:"透明度",min:0,max:1,step:.1}),(t,e)=>(v(),w(j,null,[S(n,{showBuildings:!1,autoRotate:!1},{ability:E((()=>[S(X,z({model:_(c)},p),null,16,["model"]),S(o,z(u,{builds:_(c).city}),null,16,["builds"])])),_:1}),S(tt)],64))}});export{nt as default};
