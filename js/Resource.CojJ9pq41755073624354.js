import{z as e,cl as t,cm as s,am as r,G as i,cn as o}from"./three.QlBabAUP1755073624354.js";import{D as a}from"./@tresjs.BCY8YfXT1755073624354.js";import{b as h,r as n}from"./@vue.BzMISRrV1755073624354.js";const d={GLTFLoader:i,TextureLoader:r,STLLoader:s,RGBELoader:t,FileLoader:e};const c=new class{constructor({decoderPath:e="./draco/"}={}){this.hasAllFinished=h(!1),this.progress=h(0),this.lenth=0,this.curIndex=0,this.loaderMapping=d,this.decoderPath=e,this.items={},this.reactiveItems=n({}),this.loadingMap={}}loadResources(e){e.forEach((({functionName:e,url:t,resourceID:s})=>{this.loadItem(e,t,s)}))}loadItem(e,t,s=""){if(!s){const e=t.match(/[^\\/]+$/);s=e?e[0]:t}if(void 0!==this.loadingMap[s])return this.loadingMap[s];if(this.items[s])return Promise.resolve(this.items[s]);const r=this.loaderMapping[e];if(!r)return console.error(`找不到对应的loader：${e}`),Promise.reject(`找不到对应的loader：${e}`);let i=null;"GLTFLoader"===e&&(i=e=>{const t=new o;t.setDecoderPath(this.decoderPath),t.preload(),e.setDRACOLoader(t)}),this.curIndex++,this.lenth++;const h=a(r,t,i).then((e=>(this.items[s]=e,this.reactiveItems[s]=e,this.curIndex--,this.progress.value=Math.floor((this.lenth-this.curIndex)/this.lenth*100),0===this.curIndex&&(this.hasAllFinished.value=!0),e)));return this.loadingMap[s]=h,h}getItem(e){return this.items[e]}getReactiveItem(e){return()=>this.reactiveItems[e]}getResource(e,t,s){return this.loadItem(e,t,s)}};export{c as i};
