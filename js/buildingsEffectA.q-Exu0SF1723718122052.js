import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.13664uOD1723718122052.js";import{$ as o}from"./@tresjs.GO-cpSrO1723718122052.js";import{C as e}from"./three-custom-shader-material.cBCxSCct1723718122052.js";import"./object-hash.-AaPYX971723718122052.js";import{a6 as r,C as i,cb as u,k as c,b0 as s}from"./three.eXhPIzTa1723718122052.js";import"./@amap.r0EhX7fK1723718122052.js";import"./glsl-tokenizer.1di3f6lO1723718122052.js";import{d as a,a1 as l,w as f,o as p,D as d,u as m,a4 as v,r as g,f as h,g as y,j as C,m as w}from"./@vue.Q1VpS3901723718122052.js";import{P as _}from"./tweakpane.yHWGBmom1723718122052.js";import"./@vueuse.z522fCYR1723718122052.js";import"./glsl-token-string.UXOMf2GN1723718122052.js";import"./glsl-token-functions.-uFsyLaA1723718122052.js";import"./jszip.t8h7C5WV1723718122052.js";const b=I;function x(){const t=["computeBoundingSphere","side","model","init","info","error","bulidingsColor","test","MeshBasicMaterial","renderOrder","console","string","color","2832732pvnHpS","city","Color","counter","102wtRYcE","return (function() ","call","157599TznHYg","2522988SKKTVi","boundingBox","apply","11812KBJrRG","debu","table","gger","land","bind","uTime","107722qEoSPX","#ffff00","topColor","DoubleSide","uniforms","trace","computeBoundingBox","prototype","forEach","exception","clone","1897545vGtrnt","constructor","function *\\( *\\)","landColor","input","stateObject","opacity",'{}.constructor("return this")( )',"464408CfvuCw","uOpacity","#e523ff","value","__csm","object","setStyle","gradient","chain","warn","uColor","material"];return(x=function(){return t})()}function I(t,n){const o=x();return(I=function(t,n){return o[t-=238]})(t,n)}!function(t,n){const o=I,e=x();for(;;)try{if(217598===-parseInt(o(274))/1+parseInt(o(285))/2+-parseInt(o(271))/3*(parseInt(o(278))/4)+parseInt(o(296))/5+-parseInt(o(275))/6+parseInt(o(267))/7+parseInt(o(242))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(277)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){S(this,(function(){const t=I,n=new RegExp(t(298)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=O(t(257));n.test(e+t(250))&&o[t(261)](e+t(238))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=I;let n;try{n=Function(t(272)+t(241)+");")()}catch(r){n=window}const o=n.console=n[t(264)]||{},e=["log",t(251),t(258),t(259),t(294),t(280),t(290)];for(let i=0;i<e.length;i++){const n=M[t(297)][t(292)][t(283)](M),r=e[i],u=o[r]||n;n.__proto__=M[t(283)](M),n.toString=u.toString[t(283)](u),o[r]=n}}))();const j=[b(247)],T=a({__name:"bModel",props:{model:{},bulidingsColor:{default:b(244)},landColor:{default:"#112233"},topColor:{default:b(286)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,u=t,c=u.model[n(268)];u[n(256)][n(256)].children[0][n(253)]=new(r[n(262)])({color:n(286)}),c[n(263)]=1001;const s=u[n(256)][n(282)];(()=>{const t=n,{geometry:o}=c;o[t(291)](),o[t(254)]();const{max:s,min:a}=o[t(276)];if(c[t(253)][t(246)])return;const l=new e({baseMaterial:c[t(253)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(269)])(u[t(260)])},uOpacity:{value:u[t(240)]},uLightColor:{value:new i("#ffffff")},uTopColor:{value:new(r[t(269)])(u[t(287)])},uTime:{value:0},uGradient:{value:u.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(288)]});c[t(253)].dispose(),c[t(253)]=l})();const{onLoop:a}=o();a((({delta:t})=>{const o=n;c[o(253)][o(289)][o(284)][o(245)]+=t})),l((()=>{const t=n;u.bulidingsColor&&c.material[t(289)][t(252)].value.setStyle(u[t(260)]),u.landColor&&((t,o)=>{const e=n;let i;"cu"===t||t===e(282)&&(i=Array.isArray(s[e(253)])?s[e(253)]:[s.material],i[e(293)]((t=>{const n=e;t[o][n(248)](u[n(299)]),t[n(255)]=r[n(288)]})))})(t(282),t(266)),u[t(240)]&&(c[t(253)][t(289)][t(243)][t(245)]=u[t(240)])})),f(u,((t,o)=>{const e=n;c[e(253)][e(289)].uGradient[e(245)]=t[e(249)]}));const v=u[n(256)][n(256)][n(295)]();return(t,n)=>(p(),d("primitive",{object:m(v)},null,8,j))}});function O(t){function n(t){const o=I;if(typeof t===o(265))return function(t){}[o(297)]("while (true) {}")[o(277)](o(270));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(279)+o(281))[o(273)]("action"):function(){return!1}[o(297)]("debu"+o(281))[o(277)](o(239)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=A;!function(t,n){const o=A,e=F();for(;;)try{if(476056===-parseInt(o(147))/1+parseInt(o(153))/2*(parseInt(o(159))/3)+-parseInt(o(145))/4*(parseInt(o(131))/5)+-parseInt(o(116))/6+parseInt(o(157))/7+parseInt(o(150))/8*(parseInt(o(121))/9)+-parseInt(o(146))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(109)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function F(){const t=["uColor","2WIKMhl","toString","material","return (function() ","6240080MyWYaf","string","1926303euOefs","#FFF","__proto__","constructor","apply","stateObject","gradual","matrix","function *\\( *\\)","builds","value","3729234lluTFe","color","trace",'{}.constructor("return this")( )',"counter","9Cpmdxa","chain","init","console","input","debu","uTime","object","gger","primitive","740ktabJA","speed","clone","info","uniforms","length","geometry","scale","uScale","exception","renderOrder","bind","srcColor","error","11964pofpcU","4599160sgFgBt","152151FCzztX","test","#000","4950312fhwkRs","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)"];return(F=function(){return t})()}!function(){B(this,(function(){const t=A,n=new RegExp(t(113)),o=new RegExp(t(151),"i"),e=E(t(123));n[t(148)](e+t(122))&&o[t(148)](e+t(125))?E():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(109)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function A(t,n){const o=F();return(A=function(t,n){return o[t-=108]})(t,n)}z(void 0,(function(){const t=A,n=function(){const t=A;let n;try{n=Function(t(156)+t(119)+");")()}catch(o){n=window}return n}(),o=n[t(124)]=n.console||{},e=["log","warn",t(134),t(144),t(140),"table",t(118)];for(let r=0;r<e[t(136)];r++){const n=z[t(108)].prototype.bind(z),i=e[r],u=o[i]||n;n[t(161)]=z[t(142)](z),n[t(154)]=u.toString[t(142)](u),o[i]=n}}))();const k=[P(128)],G=a({__name:"bLine",props:{builds:{},color:{default:P(160)},srcColor:{default:P(149)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,e=t;let r=null;const a={transparent:!0,uniforms:{uColor:{value:new i(e[n(117)])},uSrcColor:{value:new i(e[n(143)])},uScale:{value:e.scale},uTime:{value:0},uGradual:{value:e[n(111)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e[n(114)][n(137)])[n(133)]();f=f.applyMatrix4(e.builds[n(112)]);const v=new c(a);r=new s(f,v),r[n(155)].linewidth=e.width,r[n(141)]=1e3,l((()=>{const t=n;e[t(117)]&&(a[t(135)][t(152)][t(115)]=new i(e.color)),e.srcColor&&(a[t(135)].uSrcColor[t(115)]=new i(e[t(143)])),e.scale&&(a[t(135)][t(139)][t(115)]=e[t(138)]),e[t(111)]&&(a[t(135)].uGradual[t(115)]=e[t(111)])}));const{onLoop:g}=o();return g((({delta:t})=>{const o=n;a[o(135)][o(127)].value+=t*e[o(132)],a.uniforms[o(127)][o(115)]%=1})),(t,o)=>{const e=n;return p(),d(e(130),{object:m(r)},null,8,k)}}});function E(t){function n(t){const o=A;if(typeof t===o(158))return function(t){}[o(108)]("while (true) {}").apply(o(120));1!==(""+t/t)[o(136)]||t%20==0?function(){return!0}[o(108)]("debu"+o(129)).call("action"):function(){return!1}[o(108)](o(126)+"gger")[o(109)](o(110)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const R=K;!function(t,n){const o=K,e=D();for(;;)try{if(947249===-parseInt(o(367))/1*(parseInt(o(360))/2)+-parseInt(o(343))/3*(parseInt(o(350))/4)+parseInt(o(365))/5+-parseInt(o(375))/6*(-parseInt(o(337))/7)+-parseInt(o(364))/8*(-parseInt(o(338))/9)+-parseInt(o(358))/10+parseInt(o(354))/11*(parseInt(o(376))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(340)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(){const t=["bind","console","7LvhWAO","2261187exZpaG",'{}.constructor("return this")( )',"apply","扩散系数","city","192798IjxcsE","chain","log","speed","srcColor","线原颜色","info","12mAhToU","prototype","#000","test","8824563feCOxZ","addBinding","length","function *\\( *\\)","12769990IbSrue","builds","12uKkHhK","效果参数","counter","color","8OZtmcd","2123165HpZgbj","线扫颜色","111466BOUGvq","constructor","return (function() ","toString","buildingsEffectA","exception","trace","最大扩散","9646398lSxudz","12nNdDKU","#000000","model","#999","debu","stateObject","#FFF","table","gradual","error","gger"];return(D=function(){return t})()}!function(){Z(this,(function(){const t=K,n=new RegExp(t(357)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=W("init");n[t(353)](e+t(344))&&o[t(353)](e+"input")?W():e("0")}))()}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(340)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function K(t,n){const o=D();return(K=function(t,n){return o[t-=325]})(t,n)}H(void 0,(function(){const t=K;let n;try{n=Function(t(369)+t(339)+");")()}catch(r){n=window}const o=n[t(336)]=n[t(336)]||{},e=[t(345),"warn",t(349),t(333),t(372),t(331),t(373)];for(let i=0;i<e[t(356)];i++){const n=H.constructor[t(351)][t(335)](H),r=e[i],u=o[r]||n;n.__proto__=H[t(335)](H),n[t(370)]=u[t(370)][t(335)](u),o[r]=n}}))();const L=a({__name:R(371),async setup(o){const e=R;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=g({color:e(330),srcColor:e(352),scale:2e3,gradual:6.6,speed:.3}),s=new _({title:e(361),expanded:!0});return s[e(355)](c,e(347),{label:e(348)}),s.addBinding(c,e(363),{label:e(366)}),s[e(355)](c,e(346),{label:"速度",min:.1,max:1,step:.1}),s[e(355)](c,"scale",{label:e(374),min:10,max:2e3,step:10}),s[e(355)](c,e(332),{label:e(341),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[C(T,{model:m(u),bulidingsColor:r(325),landColor:"#112233",topColor:r(327)},null,8,[r(326)]),C(G,w({builds:m(u)[r(342)]},c),null,16,[r(359)])])),_:1})}}});function W(t){function n(t){const o=K;if("string"==typeof t)return function(t){}.constructor("while (true) {}")[o(340)](o(362));1!==(""+t/t)[o(356)]||t%20==0?function(){return!0}[o(368)](o(328)+o(334)).call("action"):function(){return!1}[o(368)](o(328)+o(334))[o(340)](o(329)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{L as default};
