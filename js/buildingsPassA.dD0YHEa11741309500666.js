import{b as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.KKnwD3Nl1741309500666.js";import{c6 as t,_ as e,c4 as o,ci as r,l as i,ct as u}from"./three.8tDGqmLF1741309500666.js";import{m as s,e as c}from"./@tresjs.yaBKiR-I1741309500666.js";import{d as a,a2 as l,r as p,o as f,f as d,g as m,j as v,aj as h,ak as x}from"./@vue.NRI7TcgI1741309500666.js";import{P}from"./tweakpane.yDiyAAkA1741309500666.js";import"./three-custom-shader-material.VwrDYuIS1741309500666.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741309500666.js";import"./postprocessing.5pHDeDVF1741309500666.js";import"./@vueuse.7Aa9Vkmy1741309500666.js";const w=_;!function(n,t){const e=_,o=y();for(;;)try{if(110263===parseInt(e(149))/1*(-parseInt(e(183))/2)+-parseInt(e(176))/3*(-parseInt(e(187))/4)+-parseInt(e(171))/5*(parseInt(e(191))/6)+-parseInt(e(179))/7*(-parseInt(e(165))/8)+parseInt(e(161))/9+parseInt(e(189))/10+-parseInt(e(198))/11*(-parseInt(e(155))/12))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const S=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[_(194)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){S(this,(function(){const n=_,t=new RegExp(n(147)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=I(n(154));t.test(o+"chain")&&e[n(170)](o+n(193))?I():o("0")}))()}();const g=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[_(194)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function y(){const n=["buildingsPassA","toString","1479688xxrLZf","addPass","Color","warn","call","test","165Xnljjc","log",'{}.constructor("return this")( )',"string","gger","48540gsSRrV","uScaleone","speed","7xfNgvk","width","action","bind","3272VoadWg","error","uColor","counter","16pXLoft","height","458070fKRmmg","stateObject","34266STDptZ","uScalenum","input","apply","material","constructor","console","11hnOhwB","value","uWidth","readBuffer","DepthTexture","length","set","exception","color","__proto__","function *\\( *\\)","projectionMatrixInverse","19bTOnPo","prototype","Vector2","depthTexture","table","init","312948CmYUFX","info","debu","return (function() ","time","uniforms","74187sRbRMC","uPosition"];return(y=function(){return n})()}g(void 0,(function(){const n=_;let t;try{t=Function(n(158)+n(173)+");")()}catch(r){t=window}const e=t[n(197)]=t.console||{},o=[n(172),n(168),n(156),n(184),n(205),n(153),"trace"];for(let i=0;i<o[n(203)];i++){const t=g.constructor[n(150)][n(182)](g),r=o[i],u=e[r]||t;t[n(146)]=g[n(182)](g),t[n(164)]=u[n(164)].bind(u),e[r]=t}}))();const b=a({__name:w(163),props:{color:{default:"#FFF"},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(n){const a=n,{renderer:p,scene:f,camera:d,sizes:m}=s();let v,h=0,x=null,P=null;l((()=>{const n=_;m[n(180)][n(199)]&&(v=m[n(180)][n(199)],h=m[n(188)][n(199)],(()=>{const n=_;x=new t(p[n(199)]);const s=new(e[n(202)])(v,h);x.readBuffer.depthBuffer=!0,x[n(201)][n(152)]=s;const c=new o(f[n(199)],d[n(199)]);x[n(166)](c),P=new r(new i({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:s},uProjectionInverse:{value:d[n(199)][n(148)]},uMatrixWorld:{value:d.value.matrixWorld},uColor:{value:new(e[n(167)])(a[n(145)])},uScalenum:{value:a.uScalenum},uScaleone:{value:a[n(177)]},uWidth:{value:a[n(200)]},uPosition:{value:new(e[n(151)])(a.uPosition.x,a[n(162)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),x[n(166)](P);const l=new r(u);x.addPass(l)})())}));const{onLoop:w}=c();return w((({elapsed:n})=>{const t=_;x&&(x.render(),P.uniforms[t(159)].value+=a[t(178)]/60)})),l((()=>{const n=_;P&&(a[n(145)]&&(P[n(195)].uniforms[n(185)].value=new(e[n(167)])(a.color)),a[n(192)]&&(P[n(195)][n(160)].uScalenum[n(199)]=a[n(192)]),a.uScaleone&&(P.material.uniforms.uScaleone[n(199)]=a[n(177)]),a[n(200)]&&(P.material[n(160)][n(200)].value=a[n(200)]),a.uPosition&&P[n(195)][n(160)][n(162)][n(199)][n(204)](a[n(162)].x,a[n(162)].y))})),(n,t)=>null}});function _(n,t){const e=y();return(_=function(n,t){return e[n-=145]})(n,t)}function I(n){function t(n){const e=_;if(typeof n===e(174))return function(n){}[e(196)]("while (true) {}")[e(194)](e(186));1!==(""+n/n)[e(203)]||n%20==0?function(){return!0}.constructor(e(157)+e(175))[e(169)](e(181)):function(){return!1}[e(196)](e(157)+e(175))[e(194)](e(190)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const j=z;!function(n,t){const e=z,o=M();for(;;)try{if(356537===-parseInt(e(265))/1+parseInt(e(290))/2+-parseInt(e(272))/3+-parseInt(e(294))/4+-parseInt(e(289))/5+parseInt(e(277))/6+parseInt(e(293))/7*(parseInt(e(261))/8))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const W=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){W(this,(function(){const n=z,t=new RegExp(n(282)),e=new RegExp(n(260),"i"),o=F("init");t[n(278)](o+n(287))&&e[n(278)](o+n(262))?F():o("0")}))()}();const D=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[z(281)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function z(n,t){const e=M();return(z=function(n,t){return e[n-=252]})(n,t)}D(void 0,(function(){const n=z,t=function(){const n=z;let t;try{t=Function(n(259)+n(275)+");")()}catch(e){t=window}return t}(),e=t[n(296)]=t[n(296)]||{},o=[n(252),n(257),"info",n(269),n(266),"table",n(264)];for(let r=0;r<o[n(276)];r++){const t=D.constructor[n(256)][n(288)](D),i=o[r],u=e[i]||t;t[n(274)]=D.bind(D),t.toString=u[n(271)][n(288)](u),e[i]=t}}))();const C=a({__name:j(291),setup(t){const e=j,o=p({color:e(283),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new P({title:e(292),expanded:!0});return r[e(295)](o,e(279),{label:e(254)}),r[e(295)](o,e(263),{label:"最大范围",min:1,max:500,step:10}),r.addBinding(o,e(253),{label:e(284),min:1,max:100,step:1}),r[e(295)](o,e(280),{label:e(267),min:0,max:1,step:.01}),r[e(295)](o,"speed",{label:"速度",min:1,max:20,step:1}),r[e(295)](o,e(255),{picker:e(297),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(t,e)=>(f(),d(n,{disableRender:!0,showAxesHelper:!1},{ability:m((()=>[v(b,h(x(o)),null,16)])),_:1}))}});function F(n){function t(n){const e=z;if(typeof n===e(285))return function(n){}.constructor(e(273)).apply("counter");1!==(""+n/n)[e(276)]||n%20==0?function(){return!0}[e(270)]("debu"+e(258))[e(286)](e(298)):function(){return!1}[e(270)]("debu"+e(258)).apply(e(268)),t(++n)}try{if(n)return t;t(0)}catch(e){}}function M(){const n=["toString","709884UTQUnm","while (true) {}","__proto__",'{}.constructor("return this")( )',"length","729078ZeXtFl","test","color","uWidth","apply","function *\\( *\\)","#00b4fb","单条圈间距","string","call","chain","bind","1651350uqSNCN","1410548QncQGn","buildingsPassA","后期效果","2832179CFiLQd","1206692MECMxQ","addBinding","console","inline","action","log","uScaleone","圈颜色","uPosition","prototype","warn","gger","return (function() ","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","16PpQXXE","input","uScalenum","trace","410873dOaVsy","exception","单条圈宽度","stateObject","error","constructor"];return(M=function(){return n})()}export{C as default};
