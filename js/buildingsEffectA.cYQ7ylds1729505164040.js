import{P as t}from"./tweakpane.yHWGBmom1729505164040.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.rIUqd8691729505164040.js";import{U as e}from"./@tresjs.IsKybBdF1729505164040.js";import{C as r}from"./three-custom-shader-material.N2P3il9e1729505164040.js";import"./object-hash.3VgPOje51729505164040.js";import{_ as i,C as u,cb as c,m as a,b3 as s}from"./three.YREzp-_G1729505164040.js";import"./@amap.-tZv8Pyx1729505164040.js";import"./glsl-tokenizer.octUzVvo1729505164040.js";import{d as l,a3 as f,w as p,o as d,E as m,u as v,a4 as g,r as h,f as y,g as C,j as w,m as _}from"./@vue.JNsx1iN61729505164040.js";import"./@vueuse.9dhnH8nd1729505164040.js";import"./glsl-token-string.GzxNJglV1729505164040.js";import"./glsl-token-functions.q-oNdpFR1729505164040.js";import"./jszip.GmmbuCmD1729505164040.js";const b=I;!function(t,n){const o=I,e=S();for(;;)try{if(561654===parseInt(o(169))/1*(parseInt(o(170))/2)+parseInt(o(184))/3+parseInt(o(119))/4+-parseInt(o(146))/5+-parseInt(o(165))/6+-parseInt(o(130))/7*(parseInt(o(144))/8)+parseInt(o(142))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(123)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=I,n=new RegExp(t(140)),o=new RegExp(t(189),"i"),e=T("init");n.test(e+"chain")&&o[t(179)](e+t(181))?T():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function I(t,n){const o=S();return(I=function(t,n){return o[t-=118]})(t,n)}M(void 0,(function(){const t=I,n=function(){const t=I;let n;try{n=Function(t(129)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(138)]||{},e=[t(164),t(154),t(190),t(171),t(137),t(172),t(133)];for(let r=0;r<e[t(166)];r++){const n=M[t(148)].prototype[t(147)](M),i=e[r],u=o[i]||n;n[t(182)]=M[t(147)](M),n[t(176)]=u[t(176)][t(147)](u),o[i]=n}}))();const j=[b(183)],P=l({__name:b(143),props:{model:{},bulidingsColor:{default:b(159)},landColor:{default:b(188)},topColor:{default:b(122)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,u=o[n(174)][n(131)];o.model[n(174)][n(151)][0][n(173)]=new(i[n(156)])({color:"#ffff00"}),u[n(168)]=1001;const c=o[n(174)][n(153)];(()=>{const t=n,{geometry:e}=u;e[t(161)](),e[t(157)]();const{max:c,min:a}=e[t(141)];if(u[t(173)][t(118)])return;const s=new r({baseMaterial:u[t(173)],vertexShader:t(180),fragmentShader:t(163),silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(175)])(o[t(121)])},uOpacity:{value:o[t(132)]},uLightColor:{value:new(i[t(175)])(t(125))},uTopColor:{value:new(i[t(175)])(o.topColor)},uTime:{value:0},uGradient:{value:o[t(155)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(128)]});u.material[t(134)](),u.material=s})();const{onLoop:a}=e();a((({delta:t})=>{const o=n;u[o(173)].uniforms[o(139)][o(124)]+=t})),f((()=>{const t=n;o.bulidingsColor&&u[t(173)].uniforms[t(158)].value.setStyle(o.bulidingsColor),o[t(152)]&&((t,e)=>{const r=n;let u;"cu"===t||"land"===t&&(u=Array[r(177)](c[r(173)])?c.material:[c[r(173)]],u[r(187)]((t=>{const n=r;t[e][n(150)](o[n(152)]),t[n(126)]=i[n(128)]})))})(t(153),t(135)),o[t(132)]&&(u.material[t(160)][t(120)][t(124)]=o[t(132)])})),p(o,((t,o)=>{const e=n;u[e(173)][e(160)][e(145)][e(124)]=t[e(155)]}));const s=o[n(174)].model[n(136)]();return(t,n)=>(d(),m("primitive",{object:v(s)},null,8,j))}});function S(){const t=["\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","log","4824168uWvuPK","length","string","renderOrder","1PpiOdy","1698716mmjMqq","error","table","material","model","Color","toString","isArray","counter","test","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","input","__proto__","object","2096097rHWUdC","stateObject","while (true) {}","forEach","#112233","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","info","__csm","3326816pVzlos","uOpacity","bulidingsColor","#ffff00","apply","value","#ffffff","side","call","DoubleSide","return (function() ","974869Qwekoz","city","opacity","trace","dispose","color","clone","exception","console","uTime","function *\\( *\\)","boundingBox","1857357KlfEic","bModel","8EXmrVO","uGradient","5405925ZEeDwL","bind","constructor","gger","setStyle","children","landColor","land","warn","gradient","MeshBasicMaterial","computeBoundingSphere","uColor","#e523ff","uniforms","computeBoundingBox","action"];return(S=function(){return t})()}function T(t){function n(t){const o=I;if(typeof t===o(167))return function(t){}[o(148)](o(186)).apply(o(178));1!==(""+t/t)[o(166)]||t%20==0?function(){return!0}[o(148)]("debu"+o(149))[o(127)](o(162)):function(){return!1}[o(148)]("debu"+o(149))[o(123)](o(185)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=G;!function(t,n){const o=G,e=F();for(;;)try{if(510848===-parseInt(o(230))/1+parseInt(o(235))/2+parseInt(o(240))/3*(-parseInt(o(285))/4)+parseInt(o(259))/5*(parseInt(o(287))/6)+-parseInt(o(263))/7*(-parseInt(o(264))/8)+parseInt(o(258))/9+-parseInt(o(253))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(238)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=G,n=new RegExp(t(261)),o=new RegExp(t(281),"i"),e=k(t(239));n[t(289)](e+t(257))&&o[t(289)](e+t(269))?k():e("0")}))()}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(238)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();B(void 0,(function(){const t=G;let n;try{n=Function(t(260)+t(277)+");")()}catch(r){n=window}const o=n[t(244)]=n[t(244)]||{},e=[t(252),t(266),t(280),t(283),t(288),t(286),t(255)];for(let i=0;i<e[t(241)];i++){const n=B[t(246)][t(282)][t(245)](B),r=e[i],u=o[r]||n;n[t(242)]=B[t(245)](B),n[t(290)]=u[t(290)][t(245)](u),o[r]=n}}))();const z=[O(249)];function F(){const t=["info","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","prototype","error","gger","8OzWawM","table","12TrTfJO","exception","test","toString","width","417535enCnPd","color","uniforms","gradual","call","1538612EfrhAu","stateObject","clone","apply","init","488667mcDnsO","length","__proto__","value","console","bind","constructor","uGradual","scale","object","srcColor","geometry","log","6255510GZCPRM","builds","trace","uTime","chain","2304018rgpXCd","1277170XQNoNu","return (function() ","function *\\( *\\)","uSrcColor","1904uKipts","10104BalCPm","material","warn","action","#FFF","input","matrix","string","uColor","uScale","renderOrder","debu","speed",'{}.constructor("return this")( )',"bLine","#000"];return(F=function(){return t})()}function G(t,n){const o=F();return(G=function(t,n){return o[t-=229]})(t,n)}const A=l({__name:O(278),props:{builds:{},color:{default:O(268)},srcColor:{default:O(279)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(231)])},uSrcColor:{value:new u(o[n(250)])},uScale:{value:o[n(248)]},uTime:{value:0},uGradual:{value:o[n(233)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(254)][n(251)])[n(237)]();l=l.applyMatrix4(o[n(254)][n(270)]);const p=new a(i);r=new s(l,p),r[n(265)].linewidth=o[n(229)],r[n(274)]=1e3,f((()=>{const t=n;o[t(231)]&&(i[t(232)][t(272)].value=new u(o[t(231)])),o[t(250)]&&(i[t(232)][t(262)][t(243)]=new u(o[t(250)])),o.scale&&(i[t(232)][t(273)][t(243)]=o[t(248)]),o[t(233)]&&(i[t(232)][t(247)][t(243)]=o.gradual)}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(232)][e(256)].value+=t*o[e(276)],i[e(232)][e(256)][e(243)]%=1})),(t,n)=>(d(),m("primitive",{object:v(r)},null,8,z))}});function k(t){function n(t){const o=G;if(typeof t===o(271))return function(t){}[o(246)]("while (true) {}").apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(275)+o(284))[o(234)](o(267)):function(){return!1}[o(246)](o(275)+o(284)).apply(o(236)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const R=Z;function Z(t,n){const o=$();return(Z=function(t,n){return o[t-=114]})(t,n)}!function(t,n){const o=Z,e=$();for(;;)try{if(714831===parseInt(o(121))/1+-parseInt(o(139))/2*(-parseInt(o(144))/3)+-parseInt(o(119))/4*(-parseInt(o(131))/5)+-parseInt(o(149))/6+-parseInt(o(143))/7+parseInt(o(115))/8+parseInt(o(157))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(133)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){D(this,(function(){const t=Z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(156),"i"),e=L("init");n.test(e+"chain")&&o[t(124)](e+"input")?L():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();W(void 0,(function(){const t=Z;let n;try{n=Function(t(158)+t(145)+");")()}catch(r){n=window}const o=n[t(136)]=n.console||{},e=[t(123),t(148),t(140),t(146),"exception",t(126),t(127)];for(let i=0;i<e.length;i++){const n=W.constructor[t(114)][t(141)](W),r=e[i],u=o[r]||n;n[t(130)]=W[t(141)](W),n[t(135)]=u[t(135)][t(141)](u),o[r]=n}}))();const H=l({__name:R(117),async setup(e){const r=R;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:"#FFF",srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(128),expanded:!0});return s[r(129)](a,r(120),{label:"线原颜色"}),s[r(129)](a,"color",{label:"线扫颜色"}),s[r(129)](a,r(154),{label:"速度",min:.1,max:1,step:.1}),s[r(129)](a,r(132),{label:"最大扩散",min:10,max:2e3,step:10}),s[r(129)](a,r(138),{label:r(116),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[w(P,{model:v(c),bulidingsColor:"#000000",landColor:e(147),topColor:e(153)},null,8,["model"]),w(A,_({builds:v(c).city},a),null,16,[e(137)])])),_:1})}}});function L(t){function n(t){const o=Z;if(typeof t===o(151))return function(t){}.constructor(o(155))[o(133)](o(134));1!==(""+t/t)[o(118)]||t%20==0?function(){return!0}[o(150)](o(122)+"gger")[o(152)]("action"):function(){return!1}[o(150)](o(122)+o(125)).apply(o(142)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function $(){const t=["#999","speed","while (true) {}","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","8936352YelVOl","return (function() ","prototype","4403040fPFeKC","扩散系数","buildingsEffectA","length","2338148DulaXy","srcColor","118491WwHKPU","debu","log","test","gger","table","trace","效果参数","addBinding","__proto__","5KDaJkH","scale","apply","counter","toString","console","builds","gradual","198sRNGQX","info","bind","stateObject","8027145ZTHBpI","20523PQoQEP",'{}.constructor("return this")( )',"error","#112233","warn","6372174GkuGBE","constructor","string","call"];return($=function(){return t})()}export{H as default};
