import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.n_49xkgO1726652192279.js";import{bZ as n,_ as e,bX as o,c7 as r,m as i,ch as s}from"./three.3esZ7Hzr1726652192279.js";import{p as u,U as c}from"./@tresjs.UGbbWZf51726652192279.js";import{d as a,a3 as l,r as p,o as f,f as d,g as v,j as m,aj as h,ak as w}from"./@vue.JNsx1iN61726652192279.js";import{P as x}from"./tweakpane.yHWGBmom1726652192279.js";import"./three-custom-shader-material.1UWxr2-p1726652192279.js";import"./object-hash.659hUnW-1726652192279.js";import"./@amap.-LPMSFvH1726652192279.js";import"./jszip.uBbFte4W1726652192279.js";import"./glsl-tokenizer.lP_hSvTG1726652192279.js";import"./glsl-token-string.0mUiHG4f1726652192279.js";import"./glsl-token-functions.lY9NGLSv1726652192279.js";import"./@vueuse.OdTlFP151726652192279.js";const P=S;!function(t,n){const e=S,o=j();for(;;)try{if(572777===parseInt(e(359))/1*(-parseInt(e(361))/2)+-parseInt(e(319))/3+-parseInt(e(342))/4+-parseInt(e(316))/5+-parseInt(e(335))/6*(-parseInt(e(326))/7)+parseInt(e(351))/8+-parseInt(e(356))/9*(-parseInt(e(321))/10))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const g=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[S(347)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){g(this,(function(){const t=S,n=new RegExp(t(349)),e=new RegExp(t(314),"i"),o=I(t(304));n.test(o+t(305))&&e[t(336)](o+"input")?I():o("0")}))()}();const b=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function S(t,n){const e=j();return(S=function(t,n){return e[t-=302]})(t,n)}b(void 0,(function(){const t=S;let n;try{n=Function(t(358)+t(332)+");")()}catch(r){n=window}const e=n.console=n[t(334)]||{},o=["log",t(354),t(307),t(320),t(330),t(346),t(343)];for(let i=0;i<o[t(328)];i++){const n=b.constructor[t(313)][t(311)](b),r=o[i],s=e[r]||n;n[t(339)]=b.bind(b),n[t(317)]=s[t(317)].bind(s),e[r]=n}}))();const y=a({__name:P(333),props:{color:{default:P(309)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const a=t,{renderer:p,scene:f,camera:d,sizes:v}=u();let m,h=0,w=null,x=null;l((()=>{const t=S;v[t(325)].value&&(m=v[t(325)][t(360)],h=v[t(315)][t(360)],(()=>{const t=S;w=new n(p.value);const u=new(e[t(303)])(m,h);w.readBuffer[t(310)]=!0,w[t(338)][t(324)]=u;const c=new o(f[t(360)],d[t(360)]);w.addPass(c),x=new r(new i({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:u},uProjectionInverse:{value:d[t(360)].projectionMatrixInverse},uMatrixWorld:{value:d[t(360)][t(355)]},uColor:{value:new(e[t(337)])(a[t(348)])},uScalenum:{value:a[t(345)]},uScaleone:{value:a[t(344)]},uWidth:{value:a[t(357)]},uPosition:{value:new(e[t(340)])(a[t(306)].x,a[t(306)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),w[t(322)](x);const l=new r(s);w[t(322)](l)})())}));const{onLoop:P}=c();return P((({elapsed:t})=>{const n=S;w&&(w[n(353)](),x[n(341)][n(350)][n(360)]+=a[n(302)]/60)})),l((()=>{const t=S;x&&(a[t(348)]&&(x.material[t(341)][t(312)][t(360)]=new(e[t(337)])(a[t(348)])),a[t(345)]&&(x[t(308)][t(341)][t(345)][t(360)]=a[t(345)]),a[t(344)]&&(x[t(308)][t(341)].uScaleone[t(360)]=a.uScaleone),a[t(357)]&&(x.material[t(341)].uWidth[t(360)]=a[t(357)]),a[t(306)]&&x.material[t(341)][t(306)][t(360)][t(323)](a[t(306)].x,a.uPosition.y))})),(t,n)=>null}});function j(){const t=["Color","readBuffer","__proto__","Vector2","uniforms","2157356YqqkWW","trace","uScaleone","uScalenum","table","apply","color","function *\\( *\\)","time","4337704ovOxtR","counter","render","warn","matrixWorld","16107030UHosCs","uWidth","return (function() ","5AuvcMd","value","434702djzXOJ","speed","DepthTexture","init","chain","uPosition","info","material","#FFF","depthBuffer","bind","uColor","prototype","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","height","1980465tlmcGL","toString","while (true) {}","588456SzEbre","error","10wtIJQR","addPass","set","depthTexture","width","7EKNdgb","debu","length","constructor","exception","gger",'{}.constructor("return this")( )',"buildingsPassA","console","2755398lGFYvN","test"];return(j=function(){return t})()}function I(t){function n(t){const e=S;if("string"==typeof t)return function(t){}[e(329)](e(318))[e(347)](e(352));1!==(""+t/t)[e(328)]||t%20==0?function(){return!0}[e(329)](e(327)+e(331)).call("action"):function(){return!1}[e(329)](e(327)+"gger")[e(347)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}const _=F;!function(t,n){const e=F,o=D();for(;;)try{if(583097===parseInt(e(453))/1+parseInt(e(438))/2+-parseInt(e(458))/3*(parseInt(e(433))/4)+-parseInt(e(432))/5+parseInt(e(429))/6*(parseInt(e(444))/7)+-parseInt(e(456))/8*(parseInt(e(448))/9)+-parseInt(e(454))/10)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const W=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){W(this,(function(){const t=F,n=new RegExp(t(434)),e=new RegExp(t(451),"i"),o=M(t(445));n[t(430)](o+t(425))&&e[t(430)](o+t(431))?M():o("0")}))()}();const z=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function D(){const t=["toString","1089543totYeW","15212840OEwRVh","inline","8gIFMua","bind","6MZzbuJ","return (function() ","apply","table","action","warn","exception","buildingsPassA","log","call","chain","prototype","length","color","222vtKmPJ","test","input","1527725uURyIk","441976RzYFCk","function *\\( *\\)","stateObject","console","addBinding","1401910VLdHWV","constructor","info","string","uScaleone","#00b4fb","169869pvVoGd","init","while (true) {}","uPosition","517167QbPgkd","gger","单条圈宽度","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)"];return(D=function(){return t})()}function F(t,n){const e=D();return(F=function(t,n){return e[t-=418]})(t,n)}z(void 0,(function(){const t=F,n=function(){const t=F;let n;try{n=Function(t(459)+'{}.constructor("return this")( ));')()}catch(e){n=window}return n}(),e=n[t(436)]=n.console||{},o=[t(423),t(420),t(440),"error",t(421),t(418),"trace"];for(let r=0;r<o[t(427)];r++){const n=z[t(439)][t(426)][t(457)](z),i=o[r],s=e[i]||n;n.__proto__=z[t(457)](z),n[t(452)]=s[t(452)][t(457)](s),e[i]=n}}))();const k=a({__name:_(422),setup(n){const e=_,o=p({color:e(443),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new x({title:"后期效果",expanded:!0});return r[e(437)](o,e(428),{label:"圈颜色"}),r[e(437)](o,"uScalenum",{label:"最大范围",min:1,max:500,step:10}),r[e(437)](o,e(442),{label:"单条圈间距",min:1,max:100,step:1}),r[e(437)](o,"uWidth",{label:e(450),min:0,max:1,step:.01}),r[e(437)](o,"speed",{label:"速度",min:1,max:20,step:1}),r[e(437)](o,e(447),{picker:e(455),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(f(),d(t,{disableRender:!0,showAxesHelper:!1},{ability:v((()=>[m(y,h(w(o)),null,16)])),_:1}))}});function M(t){function n(t){const e=F;if(typeof t===e(441))return function(t){}[e(439)](e(446))[e(460)]("counter");1!==(""+t/t)[e(427)]||t%20==0?function(){return!0}[e(439)]("debu"+e(449))[e(424)](e(419)):function(){return!1}[e(439)]("debu"+e(449))[e(460)](e(435)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{k as default};
