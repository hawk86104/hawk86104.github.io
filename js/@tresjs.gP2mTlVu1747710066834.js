import{p as e,_ as t,q as n,ad as r,ai as s,aj as o,ak as i,al as a,o as l,am as c,B as u,an as h,ao as d,l as p,A as m,a4 as f,C as g,W as v,ap as y,aq as x,ar as b,as as w,b as T,at as _,c as E,au as A,a5 as M,a as S,V as C,T as O,ab as P,av as I,aw as L,m as D,n as R,ax as k,ay as N,N as U,az as F,aA as z,f as B,u as j,O as H,aB as V,Q as X,t as Y,e as W,S as G,M as Z,g as K,k as Q,D as q,aC as J,aD as $,aE as ee,aF as te,aG as ne,z as re,aH as se,aI as oe,E as ie,R as ae,h as le,K as ce,aJ as ue,Y as he,aK as de,aL as pe,aM as me,aN as fe,aO as ge,r as ve,aP as ye,aQ as xe,ah as be,aR as we,aS as Te,aT as _e,I as Ee,a7 as Ae,aU as Me,aV as Se,a1 as Ce,aW as Oe,aX as Pe,aY as Ie,aZ as Le,ae as De,a_ as Re,a$ as ke,a9 as Ne,P as Ue,b0 as Fe,b1 as ze,af as Be,b2 as je,b3 as He,d as Ve,b4 as Xe,b5 as Ye,b6 as We,b7 as Ge,b8 as Ze,b9 as Ke,a6 as Qe,ba as qe,bb as Je,bc as $e,bd as et,be as tt,a2 as nt,bf as rt,bg as st,bh as ot,bi as it,bj as at,i as lt,bk as ct,bl as ut,bm as ht,bn as dt,bo as pt,J as mt,bp as ft,bq as gt,y as vt,br as yt,bs as xt,bt,bu as wt,bv as Tt,bw as _t,bx as Et,by as At,bz as Mt,bA as St,bB as Ct}from"./three.xEBIAocQ1747710066834.js";import{b as Ot,r as Pt,d as It,a0 as Lt,v as Dt,G as Rt,s as kt,w as Nt,V as Ut,o as Ft,N as zt,u as Bt,J as jt,a1 as Ht,R as Vt,a2 as Xt,i as Yt,a as Wt,p as Gt,q as Zt,E as Kt,F as Qt,D as qt,_ as Jt,H as $t,L as en,m as tn,I as nn,a3 as rn,j as sn,a4 as on,a5 as an,a6 as ln,a7 as cn,a8 as un,e as hn,t as dn,l as pn,n as mn,a9 as fn,f as gn,W as vn,M as yn,O as xn,Q as bn,B as wn,x as Tn,aa as _n}from"./@vue.C_fjx3FT1747710066834.js";import{E as En,R as An,N as Mn,D as Sn,O as Cn,a as On}from"./postprocessing.qgYkPc7-1747710066834.js";import{u as Pn,c as In,a as Ln,b as Dn,t as Rn,d as kn,e as Nn,r as Un,f as Fn,g as zn,h as Bn,i as jn,j as Hn,k as Vn,l as Xn,m as Yn,n as Wn,o as Gn,p as Zn}from"./@vueuse.C9JT-tFY1747710066834.js";var Kn=Object.defineProperty,Qn=(e,t,n)=>((e,t,n)=>t in e?Kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const qn={name:"@tresjs/core",type:"module",version:"4.3.3",packageManager:"pnpm@9.15.5",description:"Declarative ThreeJS using Vue Components",author:"Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",license:"MIT",repository:{type:"git",url:"git+https://github.com/Tresjs/tres.git"},keywords:["vue","3d","threejs","three","threejs-vue"],sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},main:"./dist/tres.js",module:"./dist/tres.js",types:"./dist/index.d.ts",files:["*.d.ts","dist"],publishConfig:{access:"public"},scripts:{dev:"pnpm --filter='./playground/vue' dev","dev:nuxt":"pnpm --filter='./playground/nuxt' dev",build:"vite build",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts"},peerDependencies:{three:">=0.133",vue:">=3.4"},dependencies:{"@alvarosabu/utils":"^3.2.0","@vue/devtools-api":"^6.6.3","@vueuse/core":"^12.5.0"},devDependencies:{"@release-it/conventional-changelog":"^10.0.0","@stackblitz/sdk":"^1.11.0","@tresjs/cientos":"4.1.0","@tresjs/eslint-config":"^1.4.0","@types/three":"^0.173.0","@typescript-eslint/eslint-plugin":"^8.23.0","@typescript-eslint/parser":"^8.23.0","@vitejs/plugin-vue":"^5.2.1","@vitest/coverage-c8":"^0.33.0","@vitest/coverage-v8":"^3.0.5","@vitest/ui":"^3.0.5","@vue/test-utils":"^2.4.6",eslint:"^9.19.0","eslint-plugin-vue":"^9.32.0",esno:"^4.8.0",gsap:"^3.12.7",jsdom:"^26.0.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^2.0.2","release-it":"^18.1.2","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.14.0",sponsorkit:"^16.3.0",three:"^0.173.0",unocss:"^65.4.3",unplugin:"^2.1.2","unplugin-vue-components":"^28.0.0",vite:"^6.1.0","vite-plugin-banner":"^0.8.0","vite-plugin-dts":"4.5.0","vite-plugin-inspect":"^10.1.0","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.6.3",vitest:"3.0.5",vue:"3.5.13","vue-demi":"^0.14.10"}};async function Jn(e,t,n,r,s){const{logError:o}=Dr(),i=new e;return n&&n(i),await new Promise(((e,n)=>{i.load(t,(t=>{const n=t;n.scene&&Object.assign(n,function(e){const t={nodes:{},materials:{}};return e&&e.traverse((e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}(n.scene)),e(n)}),r,(e=>{o("[useLoader] - Failed to load resource",e),n(e)}))}))}let $n=class extends p{constructor(...e){super(...e),Qn(this,"type","HightlightMesh"),Qn(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,t=1+.07*Math.sin(2.5*e);this.scale.set(t,t,t)}};function er(e){return typeof e>"u"}function tr(e){return Array.isArray(e)}function nr(e){return"string"==typeof e}function rr(e){return"function"==typeof e}function sr(e){return e===Object(e)&&!tr(e)&&!rr(e)}function or(e){return sr(e)&&"isObject3D"in e&&!!e.isObject3D}function ir(e){return sr(e)&&"isCamera"in e&&!!e.isCamera}function ar(e){return or(e)||function(e){return sr(e)&&"isBufferGeometry"in e&&!!e.isBufferGeometry}(e)||function(e){return sr(e)&&"isMaterial"in e&&!!e.isMaterial}(e)||function(e){return sr(e)&&"isFog"in e&&!!e.isFog}(e)}const lr=(e,t)=>{for(const n of Object.keys(t))t[n]instanceof Object&&Object.assign(t[n],lr(e[n],t[n]));return Object.assign(e||{},t),e},cr=mr("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot");function ur(e){return e&&1===e.nodeType}function hr(e){return e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()))}const dr=/\B([A-Z])/g;function pr(e){return e.replace(dr,"-$1").toLowerCase()}function mr(e,t){const n=Object.create(null),r=e.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e=>!!n[e]}const fr=(e,t)=>{if(!t)return;const n=Array.isArray(t)?t:t.match(/([^[.\]])+/g);return null==n?void 0:n.reduce(((e,t)=>e&&e[t]),e)};function gr(e,t){if(ur(e)&&ur(t)){const n=e.attributes,r=t.attributes;return n.length===r.length&&Array.from(n).every((({name:e,value:n})=>t.getAttribute(e)===n))}if(e===t)return!0;if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!gr(e[s],t[s]))return!1;return!0}const vr=Array.isArray;function yr(e){(function(e){return"map"in e})(e)&&e.map&&e.map.dispose(),e.dispose()}function xr(e){var n,r;if(e.parent&&(null==(n=e.removeFromParent)||n.call(e)),delete e.__tres,[...e.children].forEach((e=>xr(e))),!(e instanceof t)){const t=e;e&&(null==(r=e.dispose)||r.call(e)),t.geometry&&t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach((e=>yr(e))):t.material&&yr(t.material)}}function br(e,t){let n=e;if(t.includes("-")){const e=t.split("-");let r=e.shift();for(;n&&e.length;)r in n?(n=n[r],r=e.shift()):r=wr(r,e.shift());return{target:n,key:wr(r,...e)}}return{target:n,key:t}}function wr(...e){return e.map(((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1))).join("")}const Tr=/-\d+$/;function _r(e,t,n){const r=e;return r.__tres={type:"unknown",eventCount:0,root:n,handlers:{},memoizedProps:{},objects:[],parent:null,previousAttach:null,...t},r.__tres.attach||(r.isMaterial?r.__tres.attach="material":r.isBufferGeometry?r.__tres.attach="geometry":r.isFog&&(r.__tres.attach="fog")),r}function Er(e){var t;const n=null==(t=null==e?void 0:e.__tres)?void 0:t.root;n&&n.render&&n.render.canBeInvalidated.value&&n.invalidate()}function Ar(e){return function(e){return sr(e)&&!!e.isPrimitive}(e)?(e.object.__tres=e.__tres,e.object):e}function Mr(e,t){var n,r,s,o;const i=(null==(n=e.__tres)?void 0:n.parent)||t.scene.value;e.__tres&&(e.__tres.parent=null),i&&i.__tres&&"objects"in i.__tres&&function(e,t){let n=0;for(let r=0;r<e.length;r++)t(e[r],r)&&(e[n]=e[r],n++);e.length=n}(i.__tres.objects,(t=>t!==e)),null!=(r=e.__tres)&&r.attach?function(e,t,n){var r,s,o;if(nr(n)){const{target:r,key:s}=br(e,n),o=t.__tres.previousAttach;void 0===o?delete r[s]:r[s]=o,"__tresDetach"in r&&r.__tresDetach()}else null==(s=null==(r=t.__tres)?void 0:r.previousAttach)||s.call(r,e,t);null==(o=t.__tres)||delete o.previousAttach}(i,e,e.__tres.attach):(null==(o=null==(s=e.parent)?void 0:s.remove)||o.call(s,Ar(e)),e.parent=null)}function Sr(e,t){var n;null==(n=e.traverse)||n.call(e,(e=>{var n;t.deregisterCamera(e),null==(n=t.eventManager)||n.deregisterPointerMissedObject(e)})),t.deregisterCamera(e),Er(e)}async function Cr(e,t){const n=new r(t),s=e=>new Promise(((t,r)=>{n.load(e,(e=>t(e)),(()=>null),(()=>{r(new Error("[useTextures] - Failed to load texture"))}))}));if(vr(e)){const t=await Promise.all(e.map((e=>s(e))));return e.length>1?t:t[0]}{const{map:t,displacementMap:n,normalMap:r,roughnessMap:o,metalnessMap:i,aoMap:a,alphaMap:l,matcap:c}=e;return{map:t?await s(t):null,displacementMap:n?await s(n):null,normalMap:r?await s(r):null,roughnessMap:o?await s(o):null,metalnessMap:i?await s(i):null,aoMap:a?await s(a):null,alphaMap:l?await s(l):null,matcap:c?await s(c):null}}}const Or="[TresJS â–² â–  â—] ";function Pr(...e){"string"==typeof e[0]?e[0]=Or+e[0]:e.unshift(Or),console.error(...e)}function Ir(...e){"string"==typeof e[0]?e[0]=Or+e[0]:e.unshift(Or),console.warn(...e)}function Lr(e,t){}function Dr(){return{logError:Pr,logWarning:Ir,logMessage:Lr}}const Rr=Ot({}),kr=e=>Object.assign(Rr.value,e);function Nr(){const e=new Map,t=new Set;let n=0,r=!1;const s=n=>{e.delete(n),t.delete(n)};return{on:(t,o=0)=>{e.set(t,{priority:o,addI:n++});const i=()=>s(t);return Hn(i),r=!0,{off:i}},off:s,trigger:(...n)=>{r&&((()=>{const n=Array.from(e.entries()).sort(((e,t)=>{const n=e[1].priority-t[1].priority;return 0===n?e[1].addI-t[1].addI:n}));t.clear(),n.forEach((e=>t.add(e[0])))})(),r=!1),t.forEach((e=>e(...n)))},dispose:()=>{e.clear(),t.clear()},get count(){return e.size}}}function Ur(){let t=!0,n=!0,r=!1;const s=new e(!1),o=Ot(s.running),i=Ot(!1);let a;const l=T.generateUUID();let c=null;const u=Nr(),h=Nr(),d=Nr();f();let p={};function m(){if(!t)return void(a=requestAnimationFrame(m));const e=s.getDelta(),n=s.getElapsedTime(),r={camera:Bt(p.camera),scene:Bt(p.scene),renderer:Bt(p.renderer),raycaster:Bt(p.raycaster),controls:Bt(p.controls),invalidate:p.invalidate,advance:p.advance},l={delta:e,elapsed:n,clock:s,...r};o.value&&u.trigger(l),i.value||(h.count?h.trigger(l):c&&c(l)),o.value&&d.trigger(l),a=requestAnimationFrame(m)}function f(){const e=!n&&!r;s.running!==e&&(s.running?s.stop():s.start()),o.value=s.running}return{loopId:l,register:(e,t,n)=>function(e,t,n=0){switch(t){case"before":return u.on(e,n);case"render":return c||(c=e),h.dispose(),h.on(e);case"after":return d.on(e,n)}}(e,t,n),start:function(){n&&(n=!1,f(),m())},stop:function(){n=!0,f(),cancelAnimationFrame(a)},pause:function(){r=!0,f()},resume:function(){r=!1,f()},pauseRender:function(){i.value=!0},resumeRender:function(){i.value=!1},isRenderPaused:i,isActive:o,setContext:function(e){p=e},setReady:e=>t=e}}function Fr(e){let t=0;return e.traverse((e=>{if(e.isMesh&&e.geometry&&"HightlightMesh"!==e.type){const n=e.geometry,r=3*n.attributes.position.count*Float32Array.BYTES_PER_ELEMENT,s=n.index?n.index.count*Uint32Array.BYTES_PER_ELEMENT:0,o=n.attributes.normal?3*n.attributes.normal.count*Float32Array.BYTES_PER_ELEMENT:0,i=n.attributes.uv?2*n.attributes.uv.count*Float32Array.BYTES_PER_ELEMENT:0;t+=r+s+o+i}})),t}function zr(e){return(e/1024).toFixed(2)}const Br=Number.parseInt(M.replace("dev",""));function jr(e){return e instanceof g?e:Array.isArray(e)?new g(...e):new g(e)}const Hr={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:w,toneMapping:b,toneMappingExposure:3,shadowMap:{enabled:!0,type:x}},flat:{toneMapping:y,toneMappingExposure:1}};function Vr({canvas:e,options:t,contextParts:{sizes:n,render:r,invalidate:s,advance:o}}){const i=Wt((()=>({alpha:Rn(t.alpha)??!0,depth:Rn(t.depth),canvas:Fn(e),context:Rn(t.context),stencil:Rn(t.stencil),antialias:Rn(t.antialias)??!0,precision:Rn(t.precision),powerPreference:Rn(t.powerPreference),premultipliedAlpha:Rn(t.premultipliedAlpha),preserveDrawingBuffer:Rn(t.preserveDrawingBuffer),logarithmicDepthBuffer:Rn(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:Rn(t.failIfMajorPerformanceCaveat)}))),a=Dt(new v(i.value));function l(){"on-demand"===t.renderMode&&s()}Nt(i,(()=>{a.value.dispose(),a.value=new v(i.value),l()})),Nt([n.width,n.height],(()=>{a.value.setSize(n.width.value,n.height.value),l()}),{immediate:!0}),Nt((()=>t.clearColor),l);const{pixelRatio:c}=zn(),{logError:u}=Dr(),h=(()=>{const e=new v,t={shadowMap:{enabled:e.shadowMap.enabled,type:e.shadowMap.type},toneMapping:e.toneMapping,toneMappingExposure:e.toneMappingExposure,outputColorSpace:e.outputColorSpace};return e.dispose(),t})(),d=Rn(t.renderMode);return"on-demand"===d&&s(),"manual"===d&&setTimeout((()=>{o()}),100),Xt((()=>{const e=Rn(t.preset);e&&(e in Hr||u(`Renderer Preset must be one of these: ${Object.keys(Hr).join(", ")}`),lr(a.value,Hr[e])),function(e,t,n){var r;if(!rr(e.setPixelRatio))return;let s=0;if(n&&tr(n)){const e=n;if(e.length>=2){const[n,r]=e;s=T.clamp(t,n,r)}}else s=function(e){return"number"==typeof e}(n)?n:t;s!==(null==(r=e.getPixelRatio)?void 0:r.call(e))&&e.setPixelRatio(s)}(a.value,c.value,Rn(t.dpr)),"always"===d&&(r.frames.value=Math.max(1,r.frames.value));const n=(t,n)=>{const r=Rn(t);if(void 0!==r)return r;const s=(()=>{if(e)return fr(Hr[e],n)})();return void 0!==s?s:fr(h,n)},s=(e,t)=>((e,t,n)=>{const r=Array.isArray(t)?t:t.match(/([^[.\]])+/g);r&&r.reduce(((e,t,s)=>(void 0===e[t]&&(e[t]={}),s===r.length-1&&(e[t]=n),e[t])),e)})(a.value,t,n(e,t));s(t.shadows,"shadowMap.enabled"),s(t.toneMapping??b,"toneMapping"),s(t.shadowMapType,"shadowMap.type"),Br<150&&s(!t.useLegacyLights,"physicallyCorrectLights"),s(t.outputColorSpace,"outputColorSpace"),s(t.toneMappingExposure,"toneMappingExposure");const o=n(t.clearColor,"clearColor");o&&a.value.setClearColor(o?jr(o):new g(0))})),Ut((()=>{a.value.dispose(),a.value.forceContextLoss()})),{renderer:a}}const Xr=(e,t)=>{const n=Wt((()=>t.renderer.value.domElement)),r=Dt([]),{x:s,y:o}=Bn({target:n});let i=0;const{width:a,height:l,top:c,left:u}=jn(n),h=i=>{const h=(({x:e,y:t})=>{if(n.value)return{x:(e-u.value)/a.value*2-1,y:-(t-c.value)/l.value*2+1}})({x:(null==i?void 0:i.clientX)??s.value,y:(null==i?void 0:i.clientY)??o.value});return h&&(({x:n,y:s})=>{if(t.camera.value)return t.raycaster.value.setFromCamera(new S(n,s),t.camera.value),r.value=t.raycaster.value.intersectObjects(e.value,!0),r.value})(h)||[]},d=In(),p=In(),m=In(),f=In(),g=In(),v=In(),y=In(),x=In();const b=(e,n)=>{var s,o,a;const l=function(e){const t={};for(const n in e)"function"!=typeof n&&(t[n]=e[n]);return t}(n),c=new C(null==n?void 0:n.clientX,null==n?void 0:n.clientY,0).unproject(null==(s=t.camera)?void 0:s.value);e.trigger({...l,intersections:r.value,unprojectedPoint:c,ray:null==(o=t.raycaster)?void 0:o.value.ray,camera:null==(a=t.camera)?void 0:a.value,sourceEvent:n,delta:i,stopPropagating:!1})};let w;const T=e=>{h(e),b(m,e),w=e};let _,E,A;const M=e=>{var t;_=null==(t=r.value[0])?void 0:t.object,i=0,E=new S((null==e?void 0:e.clientX)??s.value,(null==e?void 0:e.clientY)??o.value),b(g,e)};let O,P=!1;const I=e=>{var t,n,a;e instanceof PointerEvent&&(0===r.value.length&&b(v,e),_===(null==(t=r.value[0])?void 0:t.object)&&(A=new S((null==e?void 0:e.clientX)??s.value,(null==e?void 0:e.clientY)??o.value),i=null==E?void 0:E.distanceTo(A),0===e.button?(b(d,e),O===(null==(n=r.value[0])?void 0:n.object)?P=!0:(O=null==(a=r.value[0])?void 0:a.object,P=!1)):2===e.button&&b(y,e)),b(f,e))},L=e=>{P&&(b(p,e),O=void 0,P=!1)},D=e=>b(m,e),R=e=>b(x,e);return n.value.addEventListener("pointerup",I),n.value.addEventListener("pointerdown",M),n.value.addEventListener("pointermove",T),n.value.addEventListener("pointerleave",D),n.value.addEventListener("dblclick",L),n.value.addEventListener("wheel",R),Ut((()=>{null!=n&&n.value&&(n.value.removeEventListener("pointerup",I),n.value.removeEventListener("pointerdown",M),n.value.removeEventListener("pointermove",T),n.value.removeEventListener("pointerleave",D),n.value.removeEventListener("dblclick",L),n.value.removeEventListener("wheel",R))})),{intersects:r,onClick:e=>d.on(e).off,onDblClick:e=>p.on(e).off,onContextMenu:e=>y.on(e).off,onPointerMove:e=>m.on(e).off,onPointerUp:e=>f.on(e).off,onPointerDown:e=>g.on(e).off,onPointerMissed:e=>v.on(e).off,onWheel:e=>x.on(e).off,forceUpdate:()=>{w&&T(w)}}};function Yr(e,t){if(Array.isArray(e))for(const n of e)n(t);"function"==typeof e&&e(t)}const Wr=new WeakMap;function Gr(e){if(e=e||Kr(),Wr.has(e))return Wr.get(e);const t=Date.now(),n=function(e,t,n=100){n=n<=0?100:n;const r=In(),s=new Set;let o=!1,i=!1,a=null;return function l(){a&&clearTimeout(a),i||o||!e()?!i&&!o&&(a=setTimeout(l,n)):(r.trigger(t),s.forEach((e=>e())),s.clear(),o=!0)}(),{on:e=>{if(o)return((e,...t)=>{e(...t)})(e,t),{off:()=>{}};{const t=r.on(e);return s.add(t.off),r.on(e)}},off:r.off,trigger:r.trigger,clear:r.clear,cancel:function(){i=!0,a&&clearTimeout(a)}}}((()=>{if(Date.now()-t>=100)return!0;{const t=e.renderer.value,n=(null==t?void 0:t.domElement)||{width:0,height:0};return!!(t&&n.width>0&&n.height>0)}}),e);return Wr.set(e,n),n}function Zr({scene:e,canvas:t,windowSize:r,rendererOptions:s,emit:o}){const i=Dt(e),a=function(e,t,n=10){const r=Rn(e)?kn():Nn(Wt((()=>Rn(t).parentElement))),s=Gt(Un(r.width,n)),o=Gt(Un(r.height,n)),i=Wt((()=>s.value/o.value));return{height:o,width:s,aspectRatio:i}}(r,t),{camera:c,cameras:u,registerCamera:h,deregisterCamera:d,setCameraActive:p}=(({sizes:e})=>{const t=Ot([]),r=Wt((()=>t.value[0])),s=e=>{const n=e instanceof A?e:t.value.find((t=>t.uuid===e));if(!n)return;const r=t.value.filter((({uuid:e})=>e!==n.uuid));t.value=[n,...r]};return Xt((()=>{e.aspectRatio.value&&t.value.forEach((t=>{!t.manual&&(t instanceof n||function(e){return e.hasOwnProperty("isOrthographicCamera")&&e.isOrthographicCamera}(t))&&(t instanceof n?t.aspect=e.aspectRatio.value:(t.left=-.5*e.width.value,t.right=.5*e.width.value,t.top=.5*e.height.value,t.bottom=-.5*e.height.value),t.updateProjectionMatrix())}))})),Ut((()=>{t.value=[]})),{camera:r,cameras:t,registerCamera:(e,n=!1)=>{if(ir(e)){const r=e;if(t.value.some((({uuid:e})=>e===r.uuid)))return;n?s(r):t.value.push(r)}},deregisterCamera:e=>{if(ir(e)){const n=e;t.value=t.value.filter((({uuid:e})=>e!==n.uuid))}},setCameraActive:s}})({sizes:a}),m={mode:Ot(s.renderMode||"always"),priority:Ot(0),frames:Ot(0),maxFrames:60,canBeInvalidated:Wt((()=>"on-demand"===m.mode.value&&0===m.frames.value))};function f(e=1){"on-demand"===s.renderMode&&(m.frames.value=Math.min(m.maxFrames,m.frames.value+e))}function g(){"manual"===s.renderMode&&(m.frames.value=1)}const{renderer:v}=Vr({canvas:t,options:s,contextParts:{sizes:a,render:m,invalidate:f,advance:g}}),y={sizes:a,scene:i,camera:c,cameras:Gt(u),renderer:v,raycaster:Dt(new l),controls:Ot(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},render:m,advance:g,extend:kr,invalidate:f,registerCamera:h,setCameraActive:p,deregisterCamera:d,loop:Ur()};Kt("useTres",y),y.scene.value.__tres={root:y},y.loop.register((()=>{c.value&&m.frames.value>0&&(v.value.render(e,c.value),o("render",y.renderer.value)),m.priority.value=0,"always"===m.mode.value?m.frames.value=1:m.frames.value=Math.max(0,m.frames.value-1)}),"render");const{on:x,cancel:b}=Gr(y);y.loop.setReady(!1),y.loop.start(),x((()=>{o("ready",y),y.loop.setReady(!0),function(e,t,n){var r;const s=Dt(),o=Dt();e&&(s.value=e),t&&(o.value=t);const i=e=>{var t;return(null==(t=e.children)?void 0:t.some((e=>i(e))))||(e=>{var t;return(null==(t=e.__tres)?void 0:t.eventCount)>0})(e)},a=Dt((null==(r=s.value)?void 0:r.children).filter(i)||[]);function l(e,t){const r=[];t.stopPropagation=()=>t.stopPropagating=!0;for(const s of null==t?void 0:t.intersections){if(t.stopPropagating)return;t={...t,...s};const{object:o}=s;t.eventObject=o,Yr(o[e],t),r.push(o);let i=o.parent;for(;null!==i&&!t.stopPropagating&&!r.includes(i);)t.eventObject=i,Yr(i[e],t),r.push(i),i=i.parent;const a=pr(e.slice(2));n(a,{intersection:s,event:t})}}const{onClick:c,onDblClick:u,onContextMenu:h,onPointerMove:d,onPointerDown:p,onPointerUp:m,onPointerMissed:f,onWheel:g,forceUpdate:v}=Xr(a,t);m((e=>l("onPointerUp",e))),p((e=>l("onPointerDown",e))),c((e=>l("onClick",e))),u((e=>l("onDoubleClick",e))),h((e=>l("onContextMenu",e))),g((e=>l("onWheel",e)));let y=[];d((e=>{const t=e.intersections.map((({object:e})=>e)),n=e.intersections;y.forEach((({object:n})=>{t.includes(n)||(e.intersections=y,l("onPointerLeave",e),l("onPointerOut",e))})),e.intersections=n,e.intersections.forEach((({object:t})=>{y.includes(t)||(l("onPointerEnter",e),l("onPointerOver",e))})),l("onPointerMove",e),y=e.intersections}));const x=[];function b(e){ar(e)&&or(e)&&a.value.push(e)}function w(e){if(ar(e)&&or(e)){const t=a.value.indexOf(e);t>-1&&a.value.splice(t,1)}}function T(e){ar(e)&&or(e)&&e.onPointerMissed&&x.push(e)}function _(e){if(ar(e)&&or(e)){const t=x.indexOf(e);t>-1&&x.splice(t,1)}}f((e=>{e.stopPropagation=()=>e.stopPropagating=!0,x.forEach((t=>{e.stopPropagating||(e.eventObject=t,Yr(t.onPointerMissed,e))})),n("pointer-missed",{event:e})})),t.eventManager={forceUpdate:v,registerObject:b,deregisterObject:w,registerPointerMissedObject:T,deregisterPointerMissedObject:_}}(e,y,o)})),Ut((()=>{b(),y.loop.stop()}));const w=Ln({every:100}),{isSupported:T,memory:_}=Dn({interval:100});let E=performance.now();let M=0;const{pause:S}=Pn((({delta:e})=>{window.__TRES__DEVTOOLS__&&((({timestamp:e})=>{y.scene.value&&(y.perf.memory.allocatedMem=Fr(y.scene.value)),e-E>=100&&(E=e,y.perf.fps.accumulator.push(w.value),y.perf.fps.accumulator.length>160&&y.perf.fps.accumulator.shift(),y.perf.fps.value=w.value,T.value&&_.value&&(y.perf.memory.accumulator.push(_.value.usedJSHeapSize/1024/1024),y.perf.memory.accumulator.length>160&&y.perf.memory.accumulator.shift(),y.perf.memory.currentMem=y.perf.memory.accumulator.reduce(((e,t)=>e+t),0)/y.perf.memory.accumulator.length))})({timestamp:performance.now()}),M+=e,M>=1&&(window.__TRES__DEVTOOLS__.cb(y),M=0))}),{immediate:!0});return Ut((()=>{S()})),y}function Kr(){const e=Yt("useTres");if(!e)throw new Error("useTresContext must be used together with useTresContextProvider");return e}function Qr(){const{camera:e,scene:t,renderer:n,loop:r,raycaster:s,controls:o,invalidate:i,advance:a}=Kr();return r.setContext({camera:e,scene:t,renderer:n,raycaster:s,controls:o,invalidate:i,advance:a}),{pause:r.pause,resume:r.resume,pauseRender:r.pauseRender,resumeRender:r.resumeRender,isActive:r.isActive,onBeforeRender:function(e,t=0){return r.register(e,"before",t)},render:function(e){return r.register(e,"render")},onAfterRender:function(e,t=0){return r.register(e,"after",t)}}}const qr=In(),Jr=In(),$r=In(),es=new e;let ts=0,ns=0;const{pause:rs,resume:ss,isActive:os}=Pn((()=>{qr.trigger({delta:ts,elapsed:ns,clock:es}),Jr.trigger({delta:ts,elapsed:ns,clock:es}),$r.trigger({delta:ts,elapsed:ns,clock:es})}),{immediate:!1});$r.on((()=>{ts=es.getDelta(),ns=es.getElapsedTime()}));let is=!1;const as=()=>(is||(is=!0,ss()),{onBeforeLoop:qr.on,onLoop:Jr.on,onAfterLoop:$r.on,pause:rs,resume:ss,isActive:os});function ls(){const{logWarning:e}=Dr();function t(t,n,r){let s=null;return t.traverse((e=>{e[n]===r&&(s=e)})),s||e(`Child with ${n} '${r}' not found.`),s}function n(t,n,r){const s=[];return t.traverse((e=>{e[n].includes(r)&&s.push(e)})),s.length||e(`Children with ${n} '${r}' not found.`),s}return{seek:t,seekByName:function(e,n){return t(e,"name",n)},seekAll:n,seekAllByName:function(e,t){return n(e,"name",t)}}}const{logError:cs}=Dr(),us=["onClick","onContextMenu","onPointerMove","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onDoubleClick","onPointerDown","onPointerUp","onPointerCancel","onPointerMissed","onLostPointerCapture","onWheel"],hs=e=>{const t=e.scene.value;function n(n,r){var s,o,i;if(!n)return;r=r||t;const a=n.__tres?n:_r(n,{},e),l=r.__tres?r:_r(r,{},e);n=Ar(a),r=Ar(l),n.__tres&&(null==(s=n.__tres)?void 0:s.eventCount)>0&&(null==(o=e.eventManager)||o.registerObject(n)),e.registerCamera(n),null==(i=e.eventManager)||i.registerPointerMissedObject(n),a.__tres.attach?function(e,t,n){if(nr(n)){if(Tr.test(n)){const t=n.replace(Tr,""),{target:r,key:s}=br(e,t);if(!Array.isArray(r[s])){const e=r[s],t=[];t.__tresDetach=()=>{t.every((e=>er(e)))&&(r[s]=e)},r[s]=t}}const{target:r,key:s}=br(e,n);t.__tres.previousAttach=r[s],r[s]=Ar(t)}else t.__tres.previousAttach=n(e,t)}(l,a,a.__tres.attach):or(n)&&or(l)&&(l.add(n),n.dispatchEvent({type:"added"})),a.__tres.parent=l,l.__tres.objects&&!l.__tres.objects.includes(a)&&l.__tres.objects.push(a)}function r(t,n){var s,o,i,a;if(!t)return;null!=t&&t.__tres&&(null==(s=t.__tres)?void 0:s.eventCount)>0&&(null==(o=e.eventManager)||o.deregisterObject(t)),n=er(n)?"default":n;const l=null==(i=t.__tres)?void 0:i.dispose;er(l)||(n=null!==l&&l);const c=null==(a=t.__tres)?void 0:a.primitive,u="default"===n?!c:!!n;if(t.__tres&&"objects"in t.__tres&&[...t.__tres.objects].forEach((e=>r(e,n))),u&&t.children&&[...t.children].forEach((e=>r(e,n))),Mr(t,e),Sr(t,e),u&&!function(e){return sr(e)&&"isScene"in e&&!!e.isScene}(t))if(rr(n))n(t);else if(rr(t.dispose))try{t.dispose()}catch{}"__tres"in t&&delete t.__tres}function s(t,s,o,i){var a,l;if(!t)return;let c=t,u=s;if(t.__tres&&(t.__tres.memoizedProps[s]=i),"attach"===s){const s=(null==(a=t.__tres)?void 0:a.parent)||t.parent;return r(t),_r(t,{attach:i},e),void(s&&n(t,s))}if("dispose"===s)return t.__tres||(t=_r(t,{},e)),void(t.__tres.dispose=i);if(or(t)&&"blocks-pointer-events"===u)return void(i||""===i?t[u]=i:delete t[u]);us.includes(s)&&t.__tres&&(t.__tres.eventCount+=1);let h=hr(u),d=null==c?void 0:c[h];if("args"===u){const e=t,n=o??[],r=i??[],s=(null==(l=t.__tres)?void 0:l.type)||t.type;return void(s&&n.length&&!function(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!gr(e[n],t[n]))return!1;return!0}(n,r)&&(c=Object.assign(e,new Rr.value[s](...i))))}if("BufferGeometry"===c.type){if("args"===u)return;return void c.setAttribute(hr(u),new E(...i))}if(u.includes("-")&&void 0===d){const e=u.split("-");d=e.reduce(((e,t)=>e[hr(t)]),c),u=e.pop(),h=u,null!=d&&d.set||(c=e.reduce(((e,t)=>e[hr(t)]),c))}let p=i;if(""===p&&(p=!0),rr(d))return us.includes(s)||(tr(p)?t[h](...p):t[h](p)),void(h.startsWith("on")&&rr(p)&&(c[h]=p));null!=d&&d.set||rr(d)?d.constructor===p.constructor&&null!=d&&d.copy?null==d||d.copy(p):tr(p)?d.set(...p):!d.isColor&&d.setScalar?d.setScalar(p):d.set(p):c[h]=p,Er(t)}function o(e){var t;return(null==(t=null==e?void 0:e.__tres)?void 0:t.parent)||null}return{insert:n,remove:r,createElement:function(t,o,i,a){if(a||(a={}),a.args||(a.args=[]),"template"===t||cr(t))return null;let l,c=t.replace("Tres","");if("primitive"===t){(!sr(a.object)||qt(a.object))&&cs("Tres primitives need an 'object' prop, whose value is an object or shallowRef<object>"),c=a.object.type;const t={};l=function(e,t={},n={}){let r=e;const s=e=>{r=e};let o=new Proxy({},{});return o=new Proxy({},{has:(e,n)=>n in t||n in r,get:(e,n,s)=>n in t?t[n](r):r[n],set(e,t,i){const a=n[t];return a&&"function"==typeof a?a(i,r,o,s):r[t]=i,!0}}),o}(a.object,{object:e=>e,isPrimitive:()=>!0,__tres:()=>t},{object:(t,o,i,a)=>{!function(e,t,n,r,s){const o=[...t.__tres.objects],i=Ar(t);if(i===(e=Ar(e)))return!0;const a=_r(e,t.__tres??{},s),l=t.parent??t.__tres.parent??null,c={...t.__tres.memoizedProps};delete c.object;for(const u of o)Mr(u,s),Sr(u,s);i.__tres.objects=[],r.remove(t);for(const[u,h]of Object.entries(c))r.patchProp(a,u,a[u],h);n(e),r.insert(t,l);for(const u of o)r.insert(u,t)}(t,i,a,{patchProp:s,remove:r,insert:n},e)},__tres:e=>{Object.assign(t,e)}})}else{const e=Rr.value[c];e||cs(`${c} is not defined on the THREE namespace. Use extend to add it to the catalog.`),l=new e(...a.args)}return l?(l.isCamera&&(null!=a&&a.position||l.position.set(3,3,3),null!=a&&a.lookAt||l.lookAt(0,0,0)),l=_r(l,{...l.__tres,type:c,memoizedProps:a,eventCount:0,primitive:"primitive"===t,attach:a.attach},e),l):null},patchProp:s,parentNode:o,createText:()=>{},createComment:function(t){const n=_r(new _,{type:"Comment"},e);return n.name=t,n},setText:()=>{},setElementText:()=>{},nextSibling:function(e){var t;const n=o(e),r=(null==(t=null==n?void 0:n.__tres)?void 0:t.objects)||[],s=r.indexOf(e);return s<0||s>=r.length-1?null:r[s+1]},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}}};function ds(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const ps="function"==typeof Proxy;let ms,fs;function gs(){return void 0!==ms||(typeof window<"u"&&window.performance?(ms=!0,fs=window.performance):typeof globalThis<"u"&&null!==(e=globalThis.perf_hooks)&&void 0!==e&&e.performance?(ms=!0,fs=globalThis.perf_hooks.performance):ms=!1),ms?fs.now():Date.now();var e}class vs{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const o in e.settings){const t=e.settings[o];n[o]=t.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},n);try{const e=localStorage.getItem(r),t=JSON.parse(e);Object.assign(s,t)}catch{}this.fallbacks={getSettings:()=>s,setSettings(e){try{localStorage.setItem(r,JSON.stringify(e))}catch{}s=e},now:()=>gs()},t&&t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((n=>{this.targetQueue.push({method:t,args:e,resolve:n})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function ys(e,t){const n=e,r=ds(),s=ds().__VUE_DEVTOOLS_GLOBAL_HOOK__,o=ps&&n.enableEarlyProxy;if(!s||!r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&o){const e=o?new vs(n,s):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:t,proxy:e}),e&&t(e.proxiedTarget)}else s.emit("devtools-plugin:setup",e,t)}function xs(e,t){throw new Error(e+t)}const bs=e=>{const t={id:e.uuid,label:e.type,children:[],tags:[]};""!==e.name&&t.tags.push({label:e.name,textColor:5750629,backgroundColor:15793395});const n=Fr(e);return n>0&&t.tags.push({label:`${zr(n)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),e.type.includes("Light")&&(function(e){return sr(e)&&"isLight"in e&&!!e.isLight}(e)&&t.tags.push({label:`${e.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),t.tags.push({label:`#${new g(e.color).getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),e.type.includes("Camera")&&(t.tags.push({label:`${e.fov}Â°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),t.tags.push({label:`x: ${Math.round(e.position.x)} y: ${Math.round(e.position.y)} z: ${Math.round(e.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),t};function ws(e,t,n=""){e.children.forEach((e=>{if("HightlightMesh"===e.type||n&&!e.type.includes(n)&&!e.name.includes(n))return;const r=bs(e);t.children.push(r),ws(e,r,n)}))}const Ts=[],_s="tres:inspector",Es=Pt({sceneGraph:null});function As(e,t){ys({id:"dev.esm.tres",label:"TresJS ðŸª",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:Ts,app:e},(e=>{"function"!=typeof e.now&&function(e,t){const n=`â–² â–  â—${e}`;xs(n,t)}("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),e.addInspector({id:_s,label:"TresJS ðŸª",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval((()=>{e.sendInspectorTree(_s)}),1e3),setInterval((()=>{e.notifyComponentUpdate()}),5e3),e.on.getInspectorTree((e=>{if(e.inspectorId===_s){const n=bs(t.scene.value);ws(t.scene.value,n,e.filter),Es.sceneGraph=n,e.rootNodes=[n]}}));let n=null,r=null;e.on.getInspectorState((e=>{var s;if(e.inspectorId===_s){const[o]=t.scene.value.getObjectsByProperty("uuid",e.nodeId);if(!o)return;if(r&&n&&n.parent&&r.remove(n),o.isMesh){const e=function(e){const t=new m({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:P});return new $n(e.geometry.clone(),t)}(o);o.add(e),n=e,r=o}e.state={object:Object.entries(o).map((([e,t])=>"children"===e?{key:e,value:t.filter((e=>"HightlightMesh"!==e.type))}:{key:e,value:t,editable:!0})).filter((({key:e})=>"parent"!==e))},o.isScene&&(e.state={...e.state,state:[{key:"Scene Info",value:{objects:o.children.length,memory:Fr(o),calls:t.renderer.value.info.render.calls,triangles:t.renderer.value.info.render.triangles,points:t.renderer.value.info.render.points,lines:t.renderer.value.info.render.lines}},{key:"Programs",value:(null==(s=t.renderer.value.info.programs)?void 0:s.map((e=>({...e,programName:e.name}))))||[]}]})}})),e.on.editInspectorState((e=>{e.inspectorId===_s&&function(e,t,n,r){const s=e=>{if(e.uuid===t)return e;for(const t of e.children){const e=s(t);if(e)return e}},o=s(e);if(!o)return void console.warn("Object with UUID not found in the scene.");let i=o;for(let l=0;l<n.length-1;l++){if(void 0===i[n[l]])return void console.warn(`Property path is not valid: ${n.join(".")}`);i=i[n[l]]}const a=n[n.length-1];void 0!==i[a]?i[a]=r:console.warn(`Property path is not valid: ${n.join(".")}`)}(t.scene.value,e.nodeId,e.path,e.state.value)}))}))}const Ms=["data-scene","data-tres"],Ss=It({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},dpr:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},enableProvideBridge:{type:Boolean,default:!0},context:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0},precision:{},logarithmicDepthBuffer:{type:Boolean,default:void 0},reverseDepthBuffer:{type:Boolean}},emits:["render","click","double-click","context-menu","pointer-move","pointer-up","pointer-down","pointer-enter","pointer-leave","pointer-over","pointer-out","pointer-missed","wheel","ready"],setup(e,{expose:r,emit:s}){const o=e,i=s,a=Lt(),l=Ot(),c=Dt(new t),u=Zt();kr(O);const h=(e,t=!1)=>{const n=((e,t=!1)=>It({setup(){var n;const r=null==(n=Zt())?void 0:n.appContext;r&&(r.app=null==u?void 0:u.appContext.app);const s={};return null!=u&&u.parent&&o.enableProvideBridge&&(function e(t){t&&(t.parent&&e(t.parent),t.provides&&Object.assign(s,t.provides))}(u.parent),Reflect.ownKeys(s).forEach((e=>{Kt(e,s[e])}))),Kt("useTres",e),Kt("extend",kr),typeof window<"u"&&As(null==r?void 0:r.app,e),()=>Vt(Qt,null,t?[]:a.default())}}))(e,t),{render:r}=Ht(hs(e));r(Vt(n),c.value)},d=(e,t=!1)=>{xr(e.scene.value),t&&(e.renderer.value.dispose(),e.renderer.value.renderLists.dispose(),e.renderer.value.forceContextLoss()),c.value.__tres={root:e}},p=Dt(null);r({context:p,dispose:()=>d(p.value,!0)});return kt((()=>{const e=l;p.value=Zr({scene:c.value,canvas:e,windowSize:o.windowSize??!1,rendererOptions:o,emit:i});const{registerCamera:t,camera:r,cameras:s,deregisterCamera:a}=p.value;h(p.value);Nt((()=>o.camera),((e,n)=>{e&&t(e),n&&(n.removeFromParent(),a(n))}),{immediate:!0}),r.value||(()=>{const e=new n(45,window.innerWidth/window.innerHeight,.1,1e3);e.position.set(3,3,3),e.lookAt(0,0,0),t(e);const r=Xt((()=>{s.value.length>=2&&(e.removeFromParent(),a(e),null==r||r())}))})()})),Ut((()=>{d(p.value),h(p.value,!0)})),(e,t)=>(Ft(),Rt("canvas",{ref_key:"canvas",ref:l,"data-scene":c.value.uuid,class:jt(e.$attrs.class),"data-tres":`tresjs ${Bt(qn).version}`,style:zt({display:"block",width:"100%",height:"100%",position:e.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...e.$attrs.style})},null,14,Ms))}});let Cs=class extends c{constructor(e,t){const n=new u;n.setAttribute("position",new h([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();super(n,new d({fog:!1})),this.light=e,this.color=t,this.type="RectAreaLightHelper";const r=new u;r.setAttribute("position",new h([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new p(r,new m({side:f,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}};const{logWarning:Os}=Dr();let Ps,Is;const Ls={DirectionalLight:a,PointLight:i,SpotLight:o,HemisphereLight:s,RectAreaLight:Cs},Ds={mounted:e=>{e.isLight?(Ps=Ls[e.type],e.parent.add(new Ps(e,1,e.color.getHex()))):Os(`${e.type} is not a light`)},updated:e=>{Is=e.parent.children.find((e=>e instanceof Ps)),!(Is instanceof Cs)&&Is.update()},unmounted:e=>{e.isLight?(Is=e.parent.children.find((e=>e instanceof Ps)),Is&&Is.dispose&&Is.dispose(),e.parent&&e.parent.remove(Is)):Os(`${e.type} is not a light`)}},Rs={install(e){e.component("TresCanvas",Ss)}};var ks=Object.defineProperty,Ns=(e,t,n)=>((e,t,n)=>t in e?ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);function Us(e){return!!pn()&&(mn(e),!0)}function Fs(e){return"function"==typeof e?e():Bt(e)}const zs=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const Bs=Object.prototype.toString,js=()=>{};function Hs(e,t){return function(...n){return new Promise(((r,s)=>{Promise.resolve(e((()=>t.apply(this,n)),{fn:t,thisArg:this,args:n})).then(r).catch(s)}))}}function Vs(e,t=200,n={}){return Hs(function(e,t={}){let n,r,s=js;const o=e=>{clearTimeout(e),s(),s=js};return i=>{const a=Fs(e),l=Fs(t.maxWait);return n&&o(n),a<=0||void 0!==l&&l<=0?(r&&(o(r),r=null),Promise.resolve(i())):new Promise(((e,c)=>{s=t.rejectOnCancel?c:e,l&&!r&&(r=setTimeout((()=>{n&&o(n),r=null,e(i())}),l)),n=setTimeout((()=>{r&&o(r),r=null,e(i())}),a)}))}}(t,n),e)}function Xs(e,t=200,n=!1,r=!0,s=!1){return Hs(function(...e){let t,n,r,s,o,i,a=0,l=!0,c=js;qt(e[0])||"object"!=typeof e[0]?[r,s=!0,o=!0,i=!1]=e:({delay:r,trailing:s=!0,leading:o=!0,rejectOnCancel:i=!1}=e[0]);const u=()=>{t&&(clearTimeout(t),t=void 0,c(),c=js)};return e=>{const h=Fs(r),d=Date.now()-a,p=()=>n=e();return u(),h<=0?(a=Date.now(),p()):(d>h&&(o||!l)?(a=Date.now(),p()):s&&(n=new Promise(((e,n)=>{c=i?n:e,t=setTimeout((()=>{a=Date.now(),l=!0,e(p()),u()}),Math.max(0,h-d))}))),!o&&!t&&(t=setTimeout((()=>l=!0),h)),l=!1,n)}}(t,n,r,s),e)}function Ys(e,t=!0,n){Zt()?kt(e,n):t?e():dn(e)}const Ws=zs?window:void 0;function Gs(e){var t;const n=Fs(e);return null!=(t=null==n?void 0:n.$el)?t:n}function Zs(...e){let t,n,r,s;if("string"==typeof e[0]||Array.isArray(e[0])?([n,r,s]=e,t=Ws):[t,n,r,s]=e,!t)return js;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const o=[],i=()=>{o.forEach((e=>e())),o.length=0},a=Nt((()=>[Gs(t),Fs(s)]),(([e,t])=>{if(i(),!e)return;const s=(e=>"[object Object]"===Bs.call(e))(t)?{...t}:t;o.push(...n.flatMap((t=>r.map((n=>((e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)))(e,t,n,s))))))}),{immediate:!0,flush:"post"}),l=()=>{a(),i()};return Us(l),l}function Ks(e){const t=function(){const e=Ot(!1),t=Zt();return t&&kt((()=>{e.value=!0}),t),e}();return Wt((()=>(t.value,!!e())))}const Qs={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function qs(e={}){const{window:t=Ws,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:s=!0,includeScrollbar:o=!0,type:i="inner"}=e,a=Ot(n),l=Ot(r),c=()=>{t&&("outer"===i?(a.value=t.outerWidth,l.value=t.outerHeight):o?(a.value=t.innerWidth,l.value=t.innerHeight):(a.value=t.document.documentElement.clientWidth,l.value=t.document.documentElement.clientHeight))};if(c(),Ys(c),Zs("resize",c,{passive:!0}),s){const e=function(e,t={}){const{window:n=Ws}=t,r=Ks((()=>n&&"matchMedia"in n&&"function"==typeof n.matchMedia));let s;const o=Ot(!1),i=e=>{o.value=e.matches},a=()=>{s&&("removeEventListener"in s?s.removeEventListener("change",i):s.removeListener(i))},l=Xt((()=>{r.value&&(a(),s=n.matchMedia(Fs(e)),"addEventListener"in s?s.addEventListener("change",i):s.addListener(i),o.value=s.matches)}));return Us((()=>{l(),a(),s=void 0})),o}("(orientation: portrait)");Nt(e,(()=>c()))}return{width:a,height:l}}function Js(e,t,n,r){const s=class extends R{constructor(r={}){const s=Object.entries(e);super({uniforms:s.reduce(((e,[t,n])=>({...e,...ce.clone({[t]:{value:n}})})),{}),vertexShader:t,fragmentShader:n}),Ns(this,"key",""),s.forEach((([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t}))),Object.assign(this,r)}};return s.key=T.generateUUID(),s}Js({color:new g("white"),scale:new S(1,1),imageBounds:new S(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n    varying vec2 vUv;\n    varying vec2 vPos;\n    void main() {\n      gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n      vUv = uv;\n      vPos = position.xy;\n    }\n  ","\n    // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n    varying vec2 vUv;\n    varying vec2 vPos;\n    uniform vec2 scale;\n    uniform vec2 imageBounds;\n    uniform float resolution;\n    uniform vec3 color;\n    uniform sampler2D map;\n    uniform float radius;\n    uniform float zoom;\n    uniform float grayscale;\n    uniform float opacity;\n    const vec3 luma = vec3(.299, 0.587, 0.114);\n    vec4 toGrayscale(vec4 color, float intensity) {\n      return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n    }\n    vec2 aspect(vec2 size) {\n      return size / min(size.x, size.y);\n    }\n    \n    const float PI = 3.14159265;\n      \n    // from https://iquilezles.org/articles/distfunctions\n    float udRoundBox( vec2 p, vec2 b, float r ) {\n      return length(max(abs(p)-b+r,0.0))-r;\n    }\n  \n    void main() {\n      vec2 s = aspect(scale);\n      vec2 i = aspect(imageBounds);\n      float rs = s.x / s.y;\n      float ri = i.x / i.y;\n      vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n      vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n      vec2 uv = vUv * s / new + offset;\n      vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n  \n      vec2 res = vec2(scale * resolution);\n      vec2 halfRes = 0.5 * res;\n      float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n        vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n      gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n      \n      #include <tonemapping_fragment>\n      #include <colorspace_fragment>\n    }\n  ");const $s=parseInt(M.replace(/\D+/g,"")),eo=$s>=125?"uv1":"uv2";function to(e,t){if(t===rt)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===st||t===ot){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const r=n.count-2,s=[];if(n)if(t===st)for(let e=1;e<=r;e++)s.push(n.getX(0)),s.push(n.getX(e)),s.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(s.push(n.getX(e)),s.push(n.getX(e+1)),s.push(n.getX(e+2))):(s.push(n.getX(e+2)),s.push(n.getX(e+1)),s.push(n.getX(e)));s.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=e.clone();return o.setIndex(s),o.clearGroups(),o}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}var no=Object.defineProperty;async function ro(e){const t=await e.arrayBuffer(),n=btoa(String.fromCharCode(...new Uint8Array(t)));return`data:${e.type||""};base64,${n}`}let so,oo,io,ao;function lo(e,r=1/0,s=null){oo||(oo=new D(2,2,1,1)),io||(io=new R({uniforms:{blitTexture:new yt(e)},vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = vec4(position.xy * 1.0,0.,.999999);\n        }\n      ",fragmentShader:"\n          uniform sampler2D blitTexture; \n          varying vec2 vUv;\n\n          void main(){ \n              gl_FragColor = vec4(vUv.xy, 0, 1);\n              \n              #ifdef IS_SRGB\n              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n              #else\n              gl_FragColor = texture2D( blitTexture, vUv);\n              #endif\n          }\n      "})),io.uniforms.blitTexture.value=e,io.defines.IS_SRGB="colorSpace"in e?"srgb"===e.colorSpace:3001===e.encoding,io.needsUpdate=!0,ao||(ao=new p(oo,io),ao.frustrumCulled=!1);const o=new n,i=new t;i.add(ao),s||(s=so=new v({antialias:!1})),s.setSize(Math.min(e.image.width,r),Math.min(e.image.height,r)),s.clear(),s.render(i,o);const a=new Ne(s.domElement);return a.minFilter=e.minFilter,a.magFilter=e.magFilter,a.wrapS=e.wrapS,a.wrapT=e.wrapT,a.name=e.name,so&&(so.dispose(),so=null),a}const co={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class uo{constructor(){this.pluginCallbacks=[],this.register((function(e){return new Wo(e)})),this.register((function(e){return new Go(e)})),this.register((function(e){return new Qo(e)})),this.register((function(e){return new qo(e)})),this.register((function(e){return new Jo(e)})),this.register((function(e){return new $o(e)})),this.register((function(e){return new Zo(e)})),this.register((function(e){return new Ko(e)})),this.register((function(e){return new ei(e)})),this.register((function(e){return new ti(e)})),this.register((function(e){return new ni(e)}))}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){const s=new Yo,o=[];for(let i=0,a=this.pluginCallbacks.length;i<a;i++)o.push(this.pluginCallbacks[i](s));s.setPlugins(o),s.write(e,t,r).catch(n)}parseAsync(e,t){const n=this;return new Promise((function(r,s){n.parse(e,r,s,t)}))}}var ho;ho={insertKeyframe:function(e,t){const n=e.getValueSize(),r=new e.TimeBufferType(e.times.length+1),s=new e.ValueBufferType(e.values.length+n),o=e.createInterpolant(new e.ValueBufferType(n));let i;if(0===e.times.length){r[0]=t;for(let e=0;e<n;e++)s[e]=0;i=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;r[0]=t,r.set(e.times,1),s.set(o.evaluate(t),0),s.set(e.values,n),i=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;r[r.length-1]=t,r.set(e.times,0),s.set(e.values,0),s.set(o.evaluate(t),e.values.length),i=r.length-1}else for(let a=0;a<e.times.length;a++){if(Math.abs(e.times[a]-t)<.001)return a;if(e.times[a]<t&&e.times[a+1]>t){r.set(e.times.slice(0,a+1),0),r[a+1]=t,r.set(e.times.slice(a+1),a+2),s.set(e.values.slice(0,(a+1)*n),0),s.set(o.evaluate(t),(a+1)*n),s.set(e.values.slice((a+1)*n),(a+2)*n),i=a+1;break}}return e.times=r,e.values=s,i},mergeMorphTargetTracks:function(e,t){const n=[],r={},s=e.tracks;for(let o=0;o<s.length;++o){let e=s[o];const i=ze.parseTrackName(e.name),a=ze.findNode(t,i.nodeName);if("morphTargetInfluences"!==i.propertyName||void 0===i.propertyIndex){n.push(e);continue}if(e.createInterpolant!==e.InterpolantFactoryMethodDiscrete&&e.createInterpolant!==e.InterpolantFactoryMethodLinear){if(e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),e=e.clone(),e.setInterpolation(Ze)}const l=a.morphTargetInfluences.length,c=a.morphTargetDictionary[i.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+i.propertyIndex);let u;if(void 0===r[a.uuid]){u=e.clone();const t=new u.ValueBufferType(l*u.times.length);for(let e=0;e<u.times.length;e++)t[e*l+c]=u.values[e];u.name=(i.nodeName||"")+".morphTargetInfluences",u.values=t,r[a.uuid]=u,n.push(u);continue}const h=e.createInterpolant(new e.ValueBufferType(1));u=r[a.uuid];for(let t=0;t<u.times.length;t++)u.values[t*l+c]=h.evaluate(u.times[t]);for(let t=0;t<e.times.length;t++){const n=this.insertKeyframe(u,e.times[t]);u.values[n*l+c]=e.values[t]}}return e.tracks=n,e}},((e,t,n)=>{t in e?no(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(uo,"Utils"+"",ho);const po=0,mo=1,fo=2,go=3,vo=4,yo=5120,xo=5121,bo=5122,wo=5123,To=5124,_o=5125,Eo=5126,Ao=34962,Mo=34963,So=9728,Co=9729,Oo=9984,Po=9985,Io=9986,Lo=9987,Do=33071,Ro=33648,ko=10497,No="KHR_mesh_quantization",Uo={};Uo[Le]=So,Uo[Ie]=Oo,Uo[Oe]=Io,Uo[ve]=Co,Uo[Pe]=Po,Uo[Ce]=Lo,Uo[ke]=Do,Uo[De]=ko,Uo[Re]=Ro;const Fo={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},zo=new g;function Bo(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}function jo(e){return 4*Math.ceil(e/4)}function Ho(e,t=0){const n=jo(e.byteLength);if(n!==e.byteLength){const r=new Uint8Array(n);if(r.set(new Uint8Array(e)),0!==t)for(let s=e.byteLength;s<n;s++)r[s]=t;return r.buffer}return e}function Vo(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Xo(e,t){if(void 0!==e.toBlob)return new Promise((n=>e.toBlob(n,t)));let n;return"image/jpeg"===t?n=.92:"image/webp"===t&&(n=.8),e.convertToBlob({type:t,quality:n})}class Yo{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,n={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const r=this,s=r.buffers,o=r.json;n=r.options;const i=r.extensionsUsed,a=r.extensionsRequired,l=new Blob(s,{type:"application/octet-stream"}),c=Object.keys(i),u=Object.keys(a);c.length>0&&(o.extensionsUsed=c),u.length>0&&(o.extensionsRequired=u),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=l.size),!0===n.binary?l.arrayBuffer().then((e=>{const n=Ho(e),r=new DataView(new ArrayBuffer(8));r.setUint32(0,n.byteLength,!0),r.setUint32(4,5130562,!0);const s=Ho(function(e){return(new TextEncoder).encode(e).buffer}(JSON.stringify(o)),32),i=new DataView(new ArrayBuffer(8));i.setUint32(0,s.byteLength,!0),i.setUint32(4,1313821514,!0);const a=new ArrayBuffer(12),l=new DataView(a);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);const c=12+i.byteLength+s.byteLength+r.byteLength+n.byteLength;l.setUint32(8,c,!0),new Blob([a,i,s,r,n],{type:"application/octet-stream"}).arrayBuffer().then(t)})):o.buffers&&o.buffers.length>0?ro(l).then((e=>{o.buffers[0].uri=e,t(o)})):t(o)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const n=this.options,r=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&s.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in s.gltfExtensions)t.extensions[e]=s.gltfExtensions[e],r[e]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(t.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new C;for(let n=0,r=e.count;n<r;n++)if(Math.abs(t.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const n=e.clone(),r=new C;for(let s=0,o=n.count;s<o;s++)r.fromBufferAttribute(n,s),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),n.setXYZ(s,r.x,r.y,r.z);return t.attributesNormalized.set(e,n),n}applyTextureTransform(e,t){let n=!1;const r={};(0!==t.offset.x||0!==t.offset.y)&&(r.offset=t.offset.toArray(),n=!0),0!==t.rotation&&(r.rotation=t.rotation,n=!0),(1!==t.repeat.x||1!==t.repeat.y)&&(r.scale=t.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function n(e){return("colorSpace"in e?"srgb"===e.colorSpace:3001===e.encoding)?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof dt&&(e=lo(e)),t instanceof dt&&(t=lo(t));const r=e?e.image:null,s=t?t.image:null,o=Math.max(r?r.width:0,s?s.width:0),i=Math.max(r?r.height:0,s?s.height:0),a=Vo();a.width=o,a.height=i;const l=a.getContext("2d");l.fillStyle="#00ffff",l.fillRect(0,0,o,i);const c=l.getImageData(0,0,o,i);if(r){l.drawImage(r,0,0,o,i);const t=n(e),s=l.getImageData(0,0,o,i).data;for(let e=2;e<s.length;e+=4)c.data[e]=256*t(s[e]/256)}if(s){l.drawImage(s,0,0,o,i);const e=n(t),r=l.getImageData(0,0,o,i).data;for(let t=1;t<r.length;t+=4)c.data[t]=256*e(r[t]/256)}l.putImageData(c,0,0);const u=(e||t).clone();return u.source=new Ne(a).source,"colorSpace"in u?u.colorSpace="":u.encoding=3e3,u.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),u}processBuffer(e){const t=this.json,n=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),n.push(e),0}processBufferView(e,t,n,r,s){const o=this.json;let i;switch(o.bufferViews||(o.bufferViews=[]),t){case yo:case xo:i=1;break;case bo:case wo:i=2;break;default:i=4}const a=jo(r*e.itemSize*i),l=new DataView(new ArrayBuffer(a));let c=0;for(let h=n;h<n+r;h++)for(let n=0;n<e.itemSize;n++){let r;e.itemSize>4?r=e.array[h*e.itemSize+n]:(0===n?r=e.getX(h):1===n?r=e.getY(h):2===n?r=e.getZ(h):3===n&&(r=e.getW(h)),!0===e.normalized&&(r=T.normalize(r,e.array))),t===Eo?l.setFloat32(c,r,!0):t===To?l.setInt32(c,r,!0):t===_o?l.setUint32(c,r,!0):t===bo?l.setInt16(c,r,!0):t===wo?l.setUint16(c,r,!0):t===yo?l.setInt8(c,r):t===xo&&l.setUint8(c,r),c+=i}const u={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:a};return void 0!==s&&(u.target=s),s===Ao&&(u.byteStride=e.itemSize*i),this.byteOffset+=a,o.bufferViews.push(u),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,n=t.json;return n.bufferViews||(n.bufferViews=[]),e.arrayBuffer().then((e=>{const r=Ho(e),s={buffer:t.processBuffer(r),byteOffset:t.byteOffset,byteLength:r.byteLength};return t.byteOffset+=r.byteLength,n.bufferViews.push(s)-1}))}processAccessor(e,t,n,r){const s=this.json;let o;if(e.array.constructor===Float32Array)o=Eo;else if(e.array.constructor===Int32Array)o=To;else if(e.array.constructor===Uint32Array)o=_o;else if(e.array.constructor===Int16Array)o=bo;else if(e.array.constructor===Uint16Array)o=wo;else if(e.array.constructor===Int8Array)o=yo;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);o=xo}if(void 0===n&&(n=0),void 0===r&&(r=e.count),0===r)return null;const i=function(e,t,n){const r={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let s=t;s<t+n;s++)for(let t=0;t<e.itemSize;t++){let n;e.itemSize>4?n=e.array[s*e.itemSize+t]:(0===t?n=e.getX(s):1===t?n=e.getY(s):2===t?n=e.getZ(s):3===t&&(n=e.getW(s)),!0===e.normalized&&(n=T.normalize(n,e.array))),r.min[t]=Math.min(r.min[t],n),r.max[t]=Math.max(r.max[t],n)}return r}(e,n,r);let a;void 0!==t&&(a=e===t.index?Mo:Ao);const l=this.processBufferView(e,o,n,r,a),c={bufferView:l.id,byteOffset:l.byteOffset,componentType:o,count:r,max:i.max,min:i.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(c.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(c)-1}processImage(e,t,n,r="image/png"){if(null!==e){const s=this,o=s.cache,i=s.json,a=s.options,l=s.pending;o.images.has(e)||o.images.set(e,{});const c=o.images.get(e),u=r+":flipY/"+n.toString();if(void 0!==c[u])return c[u];i.images||(i.images=[]);const h={mimeType:r},d=Vo();d.width=Math.min(e.width,a.maxTextureSize),d.height=Math.min(e.height,a.maxTextureSize);const p=d.getContext("2d");if(!0===n&&(p.translate(0,d.height),p.scale(1,-1)),void 0!==e.data){t!==pt&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>a.maxTextureSize||e.height>a.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const n=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<n.length;t+=4)n[t+0]=e.data[t+0],n[t+1]=e.data[t+1],n[t+2]=e.data[t+2],n[t+3]=e.data[t+3];p.putImageData(new ImageData(n,e.width,e.height),0,0)}else p.drawImage(e,0,0,d.width,d.height);!0===a.binary?l.push(Xo(d,r).then((e=>s.processBufferViewImage(e))).then((e=>{h.bufferView=e}))):void 0!==d.toDataURL?h.uri=d.toDataURL(r):l.push(Xo(d,r).then(ro).then((e=>{h.uri=e})));const m=i.images.push(h)-1;return c[u]=m,m}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const n={magFilter:Uo[e.magFilter],minFilter:Uo[e.minFilter],wrapS:Uo[e.wrapS],wrapT:Uo[e.wrapT]};return t.samplers.push(n)-1}processTexture(e){const t=this.options,n=this.cache,r=this.json;if(n.textures.has(e))return n.textures.get(e);r.textures||(r.textures=[]),e instanceof dt&&(e=lo(e,t.maxTextureSize));let s=e.userData.mimeType;"image/webp"===s&&(s="image/png");const o={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,s)};e.name&&(o.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,o)}));const i=r.textures.push(o)-1;return n.textures.set(e,i),i}processMaterial(e){const t=this.cache,n=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);const r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(Bo(s,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const t=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),n={index:this.processTexture(t),channel:t.channel};this.applyTextureTransform(n,t),r.pbrMetallicRoughness.metallicRoughnessTexture=n}if(e.map){const t={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),r.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive;if(Math.max(t.r,t.g,t.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),r.emissiveTexture=t}}if(e.normalMap){const t={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),r.normalTexture=t}if(e.aoMap){const t={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),r.occlusionTexture=t}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===P&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,r)}));const o=n.materials.push(r)-1;return t.materials.set(e,o),o}processMesh(e){const t=this.cache,n=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let y=0,x=e.material.length;y<x;y++)r.push(e.material[y].uuid);else r.push(e.material.uuid);const s=r.join(":");if(t.meshes.has(s))return t.meshes.get(s);const o=e.geometry;let i;i=e.isLineSegments?mo:e.isLineLoop?fo:e.isLine?go:e.isPoints?po:e.material.wireframe?mo:vo;const a={},l={},c=[],u=[],h={...$s>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},d=o.getAttribute("normal");void 0!==d&&!this.isNormalizedNormalAttribute(d)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(d)));let p=null;for(let y in o.attributes){if("morph"===y.slice(0,5))continue;const e=o.attributes[y];if(y=h[y]||y.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(y)||(y="_"+y),t.attributes.has(this.getUID(e))){l[y]=t.attributes.get(this.getUID(e));continue}p=null;const n=e.array;"JOINTS_0"===y&&!(n instanceof Uint16Array)&&!(n instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),p=new E(new Uint16Array(n),e.itemSize,e.normalized));const r=this.processAccessor(p||e,o);null!==r&&(y.startsWith("_")||this.detectMeshQuantization(y,e),l[y]=r,t.attributes.set(this.getUID(e),r))}if(void 0!==d&&o.setAttribute("normal",d),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const n=[],r=[],s={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)s[e.morphTargetDictionary[t]]=t;for(let i=0;i<e.morphTargetInfluences.length;++i){const a={};let l=!1;for(const e in o.morphAttributes){if("position"!==e&&"normal"!==e){l||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),l=!0);continue}const n=o.morphAttributes[e][i],r=e.toUpperCase(),s=o.attributes[e];if(t.attributes.has(this.getUID(n,!0))){a[r]=t.attributes.get(this.getUID(n,!0));continue}const c=n.clone();if(!o.morphTargetsRelative)for(let e=0,t=n.count;e<t;e++)for(let r=0;r<n.itemSize;r++)0===r&&c.setX(e,n.getX(e)-s.getX(e)),1===r&&c.setY(e,n.getY(e)-s.getY(e)),2===r&&c.setZ(e,n.getZ(e)-s.getZ(e)),3===r&&c.setW(e,n.getW(e)-s.getW(e));a[r]=this.processAccessor(c,o),t.attributes.set(this.getUID(s,!0),a[r])}u.push(a),n.push(e.morphTargetInfluences[i]),void 0!==e.morphTargetDictionary&&r.push(s[i])}a.weights=n,r.length>0&&(a.extras={},a.extras.targetNames=r)}const m=Array.isArray(e.material);if(m&&0===o.groups.length)return null;const f=m?e.material:[e.material],g=m?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let y=0,x=g.length;y<x;y++){const e={mode:i,attributes:l};if(this.serializeUserData(o,e),u.length>0&&(e.targets=u),null!==o.index){let n=this.getUID(o.index);(void 0!==g[y].start||void 0!==g[y].count)&&(n+=":"+g[y].start+":"+g[y].count),t.attributes.has(n)?e.indices=t.attributes.get(n):(e.indices=this.processAccessor(o.index,o,g[y].start,g[y].count),t.attributes.set(n,e.indices)),null===e.indices&&delete e.indices}const n=this.processMaterial(f[g[y].materialIndex]);null!==n&&(e.material=n),c.push(e)}a.primitives=c,n.meshes||(n.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,a)}));const v=n.meshes.push(a)-1;return t.meshes.set(s,v),v}detectMeshQuantization(e,t){if(this.extensionsUsed[No])return;let n;switch(t.array.constructor){case Int8Array:n="byte";break;case Uint8Array:n="unsigned byte";break;case Int16Array:n="short";break;case Uint16Array:n="unsigned short";break;default:return}t.normalized&&(n+=" normalized");const r=e.split("_",1)[0];co[r]&&co[r].includes(n)&&(this.extensionsUsed[No]=!0,this.extensionsRequired[No]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const n=e.isOrthographicCamera,r={type:n?"orthographic":"perspective"};return n?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:T.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const n=this.json,r=this.nodeMap;n.animations||(n.animations=[]);const s=(e=uo.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,o=[],i=[];for(let a=0;a<s.length;++a){const e=s[a],n=ze.parseTrackName(e.name);let l=ze.findNode(t,n.nodeName);const c=Fo[n.propertyName];if("bones"===n.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(n.objectIndex):void 0),!l||!c)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',e.name),null;const u=1;let h,d=e.values.length/e.times.length;c===Fo.morphTargetInfluences&&(d/=l.morphTargetInfluences.length),!0===e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(h="CUBICSPLINE",d/=3):h=e.getInterpolation()===Ge?"STEP":"LINEAR",i.push({input:this.processAccessor(new E(e.times,u)),output:this.processAccessor(new E(e.values,d)),interpolation:h}),o.push({sampler:i.length-1,target:{node:r.get(l),path:c}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:i,channels:o}),n.animations.length-1}processSkin(e){const t=this.json,n=this.nodeMap,r=t.nodes[n.get(e)],s=e.skeleton;if(void 0===s)return null;const o=e.skeleton.bones[0];if(void 0===o)return null;const i=[],a=new Float32Array(16*s.bones.length),l=new Z;for(let c=0;c<s.bones.length;++c)i.push(n.get(s.bones[c])),l.copy(s.boneInverses[c]),l.multiply(e.bindMatrix).toArray(a,16*c);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new E(a,16)),joints:i,skeleton:n.get(o)}),r.skin=t.skins.length-1}processNode(e){const t=this.json,n=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const s={};if(n.trs){const t=e.quaternion.toArray(),n=e.position.toArray(),r=e.scale.toArray();Bo(t,[0,0,0,1])||(s.rotation=t),Bo(n,[0,0,0])||(s.translation=n),Bo(r,[1,1,1])||(s.scale=r)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function(e){return Bo(e.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(s.matrix=e.matrix.elements);if(""!==e.name&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const t=this.processMesh(e);null!==t&&(s.mesh=t)}else e.isCamera&&(s.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const t=[];for(let r=0,s=e.children.length;r<s;r++){const s=e.children[r];if(s.visible||!1===n.onlyVisible){const e=this.processNode(s);null!==e&&t.push(e)}}t.length>0&&(s.children=t)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,s)}));const o=t.nodes.push(s)-1;return r.set(e,o),o}processScene(e){const t=this.json,n=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);const s=[];for(let o=0,i=e.children.length;o<i;o++){const t=e.children[o];if(t.visible||!1===n.onlyVisible){const e=this.processNode(t);null!==e&&s.push(e)}}s.length>0&&(r.nodes=s),this.serializeUserData(e,r)}processObjects(e){const n=new t;n.name="AuxScene";for(let t=0;t<e.length;t++)n.children.push(e[t]);this.processScene(n)}processInput(e){const n=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));const r=[];for(let s=0;s<e.length;s++)e[s]instanceof t?this.processScene(e[s]):r.push(e[s]);r.length>0&&this.processObjects(r);for(let t=0;t<this.skins.length;++t)this.processSkin(this.skins[t]);for(let t=0;t<n.animations.length;++t)this.processAnimation(n.animations[t],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}_invokeAll(e){for(let t=0,n=this.plugins.length;t<n;t++)e(this.plugins[t])}}class Wo{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const n=this.writer,r=n.json,s=n.extensionsUsed,o={};e.name&&(o.name=e.name),o.color=e.color.toArray(),o.intensity=e.intensity,e.isDirectionalLight?o.type="directional":e.isPointLight?(o.type="point",e.distance>0&&(o.range=e.distance)):e.isSpotLight&&(o.type="spot",e.distance>0&&(o.range=e.distance),o.spot={},o.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,o.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||-1!==e.target.position.z)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},s[this.name]=!0);const i=r.extensions[this.name].lights;i.push(o),t.extensions=t.extensions||{},t.extensions[this.name]={light:i.length-1}}}let Go=class{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const n=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}},Zo=class{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const n=this.writer,r=n.extensionsUsed,s={};if(s.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:n.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};n.applyTextureTransform(t,e.clearcoatMap),s.clearcoatTexture=t}if(s.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:n.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};n.applyTextureTransform(t,e.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:n.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};n.applyTextureTransform(t,e.clearcoatNormalMap),s.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},Ko=class{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const n=this.writer,r=n.extensionsUsed,s={};if(s.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:n.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};n.applyTextureTransform(t,e.iridescenceMap),s.iridescenceTexture=t}if(s.iridescenceIor=e.iridescenceIOR,s.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:n.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};n.applyTextureTransform(t,e.iridescenceThicknessMap),s.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},Qo=class{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const n=this.writer,r=n.extensionsUsed,s={};if(s.transmissionFactor=e.transmission,e.transmissionMap){const t={index:n.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};n.applyTextureTransform(t,e.transmissionMap),s.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},qo=class{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const n=this.writer,r=n.extensionsUsed,s={};if(s.thicknessFactor=e.thickness,e.thicknessMap){const t={index:n.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};n.applyTextureTransform(t,e.thicknessMap),s.thicknessTexture=t}s.attenuationDistance=e.attenuationDistance,s.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},Jo=class{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const n=this.writer.extensionsUsed,r={};r.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}},$o=class{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(zo)&&!e.specularIntensityMap&&!e.specularColorTexture)return;const n=this.writer,r=n.extensionsUsed,s={};if(e.specularIntensityMap){const t={index:n.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};n.applyTextureTransform(t,e.specularIntensityMap),s.specularTexture=t}if(e.specularColorMap){const t={index:n.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};n.applyTextureTransform(t,e.specularColorMap),s.specularColorTexture=t}s.specularFactor=e.specularIntensity,s.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},ei=class{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const n=this.writer,r=n.extensionsUsed,s={};if(e.sheenRoughnessMap){const t={index:n.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};n.applyTextureTransform(t,e.sheenRoughnessMap),s.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:n.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};n.applyTextureTransform(t,e.sheenColorMap),s.sheenColorTexture=t}s.sheenRoughnessFactor=e.sheenRoughness,s.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},ti=class{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const n=this.writer,r=n.extensionsUsed,s={};if(e.anisotropyMap){const t={index:n.processTexture(e.anisotropyMap)};n.applyTextureTransform(t,e.anisotropyMap),s.anisotropyTexture=t}s.anisotropyStrength=e.anisotropy,s.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}},ni=class{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const n=this.writer.extensionsUsed,r={};r.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}};var ri=Uint8Array,si=Uint16Array,oi=Uint32Array,ii=new ri([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ai=new ri([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),li=new ri([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ci=function(e,t){for(var n=new si(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var s=new oi(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)s[o]=o-n[r]<<5|r;return[n,s]},ui=ci(ii,2),hi=ui[0],di=ui[1];hi[28]=258,di[258]=28;for(var pi=ci(ai,0)[0],mi=new si(32768),fi=0;fi<32768;++fi){var gi=(43690&fi)>>>1|(21845&fi)<<1;gi=(61680&(gi=(52428&gi)>>>2|(13107&gi)<<2))>>>4|(3855&gi)<<4,mi[fi]=((65280&gi)>>>8|(255&gi)<<8)>>>1}var vi=function(e,t,n){for(var r=e.length,s=0,o=new si(t);s<r;++s)++o[e[s]-1];var i,a=new si(t);for(s=0;s<t;++s)a[s]=a[s-1]+o[s-1]<<1;i=new si(1<<t);var l=15-t;for(s=0;s<r;++s)if(e[s])for(var c=s<<4|e[s],u=t-e[s],h=a[e[s]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)i[mi[h]>>>l]=c;return i},yi=new ri(288);for(fi=0;fi<144;++fi)yi[fi]=8;for(fi=144;fi<256;++fi)yi[fi]=9;for(fi=256;fi<280;++fi)yi[fi]=7;for(fi=280;fi<288;++fi)yi[fi]=8;var xi=new ri(32);for(fi=0;fi<32;++fi)xi[fi]=5;var bi=vi(yi,9),wi=vi(xi,5),Ti=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},_i=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},Ei=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Ai=function(e){return(e/8|0)+(7&e&&1)},Mi=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new ri(0);var s=!t||n,o=!n||n.i;n||(n={}),t||(t=new ri(3*r));var i=function(e){var n=t.length;if(e>n){var r=new ri(Math.max(2*n,e));r.set(t),t=r}},a=n.f||0,l=n.p||0,c=n.b||0,u=n.l,h=n.d,d=n.m,p=n.n,m=8*r;do{if(!u){n.f=a=_i(e,l,1);var f=_i(e,l+1,3);if(l+=3,!f){var g=e[(S=Ai(l)+4)-4]|e[S-3]<<8,v=S+g;if(v>r){if(o)throw"unexpected EOF";break}s&&i(c+g),t.set(e.subarray(S,v),c),n.b=c+=g,n.p=l=8*v;continue}if(1==f)u=bi,h=wi,d=9,p=5;else{if(2!=f)throw"invalid block type";var y=_i(e,l,31)+257,x=_i(e,l+10,15)+4,b=y+_i(e,l+5,31)+1;l+=14;for(var w=new ri(b),T=new ri(19),_=0;_<x;++_)T[li[_]]=_i(e,l+3*_,7);l+=3*x;var E=Ti(T),A=(1<<E)-1,M=vi(T,E);for(_=0;_<b;){var S,C=M[_i(e,l,A)];if(l+=15&C,(S=C>>>4)<16)w[_++]=S;else{var O=0,P=0;for(16==S?(P=3+_i(e,l,3),l+=2,O=w[_-1]):17==S?(P=3+_i(e,l,7),l+=3):18==S&&(P=11+_i(e,l,127),l+=7);P--;)w[_++]=O}}var I=w.subarray(0,y),L=w.subarray(y);d=Ti(I),p=Ti(L),u=vi(I,d),h=vi(L,p)}if(l>m){if(o)throw"unexpected EOF";break}}s&&i(c+131072);for(var D=(1<<d)-1,R=(1<<p)-1,k=l;;k=l){var N=(O=u[Ei(e,l)&D])>>>4;if((l+=15&O)>m){if(o)throw"unexpected EOF";break}if(!O)throw"invalid length/literal";if(N<256)t[c++]=N;else{if(256==N){k=l,u=null;break}var U=N-254;if(N>264){var F=ii[_=N-257];U=_i(e,l,(1<<F)-1)+hi[_],l+=F}var z=h[Ei(e,l)&R],B=z>>>4;if(!z)throw"invalid distance";l+=15&z;L=pi[B];if(B>3){F=ai[B];L+=Ei(e,l)&(1<<F)-1,l+=F}if(l>m){if(o)throw"unexpected EOF";break}s&&i(c+131072);for(var j=c+U;c<j;c+=4)t[c]=t[c-L],t[c+1]=t[c+1-L],t[c+2]=t[c+2-L],t[c+3]=t[c+3-L];c=j}}n.l=u,n.p=k,n.b=c,u&&(a=1,n.m=d,n.d=h,n.n=p)}while(!a);return c==t.length?t:function(e,t,n){(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof si?si:e instanceof oi?oi:ri)(n-t);return r.set(e.subarray(t,n)),r}(t,0,c)},Si=new ri(0);var Ci=typeof TextDecoder<"u"&&new TextDecoder;try{Ci.decode(Si,{stream:!0})}catch{}var Oi=Object.defineProperty;const Pi=class extends p{constructor(e,t={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new n;const r=this,s=void 0!==t.color?new g(t.color):new g(8355711),o=t.textureWidth||512,i=t.textureHeight||512,a=t.clipBias||0,l=t.shader||Pi.ReflectorShader,c=void 0!==t.multisample?t.multisample:4,u=new le,h=new C,d=new C,p=new C,m=new Z,f=new C(0,0,-1),v=new Y,x=new C,b=new C,w=new Y,T=new Z,_=this.camera,E=new j(o,i,{samples:c,type:U}),A=new R({uniforms:ce.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});A.uniforms.tDiffuse.value=E.texture,A.uniforms.color.value=s,A.uniforms.textureMatrix.value=T,this.material=A,this.onBeforeRender=function(e,t,n){if(d.setFromMatrixPosition(r.matrixWorld),p.setFromMatrixPosition(n.matrixWorld),m.extractRotation(r.matrixWorld),h.set(0,0,1),h.applyMatrix4(m),x.subVectors(d,p),x.dot(h)>0)return;x.reflect(h).negate(),x.add(d),m.extractRotation(n.matrixWorld),f.set(0,0,-1),f.applyMatrix4(m),f.add(p),b.subVectors(d,f),b.reflect(h).negate(),b.add(d),_.position.copy(x),_.up.set(0,1,0),_.up.applyMatrix4(m),_.up.reflect(h),_.lookAt(b),_.far=n.far,_.updateMatrixWorld(),_.projectionMatrix.copy(n.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(_.projectionMatrix),T.multiply(_.matrixWorldInverse),T.multiply(r.matrixWorld),u.setFromNormalAndCoplanarPoint(h,d),u.applyMatrix4(_.matrixWorldInverse),v.set(u.normal.x,u.normal.y,u.normal.z,u.constant);const s=_.projectionMatrix;w.x=(Math.sign(v.x)+s.elements[8])/s.elements[0],w.y=(Math.sign(v.y)+s.elements[9])/s.elements[5],w.z=-1,w.w=(1+s.elements[10])/s.elements[14],v.multiplyScalar(2/v.dot(w)),s.elements[2]=v.x,s.elements[6]=v.y,s.elements[10]=v.z+1-a,s.elements[14]=v.w,r.visible=!1;const o=e.getRenderTarget(),i=e.xr.enabled,l=e.shadowMap.autoUpdate,c=e.toneMapping;let g=!1;g="outputColorSpace"in e?"srgb"===e.outputColorSpace:3001===e.outputEncoding,e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,"outputColorSpace"in e?e.outputColorSpace="srgb-linear":e.outputEncoding=3e3,e.toneMapping=y,e.setRenderTarget(E),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,_),e.xr.enabled=i,e.shadowMap.autoUpdate=l,e.toneMapping=c,"outputColorSpace"in e?e.outputColorSpace=g?"srgb":"srgb-linear":e.outputEncoding=g?3001:3e3,e.setRenderTarget(o);const A=n.viewport;void 0!==A&&e.state.viewport(A),r.visible=!0},this.getRenderTarget=function(){return E},this.dispose=function(){E.dispose(),r.material.dispose()}}};let Ii=Pi;((e,t,n)=>{((e,t,n)=>{t in e?Oi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n)})(Ii,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}",fragmentShader:`\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <${$s>=154?"colorspace_fragment":"encodings_fragment"}>\n\n\t\t}`});var Li=Object.defineProperty,Di=(e,t,n)=>(((e,t,n)=>{t in e?Li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Ri=new u,ki=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),Ni=new Se(ki,5);Ri.setIndex([0,1,2,0,2,3]),Ri.setAttribute("position",new Je(Ni,3,0,!1)),Ri.setAttribute("uv",new Je(Ni,2,3,!1));const Ui=class extends p{constructor(){super(Ui.Geometry,new m({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new C,t=new C,n=new mt(new Uint8Array(768),16,16,pt);n.minFilter=Le,n.magFilter=Le,n.wrapS=ke,n.wrapT=ke;const r=new mt(new Uint8Array(768),16,16,pt);r.minFilter=Le,r.magFilter=Le,r.wrapS=ke,r.wrapT=ke;const s=Ui.Geometry,o=new ft({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}",fragmentShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );\n\n\t\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),i=new ft({uniforms:{map:{value:n},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\t\t\t\tattribute vec2 uv;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUV = uv;\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}",fragmentShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform sampler2D map;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = texture2D( map, vUV );\n\n\t\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),a=new p(s,o),l=[],c=Fi.Shader,u=new ft({uniforms:{map:{value:null},occlusionMap:{value:r},color:{value:new g(16777215)},scale:{value:new S},screenPosition:{value:new C}},vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:gt,transparent:!0,depthWrite:!1}),h=new p(s,u);this.addElement=function(e){l.push(e)};const d=new S,f=new S,v=new vt,y=new Y;this.onBeforeRender=function(c,p,m){c.getCurrentViewport(y);const g=y.w/y.z,x=y.z/2,b=y.w/2;let w=16/y.w;if(d.set(w*g,w),v.min.set(y.x,y.y),v.max.set(y.x+(y.z-16),y.y+(y.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(m.matrixWorldInverse),!(t.z>0)&&(e.copy(t).applyMatrix4(m.projectionMatrix),f.x=y.x+e.x*x+x-8,f.y=y.y+e.y*b+b-8,v.containsPoint(f))){c.copyFramebufferToTexture(f,n);let t=o.uniforms;t.scale.value=d,t.screenPosition.value=e,c.renderBufferDirect(m,null,s,o,a,null),c.copyFramebufferToTexture(f,r),t=i.uniforms,t.scale.value=d,t.screenPosition.value=e,c.renderBufferDirect(m,null,s,i,a,null);const p=2*-e.x,g=2*-e.y;for(let n=0,r=l.length;n<r;n++){const t=l[n],r=u.uniforms;r.color.value.copy(t.color),r.map.value=t.texture,r.screenPosition.value.x=e.x+p*t.distance,r.screenPosition.value.y=e.y+g*t.distance,w=t.size/y.w;const o=y.w/y.z;r.scale.value.set(w*o,w),u.uniformsNeedUpdate=!0,c.renderBufferDirect(m,null,s,u,h,null)}}},this.dispose=function(){o.dispose(),i.dispose(),u.dispose(),n.dispose(),r.dispose();for(let e=0,t=l.length;e<t;e++)l[e].texture.dispose()}}};Di(Ui,"Geometry",Ri);class Fi{constructor(e,t=1,n=0,r=new g(16777215)){this.texture=e,this.size=t,this.distance=n,this.color=r}}Di(Fi,"Shader",{uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform vec3 screenPosition;\n\t\tuniform vec2 scale;\n\n\t\tuniform sampler2D occlusionMap;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvUV = uv;\n\n\t\t\tvec2 pos = position.xy;\n\n\t\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\n\t\t\tvVisibility =        visibility.r / 9.0;\n\t\t\tvVisibility *= 1.0 - visibility.g / 9.0;\n\t\t\tvVisibility *=       visibility.b / 9.0;\n\n\t\t\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D map;\n\t\tuniform vec3 color;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texture = texture2D( map, vUV );\n\t\t\ttexture.a *= vVisibility;\n\t\t\tgl_FragColor = texture;\n\t\t\tgl_FragColor.rgb *= color;\n\n\t\t}"});var zi=Object.defineProperty,Bi=(e,t,n)=>(((e,t,n)=>{t in e?zi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const ji={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new C},up:{value:new C(0,1,0)}},vertexShader:"\n      uniform vec3 sunPosition;\n      uniform float rayleigh;\n      uniform float turbidity;\n      uniform float mieCoefficient;\n      uniform vec3 up;\n\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      // constants for atmospheric scattering\n      const float e = 2.71828182845904523536028747135266249775724709369995957;\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      // wavelength of used primaries, according to preetham\n      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n      // mie stuff\n      // K coefficient for the primaries\n      const float v = 4.0;\n      const vec3 K = vec3( 0.686, 0.678, 0.666 );\n      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n      // earth shadow hack\n      // cutoffAngle = pi / 1.95;\n      const float cutoffAngle = 1.6110731556870734;\n      const float steepness = 1.5;\n      const float EE = 1000.0;\n\n      float sunIntensity( float zenithAngleCos ) {\n        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n      }\n\n      vec3 totalMie( float T ) {\n        float c = ( 0.2 * T ) * 10E-18;\n        return 0.434 * c * MieConst;\n      }\n\n      void main() {\n\n        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        gl_Position.z = gl_Position.w; // set z to camera.far\n\n        vSunDirection = normalize( sunPosition );\n\n        vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n      // extinction (absorbtion + out scattering)\n      // rayleigh coefficients\n        vBetaR = totalRayleigh * rayleighCoefficient;\n\n      // mie coefficients\n        vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n      }\n    ",fragmentShader:`\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      uniform float mieDirectionalG;\n      uniform vec3 up;\n\n      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n      // constants for atmospheric scattering\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      const float n = 1.0003; // refractive index of air\n      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n      // optical length at zenith for molecules\n      const float rayleighZenithLength = 8.4E3;\n      const float mieZenithLength = 1.25E3;\n      // 66 arc seconds -> degrees, and the cosine of that\n      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n      // 3.0 / ( 16.0 * pi )\n      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n      // 1.0 / ( 4.0 * pi )\n      const float ONE_OVER_FOURPI = 0.07957747154594767;\n\n      float rayleighPhase( float cosTheta ) {\n        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n      }\n\n      float hgPhase( float cosTheta, float g ) {\n        float g2 = pow( g, 2.0 );\n        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n      }\n\n      void main() {\n\n        vec3 direction = normalize( vWorldPosition - cameraPos );\n\n      // optical length\n      // cutoff angle at 90 to avoid singularity in next formula.\n        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n        float sR = rayleighZenithLength * inverse;\n        float sM = mieZenithLength * inverse;\n\n      // combined extinction factor\n        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n      // in scattering\n        float cosTheta = dot( direction, vSunDirection );\n\n        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n        vec3 betaRTheta = vBetaR * rPhase;\n\n        float mPhase = hgPhase( cosTheta, mieDirectionalG );\n        vec3 betaMTheta = vBetaM * mPhase;\n\n        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n      // nightsky\n        float theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]\n        float phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]\n        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n        vec3 L0 = vec3( 0.1 ) * Fex;\n\n      // composition + solar disc\n        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n        gl_FragColor = vec4( retColor, 1.0 );\n\n      #include <tonemapping_fragment>\n      #include <${$s>=154?"colorspace_fragment":"encodings_fragment"}>\n\n      }\n    `},Hi=new R({name:"SkyShader",fragmentShader:ji.fragmentShader,vertexShader:ji.vertexShader,uniforms:ce.clone(ji.uniforms),side:f,depthWrite:!1});class Vi extends p{constructor(){super(new k(1,1,1),Hi)}}Bi(Vi,"SkyShader",ji),Bi(Vi,"material",Hi),new ut,new C;var Xi=Object.defineProperty,Yi=(e,t,n)=>(((e,t,n)=>{t in e?Xi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Wi extends _{constructor(e,t){super(),Yi(this,"isTransformControls",!0),Yi(this,"visible",!1),Yi(this,"domElement"),Yi(this,"raycaster",new l),Yi(this,"gizmo"),Yi(this,"plane"),Yi(this,"tempVector",new C),Yi(this,"tempVector2",new C),Yi(this,"tempQuaternion",new X),Yi(this,"unit",{X:new C(1,0,0),Y:new C(0,1,0),Z:new C(0,0,1)}),Yi(this,"pointStart",new C),Yi(this,"pointEnd",new C),Yi(this,"offset",new C),Yi(this,"rotationAxis",new C),Yi(this,"startNorm",new C),Yi(this,"endNorm",new C),Yi(this,"rotationAngle",0),Yi(this,"cameraPosition",new C),Yi(this,"cameraQuaternion",new X),Yi(this,"cameraScale",new C),Yi(this,"parentPosition",new C),Yi(this,"parentQuaternion",new X),Yi(this,"parentQuaternionInv",new X),Yi(this,"parentScale",new C),Yi(this,"worldPositionStart",new C),Yi(this,"worldQuaternionStart",new X),Yi(this,"worldScaleStart",new C),Yi(this,"worldPosition",new C),Yi(this,"worldQuaternion",new X),Yi(this,"worldQuaternionInv",new X),Yi(this,"worldScale",new C),Yi(this,"eye",new C),Yi(this,"positionStart",new C),Yi(this,"quaternionStart",new X),Yi(this,"scaleStart",new C),Yi(this,"camera"),Yi(this,"object"),Yi(this,"enabled",!0),Yi(this,"axis",null),Yi(this,"mode","translate"),Yi(this,"translationSnap",null),Yi(this,"rotationSnap",null),Yi(this,"scaleSnap",null),Yi(this,"space","world"),Yi(this,"size",1),Yi(this,"dragging",!1),Yi(this,"showX",!0),Yi(this,"showY",!0),Yi(this,"showZ",!0),Yi(this,"changeEvent",{type:"change"}),Yi(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),Yi(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),Yi(this,"objectChangeEvent",{type:"objectChange"}),Yi(this,"intersectObjectWithRay",((e,t,n)=>{const r=t.intersectObject(e,!0);for(let s=0;s<r.length;s++)if(r[s].object.visible||n)return r[s];return!1})),Yi(this,"attach",(e=>(this.object=e,this.visible=!0,this))),Yi(this,"detach",(()=>(this.object=void 0,this.visible=!1,this.axis=null,this))),Yi(this,"reset",(()=>this.enabled?(this.dragging&&void 0!==this.object&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this)),Yi(this,"updateMatrixWorld",(()=>{void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()})),Yi(this,"pointerHover",(e=>{if(void 0===this.object||!0===this.dragging)return;this.raycaster.setFromCamera(e,this.camera);const t=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);this.axis=t?t.object.name:null})),Yi(this,"pointerDown",(e=>{if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){this.raycaster.setFromCamera(e,this.camera);const t=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(t){let e=this.space;if("scale"===this.mode?e="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(e="world"),"local"===e&&"rotate"===this.mode){const e=this.rotationSnap;"X"===this.axis&&e&&(this.object.rotation.x=Math.round(this.object.rotation.x/e)*e),"Y"===this.axis&&e&&(this.object.rotation.y=Math.round(this.object.rotation.y/e)*e),"Z"===this.axis&&e&&(this.object.rotation.z=Math.round(this.object.rotation.z/e)*e)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}})),Yi(this,"pointerMove",(e=>{const t=this.axis,n=this.mode,r=this.object;let s=this.space;if("scale"===n?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;this.raycaster.setFromCamera(e,this.camera);const o=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===n)this.offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this.offset.applyQuaternion(this.worldQuaternionInv),-1===t.indexOf("X")&&(this.offset.x=0),-1===t.indexOf("Y")&&(this.offset.y=0),-1===t.indexOf("Z")&&(this.offset.z=0),"local"===s&&"XYZ"!==t?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),r.position.copy(this.offset).add(this.positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this.quaternionStart)),"world"===s&&(r.parent&&r.position.add(this.tempVector.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(this.tempVector.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),this.tempVector2.set(e,e,e)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),-1===t.search("X")&&(this.tempVector2.x=1),-1===t.search("Y")&&(this.tempVector2.y=1),-1===t.search("Z")&&(this.tempVector2.z=1);r.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(-1!==t.search("X")&&(this.object.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this.offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(this.unit[t]),this.tempVector.copy(this.unit[t]),"local"===s&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this.quaternionStart),r.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),r.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}})),Yi(this,"pointerUp",(e=>{0===e.button&&(this.dragging&&null!==this.axis&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)})),Yi(this,"getPointer",(e=>{var t;if(this.domElement&&null!=(t=this.domElement.ownerDocument)&&t.pointerLockElement)return{x:0,y:0,button:e.button};{const t=e.changedTouches?e.changedTouches[0]:e,n=this.domElement.getBoundingClientRect();return{x:(t.clientX-n.left)/n.width*2-1,y:-(t.clientY-n.top)/n.height*2+1,button:e.button}}})),Yi(this,"onPointerHover",(e=>{if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(e))}})),Yi(this,"onPointerDown",(e=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(e)),this.pointerDown(this.getPointer(e)))})),Yi(this,"onPointerMove",(e=>{this.enabled&&this.pointerMove(this.getPointer(e))})),Yi(this,"onPointerUp",(e=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(e)))})),Yi(this,"getMode",(()=>this.mode)),Yi(this,"setMode",(e=>{this.mode=e})),Yi(this,"setTranslationSnap",(e=>{this.translationSnap=e})),Yi(this,"setRotationSnap",(e=>{this.rotationSnap=e})),Yi(this,"setScaleSnap",(e=>{this.scaleSnap=e})),Yi(this,"setSize",(e=>{this.size=e})),Yi(this,"setSpace",(e=>{this.space=e})),Yi(this,"update",(()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")})),Yi(this,"connect",(e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)})),Yi(this,"dispose",(()=>{var e,t,n,r,s,o;null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointermove",this.onPointerHover),null==(r=null==(n=this.domElement)?void 0:n.ownerDocument)||r.removeEventListener("pointermove",this.onPointerMove),null==(o=null==(s=this.domElement)?void 0:s.ownerDocument)||o.removeEventListener("pointerup",this.onPointerUp),this.traverse((e=>{const t=e;t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}))})),this.domElement=t,this.camera=e,this.gizmo=new Gi,this.add(this.gizmo),this.plane=new Zi,this.add(this.plane);const n=(e,t)=>{let n=t;Object.defineProperty(this,e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),this[e]=t,this.plane[e]=t,this.gizmo[e]=t};n("camera",this.camera),n("object",this.object),n("enabled",this.enabled),n("axis",this.axis),n("mode",this.mode),n("translationSnap",this.translationSnap),n("rotationSnap",this.rotationSnap),n("scaleSnap",this.scaleSnap),n("space",this.space),n("size",this.size),n("dragging",this.dragging),n("showX",this.showX),n("showY",this.showY),n("showZ",this.showZ),n("worldPosition",this.worldPosition),n("worldPositionStart",this.worldPositionStart),n("worldQuaternion",this.worldQuaternion),n("worldQuaternionStart",this.worldQuaternionStart),n("cameraPosition",this.cameraPosition),n("cameraQuaternion",this.cameraQuaternion),n("pointStart",this.pointStart),n("pointEnd",this.pointEnd),n("rotationAxis",this.rotationAxis),n("rotationAngle",this.rotationAngle),n("eye",this.eye),void 0!==t&&this.connect(t)}}class Gi extends _{constructor(){super(),Yi(this,"isTransformControlsGizmo",!0),Yi(this,"type","TransformControlsGizmo"),Yi(this,"tempVector",new C(0,0,0)),Yi(this,"tempEuler",new ie),Yi(this,"alignVector",new C(0,1,0)),Yi(this,"zeroVector",new C(0,0,0)),Yi(this,"lookAtMatrix",new Z),Yi(this,"tempQuaternion",new X),Yi(this,"tempQuaternion2",new X),Yi(this,"identityQuaternion",new X),Yi(this,"unitX",new C(1,0,0)),Yi(this,"unitY",new C(0,1,0)),Yi(this,"unitZ",new C(0,0,1)),Yi(this,"gizmo"),Yi(this,"picker"),Yi(this,"helper"),Yi(this,"rotationAxis",new C),Yi(this,"cameraPosition",new C),Yi(this,"worldPositionStart",new C),Yi(this,"worldQuaternionStart",new X),Yi(this,"worldPosition",new C),Yi(this,"worldQuaternion",new X),Yi(this,"eye",new C),Yi(this,"camera",null),Yi(this,"enabled",!0),Yi(this,"axis",null),Yi(this,"mode","translate"),Yi(this,"space","world"),Yi(this,"size",1),Yi(this,"dragging",!1),Yi(this,"showX",!0),Yi(this,"showY",!0),Yi(this,"showZ",!0),Yi(this,"updateMatrixWorld",(()=>{let e=this.space;"scale"===this.mode&&(e="local");const t="local"===e?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let n=[];n=n.concat(this.picker[this.mode].children),n=n.concat(this.gizmo[this.mode].children),n=n.concat(this.helper[this.mode].children);for(let r=0;r<n.length;r++){const e=n[r];let s;e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),(s=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(s*this.size/7),"helper"!==e.tag)?(e.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?(("X"===e.name||"XYZX"===e.name)&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),("Y"===e.name||"XYZY"===e.name)&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),("Z"===e.name||"XYZZ"===e.name)&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),-1!==e.name.search("X")&&(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.x*=-1:"bwd"===e.tag&&(e.visible=!1)),-1!==e.name.search("Y")&&(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.y*=-1:"bwd"===e.tag&&(e.visible=!1)),-1!==e.name.search("Z")&&(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.z*=-1:"bwd"===e.tag&&(e.visible=!1))):"rotate"===this.mode&&(this.tempQuaternion2.copy(t),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(t).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),"X"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion)),"Y"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion)),"Z"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion))),e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material.tempOpacity=e.material.tempOpacity||e.material.opacity,e.material.tempColor=e.material.tempColor||e.material.color.clone(),e.material.color.copy(e.material.tempColor),e.material.opacity=e.material.tempOpacity,this.enabled?this.axis&&(e.name===this.axis||this.axis.split("").some((function(t){return e.name===t}))?(e.material.opacity=1,e.material.color.lerp(new g(1,1,1),.5)):(e.material.opacity*=.25,e.material.color.lerp(new g(1,1,1),.5))):(e.material.opacity*=.5,e.material.color.lerp(new g(1,1,1),.5))):(e.visible=!1,"AXIS"===e.name?(e.position.copy(this.worldPositionStart),e.visible=!!this.axis,"X"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),e.quaternion.multiply(this.tempQuaternion),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(this.tempVector),e.visible=this.dragging):(e.quaternion.copy(t),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name))))}super.updateMatrixWorld()}));const e=new m({depthTest:!1,depthWrite:!1,transparent:!0,side:P,fog:!1,toneMapped:!1}),t=new d({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;const r=e.clone();r.opacity=.33;const s=e.clone();s.color.set(16711680);const o=e.clone();o.color.set(65280);const i=e.clone();i.color.set(255);const a=e.clone();a.opacity=.25;const l=a.clone();l.color.set(16776960);const f=a.clone();f.color.set(65535);const v=a.clone();v.color.set(16711935),e.clone().color.set(16776960);const y=t.clone();y.color.set(16711680);const x=t.clone();x.color.set(65280);const b=t.clone();b.color.set(255);const w=t.clone();w.color.set(65535);const T=t.clone();T.color.set(16711935);const E=t.clone();E.color.set(16776960);const A=t.clone();A.color.set(7895160);const M=E.clone();M.opacity=.25;const S=new de(0,.05,.2,12,1,!1),O=new k(.125,.125,.125),I=new u;I.setAttribute("position",new h([0,0,0,1,0,0],3));const L=(e,t)=>{const n=new u,r=[];for(let s=0;s<=64*t;++s)r.push(0,Math.cos(s/32*Math.PI)*e,Math.sin(s/32*Math.PI)*e);return n.setAttribute("position",new h(r,3)),n},R={X:[[new p(S,s),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new p(S,s),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new c(I,y)]],Y:[[new p(S,o),[0,1,0],null,null,"fwd"],[new p(S,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new c(I,x),null,[0,0,Math.PI/2]]],Z:[[new p(S,i),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new p(S,i),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new c(I,b),null,[0,-Math.PI/2,0]]],XYZ:[[new p(new pe(.1,0),a.clone()),[0,0,0],[0,0,0]]],XY:[[new p(new D(.295,.295),l.clone()),[.15,.15,0]],[new c(I,E),[.18,.3,0],null,[.125,1,1]],[new c(I,E),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new p(new D(.295,.295),f.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new c(I,w),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new c(I,w),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new p(new D(.295,.295),v.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new c(I,T),[.18,0,.3],null,[.125,1,1]],[new c(I,T),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},N={X:[[new p(new de(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new p(new de(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new p(new de(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new p(new pe(.2,0),n)]],XY:[[new p(new D(.4,.4),n),[.2,.2,0]]],YZ:[[new p(new D(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new p(new D(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},U={START:[[new p(new pe(.01,2),r),null,null,null,"helper"]],END:[[new p(new pe(.01,2),r),null,null,null,"helper"]],DELTA:[[new c((()=>{const e=new u;return e.setAttribute("position",new h([0,0,0,1,1,1],3)),e})(),r),null,null,null,"helper"]],X:[[new c(I,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new c(I,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new c(I,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},F={X:[[new c(L(1,.5),y)],[new p(new pe(.04,0),s),[0,0,.99],null,[1,3,1]]],Y:[[new c(L(1,.5),x),null,[0,0,-Math.PI/2]],[new p(new pe(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new c(L(1,.5),b),null,[0,Math.PI/2,0]],[new p(new pe(.04,0),i),[.99,0,0],null,[1,3,1]]],E:[[new c(L(1.25,1),M),null,[0,Math.PI/2,0]],[new p(new de(.03,0,.15,4,1,!1),M),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new p(new de(.03,0,.15,4,1,!1),M),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new p(new de(.03,0,.15,4,1,!1),M),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new p(new de(.03,0,.15,4,1,!1),M),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new c(L(1,1),A),null,[0,Math.PI/2,0]]]},z={AXIS:[[new c(I,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},B={X:[[new p(new fe(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new p(new fe(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new p(new fe(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new p(new fe(1.25,.1,2,24),n)]],XYZE:[[new p(new me(.7,10,8),n)]]},j={X:[[new p(O,s),[.8,0,0],[0,0,-Math.PI/2]],[new c(I,y),null,null,[.8,1,1]]],Y:[[new p(O,o),[0,.8,0]],[new c(I,x),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new p(O,i),[0,0,.8],[Math.PI/2,0,0]],[new c(I,b),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new p(O,l),[.85,.85,0],null,[2,2,.2]],[new c(I,E),[.855,.98,0],null,[.125,1,1]],[new c(I,E),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new p(O,f),[0,.85,.85],null,[.2,2,2]],[new c(I,w),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new c(I,w),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new p(O,v),[.85,0,.85],null,[2,.2,2]],[new c(I,T),[.855,0,.98],null,[.125,1,1]],[new c(I,T),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new p(new k(.125,.125,.125),a.clone()),[1.1,0,0]]],XYZY:[[new p(new k(.125,.125,.125),a.clone()),[0,1.1,0]]],XYZZ:[[new p(new k(.125,.125,.125),a.clone()),[0,0,1.1]]]},H={X:[[new p(new de(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new p(new de(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new p(new de(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new p(O,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new p(O,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new p(O,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new p(new k(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new p(new k(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new p(new k(.2,.2,.2),n),[0,0,1.1]]]},V={X:[[new c(I,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new c(I,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new c(I,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Y=e=>{const t=new _;for(let n in e)for(let r=e[n].length;r--;){const s=e[n][r][0].clone(),o=e[n][r][1],i=e[n][r][2],a=e[n][r][3],l=e[n][r][4];s.name=n,s.tag=l,o&&s.position.set(o[0],o[1],o[2]),i&&s.rotation.set(i[0],i[1],i[2]),a&&s.scale.set(a[0],a[1],a[2]),s.updateMatrix();const c=s.geometry.clone();c.applyMatrix4(s.matrix),s.geometry=c,s.renderOrder=1/0,s.position.set(0,0,0),s.rotation.set(0,0,0),s.scale.set(1,1,1),t.add(s)}return t};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Y(R)),this.add(this.gizmo.rotate=Y(F)),this.add(this.gizmo.scale=Y(j)),this.add(this.picker.translate=Y(N)),this.add(this.picker.rotate=Y(B)),this.add(this.picker.scale=Y(H)),this.add(this.helper.translate=Y(U)),this.add(this.helper.rotate=Y(z)),this.add(this.helper.scale=Y(V)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class Zi extends p{constructor(){super(new D(1e5,1e5,2,2),new m({visible:!1,wireframe:!0,side:P,transparent:!0,opacity:.1,toneMapped:!1})),Yi(this,"isTransformControlsPlane",!0),Yi(this,"type","TransformControlsPlane"),Yi(this,"unitX",new C(1,0,0)),Yi(this,"unitY",new C(0,1,0)),Yi(this,"unitZ",new C(0,0,1)),Yi(this,"tempVector",new C),Yi(this,"dirVector",new C),Yi(this,"alignVector",new C),Yi(this,"tempMatrix",new Z),Yi(this,"identityQuaternion",new X),Yi(this,"cameraQuaternion",new X),Yi(this,"worldPosition",new C),Yi(this,"worldQuaternion",new X),Yi(this,"eye",new C),Yi(this,"axis",null),Yi(this,"mode","translate"),Yi(this,"space","world"),Yi(this,"updateMatrixWorld",(()=>{let e=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(e="local"),this.unitX.set(1,0,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0)}break;default:this.dirVector.set(0,0,0)}0===this.dirVector.length()?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()}))}}var Ki=Object.defineProperty,Qi=(e,t,n)=>(((e,t,n)=>{t in e?Ki(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const qi=new ie(0,0,0,"YXZ"),Ji=new C,$i={type:"change"},ea={type:"lock"},ta={type:"unlock"},na=Math.PI/2;class ra extends Q{constructor(e,t){super(),Qi(this,"camera"),Qi(this,"domElement"),Qi(this,"isLocked"),Qi(this,"minPolarAngle"),Qi(this,"maxPolarAngle"),Qi(this,"pointerSpeed"),Qi(this,"onMouseMove",(e=>{if(!this.domElement||!1===this.isLocked)return;const t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;qi.setFromQuaternion(this.camera.quaternion),qi.y-=.002*t*this.pointerSpeed,qi.x-=.002*n*this.pointerSpeed,qi.x=Math.max(na-this.maxPolarAngle,Math.min(na-this.minPolarAngle,qi.x)),this.camera.quaternion.setFromEuler(qi),this.dispatchEvent($i)})),Qi(this,"onPointerlockChange",(()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(ea),this.isLocked=!0):(this.dispatchEvent(ta),this.isLocked=!1))})),Qi(this,"onPointerlockError",(()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")})),Qi(this,"connect",(e=>{this.domElement=e||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))})),Qi(this,"disconnect",(()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))})),Qi(this,"dispose",(()=>{this.disconnect()})),Qi(this,"getObject",(()=>this.camera)),Qi(this,"direction",new C(0,0,-1)),Qi(this,"getDirection",(e=>e.copy(this.direction).applyQuaternion(this.camera.quaternion))),Qi(this,"moveForward",(e=>{Ji.setFromMatrixColumn(this.camera.matrix,0),Ji.crossVectors(this.camera.up,Ji),this.camera.position.addScaledVector(Ji,e)})),Qi(this,"moveRight",(e=>{Ji.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(Ji,e)})),Qi(this,"lock",(()=>{this.domElement&&this.domElement.requestPointerLock()})),Qi(this,"unlock",(()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()})),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}}var sa=Object.defineProperty,oa=(e,t,n)=>(((e,t,n)=>{t in e?sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const ia=new ae,aa=new le,la=Math.cos(Math.PI/180*70),ca=(e,t)=>(e%t+t)%t;class ua extends Q{constructor(e,t){super(),oa(this,"object"),oa(this,"domElement"),oa(this,"enabled",!0),oa(this,"target",new C),oa(this,"minDistance",0),oa(this,"maxDistance",1/0),oa(this,"minZoom",0),oa(this,"maxZoom",1/0),oa(this,"minPolarAngle",0),oa(this,"maxPolarAngle",Math.PI),oa(this,"minAzimuthAngle",-1/0),oa(this,"maxAzimuthAngle",1/0),oa(this,"enableDamping",!1),oa(this,"dampingFactor",.05),oa(this,"enableZoom",!0),oa(this,"zoomSpeed",1),oa(this,"enableRotate",!0),oa(this,"rotateSpeed",1),oa(this,"enablePan",!0),oa(this,"panSpeed",1),oa(this,"screenSpacePanning",!0),oa(this,"keyPanSpeed",7),oa(this,"zoomToCursor",!1),oa(this,"autoRotate",!1),oa(this,"autoRotateSpeed",2),oa(this,"reverseOrbit",!1),oa(this,"reverseHorizontalOrbit",!1),oa(this,"reverseVerticalOrbit",!1),oa(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),oa(this,"mouseButtons",{LEFT:I.ROTATE,MIDDLE:I.DOLLY,RIGHT:I.PAN}),oa(this,"touches",{ONE:L.ROTATE,TWO:L.DOLLY_PAN}),oa(this,"target0"),oa(this,"position0"),oa(this,"zoom0"),oa(this,"_domElementKeyEvents",null),oa(this,"getPolarAngle"),oa(this,"getAzimuthalAngle"),oa(this,"setPolarAngle"),oa(this,"setAzimuthalAngle"),oa(this,"getDistance"),oa(this,"getZoomScale"),oa(this,"listenToKeyEvents"),oa(this,"stopListenToKeyEvents"),oa(this,"saveState"),oa(this,"reset"),oa(this,"update"),oa(this,"connect"),oa(this,"dispose"),oa(this,"dollyIn"),oa(this,"dollyOut"),oa(this,"getScale"),oa(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=e=>{let t=ca(e,2*Math.PI),n=u.phi;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let s=Math.abs(t-n);2*Math.PI-s<s&&(t<n?t+=2*Math.PI:n+=2*Math.PI),h.phi=t-n,r.update()},this.setAzimuthalAngle=e=>{let t=ca(e,2*Math.PI),n=u.theta;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let s=Math.abs(t-n);2*Math.PI-s<s&&(t<n?t+=2*Math.PI:n+=2*Math.PI),h.theta=t-n,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",se),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",se),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(s),r.update(),l=a.NONE},this.update=(()=>{const t=new C,o=new C(0,1,0),i=(new X).setFromUnitVectors(e.up,o),m=i.clone().invert(),f=new C,g=new X,v=2*Math.PI;return function(){const y=r.object.position;i.setFromUnitVectors(e.up,o),m.copy(i).invert(),t.copy(y).sub(r.target),t.applyQuaternion(i),u.setFromVector3(t),r.autoRotate&&l===a.NONE&&D(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(u.theta+=h.theta*r.dampingFactor,u.phi+=h.phi*r.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let x=r.minAzimuthAngle,b=r.maxAzimuthAngle;isFinite(x)&&isFinite(b)&&(x<-Math.PI?x+=v:x>Math.PI&&(x-=v),b<-Math.PI?b+=v:b>Math.PI&&(b-=v),u.theta=x<=b?Math.max(x,Math.min(b,u.theta)):u.theta>(x+b)/2?Math.max(x,u.theta):Math.min(b,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(p,r.dampingFactor):r.target.add(p),r.zoomToCursor&&A||r.object.isOrthographicCamera?u.radius=V(u.radius):u.radius=V(u.radius*d),t.setFromSpherical(u),t.applyQuaternion(m),y.copy(r.target).add(t),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),!0===r.enableDamping?(h.theta*=1-r.dampingFactor,h.phi*=1-r.dampingFactor,p.multiplyScalar(1-r.dampingFactor)):(h.set(0,0,0),p.set(0,0,0));let w=!1;if(r.zoomToCursor&&A){let s=null;if(r.object instanceof n&&r.object.isPerspectiveCamera){const e=t.length();s=V(e*d);const n=e-s;r.object.position.addScaledVector(_,n),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const e=new C(E.x,E.y,0);e.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix(),w=!0;const n=new C(E.x,E.y,0);n.unproject(r.object),r.object.position.sub(n).add(e),r.object.updateMatrixWorld(),s=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==s&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(s).add(r.object.position):(ia.origin.copy(r.object.position),ia.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(ia.direction))<la?e.lookAt(r.target):(aa.setFromNormalAndCoplanarPoint(r.object.up,r.target),ia.intersectPlane(aa,r.target))))}else r.object instanceof H&&r.object.isOrthographicCamera&&(w=1!==d,w&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix()));return d=1,A=!1,!!(w||f.distanceToSquared(r.object.position)>c||8*(1-g.dot(r.object.quaternion))>c)&&(r.dispatchEvent(s),f.copy(r.object.position),g.copy(r.object.quaternion),w=!1,!0)}})(),this.connect=e=>{r.domElement=e,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",oe),r.domElement.addEventListener("pointerdown",ee),r.domElement.addEventListener("pointercancel",ne),r.domElement.addEventListener("wheel",re)},this.dispose=()=>{var e,t,n,s,o,i;r.domElement&&(r.domElement.style.touchAction="auto"),null==(e=r.domElement)||e.removeEventListener("contextmenu",oe),null==(t=r.domElement)||t.removeEventListener("pointerdown",ee),null==(n=r.domElement)||n.removeEventListener("pointercancel",ne),null==(s=r.domElement)||s.removeEventListener("wheel",re),null==(o=r.domElement)||o.ownerDocument.removeEventListener("pointermove",te),null==(i=r.domElement)||i.ownerDocument.removeEventListener("pointerup",ne),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",se)};const r=this,s={type:"change"},o={type:"start"},i={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new W,h=new W;let d=1;const p=new C,m=new S,f=new S,g=new S,v=new S,y=new S,x=new S,b=new S,w=new S,T=new S,_=new C,E=new S;let A=!1;const M=[],O={};function P(){return Math.pow(.95,r.zoomSpeed)}function D(e){r.reverseOrbit||r.reverseHorizontalOrbit?h.theta+=e:h.theta-=e}function R(e){r.reverseOrbit||r.reverseVerticalOrbit?h.phi+=e:h.phi-=e}const k=(()=>{const e=new C;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),p.add(e)}})(),N=(()=>{const e=new C;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),p.add(e)}})(),U=(()=>{const e=new C;return function(t,s){const o=r.domElement;if(o&&r.object instanceof n&&r.object.isPerspectiveCamera){const n=r.object.position;e.copy(n).sub(r.target);let i=e.length();i*=Math.tan(r.object.fov/2*Math.PI/180),k(2*t*i/o.clientHeight,r.object.matrix),N(2*s*i/o.clientHeight,r.object.matrix)}else o&&r.object instanceof H&&r.object.isOrthographicCamera?(k(t*(r.object.right-r.object.left)/r.object.zoom/o.clientWidth,r.object.matrix),N(s*(r.object.top-r.object.bottom)/r.object.zoom/o.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function F(e){r.object instanceof n&&r.object.isPerspectiveCamera||r.object instanceof H&&r.object.isOrthographicCamera?d=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function z(e){F(d/e)}function B(e){F(d*e)}function j(e){if(!r.zoomToCursor||!r.domElement)return;A=!0;const t=r.domElement.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top,o=t.width,i=t.height;E.x=n/o*2-1,E.y=-s/i*2+1,_.set(E.x,E.y,1).unproject(r.object).sub(r.object.position).normalize()}function V(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function Y(e){m.set(e.clientX,e.clientY)}function G(e){v.set(e.clientX,e.clientY)}function Z(){if(1==M.length)m.set(M[0].pageX,M[0].pageY);else{const e=.5*(M[0].pageX+M[1].pageX),t=.5*(M[0].pageY+M[1].pageY);m.set(e,t)}}function K(){if(1==M.length)v.set(M[0].pageX,M[0].pageY);else{const e=.5*(M[0].pageX+M[1].pageX),t=.5*(M[0].pageY+M[1].pageY);v.set(e,t)}}function Q(){const e=M[0].pageX-M[1].pageX,t=M[0].pageY-M[1].pageY,n=Math.sqrt(e*e+t*t);b.set(0,n)}function q(e){if(1==M.length)f.set(e.pageX,e.pageY);else{const t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);f.set(n,r)}g.subVectors(f,m).multiplyScalar(r.rotateSpeed);const t=r.domElement;t&&(D(2*Math.PI*g.x/t.clientHeight),R(2*Math.PI*g.y/t.clientHeight)),m.copy(f)}function J(e){if(1==M.length)y.set(e.pageX,e.pageY);else{const t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);y.set(n,r)}x.subVectors(y,v).multiplyScalar(r.panSpeed),U(x.x,x.y),v.copy(y)}function $(e){const t=ae(e),n=e.pageX-t.x,s=e.pageY-t.y,o=Math.sqrt(n*n+s*s);w.set(0,o),T.set(0,Math.pow(w.y/b.y,r.zoomSpeed)),z(T.y),b.copy(w)}function ee(e){var t,n;!1!==r.enabled&&(0===M.length&&(null==(t=r.domElement)||t.ownerDocument.addEventListener("pointermove",te),null==(n=r.domElement)||n.ownerDocument.addEventListener("pointerup",ne)),function(e){M.push(e)}(e),"touch"===e.pointerType?function(e){switch(ie(e),M.length){case 1:switch(r.touches.ONE){case L.ROTATE:if(!1===r.enableRotate)return;Z(),l=a.TOUCH_ROTATE;break;case L.PAN:if(!1===r.enablePan)return;K(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case L.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&Q(),r.enablePan&&K(),l=a.TOUCH_DOLLY_PAN;break;case L.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&Q(),r.enableRotate&&Z(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(o)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case I.DOLLY:if(!1===r.enableZoom)return;(function(e){j(e),b.set(e.clientX,e.clientY)})(e),l=a.DOLLY;break;case I.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;G(e),l=a.PAN}else{if(!1===r.enableRotate)return;Y(e),l=a.ROTATE}break;case I.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;Y(e),l=a.ROTATE}else{if(!1===r.enablePan)return;G(e),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(o)}(e))}function te(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(ie(e),l){case a.TOUCH_ROTATE:if(!1===r.enableRotate)return;q(e),r.update();break;case a.TOUCH_PAN:if(!1===r.enablePan)return;J(e),r.update();break;case a.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;(function(e){r.enableZoom&&$(e),r.enablePan&&J(e)})(e),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;(function(e){r.enableZoom&&$(e),r.enableRotate&&q(e)})(e),r.update();break;default:l=a.NONE}}(e):function(e){if(!1!==r.enabled)switch(l){case a.ROTATE:if(!1===r.enableRotate)return;!function(e){f.set(e.clientX,e.clientY),g.subVectors(f,m).multiplyScalar(r.rotateSpeed);const t=r.domElement;t&&(D(2*Math.PI*g.x/t.clientHeight),R(2*Math.PI*g.y/t.clientHeight)),m.copy(f),r.update()}(e);break;case a.DOLLY:if(!1===r.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),T.subVectors(w,b),T.y>0?z(P()):T.y<0&&B(P()),b.copy(w),r.update()}(e);break;case a.PAN:if(!1===r.enablePan)return;!function(e){y.set(e.clientX,e.clientY),x.subVectors(y,v).multiplyScalar(r.panSpeed),U(x.x,x.y),v.copy(y),r.update()}(e)}}(e))}function ne(e){var t,n,s;(function(e){delete O[e.pointerId];for(let t=0;t<M.length;t++)if(M[t].pointerId==e.pointerId)return void M.splice(t,1)})(e),0===M.length&&(null==(t=r.domElement)||t.releasePointerCapture(e.pointerId),null==(n=r.domElement)||n.ownerDocument.removeEventListener("pointermove",te),null==(s=r.domElement)||s.ownerDocument.removeEventListener("pointerup",ne)),r.dispatchEvent(i),l=a.NONE}function re(e){!1===r.enabled||!1===r.enableZoom||l!==a.NONE&&l!==a.ROTATE||(e.preventDefault(),r.dispatchEvent(o),function(e){j(e),e.deltaY<0?B(P()):e.deltaY>0&&z(P()),r.update()}(e),r.dispatchEvent(i))}function se(e){!1===r.enabled||!1===r.enablePan||function(e){let t=!1;switch(e.code){case r.keys.UP:U(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:U(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:U(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:U(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function oe(e){!1!==r.enabled&&e.preventDefault()}function ie(e){let t=O[e.pointerId];void 0===t&&(t=new S,O[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ae(e){const t=e.pointerId===M[0].pointerId?M[1]:M[0];return O[t.pointerId]}this.dollyIn=(e=P())=>{B(e),r.update()},this.dollyOut=(e=P())=>{z(e),r.update()},this.getScale=()=>d,this.setScale=e=>{F(e),r.update()},this.getZoomScale=()=>P(),void 0!==t&&this.connect(t),this.update()}}class ha extends ua{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=I.PAN,this.mouseButtons.RIGHT=I.ROTATE,this.touches.ONE=L.PAN,this.touches.TWO=L.DOLLY_ROTATE}}function da(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}const pa="srgb",ma="srgb-linear";class fa extends ne{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new wa(e)})),this.register((function(e){return new Ta(e)})),this.register((function(e){return new Ia(e)})),this.register((function(e){return new La(e)})),this.register((function(e){return new Da(e)})),this.register((function(e){return new Ea(e)})),this.register((function(e){return new Aa(e)})),this.register((function(e){return new Ma(e)})),this.register((function(e){return new Sa(e)})),this.register((function(e){return new ba(e)})),this.register((function(e){return new Ca(e)})),this.register((function(e){return new _a(e)})),this.register((function(e){return new Pa(e)})),this.register((function(e){return new Oa(e)})),this.register((function(e){return new ya(e)})),this.register((function(e){return new Ra(e)})),this.register((function(e){return new ka(e)}))}load(e,t,n,r){const s=this;let o;if(""!==this.resourcePath)o=this.resourcePath;else if(""!==this.path){const t=ye.extractUrlBase(e);o=ye.resolveURL(t,this.path)}else o=ye.extractUrlBase(e);this.manager.itemStart(e);const i=function(t){r?r(t):console.error(t),s.manager.itemError(e),s.manager.itemEnd(e)},a=new re(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{s.parse(n,o,(function(n){t(n),s.manager.itemEnd(e)}),i)}catch(r){i(r)}}),n,i)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},i={};if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(da(new Uint8Array(e.slice(0,4)))===Na){try{o[va.KHR_BINARY_GLTF]=new za(e)}catch(l){return void(r&&r(l))}s=JSON.parse(o[va.KHR_BINARY_GLTF].content)}else s=JSON.parse(da(new Uint8Array(e)));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const a=new hl(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});a.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](a);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),i[e.name]=e,o[e.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const e=s.extensionsUsed[c],t=s.extensionsRequired||[];switch(e){case va.KHR_MATERIALS_UNLIT:o[e]=new xa;break;case va.KHR_DRACO_MESH_COMPRESSION:o[e]=new Ba(s,this.dracoLoader);break;case va.KHR_TEXTURE_TRANSFORM:o[e]=new ja;break;case va.KHR_MESH_QUANTIZATION:o[e]=new Ha;break;default:t.indexOf(e)>=0&&void 0===i[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}a.setExtensions(o),a.setPlugins(i),a.parse(n,r)}parseAsync(e,t){const n=this;return new Promise((function(r,s){n.parse(e,t,r,s)}))}}function ga(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const va={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ya{constructor(e){this.parser=e,this.name=va.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let i;const a=new g(16777215);void 0!==o.color&&a.setRGB(o.color[0],o.color[1],o.color[2],ma);const l=void 0!==o.range?o.range:0;switch(o.type){case"directional":i=new _e(a),i.target.position.set(0,0,-1),i.add(i.target);break;case"point":i=new Te(a),i.distance=l;break;case"spot":i=new we(a),i.distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,i.angle=o.spot.outerConeAngle,i.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return i.position.set(0,0,0),i.decay=2,ol(i,o),void 0!==o.intensity&&(i.intensity=o.intensity),i.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(i),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],s=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then((function(e){return n._getNodeRef(t.cache,s,e)}))}}class xa{constructor(){this.name=va.KHR_MATERIALS_UNLIT}getMaterialType(){return m}extendParams(e,t,n){const r=[];e.color=new g(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const t=s.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],ma),e.opacity=t[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,pa))}return Promise.all(r)}}class ba{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class wa{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new S(e,e)}return Promise.all(s)}}class Ta{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.dispersion=void 0!==r.dispersion?r.dispersion:0,Promise.resolve()}}class _a{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class Ea{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new g(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const e=o.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],ma)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,pa)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class Aa{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class Ma{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const i=o.attenuationColor||[1,1,1];return t.attenuationColor=(new g).setRGB(i[0],i[1],i[2],ma),Promise.all(s)}}class Sa{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class Ca{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const i=o.specularColorFactor||[1,1,1];return t.specularColor=(new g).setRGB(i[0],i[1],i[2],ma),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,pa)),Promise.all(s)}}class Oa{constructor(e){this.parser=e,this.name=va.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=void 0!==o.bumpFactor?o.bumpFactor:1,void 0!==o.bumpTexture&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class Pa{constructor(e){this.parser=e,this.name=va.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?be:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class Ia{constructor(e){this.parser=e,this.name=va.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class La{constructor(e){this.parser=e,this.name=va.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],i=r.images[o.source];let a=n.textureLoader;if(i.uri){const e=n.options.manager.getHandler(i.uri);null!==e&&(a=e)}return this.detectSupport().then((function(s){if(s)return n.loadTextureImage(e,o.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Da{constructor(e){this.parser=e,this.name=va.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],i=r.images[o.source];let a=n.textureLoader;if(i.uri){const e=n.options.manager.getHandler(i.uri);null!==e&&(a=e)}return this.detectSupport().then((function(s){if(s)return n.loadTextureImage(e,o.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Ra{constructor(e){this.name=va.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,o=e.count,i=e.byteStride,a=new Uint8Array(t,n,r);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(o,i,a,e.mode,e.filter).then((function(e){return e.buffer})):s.ready.then((function(){const t=new ArrayBuffer(o*i);return s.decodeGltfBuffer(new Uint8Array(t),o,i,a,e.mode,e.filter),t}))}))}return null}}class ka{constructor(e){this.name=va.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const a of r.primitives)if(a.mode!==Wa.TRIANGLES&&a.mode!==Wa.TRIANGLE_STRIP&&a.mode!==Wa.TRIANGLE_FAN&&void 0!==a.mode)return null;const s=n.extensions[this.name].attributes,o=[],i={};for(const a in s)o.push(this.parser.getDependency("accessor",s[a]).then((e=>(i[a]=e,i[a]))));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],r=e[0].count,s=[];for(const o of n){const e=new Z,t=new C,n=new X,a=new C(1,1,1),l=new Ee(o.geometry,o.material,r);for(let s=0;s<r;s++)i.TRANSLATION&&t.fromBufferAttribute(i.TRANSLATION,s),i.ROTATION&&n.fromBufferAttribute(i.ROTATION,s),i.SCALE&&a.fromBufferAttribute(i.SCALE,s),l.setMatrixAt(s,e.compose(t,n,a));for(const r in i)if("_COLOR_0"===r){const e=i[r];l.instanceColor=new Ae(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&o.geometry.setAttribute(r,i[r]);_.prototype.copy.call(l,o),this.parser.assignFinalMaterial(l),s.push(l)}return t.isGroup?(t.clear(),t.add(...s),t):s[0]})))}}const Na="glTF",Ua=1313821514,Fa=5130562;class za{constructor(e){this.name=va.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:da(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Na)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const t=r.getUint32(s,!0);s+=4;const n=r.getUint32(s,!0);if(s+=4,n===Ua){const n=new Uint8Array(e,12+s,t);this.content=da(n)}else if(n===Fa){const n=12+s;this.body=e.slice(n,n+t)}s+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ba{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=va.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},a={},l={};for(const c in o){const e=qa[c]||c.toLowerCase();i[e]=o[c]}for(const c in e.attributes){const t=qa[c]||c.toLowerCase();if(void 0!==o[c]){const r=n.accessors[e.attributes[c]],s=Ga[r.componentType];l[t]=s.name,a[t]=!0===r.normalized}}return t.getDependency("bufferView",s).then((function(e){return new Promise((function(t,n){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=a[t];void 0!==r&&(n.normalized=r)}t(e)}),i,l,ma,n)}))}))}}class ja{constructor(){this.name=va.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Ha{constructor(){this.name=va.KHR_MESH_QUANTIZATION}}class Va extends it{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,i=this.valueSize,a=2*i,l=3*i,c=r-t,u=(n-t)/c,h=u*u,d=h*u,p=e*l,m=p-l,f=-2*d+3*h,g=d-h,v=1-f,y=g-h+u;for(let x=0;x!==i;x++){const e=o[m+x+i],t=o[m+x+a]*c,n=o[p+x+i],r=o[p+x]*c;s[x]=v*e+y*t+f*n+g*r}return s}}const Xa=new X;class Ya extends Va{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return Xa.fromArray(s).normalize().toArray(s),s}}const Wa={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ga={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Za={9728:Le,9729:ve,9984:Ie,9985:Pe,9986:Oe,9987:Ce},Ka={33071:ke,33648:Re,10497:De},Qa={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},qa={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...$s>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ja={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},$a={CUBICSPLINE:void 0,LINEAR:Ze,STEP:Ge},el="OPAQUE",tl="MASK",nl="BLEND";function rl(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new oe({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:nt})),e.DefaultMaterial}function sl(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function ol(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function il(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function al(e){let t;const n=e.extensions&&e.extensions[va.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+ll(n.attributes):e.indices+":"+ll(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,s=e.targets.length;r<s;r++)t+=":"+ll(e.targets[r]);return t}function ll(e){let t="";const n=Object.keys(e).sort();for(let r=0,s=n.length;r<s;r++)t+=n[r]+":"+e[n[r]]+";";return t}function cl(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const ul=new Z;class hl{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ga,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,o=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),s=navigator.userAgent.indexOf("Firefox")>-1,o=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&o<98?this.textureLoader=new r(this.options.manager):this.textureLoader=new Me(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new re(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const o={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};return sl(s,o,r),ol(o,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(o)}))).then((function(){for(const e of o.scenes)e.updateMatrixWorld();e(o)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const t=e[r];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[r,o]of e.children.entries())s(o,t.children[r])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[va.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(e,s){n.load(ye.resolveURL(t.uri,r.path),e,void 0,(function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const e=Qa[r.type],t=Ga[r.componentType],n=!0===r.normalized,s=new t(r.count*e);return Promise.resolve(new E(s,e,n))}const s=[];return void 0!==r.bufferView?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then((function(e){const s=e[0],o=Qa[r.type],i=Ga[r.componentType],a=i.BYTES_PER_ELEMENT,l=a*o,c=r.byteOffset||0,u=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;let d,p;if(u&&u!==l){const e=Math.floor(c/u),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let l=t.cache.get(n);l||(d=new i(s,e*u,r.count*u/a),l=new Se(d,u/a),t.cache.add(n,l)),p=new Je(l,o,c%u/a,h)}else d=null===s?new i(r.count*o):new i(s,c,r.count*o),p=new E(d,o,h);if(void 0!==r.sparse){const t=Qa.SCALAR,n=Ga[r.sparse.indices.componentType],a=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,c=new n(e[1],a,r.sparse.count*t),u=new i(e[2],l,r.sparse.count*o);null!==s&&(p=new E(p.array.slice(),p.itemSize,p.normalized));for(let e=0,r=c.length;e<r;e++){const t=c[e];if(p.setX(t,u[e*o]),o>=2&&p.setY(t,u[e*o+1]),o>=3&&p.setZ(t,u[e*o+2]),o>=4&&p.setW(t,u[e*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,s=t.images[r];let o=this.textureLoader;if(s.uri){const e=n.manager.getHandler(s.uri);null!==e&&(o=e)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],i=s.images[t],a=(i.uri||i.bufferView)+":"+o.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=o.name||i.name||"",""===t.name&&"string"==typeof i.uri&&!1===i.uri.startsWith("data:image/")&&(t.name=i.uri);const n=(s.samplers||{})[o.sampler]||{};return t.magFilter=Za[n.magFilter]||ve,t.minFilter=Za[n.minFilter]||Ce,t.wrapS=Ka[n.wrapS]||De,t.wrapT=Ka[n.wrapT]||De,r.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const s=n.images[e],o=self.URL||self.webkitURL;let i=s.uri||"",a=!1;if(void 0!==s.bufferView)i=this.getDependency("bufferView",s.bufferView).then((function(e){a=!0;const t=new Blob([e],{type:s.mimeType});return i=o.createObjectURL(t),i}));else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(i).then((function(e){return new Promise((function(n,s){let o=n;!0===t.isImageBitmapLoader&&(o=function(e){const t=new Ne(e);t.needsUpdate=!0,n(t)}),t.load(ye.resolveURL(e,r.path),o,void 0,s)}))})).then((function(e){return!0===a&&o.revokeObjectURL(i),ol(e,s),e.userData.mimeType=s.mimeType||function(e){return e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":"image/png"}(s.uri),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",i),e}));return this.sourceCache[e]=l,l}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then((function(o){if(!o)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((o=o.clone()).channel=n.texCoord),s.extensions[va.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[va.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=s.associations.get(o);o=s.extensions[va.KHR_TEXTURE_TRANSFORM].extendTexture(o,e),s.associations.set(o,t)}}return void 0!==r&&("number"==typeof r&&(r=3001===r?pa:ma),"colorSpace"in o?o.colorSpace=r:o.encoding=r===pa?3001:3e3),e[t]=o,o}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new Ue,Fe.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new d,Fe.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(r||s||o){let e="ClonedMaterial:"+n.uuid+":";r&&(e+="derivative-tangents:"),s&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),s&&(t.vertexColors=!0),o&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return oe}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let o;const i={},a=[];if((s.extensions||{})[va.KHR_MATERIALS_UNLIT]){const e=r[va.KHR_MATERIALS_UNLIT];o=e.getMaterialType(),a.push(e.extendParams(i,s,t))}else{const n=s.pbrMetallicRoughness||{};if(i.color=new g(1,1,1),i.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;i.color.setRGB(e[0],e[1],e[2],ma),i.opacity=e[3]}void 0!==n.baseColorTexture&&a.push(t.assignTexture(i,"map",n.baseColorTexture,pa)),i.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,i.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(a.push(t.assignTexture(i,"metalnessMap",n.metallicRoughnessTexture)),a.push(t.assignTexture(i,"roughnessMap",n.metallicRoughnessTexture))),o=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),a.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,i)}))))}!0===s.doubleSided&&(i.side=P);const l=s.alphaMode||el;if(l===nl?(i.transparent=!0,i.depthWrite=!1):(i.transparent=!1,l===tl&&(i.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==m&&(a.push(t.assignTexture(i,"normalMap",s.normalTexture)),i.normalScale=new S(1,1),void 0!==s.normalTexture.scale)){const e=s.normalTexture.scale;i.normalScale.set(e,e)}if(void 0!==s.occlusionTexture&&o!==m&&(a.push(t.assignTexture(i,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(i.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==m){const e=s.emissiveFactor;i.emissive=(new g).setRGB(e[0],e[1],e[2],ma)}return void 0!==s.emissiveTexture&&o!==m&&a.push(t.assignTexture(i,"emissiveMap",s.emissiveTexture,pa)),Promise.all(a).then((function(){const n=new o(i);return s.name&&(n.name=s.name),ol(n,s),t.associations.set(n,{materials:e}),s.extensions&&sl(r,n,s),n}))}createUniqueName(e){const t=ze.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(e){return n[va.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return dl(n,e,t)}))}const o=[];for(let i=0,a=e.length;i<a;i++){const n=e[i],a=al(n),l=r[a];if(l)o.push(l.promise);else{let e;e=n.extensions&&n.extensions[va.KHR_DRACO_MESH_COMPRESSION]?s(n):dl(new u,n,t),r[a]={primitive:n,promise:e},o.push(e)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,i=[];for(let a=0,l=o.length;a<l;a++){const e=void 0===o[a].material?rl(this.cache):this.getDependency("material",o[a].material);i.push(e)}return i.push(t.loadGeometries(o)),Promise.all(i).then((function(n){const i=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let h=0,d=a.length;h<d;h++){const n=a[h],u=o[h];let d;const m=i[h];if(u.mode===Wa.TRIANGLES||u.mode===Wa.TRIANGLE_STRIP||u.mode===Wa.TRIANGLE_FAN||void 0===u.mode)d=!0===s.isSkinnedMesh?new Be(n,m):new p(n,m),!0===d.isSkinnedMesh&&d.normalizeSkinWeights(),u.mode===Wa.TRIANGLE_STRIP?d.geometry=to(d.geometry,ot):u.mode===Wa.TRIANGLE_FAN&&(d.geometry=to(d.geometry,st));else if(u.mode===Wa.LINES)d=new je(n,m);else if(u.mode===Wa.LINE_STRIP)d=new c(n,m);else if(u.mode===Wa.LINE_LOOP)d=new He(n,m);else{if(u.mode!==Wa.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);d=new Ve(n,m)}Object.keys(d.geometry.morphAttributes).length>0&&il(d,s),d.name=t.createUniqueName(s.name||"mesh_"+e),ol(d,s),u.extensions&&sl(r,d,u),t.assignFinalMaterial(d),l.push(d)}for(let r=0,s=l.length;r<s;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return s.extensions&&sl(r,l[0],s),l[0];const u=new B;s.extensions&&sl(r,u,s),t.associations.set(u,{meshes:e});for(let e=0,t=l.length;e<t;e++)u.add(l[e]);return u}))}loadCamera(e){let t;const r=this.json.cameras[e],s=r[r.type];if(s)return"perspective"===r.type?t=new n(T.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===r.type&&(t=new H(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),ol(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),r=e,s=[],o=[];for(let i=0,a=r.length;i<a;i++){const e=r[i];if(e){s.push(e);const t=new Z;null!==n&&t.fromArray(n.array,16*i),o.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[i])}return new Xe(s,o)}))}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],i=[],a=[],l=[],c=[];for(let u=0,h=r.channels.length;u<h;u++){const e=r.channels[u],t=r.samplers[e.sampler],n=e.target,s=n.node,h=void 0!==r.parameters?r.parameters[t.input]:t.input,d=void 0!==r.parameters?r.parameters[t.output]:t.output;void 0!==n.node&&(o.push(this.getDependency("node",s)),i.push(this.getDependency("accessor",h)),a.push(this.getDependency("accessor",d)),l.push(t),c.push(n))}return Promise.all([Promise.all(o),Promise.all(i),Promise.all(a),Promise.all(l),Promise.all(c)]).then((function(e){const t=e[0],r=e[1],o=e[2],i=e[3],a=e[4],l=[];for(let s=0,c=t.length;s<c;s++){const e=t[s],c=r[s],u=o[s],h=i[s],d=a[s];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const p=n._createAnimationTracks(e,c,u,h,d);if(p)for(let t=0;t<p.length;t++)l.push(p[t])}return new Ye(s,void 0,l)}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),s=[],o=n.children||[];for(let a=0,l=o.length;a<l;a++)s.push(t.getDependency("node",o[a]));const i=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(s),i]).then((function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,ul)}));for(let s=0,o=n.length;s<o;s++)t.add(n[s]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",i=[],a=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return a&&i.push(a),void 0!==s.camera&&i.push(r.getDependency("camera",s.camera).then((function(e){return r._getNodeRef(r.cameraCache,s.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){i.push(e)})),this.nodeCache[e]=Promise.all(i).then((function(t){let i;if(i=!0===s.isBone?new We:t.length>1?new B:1===t.length?t[0]:new _,i!==t[0])for(let e=0,n=t.length;e<n;e++)i.add(t[e]);if(s.name&&(i.userData.name=s.name,i.name=o),ol(i,s),s.extensions&&sl(n,i,s),void 0!==s.matrix){const e=new Z;e.fromArray(s.matrix),i.applyMatrix4(e)}else void 0!==s.translation&&i.position.fromArray(s.translation),void 0!==s.rotation&&i.quaternion.fromArray(s.rotation),void 0!==s.scale&&i.scale.fromArray(s.scale);return r.associations.has(i)||r.associations.set(i,{}),r.associations.get(i).nodes=e,i})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new B;n.name&&(s.name=r.createUniqueName(n.name)),ol(s,n),n.extensions&&sl(t,s,n);const o=n.nodes||[],i=[];for(let a=0,l=o.length;a<l;a++)i.push(r.getDependency("node",o[a]));return Promise.all(i).then((function(e){for(let t=0,n=e.length;t<n;t++)s.add(e[t]);return r.associations=(e=>{const t=new Map;for(const[n,s]of r.associations)(n instanceof Fe||n instanceof Ne)&&t.set(n,s);return e.traverse((e=>{const n=r.associations.get(e);null!=n&&t.set(e,n)})),t})(s),s}))}_createAnimationTracks(e,t,n,r,s){const o=[],i=e.name?e.name:e.uuid,a=[];let l;switch(Ja[s.path]===Ja.weights?e.traverse((function(e){e.morphTargetInfluences&&a.push(e.name?e.name:e.uuid)})):a.push(i),Ja[s.path]){case Ja.weights:l=et;break;case Ja.rotation:l=tt;break;case Ja.position:case Ja.scale:l=$e;break;default:if(1===n.itemSize)l=et;else l=$e}const c=void 0!==r.interpolation?$a[r.interpolation]:Ze,u=this._getArrayFromAccessor(n);for(let h=0,d=a.length;h<d;h++){const e=new l(a[h]+"."+Ja[s.path],t.array,u,c);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(e),o.push(e)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=cl(t.constructor),n=new Float32Array(t.length);for(let r=0,s=t.length;r<s;r++)n[r]=t[r]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof tt?Ya:Va)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function dl(e,t,n){const r=t.attributes,s=[];function o(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const i in r){const t=qa[i]||i.toLowerCase();t in e.attributes||s.push(o(r[i],t))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));s.push(r)}return ol(e,t),function(e,t,n){const r=t.attributes,s=new K;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,o=e.max;if(void 0===t||void 0===o)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(s.set(new C(t[0],t[1],t[2]),new C(o[0],o[1],o[2])),e.normalized){const t=cl(Ga[e.componentType]);s.min.multiplyScalar(t),s.max.multiplyScalar(t)}}const o=t.targets;if(void 0!==o){const e=new C,t=new C;for(let r=0,s=o.length;r<s;r++){const s=o[r];if(void 0!==s.POSITION){const r=n.json.accessors[s.POSITION],o=r.min,i=r.max;if(void 0!==o&&void 0!==i){if(t.setX(Math.max(Math.abs(o[0]),Math.abs(i[0]))),t.setY(Math.max(Math.abs(o[1]),Math.abs(i[1]))),t.setZ(Math.max(Math.abs(o[2]),Math.abs(i[2]))),r.normalized){const e=cl(Ga[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(e)}e.boundingBox=s;const i=new G;s.getCenter(i.center),i.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=i}(e,t,n),Promise.all(s).then((function(){return void 0!==t.targets?function(e,t,n){let r=!1,s=!1,o=!1;for(let c=0,u=t.length;c<u;c++){const e=t[c];if(void 0!==e.POSITION&&(r=!0),void 0!==e.NORMAL&&(s=!0),void 0!==e.COLOR_0&&(o=!0),r&&s&&o)break}if(!r&&!s&&!o)return Promise.resolve(e);const i=[],a=[],l=[];for(let c=0,u=t.length;c<u;c++){const u=t[c];if(r){const t=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):e.attributes.position;i.push(t)}if(s){const t=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):e.attributes.normal;a.push(t)}if(o){const t=void 0!==u.COLOR_0?n.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(i),Promise.all(a),Promise.all(l)]).then((function(t){const n=t[0],i=t[1],a=t[2];return r&&(e.morphAttributes.position=n),s&&(e.morphAttributes.normal=i),o&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}new C;class pl extends te{constructor(e,t={}){const{bevelEnabled:n=!1,bevelSize:r=8,bevelThickness:s=10,font:o,height:i=50,size:a=100,lineHeight:l=1,letterSpacing:c=0,...u}=t;if(void 0===o)super();else{super(o.generateShapes(e,a,{lineHeight:l,letterSpacing:c}),{...u,bevelEnabled:n,bevelSize:r,bevelThickness:s,depth:i})}this.type="TextGeometry"}}const ml={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},fl={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "};function gl(e,t,n){const r=n.length-e-1;if(t>=n[r])return r-1;if(t<=n[e])return e;let s=e,o=r,i=Math.floor((s+o)/2);for(;t<n[i]||t>=n[i+1];)t<n[i]?o=i:s=i,i=Math.floor((s+o)/2);return i}function vl(e,t){let n=1;for(let s=2;s<=e;++s)n*=s;let r=1;for(let s=2;s<=t;++s)r*=s;for(let s=2;s<=e-t;++s)r*=s;return n/r}function yl(e,t,n,r,s){const o=function(e,t,n,r,s){const o=s<e?s:e,i=[],a=gl(e,r,t),l=function(e,t,n,r,s){const o=[];for(let h=0;h<=n;++h)o[h]=0;const i=[];for(let h=0;h<=r;++h)i[h]=o.slice(0);const a=[];for(let h=0;h<=n;++h)a[h]=o.slice(0);a[0][0]=1;const l=o.slice(0),c=o.slice(0);for(let h=1;h<=n;++h){l[h]=t-s[e+1-h],c[h]=s[e+h]-t;let n=0;for(let e=0;e<h;++e){const t=c[e+1],r=l[h-e];a[h][e]=t+r;const s=a[e][h-1]/a[h][e];a[e][h]=n+t*s,n=r*s}a[h][h]=n}for(let h=0;h<=n;++h)i[0][h]=a[h][n];for(let h=0;h<=n;++h){let e=0,t=1;const s=[];for(let r=0;r<=n;++r)s[r]=o.slice(0);s[0][0]=1;for(let o=1;o<=r;++o){let r=0;const l=h-o,c=n-o;h>=o&&(s[t][0]=s[e][0]/a[c+1][l],r=s[t][0]*a[l][c]);const u=h-1<=c?o-1:n-h;for(let n=l>=-1?1:-l;n<=u;++n)s[t][n]=(s[e][n]-s[e][n-1])/a[c+1][l+n],r+=s[t][n]*a[l+n][c];h<=c&&(s[t][o]=-s[e][o-1]/a[c+1][h],r+=s[t][o]*a[h][c]),i[o][h]=r;const d=e;e=t,t=d}}let u=n;for(let h=1;h<=r;++h){for(let e=0;e<=n;++e)i[h][e]*=u;u*=n-h}return i}(a,r,e,o,t),c=[];for(let u=0;u<n.length;++u){const e=n[u].clone(),t=e.w;e.x*=t,e.y*=t,e.z*=t,c[u]=e}for(let u=0;u<=o;++u){const t=c[a-e].clone().multiplyScalar(l[u][0]);for(let n=1;n<=e;++n)t.add(c[a-e+n].clone().multiplyScalar(l[u][n]));i[u]=t}for(let u=o+1;u<=s+1;++u)i[u]=new Y(0,0,0);return i}(e,t,n,r,s);return function(e){const t=e.length,n=[],r=[];for(let o=0;o<t;++o){const t=e[o];n[o]=new C(t.x,t.y,t.z),r[o]=t.w}const s=[];for(let o=0;o<t;++o){const e=n[o].clone();for(let t=1;t<=o;++t)e.sub(s[o-t].clone().multiplyScalar(vl(o,t)*r[t]));s[o]=e.divideScalar(r[0])}return s}(o)}class xl extends ct{constructor(e,t,n,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<n.length;++o){const e=n[o];this.controlPoints[o]=new Y(e.x,e.y,e.z,e.w)}}getPoint(e,t){const n=t||new C,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=function(e,t,n,r){const s=gl(e,r,t),o=function(e,t,n,r){const s=[],o=[],i=[];s[0]=1;for(let a=1;a<=n;++a){o[a]=t-r[e+1-a],i[a]=r[e+a]-t;let n=0;for(let e=0;e<a;++e){const t=i[e+1],r=o[a-e],l=s[e]/(t+r);s[e]=n+t*l,n=r*l}s[a]=n}return s}(s,r,e,t),i=new Y(0,0,0,0);for(let a=0;a<=e;++a){const t=n[s-e+a],r=o[a],l=t.w*r;i.x+=t.x*l,i.y+=t.y*l,i.z+=t.z*l,i.w+=t.w*r}return i}(this.degree,this.knots,this.controlPoints,r);return 1!=s.w&&s.divideScalar(s.w),n.set(s.x,s.y,s.z)}getTangent(e,t){const n=t||new C,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=yl(this.degree,this.knots,this.controlPoints,r,1);return n.copy(s[1]).normalize(),n}}let bl,wl,Tl;class _l extends ne{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===s.path?ye.extractUrlBase(e):s.path,i=new re(this.manager);i.setPath(s.path),i.setResponseType("arraybuffer"),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(e,(function(n){try{t(s.parse(n,o))}catch(i){r?r(i):console.error(i),s.manager.itemError(e)}}),n,r)}parse(e,t){if(function(e){const t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===Bl(e,0,t.length)}(e))bl=(new Cl).parse(e);else{const t=Bl(e);if(!function(e){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(t){const r=e[t-1];return e=e.slice(n+t),n++,r}for(let s=0;s<t.length;++s)if(r(1)===t[s])return!1;return!0}(t))throw new Error("THREE.FBXLoader: Unknown format.");if(Il(t)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Il(t));bl=(new Sl).parse(t)}const n=new r(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new El(n,this.manager).parse(bl)}}class El{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){wl=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),s=(new Al).parse(r);return this.parseScene(r,s,n),Tl}parseConnections(){const e=new Map;return"Connections"in bl&&bl.Connections.connections.forEach((function(t){const n=t[0],r=t[1],s=t[2];e.has(n)||e.set(n,{parents:[],children:[]});const o={ID:r,relationship:s};e.get(n).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});const i={ID:n,relationship:s};e.get(r).children.push(i)})),e}parseImages(){const e={},t={};if("Video"in bl.Objects){const n=bl.Objects.Video;for(const r in n){const s=n[r];if(e[parseInt(r)]=s.RelativeFilename||s.Filename,"Content"in s){const e=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,o="string"==typeof s.Content&&""!==s.Content;if(e||o){const e=this.parseImage(n[r]);t[s.RelativeFilename||s.Filename]=e}}}}for(const n in e){const r=e[n];void 0!==t[r]?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),s="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+s+";base64,"+t;{const e=new Uint8Array(t);return window.URL.createObjectURL(new Blob([e],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in bl.Objects){const n=bl.Objects.Texture;for(const r in n){const s=this.parseTexture(n[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,o=void 0!==r?r.value:0,i=void 0!==s?s.value:0;if(n.wrapS=0===o?De:ke,n.wrapT=0===i?De:ke,"Scaling"in e){const t=e.Scaling.value;n.repeat.x=t[0],n.repeat.y=t[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,s=wl.get(e.id).children;let o;void 0!==s&&s.length>0&&void 0!==t[s[0].ID]&&(n=t[s[0].ID],(0===n.indexOf("blob:")||0===n.indexOf("data:"))&&this.textureLoader.setPath(void 0));const i=e.FileName.slice(-3).toLowerCase();if("tga"===i){const t=this.manager.getHandler(".tga");null===t?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new Ne):(t.setPath(this.textureLoader.path),o=t.load(n))}else"psd"===i?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new Ne):o=this.textureLoader.load(n);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in bl.Objects){const n=bl.Objects.Material;for(const r in n){const s=this.parseMaterial(n[r],e);null!==s&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let s=e.ShadingModel;if("object"==typeof s&&(s=s.value),!wl.has(n))return null;const o=this.parseParameters(e,t,n);let i;switch(s.toLowerCase()){case"phong":i=new Ke;break;case"lambert":i=new Qe;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),i=new Ke}return i.setValues(o),i.name=r,i}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new g).fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=(new g).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new g).fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=(new g).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new g).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new g).fromArray(e.SpecularColor.value));const s=this;return wl.get(n).children.forEach((function(e){const n=e.relationship;switch(n){case"Bump":r.bumpMap=s.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,e.ID),void 0!==r.map&&("colorSpace"in r.map?r.map.colorSpace="srgb":r.map.encoding=3001);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,e.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,e.ID),void 0!==r.emissiveMap&&("colorSpace"in r.emissiveMap?r.emissiveMap.colorSpace="srgb":r.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,e.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,e.ID),void 0!==r.envMap&&(r.envMap.mapping=ee,"colorSpace"in r.envMap?r.envMap.colorSpace="srgb":r.envMap.encoding=3001);break;case"SpecularColor":r.specularMap=s.getTexture(t,e.ID),void 0!==r.specularMap&&("colorSpace"in r.specularMap?r.specularMap.colorSpace="srgb":r.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,e.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n)}})),r}getTexture(e,t){return"LayeredTexture"in bl.Objects&&t in bl.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=wl.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in bl.Objects){const n=bl.Objects.Deformer;for(const r in n){const s=n[r],o=wl.get(parseInt(r));if("Skin"===s.attrType){const t=this.parseSkeleton(o,n);t.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),t.geometryID=o.parents[0].ID,e[r]=t}else if("BlendShape"===s.attrType){const e={id:r};e.rawTargets=this.parseMorphTargets(o,n),e.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=e}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach((function(e){const r=t[e.ID];if("Cluster"!==r.attrType)return;const s={ID:e.ID,indices:[],weights:[],transformLink:(new Z).fromArray(r.TransformLink.a)};"Indexes"in r&&(s.indices=r.Indexes.a,s.weights=r.Weights.a),n.push(s)})),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],i={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;i.geoID=wl.get(parseInt(s.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,n.push(i)}return n}parseScene(e,t,n){Tl=new B;const r=this.parseModels(e.skeletons,t,n),s=bl.Objects.Model,o=this;r.forEach((function(e){const t=s[e.ID];o.setLookAtProperties(e,t),wl.get(e.ID).parents.forEach((function(t){const n=r.get(t.ID);void 0!==n&&n.add(e)})),null===e.parent&&Tl.add(e)})),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),Tl.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);const t=Ul(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));const i=(new Ml).parse();1===Tl.children.length&&Tl.children[0].isGroup&&(Tl.children[0].animations=i,Tl=Tl.children[0]),Tl.animations=i}parseModels(e,t,n){const r=new Map,s=bl.Objects.Model;for(const o in s){const i=parseInt(o),a=s[o],l=wl.get(i);let c=this.buildSkeleton(l,e,i,a.attrName);if(!c){switch(a.attrType){case"Camera":c=this.createCamera(l);break;case"Light":c=this.createLight(l);break;case"Mesh":c=this.createMesh(l,t,n);break;case"NurbsCurve":c=this.createCurve(l,t);break;case"LimbNode":case"Root":c=new We;break;default:c=new B}c.name=a.attrName?ze.sanitizeNodeName(a.attrName):"",c.ID=i}this.getTransformData(c,a),r.set(i,c)}return r}buildSkeleton(e,t,n,r){let s=null;return e.parents.forEach((function(e){for(const o in t){const i=t[o];i.rawBones.forEach((function(t,o){if(t.ID===e.ID){const e=s;s=new We,s.matrixWorld.copy(t.transformLink),s.name=r?ze.sanitizeNodeName(r):"",s.ID=n,i.bones[o]=s,null!==e&&s.add(e)}}))}})),s}createCamera(e){let t,r;if(e.children.forEach((function(e){const t=bl.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)})),void 0===r)t=new _;else{let e=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(e=1);let s=1;void 0!==r.NearPlane&&(s=r.NearPlane.value/1e3);let o=1e3;void 0!==r.FarPlane&&(o=r.FarPlane.value/1e3);let i=window.innerWidth,a=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(i=r.AspectWidth.value,a=r.AspectHeight.value);const l=i/a;let c=45;void 0!==r.FieldOfView&&(c=r.FieldOfView.value);const u=r.FocalLength?r.FocalLength.value:null;switch(e){case 0:t=new n(c,l,s,o),null!==u&&t.setFocalLength(u);break;case 1:t=new H(-i/2,i/2,a/2,-a/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+e+"."),t=new _}}return t}createLight(e){let t,n;if(e.children.forEach((function(e){const t=bl.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new _;else{let e;e=void 0===n.LightType?0:n.LightType.value;let r=16777215;void 0!==n.Color&&(r=(new g).fromArray(n.Color.value));let s=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(s=0);let o=0;void 0!==n.FarAttenuationEnd&&(o=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const i=1;switch(e){case 0:t=new Te(r,s,o,i);break;case 1:t=new _e(r,s);break;case 2:let e=Math.PI/3;void 0!==n.InnerAngle&&(e=T.degToRad(n.InnerAngle.value));let a=0;void 0!==n.OuterAngle&&(a=T.degToRad(n.OuterAngle.value),a=Math.max(a,1)),t=new we(r,s,o,e,a,i);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new Te(r,s)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,s=null,o=null;const i=[];return e.children.forEach((function(e){t.has(e.ID)&&(s=t.get(e.ID)),n.has(e.ID)&&i.push(n.get(e.ID))})),i.length>1?o=i:i.length>0?o=i[0]:(o=new Ke({color:13421772}),i.push(o)),"color"in s.attributes&&i.forEach((function(e){e.vertexColors=!0})),s.FBX_Deformer?(r=new Be(s,o),r.normalizeSkinWeights()):r=new p(s,o),r}createCurve(e,t){const n=e.children.reduce((function(e,n){return t.has(n.ID)&&(e=t.get(n.ID)),e}),null),r=new d({color:3342591,linewidth:1});return new c(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?Fl(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&wl.get(e.ID).children.forEach((function(t){if("LookAtProperty"===t.relationship){const n=bl.Objects.Model[t.ID];if("Lcl_Translation"in n){const t=n.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(t),Tl.add(e.target)):e.lookAt((new C).fromArray(t))}}}))}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const s in e){const o=e[s];wl.get(parseInt(o.ID)).parents.forEach((function(e){if(t.has(e.ID)){const t=e.ID;wl.get(t).parents.forEach((function(e){n.has(e.ID)&&n.get(e.ID).bind(new Xe(o.bones),r[e.ID])}))}}))}}parsePoseNodes(){const e={};if("Pose"in bl.Objects){const t=bl.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach((function(t){e[t.Node]=(new Z).fromArray(t.Matrix.a)})):e[r.Node]=(new Z).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in bl&&"AmbientColor"in bl.GlobalSettings){const e=bl.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(0!==t||0!==n||0!==r){const e=new g(t,n,r);Tl.add(new qe(e,1))}}}}class Al{parse(e){const t=new Map;if("Geometry"in bl.Objects){const n=bl.Objects.Geometry;for(const r in n){const s=wl.get(parseInt(r)),o=this.parseGeometry(s,n[r],e);t.set(parseInt(r),o)}}return t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,s=[],o=e.parents.map((function(e){return bl.Objects.Model[e.ID]}));if(0===o.length)return;const i=e.children.reduce((function(e,t){return void 0!==r[t.ID]&&(e=r[t.ID]),e}),null);e.children.forEach((function(e){void 0!==n.morphTargets[e.ID]&&s.push(n.morphTargets[e.ID])}));const a=o[0],l={};"RotationOrder"in a&&(l.eulerOrder=Fl(a.RotationOrder.value)),"InheritType"in a&&(l.inheritType=parseInt(a.InheritType.value)),"GeometricTranslation"in a&&(l.translation=a.GeometricTranslation.value),"GeometricRotation"in a&&(l.rotation=a.GeometricRotation.value),"GeometricScaling"in a&&(l.scale=a.GeometricScaling.value);const c=Ul(l);return this.genGeometry(t,i,s,c)}genGeometry(e,t,n,r){const s=new u;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),i=this.genBuffers(o),a=new h(i.vertex,3);if(a.applyMatrix4(r),s.setAttribute("position",a),i.colors.length>0&&s.setAttribute("color",new h(i.colors,3)),t&&(s.setAttribute("skinIndex",new at(i.weightsIndices,4)),s.setAttribute("skinWeight",new h(i.vertexWeights,4)),s.FBX_Deformer=t),i.normal.length>0){const e=(new lt).getNormalMatrix(r),t=new h(i.normal,3);t.applyNormalMatrix(e),s.setAttribute("normal",t)}if(i.uvs.forEach((function(e,t){"uv2"===eo&&t++;const n=0===t?"uv":`uv${t}`;s.setAttribute(n,new h(i.uvs[t],2))})),o.material&&"AllSame"!==o.material.mappingType){let e=i.materialIndex[0],t=0;if(i.materialIndex.forEach((function(n,r){n!==e&&(s.addGroup(t,r-t,e),e=n,t=r)})),s.groups.length>0){const t=s.groups[s.groups.length-1],n=t.start+t.count;n!==i.materialIndex.length&&s.addGroup(n,i.materialIndex.length-n,e)}0===s.groups.length&&s.addGroup(0,i.materialIndex.length,i.materialIndex[0])}return this.addMorphTargets(s,e,n,r),s}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let t=0;for(;e.LayerElementUV[t];)e.LayerElementUV[t].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[t])),t++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(r,s){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:t,weight:e.weights[s]})}))}))),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,s=!1,o=[],i=[],a=[],l=[],c=[],u=[];const h=this;return e.vertexIndices.forEach((function(d,p){let m,f=!1;d<0&&(d=~d,f=!0);let g=[],v=[];if(o.push(3*d,3*d+1,3*d+2),e.color){const t=Rl(p,n,d,e.color);a.push(t[0],t[1],t[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach((function(e){v.push(e.weight),g.push(e.id)})),v.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const e=[0,0,0,0],t=[0,0,0,0];v.forEach((function(n,r){let s=n,o=g[r];t.forEach((function(t,n,r){if(s>t){r[n]=s,s=t;const i=e[n];e[n]=o,o=i}}))})),g=e,v=t}for(;v.length<4;)v.push(0),g.push(0);for(let e=0;e<4;++e)c.push(v[e]),u.push(g[e])}if(e.normal){const t=Rl(p,n,d,e.normal);i.push(t[0],t[1],t[2])}e.material&&"AllSame"!==e.material.mappingType&&(m=Rl(p,n,d,e.material)[0]),e.uv&&e.uv.forEach((function(e,t){const r=Rl(p,n,d,e);void 0===l[t]&&(l[t]=[]),l[t].push(r[0]),l[t].push(r[1])})),r++,f&&(h.genFace(t,e,o,m,i,a,l,c,u,r),n++,r=0,o=[],i=[],a=[],l=[],c=[],u=[])})),t}genFace(e,t,n,r,s,o,i,a,l,c){for(let u=2;u<c;u++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(u-1)]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[n[3*u]]),e.vertex.push(t.vertexPositions[n[3*u+1]]),e.vertex.push(t.vertexPositions[n[3*u+2]]),t.skeleton&&(e.vertexWeights.push(a[0]),e.vertexWeights.push(a[1]),e.vertexWeights.push(a[2]),e.vertexWeights.push(a[3]),e.vertexWeights.push(a[4*(u-1)]),e.vertexWeights.push(a[4*(u-1)+1]),e.vertexWeights.push(a[4*(u-1)+2]),e.vertexWeights.push(a[4*(u-1)+3]),e.vertexWeights.push(a[4*u]),e.vertexWeights.push(a[4*u+1]),e.vertexWeights.push(a[4*u+2]),e.vertexWeights.push(a[4*u+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(u-1)]),e.weightsIndices.push(l[4*(u-1)+1]),e.weightsIndices.push(l[4*(u-1)+2]),e.weightsIndices.push(l[4*(u-1)+3]),e.weightsIndices.push(l[4*u]),e.weightsIndices.push(l[4*u+1]),e.weightsIndices.push(l[4*u+2]),e.weightsIndices.push(l[4*u+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(u-1)]),e.colors.push(o[3*(u-1)+1]),e.colors.push(o[3*(u-1)+2]),e.colors.push(o[3*u]),e.colors.push(o[3*u+1]),e.colors.push(o[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[3*(u-1)]),e.normal.push(s[3*(u-1)+1]),e.normal.push(s[3*(u-1)+2]),e.normal.push(s[3*u]),e.normal.push(s[3*u+1]),e.normal.push(s[3*u+2])),t.uv&&t.uv.forEach((function(t,n){void 0===e.uvs[n]&&(e.uvs[n]=[]),e.uvs[n].push(i[n][0]),e.uvs[n].push(i[n][1]),e.uvs[n].push(i[n][2*(u-1)]),e.uvs[n].push(i[n][2*(u-1)+1]),e.uvs[n].push(i[n][2*u]),e.uvs[n].push(i[n][2*u+1])}))}addMorphTargets(e,t,n,r){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const o=bl.Objects.Geometry[n.geoID];void 0!==o&&s.genMorphGeometry(e,t,o,r,n.name)}))}))}genMorphGeometry(e,t,n,r,s){const o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],i=void 0!==n.Vertices?n.Vertices.a:[],a=void 0!==n.Indexes?n.Indexes.a:[],l=3*e.attributes.position.count,c=new Float32Array(l);for(let h=0;h<a.length;h++){const e=3*a[h];c[e]=i[3*h],c[e+1]=i[3*h+1],c[e+2]=i[3*h+2]}const u={vertexIndices:o,vertexPositions:c},d=this.genBuffers(u),p=new h(d.vertex,3);p.name=s||n.attrName,p.applyMatrix4(r),e.morphAttributes.position.push(p)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let s=[];return"IndexToDirect"===n&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:s,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let s=[];return"IndexToDirect"===n&&(s=e.UVIndex.a),{dataSize:2,buffer:r,indices:s,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let s=[];return"IndexToDirect"===n&&(s=e.ColorIndex.a),{dataSize:4,buffer:r,indices:s,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:n}}parseNurbsGeometry(e){if(void 0===xl)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new u;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new u;const n=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let c=0,u=o.length;c<u;c+=4)s.push((new Y).fromArray(o,c));let i,a;if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){i=n,a=r.length-1-i;for(let e=0;e<n;++e)s.push(s[e])}const l=new xl(n,r,s,i,a).getPoints(12*s.length);return(new u).setFromPoints(l)}}class Ml{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const r=t[n],s=this.addClip(r);e.push(s)}return e}parseClips(){if(void 0===bl.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=bl.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const e={id:r.id,attr:r.attrName,curves:{}};t.set(e.id,e)}}return t}parseAnimationCurves(e){const t=bl.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(Ll),values:t[n].KeyValueFloat.a},s=wl.get(r.id);if(void 0!==s){const t=s.parents[0].ID,n=s.parents[0].relationship;n.match(/X/)?e.get(t).curves.x=r:n.match(/Y/)?e.get(t).curves.y=r:n.match(/Z/)?e.get(t).curves.z=r:n.match(/d|DeformPercent/)&&e.has(t)&&(e.get(t).curves.morph=r)}}}parseAnimationLayers(e){const t=bl.Objects.AnimationLayer,n=new Map;for(const r in t){const t=[],s=wl.get(parseInt(r));void 0!==s&&(s.children.forEach((function(n,r){if(e.has(n.ID)){const s=e.get(n.ID);if(void 0!==s.curves.x||void 0!==s.curves.y||void 0!==s.curves.z){if(void 0===t[r]){const e=wl.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID;if(void 0!==e){const s=bl.Objects.Model[e.toString()];if(void 0===s)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const o={modelName:s.attrName?ze.sanitizeNodeName(s.attrName):"",ID:s.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Tl.traverse((function(e){e.ID===s.id&&(o.transform=e.matrix,e.userData.transformData&&(o.eulerOrder=e.userData.transformData.eulerOrder))})),o.transform||(o.transform=new Z),"PreRotation"in s&&(o.preRotation=s.PreRotation.value),"PostRotation"in s&&(o.postRotation=s.PostRotation.value),t[r]=o}}t[r]&&(t[r][s.attr]=s)}else if(void 0!==s.curves.morph){if(void 0===t[r]){const e=wl.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,s=wl.get(e).parents[0].ID,o=wl.get(s).parents[0].ID,i=wl.get(o).parents[0].ID,a=bl.Objects.Model[i],l={modelName:a.attrName?ze.sanitizeNodeName(a.attrName):"",morphName:bl.Objects.Deformer[e].attrName};t[r]=l}t[r][s.attr]=s}}})),n.set(parseInt(r),t))}return n}parseAnimStacks(e){const t=bl.Objects.AnimationStack,n={};for(const r in t){const s=wl.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);n[r]={name:t[r].attrName,layer:o}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach((function(e){t=t.concat(n.generateTracks(e))})),new Ye(e.name,-1,t)}generateTracks(e){const t=[];let n=new C,r=new X,s=new C;if(e.transform&&e.transform.decompose(n,r,s),n=n.toArray(),r=(new ie).setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==r&&t.push(r)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const n=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==n&&t.push(n)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const n=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");void 0!==n&&t.push(n)}if(void 0!==e.DeformPercent){const n=this.generateMorphTrack(e);void 0!==n&&t.push(n)}return t}generateVectorTrack(e,t,n,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,n);return new $e(e+"."+r,s,o)}generateRotationTrack(e,t,n,r,s,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(T.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(T.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(T.degToRad));const i=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(i,t,n);void 0!==r&&((r=r.map(T.degToRad)).push(o),r=(new ie).fromArray(r),r=(new X).setFromEuler(r)),void 0!==s&&((s=s.map(T.degToRad)).push(o),s=(new ie).fromArray(s),s=(new X).setFromEuler(s).invert());const l=new X,c=new ie,u=[];for(let h=0;h<a.length;h+=3)c.set(a[h],a[h+1],a[h+2],o),l.setFromEuler(c),void 0!==r&&l.premultiply(r),void 0!==s&&l.multiply(s),l.toArray(u,h/3*4);return new tt(e+".quaternion",i,u)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map((function(e){return e/100})),r=Tl.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new et(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort((function(e,t){return e-t})),t.length>1){let e=1,n=t[0];for(let r=1;r<t.length;r++){const s=t[r];s!==n&&(t[e]=s,n=s,e++)}t=t.slice(0,e)}return t}getKeyframeTrackValues(e,t,n){const r=n,s=[];let o=-1,i=-1,a=-1;return e.forEach((function(e){if(t.x&&(o=t.x.times.indexOf(e)),t.y&&(i=t.y.times.indexOf(e)),t.z&&(a=t.z.times.indexOf(e)),-1!==o){const e=t.x.values[o];s.push(e),r[0]=e}else s.push(r[0]);if(-1!==i){const e=t.y.values[i];s.push(e),r[1]=e}else s.push(r[1]);if(-1!==a){const e=t.z.values[a];s.push(e),r[2]=e}else s.push(r[2])})),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,s=Math.abs(r);if(s>=180){const o=s/180,i=r/o;let a=n+i;const l=e.times[t-1],c=(e.times[t]-l)/o;let u=l+c;const h=[],d=[];for(;u<e.times[t];)h.push(u),u+=c,d.push(a),a+=i;e.times=jl(e.times,t,h),e.values=jl(e.values,t,d)}}}}class Sl{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new Pl,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach((function(e,r){const s=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(s||o)return;const i=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),a=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");i?t.parseNodeBegin(e,i):a?t.parseNodeProperty(e,a,n[++r]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)})),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),s={name:n},o=this.parseNodeAttr(r),i=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,s):n in i?("PoseNode"===n?i.PoseNode.push(s):void 0!==i[n].id&&(i[n]={},i[n][i[n].id]=i[n]),""!==o.id&&(i[n][o.id]=s)):"number"==typeof o.id?(i[n]={},i[n][o.id]=s):"Properties70"!==n&&(i[n]="PoseNode"===n?[s]:s),"number"==typeof o.id&&(s.id=o.id),""!==o.name&&(s.attrName=o.name),""!==o.type&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===s&&(s=n.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){const e=s.split(",").slice(1),t=parseInt(e[0]),n=parseInt(e[1]);let i=s.split(",").slice(3);i=i.map((function(e){return e.trim().replace(/^"/,"")})),r="connections",s=[t,n],function(e,t){for(let n=0,r=e.length,s=t.length;n<s;n++,r++)e[r]=t[n]}(s,i),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):"a"!==r?o[r]=s:o.a=s,this.setCurrentProp(o,r),"a"===r&&","!==s.slice(-1)&&(o.a=zl(s))}else this.parseNodeSpecialProperty(e,r,s)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=zl(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),s=r[0],o=r[1],i=r[2],a=r[3];let l=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=zl(l)}this.getPrevNode()[s]={type:o,type2:i,flag:a,value:l},this.setCurrentProp(this.getPrevNode(),s)}}class Cl{parse(e){const t=new Ol(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new Pl;for(;!this.endOfContent(t);){const e=this.parseNode(t,n);null!==e&&r.add(e.name,e)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),i=e.getString(o);if(0===r)return null;const a=[];for(let h=0;h<s;h++)a.push(this.parseProperty(e));const l=a.length>0?a[0]:"",c=a.length>1?a[1]:"",u=a.length>2?a[2]:"";for(n.singleProperty=1===s&&e.getOffset()===r;r>e.getOffset();){const r=this.parseNode(e,t);null!==r&&this.parseSubNode(i,n,r)}return n.propertyList=a,"number"==typeof l&&(n.id=l),""!==c&&(n.attrName=c),""!==u&&(n.attrType=u),""!==i&&(n.name=i),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const e=n.propertyList[0];Array.isArray(e)?(t[n.name]=n,n.a=e):t[n.name]=e}else if("Connections"===e&&"C"===n.name){const e=[];n.propertyList.forEach((function(t,n){0!==n&&e.push(t)})),void 0===t.connections&&(t.connections=[]),t.connections.push(e)}else if("Properties70"===n.name)Object.keys(n).forEach((function(e){t[e]=n[e]}));else if("Properties70"===e&&"P"===n.name){let e=n.propertyList[0],r=n.propertyList[1];const s=n.propertyList[2],o=n.propertyList[3];let i;0===e.indexOf("Lcl ")&&(e=e.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),i="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[e]={type:r,type2:s,flag:o,value:i}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(0===s)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const i=function(e,t){return Mi((function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"}(e),e.subarray(2,-4)),t)}(new Uint8Array(e.getArrayBuffer(o))),a=new Ol(i.buffer);switch(t){case"b":case"c":return a.getBooleanArray(r);case"d":return a.getFloat64Array(r);case"f":return a.getFloat32Array(r);case"i":return a.getInt32Array(r);case"l":return a.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class Ol{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return!(1&~this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),da(new Uint8Array(t))}}class Pl{add(e,t){this[e]=t}}function Il(e){const t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Ll(e){return e/46186158e3}const Dl=[];function Rl(e,t,n,r){let s;switch(r.mappingType){case"ByPolygonVertex":s=e;break;case"ByPolygon":s=t;break;case"ByVertice":s=n;break;case"AllSame":s=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(s=r.indices[s]);const o=s*r.dataSize,i=o+r.dataSize;return function(e,t,n,r){for(let s=n,o=0;s<r;s++,o++)e[o]=t[s];return e}(Dl,r.buffer,o,i)}const kl=new ie,Nl=new C;function Ul(e){const t=new Z,n=new Z,r=new Z,s=new Z,o=new Z,i=new Z,a=new Z,l=new Z,c=new Z,u=new Z,h=new Z,d=new Z,p=e.inheritType?e.inheritType:0;if(e.translation&&t.setPosition(Nl.fromArray(e.translation)),e.preRotation){const t=e.preRotation.map(T.degToRad);t.push(e.eulerOrder),n.makeRotationFromEuler(kl.fromArray(t))}if(e.rotation){const t=e.rotation.map(T.degToRad);t.push(e.eulerOrder),r.makeRotationFromEuler(kl.fromArray(t))}if(e.postRotation){const t=e.postRotation.map(T.degToRad);t.push(e.eulerOrder),s.makeRotationFromEuler(kl.fromArray(t)),s.invert()}e.scale&&o.scale(Nl.fromArray(e.scale)),e.scalingOffset&&a.setPosition(Nl.fromArray(e.scalingOffset)),e.scalingPivot&&i.setPosition(Nl.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(Nl.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(Nl.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(h.copy(e.parentMatrix),u.copy(e.parentMatrixWorld));const m=n.clone().multiply(r).multiply(s),f=new Z;f.extractRotation(u);const g=new Z;g.copyPosition(u);const v=g.clone().invert().multiply(u),y=f.clone().invert().multiply(v),x=o,b=new Z;if(0===p)b.copy(f).multiply(m).multiply(y).multiply(x);else if(1===p)b.copy(f).multiply(y).multiply(m).multiply(x);else{const e=(new Z).scale((new C).setFromMatrixScale(h)).clone().invert(),t=y.clone().multiply(e);b.copy(f).multiply(m).multiply(t).multiply(x)}const w=c.clone().invert(),_=i.clone().invert();let E=t.clone().multiply(l).multiply(c).multiply(n).multiply(r).multiply(s).multiply(w).multiply(a).multiply(i).multiply(o).multiply(_);const A=(new Z).copyPosition(E),M=u.clone().multiply(A);return d.copyPosition(M),E=d.clone().multiply(b),E.premultiply(u.invert()),E}function Fl(e){const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function zl(e){return e.split(",").map((function(e){return parseFloat(e)}))}function Bl(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.byteLength),da(new Uint8Array(e,t,n))}function jl(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))}var Hl=Object.defineProperty,Vl=(e,t,n)=>(((e,t,n)=>{t in e?Hl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Xl extends ne{constructor(e){super(e)}load(e,t,n,r){const s=new re(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(e=>{if("string"!=typeof e)throw new Error("unsupported data type");const n=JSON.parse(e),r=this.parse(n);t&&t(r)}),n,r)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new Yl(e)}}class Yl{constructor(e){Vl(this,"data"),this.data=e}generateShapes(e,t=100,n){const r=[],s={letterSpacing:0,lineHeight:1,...n},o=function(e,t,n,r){const s=Array.from(e),o=t/n.resolution,i=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,a=[];let l=0,c=0;for(let u=0;u<s.length;u++){const e=s[u];if("\n"===e)l=0,c-=i*r.lineHeight;else{const t=Wl(e,o,l,c,n);t&&(l+=t.offsetX+r.letterSpacing,a.push(t.path))}}return a}(e,t,this.data,s);for(let i=0,a=o.length;i<a;i++)Array.prototype.push.apply(r,o[i].toShapes(!1));return r}}function Wl(e,t,n,r,s){const o=s.glyphs[e]||s.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+s.familyName+".");const i=new xe;let a,l,c,u,h,d,p,m;if(o.o){const e=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let s=0,o=e.length;s<o;)switch(e[s++]){case"m":a=parseInt(e[s++])*t+n,l=parseInt(e[s++])*t+r,i.moveTo(a,l);break;case"l":a=parseInt(e[s++])*t+n,l=parseInt(e[s++])*t+r,i.lineTo(a,l);break;case"q":c=parseInt(e[s++])*t+n,u=parseInt(e[s++])*t+r,h=parseInt(e[s++])*t+n,d=parseInt(e[s++])*t+r,i.quadraticCurveTo(h,d,c,u);break;case"b":c=parseInt(e[s++])*t+n,u=parseInt(e[s++])*t+r,h=parseInt(e[s++])*t+n,d=parseInt(e[s++])*t+r,p=parseInt(e[s++])*t+n,m=parseInt(e[s++])*t+r,i.bezierCurveTo(h,d,p,m,c,u)}}return{offsetX:o.ha*t,path:i}}Vl(Yl,"isFont"),Vl(Yl,"type");class Gl extends ue{constructor(e){super(e),this.type=U}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,n){t=t||1024;let r=e.pos,s=-1,o=0,i="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(s=a.indexOf("\n"))&&o<t&&r<e.byteLength;)i+=a,o+=a.length,r+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<s&&(e.pos+=o+s+1,i+a.slice(0,s))},r=function(e,t,n,r){const s=e[t+3],o=Math.pow(2,s-128)/255;n[r+0]=e[t+0]*o,n[r+1]=e[t+1]*o,n[r+2]=e[t+2]*o,n[r+3]=1},s=function(e,t,n,r){const s=e[t+3],o=Math.pow(2,s-128)/255;n[r+0]=ge.toHalfFloat(Math.min(e[t+0]*o,65504)),n[r+1]=ge.toHalfFloat(Math.min(e[t+1]*o,65504)),n[r+2]=ge.toHalfFloat(Math.min(e[t+2]*o,65504)),n[r+3]=ge.toHalfFloat(1)},o=new Uint8Array(e);o.pos=0;const i=function(e){const r=/^#\?(\S+)/,s=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let c,u;for((e.pos>=e.byteLength||!(c=n(e)))&&t(1,"no header found"),(u=c.match(r))||t(3,"bad initial token"),l.valid|=1,l.programtype=u[1],l.string+=c+"\n";c=n(e),!1!==c;)if(l.string+=c+"\n","#"!==c.charAt(0)){if((u=c.match(s))&&(l.gamma=parseFloat(u[1])),(u=c.match(o))&&(l.exposure=parseFloat(u[1])),(u=c.match(i))&&(l.valid|=2,l.format=u[1]),(u=c.match(a))&&(l.valid|=4,l.height=parseInt(u[1],10),l.width=parseInt(u[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=c+"\n";return 2&l.valid||t(3,"missing format specifier"),4&l.valid||t(3,"missing image size specifier"),l}(o),a=i.width,l=i.height,c=function(e,n,r){const s=n;if(s<8||s>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);s!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const o=new Uint8Array(4*n*r);o.length||t(4,"unable to allocate buffer space");let i=0,a=0;const l=4*s,c=new Uint8Array(4),u=new Uint8Array(l);let h=r;for(;h>0&&a<e.byteLength;){a+4>e.byteLength&&t(1),c[0]=e[a++],c[1]=e[a++],c[2]=e[a++],c[3]=e[a++],(2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=s)&&t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&a<e.byteLength;){n=e[a++];const s=n>128;if(s&&(n-=128),(0===n||r+n>l)&&t(3,"bad scanline data"),s){const t=e[a++];for(let e=0;e<n;e++)u[r++]=t}else u.set(e.subarray(a,a+n),r),r+=n,a+=n}const d=s;for(let e=0;e<d;e++){let t=0;o[i]=u[e+t],t+=s,o[i+1]=u[e+t],t+=s,o[i+2]=u[e+t],t+=s,o[i+3]=u[e+t],i+=4}h--}return o}(o.subarray(o.pos),a,l);let u,h,d;switch(this.type){case he:d=c.length/4;const e=new Float32Array(4*d);for(let n=0;n<d;n++)r(c,4*n,e,4*n);u=e,h=he;break;case U:d=c.length/4;const t=new Uint16Array(4*d);for(let n=0;n<d;n++)s(c,4*n,t,4*n);u=t,h=U;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:a,height:l,data:u,header:i.string,gamma:i.gamma,exposure:i.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,(function(e,n){switch(e.type){case he:case U:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=ve,e.magFilter=ve,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),n,r)}}const Zl=new WeakMap;class Kl extends ne{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new re(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(r)}),n,r)}decodeDracoFile(e,t,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const a in t.attributeTypes){const e=t.attributeTypes[a];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[a]=e.name)}const n=JSON.stringify(t);if(Zl.has(e)){const t=Zl.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,i=this._getWorker(s,o).then((n=>(r=n,new Promise(((n,o)=>{r._callbacks[s]={resolve:n,reject:o},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return i.catch((()=>!0)).then((()=>{r&&s&&this._releaseTask(r,s)})),Zl.set(e,{key:n,promise:i}),i}_createGeometry(e){const t=new u;e.index&&t.setIndex(new E(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,o=r.array,i=r.itemSize;t.setAttribute(s,new E(o,i))}return t}_loadLibrary(e,t){const n=new re(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,r)=>{n.load(e,t,void 0,r)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=Ql.toString(),s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Ql(){let e,t;function n(e,t,n,r,s,o){const i=o.num_components(),a=n.num_points()*i,l=a*s.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,s),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,o,c,l,u);const h=new s(e.HEAPF32.buffer,u,a).slice();return e._free(u),{name:r,array:h,itemSize:i}}onmessage=function(r){const s=r.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const r=s.buffer,o=s.taskConfig;t.then((e=>{const t=e.draco,i=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(r),r.byteLength);try{const e=function(e,t,r,s){const o=s.attributeIDs,i=s.attributeTypes;let a,l;const c=t.GetEncodedGeometryType(r);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,l=t.DecodeBufferToMesh(r,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,l=t.DecodeBufferToPointCloud(r,a)}if(!l.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const u={index:null,attributes:[]};for(const h in o){const r=self[i[h]];let l,c;if(s.useUniqueIDs)c=o[h],l=t.GetAttributeByUniqueId(a,c);else{if(c=t.GetAttributeId(a,e[o[h]]),-1===c)continue;l=t.GetAttribute(a,c)}u.attributes.push(n(e,t,a,h,r,l))}return c===e.TRIANGULAR_MESH&&(u.index=function(e,t,n){const r=3*n.num_faces(),s=4*r,o=e._malloc(s);t.GetTrianglesUInt32Array(n,s,o);const i=new Uint32Array(e.HEAPF32.buffer,o,r).slice();return e._free(o),{array:i,itemSize:1}}(e,t,a)),e.destroy(a),u}(t,i,a,o),r=e.attributes.map((e=>e.array.buffer));e.index&&r.push(e.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:e},r)}catch(Fd){console.error(Fd),self.postMessage({type:"error",id:s.id,error:Fd.message})}finally{t.destroy(a),t.destroy(i)}}))}}}new K,new C,new Y,new C,new C,new Y,new Y,new Y,new C,new Z,new ht,new C,new K,new G,new Y,T.clamp,T.lerp;const ql=It({__name:"Levioso",props:{speed:{default:1},rotationFactor:{default:1},floatFactor:{default:1},range:{default:()=>[-.1,.1]}},setup(e,{expose:t}){const n=e,r=Dt();t({instance:r});{const e=1e4*Math.random(),{onBeforeRender:t}=Qr();let s=e;t((({delta:e,invalidate:t})=>{if(!r.value)return;s+=e*n.speed;const o=.25*s,i=r.value;i.rotation.x=.125*Math.cos(o)*n.rotationFactor,i.rotation.y=.125*Math.sin(o)*n.rotationFactor,i.rotation.z=.05*Math.sin(o)*n.rotationFactor,i.position.y=T.mapLinear(Math.sin(o),-1,1,n.range[0],n.range[1])*n.floatFactor,t()}))}return(e,t)=>(Ft(),Rt("TresGroup",tn(e.$attrs,{ref_key:"groupRef",ref:r}),[en(e.$slots,"default")],16))}});Js({screenspace:!1,color:new g("black"),opacity:1,thickness:.05,size:new S(1,1)},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   uniform float thickness;\n   uniform bool screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n       #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n     #include <morphtarget_vertex>\n     #include <skinning_vertex>\n     #include <project_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }","uniform vec3 color;\n   uniform float opacity;\n   void main(){\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <colorspace_fragment>\n   }");Ii.ReflectorShader;const Jl=["args","center"],$l=It({__name:"Text3D",props:{font:{},text:{},size:{default:.5},height:{default:.2},curveSegments:{default:5},bevelEnabled:{type:Boolean,default:!0},bevelThickness:{default:.05},bevelSize:{default:.02},bevelOffset:{default:0},bevelSegments:{default:4},center:{type:Boolean,default:!1},needUpdates:{type:Boolean,default:!1}},async setup(e,{expose:t}){let n,r;const s=e,{center:o,font:i,text:a,needUpdates:l,size:c,height:u,curveSegments:h,bevelEnabled:d,bevelThickness:p,bevelSize:m,bevelOffset:f,bevelSegments:g}=Jt(s),{extend:v,invalidate:y}=Kr();Nt(s,(()=>y())),v({TextGeometry:pl});const x=new Xl,b=Lt(),w=Wt((()=>{var e;return null!=a&&a.value?a.value:b.default?null==(e=b.default()[0].children)?void 0:e.trim():l.value?"":"TresJS"})),T=Dt();t({instance:T});const _=([n,r]=an((()=>new Promise(((e,t)=>{try{"string"==typeof i.value?x.load(i.value,(t=>{e(t)})):e(i.value)}catch(n){t(console.error("cientos",n))}})))),n=await n,r(),n),E=Wt((()=>({font:_,size:cn(c),height:cn(u),curveSegments:cn(h),bevelEnabled:cn(d),bevelThickness:cn(p),bevelSize:cn(m),bevelOffset:cn(f),bevelSegments:cn(g)})));return Xt((()=>{T.value&&l.value&&(T.value.geometry.dispose(),T.value.geometry=new pl(w.value,E.value),o.value&&T.value.geometry.center())})),(e,t)=>Bt(i)?(Ft(),Rt("TresMesh",{key:0,ref_key:"text3DRef",ref:T},[w.value?(Ft(),Rt("TresTextGeometry",{key:0,args:[w.value,E.value],center:Bt(o)},null,8,Jl)):$t("",!0),en(e.$slots,"default")],512)):$t("",!0)}});function ec(e,t){const n=Ot(t),r=new z(n.value),s=un({});e.forEach((e=>{const t=r.clipAction(e,n.value);s[e.name]=t}));const{onBeforeRender:o}=Qr();return o((({delta:e})=>{r.update(e)})),{actions:s,mixer:r}}new C,new C,new C;const tc={sunset:"venice/venice_sunset_1k.hdr",studio:"studio/poly_haven_studio_1k.hdr",city:"city/canary_wharf_1k.hdr",umbrellas:"outdoor/outdoor_umbrellas_1k.hdr",night:"outdoor/satara_night_1k.hdr",forest:"outood/mossy_forest_1k.hdr",snow:"outdoor/snowy_forest_path_01_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",hangar:"indoor/small_hangar_01_1k.hdr",urban:"indoor/abandoned_games_room_02_1k.hdr",modern:"city/modern_buildings_2_1k.hdr",shangai:"city/shanghai_bund_1k.hdr"};function nc(e){return e instanceof ie?e:Array.isArray(e)?new ie(e[0],e[1],e[2]):"number"==typeof e?new ie(e,e,e):e instanceof C||"object"==typeof e&&"x"in e&&"y"in e&&"z"in e?new ie(e.x,e.y,e.z):null}function rc(e){e.traverse((e=>{e instanceof p&&e.material&&(e.material.needsUpdate=!0)}))}
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */
const sc=1,oc=2,ic=4,ac=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),lc=0,cc=1,uc=-1;function hc(e){return e.isPerspectiveCamera}function dc(e){return e.isOrthographicCamera}const pc=2*Math.PI,mc=Math.PI/2,fc=1e-5,gc=Math.PI/180;function vc(e,t,n){return Math.max(t,Math.min(n,e))}function yc(e,t=fc){return Math.abs(e)<t}function xc(e,t,n=fc){return yc(e-t,n)}function bc(e,t){return Math.round(e/t)*t}function wc(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Tc(e){return Math.abs(e)<Number.MAX_VALUE?e:e*(1/0)}function _c(e,t,n,r,s=1/0,o){const i=2/(r=Math.max(1e-4,r)),a=i*o,l=1/(1+a+.48*a*a+.235*a*a*a);let c=e-t;const u=t,h=s*r;c=vc(c,-h,h),t=e-c;const d=(n.value+i*c)*o;n.value=(n.value-i*d)*l;let p=t+(c+d)*l;return u-e>0==p>u&&(p=u,n.value=(p-u)/o),p}function Ec(e,t,n,r,s=1/0,o,i){const a=2/(r=Math.max(1e-4,r)),l=a*o,c=1/(1+l+.48*l*l+.235*l*l*l);let u=t.x,h=t.y,d=t.z,p=e.x-u,m=e.y-h,f=e.z-d;const g=u,v=h,y=d,x=s*r,b=p*p+m*m+f*f;if(b>x*x){const e=Math.sqrt(b);p=p/e*x,m=m/e*x,f=f/e*x}u=e.x-p,h=e.y-m,d=e.z-f;const w=(n.x+a*p)*o,T=(n.y+a*m)*o,_=(n.z+a*f)*o;n.x=(n.x-a*w)*c,n.y=(n.y-a*T)*c,n.z=(n.z-a*_)*c,i.x=u+(p+w)*c,i.y=h+(m+T)*c,i.z=d+(f+_)*c;const E=g-e.x,A=v-e.y,M=y-e.z;return E*(i.x-g)+A*(i.y-v)+M*(i.z-y)>0&&(i.x=g,i.y=v,i.z=y,n.x=(i.x-g)/o,n.y=(i.y-v)/o,n.z=(i.z-y)/o),i}function Ac(e,t){t.set(0,0),e.forEach((e=>{t.x+=e.clientX,t.y+=e.clientY})),t.x/=e.length,t.y/=e.length}function Mc(e,t){return!!dc(e)&&(console.warn(`${t} is not supported in OrthographicCamera`),!0)}class Sc{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}removeAllEventListeners(e){e?Array.isArray(this._listeners[e])&&(this._listeners[e].length=0):this._listeners={}}dispatchEvent(e){const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e)}}}var Cc;const Oc=1/8,Pc=/Mac/.test(null===(Cc=null==globalThis?void 0:globalThis.navigator)||void 0===Cc?void 0:Cc.platform);let Ic,Lc,Dc,Rc,kc,Nc,Uc,Fc,zc,Bc,jc,Hc,Vc,Xc,Yc,Wc,Gc,Zc,Kc,Qc,qc,Jc,$c,eu=class e extends Sc{static install(e){Ic=e.THREE,Lc=Object.freeze(new Ic.Vector3(0,0,0)),Dc=Object.freeze(new Ic.Vector3(0,1,0)),Rc=Object.freeze(new Ic.Vector3(0,0,1)),kc=new Ic.Vector2,Nc=new Ic.Vector3,Uc=new Ic.Vector3,Fc=new Ic.Vector3,zc=new Ic.Vector3,Bc=new Ic.Vector3,jc=new Ic.Vector3,Hc=new Ic.Vector3,Vc=new Ic.Vector3,Xc=new Ic.Vector3,Yc=new Ic.Spherical,Wc=new Ic.Spherical,Gc=new Ic.Box3,Zc=new Ic.Box3,Kc=new Ic.Sphere,Qc=new Ic.Quaternion,qc=new Ic.Quaternion,Jc=new Ic.Matrix4,$c=new Ic.Raycaster}static get ACTION(){return ac}constructor(t,n){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=ac.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=lc,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Ic.Vector3,this._focalOffsetVelocity=new Ic.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,n)=>{let r,s;if(hc(this._camera)){const n=Nc.copy(this._camera.position).sub(this._target),o=this._camera.getEffectiveFOV()*gc,i=n.length()*Math.tan(.5*o);r=this.truckSpeed*e*i/this._elementRect.height,s=this.truckSpeed*t*i/this._elementRect.height}else{if(!dc(this._camera))return;{const n=this._camera;r=e*(n.right-n.left)/n.zoom/this._elementRect.width,s=t*(n.top-n.bottom)/n.zoom/this._elementRect.height}}this.verticalDragToForward?(n?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(r,0,!0),this.forward(-s,!0)):n?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+s,this._focalOffsetEnd.z,!0):this.truck(r,s,!0)},this._rotateInternal=(e,t)=>{const n=pc*this.azimuthRotateSpeed*e/this._elementRect.height,r=pc*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(n,r,!0)},this._dollyInternal=(e,t,n)=>{const r=Math.pow(.95,-e*this.dollySpeed),s=this._sphericalEnd.radius,o=this._sphericalEnd.radius*r,i=vc(o,this.minDistance,this.maxDistance),a=i-o;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(o,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(a,!0),this._dollyToNoClamp(i,!0)):this._dollyToNoClamp(i,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?o:i)-s,this._dollyControlCoord.set(t,n)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,n)=>{const r=Math.pow(.95,e*this.dollySpeed),s=this._zoom,o=this._zoom*r;this.zoomTo(o,!0),this.dollyToCursor&&(this._changedZoom+=o-s,this._dollyControlCoord.set(t,n))},typeof Ic>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=(new Ic.Quaternion).setFromUnitVectors(this._camera.up,Dc),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=ac.NONE,this._target=new Ic.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Ic.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new Ic.Spherical).setFromVector3(Nc.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Ic.Vector3,new Ic.Vector3,new Ic.Vector3,new Ic.Vector3],this._updateNearPlaneCorners(),this._boundary=new Ic.Box3(new Ic.Vector3(-1/0,-1/0,-1/0),new Ic.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Ic.Vector2,this.mouseButtons={left:ac.ROTATE,middle:ac.DOLLY,right:ac.TRUCK,wheel:hc(this._camera)?ac.DOLLY:dc(this._camera)?ac.ZOOM:ac.NONE},this.touches={one:ac.TOUCH_ROTATE,two:hc(this._camera)?ac.TOUCH_DOLLY_TRUCK:dc(this._camera)?ac.TOUCH_ZOOM_TRUCK:ac.NONE,three:ac.TOUCH_TRUCK};const r=new Ic.Vector2,s=new Ic.Vector2,o=new Ic.Vector2,i=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}const t="mouse"!==e.pointerType?null:(e.buttons&sc)===sc?sc:(e.buttons&ic)===ic?ic:(e.buttons&oc)===oc?oc:null;if(null!==t){const e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&sc)===sc&&this._lockedPointer)return;const n={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(n),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),this._isDragging=!0,d(e)},a=e=>{e.cancelable&&e.preventDefault();const t=e.pointerId,n=this._lockedPointer||this._findPointerById(t);if(n){if(n.clientX=e.clientX,n.clientY=e.clientY,n.deltaX=e.movementX,n.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&sc)===sc)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&ic)===ic&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&oc)===oc&&(this._state=this._state|this.mouseButtons.right);p()}},l=e=>{const t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=ac.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=ac.NONE;m()}};let c=-1;const u=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===ac.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===ac.ROTATE||this.mouseButtons.wheel===ac.TRUCK){const e=performance.now();c-e<1e3&&this._getClientRect(this._elementRect),c=e}const t=Pc?-1:-3,n=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),r=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?(e.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case ac.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case ac.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case ac.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case ac.DOLLY:this._dollyInternal(-n,r,s),this._isUserControllingDolly=!0;break;case ac.ZOOM:this._zoomInternal(-n,r,s),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},h=t=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===e.ACTION.NONE){const e=t instanceof PointerEvent?t.pointerId:0,n=this._findPointerById(e);return n&&this._disposePointer(n),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),void this._domElement.ownerDocument.removeEventListener("pointerup",l)}t.preventDefault()}},d=e=>{if(this._enabled){if(Ac(this._activePointers,kc),this._getClientRect(this._elementRect),r.copy(kc),s.copy(kc),this._activePointers.length>=2){const e=kc.x-this._activePointers[1].clientX,t=kc.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t);o.set(0,n);const r=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),i=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);s.set(r,i)}if(this._state=0,e)if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else!this._lockedPointer&&(e.buttons&sc)===sc&&(this._state=this._state|this.mouseButtons.left),(e.buttons&ic)===ic&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&oc)===oc&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&ac.ROTATE)===ac.ROTATE||(this._state&ac.TOUCH_ROTATE)===ac.TOUCH_ROTATE||(this._state&ac.TOUCH_DOLLY_ROTATE)===ac.TOUCH_DOLLY_ROTATE||(this._state&ac.TOUCH_ZOOM_ROTATE)===ac.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&ac.TRUCK)===ac.TRUCK||(this._state&ac.TOUCH_TRUCK)===ac.TOUCH_TRUCK||(this._state&ac.TOUCH_DOLLY_TRUCK)===ac.TOUCH_DOLLY_TRUCK||(this._state&ac.TOUCH_ZOOM_TRUCK)===ac.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&ac.DOLLY)===ac.DOLLY||(this._state&ac.TOUCH_DOLLY)===ac.TOUCH_DOLLY||(this._state&ac.TOUCH_DOLLY_TRUCK)===ac.TOUCH_DOLLY_TRUCK||(this._state&ac.TOUCH_DOLLY_OFFSET)===ac.TOUCH_DOLLY_OFFSET||(this._state&ac.TOUCH_DOLLY_ROTATE)===ac.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&ac.ZOOM)===ac.ZOOM||(this._state&ac.TOUCH_ZOOM)===ac.TOUCH_ZOOM||(this._state&ac.TOUCH_ZOOM_TRUCK)===ac.TOUCH_ZOOM_TRUCK||(this._state&ac.TOUCH_ZOOM_OFFSET)===ac.TOUCH_ZOOM_OFFSET||(this._state&ac.TOUCH_ZOOM_ROTATE)===ac.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&ac.OFFSET)===ac.OFFSET||(this._state&ac.TOUCH_OFFSET)===ac.TOUCH_OFFSET||(this._state&ac.TOUCH_DOLLY_OFFSET)===ac.TOUCH_DOLLY_OFFSET||(this._state&ac.TOUCH_ZOOM_OFFSET)===ac.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},p=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Ac(this._activePointers,kc);const e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:s.x-kc.x,n=e?-e.deltaY:s.y-kc.y;if(s.copy(kc),((this._state&ac.ROTATE)===ac.ROTATE||(this._state&ac.TOUCH_ROTATE)===ac.TOUCH_ROTATE||(this._state&ac.TOUCH_DOLLY_ROTATE)===ac.TOUCH_DOLLY_ROTATE||(this._state&ac.TOUCH_ZOOM_ROTATE)===ac.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,n),this._isUserControllingRotate=!0),(this._state&ac.DOLLY)===ac.DOLLY||(this._state&ac.ZOOM)===ac.ZOOM){const e=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0,s=this.dollyDragInverted?-1:1;(this._state&ac.DOLLY)===ac.DOLLY?(this._dollyInternal(s*n*Oc,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(s*n*Oc,e,t),this._isUserControllingZoom=!0)}if((this._state&ac.TOUCH_DOLLY)===ac.TOUCH_DOLLY||(this._state&ac.TOUCH_ZOOM)===ac.TOUCH_ZOOM||(this._state&ac.TOUCH_DOLLY_TRUCK)===ac.TOUCH_DOLLY_TRUCK||(this._state&ac.TOUCH_ZOOM_TRUCK)===ac.TOUCH_ZOOM_TRUCK||(this._state&ac.TOUCH_DOLLY_OFFSET)===ac.TOUCH_DOLLY_OFFSET||(this._state&ac.TOUCH_ZOOM_OFFSET)===ac.TOUCH_ZOOM_OFFSET||(this._state&ac.TOUCH_DOLLY_ROTATE)===ac.TOUCH_DOLLY_ROTATE||(this._state&ac.TOUCH_ZOOM_ROTATE)===ac.TOUCH_ZOOM_ROTATE){const e=kc.x-this._activePointers[1].clientX,t=kc.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t),r=o.y-n;o.set(0,n);const i=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&ac.TOUCH_DOLLY)===ac.TOUCH_DOLLY||(this._state&ac.TOUCH_DOLLY_ROTATE)===ac.TOUCH_DOLLY_ROTATE||(this._state&ac.TOUCH_DOLLY_TRUCK)===ac.TOUCH_DOLLY_TRUCK||(this._state&ac.TOUCH_DOLLY_OFFSET)===ac.TOUCH_DOLLY_OFFSET?(this._dollyInternal(r*Oc,i,a),this._isUserControllingDolly=!0):(this._zoomInternal(r*Oc,i,a),this._isUserControllingZoom=!0)}((this._state&ac.TRUCK)===ac.TRUCK||(this._state&ac.TOUCH_TRUCK)===ac.TOUCH_TRUCK||(this._state&ac.TOUCH_DOLLY_TRUCK)===ac.TOUCH_DOLLY_TRUCK||(this._state&ac.TOUCH_ZOOM_TRUCK)===ac.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,n,!1),this._isUserControllingTruck=!0),((this._state&ac.OFFSET)===ac.OFFSET||(this._state&ac.TOUCH_OFFSET)===ac.TOUCH_OFFSET||(this._state&ac.TOUCH_DOLLY_OFFSET)===ac.TOUCH_DOLLY_OFFSET||(this._state&ac.TOUCH_ZOOM_OFFSET)===ac.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,n,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},m=()=>{Ac(this._activePointers,kc),s.copy(kc),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",f),this._domElement.ownerDocument.addEventListener("pointerlockerror",g),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),d())},this.unlockPointer=()=>{var e,t,n;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",f),null===(n=this._domElement)||void 0===n||n.ownerDocument.removeEventListener("pointerlockerror",g),this.cancel()};const f=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},g=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",i),this._domElement.addEventListener("pointercancel",l),this._domElement.addEventListener("wheel",u,{passive:!1}),this._domElement.addEventListener("contextmenu",h)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",i),this._domElement.removeEventListener("pointercancel",l),this._domElement.removeEventListener("wheel",u,{passive:!1}),this._domElement.removeEventListener("contextmenu",h),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("pointerlockchange",f),this._domElement.ownerDocument.removeEventListener("pointerlockerror",g))},this.cancel=()=>{this._state!==ac.NONE&&(this._state=ac.NONE,this._activePointers.length=0,m())},n&&this.connect(n),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=vc(e.width,0,1),this._interactiveArea.height=vc(e.height,0,1),this._interactiveArea.x=vc(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=vc(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=vc(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=vc(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!n||xc(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&xc(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=lc,this._changedDolly=0,this._dollyToNoClamp(vc(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const t=this._collisionTest(),r=xc(t,this._spherical.radius);if(!(n>e)&&r)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||xc(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(zc).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||xc(this._target.x,this._targetEnd.x,this.restThreshold)&&xc(this._target.y,this._targetEnd.y,this.restThreshold)&&xc(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=vc(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||xc(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),Bc.setFromMatrixColumn(this._camera.matrix,0),jc.setFromMatrixColumn(this._camera.matrix,1),Bc.multiplyScalar(e),jc.multiplyScalar(-t);const r=Nc.copy(Bc).add(jc),s=Uc.copy(this._targetEnd).add(r);return this.moveTo(s.x,s.y,s.z,n)}forward(e,t=!1){Nc.setFromMatrixColumn(this._camera.matrix,0),Nc.crossVectors(this._camera.up,Nc),Nc.multiplyScalar(e);const n=Uc.copy(this._targetEnd).add(Nc);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return Nc.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Nc.x,this._targetEnd.y+Nc.y,this._targetEnd.z+Nc.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const s=Nc.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const o=!r||xc(this._target.x,this._targetEnd.x,this.restThreshold)&&xc(this._target.y,this._targetEnd.y,this.restThreshold)&&xc(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,n,r=!1){const s=Nc.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(s.x,s.y,s.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:s=0,paddingBottom:o=0,paddingTop:i=0}={}){const a=[],l=e.isBox3?Gc.copy(e):Gc.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=bc(this._sphericalEnd.theta,mc),u=bc(this._sphericalEnd.phi,mc);a.push(this.rotateTo(c,u,t));const h=Nc.setFromSpherical(this._sphericalEnd).normalize(),d=Qc.setFromUnitVectors(h,Rc),p=xc(Math.abs(h.y),1);p&&d.multiply(qc.setFromAxisAngle(Dc,c)),d.multiply(this._yAxisUpSpaceInverse);const m=Zc.makeEmpty();Uc.copy(l.min).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.min).setX(l.max.x).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.min).setY(l.max.y).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.max).setZ(l.min.z).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.min).setZ(l.max.z).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.max).setY(l.min.y).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.max).setX(l.min.x).applyQuaternion(d),m.expandByPoint(Uc),Uc.copy(l.max).applyQuaternion(d),m.expandByPoint(Uc),m.min.x-=r,m.min.y-=o,m.max.x+=s,m.max.y+=i,d.setFromUnitVectors(Rc,h),p&&d.premultiply(qc.invert()),d.premultiply(this._yAxisUpSpace);const f=m.getSize(Nc),g=m.getCenter(Uc).applyQuaternion(d);if(hc(this._camera)){const e=this.getDistanceToFitBox(f.x,f.y,f.z,n);a.push(this.moveTo(g.x,g.y,g.z,t)),a.push(this.dollyTo(e,t)),a.push(this.setFocalOffset(0,0,0,t))}else if(dc(this._camera)){const e=this._camera,r=e.right-e.left,s=e.top-e.bottom,o=n?Math.max(r/f.x,s/f.y):Math.min(r/f.x,s/f.y);a.push(this.moveTo(g.x,g.y,g.z,t)),a.push(this.zoomTo(o,t)),a.push(this.setFocalOffset(0,0,0,t))}return Promise.all(a)}fitToSphere(t,n){const r=[],s="isObject3D"in t?e.createBoundingSphere(t,Kc):Kc.copy(t);if(r.push(this.moveTo(s.center.x,s.center.y,s.center.z,n)),hc(this._camera)){const e=this.getDistanceToFitSphere(s.radius);r.push(this.dollyTo(e,n))}else if(dc(this._camera)){const e=this._camera.right-this._camera.left,t=this._camera.top-this._camera.bottom,o=2*s.radius,i=Math.min(e/o,t/o);r.push(this.zoomTo(i,n))}return r.push(this.setFocalOffset(0,0,0,n)),Promise.all(r)}setLookAt(e,t,n,r,s,o,i=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=lc,this._changedDolly=0;const a=Uc.set(r,s,o),l=Nc.set(e,t,n);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(l.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,i||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const c=!i||xc(this._target.x,this._targetEnd.x,this.restThreshold)&&xc(this._target.y,this._targetEnd.y,this.restThreshold)&&xc(this._target.z,this._targetEnd.z,this.restThreshold)&&xc(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&xc(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&xc(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,n,r,s,o,i,a,l,c,u,h,d,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=lc,this._changedDolly=0;const m=Nc.set(r,s,o),f=Uc.set(e,t,n);Yc.setFromVector3(f.sub(m).applyQuaternion(this._yAxisUpSpace));const g=Fc.set(c,u,h),v=Uc.set(i,a,l);Wc.setFromVector3(v.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(m.lerp(g,d));const y=Wc.theta-Yc.theta,x=Wc.phi-Yc.phi,b=Wc.radius-Yc.radius;this._sphericalEnd.set(Yc.radius+b*d,Yc.phi+x*d,Yc.theta+y*d),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const w=!p||xc(this._target.x,this._targetEnd.x,this.restThreshold)&&xc(this._target.y,this._targetEnd.y,this.restThreshold)&&xc(this._target.z,this._targetEnd.z,this.restThreshold)&&xc(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&xc(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&xc(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(w)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const s=this.getPosition(Nc),o=this.setLookAt(s.x,s.y,s.z,e,t,n,r);return this._sphericalEnd.phi=vc(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const s=!r||xc(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&xc(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&xc(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),Bc.setFromMatrixColumn(this._camera.matrixWorldInverse,0),jc.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Hc.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=Nc.set(e,t,n),s=r.distanceTo(this._camera.position),o=r.sub(this._camera.position);Bc.multiplyScalar(o.x),jc.multiplyScalar(o.y),Hc.multiplyScalar(o.z),Nc.copy(Bc).add(jc).add(Hc),Nc.z=Nc.z+s,this.dollyTo(s,!1),this.setFocalOffset(-Nc.x,Nc.y,-Nc.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){null!==e?(this._viewport=this._viewport||new Ic.Vector4,"number"==typeof e?this._viewport.set(e,t,n,r):this._viewport.copy(e)):this._viewport=null}getDistanceToFitBox(e,t,n,r=!1){if(Mc(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/t,o=this._camera.getEffectiveFOV()*gc,i=this._camera.aspect;return.5*((r?s>i:s<i)?t:e/i)/Math.tan(.5*o)+.5*n}getDistanceToFitSphere(e){if(Mc(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*gc,n=2*Math.atan(Math.tan(.5*t)*this._camera.aspect),r=1<this._camera.aspect?t:n;return e/Math.sin(.5*r)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Ic.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Ic.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new Ic.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Ic.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%pc,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=pc),this._spherical.theta+=pc*Math.round((this._sphericalEnd.theta-this._spherical.theta)/pc)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!xc(this._camera.up.x,this._cameraUp0.x)||!xc(this._camera.up.y,this._cameraUp0.y)||!xc(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const e=this.getPosition(Nc);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Dc),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Nc.subVectors(this._target,this._camera.position).normalize(),t=Uc.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(Nc);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,s=Vc.subVectors(this._targetEnd,this._target),o=Xc.subVectors(this._focalOffsetEnd,this._focalOffset),i=this._zoomEnd-this._zoom;if(yc(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=_c(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(yc(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=_c(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(yc(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=_c(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(yc(s.x)&&yc(s.y)&&yc(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;Ec(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(yc(o.x)&&yc(o.y)&&yc(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;Ec(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(yc(i))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=_c(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor)if(hc(this._camera)&&0!==this._changedDolly){const e=this._spherical.radius-this._lastDistance,t=this._camera,n=this._getCameraDirection(zc),r=Nc.copy(n).cross(t.up).normalize();0===r.lengthSq()&&(r.x=1);const s=Uc.crossVectors(r,n),o=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*gc*.5),i=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=Fc.copy(this._targetEnd).add(r.multiplyScalar(this._dollyControlCoord.x*o*t.aspect)).add(s.multiplyScalar(this._dollyControlCoord.y*o)),l=Nc.copy(this._targetEnd).lerp(a,i),c=this._lastDollyDirection===cc&&this._spherical.radius<=this.minDistance,u=this._lastDollyDirection===uc&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||u)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;const t=Uc.copy(n).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);const h=Uc.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedDolly-=e,yc(this._changedDolly)&&(this._changedDolly=0)}else if(dc(this._camera)&&0!==this._changedZoom){const e=this._zoom-this._lastZoom,t=this._camera,n=Nc.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),r=Uc.set(0,0,-1).applyQuaternion(t.quaternion),s=Fc.copy(n).add(r.multiplyScalar(-n.dot(t.up))),o=-(this._zoom-e-this._zoom)/this._zoom,i=this._getCameraDirection(zc),a=this._targetEnd.dot(i),l=Nc.copy(this._targetEnd).lerp(s,o),c=l.dot(i),u=i.multiplyScalar(c-a);l.sub(u),this._boundary.clampPoint(l,l);const h=Uc.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedZoom-=e,yc(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!yc(this._focalOffset.x)||!yc(this._focalOffset.y)||!yc(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Bc.setFromMatrixColumn(this._camera.matrix,0),jc.setFromMatrixColumn(this._camera.matrix,1),Hc.setFromMatrixColumn(this._camera.matrix,2),Bc.multiplyScalar(this._focalOffset.x),jc.multiplyScalar(-this._focalOffset.y),Hc.multiplyScalar(this._focalOffset.z),Nc.copy(Bc).add(jc).add(Hc),this._camera.position.add(Nc)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Nc.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),yc(t,this.restThreshold)&&yc(n,this.restThreshold)&&yc(r,this.restThreshold)&&yc(s.x,this.restThreshold)&&yc(s.y,this.restThreshold)&&yc(s.z,this.restThreshold)&&yc(o.x,this.restThreshold)&&yc(o.y,this.restThreshold)&&yc(o.z,this.restThreshold)&&yc(i,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:wc(this.maxDistance),minZoom:this.minZoom,maxZoom:wc(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:wc(this.maxPolarAngle),minAzimuthAngle:wc(this.minAzimuthAngle),maxAzimuthAngle:wc(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Nc.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=Tc(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=Tc(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=Tc(n.maxPolarAngle),this.minAzimuthAngle=Tc(n.minAzimuthAngle),this.maxAzimuthAngle=Tc(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),Yc.setFromVector3(Nc.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Yc.theta,Yc.phi,t),this.dollyTo(Yc.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){this._domElement?console.warn("camera-controls is already connected."):(e.setAttribute("data-camera-controls-version","2.9.0"),this._addAllEventListeners(e),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find((t=>t.pointerId===e))}_findPointerByMouseButton(e){return this._activePointers.find((t=>t.mouseButton===e))}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(0===r)return e;const s=Uc.copy(t).add(e),o=this._boundary.clampPoint(s,Fc).sub(s),i=o.lengthSq();if(0===i)return e.add(t);if(i===r)return e;if(0===n)return e.add(t).add(o);{const r=1+n*i/t.dot(o);return e.add(Uc.copy(t).multiplyScalar(r)).add(o.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(hc(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*gc,r=Math.tan(.5*n)*t,s=r*e.aspect;this._nearPlaneCorners[0].set(-s,-r,0),this._nearPlaneCorners[1].set(s,-r,0),this._nearPlaneCorners[2].set(s,r,0),this._nearPlaneCorners[3].set(-s,r,0)}else if(dc(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,s=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(n,s,0),this._nearPlaneCorners[1].set(r,s,0),this._nearPlaneCorners[2].set(r,o,0),this._nearPlaneCorners[3].set(n,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Mc(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(zc);Jc.lookAt(Lc,t,this._camera.up);for(let n=0;n<4;n++){const r=Uc.copy(this._nearPlaneCorners[n]);r.applyMatrix4(Jc);const s=Fc.addVectors(this._target,r);$c.set(s,t),$c.far=this._spherical.radius+1;const o=$c.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<e&&(e=o[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((e=>{const t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)})))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Ic.Sphere){const n=t,r=n.center;Gc.makeEmpty(),e.traverseVisible((e=>{e.isMesh&&Gc.expandByObject(e)})),Gc.getCenter(r);let s=0;return e.traverseVisible((e=>{if(!e.isMesh)return;const t=e,n=t.geometry.clone();n.applyMatrix4(t.matrixWorld);const o=n.attributes.position;for(let i=0,a=o.count;i<a;i++)Nc.fromBufferAttribute(o,i),s=Math.max(s,r.distanceToSquared(Nc))})),n.radius=Math.sqrt(s),n}};const tu=e=>!(!e||!e.isPerspectiveCamera),nu=e=>!(!e||!e.isOrthographicCamera),ru=["min-polar-angle","max-polar-angle","min-azimuth-angle","max-azimuth-angle","distance","min-distance","max-distance","infinity-dolly","min-zoom","max-zoom","smooth-time","dragging-smooth-time","max-speed","azimuth-rotate-speed","polar-rotate-speed","dolly-speed","dolly-drag-inverted","truck-speed","dolly-to-cursor","drag-to-offset","vertical-drag-to-forward","boundary-friction","rest-threshold","collider-meshes","args","mouse-buttons","touches"],su=(e,t)=>({left:eu.ACTION.ROTATE,middle:eu.ACTION.DOLLY,right:eu.ACTION.TRUCK,wheel:tu(e)?eu.ACTION.DOLLY:nu(e)?eu.ACTION.ZOOM:eu.ACTION.NONE,...t}),ou=(e,t)=>({one:eu.ACTION.TOUCH_ROTATE,two:tu(e)?eu.ACTION.TOUCH_DOLLY_TRUCK:nu(e)?eu.ACTION.TOUCH_ZOOM_TRUCK:eu.ACTION.NONE,three:eu.ACTION.TOUCH_TRUCK,...t}),iu=It({__name:"CameraControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},minPolarAngle:{default:0},maxPolarAngle:{default:Math.PI},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},distance:{default:()=>Kr().camera.value.position.z},minDistance:{default:Number.EPSILON},maxDistance:{default:Number.POSITIVE_INFINITY},infinityDolly:{type:Boolean,default:!1},minZoom:{default:.01},maxZoom:{default:Number.POSITIVE_INFINITY},smoothTime:{default:.25},draggingSmoothTime:{default:.125},maxSpeed:{default:Number.POSITIVE_INFINITY},azimuthRotateSpeed:{default:1},polarRotateSpeed:{default:1},dollySpeed:{default:1},dollyDragInverted:{type:Boolean,default:!1},truckSpeed:{default:2},dollyToCursor:{type:Boolean,default:!1},dragToOffset:{type:Boolean,default:!1},verticalDragToForward:{type:Boolean,default:!1},boundaryFriction:{default:0},restThreshold:{default:.01},colliderMeshes:{default:()=>[]},mouseButtons:{default:()=>su(Kr().camera.value)},touches:{default:()=>ou(Kr().camera.value)}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,s=n,{makeDefault:o,minPolarAngle:i,maxPolarAngle:a,minAzimuthAngle:c,maxAzimuthAngle:u,distance:h,minDistance:d,maxDistance:p,infinityDolly:m,minZoom:f,maxZoom:g,smoothTime:v,draggingSmoothTime:y,maxSpeed:x,azimuthRotateSpeed:b,polarRotateSpeed:w,dollySpeed:_,dollyDragInverted:E,truckSpeed:A,dollyToCursor:M,dragToOffset:O,verticalDragToForward:P,boundaryFriction:I,restThreshold:L,colliderMeshes:D}=Jt(r),R={Box3:K,MathUtils:{clamp:T.clamp},Matrix4:Z,Quaternion:X,Raycaster:l,Sphere:G,Spherical:W,Vector2:S,Vector3:C,Vector4:Y};eu.install({THREE:R});const{camera:k,renderer:N,extend:U,controls:F,invalidate:z}=Kr();Nt(r,(()=>{z()}));const B=Wt((()=>su(r.camera||k.value,r.mouseButtons))),j=Wt((()=>ou(r.camera||k.value,r.touches))),H=Dt(null);U({CameraControls:eu}),Xt((()=>{Zs(H.value,"update",(()=>{s("change",H.value),z()})),Zs(H.value,"controlend",(()=>s("end",H.value))),Zs(H.value,"controlstart",(()=>s("start",H.value))),H.value&&o.value?F.value=H.value:F.value=null}));const{onBeforeRender:V}=Qr();return V((({delta:e,invalidate:t})=>{var n,r;null!=(n=H.value)&&n.enabled&&(null==(r=H.value)||r.update(e),t())})),Ut((()=>{H.value&&H.value.disconnect()})),t({instance:H}),(e,t)=>(e.camera||Bt(k))&&(e.domElement||Bt(N))?(Ft(),Rt("TresCameraControls",{key:0,ref_key:"controlsRef",ref:H,"min-polar-angle":Bt(i),"max-polar-angle":Bt(a),"min-azimuth-angle":Bt(c),"max-azimuth-angle":Bt(u),distance:Bt(h),"min-distance":Bt(d),"max-distance":Bt(p),"infinity-dolly":Bt(m),"min-zoom":Bt(f),"max-zoom":Bt(g),"smooth-time":Bt(v),"dragging-smooth-time":Bt(y),"max-speed":Bt(x),"azimuth-rotate-speed":Bt(b),"polar-rotate-speed":Bt(w),"dolly-speed":Bt(_),"dolly-drag-inverted":Bt(E),"truck-speed":Bt(A),"dolly-to-cursor":Bt(M),"drag-to-offset":Bt(O),"vertical-drag-to-forward":Bt(P),"boundary-friction":Bt(I),"rest-threshold":Bt(L),"collider-meshes":Bt(D),args:[e.camera||Bt(k),e.domElement||Bt(N).domElement],"mouse-buttons":B.value,touches:j.value},null,8,ru)):$t("",!0)}}),au=It({__name:"KeyboardControls",props:{makeDefault:{type:Boolean,default:!0},camera:{},domElement:{},moveSpeed:{default:.2},selector:{}},emits:["isLock","change"],setup(e,{expose:t,emit:n}){const r=e,s=n,{moveSpeed:o}=Jt(r),{camera:i,controls:a,renderer:l,invalidate:c}=Kr();Nt(r,(()=>{c()}));const u=Ot(0),h=Ot(0),{KeyW:d,KeyA:p,KeyS:m,KeyD:f,Up:g,Down:v,Left:y,Right:x}=function(e={}){const{reactive:t=!1,target:n=Ws,aliasMap:r=Qs,passive:s=!0,onEventFired:o=js}=e,i=Pt(new Set),a={toJSON:()=>({}),current:i},l=t?Pt(a):a,c=new Set,u=new Set;function h(e,n){e in l&&(t?l[e]=n:l[e].value=n)}function d(){i.clear();for(const e of u)h(e,!1)}function p(e,t){var n,r;const s=null==(n=e.key)?void 0:n.toLowerCase(),o=[null==(r=e.code)?void 0:r.toLowerCase(),s].filter(Boolean);s&&(t?i.add(s):i.delete(s));for(const i of o)u.add(i),h(i,t);"meta"!==s||t?"function"==typeof e.getModifierState&&e.getModifierState("Meta")&&t&&[...i,...o].forEach((e=>c.add(e))):(c.forEach((e=>{i.delete(e),h(e,!1)})),c.clear())}Zs(n,"keydown",(e=>(p(e,!0),o(e))),{passive:s}),Zs(n,"keyup",(e=>(p(e,!1),o(e))),{passive:s}),Zs("blur",d,{passive:!0}),Zs("focus",d,{passive:!0});const m=new Proxy(l,{get(e,n,s){if("string"!=typeof n)return Reflect.get(e,n,s);if((n=n.toLowerCase())in r&&(n=r[n]),!(n in l))if(/[+_-]/.test(n)){const e=n.split(/[+_-]/g).map((e=>e.trim()));l[n]=Wt((()=>e.every((e=>Fs(m[e])))))}else l[n]=Ot(!1);const o=Reflect.get(e,n,s);return t?Fs(o):o}});return m}();Xt((()=>{p.value||y.value?u.value=-o.value:f.value||x.value?u.value=o.value:u.value=0,d.value||g.value?h.value=o.value:m.value||v.value?h.value=-o.value:h.value=0})),t({instance:a});const b=e=>s("isLock",e),w=e=>s("change",e),T=new C,_=new C,E=new X,{onBeforeRender:A}=Qr();return A((({delta:e,invalidate:t})=>{var n;a.value instanceof ra&&null!=(n=a.value)&&n.isLocked&&(((e,t)=>{var n;if(!(null!=(n=i.value)&&n.position||T))return;const r=i.value,o=.001*e;null==r||r.translateZ(-t),E.set(_.x*o,_.y*o,_.z*o,1).normalize(),null==r||r.quaternion.multiply(E),(u.value||h.value)&&s("change",a.value)})(e,h.value),a.value.moveRight(u.value),t())})),(e,t)=>(Ft(),hn(Bt(pu),{selector:e.selector,"make-default":e.makeDefault,camera:e.camera||Bt(i),"dom-element":e.domElement||Bt(l).domElement,onIsLock:b,onChange:w},null,8,["selector","make-default","camera","dom-element"]))}}),lu=["args","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","enable-zoom","zoom-speed","enable-rotate","rotate-speed"],cu=It({__name:"MapControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,{autoRotate:s,autoRotateSpeed:o,enableDamping:i,dampingFactor:a,enablePan:l,keyPanSpeed:c,maxAzimuthAngle:u,minAzimuthAngle:h,maxPolarAngle:d,minPolarAngle:p,minDistance:m,maxDistance:f,minZoom:g,maxZoom:v,enableZoom:y,zoomSpeed:x,enableRotate:b,rotateSpeed:w}=Jt(r),{camera:T,renderer:_,extend:E,controls:A,invalidate:M}=Kr();Nt(r,(()=>{M()}));const S=Dt(null);E({MapControls:ha}),Nt(A,(e=>{e&&r.makeDefault?A.value=e:A.value=null}));const{onBeforeRender:C}=Qr();return C((({invalidate:e})=>{S.value&&(i.value||s.value)&&(S.value.update(),e())})),Ut((()=>{S.value&&S.value.dispose()})),t({instance:S}),(e,t)=>(e.camera||Bt(T))&&(e.domElement||Bt(_))?(Ft(),Rt("TresMapControls",{key:0,ref_key:"controlsRef",ref:S,args:[e.camera||Bt(T),e.domElement||Bt(_).domElement],"auto-rotate":Bt(s),"auto-rotate-speed":Bt(o),"enable-damping":Bt(i),"damping-factor":Bt(a),"enable-pan":Bt(l),"key-pan-speed":Bt(c),keys:e.keys,"max-azimuth-angle":Bt(u),"min-azimuth-angle":Bt(h),"max-polar-angle":Bt(d),"min-polar-angle":Bt(p),"min-distance":Bt(m),"max-distance":Bt(f),"min-zoom":Bt(g),"max-zoom":Bt(v),"enable-zoom":Bt(y),"zoom-speed":Bt(x),"enable-rotate":Bt(b),"rotate-speed":Bt(w)},null,8,lu)):$t("",!0)}}),uu=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","mouse-buttons","args"],hu=It({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:L.ROTATE,TWO:L.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1},mouseButtons:{default:()=>({LEFT:I.ROTATE,MIDDLE:I.DOLLY,RIGHT:I.PAN})}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,s=n,{makeDefault:o,autoRotate:i,autoRotateSpeed:a,enableDamping:l,dampingFactor:c,enablePan:u,keyPanSpeed:h,maxAzimuthAngle:d,minAzimuthAngle:p,maxPolarAngle:m,minPolarAngle:f,minDistance:g,maxDistance:v,minZoom:y,maxZoom:x,enableZoom:b,zoomSpeed:w,enableRotate:T,touches:_,rotateSpeed:E,target:A,mouseButtons:M}=Jt(r),{camera:S,renderer:C,extend:O,controls:P,invalidate:I}=Kr(),L=Dt(null);O({OrbitControls:ua}),Nt(L,(e=>{Zs(L.value,"change",(()=>{s("change",L.value),I()})),Zs(L.value,"start",(()=>s("start",L.value))),Zs(L.value,"end",(()=>s("end",L.value))),e&&o.value?P.value=e:P.value=null}));const{onBeforeRender:D}=Qr();return D((({invalidate:e})=>{L.value&&(l.value||i.value)&&(L.value.update(),i.value&&e())})),Ut((()=>{L.value&&L.value.dispose()})),t({instance:L}),(e,t)=>(e.camera||Bt(S))&&(e.domElement||Bt(C))?(Ft(),Rt("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:L,target:Bt(A),"auto-rotate":Bt(i),"auto-rotate-speed":Bt(a),"enable-damping":Bt(l),"damping-factor":Bt(c),"enable-pan":Bt(u),"key-pan-speed":Bt(h),keys:e.keys,"max-azimuth-angle":Bt(d),"min-azimuth-angle":Bt(p),"max-polar-angle":Bt(m),"min-polar-angle":Bt(f),"min-distance":Bt(g),"max-distance":Bt(v),"min-zoom":Bt(y),"max-zoom":Bt(x),touches:Bt(_),"enable-zoom":Bt(b),"zoom-speed":Bt(w),"enable-rotate":Bt(T),"rotate-speed":Bt(E),"mouse-buttons":Bt(M),args:[e.camera||Bt(S),e.domElement||Bt(C).domElement]},null,8,uu)):$t("",!0)}}),du=["args"],pu=It({__name:"PointerLockControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},selector:{}},emits:["isLock","change"],setup(e,{expose:t,emit:n}){const r=e,s=n,{camera:o,renderer:i,extend:a,controls:l,invalidate:c}=Kr();Nt(r,(()=>{c()}));const u=Dt(null);let h;a({PointerLockControls:ra});const d=e=>{s("isLock",e)};return Nt(u,(e=>{e&&r.makeDefault?l.value=e:l.value=null,h=document.getElementById(r.selector||"")||i.value.domElement,Zs(h,"click",(()=>{u.value&&(u.value.lock(),u.value.addEventListener("lock",(()=>d(!0))),u.value.addEventListener("unlock",(()=>d(!1))),c())}))})),Ut((()=>{const e=u.value;e&&(e.removeEventListener("lock",(()=>d(!0))),e.removeEventListener("unlock",(()=>d(!1))),e.dispose())})),t({instance:l}),(e,t)=>(e.camera||Bt(o))&&(e.domElement||Bt(i))?(Ft(),Rt("TresPointerLockControls",{key:0,ref_key:"controlsRef",ref:u,args:[e.camera||Bt(o),e.domElement||Bt(i).domElement]},null,8,du)):$t("",!0)}}),mu=It({__name:"ScrollControls",props:{pages:{default:4},distance:{default:4},smoothScroll:{default:.1},horizontal:{type:Boolean,default:!1},htmlScroll:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const r=e,s=n,{logWarning:o}=Dr();r.smoothScroll<0&&o("SmoothControl must be greater than zero"),r.pages<0&&o("Pages must be greater than zero");const{camera:i,controls:a,renderer:l,invalidate:c}=Kr();Nt(r,(()=>{c()}));const u=Dt(),h=document.createElement("div"),{y:d}=function(e={}){const{window:t=Ws,behavior:n="auto"}=e;if(!t)return{x:Ot(0),y:Ot(0)};const r=Ot(t.scrollX),s=Ot(t.scrollY),o=Wt({get:()=>r.value,set(e){scrollTo({left:e,behavior:n})}}),i=Wt({get:()=>s.value,set(e){scrollTo({top:e,behavior:n})}});return Zs(t,"scroll",(()=>{r.value=t.scrollX,s.value=t.scrollY}),{capture:!1,passive:!0}),{x:o,y:i}}(),{x:p,y:m,isScrolling:f}=function(e,t={}){const{throttle:n=0,idle:r=200,onStop:s=js,onScroll:o=js,offset:i={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0},behavior:l="auto",window:c=Ws,onError:u=e=>{console.error(e)}}=t,h=Ot(0),d=Ot(0),p=Wt({get:()=>h.value,set(e){f(e,void 0)}}),m=Wt({get:()=>d.value,set(e){f(void 0,e)}});function f(t,n){var r,s,o,i;if(!c)return;const a=Fs(e);if(!a)return;null==(o=a instanceof Document?c.document.body:a)||o.scrollTo({top:null!=(r=Fs(n))?r:m.value,left:null!=(s=Fs(t))?s:p.value,behavior:Fs(l)});const u=(null==(i=null==a?void 0:a.document)?void 0:i.documentElement)||(null==a?void 0:a.documentElement)||a;null!=p&&(h.value=u.scrollLeft),null!=m&&(d.value=u.scrollTop)}const g=Ot(!1),v=Pt({left:!0,right:!1,top:!0,bottom:!1}),y=Pt({left:!1,right:!1,top:!1,bottom:!1}),x=e=>{g.value&&(g.value=!1,y.left=!1,y.right=!1,y.top=!1,y.bottom=!1,s(e))},b=Vs(x,n+r),w=e=>{var t;if(!c)return;const n=(null==(t=null==e?void 0:e.document)?void 0:t.documentElement)||(null==e?void 0:e.documentElement)||Gs(e),{display:r,flexDirection:s}=getComputedStyle(n),o=n.scrollLeft;y.left=o<h.value,y.right=o>h.value;const a=Math.abs(o)<=(i.left||0),l=Math.abs(o)+n.clientWidth>=n.scrollWidth-(i.right||0)-1;"flex"===r&&"row-reverse"===s?(v.left=l,v.right=a):(v.left=a,v.right=l),h.value=o;let u=n.scrollTop;e===c.document&&!u&&(u=c.document.body.scrollTop),y.top=u<d.value,y.bottom=u>d.value;const p=Math.abs(u)<=(i.top||0),m=Math.abs(u)+n.clientHeight>=n.scrollHeight-(i.bottom||0)-1;"flex"===r&&"column-reverse"===s?(v.top=m,v.bottom=p):(v.top=p,v.bottom=m),d.value=u},T=e=>{var t;if(!c)return;const n=null!=(t=e.target.documentElement)?t:e.target;w(n),g.value=!0,b(e),o(e)};return Zs(e,"scroll",n?Xs(T,n,!0,!1):T,a),Ys((()=>{try{const t=Fs(e);if(!t)return;w(t)}catch(_){u(_)}})),Zs(e,"scrollend",x,a),{x:p,y:m,isScrolling:g,arrivedState:v,directions:y,measure(){const t=Fs(e);c&&t&&w(t)}}}(h),{height:g,width:v}=qs();let y=0;const x=Ot(!1),b=Ot(0),w=Ot(0),T=Ot(0),_=r.horizontal?"x":"y",E=Nt(i,(e=>{x.value?E():(y=r.horizontal?(null==e?void 0:e.position.x)||0:(null==e?void 0:e.position.y)||0,x.value=!0)}),{immediate:!0});Nt(f,(e=>{a.value&&(a.value.enabled=!e)}),{immediate:!0}),Nt(d,(e=>{!f.value&&!r.htmlScroll||(w.value=e/g.value/(T.value/g.value-1),b.value=-1*w.value,s("update:modelValue",w.value))})),Nt(m,(e=>{w.value=e/g.value/(T.value/g.value),b.value=-1*w.value,s("update:modelValue",w.value)})),Nt(p,(e=>{w.value=e/v.value/(T.value/v.value-1),b.value=+w.value,s("update:modelValue",w.value)})),Nt(l,(e=>{var t,n;const s=null==e?void 0:e.domElement;if(r.htmlScroll&&null!=e&&e.domElement)null!=s&&s.style.width&&null!=s&&s.style.position&&null!=s&&s.style.top&&null!=s&&s.style.left&&(s.style.width="100%",s.style.position="fixed",s.style.zIndex=" -99999",s.style.top="0",s.style.left="0"),T.value=document.body.scrollHeight;else{const o=document.createElement("div"),i=document.createElement("div");h.style[r.horizontal?"overflowX":"overflowY"]="auto",h.style[r.horizontal?"overflowY":"overflowX"]="hidden",h.style.position="absolute",h.style.width="100%",h.style.height=" 100%",h.style.top="0",h.style.left="0",h.classList.add("scrollContainer"),o.style.position="sticky",o.style.top="0px",o.style.left="0px",o.style.width="100%",o.style.height="100%",o.style.overflow="hidden",h.appendChild(o),i.style.height=r.horizontal?"100%":g.value*r.pages+"px",i.style.width=r.horizontal?v.value*r.pages+"px":"100vw",i.style.pointerEvents="none",s.style.position="fixed",s.style.zIndex="0",null!=s&&s.style.width&&(s.style.width="100%"),h.appendChild(i),null!=e&&e.domElement.parentNode&&(e.domElement.parentNode.style.position="relative"),null==(n=null==(t=null==e?void 0:e.domElement)?void 0:t.parentNode)||n.appendChild(h),T.value=r.horizontal?v.value*r.pages:g.value*r.pages}}),{immediate:!0});const{onBeforeRender:A}=Qr();return A((({invalidate:e})=>{var t;if(null!=(t=i.value)&&t.position){const t=(b.value*r.distance-i.value.position[_]+y)*r.smoothScroll;i.value.position[_]+=t,u.value.children.length>0&&(u.value.position[_]+=t),e()}})),t({instance:u}),(e,t)=>(Ft(),Rt("TresGroup",{ref_key:"wrapperRef",ref:u},[en(e.$slots,"default")],512))}}),fu=["object","args","mode","enabled","axis","translation-snap","rotation-snap","scale-snap","space","size","show-x","show-y","show-z"],gu=It({__name:"TransformControls",props:{object:{},camera:{},mode:{default:"translate"},enabled:{type:Boolean,default:!0},axis:{default:"XYZ"},translationSnap:{},rotationSnap:{},scaleSnap:{},space:{default:"world"},size:{default:1},showX:{type:Boolean,default:!0},showY:{type:Boolean,default:!0},showZ:{type:Boolean,default:!0}},emits:["dragging","change","mouseDown","mouseUp","objectChange"],setup(e,{expose:t,emit:n}){const r=e,s=n,{object:o,mode:i,enabled:a,axis:l,translationSnap:c,rotationSnap:u,scaleSnap:h,space:d,size:p,showX:m,showY:f,showZ:g}=Jt(r),v=Dt(null),{controls:y,camera:x,renderer:b,extend:w,invalidate:T}=Kr();Nt([o,i,a,l,c,u,h,d,p,m,f,g],(()=>{T()})),w({TransformControls:Wi});const _=()=>{T(),s("change")},E=e=>{y.value&&(y.value.enabled=!e.value),T(),s("dragging",e.value)},A=()=>{T(),s("mouseDown")},M=()=>{T(),s("mouseDown")},S=()=>{T(),s("objectChange")};return Nt(v,(e=>{e&&(Zs(v.value,"change",_),Zs(v.value,"dragging-changed",E),Zs(v.value,"mouseDown",A),Zs(v.value,"mouseUp",M),Zs(v.value,"objectChange",S))})),Ut((()=>{v.value&&v.value.dispose()})),t({instance:v}),(e,t)=>{var n;return(e.camera||Bt(x))&&Bt(b)?(Ft(),Rt("TresTransformControls",{ref_key:"controlsRef",ref:v,key:null==(n=e.camera||Bt(x))?void 0:n.uuid,object:Bt(o),args:[e.camera||Bt(x),Bt(b).domElement],mode:Bt(i),enabled:Bt(a),axis:Bt(l),"translation-snap":Bt(c),"rotation-snap":Bt(u),"scale-snap":Bt(h),space:Bt(d),size:Bt(p),"show-x":Bt(m),"show-y":Bt(f),"show-z":Bt(g),visible:!0},null,8,fu)):$t("",!0)}}});const vu=class extends ne{constructor(e){super(e),Ns(this,"fbxLoader"),this.fbxLoader=new _l(e)}load(e,t,n,r){const s=Array.isArray(e)?e[0]:e;this.fbxLoader.load(s,t,n,r)}async loadAsync(e){const t=Array.isArray(e)?e[0]:e;return this.fbxLoader.loadAsync(t)}};async function yu(e){return await Jn(vu,e)}const xu=class extends ne{constructor(e){super(e),Ns(this,"gltfLoader"),this.gltfLoader=new fa(e)}load(e,t,n,r){const s=Array.isArray(e)?e[0]:e;this.gltfLoader.load(s,t,n,r)}async loadAsync(e){const t=Array.isArray(e)?e[0]:e;return this.gltfLoader.loadAsync(t)}setDRACOLoader(e){return this.gltfLoader.setDRACOLoader(e)}};let bu=null;async function wu(e,t={draco:!1},n){const r=await Jn(xu,e,function(e){return t=>{e.draco&&(bu||(bu=new Kl),bu.setDecoderPath(e.decoderPath||"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),t.setDRACOLoader&&t.setDRACOLoader(bu))}}(t));return null==bu||bu.dispose(),bu=null,r}const Tu="[TresJS - Cientos â–² â–  â™¥] ";function _u(e,t){console.error(`${Tu} ${e}`,t||"")}function Eu(e){console.warn(`${Tu} ${e}`)}function Au(e,t){}function Mu(){return{logError:_u,logWarning:Eu,logMessage:Au}}let Su=0;function Cu(){const e=Ot(!1),t=Ot(0),n=Ot([]),{logError:r}=Mu();return new Promise((s=>{q.onStart=()=>{e.value=!1},q.onLoad=()=>{e.value=!0},q.onProgress=(r,s,o)=>{s===o&&(Su=o,e.value=!0,n.value.push(r)),t.value=Math.round((s-Su)/(o-Su)*100||100)},q.onError=t=>{r("Error loading assets",new Error(t)),e.value=!0},s({items:n,hasFinishLoading:e,progress:t})}))}async function Ou(e,t){const{logError:n}=Mu();if(!e)return n("Error no path provided");const{unsuspend:r,start:s,crossOrigin:o,muted:i,loop:a,...l}={unsuspend:"loadedmetadata",crossOrigin:"Anonymous",muted:!0,loop:!0,start:!0,playsInline:!0,...t};try{const t=await new Promise(((t,n)=>{const s=Object.assign(document.createElement("video"),{src:"string"==typeof e&&e||void 0,crossOrigin:o,loop:a,muted:i,autoplay:!0,...l}),c=new se(s);return s.addEventListener(r,(()=>t(c))),s.addEventListener("error",(()=>n(new Error("Error loading video")))),c}));return s&&t.image&&t.image.play(),t}catch{n("Error loading resource")}}function Pu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Iu(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Lu,Du={exports:{}};var Ru=(Lu||(Lu=1,Du.exports=function e(t,n,r){function s(i,a){if(!n[i]){if(!t[i]){if(!a&&Iu)return Iu(i);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}a=n[i]={exports:{}},t[i][0].call(a.exports,(function(e){return s(t[i][1][e]||e)}),a,a.exports,e,t,n,r)}return n[i].exports}for(var o=Iu,i=0;i<r.length;i++)s(r[i]);return s}({1:[function(e,t,n){(function(r,s,o,i,a,l,c,u,h){var d=e("crypto");function p(e,t){var n;return void 0===(n="passthrough"!==(t=g(e,t)).algorithm?d.createHash(t.algorithm):new x).write&&(n.write=n.update,n.end=n.update),y(t,n).dispatch(e),n.update||n.end(""),n.digest?n.digest("buffer"===t.encoding?void 0:t.encoding):(e=n.read(),"buffer"!==t.encoding?e.toString(t.encoding):e)}(n=t.exports=p).sha1=function(e){return p(e)},n.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},n.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},n.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=d.getHashes?d.getHashes().slice():["sha1","md5"],f=(m.push("passthrough"),["buffer","hex","binary","base64"]);function g(e,t){var n={};if(n.algorithm=(t=t||{}).algorithm||"sha1",n.encoding=t.encoding||"hex",n.excludeValues=!!t.excludeValues,n.algorithm=n.algorithm.toLowerCase(),n.encoding=n.encoding.toLowerCase(),n.ignoreUnknown=!0===t.ignoreUnknown,n.respectType=!1!==t.respectType,n.respectFunctionNames=!1!==t.respectFunctionNames,n.respectFunctionProperties=!1!==t.respectFunctionProperties,n.unorderedArrays=!0===t.unorderedArrays,n.unorderedSets=!1!==t.unorderedSets,n.unorderedObjects=!1!==t.unorderedObjects,n.replacer=t.replacer||void 0,n.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var r=0;r<m.length;++r)m[r].toLowerCase()===n.algorithm.toLowerCase()&&(n.algorithm=m[r]);if(-1===m.indexOf(n.algorithm))throw new Error('Algorithm "'+n.algorithm+'"  not supported. supported values: '+m.join(", "));if(-1===f.indexOf(n.encoding)&&"passthrough"!==n.algorithm)throw new Error('Encoding "'+n.encoding+'"  not supported. supported values: '+f.join(", "));return n}function v(e){if("function"==typeof e)return null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function y(e,t,n){function r(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")}return n=n||[],{dispatch:function(t){return this["_"+(null===(t=e.replacer?e.replacer(t):t)?"null":typeof t)](t)},_object:function(t){var s,i=Object.prototype.toString.call(t),a=/\[object (.*)\]/i.exec(i);if(a=(a=a?a[1]:"unknown:["+i+"]").toLowerCase(),0<=(i=n.indexOf(t)))return this.dispatch("[CIRCULAR:"+i+"]");if(n.push(t),void 0!==o&&o.isBuffer&&o.isBuffer(t))return r("buffer:"),r(t);if("object"===a||"function"===a||"asyncfunction"===a)return i=Object.keys(t),e.unorderedObjects&&(i=i.sort()),!1===e.respectType||v(t)||i.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(i=i.filter((function(t){return!e.excludeKeys(t)}))),r("object:"+i.length+":"),s=this,i.forEach((function(n){s.dispatch(n),r(":"),e.excludeValues||s.dispatch(t[n]),r(",")}));if(!this["_"+a]){if(e.ignoreUnknown)return r("["+a+"]");throw new Error('Unknown object type "'+a+'"')}this["_"+a](t)},_array:function(t,s){s=void 0!==s?s:!1!==e.unorderedArrays;var o=this;if(r("array:"+t.length+":"),!s||t.length<=1)return t.forEach((function(e){return o.dispatch(e)}));var i=[];return s=t.map((function(t){var r=new x,s=n.slice();return y(e,r,s).dispatch(t),i=i.concat(s.slice(n.length)),r.read().toString()})),n=n.concat(i),s.sort(),this._array(s,!1)},_date:function(e){return r("date:"+e.toJSON())},_symbol:function(e){return r("symbol:"+e.toString())},_error:function(e){return r("error:"+e.toString())},_boolean:function(e){return r("bool:"+e.toString())},_string:function(e){r("string:"+e.length+":"),r(e.toString())},_function:function(t){r("fn:"),v(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return r("number:"+e.toString())},_xml:function(e){return r("xml:"+e.toString())},_null:function(){return r("Null")},_undefined:function(){return r("Undefined")},_regexp:function(e){return r("regex:"+e.toString())},_uint8array:function(e){return r("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return r("int8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return r("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return r("int16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return r("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return r("int32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return r("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return r("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return r("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return r("url:"+e.toString())},_map:function(t){return r("map:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_set:function(t){return r("set:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_file:function(e){return r("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(e.ignoreUnknown)return r("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return r("domwindow")},_bigint:function(e){return r("bigint:"+e.toString())},_process:function(){return r("process")},_timer:function(){return r("timer")},_pipe:function(){return r("pipe")},_tcp:function(){return r("tcp")},_udp:function(){return r("udp")},_tty:function(){return r("tty")},_statwatcher:function(){return r("statwatcher")},_securecontext:function(){return r("securecontext")},_connection:function(){return r("connection")},_zlib:function(){return r("zlib")},_context:function(){return r("context")},_nodescript:function(){return r("nodescript")},_httpparser:function(){return r("httpparser")},_dataview:function(){return r("dataview")},_signal:function(){return r("signal")},_fsevent:function(){return r("fsevent")},_tlswrap:function(){return r("tlswrap")}}}function x(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}n.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),y(t=g(e,t),n).dispatch(e)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,t,n){(function(e,t,r,s,o,i,a,l,c){!function(e){var t=typeof Uint8Array<"u"?Uint8Array:Array,n=43,r=47,s=48,o=97,i=65,a=45,l=95;function c(e){return(e=e.charCodeAt(0))===n||e===a?62:e===r||e===l?63:e<s?-1:e<s+10?e-s+26+26:e<i+26?e-i:e<o+26?e-o+26:void 0}e.toByteArray=function(e){var n,r;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.length,o=(s="="===e.charAt(s-2)?2:"="===e.charAt(s-1)?1:0,new t(3*e.length/4-s)),i=0<s?e.length-4:e.length,a=0;function l(e){o[a++]=e}for(n=0;n<i;n+=4,0)l((16711680&(r=c(e.charAt(n))<<18|c(e.charAt(n+1))<<12|c(e.charAt(n+2))<<6|c(e.charAt(n+3))))>>16),l((65280&r)>>8),l(255&r);return 2==s?l(255&(r=c(e.charAt(n))<<2|c(e.charAt(n+1))>>4)):1==s&&(l((r=c(e.charAt(n))<<10|c(e.charAt(n+1))<<4|c(e.charAt(n+2))>>2)>>8&255),l(255&r)),o},e.fromByteArray=function(e){var t,n,r,s,o=e.length%3,i="";function a(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,r=e.length-o;t<r;t+=3)i+=a((s=n=(e[t]<<16)+(e[t+1]<<8)+e[t+2])>>18&63)+a(s>>12&63)+a(s>>6&63)+a(63&s);switch(o){case 1:i=(i+=a((n=e[e.length-1])>>2))+a(n<<4&63)+"==";break;case 2:i=(i=(i+=a((n=(e[e.length-2]<<8)+e[e.length-1])>>10))+a(n>>4&63))+a(n<<2&63)+"="}return i}}(void 0===n?this.base64js={}:n)}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,t,n){(function(t,r,s,o,i,a,l,c,u){var h=e("base64-js"),d=e("ieee754");function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);var r,o,i,a,l=typeof e;if("base64"===t&&"string"==l)for(e=(a=e).trim?a.trim():a.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if("number"==l)r=P(e);else if("string"==l)r=s.byteLength(e,t);else{if("object"!=l)throw new Error("First argument needs to be a number, array or string.");r=P(e.length)}if(s._useTypedArrays?o=s._augment(new Uint8Array(r)):((o=this).length=r,o._isBuffer=!0),s._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else if(I(a=e)||s.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length)for(i=0;i<r;i++)s.isBuffer(e)?o[i]=e.readUInt8(i):o[i]=e[i];else if("string"==l)o.write(e,0,t);else if("number"==l&&!s._useTypedArrays&&!n)for(i=0;i<r;i++)o[i]=0;return o}function p(e,t,n,r){return s._charsWritten=k(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function m(e,t,n,r){return s._charsWritten=k(function(e){for(var t,n,r=[],s=0;s<e.length;s++)t=(n=e.charCodeAt(s))>>8,n%=256,r.push(n),r.push(t);return r}(t),e,n,r)}function f(e,t,n){var r="";n=Math.min(e.length,n);for(var s=t;s<n;s++)r+=String.fromCharCode(e[s]);return r}function g(e,t,n,r){var s;if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!((r=e.length)<=t))return n?(s=e[t],t+1<r&&(s|=e[t+1]<<8)):(s=e[t]<<8,t+1<r&&(s|=e[t+1])),s}function v(e,t,n,r){var s;if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!((r=e.length)<=t))return n?(t+2<r&&(s=e[t+2]<<16),t+1<r&&(s|=e[t+1]<<8),s|=e[t],t+3<r&&(s+=e[t+3]<<24>>>0)):(t+1<r&&(s=e[t+1]<<16),t+2<r&&(s|=e[t+2]<<8),t+3<r&&(s|=e[t+3]),s+=e[t]<<24>>>0),s}function y(e,t,n,r){if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 32768&(r=g(e,t,n,!0))?-1*(65535-r+1):r}function x(e,t,n,r){if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 2147483648&(r=v(e,t,n,!0))?-1*(4294967295-r+1):r}function b(e,t,n,r){return r||(B("boolean"==typeof n,"missing or invalid endian"),B(t+3<e.length,"Trying to read beyond buffer length")),d.read(e,t,n,23,4)}function w(e,t,n,r){return r||(B("boolean"==typeof n,"missing or invalid endian"),B(t+7<e.length,"Trying to read beyond buffer length")),d.read(e,t,n,52,8)}function T(e,t,n,r,s){if(s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+1<e.length,"trying to write beyond buffer length"),U(t,65535)),!((s=e.length)<=n))for(var o=0,i=Math.min(s-n,2);o<i;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function _(e,t,n,r,s){if(s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"trying to write beyond buffer length"),U(t,4294967295)),!((s=e.length)<=n))for(var o=0,i=Math.min(s-n,4);o<i;o++)e[n+o]=t>>>8*(r?o:3-o)&255}function E(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+1<e.length,"Trying to write beyond buffer length"),F(t,32767,-32768)),e.length<=n||T(e,0<=t?t:65535+t+1,n,r,s)}function A(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"Trying to write beyond buffer length"),F(t,2147483647,-2147483648)),e.length<=n||_(e,0<=t?t:4294967295+t+1,n,r,s)}function M(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"Trying to write beyond buffer length"),z(t,34028234663852886e22,-34028234663852886e22)),e.length<=n||d.write(e,t,n,r,23,4)}function S(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+7<e.length,"Trying to write beyond buffer length"),z(t,17976931348623157e292,-17976931348623157e292)),e.length<=n||d.write(e,t,n,r,52,8)}n.Buffer=s,n.SlowBuffer=s,n.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch{return!1}}(),s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=D(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=R(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},s.concat=function(e,t){if(B(I(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new s(0);if(1===e.length)return e[0];if("number"!=typeof t)for(o=t=0;o<e.length;o++)t+=e[o].length;for(var n=new s(t),r=0,o=0;o<e.length;o++){var i=e[o];i.copy(n,r),r+=i.length}return n},s.prototype.write=function(e,t,n,r){isFinite(t)?isFinite(n)||(r=n,n=void 0):(c=r,r=t,t=n,n=c),t=Number(t)||0;var o,i,a,l,c=this.length-t;switch((!n||c<(n=Number(n)))&&(n=c),r=String(r||"utf8").toLowerCase()){case"hex":o=function(e,t,n,r){n=Number(n)||0;var o=e.length-n;(!r||o<(r=Number(r)))&&(r=o),B((o=t.length)%2==0,"Invalid hex string"),o/2<r&&(r=o/2);for(var i=0;i<r;i++){var a=parseInt(t.substr(2*i,2),16);B(!isNaN(a),"Invalid hex string"),e[n+i]=a}return s._charsWritten=2*i,i}(this,e,t,n);break;case"utf8":case"utf-8":i=this,a=t,l=n,o=s._charsWritten=k(D(e),i,a,l);break;case"ascii":case"binary":o=p(this,e,t,n);break;case"base64":i=this,a=t,l=n,o=s._charsWritten=k(R(e),i,a,l);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=m(this,e,t,n);break;default:throw new Error("Unknown encoding")}return o},s.prototype.toString=function(e,t,n){var r,s,o,i,a=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):a.length)===t)return"";switch(e){case"hex":r=function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var s="",o=t;o<n;o++)s+=L(e[o]);return s}(a,t,n);break;case"utf8":case"utf-8":r=function(e,t,n){var r="",s="";n=Math.min(e.length,n);for(var o=t;o<n;o++)e[o]<=127?(r+=N(s)+String.fromCharCode(e[o]),s=""):s+="%"+e[o].toString(16);return r+N(s)}(a,t,n);break;case"ascii":case"binary":r=f(a,t,n);break;case"base64":s=a,i=n,r=0===(o=t)&&i===s.length?h.fromByteArray(s):h.fromByteArray(s.slice(o,i));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=function(e,t,n){for(var r=e.slice(t,n),s="",o=0;o<r.length;o+=2)s+=String.fromCharCode(r[o]+256*r[o+1]);return s}(a,t,n);break;default:throw new Error("Unknown encoding")}return r},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(e,t,n,r){if(t=t||0,(r=r||0===r?r:this.length)!==(n=n||0)&&0!==e.length&&0!==this.length){B(n<=r,"sourceEnd < sourceStart"),B(0<=t&&t<e.length,"targetStart out of bounds"),B(0<=n&&n<this.length,"sourceStart out of bounds"),B(0<=r&&r<=this.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length);var o=(r=e.length-t<r-n?e.length-t+n:r)-n;if(o<100||!s._useTypedArrays)for(var i=0;i<o;i++)e[i+t]=this[i+n];else e._set(this.subarray(n,n+o),t)}},s.prototype.slice=function(e,t){var n=this.length;if(e=O(e,n,0),t=O(t,n,n),s._useTypedArrays)return s._augment(this.subarray(e,t));for(var r=t-e,o=new s(r,void 0,!0),i=0;i<r;i++)o[i]=this[i+e];return o},s.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},s.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},s.prototype.readUInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},s.prototype.readUInt16LE=function(e,t){return g(this,e,!0,t)},s.prototype.readUInt16BE=function(e,t){return g(this,e,!1,t)},s.prototype.readUInt32LE=function(e,t){return v(this,e,!0,t)},s.prototype.readUInt32BE=function(e,t){return v(this,e,!1,t)},s.prototype.readInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},s.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},s.prototype.readInt32LE=function(e,t){return x(this,e,!0,t)},s.prototype.readInt32BE=function(e,t){return x(this,e,!1,t)},s.prototype.readFloatLE=function(e,t){return b(this,e,!0,t)},s.prototype.readFloatBE=function(e,t){return b(this,e,!1,t)},s.prototype.readDoubleLE=function(e,t){return w(this,e,!0,t)},s.prototype.readDoubleBE=function(e,t){return w(this,e,!1,t)},s.prototype.writeUInt8=function(e,t,n){n||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"trying to write beyond buffer length"),U(e,255)),t>=this.length||(this[t]=e)},s.prototype.writeUInt16LE=function(e,t,n){T(this,e,t,!0,n)},s.prototype.writeUInt16BE=function(e,t,n){T(this,e,t,!1,n)},s.prototype.writeUInt32LE=function(e,t,n){_(this,e,t,!0,n)},s.prototype.writeUInt32BE=function(e,t,n){_(this,e,t,!1,n)},s.prototype.writeInt8=function(e,t,n){n||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"Trying to write beyond buffer length"),F(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},s.prototype.writeInt16LE=function(e,t,n){E(this,e,t,!0,n)},s.prototype.writeInt16BE=function(e,t,n){E(this,e,t,!1,n)},s.prototype.writeInt32LE=function(e,t,n){A(this,e,t,!0,n)},s.prototype.writeInt32BE=function(e,t,n){A(this,e,t,!1,n)},s.prototype.writeFloatLE=function(e,t,n){M(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){M(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){S(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){S(this,e,t,!1,n)},s.prototype.fill=function(e,t,n){if(t=t||0,n=n||this.length,B("number"==typeof(e="string"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),"value is not a number"),B(t<=n,"end < start"),n!==t&&0!==this.length){B(0<=t&&t<this.length,"start out of bounds"),B(0<=n&&n<=this.length,"end out of bounds");for(var r=t;r<n;r++)this[r]=e}},s.prototype.inspect=function(){for(var e=[],t=this.length,r=0;r<t;r++)if(e[r]=L(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer};var C=s.prototype;function O(e,t,n){return"number"!=typeof e?n:t<=(e=~~e)?t:0<=e||0<=(e+=t)?e:0}function P(e){return(e=~~Math.ceil(+e))<0?0:e}function I(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function L(e){return e<16?"0"+e.toString(16):e.toString(16)}function D(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else for(var s=n,o=(55296<=r&&r<=57343&&n++,encodeURIComponent(e.slice(s,n+1)).substr(1).split("%")),i=0;i<o.length;i++)t.push(parseInt(o[i],16))}return t}function R(e){return h.toByteArray(e)}function k(e,t,n,r){for(var s=0;s<r&&!(s+n>=t.length||s>=e.length);s++)t[s+n]=e[s];return s}function N(e){try{return decodeURIComponent(e)}catch{return"ï¿½"}}function U(e,t){B("number"==typeof e,"cannot write a non-number as a number"),B(0<=e,"specified a negative value for writing an unsigned value"),B(e<=t,"value is larger than maximum value for type"),B(Math.floor(e)===e,"value has a fractional component")}function F(e,t,n){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(n<=e,"value smaller than minimum allowed value"),B(Math.floor(e)===e,"value has a fractional component")}function z(e,t,n){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(n<=e,"value smaller than minimum allowed value")}function B(e,t){if(!e)throw new Error(t||"Failed assertion")}s._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=C.get,e.set=C.set,e.write=C.write,e.toString=C.toString,e.toLocaleString=C.toString,e.toJSON=C.toJSON,e.copy=C.copy,e.slice=C.slice,e.readUInt8=C.readUInt8,e.readUInt16LE=C.readUInt16LE,e.readUInt16BE=C.readUInt16BE,e.readUInt32LE=C.readUInt32LE,e.readUInt32BE=C.readUInt32BE,e.readInt8=C.readInt8,e.readInt16LE=C.readInt16LE,e.readInt16BE=C.readInt16BE,e.readInt32LE=C.readInt32LE,e.readInt32BE=C.readInt32BE,e.readFloatLE=C.readFloatLE,e.readFloatBE=C.readFloatBE,e.readDoubleLE=C.readDoubleLE,e.readDoubleBE=C.readDoubleBE,e.writeUInt8=C.writeUInt8,e.writeUInt16LE=C.writeUInt16LE,e.writeUInt16BE=C.writeUInt16BE,e.writeUInt32LE=C.writeUInt32LE,e.writeUInt32BE=C.writeUInt32BE,e.writeInt8=C.writeInt8,e.writeInt16LE=C.writeInt16LE,e.writeInt16BE=C.writeInt16BE,e.writeInt32LE=C.writeInt32LE,e.writeInt32BE=C.writeInt32BE,e.writeFloatLE=C.writeFloatLE,e.writeFloatBE=C.writeFloatBE,e.writeDoubleLE=C.writeDoubleLE,e.writeDoubleBE=C.writeDoubleBE,e.fill=C.fill,e.inspect=C.inspect,e.toArrayBuffer=C.toArrayBuffer,e}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,t,n){(function(n,r,s,o,i,a,l,c,u){s=e("buffer").Buffer;var h=4,d=new s(h);d.fill(0),t.exports={hash:function(e,t,n,r){for(var o=t(function(e,t){e.length%h!=0&&(n=e.length+(h-e.length%h),e=s.concat([e,d],n));for(var n,r=[],o=t?e.readInt32BE:e.readInt32LE,i=0;i<e.length;i+=h)r.push(o.call(e,i));return r}(e=s.isBuffer(e)?e:new s(e),r),8*e.length),i=(t=r,new s(n)),a=t?i.writeInt32BE:i.writeInt32LE,l=0;l<o.length;l++)a.call(i,o[l],4*l,!0);return i}}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,t,n){(function(t,r,s,o,i,a,l,c,u){s=e("buffer").Buffer;var h=e("./sha"),d=e("./sha256"),p=e("./rng"),m={sha1:h,sha256:d,md5:e("./md5")},f=64,g=new s(f);function v(e,t){var n=m[e=e||"sha1"],r=[];return n||y("algorithm:",e,"is not yet supported"),{update:function(e){return s.isBuffer(e)||(e=new s(e)),r.push(e),e.length,this},digest:function(e){var o=s.concat(r);return o=t?function(e,t,n){s.isBuffer(t)||(t=new s(t)),s.isBuffer(n)||(n=new s(n)),t.length>f?t=e(t):t.length<f&&(t=s.concat([t,g],f));for(var r=new s(f),o=new s(f),i=0;i<f;i++)r[i]=54^t[i],o[i]=92^t[i];return n=e(s.concat([r,n])),e(s.concat([o,n]))}(n,t,o):n(o),r=null,e?o.toString(e):o}}}function y(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}g.fill(0),n.createHash=function(e){return v(e)},n.createHmac=v,n.randomBytes=function(e,t){if(!t||!t.call)return new s(p(e));try{t.call(this,void 0,new s(p(e)))}catch(jd){t(jd)}};var x,b=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],w=function(e){n[e]=function(){y("sorry,",e,"is not implemented yet")}};for(x in b)w(b[x])}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,t,n){(function(n,r,s,o,i,a,l,c,u){var h=e("./helpers");function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,s=-1732584194,o=271733878,i=0;i<e.length;i+=16){var a=n,l=r,c=s,u=o;n=m(n,r,s,o,e[i+0],7,-680876936),o=m(o,n,r,s,e[i+1],12,-389564586),s=m(s,o,n,r,e[i+2],17,606105819),r=m(r,s,o,n,e[i+3],22,-1044525330),n=m(n,r,s,o,e[i+4],7,-176418897),o=m(o,n,r,s,e[i+5],12,1200080426),s=m(s,o,n,r,e[i+6],17,-1473231341),r=m(r,s,o,n,e[i+7],22,-45705983),n=m(n,r,s,o,e[i+8],7,1770035416),o=m(o,n,r,s,e[i+9],12,-1958414417),s=m(s,o,n,r,e[i+10],17,-42063),r=m(r,s,o,n,e[i+11],22,-1990404162),n=m(n,r,s,o,e[i+12],7,1804603682),o=m(o,n,r,s,e[i+13],12,-40341101),s=m(s,o,n,r,e[i+14],17,-1502002290),n=f(n,r=m(r,s,o,n,e[i+15],22,1236535329),s,o,e[i+1],5,-165796510),o=f(o,n,r,s,e[i+6],9,-1069501632),s=f(s,o,n,r,e[i+11],14,643717713),r=f(r,s,o,n,e[i+0],20,-373897302),n=f(n,r,s,o,e[i+5],5,-701558691),o=f(o,n,r,s,e[i+10],9,38016083),s=f(s,o,n,r,e[i+15],14,-660478335),r=f(r,s,o,n,e[i+4],20,-405537848),n=f(n,r,s,o,e[i+9],5,568446438),o=f(o,n,r,s,e[i+14],9,-1019803690),s=f(s,o,n,r,e[i+3],14,-187363961),r=f(r,s,o,n,e[i+8],20,1163531501),n=f(n,r,s,o,e[i+13],5,-1444681467),o=f(o,n,r,s,e[i+2],9,-51403784),s=f(s,o,n,r,e[i+7],14,1735328473),n=g(n,r=f(r,s,o,n,e[i+12],20,-1926607734),s,o,e[i+5],4,-378558),o=g(o,n,r,s,e[i+8],11,-2022574463),s=g(s,o,n,r,e[i+11],16,1839030562),r=g(r,s,o,n,e[i+14],23,-35309556),n=g(n,r,s,o,e[i+1],4,-1530992060),o=g(o,n,r,s,e[i+4],11,1272893353),s=g(s,o,n,r,e[i+7],16,-155497632),r=g(r,s,o,n,e[i+10],23,-1094730640),n=g(n,r,s,o,e[i+13],4,681279174),o=g(o,n,r,s,e[i+0],11,-358537222),s=g(s,o,n,r,e[i+3],16,-722521979),r=g(r,s,o,n,e[i+6],23,76029189),n=g(n,r,s,o,e[i+9],4,-640364487),o=g(o,n,r,s,e[i+12],11,-421815835),s=g(s,o,n,r,e[i+15],16,530742520),n=v(n,r=g(r,s,o,n,e[i+2],23,-995338651),s,o,e[i+0],6,-198630844),o=v(o,n,r,s,e[i+7],10,1126891415),s=v(s,o,n,r,e[i+14],15,-1416354905),r=v(r,s,o,n,e[i+5],21,-57434055),n=v(n,r,s,o,e[i+12],6,1700485571),o=v(o,n,r,s,e[i+3],10,-1894986606),s=v(s,o,n,r,e[i+10],15,-1051523),r=v(r,s,o,n,e[i+1],21,-2054922799),n=v(n,r,s,o,e[i+8],6,1873313359),o=v(o,n,r,s,e[i+15],10,-30611744),s=v(s,o,n,r,e[i+6],15,-1560198380),r=v(r,s,o,n,e[i+13],21,1309151649),n=v(n,r,s,o,e[i+4],6,-145523070),o=v(o,n,r,s,e[i+11],10,-1120210379),s=v(s,o,n,r,e[i+2],15,718787259),r=v(r,s,o,n,e[i+9],21,-343485551),n=y(n,a),r=y(r,l),s=y(s,c),o=y(o,u)}return Array(n,r,s,o)}function p(e,t,n,r,s,o){return y((t=y(y(t,e),y(r,o)))<<s|t>>>32-s,n)}function m(e,t,n,r,s,o,i){return p(t&n|~t&r,e,t,s,o,i)}function f(e,t,n,r,s,o,i){return p(t&r|n&~r,e,t,s,o,i)}function g(e,t,n,r,s,o,i){return p(t^n^r,e,t,s,o,i)}function v(e,t,n,r,s,o,i){return p(n^(t|~r),e,t,s,o,i)}function y(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}t.exports=function(e){return h.hash(e,d,16)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,t,n){(function(e,n,r,s,o,i,a,l,c){t.exports=function(e){for(var t,n=new Array(e),r=0;r<e;r++)!(3&r)&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,t,n){(function(n,r,s,o,i,a,l,c,u){var h=e("./helpers");function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var n,r,s,o=Array(80),i=1732584193,a=-271733879,l=-1732584194,c=271733878,u=-1009589776,h=0;h<e.length;h+=16){for(var d=i,f=a,g=l,v=c,y=u,x=0;x<80;x++){o[x]=x<16?e[h+x]:m(o[x-3]^o[x-8]^o[x-14]^o[x-16],1);var b=p(p(m(i,5),(b=a,r=l,s=c,(n=x)<20?b&r|~b&s:!(n<40)&&n<60?b&r|b&s|r&s:b^r^s)),p(p(u,o[x]),(n=x)<20?1518500249:n<40?1859775393:n<60?-1894007588:-899497514));u=c,c=l,l=m(a,30),a=i,i=b}i=p(i,d),a=p(a,f),l=p(l,g),c=p(c,v),u=p(u,y)}return Array(i,a,l,c,u)}function p(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function m(e,t){return e<<t|e>>>32-t}t.exports=function(e){return h.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,t,n){(function(n,r,s,o,i,a,l,c,u){function h(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function d(e,t){var n,r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),s=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),o=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var i,a,l=0;l<e.length;l+=16){for(var c=s[0],u=s[1],d=s[2],p=s[3],g=s[4],v=s[5],y=s[6],x=s[7],b=0;b<64;b++)o[b]=b<16?e[b+l]:h(h(h((a=o[b-2],m(a,17)^m(a,19)^f(a,10)),o[b-7]),(a=o[b-15],m(a,7)^m(a,18)^f(a,3))),o[b-16]),n=h(h(h(h(x,m(a=g,6)^m(a,11)^m(a,25)),g&v^~g&y),r[b]),o[b]),i=h(m(i=c,2)^m(i,13)^m(i,22),c&u^c&d^u&d),x=y,y=v,v=g,g=h(p,n),p=d,d=u,u=c,c=h(n,i);s[0]=h(c,s[0]),s[1]=h(u,s[1]),s[2]=h(d,s[2]),s[3]=h(p,s[3]),s[4]=h(g,s[4]),s[5]=h(v,s[5]),s[6]=h(y,s[6]),s[7]=h(x,s[7])}return s}var p=e("./helpers"),m=function(e,t){return e>>>t|e<<32-t},f=function(e,t){return e>>>t};t.exports=function(e){return p.hash(e,d,32,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,t,n){(function(e,t,r,s,o,i,a,l,c){n.read=function(e,t,n,r,s){var o,i,a=8*s-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?s-1:0,d=n?-1:1;for(s=e[t+h],h+=d,o=s&(1<<-u)-1,s>>=-u,u+=a;0<u;o=256*o+e[t+h],h+=d,u-=8);for(i=o&(1<<-u)-1,o>>=-u,u+=r;0<u;i=256*i+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return i?NaN:1/0*(s?-1:1);i+=Math.pow(2,r),o-=c}return(s?-1:1)*i*Math.pow(2,o-r)},n.write=function(e,t,n,r,s,o){var i,a,l=8*o-s-1,c=(1<<l)-1,u=c>>1,h=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1;for(o=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,i=c):(i=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-i))<1&&(i--,r*=2),2<=(t+=1<=i+u?h/r:h*Math.pow(2,1-u))*r&&(i++,r/=2),c<=i+u?(a=0,i=c):1<=i+u?(a=(t*r-1)*Math.pow(2,s),i+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,s),i=0));8<=s;e[n+d]=255&a,d+=p,a/=256,s-=8);for(i=i<<s|a,l+=s;0<l;e[n+d]=255&i,d+=p,i/=256,l-=8);e[n+d-p]|=128*o}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,t,n){(function(e,n,r,s,o,i,a,l,c){var u,h,d;function p(){}(e=t.exports={}).nextTick=(h=typeof window<"u"&&window.setImmediate,d=typeof window<"u"&&window.postMessage&&window.addEventListener,h?function(e){return window.setImmediate(e)}:d?(u=[],window.addEventListener("message",(function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<u.length&&u.shift()())}),!0),function(e){u.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)),Du.exports);const ku=Pu(Ru);var Nu,Uu,Fu,zu,Bu,ju,Hu,Vu,Xu,Yu,Wu,Gu,Zu,Ku;function Qu(){return Uu||(Uu=1,Nu=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]),Nu}function qu(){return ju||(ju=1,Bu=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]),Bu}function Ju(){if(Gu)return Wu;Gu=1,Wu=function(b){var w,T,_,E=0,A=0,M=o,S=[],C=[],O=1,P=0,I=0,L=!1,D=!1,R="";b=b||{};var k=n,N=e;"300 es"===b.version&&(k=s,N=r);var U={},F={};for(E=0;E<k.length;E++)U[k[E]]=!0;for(E=0;E<N.length;E++)F[N[E]]=!0;return function(e){return C=[],null!==e?function(e){E=0,e.toString&&(e=e.toString()),R+=e.replace(/\r\n/g,"\n"),_=R.length;for(var t;w=R[E],E<_;){switch(t=E,M){case a:E=X();break;case l:E=V();break;case c:E=H();break;case u:E=Y();break;case h:E=Z();break;case y:E=G();break;case d:E=K();break;case i:E=Q();break;case g:E=j();break;case o:E=B()}if(t!==E)if("\n"===R[t])P=0,++O;else++P}return A+=E,R=R.slice(E),C}(e):(S.length&&z(S.join("")),M=v,z("(eof)"),C)};function z(e){e.length&&C.push({type:x[M],data:e,position:I,line:O,column:P})}function B(){return S=S.length?[]:S,"/"===T&&"*"===w?(I=A+E-1,M=a,T=w,E+1):"/"===T&&"/"===w?(I=A+E-1,M=l,T=w,E+1):"#"===w?(M=c,I=A+E,E):/\s/.test(w)?(M=g,I=A+E,E):(L=/\d/.test(w),D=/[^\w_]/.test(w),I=A+E,M=L?h:D?u:i,E)}function j(){return/[^\s]/g.test(w)?(z(S.join("")),M=o,E):(S.push(w),T=w,E+1)}function H(){return"\r"!==w&&"\n"!==w||"\\"===T?(S.push(w),T=w,E+1):(z(S.join("")),M=o,E)}function V(){return H()}function X(){return"/"===w&&"*"===T?(S.push(w),z(S.join("")),M=o,E+1):(S.push(w),T=w,E+1)}function Y(){if("."===T&&/\d/.test(w))return M=d,E;if("/"===T&&"*"===w)return M=a,E;if("/"===T&&"/"===w)return M=l,E;if("."===w&&S.length){for(;W(S););return M=d,E}if(";"===w||")"===w||"("===w){if(S.length)for(;W(S););return z(w),M=o,E+1}var e=2===S.length&&"="!==w;if(/[\w_\d\s]/.test(w)||e){for(;W(S););return M=o,E}return S.push(w),T=w,E+1}function W(e){for(var n,r,s=0;;){if(n=t.indexOf(e.slice(0,e.length+s).join("")),r=t[n],-1===n){if(s--+e.length>0)continue;r=e.slice(0,1).join("")}return z(r),I+=r.length,(S=S.slice(r.length)).length}}function G(){return/[^a-fA-F0-9]/.test(w)?(z(S.join("")),M=o,E):(S.push(w),T=w,E+1)}function Z(){return"."===w||/[eE]/.test(w)?(S.push(w),M=d,T=w,E+1):"x"===w&&1===S.length&&"0"===S[0]?(M=y,S.push(w),T=w,E+1):/[^\d]/.test(w)?(z(S.join("")),M=o,E):(S.push(w),T=w,E+1)}function K(){return"f"===w&&(S.push(w),T=w,E+=1),/[eE]/.test(w)||("-"===w||"+"===w)&&/[eE]/.test(T)?(S.push(w),T=w,E+1):/[^\d]/.test(w)?(z(S.join("")),M=o,E):(S.push(w),T=w,E+1)}function Q(){if(/[^\d\w_]/.test(w)){var e=S.join("");return M=F[e]?f:U[e]?m:p,z(S.join("")),M=o,E}return S.push(w),T=w,E+1}};var e=Qu(),t=(zu||(zu=1,Fu=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]),Fu),n=qu(),r=function(){if(Vu)return Hu;Vu=1;var e=Qu();return Hu=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])}(),s=function(){if(Yu)return Xu;Yu=1;var e=qu();return e=e.slice().filter((function(e){return!/^(gl\_|texture)/.test(e)})),Xu=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])}(),o=999,i=9999,a=0,l=1,c=2,u=3,h=4,d=5,p=6,m=7,f=8,g=9,v=10,y=11,x=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];return Wu}var $u=function(){if(Ku)return Zu;Ku=1;var e=Ju();return Zu=function(t,n){var r=e(n),s=[];return s=s.concat(r(t)),s=s.concat(r(null))},Zu}();const eh=Pu($u);var th,nh;var rh=(nh||(nh=1,th=function(e){for(var t=[],n=0;n<e.length;n++)"eof"!==e[n].type&&t.push(e[n].data);return t.join("")}),th);const sh=Pu(rh);var oh,ih;var ah=function(){if(ih)return oh;function e(e){return function(t){return"operator"===t.type&&(!e||t.data===e)}}function t(e){return"whitespace"!==e.type}return ih=1,oh=function(n){var r,s,o,i=null,a=null,l=0,c=0,u=0,h=0,d=0,p=[];for(r=0;r<n.length;r++)if("{"===(o=n[r]).data){if(l&&l++||(s=f(r,e(")"),e()))<0||(h=s,(s=f(s,e("("),e(")")))<0)||(d=s,(s=f(s,t))<0)||"ident"!==n[s].type||(a=n[s].data,(s=f(s,t))<0))continue;l=1,c=r,i=n[s].data,u=s;var m=f(s,t);switch(n[m]&&n[m].data){case"lowp":case"highp":case"mediump":u=m}}else if(l&&"}"===o.data){if(--l)continue;p.push({name:a,type:i,body:[c+1,r],args:[d,h+1],outer:[u,r+1]})}for(r=0;r<n.length;r++)if(";"===(o=n[r]).data){if((s=f(r,e(")"),e()))<0||(h=s,(s=f(s,e("("),e(")")))<0)||(d=s,(s=f(s,t))<0)||"ident"!==n[s].type||(a=n[s].data,(s=f(s,t))<0)||"operator"===n[s].type||"return"===n[s].data)continue;i=n[s].data,p.push({name:a,type:i,body:!1,args:[d,h+1],outer:[s,r+1]})}return p.sort((function(e,t){return e.outer[0]-t.outer[0]}));function f(e,t,r){for(var s=e-1;s>=0;s--){if(t(n[s]))return s;if(r&&r(n[s]))return-1}return-1}},oh}();const lh=Pu(ah);function ch(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function uh(e,t,n){return(t=ch(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hh(Object(n),!0).forEach((function(t){uh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ph(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function mh(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ch(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gh(e,t){return(gh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function vh(e){return vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vh(e)}function yh(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}();return function(){var n,r=vh(e);if(t){var s=vh(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fh(e)}(this,n)}}var xh,bh,wh,Th="csm_Position",_h="csm_PositionRaw",Eh="csm_PointSize",Ah="csm_FragColor",Mh="csm_DiffuseColor",Sh="csm_Normal",Ch="csm_Roughness",Oh="csm_Metalness",Ph="csm_Emissive",Ih="csm_AO",Lh="csm_Bump",Dh="csm_DepthAlpha",Rh=(uh(xh={},"".concat(Sh),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(Sh,";\n    #ifdef USE_TANGENT\n\t    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),uh(xh,"".concat(Th),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(Th,";\n  ")}),uh(xh,"".concat(_h),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(_h,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),uh(xh,"".concat(Eh),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(Eh,";\n    ")}),uh(xh,"".concat(Mh),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(Mh,";\n  ")}),uh(xh,"".concat(Ah),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(Ah,";\n  ")}),uh(xh,"".concat(Ph),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(Ph,";\n    ")}),uh(xh,"".concat(Ch),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(Ch,";\n    ")}),uh(xh,"".concat(Oh),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(Oh,";\n    ")}),uh(xh,"".concat(Ih),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(Ih,";\n    ")}),uh(xh,"".concat(Lh),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(Lh," - (dot(").concat(Lh,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),uh(xh,"".concat(Dh),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(Dh," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(Dh,";\n    ")}),xh),kh=(uh(bh={},"".concat(Th),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(Th,", 1.0 );\n  ")}),uh(bh,"".concat(_h),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(Th,";\n  ")}),uh(bh,"".concat(Mh),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(Mh,";\n  ")}),uh(bh,"".concat(Ah),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(Ah,";\n  ")}),bh),Nh=(uh(wh={},"".concat(Th),"*"),uh(wh,"".concat(_h),"*"),uh(wh,"".concat(Sh),"*"),uh(wh,"".concat(Eh),["PointsMaterial"]),uh(wh,"".concat(Mh),"*"),uh(wh,"".concat(Ah),"*"),uh(wh,"".concat(Ph),["MeshStandardMaterial","MeshPhysicalMaterial"]),uh(wh,"".concat(Ch),["MeshStandardMaterial","MeshPhysicalMaterial"]),uh(wh,"".concat(Oh),["MeshStandardMaterial","MeshPhysicalMaterial"]),uh(wh,"".concat(Ih),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),uh(wh,"".concat(Lh),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),uh(wh,"".concat(Dh),"*"),wh),Uh=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"];function Fh(e){var t=e.toString().trim();return 0===t.substring(t.indexOf("{")+1,t.lastIndexOf("}")).trim().length}function zh(e){return e.replace(/\s/g,"")}var Bh=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gh(e,t)}(t,Fe);var e=yh(t);function t(n){var r,s,o=n.baseMaterial,i=n.fragmentShader,a=n.vertexShader,l=n.uniforms,c=n.patchMap,u=n.cacheKey,h=n.silent,d=ph(n,Uh);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(t){try{new t}catch(e){if(e.message.indexOf("is not a constructor")>=0)return!1}return!0}(o)?s=new o(d):(s=o,Object.assign(s,d)),"RawShaderMaterial"===s.type)throw new Error("CustomShaderMaterial does not support RawShaderMaterial");(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object.assign(e,t);var r=Object.getPrototypeOf(t);Object.entries(Object.getOwnPropertyDescriptors(r)).filter((function(e){var t="function"==typeof e[1].get,n="function"==typeof e[1].set,r="function"==typeof e[1].value,s="constructor"===e[0];return(t||n||r)&&!s})).forEach((function(t){if("function"!=typeof e[t[0]])Object.defineProperty(e,t[0],t[1]);else{n||console.warn("Function ".concat(t[0]," already exists on CSM, renaming to base_").concat(t[0]));var r="base_".concat(t[0]);e[r]=t[1].value.bind(e)}}))})(fh(r=e.call(this)),s,h),r.__csm={patchMap:c||{},fragmentShader:i||"",vertexShader:a||"",cacheKey:u,baseMaterial:o,instanceID:T.generateUUID(),type:s.type,isAlreadyExtended:!Fh(s.onBeforeCompile),cacheHash:"",silent:h},r.uniforms=dh(dh({},r.uniforms||{}),l||{});var p=r.__csm,m=p.fragmentShader,f=p.vertexShader,g=r.uniforms;return r.__csm.cacheHash=r.getCacheHash(),r.generateMaterial(m,f,g),r}return mh(t,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.uniforms=e.uniforms||this.uniforms,Object.assign(this.__csm,e);var t=this.__csm,n=t.fragmentShader,r=t.vertexShader,s=this.uniforms,o=this.getCacheHash();this.__csm.cacheHash=o,this.generateMaterial(n,r,s)}},{key:"clone",value:function(){var e={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},t=new this.constructor(e);return Object.assign(this,t),t}},{key:"getCacheHash",value:function(){var e=this.__csm,t=e.fragmentShader,n=e.vertexShader,r=this.uniforms,s=Object.values(r).reduce((function(e,t){var n=t.value;return e+JSON.stringify(n)}),""),o=zh(t)+zh(n)+s;return o.trim().length>0?ku(o):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(e,t,n){var r=this,s=this.parseShader(e),o=this.parseShader(t);this.uniforms=n||{},this.customProgramCacheKey=function(){return r.__csm.cacheHash};var i=function(e){try{if(s){var t=r.patchShader(s,e.fragmentShader,!0);e.fragmentShader=r.getMaterialDefine()+t}if(o){var n=r.patchShader(o,e.vertexShader);e.vertexShader="#define IS_VERTEX;\n"+n,e.vertexShader=r.getMaterialDefine()+e.vertexShader}e.uniforms=dh(dh({},e.uniforms),r.uniforms),r.uniforms=e.uniforms}catch(i){console.error(i)}};if(this.__csm.isAlreadyExtended){var a=this.onBeforeCompile;this.onBeforeCompile=function(e,t){a(e,t),i(e)}}else this.onBeforeCompile=i;this.needsUpdate=!0}},{key:"patchShader",value:function(e,t,n){var r=this,s=t,o=dh(dh({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(o).forEach((function(t){Object.keys(o[t]).forEach((function(n){var i=Nh[t],a=r.__csm.type;if("*"===t||function(e,t){return new RegExp("\\b".concat(function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t),"\\b")).test(e)}(e.main,t)){if(!(!i||Array.isArray(i)&&i.includes(a)||"*"===i))throw new Error("CSM: ".concat(t," is not available in ").concat(a,". Shader cannot compile."));s=function(e,t,n){return e.split(t).join(n)}(s,n,o[t][n])}}))})),s=s.replace("void main() {","\n        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED\n          ".concat("\n    varying mat4 csm_internal_vModelViewMatrix;\n","\n          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1\n        #endif\n\n        ").concat(e.header,"\n        \n        void main() {\n          #ifndef CSM_IS_DEFAULTS_DEFINED\n            ").concat("\n\n#ifdef IS_VERTEX\n    // csm_Position & csm_PositionRaw\n    #ifdef IS_UNKNOWN\n        vec3 csm_Position = vec3(0.0);\n        vec4 csm_PositionRaw = vec4(0.0);\n        vec3 csm_Normal = vec3(0.0);\n    #else\n        vec3 csm_Position = position;\n        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n        vec3 csm_Normal = normal;\n    #endif\n\n    // csm_PointSize\n    #ifdef IS_POINTSMATERIAL\n        float csm_PointSize = size;\n    #endif\n#else\n    // csm_DiffuseColor & csm_FragColor\n    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL\n        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);\n        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    #else\n        #ifdef USE_MAP\n            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);\n\n            #ifdef DECODE_VIDEO_TEXTURE\n            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)\n            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);\n            #endif\n\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n        #else\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity);\n            vec4 csm_FragColor = vec4(diffuse, opacity);\n        #endif\n    #endif\n\n    // csm_Emissive, csm_Roughness, csm_Metalness\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL\n        vec3 csm_Emissive = emissive;\n        float csm_Roughness = roughness;\n        float csm_Metalness = metalness;\n    #endif\n\n    // csm_AO\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL\n        float csm_AO = 0.0;\n    #endif\n\n    // csm_Bump\n    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL \n        vec3 csm_Bump = vec3(0.0);\n    #endif\n\n    float csm_DepthAlpha = 1.0;\n#endif\n","\n            #define CSM_IS_DEFAULTS_DEFINED 1\n          #endif\n          \n          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED\n            ").concat(n?"\n    \n":"\n    csm_internal_vModelViewMatrix = modelViewMatrix;\n","\n            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1\n          #endif\n\n          // CSM_START\n      "));var i=this.__csm.isAlreadyExtended,a=s.includes("// CSM_END");return s=i&&a?function(e,t,n){var r=e.lastIndexOf(t);return-1===r?e:e.substring(0,r)+n+e.substring(r+t.length)}(s,"// CSM_END","\n          // CSM_END\n          ".concat(e.main,"\n          // CSM_END\n        ")):s.replace("// CSM_START","\n        // CSM_START\n        ".concat(e.main,"\n        // CSM_END\n          ")),s=e.defines+s}},{key:"parseShader",value:function(e){if(e){var t=e.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),n=eh(t),r=lh(n),s=r.map((function(e){return e.name})).indexOf("main");return{defines:"",header:sh(n.slice(0,s>=0?r[s].outer[0]:void 0)),main:s>=0?this.getShaderFromIndex(n,r[s].body):""}}}},{key:"getMaterialDefine",value:function(){var e=this.__csm.type;return e?"#define IS_".concat(e.toUpperCase(),";\n"):"#define IS_UNKNOWN;\n"}},{key:"getPatchMapForMaterial",value:function(){return"ShaderMaterial"===this.__csm.type?kh:Rh}},{key:"getShaderFromIndex",value:function(e,t){return sh(e.slice(t[0],t[1]))}}]),t}();const jh=["args"],Hh=It({__name:"index",props:{baseMaterial:{type:Function},vertexShader:{},fragmentShader:{},silent:{type:Boolean},uniforms:{}},setup(e,{expose:t}){const n=e,r=Dt(null),{extend:s,invalidate:o}=Kr();return s({CustomShaderMaterial:Bh}),Nt(n,(()=>o())),t({instance:r}),(e,t)=>(Ft(),Rt("TresCustomShaderMaterial",{ref_key:"customShaderMaterialClass",ref:r,args:[n]},null,8,jh))}});class Vh extends oe{constructor(e={}){super(),Ns(this,"isMeshPhysicalMaterial"),Ns(this,"clearcoatMap"),Ns(this,"clearcoatRoughness"),Ns(this,"clearcoatRoughnessMap"),Ns(this,"clearcoatNormalScale"),Ns(this,"clearcoatNormalMap"),Ns(this,"ior"),Ns(this,"transmissionMap"),Ns(this,"thickness"),Ns(this,"thicknessMap"),Ns(this,"attenuationDistance"),Ns(this,"attenuationColor"),Ns(this,"specularIntensity"),Ns(this,"specularIntensityMap"),Ns(this,"specularColor"),Ns(this,"specularColorMap"),Ns(this,"_clearcoat"),Ns(this,"_transmission"),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new S(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get(){return T.clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.roughness=0,this.transmissionMap=null,this.thickness=.5,this.thicknessMap=null,this.attenuationDistance=Number.POSITIVE_INFINITY,this.attenuationColor=new g(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new g(1,1,1),this.specularColorMap=null,this._clearcoat=.5,this._transmission=1,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const Xh=It({__name:"index",setup(e,{expose:t}){const n=Dt(),{extend:r}=Kr();return r({MeshGlassMaterial:Vh}),t({instance:n}),(e,t)=>(Ft(),Rt("TresMeshGlassMaterial",{ref_key:"MeshGlassMaterialClass",ref:n},null,512))}});class Yh extends oe{constructor(e={}){super(e),Ns(this,"_time"),Ns(this,"_factor"),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms||(e.uniforms={}),e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`\n        uniform float time;\n        uniform float factor;\n        ${e.vertexShader}\n      `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n          float c = cos( theta );\n          float s = sin( theta );\n          mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n          vec3 transformed = vec3( position ) * m;\n          vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const Wh=["factor"],Gh=It({__name:"index",props:{speed:{default:1},factor:{default:1}},setup(e,{expose:t}){const n=e,r=Dt(),{extend:s,invalidate:o}=Kr();s({MeshWobbleMaterial:Yh}),Nt(n,(()=>o()));const{onBeforeRender:i}=Qr();return i((({elapsed:e,invalidate:t})=>{r.value&&(r.value.time=e*(null==n?void 0:n.speed),t())})),t({instance:r}),(e,t)=>(Ft(),Rt("TresMeshWobbleMaterial",tn({ref_key:"materialRef",ref:r,factor:e.factor},e.$attrs),null,16,Wh))}});const Zh=new C(0,0,0),Kh=new C(0,0,0),Qh=new C(0,0,0);function qh(e,t,n){const r=Zh.setFromMatrixPosition(e.matrixWorld);r.project(t);const s=n.width/2,o=n.height/2;return[(Number.isNaN(r.x)?0:r.x)*s+s,-r.y*o+o,r.z]}const Jh=e=>Math.abs(e)<1e-10?0:e;function $h(e,t,n=""){let r="matrix3d(";for(let s=0;16!==s;s++)r+=Jh(t[s]*e.elements[s])+(15!==s?",":")");return n+r}const ed=(e=>t=>$h(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),td=(()=>(e,t)=>$h(e,(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1])(t),"translate(-50%,-50%)"))(),nd=["geometry","material"],rd=It({__name:"HTML",props:{geometry:{default:new D},material:{},as:{default:"div"},transform:{type:Boolean,default:!1},portal:{},wrapperClass:{},eps:{default:1e-4},distanceFactor:{},fullscreen:{type:Boolean},center:{type:Boolean},pointerEvents:{default:"auto"},sprite:{type:Boolean,default:!1},zIndexRange:{default:()=>[16777271,0]},occlude:{type:[Object,null,Array,Boolean,String]}},emits:["onOcclude"],setup(e,{expose:t,emit:r}){const s=e,o=r,i=Lt(),a=rn(),l=Ot(),c=Ot(),{geometry:u,material:h,as:d,transform:p,portal:m,wrapperClass:f,eps:g,distanceFactor:v,fullscreen:y,center:x,pointerEvents:b,sprite:w,occlude:T,zIndexRange:_}=Jt(s),{renderer:E,scene:A,camera:M,raycaster:O,sizes:I}=Kr(),L=Wt((()=>document.createElement(d.value))),D=Ot([0,0,0]),k=Ot(0),N=Ot(),U=Wt((()=>p.value?{position:"absolute",top:0,left:0,width:`${I.width.value}px`,height:`${I.height.value}px`,transformStyle:"preserve-3d",pointerEvents:"none",zIndex:2}:{position:"absolute",transform:x.value?"translate3d(-50%,-50%,0)":"none",...y.value&&{top:-I.height.value/2,left:-I.width.value/2,width:`${I.width.value}px`,height:`${I.height.value}px`},zIndex:2,...Object.assign({},a.style)})),F=Wt((()=>({position:"absolute",pointerEvents:b.value}))),z=Ot(null),B=Ot(!1),j=Wt((()=>(null==T?void 0:T.value)&&"blending"!==(null==T?void 0:T.value)||Array.isArray(null==T?void 0:T.value)&&(null==T?void 0:T.value.length)&&qt(T.value[0])));Nt((()=>T),(({value:e})=>{"blending"===e?(L.value.style.zIndex=`${Math.floor(_.value[0]/2)}`,L.value.style.position="absolute",L.value.style.pointerEvents="none"):(L.value.style.zIndex=null,L.value.style.position=null,L.value.style.pointerEvents=null)})),Nt((()=>{var e;return[l.value,E.value,I.width.value,I.height.value,null==(e=i.default)?void 0:e.call(i)]}),(([e,t])=>{var n,r,s,o,l,u;if(e&&t){const h=(null==m?void 0:m.value)||t.domElement;if(null==(n=A.value)||n.updateMatrixWorld(),p.value)L.value.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=qh(e,M.value,{width:I.width.value,height:I.height.value});L.value.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${t[0]}px,${t[1]}px,0);transform-origin:0 0;`}h&&!L.value.parentNode&&(null==(r=h.parentNode)||r.appendChild(L.value)),p.value?N.value=sn("div",{id:"outer",style:U.value},[sn("div",{id:"inner",style:F.value},[sn("div",{key:null==(s=c.value)?void 0:s.uuid,id:null==A?void 0:A.value.uuid,class:a.class,style:a.style},null==(o=i.default)?void 0:o.call(i))])]):N.value=sn("div",{key:null==(l=c.value)?void 0:l.uuid,id:null==A?void 0:A.value.uuid,style:U.value},null==(u=i.default)?void 0:u.call(i)),on(N.value,L.value)}})),Xt((()=>{null!=f&&f.value&&(L.value.className=f.value)}));const V=Ot(!0),{onBeforeRender:X}=Qr();X((({invalidate:e})=>{var t,r,s,i,h,d,m;if(e(),l.value&&M.value&&E.value){null==(t=M.value)||t.updateMatrixWorld(),l.value.updateWorldMatrix(!0,!1);const e=p.value?D.value:qh(l.value,M.value,{width:I.width.value||0,height:I.height.value||0});if(p.value||Math.abs(k.value-M.value.zoom)>g.value||Math.abs(D.value[0]-e[0])>g.value||Math.abs(D.value[1]-e[1])>g.value||Math.abs(D.value[2]-e[2])>g.value){const t=function(e,t){const n=Zh.setFromMatrixPosition(e.matrixWorld),r=Kh.setFromMatrixPosition(t.matrixWorld),s=n.sub(r),o=t.getWorldDirection(Qh);return s.angleTo(o)>Math.PI/2}(l.value,M.value);let i=!1;j.value&&(Array.isArray(null==T?void 0:T.value)?i=null==T?void 0:T.value:"blending"!==(null==T?void 0:T.value)&&(i=[A.value]));const a=V.value;if(i){const e=function(e,t,n,r){const s=Zh.setFromMatrixPosition(e.matrixWorld),o=s.clone();o.project(t),n.setFromCamera(new S(o.x,o.y),t);const i=n.intersectObjects(r,!0);if(i.length>0){const e=i[0].distance;return s.distanceTo(n.ray.origin)<e}return!0}(l.value,M.value,O.value,i);V.value=e&&!t}else V.value=!t;a!==V.value&&(o("onOcclude",!V.value),L.value.style.display=V.value?"block":"none");const c=Math.floor(_.value[0]/2),u=null!=T&&T.value?j.value?[_.value[0],c]:[c-1,0]:_.value;if(L.value.style.zIndex=`${function(e,t,r){if(t instanceof n||t instanceof H){const n=Zh.setFromMatrixPosition(e.matrixWorld),s=Kh.setFromMatrixPosition(t.matrixWorld),o=n.distanceTo(s),i=(r[1]-r[0])/(t.far-t.near),a=r[1]-i*t.far;return Math.round(i*o+a)}}(l.value,M.value,u)}`,p.value){const[e,t]=[I.width.value/2,I.height.value/2],n=M.value.projectionMatrix.elements[5]*t,{isOrthographicCamera:o,top:i,left:a,bottom:c,right:u}=M.value,h=ed(M.value.matrixWorldInverse),d=o?`scale(${n})translate(${Jh(-(u+a)/2)}px,${Jh((i+c)/2)}px)`:`translateZ(${n}px)`;let p=l.value.matrixWorld;if(w.value&&(p=M.value.matrixWorldInverse.clone().transpose().copyPosition(p).scale(l.value.scale),p.elements[3]=p.elements[7]=p.elements[11]=0,p.elements[15]=1),L.value.style.width=`${I.width.value}px`,L.value.style.height=`${I.height.value}px`,L.value.style.perspective=o?"":`${n}px`,null!=(r=N.value)&&r.el&&null!=(s=N.value)&&s.children&&Array.isArray(N.value.children)){N.value.el.style.transform=`${d}${h}translate(${e}px,${t}px)`;const n=N.value.children[0];n&&n.el&&(n.el.style.transform=td(p,1/(((null==v?void 0:v.value)||10)/400)))}}else{const t=void 0===(null==v?void 0:v.value)?1:function(e,t){if(t instanceof H)return t.zoom;if(t instanceof n){const n=Zh.setFromMatrixPosition(e.matrixWorld),r=Kh.setFromMatrixPosition(t.matrixWorld),s=t.fov*Math.PI/180,o=n.distanceTo(r);return 1/(2*Math.tan(s/2)*o)}return 1}(l.value,M.value)*(null==v?void 0:v.value);L.value.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}}D.value=e,k.value=M.value.zoom}if(!j.value&&c.value&&!B.value)if(p.value){if(null!=(i=N.value)&&i.el&&null!=(h=N.value)&&h.children){const e=(null==(d=N.value)?void 0:d.children)[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=M.value;if(t||u)a.scale&&(Array.isArray(a.scale)?a.scale instanceof C?c.value.scale.copy(a.scale.clone().divideScalar(1)):c.value.scale.set(1/a.scale[0],1/a.scale[1],1/a.scale[2]):c.value.scale.setScalar(1/a.scale));else{const t=((null==v?void 0:v.value)||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;c.value.scale.set(n,r,1)}B.value=!0}}}else{const e=L.value.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const t=1*e.clientWidth,n=1*e.clientHeight;c.value.scale.set(t,n,1),B.value=!0}z.value.lookAt(null==(m=M.value)?void 0:m.position)}}));const Y=Wt((()=>({vertexShader:p.value?void 0:"#include <common>\n\nvoid main() {\n  vec2 center = vec2(0., 1.);\n  float rotation = 0.0;\n\n  \n  \n  float size = 0.03;\n\n  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n  bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n  if ( isPerspective ) scale *= - mvPosition.z;\n\n  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n  mvPosition.xy += rotatedPosition;\n\n  gl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"void main() {\n  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n}"}))),W=Wt((()=>{const e=Y.value;return h.value||new R({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:P})}));return Ut((()=>{W.value&&W.value.dispose(),L.value.remove()})),t({instance:l}),(e,t)=>(Ft(),Rt("TresGroup",{ref_key:"groupRef",ref:l},[Bt(T)&&!j.value?(Ft(),Rt("TresMesh",{key:0,ref_key:"meshRef",ref:c,geometry:Bt(u),material:W.value},null,8,nd)):$t("",!0)],512))}});var sd,od={exports:{}};sd||(sd=1,od.exports=function(){var e=function(){function t(e){return s.appendChild(e.dom),e}function n(e){for(var t=0;t<s.children.length;t++)s.children[t].style.display=t===e?"block":"none";r=e}var r=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",(function(e){e.preventDefault(),n(++r%s.children.length)}),!1);var o=(performance||Date).now(),i=o,a=0,l=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:s,addPanel:t,showPanel:n,begin:function(){o=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-o,200),e>i+1e3&&(l.update(1e3*a/(e-i),100),i=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:s,setMode:n}};return e.Panel=function(e,t,n){var r=1/0,s=0,o=Math.round,i=o(window.devicePixelRatio||1),a=80*i,l=48*i,c=3*i,u=2*i,h=3*i,d=15*i,p=74*i,m=30*i,f=document.createElement("canvas");f.width=a,f.height=l,f.style.cssText="width:80px;height:48px";var g=f.getContext("2d");return g.font="bold "+9*i+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,c,u),g.fillRect(h,d,p,m),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,d,p,m),{dom:f,update:function(l,v){r=Math.min(r,l),s=Math.max(s,l),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=t,g.fillText(o(l)+" "+e+" ("+o(r)+"-"+o(s)+")",c,u),g.drawImage(f,h+i,d,p-i,m,h,d,p-i,m),g.fillRect(h+p-i,d,i,m),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+p-i,d,i,o((1-l/v)*m))}}},e}());const id=["args"],ad=["color"],ld=It({__name:"Box",props:{args:{default:()=>[1,1,1]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{invalidate:r}=Kr(),{args:s,color:o}=Jt(n);Nt(s,(()=>r()));const i=Dt();return t({instance:i}),(e,t)=>(Ft(),Rt("TresMesh",tn({ref_key:"boxRef",ref:i},e.$attrs),[nn("TresBoxGeometry",{args:Bt(s)},null,8,id),en(e.$slots,"default",{},(()=>[nn("TresMeshBasicMaterial",{color:Bt(o)},null,8,ad)]))],16))}}),cd=["args"],ud=["color"],hd=It({__name:"Cone",props:{args:{default:()=>[1,1,12,12,!1,0,2*Math.PI]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{args:r,color:s}=Jt(n),{invalidate:o}=Kr();Nt(r,(()=>o()));const i=Dt();return t({instance:i}),(e,t)=>(Ft(),Rt("TresMesh",tn({ref_key:"coneRef",ref:i},e.$attrs),[nn("TresConeGeometry",{args:Bt(r)},null,8,cd),en(e.$slots,"default",{},(()=>[nn("TresMeshBasicMaterial",{color:Bt(s)},null,8,ud)]))],16))}}),dd=["rotation"],pd=["args"],md=["color"],fd=It({__name:"Plane",props:{args:{default:()=>[1,1]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{args:r,color:s}=Jt(n),{invalidate:o}=Kr();Nt(r,(()=>o()));const i=Dt();return t({instance:i}),(e,t)=>(Ft(),Rt("TresMesh",tn({ref_key:"planeRef",ref:i,rotation:[-Math.PI/2,0,0]},e.$attrs),[nn("TresPlaneGeometry",{args:Bt(r)},null,8,pd),en(e.$slots,"default",{},(()=>[nn("TresMeshBasicMaterial",{color:Bt(s)},null,8,md)]))],16,dd))}}),gd=["args"],vd=["color"],yd=It({__name:"Sphere",props:{args:{default:()=>[2,32,16]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{args:r,color:s}=Jt(n),{invalidate:o}=Kr();Nt(r,(()=>o()));const i=Dt();return t({instance:i}),(e,t)=>(Ft(),Rt("TresMesh",tn({ref_key:"sphereRef",ref:i},e.$attrs),[nn("TresSphereGeometry",{args:Bt(r)},null,8,gd),en(e.$slots,"default",{},(()=>[nn("TresMeshBasicMaterial",{color:Bt(s)},null,8,vd)]))],16))}}),xd=["object"],bd=It({__name:"ContactShadows",props:{opacity:{default:1},blur:{default:1},color:{default:"#000000"},tint:{default:void 0},scale:{default:10},width:{default:1},height:{default:1},far:{default:10},smooth:{type:Boolean,default:!0},resolution:{default:512},frames:{default:Number.POSITIVE_INFINITY},depthWrite:{type:Boolean,default:!1}},setup(e,{expose:t}){const n=e;function r(e,t,n){n.blurPlane.visible=!0,n.blurPlane.material=n.horizontalBlurMaterial,n.horizontalBlurMaterial.uniforms.tDiffuse.value=n.renderTarget.texture,n.horizontalBlurMaterial.uniforms.h.value=e/256,t.setRenderTarget(n.renderTargetBlur),t.render(n.blurPlane,n.shadowCamera),n.blurPlane.material=n.verticalBlurMaterial,n.verticalBlurMaterial.uniforms.tDiffuse.value=n.renderTargetBlur.texture,n.verticalBlurMaterial.uniforms.v.value=e/256,t.setRenderTarget(n.renderTarget),t.render(n.blurPlane,n.shadowCamera),n.blurPlane.visible=!1}const{onBeforeRender:s}=Qr(),o=function(e){const t=new B,n=new j(e.resolution,e.resolution);n.texture.generateMipmaps=!1;const r=new j(e.resolution,e.resolution);r.texture.generateMipmaps=!1;const s=new D(e.width,e.height).rotateX(Math.PI/2),o=new m({map:n.texture,opacity:e.opacity,transparent:!0,depthWrite:e.depthWrite,color:new g(e.color??"black")}),i=new p(s,o);t.add(i),i.scale.y=-1;const a=new p(s);a.visible=!1,t.add(a);const l=new H(-e.width/2,e.width/2,e.height/2,-e.height/2,0,.3);l.rotation.x=Math.PI/2,t.add(l);const c=new V,u=new R(ml);u.depthTest=!1;const h=new R(fl);return h.depthTest=!1,{renderTarget:n,renderTargetBlur:r,shadowCamera:l,depthMaterial:c,horizontalBlurMaterial:u,verticalBlurMaterial:h,shadowGroup:t,plane:i,blurPlane:a}}(n);let i=0;const a=()=>i=i>=n.frames?n.frames-1:i;return s((({renderer:e,scene:t,invalidate:s})=>{i<n.frames&&(i++,function(e,t,n,s){const{renderTarget:o,shadowCamera:i,depthMaterial:a}=s,l=t.background;t.background=null,t.overrideMaterial=a;const c=n.getClearAlpha();n.setClearAlpha(0),n.setRenderTarget(o),n.render(t,i),t.overrideMaterial=null,r(e.blur,n,s),e.smooth&&r(.4*e.blur,n,s),n.setRenderTarget(null),n.setClearAlpha(c),t.background=l}(n,t,e,o),s())})),Nt((()=>[n.opacity,n.depthWrite,n.blur,n.smooth]),(()=>{o.plane.material.opacity=n.opacity??1,o.plane.material.depthWrite=n.depthWrite??!1,a()}),{immediate:!0}),Nt((()=>[n.color,n.tint]),(()=>{(function(e,t){t.plane.material.color=new g(e.color??"black"),t.depthMaterial.dispose(),t.depthMaterial=new V,t.depthMaterial.onBeforeCompile=function(t){const n=e.tint?new g(e.tint):new g("white"),{r:r,g:s,b:o}=n,i=t.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );",`gl_FragColor = vec4( ${r}, ${s}, ${o}, ( 1.0 - fragCoordZ ) * opacity);`);t.fragmentShader=i}})(n,o),a()}),{immediate:!0}),Nt((()=>[n.resolution]),(()=>{(function(e,t){t.renderTarget.dispose(),t.renderTargetBlur.dispose(),t.renderTarget=new j(e,e),t.renderTarget.texture.generateMipmaps=!1,t.renderTargetBlur=new j(e,e),t.renderTargetBlur.texture.generateMipmaps=!1,t.plane.material.map=t.renderTarget.texture})(n.resolution,o),a()})),Nt((()=>[n.width,n.height,n.scale,n.far]),(()=>{(function(e,t){const n=t.shadowCamera;n.left=-e.width/2,n.right=e.width/2,n.top=e.height/2,n.bottom=-e.height/2,n.far=e.far;const r=e.width*(Array.isArray(e.scale)?e.scale[0]:e.scale||1),s=e.height*(Array.isArray(e.scale)?e.scale[1]:e.scale||1);t.shadowGroup.scale.set(r,e.far,s)})(n,o),a()}),{immediate:!0}),Ut((()=>{for(const e of Object.values(o))e&&"dispose"in e&&"function"==typeof e.dispose&&e.dispose()})),t({instance:o.shadowGroup}),(e,t)=>(Ft(),Rt("primitive",{object:Bt(o).shadowGroup},null,8,xd))}}),wd=["size","color","alpha-map","map","opacity","alpha-test","depth-write","transparent","size-attenuation"],Td=["position","velocity"],_d=It({__name:"Precipitation",props:{size:{default:.1},area:{default:()=>[10,10,20]},color:{default:16777215},map:{},alphaMap:{},alphaTest:{default:.01},opacity:{default:.8},count:{default:5e3},speed:{default:.1},randomness:{default:.5},depthWrite:{type:Boolean,default:!1},transparent:{type:Boolean,default:!0},sizeAttenuation:{type:Boolean,default:!0}},setup(e,{expose:t}){const n=e,{size:r,area:s,color:o,alphaMap:i,map:a,opacity:l,alphaTest:c,depthWrite:u,transparent:h,sizeAttenuation:d,count:p,speed:m,randomness:f}=Jt(n),g=Dt();let v=[],y=[];const x=()=>{v=new Float32Array(3*p.value);for(let e=0;e<p.value;e++){const t=3*e;v[t]=(Math.random()-.5)*s.value[0],v[t+1]=(Math.random()-.5)*s.value[1],v[t+2]=(Math.random()-.5)*s.value[2]}},b=()=>{y=new Float32Array(2*p.value);for(let e=0;e<2*p.value;e+=2)y[e]=(Math.random()-.5)/5*m.value*f.value,y[e+1]=Math.random()/5*m.value};b(),x(),Xt((()=>{b(),x()}));const w=Dt(null),T=Dt(null);Xt((async()=>{Xt((async()=>{if("string"==typeof i.value){const e=await Cr({alphaMap:i.value});w.value=e.alphaMap}else w.value=i.value??null;if("string"==typeof a.value){const e=await Cr({map:a.value});T.value=e.map}else T.value=a.value??null}))}));const{onBeforeRender:_}=Qr();_((({invalidate:e})=>{var t,n;if(null!=(t=g.value)&&t.attributes.position.array&&null!=(n=g.value)&&n.attributes.position.count){const t=g.value.attributes.position.array;for(let e=0;e<g.value.attributes.position.count;e++){const n=y[2*e],r=y[2*e+1];t[3*e]+=n,t[3*e+1]-=r,(t[3*e]<=-s.value[0]/2||t[3*e]>=s.value[0]/2)&&(t[3*e]=-1*t[3*e]),(t[3*e+1]<=-s.value[1]/2||t[3*e+1]>=s.value[1]/2)&&(t[3*e+1]=-1*t[3*e+1])}g.value.attributes.position.needsUpdate=!0,e()}}));const E=Dt();return t({instance:E}),(e,t)=>(Ft(),Rt("TresPoints",{ref_key:"pointsRef",ref:E},[nn("TresPointsMaterial",{size:Bt(r),color:Bt(o),"alpha-map":w.value,map:T.value,opacity:Bt(l),"alpha-test":Bt(c),"depth-write":Bt(u),transparent:Bt(h),"size-attenuation":Bt(d)},null,8,wd),nn("TresBufferGeometry",{ref_key:"geometryRef",ref:g,position:[Bt(v),3],velocity:[Bt(y)]},null,8,Td)],512))}}),Ed=["object","material-uniforms-turbidity-value","material-uniforms-rayleigh-value","material-uniforms-mieCoefficient-value","material-uniforms-mieDirectionalG-value","material-uniforms-sunPosition-value","scale"],Ad=It({__name:"Sky",props:{turbidity:{default:3.4},rayleigh:{default:3},mieCoefficient:{default:.005},mieDirectionalG:{default:.7},elevation:{default:.6},azimuth:{default:180},distance:{default:45e4}},setup(e,{expose:t}){const n=e,{invalidate:r}=Kr();Nt(n,(()=>r()));const s=Dt(),o=new Vi,i=Wt((()=>function(e,t){const n=T.degToRad(90-t),r=T.degToRad(e);return(new C).setFromSphericalCoords(1,n,r)}(n.azimuth,n.elevation)));return t({instance:s,sunPosition:i.value}),(e,t)=>(Ft(),Rt("primitive",{ref_key:"skyRef",ref:s,object:Bt(o),"material-uniforms-turbidity-value":n.turbidity,"material-uniforms-rayleigh-value":n.rayleigh,"material-uniforms-mieCoefficient-value":n.mieCoefficient,"material-uniforms-mieDirectionalG-value":n.mieDirectionalG,"material-uniforms-sunPosition-value":i.value,scale:n.distance},null,8,Ed))}}),Md=["position","a-scale"],Sd=["size","size-attenuation","transparent","alpha-test","alpha-map"],Cd=It({__name:"Stars",props:{size:{default:.1},sizeAttenuation:{type:Boolean,default:!0},transparent:{type:Boolean,default:!0},alphaTest:{default:.01},count:{default:5e3},depth:{default:50},radius:{default:100},alphaMap:{default:null}},setup(e,{expose:t}){const n=e,r=Ot(),s=Ot(),{radius:o,depth:i,count:a,size:l,sizeAttenuation:c,transparent:u,alphaMap:h,alphaTest:d}=Jt(n),{invalidate:p}=Kr();Nt(n,(()=>{p()}));Xt((()=>{(()=>{let e=o.value+i.value;const t=Wt((()=>i.value/a.value)),n=[],l=Array.from({length:a.value},(()=>4*(.5+.5*Math.random()))),c=e=>(new C).setFromSpherical(new W(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)).toArray();for(let r=0;r<a.value;r++)e-=t.value*Math.random(),n.push(...c(e));r.value=new Float32Array(n),s.value=new Float32Array(l)})()}));const m=Dt();return t({instance:m}),(e,t)=>(Ft(),Rt("TresPoints",{ref_key:"starsRef",ref:m},[nn("TresBufferGeometry",{position:[r.value,3],"a-scale":[s.value,1]},null,8,Md),nn("TresPointsMaterial",{size:Bt(l),"size-attenuation":Bt(c),transparent:Bt(u),"alpha-test":Bt(d),"alpha-map":Bt(h)},null,8,Sd)],512))}});class Od extends _{constructor(){super(),Ns(this,"virtualScene",null),this.virtualScene=new t}add(...e){return this.virtualScene.add(...e),this}dispose(){this.virtualScene.traverse((e=>{e instanceof p&&(e.geometry.dispose(),e.material.dispose(),e.material.map&&e.material.map.dispose(),this.virtualScene.remove(e))})),this.virtualScene=null}}const Pd=It({__name:"component",props:{background:{type:[Boolean,String],default:!1},blur:{default:0},files:{default:()=>[]},path:{default:""},preset:{default:void 0},resolution:{default:256},near:{default:1},far:{default:1e3},frames:{default:Number.POSITIVE_INFINITY},backgroundIntensity:{default:1},backgroundRotation:{},environmentIntensity:{default:1},environmentRotation:{},syncMaterials:{type:Boolean}},async setup(e,{expose:t}){let n,r;const s=e,o=Ot(null);t({texture:o});const{extend:i,renderer:a,scene:l}=Kr();i({EnvironmentScene:Od});let c=null;const u=Ot(null);let h=null;const d=Ot(null),g=([n,r]=an((()=>async function(e,t){const{scene:n,invalidate:r}=Kr(),{preset:s,blur:o,files:i=Ot([]),path:a=Ot(""),background:l,backgroundIntensity:c=Ot(1),environmentIntensity:u=Ot(1),backgroundRotation:h=Ot([0,0,0]),environmentRotation:d=Ot([0,0,0]),syncMaterials:p=Ot(!1)}=Jt(e);Nt(e,(()=>{r()}));const m=Ot(null),f=Wt((()=>Array.isArray(i.value))),g=Wt((()=>f.value?J:Gl));return Nt([i,a],(async([e,t])=>{if(e&&e.length>0&&(null==s||!s.value)){try{const n=await Jn(g.value,f.value?[...Bt(e)]:Bt(e),(e=>{t&&e.setPath(Bt(t))}));m.value=Array.isArray(n)?n[0]:n}catch(n){throw new Error(`Failed to load environment map: ${n}`)}m.value&&(m.value.mapping=f.value?$:ee)}}),{immediate:!0}),Nt(m,(e=>{n.value&&e&&(n.value.environment=e)}),{immediate:!0}),Nt([l,m],(([e,r])=>{if(n.value){const s=null!=t&&t.value?t.value.texture:r;s&&(n.value.background=e?s:null)}}),{immediate:!0}),Nt((()=>null==o?void 0:o.value),(e=>{n.value&&e&&(n.value.backgroundBlurriness=e)}),{immediate:!0}),Nt((()=>null==c?void 0:c.value),(e=>{n.value&&(n.value.backgroundIntensity=e??1)}),{immediate:!0}),Nt((()=>null==u?void 0:u.value),(e=>{n.value&&(n.value.environmentIntensity=e??1)}),{immediate:!0}),Nt((()=>null==h?void 0:h.value),(e=>{if(n.value){const t=nc(e);t&&(n.value.backgroundRotation=t)}}),{immediate:!0}),Nt((()=>null==d?void 0:d.value),(e=>{if(n.value&&(null==p||!p.value)){const t=nc(e);t&&(n.value.environmentRotation=t,rc(n.value))}}),{immediate:!0}),Nt((()=>null==s?void 0:s.value),(async e=>{if(e&&e in tc){const n="https://raw.githubusercontent.com/Tresjs/assets/main/textures/hdr/",s=tc[e];try{const e=await Jn(Gl,s,(e=>{n&&e.setPath(n)}));m.value=Array.isArray(e)?e[0]:e}catch(t){throw new Error(`Failed to load environment map: ${t}`)}m.value&&(m.value.mapping=ee),r()}else if(e&&!(e in tc))throw new Error(`Preset must be one of: ${Object.keys(tc).join(", ")}`)}),{immediate:!0}),Nt([p,h],(([e,t])=>{if(e&&n.value){const e=nc(t);e&&(n.value.environmentRotation=e,rc(n.value))}}),{immediate:!0}),m}(s,u))),n=await n,r(),n),{onBeforeRender:v}=Qr();let y=1;v((()=>{if(h&&d.value&&u.value&&(s.frames===Number.POSITIVE_INFINITY||y<s.frames)){const e=a.value.autoClear;a.value.autoClear=!0;const t=ln(d.value).virtualScene;h.update(a.value,t),a.value.autoClear=e,y++}}),-1),Nt([g,d],(([e,t])=>{if(e&&null!=t&&t.virtualScene){const n=ln(t).virtualScene;let r=n.children.find((e=>e instanceof p&&e.userData.isEnvironment));r||(r=new p(new k(1,1,1),new m({side:f})),r.userData.isEnvironment=!0,n.add(r)),n.background=e,n.backgroundBlurriness=s.blur}}),{immediate:!0});const x=e=>{e&&null!=c&&c.length?(l.value.environment=e.texture,s.background&&(l.value.background=e.texture)):g.value&&(l.value.environment=g.value,s.background&&(l.value.background=g.value))};return Nt(g,(()=>{u.value&&x(u.value)}),{immediate:!0,deep:!0}),Nt((()=>Lt().default),(e=>{var t;if(e&&(c=e(),Array.isArray(c)&&c.length>0))return i({EnvironmentScene:Od}),u.value=new N(s.resolution),u.value.texture.type=U,h=new F(s.near,s.far,u.value),void x(u.value);null==(t=u.value)||t.dispose(),u.value=null,x()}),{immediate:!0,deep:!0}),o.value=g.value,Ut((()=>{var e,t;null==(e=d.value)||e.dispose(),null==(t=u.value)||t.dispose()})),(e,t)=>u.value?(Ft(),Rt("TresEnvironmentScene",{key:0,ref_key:"environmentScene",ref:d},[en(e.$slots,"default")],512)):$t("",!0)}});Boolean,new g(16777215);let Id=class{static isWebGL2Available(){try{const e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch{return!1}}static isColorSpaceAvailable(e){try{const t=document.createElement("canvas"),n=window.WebGL2RenderingContext&&t.getContext("webgl2");return n.drawingBufferColorSpace=e,n.drawingBufferColorSpace===e}catch{return!1}}static getWebGL2ErrorMessage(){return this.getErrorMessage(2)}static getErrorMessage(e){const t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext};let n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>';const r=document.createElement("div");return r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0",n=t[e]?n.replace("$0","graphics card"):n.replace("$0","browser"),n=n.replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),r.innerHTML=n,r}static isWebGLAvailable(){console.warn("isWebGLAvailable() has been deprecated and will be removed in r178. Use isWebGL2Available() instead.");try{const e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch{return!1}}static getWebGLErrorMessage(){return console.warn("getWebGLErrorMessage() has been deprecated and will be removed in r178. Use getWebGL2ErrorMessage() instead."),this.getErrorMessage(1)}};const Ld=Symbol("effectComposerPmndrs"),Dd=It({__name:"EffectComposerPmndrs",props:{enabled:{type:Boolean,default:!0},depthBuffer:{type:Boolean,default:void 0},disableNormalPass:{type:Boolean,default:!1},stencilBuffer:{type:Boolean,default:void 0},resolutionScale:{},autoClear:{type:Boolean,default:!0},multisampling:{default:0},frameBufferType:{default:U}},emits:["render"],setup(e,{expose:t,emit:n}){const r=e,s=n,{scene:o,camera:i,renderer:a,sizes:l,render:c}=Kr(),u=Dt(null);let h=null,d=null;Kt(Ld,u),t({composer:u});const p=Wt((()=>{const e=new En,t={depthBuffer:void 0!==r.depthBuffer?r.depthBuffer:e.inputBuffer.depthBuffer,stencilBuffer:void 0!==r.stencilBuffer?r.stencilBuffer:e.inputBuffer.stencilBuffer,multisampling:Id.isWebGL2Available()?void 0!==r.multisampling?r.multisampling:e.multisampling:0,frameBufferType:void 0!==r.frameBufferType?r.frameBufferType:U};return e.dispose(),t})),m=()=>{var e;!a.value&&!o.value&&!i.value||(null==(e=u.value)||e.dispose(),u.value=new En(a.value,p.value),u.value.addPass(new An(o.value,i.value)),r.disableNormalPass||u.value&&(d=new Mn(o.value,i.value),d.enabled=!1,u.value.addPass(d),void 0!==r.resolutionScale&&Id.isWebGL2Available()&&(h=new Sn({normalBuffer:d.texture,resolutionScale:r.resolutionScale}),h.enabled=!1,u.value.addPass(h))))};Nt([a,o,i,()=>r.disableNormalPass],(()=>{!l.width.value||!l.height.value||m()})),Nt((()=>[l.width.value,l.height.value]),(([e,t])=>{!e&&!t||(u.value?u.value.setSize(e,t):m())}),{immediate:!0});const{render:f}=Qr();return f((()=>{if(r.enabled&&a.value&&u.value&&l.width.value&&l.height.value&&c.frames.value>0){const e=a.value.autoClear;a.value.autoClear=r.autoClear,r.stencilBuffer&&!r.autoClear&&a.value.clearStencil(),u.value.render(),s("render",u.value),a.value.autoClear=e}c.frames.value="always"===c.mode.value?1:Math.max(0,c.frames.value-1)})),Ut((()=>{var e;null==(e=u.value)||e.dispose()})),(e,t)=>en(e.$slots,"default")}}),Rd=(e,t,n)=>{const r=Yt(Ld),s=Dt(null),o=Dt(null),{scene:i,camera:a,invalidate:l}=Kr();Nt(t,(()=>l()));Xt((()=>{!a.value||null==o||!o.value||(o.value.mainCamera=a.value)}));const c=Xt((()=>{var t;!a.value||null==r||!r.value||!i.value||(dn((()=>c())),!o.value&&(!a.value||null==r||!r.value||!i.value||(o.value=e(),s.value=new On(a.value,o.value),r.value.addPass(s.value,t))))}));return Ut((()=>{var e,t,n;s.value&&(null==(e=null==r?void 0:r.value)||e.removePass(s.value)),null==(t=o.value)||t.dispose(),null==(n=s.value)||n.dispose()})),{pass:s,effect:o}},kd=/([^[.\]])+/g,Nd=(e,t,n)=>{const r=Array.isArray(t)?t:t.match(kd);r&&r.reduce(((e,t,s)=>(void 0===e[t]&&(e[t]={}),s===r.length-1&&(e[t]=n),e[t])),e)},Ud=(e,t,n,r,s={})=>Nt(e,(s=>{var o;if(t.value)if(void 0===s){const e=r();Nd(t.value,n,((e,t)=>{if(!t)return;const n=Array.isArray(t)?t:t.match(kd);return null==n?void 0:n.reduce(((e,t)=>e&&e[t]),e)})(e,n)),null==(o=e.dispose)||o.call(e)}else Nd(t.value,n,e())}),s),Fd=(e,t,n)=>e.map((([e,r])=>Ud(e,t,r,n))),zd=It({__name:"OutlinePmndrs",props:{outlinedObjects:{},blur:{type:Boolean,default:void 0},xRay:{type:Boolean,default:void 0},kernelSize:{},pulseSpeed:{},resolutionX:{},resolutionY:{},edgeStrength:{},patternScale:{},multisampling:{},blendFunction:{},patternTexture:{},resolutionScale:{},hiddenEdgeColor:{},visibleEdgeColor:{}},setup(e,{expose:t}){const n=e,r=e=>void 0!==e?jr(e).getHex():void 0,{camera:s,scene:o}=Kr(),{pass:i,effect:a}=Rd((()=>new Cn(o.value,s.value,{blur:n.blur,xRay:n.xRay,kernelSize:n.kernelSize,pulseSpeed:n.pulseSpeed,resolutionX:n.resolutionX,resolutionY:n.resolutionY,patternScale:n.patternScale,edgeStrength:n.edgeStrength,blendFunction:n.blendFunction,multisampling:n.multisampling,patternTexture:n.patternTexture,resolutionScale:n.resolutionScale,hiddenEdgeColor:r(n.hiddenEdgeColor),visibleEdgeColor:r(n.visibleEdgeColor)})),n);t({pass:i,effect:a}),Nt([()=>n.outlinedObjects,a],(()=>{var e;null==(e=a.value)||e.selection.set(n.outlinedObjects||[])}),{immediate:!0});const l=Wt((()=>({hiddenEdgeColor:n.hiddenEdgeColor?jr(n.hiddenEdgeColor):void 0,visibleEdgeColor:n.visibleEdgeColor?jr(n.visibleEdgeColor):void 0})));return Fd([[()=>n.blendFunction,"blendMode.blendFunction"],[()=>n.blur,"blur"],[()=>n.xRay,"xRay"],[()=>n.pulseSpeed,"pulseSpeed"],[()=>n.kernelSize,"kernelSize"],[()=>n.edgeStrength,"edgeStrength"],[()=>n.patternScale,"patternScale"],[()=>n.multisampling,"multisampling"],[()=>n.resolutionX,"resolution.width"],[()=>n.resolutionY,"resolution.height"],[()=>n.patternTexture,"patternTexture"],[()=>n.resolutionScale,"resolution.scale"],[()=>l.value.hiddenEdgeColor,"hiddenEdgeColor"],[()=>l.value.visibleEdgeColor,"visibleEdgeColor"]],a,(()=>new Cn)),()=>{}}}),Bd={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class jd{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Hd=new H(-1,1,1,-1,0,1);const Vd=new class extends u{constructor(){super(),this.setAttribute("position",new h([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new h([0,2,0,0,2,0],2))}};let Xd=class{constructor(e){this._mesh=new p(Vd,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Hd)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}};class Yd extends jd{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof R?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=ce.clone(e.uniforms),this.material=new R({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Xd(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}let Wd=class extends jd{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;let o,i;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,i=1):(o=1,i=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(i),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}},Gd=class extends jd{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}};class Zd{constructor(t,n){if(this.renderer=t,this._pixelRatio=t.getPixelRatio(),void 0===n){const e=t.getSize(new S);this._width=e.width,this._height=e.height,(n=new j(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:U})).texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Yd(Bd),this.copyPass.material.blending=xt,this.clock=new e}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const t=this.passes[r];if(!1!==t.enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),t.needsSwap){if(n){const t=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Wd&&(t instanceof Wd?n=!0:t instanceof Gd&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new S);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Kd extends jd{constructor(e,t,n=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new g}render(e,t,n){const r=e.autoClear;let s,o;e.autoClear=!1,null!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(s),null!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}const Qd=Symbol("effectComposerThree"),qd=It({__name:"EffectComposer",props:{enabled:{type:Boolean,default:!0},withoutRenderPass:{type:Boolean}},setup(e,{expose:t}){const n=e,r=Dt(null);Kt(Qd,r),t({composer:r});const{renderer:s,sizes:o,scene:i,camera:a,render:l}=Kr();Xt((()=>{var e;null==(e=r.value)||e.dispose(),r.value=new Zd(s.value)})),Xt((()=>{var e;const{width:t,height:n}=o;n.value&&t.value&&(null==(e=r.value)||e.setSize(t.value,n.value))}));const{pixelRatio:c}=zn();Xt((()=>{var e;null==(e=r.value)||e.setPixelRatio(c.value)})),n.withoutRenderPass||Xt((()=>{a.value&&i.value&&r.value&&r.value.addPass(new Kd(i.value,a.value))}));const{render:u}=Qr();return u((()=>{l.frames.value>0&&r.value&&n.enabled&&r.value.render(),l.frames.value="always"===l.mode.value?1:Math.max(0,l.frames.value-1)})),Ut((()=>{var e;null==(e=r.value)||e.dispose()})),(e,t)=>en(e.$slots,"default")}}),Jd=(e,t,n)=>{if(!t&&n)throw new Error("passDependencies is required when dependencyFieldsTriggeringRecreation is provided");const r=Yt(Qd),s=Dt(e()),{sizes:o,invalidate:i}=Kr();t&&Nt(t,(()=>i()));const a=()=>{var e;null==(e=null==r?void 0:r.value)||e.removePass(s.value),s.value.dispose()},l=Xt((()=>{null==r||!r.value||!o.height.value||!o.width.value||(r.value.addPass(s.value),dn((()=>l())))}));return n&&Nt((()=>n.map((e=>null==t?void 0:t[e]))),(()=>{if(null==r||!r.value)return;const t=r.value.passes.findIndex((e=>e===s.value));~t&&(a(),s.value=e(),r.value.insertPass(s.value,t))})),Ut((()=>{a()})),{pass:s}},$d={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tfloat disp = texture2D(tDisp, p*seed*seed).r;\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=disp*seed_x*(seed/5.);\n\t\t\t\tp.y+=disp*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"};let ep=class extends jd{constructor(e=64){super();const t=$d;this.uniforms=ce.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new R({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new Xd(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=T.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=T.randFloat(-1,1),this.uniforms.seed_y.value=T.randFloat(-1,1),this.uniforms.distortion_x.value=T.randFloat(0,1),this.uniforms.distortion_y.value=T.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=T.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=T.randFloat(0,1),this.uniforms.distortion_y.value=T.randFloat(0,1),this.uniforms.seed_x.value=T.randFloat(-.3,.3),this.uniforms.seed_y.value=T.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=T.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),n=e*e;for(let s=0;s<n;s++){const e=T.randFloat(0,1);t[s]=e}const r=new mt(t,e,e,bt,he);return r.needsUpdate=!0,r}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}};const tp=It({__name:"Glitch",props:{dtSize:{},goWild:{type:Boolean}},setup(e,{expose:t}){const n=e,{pass:r}=Jd((()=>new ep(n.dtSize)),n,["dtSize"]);t({pass:r});const{onBeforeRender:s}=Qr();return s((({invalidate:e})=>e())),Fd([[()=>n.goWild,"goWild"]],r,(()=>new ep)),()=>{}}}),np={name:"OutputShader",uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:"\n\t\tprecision highp float;\n\n\t\tuniform mat4 modelViewMatrix;\n\t\tuniform mat4 projectionMatrix;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\t#include <tonemapping_pars_fragment>\n\t\t#include <colorspace_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t// tone mapping\n\n\t\t\t#ifdef LINEAR_TONE_MAPPING\n\n\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( AGX_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\n\t\t\t#endif\n\n\t\t\t// color space\n\n\t\t\t#ifdef SRGB_TRANSFER\n\n\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\n\t\t\t#endif\n\n\t\t}"};class rp extends jd{constructor(){super();const e=np;this.uniforms=ce.clone(e.uniforms),this.material=new ft({name:e.name,uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.fsQuad=new Xd(this.material),this._outputColorSpace=null,this._toneMapping=null}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.toneMappingExposure.value=e.toneMappingExposure,(this._outputColorSpace!==e.outputColorSpace||this._toneMapping!==e.toneMapping)&&(this._outputColorSpace=e.outputColorSpace,this._toneMapping=e.toneMapping,this.material.defines={},wt.getTransfer(this._outputColorSpace)===Tt&&(this.material.defines.SRGB_TRANSFER=""),this._toneMapping===_t?this.material.defines.LINEAR_TONE_MAPPING="":this._toneMapping===Et?this.material.defines.REINHARD_TONE_MAPPING="":this._toneMapping===At?this.material.defines.CINEON_TONE_MAPPING="":this._toneMapping===b?this.material.defines.ACES_FILMIC_TONE_MAPPING="":this._toneMapping===Mt?this.material.defines.AGX_TONE_MAPPING="":this._toneMapping===St?this.material.defines.NEUTRAL_TONE_MAPPING="":this._toneMapping===Ct&&(this.material.defines.CUSTOM_TONE_MAPPING=""),this.material.needsUpdate=!0),!0===this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}const sp=It({__name:"Output",setup(e,{expose:t}){const{pass:n}=Jd((()=>new rp));return t({pass:n}),()=>{}}}),op={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new S(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAAEdgeDetectionVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n\t\t\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n\t\t\t// Calculate color deltas:\n\t\t\tvec4 delta;\n\t\t\tvec3 C = texture2D( colorTex, texcoord ).rgb;\n\n\t\t\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n\t\t\tvec3 t = abs( C - Cleft );\n\t\t\tdelta.x = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n\t\t\tt = abs( C - Ctop );\n\t\t\tdelta.y = max( max( t.r, t.g ), t.b );\n\n\t\t\t// We do the usual threshold:\n\t\t\tvec2 edges = step( threshold, delta.xy );\n\n\t\t\t// Then discard if there is no edge:\n\t\t\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n\t\t\t\tdiscard;\n\n\t\t\t// Calculate right and bottom deltas:\n\t\t\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n\t\t\tt = abs( C - Cright );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n\t\t\tt = abs( C - Cbottom );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the maximum delta in the direct neighborhood:\n\t\t\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n\t\t\t// Calculate left-left and top-top deltas:\n\t\t\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n\t\t\tt = abs( C - Cleftleft );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n\t\t\tt = abs( C - Ctoptop );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the final maximum delta:\n\t\t\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n\t\t\t// Local contrast adaptation in action:\n\t\t\tedges.xy *= step( 0.5 * maxDelta, delta.xy );\n\n\t\t\treturn vec4( edges, 0.0, 0.0 );\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );\n\n\t\t}"},ip={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new S(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\t\tvarying vec2 vPixcoord;\n\n\t\tvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n\t\t\tvPixcoord = texcoord / resolution;\n\n\t\t\t// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components\n\n\t\t\t// And these for the searches, they indicate the ends of the loops:\n\t\t\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAABlendingWeightCalculationVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tArea;\n\t\tuniform sampler2D tSearch;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[3];\n\t\tvarying vec2 vPixcoord;\n\n\t\t#if __VERSION__ == 100\n\t\tvec2 round( vec2 x ) {\n\t\t\treturn sign( x ) * floor( abs( x ) + 0.5 );\n\t\t}\n\t\t#endif\n\n\t\tfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n\t\t\t// Not required if searchTex accesses are set to point:\n\t\t\t// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);\n\t\t\t// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +\n\t\t\t//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\n\t\t\te.r = bias + e.r * scale;\n\t\t\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;\n\t\t}\n\n\t\tfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\t/**\n\t\t\t\t* @PSEUDO_GATHER4\n\t\t\t\t* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to\n\t\t\t\t* sample between edge, thus fetching four edges in a row.\n\t\t\t\t* Sampling with different offsets in each direction allows to disambiguate\n\t\t\t\t* which edges are active from the four fetched ones.\n\t\t\t\t*/\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\t// We correct the previous (-0.25, -0.125) offset we applied:\n\t\t\ttexcoord.x += 0.25 * resolution.x;\n\n\t\t\t// The searches are bias by 1, so adjust the coords accordingly:\n\t\t\ttexcoord.x += resolution.x;\n\n\t\t\t// Disambiguate the length added by the last step:\n\t\t\ttexcoord.x += 2.0 * resolution.x; // Undo last step\n\t\t\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.x -= 0.25 * resolution.x;\n\t\t\ttexcoord.x -= resolution.x;\n\t\t\ttexcoord.x -= 2.0 * resolution.x;\n\t\t\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n\t\t\t// Rounding prevents precision errors of bilinear filtering:\n\t\t\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\n\t\t\t// We do a scale and bias for mapping to texel space:\n\t\t\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\n\t\t\t// Move to proper place, according to the subpixel offset:\n\t\t\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\n\t\t\treturn texture2D( areaTex, texcoord, 0.0 ).rg;\n\t\t}\n\n\t\tvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n\t\t\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tvec2 e = texture2D( edgesTex, texcoord ).rg;\n\n\t\t\tif ( e.g > 0.0 ) { // Edge at north\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the left:\n\t\t\t\tvec2 coords;\n\t\t\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n\t\t\t\tcoords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)\n\t\t\t\td.x = coords.x;\n\n\t\t\t\t// Now fetch the left crossing edges, two at a time using bilinear\n\t\t\t\t// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to\n\t\t\t\t// discern what value each edge has:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\n\t\t\t\t// Find the distance to the right:\n\t\t\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n\t\t\t\td.y = coords.x;\n\n\t\t\t\t// We want the distances to be in pixel units (doing this here allow to\n\t\t\t\t// better interleave arithmetic and memory accesses):\n\t\t\t\td = d / resolution.x - pixcoord.x;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the right crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\n\t\t\t\t// Ok, we know how this pattern looks like, now it is time for getting\n\t\t\t\t// the actual area:\n\t\t\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n\t\t\t}\n\n\t\t\tif ( e.r > 0.0 ) { // Edge at west\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the top:\n\t\t\t\tvec2 coords;\n\n\t\t\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n\t\t\t\tcoords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;\n\t\t\t\td.x = coords.y;\n\n\t\t\t\t// Fetch the top crossing edges:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\n\t\t\t\t// Find the distance to the bottom:\n\t\t\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n\t\t\t\td.y = coords.y;\n\n\t\t\t\t// We want the distances to be in pixel units:\n\t\t\t\td = d / resolution.y - pixcoord.y;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the bottom crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\n\t\t\t\t// Get the area for this direction:\n\t\t\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\t\t\t}\n\n\t\t\treturn weights;\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );\n\n\t\t}"},ap={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new S(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAANeighborhoodBlendingVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tColor;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n\t\t\t// Fetch the blending weights for current pixel:\n\t\t\tvec4 a;\n\t\t\ta.xz = texture2D( blendTex, texcoord ).xz;\n\t\t\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n\t\t\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\n\t\t\t// Is there any blending weight with a value greater than 0.0?\n\t\t\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n\t\t\t\treturn texture2D( colorTex, texcoord, 0.0 );\n\t\t\t} else {\n\t\t\t\t// Up to 4 lines can be crossing a pixel (one through each edge). We\n\t\t\t\t// favor blending by choosing the line with the maximum weight for each\n\t\t\t\t// direction:\n\t\t\t\tvec2 offset;\n\t\t\t\toffset.x = a.a > a.b ? a.a : -a.b; // left vs. right\n\t\t\t\toffset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs\n\n\t\t\t\t// Then we go in the direction that has the maximum weight:\n\t\t\t\tif ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical\n\t\t\t\t\toffset.y = 0.0;\n\t\t\t\t} else {\n\t\t\t\t\toffset.x = 0.0;\n\t\t\t\t}\n\n\t\t\t\t// Fetch the opposite color and lerp by hand:\n\t\t\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\ttexcoord += sign( offset ) * resolution;\n\t\t\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\n\t\t\t\t// WebGL port note: Added gamma correction\n\t\t\t\tC.xyz = pow(C.xyz, vec3(2.2));\n\t\t\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));\n\t\t\t\tvec4 mixed = mix(C, Cop, s);\n\t\t\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));\n\n\t\t\t\treturn mixed;\n\t\t\t}\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );\n\n\t\t}"};class lp extends jd{constructor(e,t){super(),this.edgesRT=new j(e,t,{depthBuffer:!1,type:U}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new j(e,t,{depthBuffer:!1,type:U}),this.weightsRT.texture.name="SMAAPass.weights";const n=this,r=new Image;r.src=this.getAreaTexture(),r.onload=function(){n.areaTexture.needsUpdate=!0},this.areaTexture=new Ne,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=r,this.areaTexture.minFilter=ve,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const s=new Image;s.src=this.getSearchTexture(),s.onload=function(){n.searchTexture.needsUpdate=!0},this.searchTexture=new Ne,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=Le,this.searchTexture.minFilter=Le,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,this.uniformsEdges=ce.clone(op.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new R({defines:Object.assign({},op.defines),uniforms:this.uniformsEdges,vertexShader:op.vertexShader,fragmentShader:op.fragmentShader}),this.uniformsWeights=ce.clone(ip.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new R({defines:Object.assign({},ip.defines),uniforms:this.uniformsWeights,vertexShader:ip.vertexShader,fragmentShader:ip.fragmentShader}),this.uniformsBlend=ce.clone(ap.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new R({uniforms:this.uniformsBlend,vertexShader:ap.vertexShader,fragmentShader:ap.fragmentShader}),this.fsQuad=new Xd(null)}render(e,t,n){this.uniformsEdges.tDiffuse.value=n.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=n.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,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"}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}dispose(){this.edgesRT.dispose(),this.weightsRT.dispose(),this.areaTexture.dispose(),this.searchTexture.dispose(),this.materialEdges.dispose(),this.materialWeights.dispose(),this.materialBlend.dispose(),this.fsQuad.dispose()}}const cp=It({__name:"SMAA",props:{width:{},height:{}},setup(e,{expose:t}){const n=e,{sizes:r}=Kr(),{pixelRatio:s}=zn(),o=Wt((()=>n.width??r.width.value*s.value)),i=Wt((()=>n.height??r.height.value*s.value)),{pass:a}=Jd((()=>new lp(o.value,i.value)),n);return t({pass:a}),Xt((()=>{a.value.setSize(o.value,i.value)})),()=>{}}}),up={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new g(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat v = luminance( texel.xyz );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class hp extends jd{constructor(e,t,n,r){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new S(e.x,e.y):new S(256,256),this.clearColor=new g(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new j(s,o,{type:U}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let c=0;c<this.nMips;c++){const e=new j(s,o,{type:U});e.texture.name="UnrealBloomPass.h"+c,e.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(e);const t=new j(s,o,{type:U});t.texture.name="UnrealBloomPass.v"+c,t.texture.generateMipmaps=!1,this.renderTargetsVertical.push(t),s=Math.round(s/2),o=Math.round(o/2)}const i=up;this.highPassUniforms=ce.clone(i.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new R({uniforms:this.highPassUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),this.separableBlurMaterials=[];const a=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeparableBlurMaterial(a[c])),this.separableBlurMaterials[c].uniforms.invSize.value=new S(1/s,1/o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const l=Bd;this.copyUniforms=ce.clone(l.uniforms),this.blendMaterial=new R({uniforms:this.copyUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,blending:gt,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new g,this.oldClearAlpha=1,this.basic=new m,this.fsQuad=new Xd(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.invSize.value=new S(1/n,1/r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let i=this.renderTargetBright;for(let a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=i.texture,this.separableBlurMaterials[a].uniforms.direction.value=hp.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[a]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=hp.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[a]),e.clear(),this.fsQuad.render(e),i=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeparableBlurMaterial(e){const t=[];for(let n=0;n<e;n++)t.push(.39894*Math.exp(-.5*n*n/(e*e))/e);return new R({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new S(.5,.5)},direction:{value:new S(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new R({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}hp.BlurDirectionX=new S(1,0),hp.BlurDirectionY=new S(0,1);const dp=It({__name:"UnrealBloom",props:{radius:{default:0},strength:{default:1},threshold:{default:0}},setup(e,{expose:t}){const n=e,{sizes:r}=Kr(),{pass:s}=Jd((()=>new hp(new S(r.width.value,r.height.value),n.radius,n.strength,n.threshold)),n);return t({pass:s}),Xt((()=>{var e;s.value.radius=n.radius??(null==(e=s.value.getCompositeMaterial().uniforms.bloomRadius)?void 0:e.value)??.1})),Xt((()=>{var e;s.value.strength=n.strength??(null==(e=s.value.getCompositeMaterial().uniforms.bloomStrength)?void 0:e.value)??1})),Xt((()=>{var e;s.value.threshold=n.threshold??(null==(e=up.uniforms.luminosityThreshold)?void 0:e.value)??1})),()=>{}}}),pp=typeof window<"u"&&typeof document<"u";function mp(e,t={}){if(!qt(e))return Jt(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const r in e.value)n[r]=_n((()=>({get:()=>e.value[r],set(n){var s;if(null==(s=cn(t.replaceRef))||s)if(Array.isArray(e.value)){const t=[...e.value];t[r]=n,e.value=t}else{const t={...e.value,[r]:n};Object.setPrototypeOf(t,Object.getPrototypeOf(e.value)),e.value=t}else e.value[r]=n}})));return n}typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const fp=cn,gp=pp?window:void 0;const vp=It({name:"UseDraggable",props:["storageKey","storageType","initialValue","exact","preventDefault","stopPropagation","pointerTypes","as","handle","axis","onStart","onMove","onEnd"],setup(e,{slots:t}){const n=Ot(),r=Wt((()=>e.handle??n.value)),s=e.storageKey&&Vn(e.storageKey,fp(e.initialValue)||{x:0,y:0},Xn?"session"===e.storageType?sessionStorage:localStorage:void 0),o=s||e.initialValue||{x:0,y:0},i=Pt(function(e,t={}){const{pointerTypes:n,preventDefault:r,stopPropagation:s,exact:o,onMove:i,onEnd:a,onStart:l,initialValue:c,axis:u="both",draggingElement:h=gp,handle:d=e}=t,{width:p}=kn();let m=p.value;const f=Ot(fp(c)??{x:0,y:0});Nt(p,(()=>{const e=p.value-m;f.value.x+=e,m=p.value}));const g=Ot(),v=e=>!n||n.includes(e.pointerType),y=e=>{fp(r)&&e.preventDefault(),fp(s)&&e.stopPropagation()},x=t=>{if(!v(t)||fp(o)&&t.target!==fp(e))return;const n=fp(e).getBoundingClientRect(),r={x:t.clientX-n.left,y:t.clientY-n.top};!1!==(null==l?void 0:l(r,t))&&(g.value=r,y(t))},b=e=>{if(!v(e)||!g.value)return;let{x:t,y:n}=f.value;("x"===u||"both"===u)&&(t=e.clientX-g.value.x),("y"===u||"both"===u)&&(n=e.clientY-g.value.y),f.value={x:t,y:n},null==i||i(f.value,e),y(e)},w=e=>{v(e)&&g.value&&(g.value=void 0,null==a||a(f.value,e),y(e))};if(pp){const e={capture:t.capture??!0};Zn(d,"pointerdown",x,e),Zn(h,"pointermove",b,e),Zn(h,"pointerup",w,e)}return{...mp(f),position:f,isDragging:Wt((()=>!!g.value)),style:Wt((()=>`left:${f.value.x}px;top:${f.value.y}px;`))}}(n,{...e,handle:r,initialValue:o,onEnd:(t,n)=>{var r;null==(r=e.onEnd)||r.call(e,t,n),s&&(s.value.x=t.x,s.value.y=t.y)}}));return()=>{if(t.default)return Vt(e.as||"div",{ref:n,style:`touch-action:none;${i.style}`},t.default(i))}}}),yp=Symbol("CONTROLS_CONTEXT_KEY"),xp="default",bp=Pt({});const wp=e=>"boolean"==typeof e?"boolean":"number"==typeof e?"number":"string"==typeof e&&/^#(?:[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^0x(?:[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e)?"color":"string"==typeof e?"string":e.isVector3||e.isVector2||e.isEuler||Array.isArray(e.value)||e.value.isVector3||e.value.isVector2||e.value.isEuler||Array.isArray(e.value.value)?"vector":void 0!==e.min||void 0!==e.max||void 0!==e.step?"range":e.options&&Array.isArray(e.options)?"select":"unknown",Tp=(e,t,n,r)=>{const s={key:Ot(e),label:Ot(e),name:Ot(e),type:Ot(n),value:Ot(t),visible:Ot(!0),icon:Ot(),uniqueKey:Ot(e),[e]:Ot(t)};return r&&(s.folder=Ot(r)),s},_p=(e,t,n)=>{const r={},s="string"==typeof e?e:null,o=s?t:e,i=s&&"fpsgraph"!==s?n:t,a=(null==i?void 0:i.uuid)||xp;if(bp[a]||(bp[a]=Pt({})),"fpsgraph"===e){const e=Tp("fpsgraph",null,"fpsgraph",null);return bp[a].fpsgraph=e,r.fpsgraph=e,Jt(Pt(r))}const l=bp[a],c=fn(o),u=c?Jt(o):{};for(const h in o){let e=o[h],t=h;if(c&&u[h]&&(e=u[h]),s&&(t=`${s}${h.charAt(0).toUpperCase()+h.slice(1)}`),"object"==typeof e&&!qt(e)&&!Array.isArray(e)&&void 0!==e.value){const n=e,o=qt(n.value)?n.value:Ot(n.value),i=n.type||wp(n),a=Tp(h,o,i,s);"select"===i&&(a.options=Ot(n.options.map((e=>"object"==typeof e&&e.text&&e.value?e:{text:e,value:e})))),"range"===i&&(a.min=Ot(n.min||0),a.max=Ot(n.max||1),a.step=Ot(n.step||.1)),a.label.value=n.label||h,a.icon.value=n.icon,a.visible.value=void 0===n.visible||n.visible,a.uniqueKey.value=t,l[t]=a,r[t]=a;continue}if(qt(e)){const n=Tp(h,e,e.value.type||wp(e.value),s);l[t]=n,r[t]=n;continue}if("object"==typeof e&&!Array.isArray(e)){const t=Jt(e);t[h]&&(e=t[h])}const n=Tp(h,e,e.type||wp(e),s);l[t]=n,r[t]=n,n.uniqueKey.value=t}return Object.keys(r).length>1?Jt(Pt(r)):Object.values(r)[0]},Ep=["for","title"],Ap=It({__name:"ControlLabel",props:{label:{},control:{}},setup:e=>(e,t)=>(Ft(),Rt("label",{for:e.control.uniqueKey,title:e.label,class:"tl-text-gray-500 tl-w-1/3 tl-truncate"},[e.control.icon?(Ft(),Rt("i",{key:0,class:jt(e.control.icon)},null,2)):(Ft(),Rt(Qt,{key:1},[Tn(yn(e.label),1)],64))],8,Ep))}),Mp={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},Sp=["id","value","min","max","step"],Cp=It({__name:"NumberControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function s(e){const{target:t}=e;r("change",t.valueAsNumber)}const o=Yn(),i=Ot(0),a=Ot(!1),l=e=>{i.value=e.clientX,a.value=!0},c=()=>{a.value=!1};return Nt(o.x,(e=>{if(a.value){const t=e-i.value,s=(e=>Math.floor(Math.abs(e)/10))(t);t>0?r("change",n.control.value+1+s):t<0&&r("change",n.control.value-1+s),void 0!==n.control.min&&n.control.value<n.control.min&&r("change",n.control.min),void 0!==n.control.max&&n.control.value>n.control.max&&r("change",n.control.max),i.value=e}})),(e,t)=>(Ft(),Rt("div",Mp,[sn(Ap,{label:e.label,control:e.control},null,8,["label","control"]),nn("input",{id:e.control.uniqueKey,value:e.control.value,class:jt(["tl-p-2 tl-w-1/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans",{"tl-cursor-ew-resize":a.value}]),type:"number",min:e.control.min,max:e.control.max,step:e.control.step,onInput:s,onMousedown:l,onMouseup:c},null,42,Sp)]))}}),Op={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2 tl-min-h-32px"},Pp=["id","value","aria-label"],Ip=It({__name:"TextControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){const{target:t}=e;n("change",t.value)}return(e,t)=>(Ft(),Rt("div",Op,[sn(Ap,{label:e.label,control:e.control},null,8,["label","control"]),nn("input",{id:e.control.uniqueKey,value:e.control.value,type:"text",tabindex:"0",class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 focus:tl-border-gray-200 tl-border-none tl-font-sans","aria-label":e.label,placeholder:"Enter value here...",onChange:r},null,40,Pp)]))}}),Lp={class:"tl-flex tl-px-4 tl-justify-start tl-gap-2 tl-items-center tl-mb-2 tl-min-h-32px"},Dp={class:"tl-text-gray-500 tl-w-1/3"},Rp=["id","checked"],kp=["for"],Np=["aria-checked"],Up={class:"i-ic:baseline-check tl-text-light"},Fp=It({__name:"BooleanControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function s(e){const{target:t}=e;r("change",t.checked)}function o(e){("Space"===e.code||"Enter"===e.code)&&(e.preventDefault(),r("change",!n.control.value))}return(e,t)=>(Ft(),Rt("div",Lp,[nn("label",Dp,yn(e.label),1),nn("input",{id:e.control.uniqueKey,checked:e.control.value,class:"tl-hidden",type:"checkbox",onInput:s},null,40,Rp),nn("label",{for:e.control.uniqueKey,class:"tl-inline-flex tl-items-center tl-cursor-pointer"},[nn("span",{tabindex:"0",role:"checkbox","aria-checked":e.control.value.toString(),class:jt([{"tl-bg-dark-500":e.control.value,"tl-bg-gray-200":!e.control.value},"tl-w-4 tl-h-4 tl-flex tl-justify-center tl-items-center tl-rounded tl-border tl-border-gray-300 tl-mr-2 tl-transition-colors tl-duration-200"]),onKeydown:o},[xn(nn("i",Up,null,512),[[bn,e.control.value]])],42,Np)],8,kp)]))}}),zp={class:"tl-px-4 tl-relative tl-flex tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},Bp=["value","min","max","step"],jp=["value","min","max","step"],Hp=It({__name:"SliderControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function s(e){const{target:t}=e;r("change",t.valueAsNumber)}const o=Wt((()=>({backgroundImage:`linear-gradient(to right, #333 0% ${100*(n.control.value-(n.control.min||0))/((n.control.max||100)-(n.control.min||0))}%, #e2e2e2 0%)`}))),i=Yn(),a=Ot(0),l=Ot(!1),c=e=>{a.value=e.clientX,l.value=!0},u=()=>{l.value=!1};return Nt(i.x,(e=>{if(l.value){const t=e-a.value,s=(e=>Math.floor(Math.abs(e)/10))(t);t>0?r("change",n.control.value+1+s):t<0&&r("change",n.control.value-1+s),void 0!==n.control.min&&n.control.value<n.control.min&&r("change",n.control.min),void 0!==n.control.max&&n.control.value>n.control.max&&r("change",n.control.max),a.value=e}})),(e,t)=>(Ft(),Rt("div",zp,[sn(Ap,{label:e.label,control:e.control},null,8,["label","control"]),nn("input",{value:e.control.value,class:"tl-w-1/2 tl-h-0.75 tl-bg-dark-200 tl-rounded-full tl-appearance-none",style:zt(o.value),type:"range",min:e.control.min,max:e.control.max,step:e.control.step,onInput:s},null,44,Bp),nn("input",{value:e.control.value,class:jt(["tl-p-2 tl-w-1/4 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans",{"tl-cursor-ew-resize":l.value}]),type:"number",min:e.control.min,max:e.control.max,step:e.control.step,onInput:s,onMousedown:c,onMouseup:u},null,42,jp)]))}}),Vp=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},Xp=Vp(Hp,[["__scopeId","data-v-207d19a7"]]),Yp={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},Wp={class:"tl-text-gray-500 tl-w-1/3"},Gp=["id","value","aria-label"],Zp=["id","aria-label","value"],Kp=It({__name:"ColorControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){const{target:t}=e;n("change",t.value)}return(e,t)=>(Ft(),Rt("div",Yp,[nn("label",Wp,yn(e.label),1),nn("input",{id:e.control.uniqueKey,tabindex:"0",value:e.control.value,"aria-label":e.label,class:jt(["focus:tl-outline-none focus:tl-ring-2 focus:tl-ring-blue-600",{"important-tl-outline-gray-200":"#ffffff"===e.control.value}]),type:"color",onInput:r},null,42,Gp),nn("input",{id:e.control.uniqueKey,tabindex:"0","aria-label":e.label,value:e.control.value,class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-border-none tl-font-sans",type:"text",onInput:r},null,40,Zp)]))}});function Qp(e){return e&&"number"==typeof e.x&&"number"==typeof e.y}function qp(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}const Jp={class:"tl-relative tl-w-2/3 tl-flex tl-justify-between tl-gap-0.5"},$p={key:0,class:"tl-font-bold tl-px-1 tl-py-1 tl-text-0.65rem tl-text-gray-300"},em=["id","step","value","onInput","onMousedown","onMouseup","onFocus"],tm=It({__name:"VectorControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t,s=Yn(),{pressed:o}=Wn(),i=Ot(0),a=Ot(!1),l=Ot(0),c=Ot(null),u=Ot(1),h=Gn("Shift"),d=Gn("Alt");Nt(h,(e=>{u.value=e?10:1})),Nt(d,(e=>{u.value=e?.1:1}));const p=()=>{c.value=null};Nt(o,(e=>{e||(a.value=!1)}));const m=Wt((()=>function(e){if("number"==typeof e)return[e,e,e];if(qp(e)){const{x:t,y:n,z:r}=e;return[t,n,r]}if(Qp(e)){const{x:t,y:n}=e;return[t,n]}return e}(n.control.value))),f=Ot(["x","y","z"]),g=Wt((()=>Qp(n.control.value)||qp(n.control.value)));return Nt(s.x,(e=>{if(a.value){const t=e-i.value,s=(e=>Math.floor(Math.abs(e)/10))(t),{value:o}=n.control,a=g.value?f.value[l.value]:l.value;t>0?o[a]+=u.value+s:t<0&&(o[a]-=u.value+s),void 0!==n.control.min&&o<n.control.min&&(o[a]=n.control.min),void 0!==n.control.max&&o>n.control.max&&(o[a]=n.control.max),r("change",o),i.value=e}})),(e,t)=>(Ft(),Rt("div",{class:"tl-flex tl-px-4 tl-justify-between tl-gap-1 tl-items-center tl-mb-2",onMouseup:t[0]||(t[0]=e=>{a.value=!1})},[sn(Ap,{label:e.label,control:e.control},null,8,["label","control"]),nn("div",Jp,[(Ft(!0),Rt(Qt,null,vn(m.value,((t,s)=>(Ft(),Rt("div",{key:e.label+s,class:jt(["tl-flex tl-items-center tl-bg-gray-100 tl-rounded",{"tl-w-2/5":c.value===s,"tl-w-1/3":Bt(qp)(e.control.value),"tl-w-1/2":Bt(Qp)(e.control.value)}])},[f.value[s]&&g.value?(Ft(),Rt("span",$p,yn(f.value[s]),1)):$t("",!0),nn("input",{id:`${e.control.uniqueKey}-${f.value[s]}`,type:"number",step:u.value,class:jt(["tl-w-full tl-px-0 tl-p-1 tl-text-right tl-text-0.65rem tl-text-gray-400 tl-bg-transparent focus:tl-border-gray-200 tl-outline-none tl-border-none tl-font-sans tl-appearence-none",{"tl-cursor-ew-resize":a.value}]),value:m.value[s].toFixed(2),onInput:e=>function(e,t){const{value:s}=n.control,{target:o}=e;l.value=t,s[g.value?f.value[l.value]:l.value]=Number.parseFloat(o.value),r("change",s)}(e,s),onMousedown:e=>((e,t)=>{l.value=t,i.value=e.clientX,a.value=!0})(e,s),onMouseup:e=>((e,t)=>{l.value=t,a.value=!1})(0,s),onFocus:e=>(e=>{c.value=e})(s),onBlur:p},null,42,em)],2)))),128))])],32))}}),nm={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},rm={class:"tl-text-gray-500 tl-w-1/3"},sm={class:"tl-relative tl-w-2/3 tl-p-1 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans"},om={class:"tl-absolute tl-bottom-0.5 tl-right-0.5 tl-font-sans tl-text-xs"},im=["points"],am=It({__name:"FPSGraph",props:{label:{},control:{}},setup(e){const t=Ln({every:100}),n=Ot(""),r=Ot([]),s=Ot(80);let o=performance.now();return Pn((({timestamp:e})=>{e-o>=100&&(o=e,r.value.push(t.value),r.value.length>s.value&&r.value.shift(),n.value=r.value.map(((e,t)=>`${2*t},${59-58*e/120}`)).join(" "))})),(e,r)=>(Ft(),Rt("div",nm,[nn("label",rm,yn(e.label),1),nn("div",sm,[nn("div",om,yn(Math.round(Bt(t)))+" FPS ",1),(Ft(),Rt("svg",{width:160,height:40,xmlns:"http://www.w3.org/2000/svg",class:"tl-bg-gray-100"},[nn("polyline",{points:n.value,fill:"none",stroke:"lightgray","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},null,8,im)]))])]))}}),lm={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2 tl-min-h-32px"},cm=["id","value"],um=["value"],hm=It({__name:"SelectControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){n("change",e.target.value)}return(e,t)=>(Ft(),Rt("div",lm,[sn(Ap,{label:e.label,control:e.control},null,8,["label","control"]),nn("select",{id:e.control.uniqueKey,value:e.control.value,class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-left tl-text-xs tl-text-gray-400 tl-bg-gray-100 focus:tl-border-gray-200 tl-outline-none tl-border-none tl-font-sans",onChange:r},[(Ft(!0),Rt(Qt,null,vn(e.control.options,(e=>(Ft(),Rt("option",{key:e.value,value:e.value},yn(e.text),9,um)))),128))],40,cm)]))}}),dm=It({__name:"ButtonControl",props:{label:{},control:{}},setup(e){const t=e,n=Wt((()=>["leches-btn",`leches-btn-${t.control.value.variant||"primary"}`,`leches-btn-${t.control.value.size||"sm"}`]));return(e,t)=>(Ft(),Rt("button",{class:jt(n.value),onClick:t[0]||(t[0]=(...t)=>e.control.value.onClick&&e.control.value.onClick(...t))},[nn("i",{class:jt([e.control.value.icon,e.control.value.label?"mr-1":""])},null,2),Tn(" "+yn(e.control.value.label),1)],2))}}),pm=Vp(dm,[["__scopeId","data-v-926dfadc"]]),mm={key:0},fm=It({__name:"ControlInput",props:{control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){n("change",e)}return(e,t)=>e.control.visible?(Ft(),Rt("div",mm,["color"===e.control.type?(Ft(),hn(Kp,{key:0,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"select"===e.control.type?(Ft(),hn(hm,{key:1,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"vector"===e.control.type?(Ft(),hn(tm,{key:2,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"boolean"===e.control.type?(Ft(),hn(Fp,{key:3,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"fpsgraph"===e.control.type?(Ft(),hn(am,{key:4,label:e.control.label,control:e.control},null,8,["label","control"])):"number"===e.control.type?(Ft(),hn(Cp,{key:5,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"range"===e.control.type?(Ft(),hn(Xp,{key:6,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"button"===e.control.type?(Ft(),Rt("div",{key:7,class:jt(["tl-p-2","tl-block"===e.control.value.size?"tl-flex":"tl-inline-flex"])},[sn(pm,{label:e.control.label,control:e.control},null,8,["label","control"])],2)):(Ft(),hn(Ip,{key:8,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"]))])):$t("",!0)}}),gm={class:"tl-mb-4"},vm=["aria-expanded","data-folder"],ym={class:"tl-bg-white tl-rounded-b tl-pt-4",role:"menu"},xm=It({__name:"Folder",props:{controls:{},label:{}},setup(e){const t=Ot(!1),n=()=>{t.value=!t.value};return(e,r)=>(Ft(),Rt("div",gm,[nn("button",{class:"tl-flex tl-items-center tl-justify-between tl-w-full tl-py-2 tl-px-4 tl-bg-gray-100 tl-border-none tl-text-gray-400 tl-font-bold tl-text-xs tl-font-sans tl-cursor-pointer","aria-expanded":t.value,"aria-haspopup":"true",role:"button","data-folder":e.label,tabindex:"0",onClick:n},[nn("span",null,yn(e.label),1),nn("i",{class:jt(t.value?"i-ic:baseline-keyboard-arrow-up":"i-ic:baseline-keyboard-arrow-down")},null,2)],8,vm),sn(wn,{name:"slide","enter-active-class":"tl-animate-fade-in tl-animate-duration-200 tl-animate-ease-in-out","leave-active-class":"tl-animate-fade-out tl-animate-duration-200 tl-animate-ease-in-out"},{default:gn((()=>[xn(nn("div",ym,[(Ft(!0),Rt(Qt,null,vn(e.controls,(e=>(Ft(),hn(fm,{key:e.label,control:e,role:"menuitem",onChange:t=>function(e,t){t.value=e}(t,e)},null,8,["control","onChange"])))),128))],512),[[bn,t.value]])])),_:1})]))}}),bm={tabindex:"0",class:"tl-bg-white tl-shadow-xl tl-rounded tl-border-4 tl-border-solid tl-border-black"},wm=It({__name:"TresLeches",props:{uuid:{}},setup(e){const t=e,{uuid:n}=Jt(t),{width:r}=kn(),s=Ot(null),o=function(e=xp){return Kt(yp,bp),bp[e]}(null==n?void 0:n.value);const i=Wt((()=>{const e={};for(const t in o){const n=o[t],r=n.folder||"default";e[r]||(e[r]=[]),e[r].push(n)}return e}));return(e,t)=>(Ft(),hn(Bt(vp),{id:Bt(n),"initial-value":{x:Bt(r)-280-40,y:10},class:jt(["tl-absolute tl-select-none tl-z-24 tl-w-280px tl-font-sans tl-text-xs",e.$attrs.class]),handle:s.value},{default:gn((()=>[nn("div",bm,[nn("header",{ref_key:"handle",ref:s,class:"tl-relative tl-cursor-grabbing tl-p-4 tl-flex tl-justify-between tl-text-gray-200 tl-relative"},t[0]||(t[0]=[nn("i",{class:"tl-h-4 tl-w-4 tl-p-1.5 tl-flex tl-items-center tl-line-height-0 tl-rounded-full tl-bg-gray-100 tl-text-xs"},"ðŸ°",-1),nn("div",null,[nn("i",{class:"i-ic-baseline-drag-indicator"}),nn("i",{class:"i-ic-baseline-drag-indicator"}),nn("i",{class:"i-ic-baseline-drag-indicator"})],-1),nn("div",null,null,-1)]),512),(Ft(!0),Rt(Qt,null,vn(i.value,((e,t)=>(Ft(),Rt(Qt,{key:t},["default"!==t?(Ft(),hn(xm,{key:0,label:t,controls:e},null,8,["label","controls"])):$t("",!0),"default"===t?(Ft(!0),Rt(Qt,{key:1},vn(e,(e=>(Ft(),hn(fm,{key:e.label,control:e,onChange:t=>function(e,t){o[Bt(e)].value=t,o[Bt(e)][Bt(e)]=t}(e.key,t)},null,8,["control","onChange"])))),128)):$t("",!0)],64)))),128))])])),_:1},8,["id","initial-value","class","handle"]))}});export{ls as A,yd as B,yu as C,Jn as D,Ds as E,Ou as F,Dd as G,Ss as H,_p as I,Ad as J,wm as K,fd as L,pu as M,Dr as Q,hd as R,ld as S,rd as T,ql as V,bd as Y,Qr as Z,hu as a,Cr as b,iu as c,Cd as d,as as e,gu as f,Hh as g,Cu as h,Rs as i,qd as j,wu as k,mu as l,Kr as m,dp as n,au as o,tp as p,$l as q,cu as r,cp as s,Pd as t,sp as u,zd as v,_d as w,Gh as x,Xh as y,ec as z};
