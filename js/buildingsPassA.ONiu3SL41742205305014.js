import{b as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.Jt6kAW7U1742205305014.js";import{c6 as t,_ as e,c4 as o,cl as i,C as r,V as u,cw as s}from"./three.LxxvsMJG1742205305014.js";import{m as a,e as c}from"./@tresjs.nk0nhZ9a1742205305014.js";import{d as l,a2 as p,r as f,o as d,f as v,g as m,j as h,aj as w,ak as P}from"./@vue.NRI7TcgI1742205305014.js";import{P as x}from"./tweakpane.yDiyAAkA1742205305014.js";import"./three-custom-shader-material.8lD1n5aS1742205305014.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1742205305014.js";import"./postprocessing.lrLv6HE21742205305014.js";import"./@vueuse.w6JAmAgA1742205305014.js";const g=I;!function(n,t){const e=I,o=y();for(;;)try{if(288710===parseInt(e(230))/1*(-parseInt(e(208))/2)+parseInt(e(227))/3*(-parseInt(e(198))/4)+parseInt(e(239))/5+-parseInt(e(244))/6+parseInt(e(200))/7+parseInt(e(223))/8*(parseInt(e(229))/9)+parseInt(e(235))/10)break;o.push(o.shift())}catch(i){o.push(o.shift())}}();const S=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){S(this,(function(){const n=I,t=new RegExp(n(195)),e=new RegExp(n(248),"i"),o=j(n(211));t.test(o+n(216))&&e.test(o+n(209))?j():o("0")}))()}();const b=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[I(245)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function y(){const n=["prototype","735916PIujeU","set","563626FTBRUM","action","return (function() ","value","Color","buildingsPassA","uScalenum","height","2CnKrap","input","trace","init","string","toString","debu","material","chain","length","addPass","counter","render","uScaleone","uWidth","8LtsPAl","warn","depthTexture","uniforms","3dFtdQX","time","299655MNkXUN","272587wlDuwp","speed","console","bind","table","5020130HGsfYE",'{}.constructor("return this")( )',"DepthTexture","info","2344535SADWyK","uPosition","gger","color","width","2036742kkBZpw","apply","depthBuffer","readBuffer","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","error","uColor","projectionMatrixInverse","constructor","ShaderMaterial","function *\\( *\\)","while (true) {}"];return(y=function(){return n})()}function I(n,t){const e=y();return(I=function(n,t){return e[n-=190]})(n,t)}b(void 0,(function(){const n=I;let t;try{t=Function(n(202)+n(236)+");")()}catch(i){t=window}const e=t[n(232)]=t[n(232)]||{},o=["log",n(224),n(238),n(190),"exception",n(234),n(210)];for(let r=0;r<o[n(217)];r++){const t=b[n(193)][n(197)][n(233)](b),i=o[r],u=e[i]||t;t.__proto__=b[n(233)](b),t[n(213)]=u[n(213)].bind(u),e[i]=t}}))();const _=l({__name:g(205),props:{color:{default:"#FFF"},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(n){const l=n,{renderer:f,scene:d,camera:v,sizes:m}=a();let h,w=0,P=null,x=null;p((()=>{const n=I;m[n(243)][n(203)]&&(h=m[n(243)].value,w=m[n(207)][n(203)],(()=>{const n=I;P=new t(f[n(203)]);const a=new(e[n(237)])(h,w);P[n(247)][n(246)]=!0,P[n(247)][n(225)]=a;const c=new o(d.value,v[n(203)]);P[n(218)](c),x=new i(new(e[n(194)])({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:a},uProjectionInverse:{value:v[n(203)][n(192)]},uMatrixWorld:{value:v[n(203)].matrixWorld},uColor:{value:new r(l[n(242)])},uScalenum:{value:l[n(206)]},uScaleone:{value:l[n(221)]},uWidth:{value:l[n(222)]},uPosition:{value:new u(l[n(240)].x,l[n(240)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),P.addPass(x);const p=new i(s);P[n(218)](p)})())}));const{onLoop:g}=c();return g((({elapsed:n})=>{const t=I;P&&(P[t(220)](),x.uniforms[t(228)].value+=l[t(231)]/60)})),p((()=>{const n=I;x&&(l[n(242)]&&(x[n(215)][n(226)][n(191)][n(203)]=new(e[n(204)])(l[n(242)])),l[n(206)]&&(x[n(215)].uniforms.uScalenum[n(203)]=l[n(206)]),l.uScaleone&&(x[n(215)].uniforms[n(221)][n(203)]=l[n(221)]),l[n(222)]&&(x[n(215)][n(226)][n(222)].value=l[n(222)]),l[n(240)]&&x[n(215)].uniforms[n(240)][n(203)][n(199)](l[n(240)].x,l[n(240)].y))})),(n,t)=>null}});function j(n){function t(n){const e=I;if(typeof n===e(212))return function(n){}[e(193)](e(196))[e(245)](e(219));1!==(""+n/n)[e(217)]||n%20==0?function(){return!0}[e(193)](e(214)+e(241)).call(e(201)):function(){return!1}[e(193)](e(214)+e(241))[e(245)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(e){}}const W=D;function D(n,t){const e=F();return(D=function(n,t){return e[n-=490]})(n,t)}!function(n,t){const e=D,o=F();for(;;)try{if(951710===-parseInt(e(532))/1+parseInt(e(509))/2+-parseInt(e(493))/3*(parseInt(e(535))/4)+parseInt(e(490))/5+parseInt(e(521))/6+-parseInt(e(496))/7*(parseInt(e(491))/8)+-parseInt(e(533))/9*(-parseInt(e(507))/10))break;o.push(o.shift())}catch(i){o.push(o.shift())}}();const M=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[D(527)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){M(this,(function(){const n=D,t=new RegExp(n(502)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=k("init");t[n(497)](o+n(522))&&e[n(497)](o+n(526))?k():o("0")}))()}();const z=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[D(527)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function F(){const n=["debu",'{}.constructor("return this")( )',"toString","8207316fFGKJq","chain","bind","#00b4fb","exception","input","apply","speed","trace","uWidth","counter","1662859AjEBTM","14853735TVgfbn","length","6532948kubwod","9398960TOdKaW","104gXoMax","info","3jGtYwH","gger","prototype","635572YemUQe","test","最大范围","console","color","uPosition","function *\\( *\\)","buildingsPassA","log","uScalenum","inline","10PlaePM","圈颜色","1060122HwRaZJ","table","单条圈宽度","string","uScaleone","addBinding","单条圈间距","constructor","后期效果"];return(F=function(){return n})()}z(void 0,(function(){const n=D,t=function(){const n=D;let t;try{t=Function("return (function() "+n(519)+");")()}catch(e){t=window}return t}(),e=t[n(499)]=t[n(499)]||{},o=[n(504),"warn",n(492),"error",n(525),n(510),n(529)];for(let i=0;i<o[n(534)];i++){const t=z[n(516)][n(495)].bind(z),r=o[i],u=e[r]||t;t.__proto__=z.bind(z),t[n(520)]=u[n(520)][n(523)](u),e[r]=t}}))();const T=l({__name:W(503),setup(t){const e=W,o=f({color:e(524),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),i=new x({title:e(517),expanded:!0});return i.addBinding(o,e(500),{label:e(508)}),i.addBinding(o,e(505),{label:e(498),min:1,max:500,step:10}),i[e(514)](o,e(513),{label:e(515),min:1,max:100,step:1}),i[e(514)](o,e(530),{label:e(511),min:0,max:1,step:.01}),i.addBinding(o,e(528),{label:"速度",min:1,max:20,step:1}),i[e(514)](o,e(501),{picker:e(506),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(t,e)=>(d(),v(n,{disableRender:!0,showAxesHelper:!1},{ability:m((()=>[h(_,w(P(o)),null,16)])),_:1}))}});function k(n){function t(n){const e=D;if(typeof n===e(512))return function(n){}[e(516)]("while (true) {}")[e(527)](e(531));1!==(""+n/n)[e(534)]||n%20==0?function(){return!0}[e(516)](e(518)+"gger").call("action"):function(){return!1}[e(516)]("debu"+e(494))[e(527)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(e){}}export{T as default};
