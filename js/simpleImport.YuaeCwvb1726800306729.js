var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;import{_ as r,bU as o,ak as s,am as i}from"./three.ZddO3ejJ1726800306729.js";import{p as c,U as a,Y as u,L as l}from"./@tresjs.pv1MNfNv1726800306729.js";import{g as p,i as f,e as d}from"./utils.Vy4iO5961726800306729.js";import{_ as m}from"./jszip.1BnN4Vdj1726800306729.js";import{F as h}from"./file-saver.teuVQkhH1726800306729.js";import{P as g}from"./tweakpane.yHWGBmom1726800306729.js";import{d as v,q as y,r as w,Y as b,a3 as j,o as I,E,j as O,g as S,u as L,aj as P,ak as T,f as x,al as _,m as k,F as z,L as R}from"./@vue.bvMz0l_u1726800306729.js";import{w as C}from"./@fesjs.ZmXcHXlr1726800306729.js";import"./@vueuse.bZHkTEeA1726800306729.js";import"./@amap.soyOEMuN1726800306729.js";import"./vue-router.IQrzWmDn1726800306729.js";import"./lodash-es.guXTxyfJ1726800306729.js";import"./@qlin.yHhFDldE1726800306729.js";import"./pinia.sgFdRj_31726800306729.js";import"./@floating-ui.BPbuo5Gx1726800306729.js";import"./@juggle.7yjBMqoW1726800306729.js";const F=N;!function(t,n){const e=N,r=W();for(;;)try{if(178282===-parseInt(e(278))/1*(-parseInt(e(254))/2)+parseInt(e(268))/3+-parseInt(e(305))/4*(-parseInt(e(279))/5)+parseInt(e(264))/6*(parseInt(e(301))/7)+-parseInt(e(270))/8+-parseInt(e(253))/9+-parseInt(e(293))/10*(parseInt(e(296))/11))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const A=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[N(257)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){A(this,(function(){const t=N,n=new RegExp("function *\\( *\\)"),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=K("init");n[t(252)](r+t(260))&&e[t(252)](r+t(272))?K():r("0")}))()}();const J=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[N(257)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function N(t,n){const e=W();return(N=function(t,n){return e[t-=248]})(t,n)}function H(t,n){for(let e=0,r=t[F(287)];e<r;e++)t[e](n)}J(void 0,(function(){const t=N,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),e=n[t(303)]=n.console||{},r=["log",t(281),"info",t(271),"exception",t(276),t(286)];for(let o=0;o<r.length;o++){const n=J[t(298)][t(269)].bind(J),s=r[o],i=e[s]||n;n[t(259)]=J[t(255)](J),n[t(289)]=i.toString[t(255)](i),e[s]=n}}))(),window[F(261)]=r;const M={init:[],start:[],stop:[],keydown:[],keyup:[],pointerdown:[],pointerup:[],pointermove:[],update:[]},G=()=>{};function Z(t){H(M[F(256)],t)}function B(t){H(M[F(283)],t)}function U(t){H(M[F(249)],t)}function W(){const t=["string","while (true) {}","trace","length","call","toString","pointermove","stateObject","scene","100HFNLFn","addEventListener","uuid","203929SlykWw","pointerup","constructor","action","removeEventListener","7tRcCGp","width","console","start","69620AdFCly","replace","height","pointerdown","debu","getObjectByProperty","test","2779299yVFAxA","50pOyQne","bind","keydown","apply","APP.Player: Script without object.","__proto__","chain","THREE","push","player,renderer,scene,camera","179370thHHPe","init","object","stringify","814824EYwBSc","prototype","979920HIcLji","error","input","counter","scripts","stop","table","update","9992xTXWhI","70PZoANJ","gger","warn","value","keyup"];return(W=function(){return t})()}function $(t){H(M[F(297)],t)}function D(t){H(M[F(290)],t)}function K(t){function n(t){const e=N;if(typeof t===e(284))return function(t){}[e(298)](e(285))[e(257)](e(273));1!==(""+t/t)[e(287)]||t%20==0?function(){return!0}[e(298)](e(250)+e(280))[e(288)](e(299)):function(){return!1}.constructor(e(250)+e(280))[e(257)](e(291)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=Y,r=V();for(;;)try{if(941628===parseInt(e(319))/1*(-parseInt(e(351))/2)+-parseInt(e(327))/3*(parseInt(e(348))/4)+parseInt(e(329))/5*(-parseInt(e(340))/6)+parseInt(e(318))/7*(parseInt(e(325))/8)+parseInt(e(334))/9+-parseInt(e(331))/10*(parseInt(e(323))/11)+parseInt(e(352))/12)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const q=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[Y(316)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){q(this,(function(){const t=Y,n=new RegExp(t(314)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=Q(t(347));n.test(r+t(338))&&e[t(335)](r+t(328))?Q():r("0")}))()}();const X=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[Y(316)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function Y(t,n){const e=V();return(Y=function(t,n){return e[t-=314]})(t,n)}X(void 0,(function(){const t=Y,n=function(){const t=Y;let n;try{n=Function("return (function() "+t(345)+");")()}catch(e){n=window}return n}(),e=n[t(354)]=n[t(354)]||{},r=[t(322),t(341),t(330),t(342),"exception",t(349),"trace"];for(let o=0;o<r.length;o++){const n=X[t(350)][t(321)][t(320)](X),s=r[o],i=e[s]||n;n[t(344)]=X.bind(X),n.toString=i[t(317)][t(320)](i),e[s]=n}}))();function V(){const t=["bind","prototype","log","33iJcaMJ","stringify","64tKrUfG","\n\t\tthis.events = {\n\t\t\t\tinit: [],\n\t\t\t\tstart: [],\n\t\t\t\tstop: [],\n\t\t\t\tkeydown: [],\n\t\t\t\tkeyup: [],\n\t\t\t\tpointerdown: [],\n\t\t\t\tpointerup: [],\n\t\t\t\tpointermove: [],\n\t\t\t\tupdate: [],\n\t\t}\n\t\tlet scriptWrapParams = 'player,renderer,scene,camera'\n\t\tconst scriptWrapResultObj = {}\n\n\t\tfor (const eventKey in this.events) {\n\t\t\t\tscriptWrapParams += `,${eventKey}`\n\t\t\t\tscriptWrapResultObj[eventKey] = eventKey\n\t\t}\n\t\tconst scriptWrapResult = JSON.stringify(scriptWrapResultObj).replace(/\\\"/g, '')\n\t\tfor (const uuid in scriptsJson) {\n\t\t\t\tlet curUuid = uuid\n\t\t\t\t//这里解决一个问题 目前并没有把 主场景scene直接替换而是通过group 加进入的，所以 如果事件是基于主场景scene 那么替换这个uuid为现在tres主场景的uuid\n\t\t\t\tif (uuid === sceneObject.uuid) {\n\t\t\t\t\t\tcurUuid = this.scene.uuid\n\t\t\t\t}\n\t\t\t\tconst object = this.scene.getObjectByProperty('uuid', curUuid, true)\n\t\t\t\tif (object === undefined) {\n\t\t\t\t\t\tconsole.warn('player: Script without object.', curUuid)\n\t\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst scripts = scriptsJson[uuid]\n\t\t\t\tfor (let i = 0; i < scripts.length; i++) {\n\t\t\t\t\t\tconst script = scripts[i]\n\t\t\t\t\t\t// eslint-disable-next-line no-new-func\n\t\t\t\t\t\tconst functions = new Function(scriptWrapParams, `${script.source}\nreturn ${scriptWrapResult};`).bind(object)(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.renderer,\n\t\t\t\t\t\t\t\tthis.scene,\n\t\t\t\t\t\t\t\tthis.camera,\n\t\t\t\t\t\t)\n\t\t\t\t\t\tfor (const name in functions) {\n\t\t\t\t\t\t\t\tif (functions[name] === undefined) continue\n\t\t\t\t\t\t\t\tif (this.events[name] === undefined) {\n\t\t\t\t\t\t\t\t\t\tconsole.warn('player: Event type not supported (', name, ')')\n\t\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.events[name].push(functions[name].bind(object))\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.dispatch(this.events.init, arguments)\n\t\t}\n\t},\n\tdispatch(array, event) {\n\t\tfor (let i = 0, l = array.length; i < l; i++) {\n\t\t\t\tarray[i](event)\n\t\t}\n\t},\n\tsetCamera(value) {\n\t\t\tconsole.warn('暂时不考虑摄像机的设置函数', value)\n\t\t\t// camera = value\n\t\t\t// camera.aspect = this.width / this.height\n\t\t\t// camera.updateProjectionMatrix()\n\t},\n\tsetScene(value) {\n\t\t\tconsole.warn('暂时不考虑场景的设置函数', value)\n\t\t\t// scene = value\n\t},\n\tsetPixelRatio(value) {\n\t\t\tconsole.warn('暂时不考虑像素比的设置函数', value)\n\t},\n\tsetSize(value) {\n\t\t\tconsole.warn('暂时不考虑尺寸的设置函数', value)\n\t},\n\tdispose() {\n\t\t\t// renderer.dispose();\n\t\t\t// camera = undefined;\n\t\t\t// scene = undefined;\n\t\t\tconsole.warn('暂时不考虑释放资源的函数')\n\t},\n\tonKeyDown(event) {\n\t\tplayer.dispatch(player.events.keydown, event)\n\t},\n\tonKeyUp(event) {\n\t\t\tplayer.dispatch(player.events.keyup, event)\n\t},\n\tonPointerDown(event) {\n\t\t\tplayer.dispatch(player.events.pointerdown, event)\n\t},\n\tonPointerUp(event) {\n\t\t\tplayer.dispatch(player.events.pointerup, event)\n\t},\n\tonPointerMove(event) {\n\t\t\tplayer.dispatch(player.events.pointermove, event)\n\t},\n\tplay() {\n\t\t\tdocument.addEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.addEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.addEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.addEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.addEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.start, null)\n\t\t\t//renderer.setAnimationLoop( animate ); 播放是自动的\n\t},\n\tstop() {\n\t\t\tdocument.removeEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.removeEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.removeEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.removeEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.removeEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.stop, arguments)\n\t\t\t// renderer.setAnimationLoop( null );播放是自动的\n\t},\n\trender(elapsed, delta) {\n\t\t\tthis.dispatch(this.events.update, { time: elapsed, delta })\n\t},\n}\nexport default player\n","2679GDmquT","input","6755MkYBVx","info","5644770tzqCLF","length","counter","15883020ujkAXr","test","debu","stateObject","chain","string","1314xiRTIc","warn","error","/* eslint-disable prefer-rest-params */\n/* eslint-disable no-undefined */\n/* eslint-disable guard-for-in */\nimport * as THREE from 'three'\n\nwindow.THREE = THREE // Used by APP Scripts.\nconst Grscwh = { scene: null, renderer: null, camera: null, sizes: null }\nconst player = {\n\tget renderer() {\n\t\treturn Grscwh.renderer?.value\n\t},\n\tloader: new THREE.TextureLoader(),\n\tget scene() {\n\t\t\treturn Grscwh.scene?.value\n\t},\n\tget camera() {\n\t\t\treturn Grscwh.camera?.value\n\t},\n\tget width() {\n\t\t\treturn Grscwh.sizes?.width?.value\n\t},\n\tget height() {\n\t\t\treturn Grscwh.sizes?.height?.value\n\t},\n\tget dom() {\n\t\t\treturn Grscwh.renderer?.value.domElement.parentElement\n\t},\n\tget canvas() {\n\t\t\treturn Grscwh.renderer?.value.domElement\n\t},\n\tevents: {},\n\tinit(scene, renderer, camera, sizes) {\n\t\t\tGrscwh.scene = scene\n\t\t\tGrscwh.renderer = renderer\n\t\t\tGrscwh.camera = camera\n\t\t\tGrscwh.sizes = sizes\n\t},\n\tload(sceneObject) {\n\t\t","__proto__",'{}.constructor("return this")( )',"while (true) {}","init","4056aDpmLU","table","constructor","131218eWEWPe","20904936JAbALu","call","console","function *\\( *\\)","gger","apply","toString","1436533wOVakl","20BTOLXa"];return(V=function(){return t})()}function Q(t){function n(t){const e=Y;if(typeof t===e(339))return function(t){}.constructor(e(346)).apply(e(333));1!==(""+t/t)[e(332)]||t%20==0?function(){return!0}[e(350)](e(336)+e(315))[e(353)]("action"):function(){return!1}[e(350)]("debu"+e(315))[e(316)](e(337)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=ot,r=et();for(;;)try{if(920106===-parseInt(e(408))/1*(-parseInt(e(490))/2)+parseInt(e(438))/3+parseInt(e(390))/4*(parseInt(e(442))/5)+parseInt(e(402))/6*(parseInt(e(393))/7)+-parseInt(e(437))/8*(parseInt(e(449))/9)+parseInt(e(441))/10*(parseInt(e(377))/11)+-parseInt(e(433))/12)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const tt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[ot(420)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){tt(this,(function(){const t=ot,n=new RegExp(t(465)),e=new RegExp(t(448),"i"),r=ut(t(401));n[t(411)](r+"chain")&&e[t(411)](r+t(414))?ut():r("0")}))()}();const nt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[ot(420)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function et(){const t=["src/plugins/","<Tres","forEach",'" name="',",\n\ttoneMappingExposure:","THREE.PCFShadowMap","<TresGridHelper />","url:geometries/","call","fileName","toneMappingExposure","34MXkFIo","pages/index.vue","18279701jICMXf","object",'/${url}`\n            }\n            if (url.endsWith(".json")) {\n                image.url = await loadJsonFile(url)\n            } else {\n                image.url = await loadImageToBase64(url)\n            }\n        }\n    }\n}\n\nconst sceneObject = loader.parse(scene) as any\nonMounted(() => {\n    tresScene.value.background = sceneObject.background\n    tresScene.value.environment = sceneObject.environment\n    tresScene.value.fog = sceneObject.fog\n    player.load(sceneObject)\n    player.play()\n})\nconst { onLoop } = useRenderLoop()\nonLoop(({ delta, elapsed }) => {\n    if (player.renderer) {\n        player.render(elapsed * 1000, delta * 1000)\n    }\n})\n<\/script>',"pop","length","secondLevel",'" type="',",\n})\n\nconst cameraConfig = ","debu","while (true) {}","uuid","children","camera","16OcZPvp","getDate","\n\nconst { scene: tresScene, renderer, camera, sizes } = useTresContext()\nplayer.init(tresScene, renderer, camera, sizes)\n\nconst loader = new THREE.ObjectLoader()\nconst scene = await loadJsonFile('./plugins/","7ENBaso","<template>\n        ",'\n<template>\n    <loading />\n\t<TresCanvas v-bind="state">\n\t\t',"data","info","blob",'"/>\n        ','"/>\n    ',"init","403278XPItqs","string","console","THREE.NoToneMapping",'].children" />',"gger","70138EajCVU","\n\t\t","stringify","test"," from './childComponent/","push","input","generateAsync","constructor",".json","url:images/",'    \n    <primitive :object="sceneObject.children[',"apply","split","childLevel","getMonth","warn",",\n\ttoneMapping: ","toString",".vue","import ","type","log","/json/scene.json')\n\nif (scene.geometries) {\n    for (const geometry of scene.geometries) {\n        if (geometry.data && geometry.data.startsWith('url:')) {\n            let url = geometry.data.slice(4)\n            if (url.startsWith('geometries/')) {\n                url = `./plugins/","file","35612676DnNbQJ","return (function() ","common/eventScript.js","error","16lBJFVN","1579083ZYpmyh",'",\n\t\t"updateTime": "',"__proto__","10TYVpGz","2118170QdNKbp",".zip","thirdLevel","pluginName","stateObject","/${url}`\n            }\n            geometry.data = await loadJsonFile(url)\n        }\n    }\n}\nif (scene.images) {\n    for (const image of scene.images) {\n        if (image.url && image.url.startsWith('url:')) {\n            let url = image.url.slice(4)\n            if (url.startsWith('images/')) {\n                url = `./plugins/","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","5644881zUdtvF","bind","name",'\n        <primitive :object="object[',"toneMapping","trace",'" />',"comName","url",'  ref="cameraRef" uuid="',"folder",'\n</template>\n\n<script setup lang="ts">\nconst props = withDefaults(\n    defineProps<{\n        object: any\n    }>(),\n    {},\n)\n<\/script>\n',"gridHelper","geometries","<Suspense>\n\t\t\t<sceneCom />\n\t\t</Suspense>","padStart","function *\\( *\\)","true","scene","images",'",\n\t\t"require": [],\n        "tvtstore": \'LOCAL\',\n\t\t"preview": [\n\t\t\t{ "src": "plugins/basic/base/preview/theBasic.png", "type": "img", "name": "index", "title": "实例" ,"disableFPSGraph": false, "disableSrcBtn": false},\n\t\t]\n\t}',";base64,","shadowType",']" name="',"action","BufferGeometry",'",\n\t\t"title": "编辑器导出的插件",\n\t\t"intro": "描述",\n\t\t"version": "0.0.1",\n\t\t"author": "作者名",\n\t\t"website": "站点地址",\n\t\t"state": "active",\n\t\t"creatTime": "',"public/plugins/","getFullYear",'" uuid="'];return(et=function(){return t})()}nt(void 0,(function(){const t=ot,n=function(){const t=ot;let n;try{n=Function(t(434)+'{}.constructor("return this")( ));')()}catch(e){n=window}return n}(),e=n[t(404)]=n.console||{},r=[t(430),t(424),t(397),t(436),"exception","table",t(454)];for(let o=0;o<r[t(381)];o++){const n=nt[t(416)].prototype[t(450)](nt),s=r[o],i=e[s]||n;n[t(440)]=nt[t(450)](nt),n[t(426)]=i.toString[t(450)](i),e[s]=n}}))();let rt=[];function ot(t,n){const e=et();return(ot=function(t,n){return e[t-=376]})(t,n)}const st=(r,o,s,i)=>{const c=ot,a=s[c(378)],{uuid:u}=a,l=((r,o)=>{var s={};for(var i in r)n.call(r,i)&&o.indexOf(i)<0&&(s[i]=r[i]);if(null!=r&&t)for(var i of t(r))o.indexOf(i)<0&&e.call(r,i)&&(s[i]=r[i]);return s})(a,["uuid"]),p=JSON.parse(JSON[c(410)](s));return p[c(378)]=l,c(395)+(i.orbitControls?"<OrbitControls />":"")+c(409)+(s?c(480)+s[c(378)][c(429)]+c(458)+s[c(378)][c(387)]+c(482)+s[c(378)].name+c(455):"")+c(409)+r+c(409)+(i[c(461)]?c(485):"")+"\n\t</TresCanvas>\n</template>\n<script setup lang=\"ts\">\nimport * as THREE from 'three'\nimport { reactive, watch, ref } from 'vue'\nimport { TresCanvas } from '@tresjs/core'\nimport { OrbitControls } from '@tresjs/cientos'\nimport sceneCom from '../components/scene.vue'\nimport { loading2 as loading } from 'PLS/UIdemo'\n\nconst state = reactive({\n\tclearColor: '#201919',\n\twindowSize:true,\n\tantialias: true,\n\tshadows: "+(o.shadows?c(466):"false")+",\n\tshadowMapType: "+(o[c(471)]?o[c(471)]:c(484))+c(425)+(o[c(453)]?o[c(453)]:c(405))+c(483)+(o[c(489)]?o.toneMappingExposure:"1")+c(384)+(p?""+JSON[c(410)](p):"{}")+"\nconst loader = new THREE.ObjectLoader()\nconst cameraObject = loader.parse(cameraConfig)\nconst cameraRef = ref(null)\nwatch(\n\t() => cameraRef.value,\n\t(val) => {\n\t\t\tval.copy(cameraObject)\n\t},\n)\n<\/script>\n\t"},it=(t,n,e,r,o)=>{const s=ot;n[s(422)];let i='\n    <primitive :object="sceneObject.children['+r+s(472)+e.name+s(478)+e[s(387)]+s(383)+e[s(429)]+'">\n    ';if(e[s(388)]&&e[s(388)][s(381)]){const n=((t,n)=>{const e=ot,r=t-1,o=["firstLevel",e(382),e(444)],s=n[e(421)]("-")[e(380)]();return{fileName:o[r]+"-"+s+e(427),comName:""+o[r]+s}})(o,e[s(387)]);i+="<"+n[s(456)]+' :object="sceneObject.children['+r+s(406),((t,n,e)=>{const r=ot;let o="";e.forEach(((t,n)=>{const e=ot;o+=e(452)+n+e(472)+t.name+'" uuid="'+t[e(387)]+'" type="'+t[e(429)]+e(399)}));const s="<template>\n    "+o+r(460);t[r(432)](""+n[r(488)],s),rt[r(413)](n)})(t,n,e[s(388)])}return i+="\n    </primitive>\n",i},ct=(t,n,e)=>{const r=ot;let o="";const s=t[r(459)]("components/childComponent");return e[r(378)]&&e[r(378)][r(388)]&&e.object[r(388)].length&&e[r(378)][r(388)][r(481)](((t,e)=>{const i=r;n.childLevel>0&&t[i(388)]&&t[i(388)][i(381)]?o+=it(s,n,t,e,1):o+=i(419)+e+i(472)+t[i(451)]+i(478)+t[i(387)]+'" type="'+t[i(429)]+i(400)})),t.file("components/scene.vue",r(394)+o+"</template>\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue'\nimport * as THREE from 'three'\nimport { loadImageToBase64, loadJsonFile } from 'PLS/tresEditor'\nimport { useTresContext, useRenderLoop } from '@tresjs/core'\nimport player from '../common/eventScript'\n"+(()=>{const t=ot;let n="";return rt[t(481)]((e=>{const r=t;n+=r(428)+e[r(456)]+r(412)+e[r(488)]+"'\n"})),n})()+r(392)+n[r(445)]+r(431)+n[r(445)]+r(447)+n.pluginName+r(379)),r(463)};function at(t,n){const e=ot;rt=[];const r=n[e(445)],o=new m;((t,n)=>{const e=ot,r=[];n[e(462)]&&n[e(462)][e(481)]((t=>{const n=e;t[n(429)]===n(474)&&(r[n(413)]({uuid:t[n(387)],data:t[n(396)]}),t[n(396)]=n(486)+t[n(387)]+".json")}));const o=[];if(n[e(468)]&&n[e(468)][e(481)]((t=>{const n=e;t[n(457)]&&(o[n(413)]({uuid:t[n(387)],url:t[n(457)]}),t[n(457)].type?t.url=n(418)+t[n(387)]+"."+t[n(457)][n(429)]+n(417):t[n(457)]="url:images/"+t[n(387)]+"."+p(t[n(457)]))})),r[e(381)]){const n=t[e(459)]("geometries");r[e(481)]((t=>{const r=e;n.file(t.uuid+r(417),JSON.stringify(t[r(396)]))}))}if(o.length){const n=t[e(459)](e(468));o.forEach((t=>{const r=e;t[r(457)][r(429)]?n[r(432)](t[r(387)]+"."+t[r(457)][r(429)]+".json",JSON[r(410)](t[r(457)])):n[r(432)](t[r(387)]+"."+p(t[r(457)]),t[r(457)][r(421)](r(470))[r(380)](),{base64:!0})}))}t.file("json/scene.json",JSON.stringify(n))})(o[e(459)](e(476)+r),t[e(467)]);const s=o[e(459)](e(479)+r);s[e(432)]("config.js",(t=>{const n=ot,e=new Date,r=e[n(477)]()+"-"+String(e[n(423)]()+1)[n(464)](2,"0")+"-"+String(e[n(391)]())[n(464)](2,"0");return'\n\texport default {\n\t\t"name": "'+t+n(475)+r+n(439)+r+n(469)})(r));const i=st(ct(s,n,t.scene),t.project,t[e(389)],n);return s[e(432)](e(376),i),s[e(432)](e(435),(t=>{const n=Y,e="const scriptsJson = \n"+JSON[n(324)](t)+"\n";return n(343)+e+n(326)})(t.scripts)),o[e(415)]({type:e(398)}).then((t=>{const n=e;h.saveAs(t,r+n(443))}))}function ut(t){function n(t){const e=ot;if(typeof t===e(403))return function(t){}.constructor(e(386))[e(420)]("counter");1!==(""+t/t)[e(381)]||t%20==0?function(){return!0}[e(416)](e(385)+e(407))[e(487)](e(473)):function(){return!1}[e(416)](e(385)+"gger")[e(420)](e(446)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const lt=ft;!function(t,n){const e=ft,r=mt();for(;;)try{if(643719===parseInt(e(232))/1+-parseInt(e(240))/2+parseInt(e(164))/3*(-parseInt(e(227))/4)+parseInt(e(237))/5*(parseInt(e(202))/6)+parseInt(e(224))/7+-parseInt(e(182))/8+-parseInt(e(173))/9)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const pt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function ft(t,n){const e=mt();return(ft=function(t,n){return e[t-=163]})(t,n)}!function(){pt(this,(function(){const t=ft,n=new RegExp(t(192)),e=new RegExp(t(244),"i"),r=gt(t(211));n[t(207)](r+"chain")&&e.test(r+t(219))?gt():r("0")}))()}();const dt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[ft(203)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function mt(){const t=["2559907vNiCsy","bind","gger","20ePZuaO","pluginName","toString","error","gridHelper","518897OkaRuZ","table","Json2Zip","geometry","warn","5EzjjXt","导入原生场景Json","click","485592hrYHft","log","导入分解场景Zip","add","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","target","action","children","ObjectLoader","199587ljLvwu","onchange","分解场景[中间件 测试用]","importJson","background","addFolder","onload","生成插件包","getElementById","4960566nBzmyj","场景内无物体","warning","trace","clear","stateObject","默认控制器","console","material","1235184aPrlRN","默认网格","清空场景","forEach","先清空场景","result","accept","debu","string","counter","function *\\( *\\)","value","length","reload","TvT插件包",".zip","return (function() ","生成分解场景Zip","dispose","addButton","6240804mhgIvF","apply","__proto__","srcJson","请正确填写插件名称","test","prototype","orbitControls",'{}.constructor("return this")( )',"init","MakePlugin","environment","Group","fileInput",".json","call","确定要执行操作吗？","input","constructor","while (true) {}","parse","addBinding"];return(mt=function(){return t})()}dt(void 0,(function(){const t=ft;let n;try{n=Function(t(198)+t(210)+");")()}catch(o){n=window}const e=n.console=n[t(180)]||{},r=[t(241),t(236),"info",t(230),"exception",t(233),t(176)];for(let s=0;s<r[t(194)];s++){const n=dt[t(220)][t(208)][t(225)](dt),o=r[s],i=e[o]||n;n[t(204)]=dt[t(225)](dt),n[t(229)]=i[t(229)][t(225)](i),e[o]=n}}))();const ht=v({__name:lt(167),setup(t){const n=lt;let e,o=null;var s=new(r[n(163)]);let i=null;const{scene:u,renderer:l,camera:p,sizes:m}=c(),h=()=>{if(!i)return;const t=n=>{const e=ft;let r=n.children.filter((t=>!!t));r[e(185)]((n=>{const r=e;n[r(247)][r(194)]?t(n):((t=>{var n,e;const r=ft;null==(n=t[r(235)])||n[r(200)](),null==(e=t[r(181)])||e[r(200)]()})(n),n[r(177)]())})),n[e(177)](),r=null};t(i),i=null},v=t=>{const e=n;h(),(()=>{const t=F;document[t(300)]("keydown",Z),document[t(300)]("keyup",B),document[t(300)]("pointerdown",U),document.removeEventListener("pointerup",$),document.removeEventListener(t(290),D),H(M[t(275)],null),M[t(265)]=[],M[t(304)]=[],M[t(275)]=[],M[t(256)]=[],M[t(283)]=[],M[t(249)]=[],M[t(297)]=[],M[t(290)]=[],M.update=[]})(),i=new(r[e(214)]),t[e(247)]&&(i[e(247)]=t[e(247)],u.value[e(243)](i),u.value[e(168)]=t[e(168)],u[e(193)][e(213)]=t[e(213)],u[e(193)].fog=t.fog)},w=new g;w.addButton({title:n(184),label:"clear"}).on(n(239),(()=>{const t=n;confirm(t(218))&&window.location[t(195)]()}));w.addButton({title:n(238),label:n(205)}).on(n(239),(()=>{var t,r;const s=n;o?null==(r=(t=C)[s(175)])||r.call(t,{content:s(186),colorful:!0}):e&&(e[s(188)]=s(216),e[s(193)]=null,e[s(239)]())}));const b=w[n(169)]({title:n(166),expanded:!1});b[n(201)]({title:n(199),label:n(234)}).on(n(239),(()=>{var t,e;const r=n;o?d(o):null==(e=(t=C)[r(175)])||e.call(t,{content:r(174),colorful:!0})}));b[n(201)]({title:n(242),label:"Zip2Json"}).on(n(239),(()=>{var t,r;const s=n;o?null==(r=(t=C)[s(175)])||r.call(t,{content:"先清空场景",colorful:!0}):e&&(e[s(188)]=".zip",e[s(193)]=null,e[s(239)]())}));const j={orbitControls:!0,gridHelper:!0,pluginName:"testEditor",childLevel:1},I=w[n(169)]({title:n(196)});I[n(223)](j,n(228),{label:"插件名称"}),I[n(223)](j,n(209),{label:n(179)}),I[n(223)](j,n(231),{label:n(183)});I[n(201)]({title:n(171),label:n(212)}).on("click",(()=>{var t,e,r,s;const i=n;o?j[i(228)]?at(o,j):null==(e=(t=C).warning)||e.call(t,{content:i(206),colorful:!0}):null==(s=(r=C)[i(175)])||s.call(r,{content:i(174),colorful:!0})}));const E=t=>{const e=n;o=t,v(s[e(222)](o.scene)),((t,n,e,r,o)=>{const s=F,i=o[s(274)]||{};let c=s(263);const a={};for(const l in M)c+=","+l,a[l]=l;const u=JSON[s(267)](a)[s(306)](/\"/g,"");for(const l in i){let a=l;l===o[s(292)][s(266)][s(295)]&&(a=n.uuid);const p=n[s(251)](s(295),a,!0);if(void 0===p){console[s(281)](s(258),a);continue}const f=i[l];for(let o=0;o<f[s(287)];o++){const i=f[o],a=new Function(c,i.source+"\nreturn "+u+";")[s(255)](p)({width:r[s(302)][s(282)],height:r[s(248)][s(282)],setCamera:G},t,n,e);for(const t in a)void 0!==a[t]&&(void 0!==M[t]?M[t][s(262)](a[t].bind(p)):console[s(281)]("APP.Player: Event type not supported (",t,")"))}}H(M[s(265)],null)})(l[e(193)],u[e(193)],p[e(193)],m,o),(()=>{const t=F;document[t(294)]("keydown",Z),document[t(294)](t(283),B),document[t(294)]("pointerdown",U),document[t(294)]("pointerup",$),document[t(294)](t(290),D),H(M[t(304)],null)})()};y((()=>{const t=n;e=document[t(172)](t(215)),e&&(e[t(165)]=n=>{const r=t,o=n[r(245)].files[0];if(".json"===e.accept){const t=new FileReader;t[r(170)]=t=>{const n=r,e=t[n(245)][n(187)];E(JSON[n(222)](e))},t.readAsText(o)}e[r(188)]===r(197)&&f(o,E)})}));const{onLoop:O}=a();return O((({delta:t,elapsed:n})=>{var e,r;e=1e3*n,r=1e3*t,H(M[F(277)],{time:e,delta:r})})),(t,n)=>null}});function gt(t){function n(t){const e=ft;if(typeof t===e(190))return function(t){}.constructor(e(221))[e(203)](e(191));1!==(""+t/t)[e(194)]||t%20==0?function(){return!0}[e(220)](e(189)+e(226))[e(217)](e(246)):function(){return!1}.constructor(e(189)+e(226))[e(203)](e(178)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const vt=Ot;!function(t,n){const e=Ot,r=bt();for(;;)try{if(526502===parseInt(e(134))/1*(-parseInt(e(144))/2)+parseInt(e(142))/3*(-parseInt(e(126))/4)+parseInt(e(131))/5+-parseInt(e(112))/6*(parseInt(e(154))/7)+-parseInt(e(133))/8*(-parseInt(e(113))/9)+-parseInt(e(114))/10*(parseInt(e(140))/11)+-parseInt(e(117))/12*(-parseInt(e(120))/13))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const yt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){yt(this,(function(){const t=Ot,n=new RegExp(t(148)),e=new RegExp(t(147),"i"),r=Lt(t(156));n.test(r+t(139))&&e.test(r+"input")?Lt():r("0")}))()}();const wt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[Ot(121)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function bt(){const t=["info","324qHszfQ","value","__proto__","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","function *\\( *\\)","fileInput","trace","warn","error","#201919","142023xzkXxE","none","init",".zip","log","84JzAolF","50877iQEVjP","256070EFiTYY","exception","TresGridHelper","500964GqyTQK","bind","stateObject","364qHtslZ","apply","action","console","counter","debu","434420zmfAUB","simpleImport",'{}.constructor("return this")( )',"toString","return (function() ","3209515VLSnQh","constructor","904TlzlAS","601XgaXBP","length","while (true) {}","gger","call","chain","429mwgvMN","prototype","15eoWhqy"];return(bt=function(){return t})()}wt(void 0,(function(){const t=Ot,n=function(){const t=Ot;let n;try{n=Function(t(130)+t(128)+");")()}catch(e){n=window}return n}(),e=n[t(123)]=n[t(123)]||{},r=[t(111),t(151),t(143),t(152),t(115),"table",t(150)];for(let o=0;o<r[t(135)];o++){const n=wt.constructor[t(141)][t(118)](wt),s=r[o],i=e[s]||n;n[t(146)]=wt[t(118)](wt),n[t(129)]=i.toString[t(118)](i),e[s]=n}}))();const jt=R("TresPerspectiveCamera",{position:[15,15,15],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1),It=R(vt(116),null,null,-1),Et=R("input",{id:vt(149),type:"file",accept:vt(110),style:{display:vt(155)}},null,-1);function Ot(t,n){const e=bt();return(Ot=function(t,n){return e[t-=110]})(t,n)}const St=v({__name:vt(127),setup(t){const n=vt,e=w({clearColor:n(153),shadows:!0,alpha:!1,shadowMapType:o,outputColorSpace:s,toneMapping:i}),r=w({enableDamping:!0,dampingFactor:.05}),c=b(null);return j((()=>{c[n(145)]})),(t,n)=>(I(),E(z,null,[O(L(l),k(e,{"window-size":""}),{default:S((()=>[jt,O(L(u),P(T(r)),null,16),(I(),x(_,null,{default:S((()=>[O(ht)])),_:1})),It])),_:1},16),Et],64))}});function Lt(t){function n(t){const e=Ot;if("string"==typeof t)return function(t){}.constructor(e(136))[e(121)](e(124));1!==(""+t/t)[e(135)]||t%20==0?function(){return!0}[e(132)](e(125)+e(137))[e(138)](e(122)):function(){return!1}.constructor(e(125)+e(137))[e(121)](e(119)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{St as default};
