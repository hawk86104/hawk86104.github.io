import{importShared as e}from"./3d-tiles-renderer.de6b_qgz1767149344623.js";import{shaderMaterial as o}from"./shaderMaterial.Cc16aWoi1767149344623.js";const n=await e("three"),i=o({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,cellThickness:.5,sectionThickness:1,cellColor:new n.Color,sectionColor:new n.Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new n.Vector3,worldPlanePosition:new n.Vector3},"\n      varying vec3 localPosition;\n      varying vec4 worldPosition;\n  \n      uniform vec3 worldCamProjPosition;\n      uniform vec3 worldPlanePosition;\n      uniform float fadeDistance;\n      uniform bool infiniteGrid;\n      uniform bool followCamera;\n  \n      void main() {\n        localPosition = position.xzy;\n        if (infiniteGrid) localPosition *= 1.0 + fadeDistance;\n        \n        worldPosition = modelMatrix * vec4(localPosition, 1.0);\n        if (followCamera) {\n          worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);\n          localPosition = (inverse(modelMatrix) * worldPosition).xyz;\n        }\n  \n        gl_Position = projectionMatrix * viewMatrix * worldPosition;\n      }\n    ",`\n      varying vec3 localPosition;\n      varying vec4 worldPosition;\n  \n      uniform vec3 worldCamProjPosition;\n      uniform float cellSize;\n      uniform float sectionSize;\n      uniform vec3 cellColor;\n      uniform vec3 sectionColor;\n      uniform float fadeDistance;\n      uniform float fadeStrength;\n      uniform float cellThickness;\n      uniform float sectionThickness;\n  \n      float getGrid(float size, float thickness) {\n        vec2 r = localPosition.xz / size;\n        vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n        float line = min(grid.x, grid.y) + 1.0 - thickness;\n        return 1.0 - min(line, 1.0);\n      }\n  \n      void main() {\n        float g1 = getGrid(cellSize, cellThickness);\n        float g2 = getGrid(sectionSize, sectionThickness);\n  \n        float dist = distance(worldCamProjPosition, worldPosition.xyz);\n        float d = 1.0 - min(dist / fadeDistance, 1.0);\n        vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));\n  \n        gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));\n        gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);\n        if (gl_FragColor.a <= 0.0) discard;\n  \n        #include <tonemapping_fragment>\n        #include <${parseInt(n.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>\n      }\n    `),{defineComponent:l}=await e("vue"),{unref:t,openBlock:r,createElementBlock:a}=await e("vue"),s=["object"],c=await e("three"),{watchEffect:f}=await e("vue"),d=l({__name:"gridPlusCom",props:{args:{default:[10,10]},cellColor:{default:"#6f6f6f"},cellSize:{default:.6},cellThickness:{default:1},sectionColor:{default:"#9d4b4b"},sectionSize:{default:3.3},sectionThickness:{default:1.5},fadeDistance:{default:25},fadeStrength:{default:1},followCamera:{type:Boolean,default:!1},infiniteGrid:{type:Boolean,default:!0}},setup(e){const o=e,l=(({args:e=[1,1],cellColor:o=new n.Color("#000000"),sectionColor:l=new n.Color("#2080ff"),cellSize:t=.5,sectionSize:r=1,followCamera:a=!1,infiniteGrid:s=!1,fadeDistance:c=100,fadeStrength:f=1,cellThickness:d=.5,sectionThickness:m=1,side:C=n.BackSide}={})=>{const w=new i({transparent:!0,side:C,cellSize:t,sectionSize:r,cellColor:o,sectionColor:l,cellThickness:d,sectionThickness:m,fadeDistance:c,fadeStrength:f,infiniteGrid:s,followCamera:a}),g=new n.PlaneGeometry(e[0],e[1]),u=new n.Mesh(g,w);u.frustumCulled=!1;const h=new n.Plane,P=new n.Vector3(0,1,0),S=new n.Vector3(0,0,0);return{mesh:u,update:e=>{if(!u.parent)return;h.setFromNormalAndCoplanarPoint(P,S).applyMatrix4(u.matrixWorld);const o=u.material,n=o.uniforms.worldCamProjPosition,i=o.uniforms.worldPlanePosition;h.projectPoint(e.position,n.value),i.value.set(0,0,0).applyMatrix4(u.matrixWorld)}}})({args:o.args,cellSize:o.cellSize,cellThickness:o.cellThickness,cellColor:new c.Color(o.cellColor),sectionSize:o.sectionSize,sectionThickness:o.sectionThickness,sectionColor:new c.Color(o.sectionColor),fadeDistance:o.fadeDistance,fadeStrength:o.fadeStrength,followCamera:o.followCamera,infiniteGrid:o.infiniteGrid});return f(()=>{const e=l.mesh.material;e.cellSize=o.cellSize,e.cellThickness=o.cellThickness,e.cellColor.set(o.cellColor),e.sectionColor.set(o.sectionColor),e.sectionSize=o.sectionSize,e.sectionThickness=o.sectionThickness,e.fadeDistance=o.fadeDistance,e.fadeStrength=o.fadeStrength,e.followCamera=o.followCamera,e.infiniteGrid=o.infiniteGrid}),(e,o)=>(r(),a("primitive",{object:t(l).mesh},null,8,s))}});export{d as _sfc_main};
