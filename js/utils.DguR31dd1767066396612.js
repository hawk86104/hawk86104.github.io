import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{r as t}from"./@fesjs.BK66sTPr1767066396612.js";import{i as r}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.DS9PWjZT1767066396612.js";import"./index.vue_vue_type_script_setup_true_lang.iYOGhvYh1767066396612.js";import{W as o}from"./three.BD1hRFgo1767066396612.js";import{c as s,d as a,a as i}from"./three-mesh-bvh.BBErpT9w1767066396612.js";const{BufferAttribute:n,Box3:p,Vector3:u,RepeatWrapping:l,Color:c,Mesh:m,PlaneGeometry:g,Vector2:h,DoubleSide:f,Material:d,MeshBasicMaterial:y,BufferGeometry:_,Matrix4:w}=await e("three"),x=(e,t=!1)=>{e.computeBoundingBox();const{max:r,min:o}=e.boundingBox;e.deleteAttribute("uv");const s=r.x-o.x,a=r.y-o.y,i=[];for(let n=0;n<e.attributes.position.count;n++)t?(i.push((e.attributes.position.getX(n)-(o.x+r.x)/2)/s),i.push((e.attributes.position.getY(n)-(o.y+r.y)/2)/a)):(i.push((e.attributes.position.getX(n)-o.x)/s),i.push((e.attributes.position.getY(n)-o.y)/a));const p=new Float32Array(i);e.setAttribute("uv",new n(p,2))},b=(e,r)=>new Promise((o,s)=>{t(e,{},{method:"get",mergeRequest:!0,responseType:"json"}).then(e=>{r&&o(e[r]),o(e.features)}).catch(e=>{console.error(e),s(e)})}),j=e=>{const t=(new THREE.Box3).setFromObject(e),r=new THREE.Vector3;t.getCenter(r),e.children.forEach(e=>{e.position.sub(r)}),e.position.copy(r.negate())},v=()=>{_.prototype.computeBoundsTree=s,_.prototype.disposeBoundsTree=a,m.prototype.raycast=i},B=async e=>{const t=await r(["./plugins/water/images/Water_1_M_Normal.jpg","./plugins/water/images/Water_2_M_Normal.jpg"]),s=e.geometry.clone();x(s),s.computeBoundsTree();const a=new o(s,{color:new c("#fff"),scale:20,flowDirection:new h(1,1),textureWidth:1024,textureHeight:1024,normalMap0:t[0],normalMap1:t[1]});return a.material.transparent=!0,a.material.depthWrite=!0,a.material.depthTest=!0,a.material.side=f,a.material.uniforms.config.value.w=20,a.material.uniforms.reflectivity.value=.46,a};function M(e){const t=[];for(let o=0;o<e.length;o++)t.push(new h(e[o].x,e[o].y));const r=new h;for(let o=0;o<t.length;o++)r.add(t[o]);r.divideScalar(t.length);for(let o=0;o<t.length;o++)t[o].sub(r);return{points:t,centerPoint:r}}export{j as a,M as g,v as i,b as l,x as r,B as s};
