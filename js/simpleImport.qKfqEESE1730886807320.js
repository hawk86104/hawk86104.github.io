var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;import{_ as r,bU as o,ak as s,am as i}from"./three._P_a_E_Z1730886807320.js";import{m as c,e as a,U as u,c as l}from"./@tresjs.iUmyNPdW1730886807320.js";import{g as p,i as f,e as d}from"./utils.SkgLEMCg1730886807320.js";import{_ as m}from"./jszip._dv5DHfD1730886807320.js";import{F as h}from"./file-saver.uyefbjWC1730886807320.js";import{P as g}from"./tweakpane.yHWGBmom1730886807320.js";import{d as v,q as y,r as w,X as b,a3 as j,o as E,D as I,j as O,g as S,J as x,u as P,aj as R,ak as _,f as k,al as L,m as T,F as z}from"./@vue.-THQH3GC1730886807320.js";import{v as C}from"./@fesjs.rCnyFuNL1730886807320.js";import"./@vueuse.Uoe2bW0Q1730886807320.js";import"./@amap.T-fZ7qS81730886807320.js";import"./vue-router.QnjVwwup1730886807320.js";import"./lodash-es.kYt-_xTG1730886807320.js";import"./@qlin.yHhFDldE1730886807320.js";import"./pinia.ZAQpp9No1730886807320.js";import"./vue-demi.C4xddsk91730886807320.js";import"./@floating-ui.BPbuo5Gx1730886807320.js";import"./@juggle.7yjBMqoW1730886807320.js";const J=$;!function(t,n){const e=$,r=U();for(;;)try{if(189030===-parseInt(e(258))/1*(parseInt(e(240))/2)+parseInt(e(292))/3+parseInt(e(286))/4*(parseInt(e(264))/5)+parseInt(e(287))/6*(parseInt(e(251))/7)+-parseInt(e(268))/8*(parseInt(e(252))/9)+parseInt(e(243))/10*(parseInt(e(253))/11)+-parseInt(e(265))/12)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const N=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[$(283)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){N(this,(function(){const t=$,n=new RegExp(t(269)),e=new RegExp(t(295),"i"),r=K(t(285));n[t(276)](r+t(275))&&e[t(276)](r+t(239))?K():r("0")}))()}();const F=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[$(283)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function A(t,n){for(let e=0,r=t[J(273)];e<r;e++)t[e](n)}F(void 0,(function(){const t=$,n=function(){const t=$;let n;try{n=Function(t(242)+t(248)+");")()}catch(e){n=window}return n}(),e=n.console=n[t(260)]||{},r=[t(256),t(267),t(291),t(272),"exception",t(284),t(290)];for(let o=0;o<r[t(273)];o++){const n=F[t(279)].prototype[t(250)](F),s=r[o],i=e[s]||n;n.__proto__=F[t(250)](F),n.toString=i[t(247)].bind(i),e[s]=n}}))(),window[J(294)]=r;const G={init:[],start:[],stop:[],keydown:[],keyup:[],pointerdown:[],pointerup:[],pointermove:[],update:[]},M=()=>{};function H(t){A(G[J(262)],t)}function W(t){A(G[J(244)],t)}function B(t){A(G[J(274)],t)}function D(t){A(G.pointerup,t)}function U(){const t=["THREE","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","input","2sGfhyv","replace","return (function() ","220KwghjO","keyup","\nreturn ","width","toString",'{}.constructor("return this")( )',"pointerup","bind","81578xsEhNm","9XYqmjF","79651VhGlxO","while (true) {}","update","log","addEventListener","32293aYSeSd","counter","console","pointermove","keydown","removeEventListener","1410210lahwmk","2610144GItfcF","start","warn","2991152bRoOuB","function *\\( *\\)","stringify","APP.Player: Script without object.","error","length","pointerdown","chain","test","action","getObjectByProperty","constructor","object","uuid","call","apply","table","init","4rWNFCs","48NBfMJt","push","string","trace","info","834459Oigxgu","gger"];return(U=function(){return t})()}function Z(t){A(G[J(261)],t)}function $(t,n){const e=U();return($=function(t,n){return e[t-=239]})(t,n)}function K(t){function n(t){const e=$;if(typeof t===e(289))return function(t){}.constructor(e(254))[e(283)](e(259));1!==(""+t/t)[e(273)]||t%20==0?function(){return!0}[e(279)]("debu"+e(293))[e(282)](e(277)):function(){return!1}[e(279)]("debu"+e(293))[e(283)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}function q(){const t=["toString","66jqIYQD","info","776783infRqR","4335159dskQfm","600Agxqio","chain","while (true) {}","136944tPdWpE","return (function() ","console","prototype","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","init","const scriptsJson = \n","3816490ldcMPP","\n\t\tthis.events = {\n\t\t\t\tinit: [],\n\t\t\t\tstart: [],\n\t\t\t\tstop: [],\n\t\t\t\tkeydown: [],\n\t\t\t\tkeyup: [],\n\t\t\t\tpointerdown: [],\n\t\t\t\tpointerup: [],\n\t\t\t\tpointermove: [],\n\t\t\t\tupdate: [],\n\t\t}\n\t\tlet scriptWrapParams = 'player,renderer,scene,camera'\n\t\tconst scriptWrapResultObj = {}\n\n\t\tfor (const eventKey in this.events) {\n\t\t\t\tscriptWrapParams += `,${eventKey}`\n\t\t\t\tscriptWrapResultObj[eventKey] = eventKey\n\t\t}\n\t\tconst scriptWrapResult = JSON.stringify(scriptWrapResultObj).replace(/\\\"/g, '')\n\t\tfor (const uuid in scriptsJson) {\n\t\t\t\tlet curUuid = uuid\n\t\t\t\t//这里解决一个问题 目前并没有把 主场景scene直接替换而是通过group 加进入的，所以 如果事件是基于主场景scene 那么替换这个uuid为现在tres主场景的uuid\n\t\t\t\tif (uuid === sceneObject.uuid) {\n\t\t\t\t\t\tcurUuid = this.scene.uuid\n\t\t\t\t}\n\t\t\t\tconst object = this.scene.getObjectByProperty('uuid', curUuid, true)\n\t\t\t\tif (object === undefined) {\n\t\t\t\t\t\tconsole.warn('player: Script without object.', curUuid)\n\t\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst scripts = scriptsJson[uuid]\n\t\t\t\tfor (let i = 0; i < scripts.length; i++) {\n\t\t\t\t\t\tconst script = scripts[i]\n\t\t\t\t\t\t// eslint-disable-next-line no-new-func\n\t\t\t\t\t\tconst functions = new Function(scriptWrapParams, `${script.source}\nreturn ${scriptWrapResult};`).bind(object)(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.renderer,\n\t\t\t\t\t\t\t\tthis.scene,\n\t\t\t\t\t\t\t\tthis.camera,\n\t\t\t\t\t\t)\n\t\t\t\t\t\tfor (const name in functions) {\n\t\t\t\t\t\t\t\tif (functions[name] === undefined) continue\n\t\t\t\t\t\t\t\tif (this.events[name] === undefined) {\n\t\t\t\t\t\t\t\t\t\tconsole.warn('player: Event type not supported (', name, ')')\n\t\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.events[name].push(functions[name].bind(object))\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.dispatch(this.events.init, arguments)\n\t\t}\n\t},\n\tdispatch(array, event) {\n\t\tfor (let i = 0, l = array.length; i < l; i++) {\n\t\t\t\tarray[i](event)\n\t\t}\n\t},\n\tsetCamera(value) {\n\t\t\tconsole.warn('暂时不考虑摄像机的设置函数', value)\n\t\t\t// camera = value\n\t\t\t// camera.aspect = this.width / this.height\n\t\t\t// camera.updateProjectionMatrix()\n\t},\n\tsetScene(value) {\n\t\t\tconsole.warn('暂时不考虑场景的设置函数', value)\n\t\t\t// scene = value\n\t},\n\tsetPixelRatio(value) {\n\t\t\tconsole.warn('暂时不考虑像素比的设置函数', value)\n\t},\n\tsetSize(value) {\n\t\t\tconsole.warn('暂时不考虑尺寸的设置函数', value)\n\t},\n\tdispose() {\n\t\t\t// renderer.dispose();\n\t\t\t// camera = undefined;\n\t\t\t// scene = undefined;\n\t\t\tconsole.warn('暂时不考虑释放资源的函数')\n\t},\n\tonKeyDown(event) {\n\t\tplayer.dispatch(player.events.keydown, event)\n\t},\n\tonKeyUp(event) {\n\t\t\tplayer.dispatch(player.events.keyup, event)\n\t},\n\tonPointerDown(event) {\n\t\t\tplayer.dispatch(player.events.pointerdown, event)\n\t},\n\tonPointerUp(event) {\n\t\t\tplayer.dispatch(player.events.pointerup, event)\n\t},\n\tonPointerMove(event) {\n\t\t\tplayer.dispatch(player.events.pointermove, event)\n\t},\n\tplay() {\n\t\t\tdocument.addEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.addEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.addEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.addEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.addEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.start, null)\n\t\t\t//renderer.setAnimationLoop( animate ); 播放是自动的\n\t},\n\tstop() {\n\t\t\tdocument.removeEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.removeEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.removeEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.removeEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.removeEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.stop, arguments)\n\t\t\t// renderer.setAnimationLoop( null );播放是自动的\n\t},\n\trender(elapsed, delta) {\n\t\t\tthis.dispatch(this.events.update, { time: elapsed, delta })\n\t},\n}\nexport default player\n","20372fcoOmM","call","exception","/* eslint-disable prefer-rest-params */\n/* eslint-disable no-undefined */\n/* eslint-disable guard-for-in */\nimport * as THREE from 'three'\n\nwindow.THREE = THREE // Used by APP Scripts.\nconst Grscwh = { scene: null, renderer: null, camera: null, sizes: null }\nconst player = {\n\tget renderer() {\n\t\treturn Grscwh.renderer?.value\n\t},\n\tloader: new THREE.TextureLoader(),\n\tget scene() {\n\t\t\treturn Grscwh.scene?.value\n\t},\n\tget camera() {\n\t\t\treturn Grscwh.camera?.value\n\t},\n\tget width() {\n\t\t\treturn Grscwh.sizes?.width?.value\n\t},\n\tget height() {\n\t\t\treturn Grscwh.sizes?.height?.value\n\t},\n\tget dom() {\n\t\t\treturn Grscwh.renderer?.value.domElement.parentElement\n\t},\n\tget canvas() {\n\t\t\treturn Grscwh.renderer?.value.domElement\n\t},\n\tevents: {},\n\tinit(scene, renderer, camera, sizes) {\n\t\t\tGrscwh.scene = scene\n\t\t\tGrscwh.renderer = renderer\n\t\t\tGrscwh.camera = camera\n\t\t\tGrscwh.sizes = sizes\n\t},\n\tload(sceneObject) {\n\t\t","366838tBYWWB","apply","test","function *\\( *\\)","action","4AGnWsc","error","gger","stateObject","stringify","72iGguXk","counter","warn","10191890AeSzgx","constructor","debu","1DXxRJT"];return(q=function(){return t})()}!function(t,n){const e=X,r=q();for(;;)try{if(837100===parseInt(e(314))/1*(parseInt(e(298))/2)+-parseInt(e(319))/3*(-parseInt(e(303))/4)+-parseInt(e(292))/5+-parseInt(e(316))/6*(-parseInt(e(318))/7)+-parseInt(e(308))/8*(parseInt(e(323))/9)+-parseInt(e(311))/10+-parseInt(e(294))/11*(parseInt(e(320))/12))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const Q=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[X(299)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){Q(this,(function(){const t=X,n=new RegExp(t(301)),e=new RegExp(t(289),"i"),r=V(t(290));n[t(300)](r+t(321))&&e.test(r+"input")?V():r("0")}))()}();const Y=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[X(299)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function X(t,n){const e=q();return(X=function(t,n){return e[t-=286]})(t,n)}Y(void 0,(function(){const t=X;let n;try{n=Function(t(286)+'{}.constructor("return this")( ));')()}catch(o){n=window}const e=n[t(287)]=n[t(287)]||{},r=["log",t(310),t(317),t(304),t(296),"table","trace"];for(let s=0;s<r.length;s++){const n=Y[t(312)][t(288)].bind(Y),o=r[s],i=e[o]||n;n.__proto__=Y.bind(Y),n[t(315)]=i[t(315)].bind(i),e[o]=n}}))();function V(t){function n(t){const e=X;if("string"==typeof t)return function(t){}[e(312)](e(322))[e(299)](e(309));1!==(""+t/t).length||t%20==0?function(){return!0}[e(312)](e(313)+e(305))[e(295)](e(302)):function(){return!1}[e(312)](e(313)+"gger")[e(299)](e(306)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function tt(t,n){const e=rt();return(tt=function(t,n){return e[t-=477]})(t,n)}!function(t,n){const e=tt,r=rt();for(;;)try{if(387874===-parseInt(e(550))/1+parseInt(e(510))/2+parseInt(e(558))/3+-parseInt(e(581))/4*(-parseInt(e(551))/5)+-parseInt(e(539))/6+parseInt(e(479))/7+parseInt(e(493))/8*(-parseInt(e(540))/9))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const nt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[tt(505)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){nt(this,(function(){const t=tt,n=new RegExp(t(576)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=ut("init");n.test(r+t(516))&&e.test(r+t(518))?ut():r("0")}))()}();const et=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[tt(505)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function rt(){const t=['" />',"<template>\n    ",'" type="',"thirdLevel",'/${url}`\n            }\n            if (url.endsWith(".json")) {\n                image.url = await loadJsonFile(url)\n            } else {\n                image.url = await loadImageToBase64(url)\n            }\n        }\n    }\n}\n\nconst sceneObject = loader.parse(scene) as any\nonMounted(() => {\n    tresScene.value.background = sceneObject.background\n    tresScene.value.environment = sceneObject.environment\n    tresScene.value.fog = sceneObject.fog\n    player.load(sceneObject)\n    player.play()\n})\nconst { onLoop } = useRenderLoop()\nonLoop(({ delta, elapsed }) => {\n    if (player.renderer) {\n        player.render(elapsed * 1000, delta * 1000)\n    }\n})\n<\/script>',"gridHelper","280317qhReqQ","221035sgnHPW",'{}.constructor("return this")( )',",\n\ttoneMappingExposure:","images","THREE.NoToneMapping","gger",".json","2016435HxEUWs","secondLevel","\n\t\t","orbitControls",'].children" />',"\n\nconst { scene: tresScene, renderer, camera, sizes } = useTresContext()\nplayer.init(tresScene, renderer, camera, sizes)\n\nconst loader = new THREE.ObjectLoader()\nconst scene = await loadJsonFile('./plugins/",']" name="',"table","blob",'"/>\n        ',"pages/index.vue","while (true) {}","string","true","data","components/scene.vue","url","childLevel","function *\\( *\\)",'",\n\t\t"updateTime": "',"<template>\n        ","components/childComponent",'" uuid="',"52HckGek","bind","return (function() ","</template>\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue'\nimport * as THREE from 'three'\nimport { loadImageToBase64, loadJsonFile } from 'PLS/tresEditor'\nimport { useTresContext, useRenderLoop } from '@tresjs/core'\nimport player from '../common/eventScript'\n","name",".vue","then","firstLevel","THREE.PCFShadowMap","folder",'",\n\t\t"title": "编辑器导出的插件",\n\t\t"intro": "描述",\n\t\t"version": "0.0.1",\n\t\t"author": "作者名",\n\t\t"website": "站点地址",\n\t\t"state": "active",\n\t\t"creatTime": "',"stateObject","url:geometries/",",\n\ttoneMapping: ","parse","3874101IMbcqi","shadowType",'\n<template>\n    <loading />\n\t<TresCanvas v-bind="state">\n\t\t',"comName","length","exception","split","scripts","<Suspense>\n\t\t\t<sceneCom />\n\t\t</Suspense>",";base64,","/json/scene.json')\n\nif (scene.geometries) {\n    for (const geometry of scene.geometries) {\n        if (geometry.data && geometry.data.startsWith('url:')) {\n            let url = geometry.data.slice(4)\n            if (url.startsWith('geometries/')) {\n                url = `./plugins/","console","camera","pluginName","13413472klEDjM",'    \n    <primitive :object="sceneObject.children[',"debu","toneMappingExposure","geometries",'\n    <primitive :object="sceneObject.children[',"__proto__",".zip","url:images/","import ","project","push","apply","prototype","getMonth","public/plugins/",' :object="sceneObject.children[',"1505428TPgHiv","children","<Tres","toString","false",'\n</template>\n\n<script setup lang="ts">\nconst props = withDefaults(\n    defineProps<{\n        object: any\n    }>(),\n    {},\n)\n<\/script>\n',"chain","constructor","input","scene",'" name="',"warn","call","log","<TresGridHelper />","fileName","counter","uuid","BufferGeometry","\nconst loader = new THREE.ObjectLoader()\nconst cameraObject = loader.parse(cameraConfig)\nconst cameraRef = ref(null)\nwatch(\n\t() => cameraRef.value,\n\t(val) => {\n\t\t\tval.copy(cameraObject)\n\t},\n)\n<\/script>\n\t","file","object","error","type","forEach","action","trace","pop","padStart","1248708yhWgdt","9vrsCPg",'\n        <primitive :object="object[',"stringify",'  ref="cameraRef" uuid="'];return(rt=function(){return t})()}et(void 0,(function(){const t=tt;let n;try{n=Function(t(583)+t(552)+");")()}catch(o){n=window}const e=n[t(490)]=n[t(490)]||{},r=[t(523),t(521),"info",t(532),t(484),t(565),t(536)];for(let s=0;s<r.length;s++){const n=et.constructor[t(506)][t(582)](et),o=r[s],i=e[o]||n;n[t(499)]=et[t(582)](et),n[t(513)]=i[t(513)].bind(i),e[o]=n}}))();let ot=[];const st=(r,o,s,i)=>{const c=tt,a=s[c(531)],{uuid:u}=a,l=((r,o)=>{var s={};for(var i in r)n.call(r,i)&&o.indexOf(i)<0&&(s[i]=r[i]);if(null!=r&&t)for(var i of t(r))o.indexOf(i)<0&&e.call(r,i)&&(s[i]=r[i]);return s})(a,["uuid"]),p=JSON[c(478)](JSON[c(542)](s));return p[c(531)]=l,c(481)+(i[c(561)]?"<OrbitControls />":"")+c(560)+(s?c(512)+s.object[c(533)]+c(543)+s[c(531)][c(527)]+c(520)+s[c(531)][c(585)]+c(544):"")+"\n\t\t"+r+c(560)+(i[c(549)]?c(524):"")+"\n\t</TresCanvas>\n</template>\n<script setup lang=\"ts\">\nimport * as THREE from 'three'\nimport { reactive, watch, ref } from 'vue'\nimport { TresCanvas } from '@tresjs/core'\nimport { OrbitControls } from '@tresjs/cientos'\nimport sceneCom from '../components/scene.vue'\nimport { loading2 as loading } from 'PLS/UIdemo'\n\nconst state = reactive({\n\tclearColor: '#201919',\n\twindowSize:true,\n\tantialias: true,\n\tshadows: "+(o.shadows?c(571):c(514))+",\n\tshadowMapType: "+(o[c(480)]?o[c(480)]:c(589))+c(477)+(o.toneMapping?o.toneMapping:c(555))+c(553)+(o[c(496)]?o[c(496)]:"1")+",\n})\n\nconst cameraConfig = "+(p?""+JSON[c(542)](p):"{}")+c(529)},it=(t,n,e,r,o)=>{const s=tt;n.childLevel;let i=s(498)+r+s(564)+e[s(585)]+'" uuid="'+e[s(527)]+s(546)+e[s(533)]+'">\n    ';if(e[s(511)]&&e[s(511)][s(483)]){const n=((t,n)=>{const e=tt,r=t-1,o=[e(588),e(559),e(547)],s=n.split("-")[e(537)]();return{fileName:o[r]+"-"+s+e(586),comName:""+o[r]+s}})(o,e[s(527)]);i+="<"+n[s(482)]+s(509)+r+s(562),((t,n,e)=>{const r=tt;let o="";e.forEach(((t,n)=>{const e=tt;o+=e(541)+n+e(564)+t[e(585)]+e(580)+t.uuid+e(546)+t[e(533)]+e(567)}));const s=r(545)+o+r(515);t[r(530)](""+n.fileName,s),ot[r(504)](n)})(t,n,e[s(511)])}return i+="\n    </primitive>\n",i},ct=(t,n,e)=>{const r=tt;let o="";const s=t[r(590)](r(579));return e[r(531)]&&e[r(531)][r(511)]&&e[r(531)][r(511)].length&&e[r(531)][r(511)][r(534)](((t,e)=>{const i=r;n[i(575)]>0&&t.children&&t.children[i(483)]?o+=it(s,n,t,e,1):o+=i(494)+e+i(564)+t[i(585)]+i(580)+t.uuid+i(546)+t[i(533)]+'"/>\n    '})),t[r(530)](r(573),r(578)+o+r(584)+(()=>{const t=tt;let n="";return ot[t(534)]((e=>{const r=t;n+=r(502)+e[r(482)]+" from './childComponent/"+e[r(525)]+"'\n"})),n})()+r(563)+n[r(492)]+r(489)+n.pluginName+"/${url}`\n            }\n            geometry.data = await loadJsonFile(url)\n        }\n    }\n}\nif (scene.images) {\n    for (const image of scene.images) {\n        if (image.url && image.url.startsWith('url:')) {\n            let url = image.url.slice(4)\n            if (url.startsWith('images/')) {\n                url = `./plugins/"+n.pluginName+r(548)),r(487)};function at(t,n){const e=tt;ot=[];const r=n.pluginName,o=new m;((t,n)=>{const e=tt,r=[];n[e(497)]&&n[e(497)].forEach((t=>{const n=e;t[n(533)]===n(528)&&(r[n(504)]({uuid:t[n(527)],data:t[n(572)]}),t[n(572)]=n(593)+t[n(527)]+n(557))}));const o=[];if(n[e(554)]&&n[e(554)][e(534)]((t=>{const n=e;t.url&&(o[n(504)]({uuid:t[n(527)],url:t[n(574)]}),t[n(574)][n(533)]?t.url=n(501)+t[n(527)]+"."+t[n(574)][n(533)]+".json":t.url="url:images/"+t[n(527)]+"."+p(t.url))})),r[e(483)]){const n=t[e(590)](e(497));r[e(534)]((t=>{const r=e;n[r(530)](t[r(527)]+r(557),JSON.stringify(t[r(572)]))}))}if(o[e(483)]){const n=t[e(590)](e(554));o[e(534)]((t=>{const r=e;t.url[r(533)]?n[r(530)](t[r(527)]+"."+t[r(574)][r(533)]+r(557),JSON[r(542)](t[r(574)])):n[r(530)](t.uuid+"."+p(t[r(574)]),t[r(574)][r(485)](r(488))[r(537)](),{base64:!0})}))}t[e(530)]("json/scene.json",JSON.stringify(n))})(o[e(590)](e(508)+r),t.scene);const s=o[e(590)]("src/plugins/"+r);s[e(530)]("config.js",(t=>{const n=tt,e=new Date,r=e.getFullYear()+"-"+String(e[n(507)]()+1)[n(538)](2,"0")+"-"+String(e.getDate())[n(538)](2,"0");return'\n\texport default {\n\t\t"name": "'+t+n(591)+r+n(577)+r+'",\n\t\t"require": [],\n        "tvtstore": \'LOCAL\',\n\t\t"preview": [\n\t\t\t{ "src": "plugins/basic/base/preview/theBasic.png", "type": "img", "name": "index", "title": "实例" ,"disableFPSGraph": false, "disableSrcBtn": false},\n\t\t]\n\t}'})(r));const i=st(ct(s,n,t[e(519)]),t[e(503)],t[e(491)],n);return s.file(e(568),i),s[e(530)]("common/eventScript.js",(t=>{const n=X,e=n(291)+JSON[n(307)](t)+"\n";return n(297)+e+n(293)})(t[e(486)])),o.generateAsync({type:e(566)})[e(587)]((t=>{const n=e;h.saveAs(t,r+n(500))}))}function ut(t){function n(t){const e=tt;if(typeof t===e(570))return function(t){}[e(517)](e(569))[e(505)](e(526));1!==(""+t/t)[e(483)]||t%20==0?function(){return!0}[e(517)](e(495)+e(556))[e(522)](e(535)):function(){return!1}[e(517)](e(495)+"gger")[e(505)](e(592)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=ft,r=dt();for(;;)try{if(275362===parseInt(e(490))/1*(parseInt(e(485))/2)+parseInt(e(484))/3+-parseInt(e(480))/4+parseInt(e(474))/5*(parseInt(e(531))/6)+-parseInt(e(511))/7*(parseInt(e(483))/8)+parseInt(e(479))/9*(-parseInt(e(486))/10)+parseInt(e(510))/11)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const lt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){lt(this,(function(){const t=ft,n=new RegExp(t(522)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=ht(t(470));n[t(459)](r+"chain")&&e.test(r+"input")?ht():r("0")}))()}();const pt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[ft(512)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function ft(t,n){const e=dt();return(ft=function(t,n){return e[t-=449]})(t,n)}function dt(){const t=["call","1164390LVyjRx","table","reload","while (true) {}","分解场景[中间件 测试用]","environment","Zip2Json","log","gridHelper","info","click","test","gger","addButton","ObjectLoader","toString","导入原生场景Json","files","filter",".zip","请正确填写插件名称","stateObject","init","accept",'{}.constructor("return this")( )',"value","5OTiNxZ","warn","bind","warning","确定要执行操作吗？","8784RipCem","672644nRJXFs","场景内无物体","Group","148168iwDJrY","102798udiEQc","31984qzTbQF","4510jzcHLZ","pluginName","console","target","1qDQUPU","生成分解场景Zip","location",".json","add","constructor","children","exception","onload","result","onchange","默认网格","return (function() ","forEach","length","background","readAsText","material","Json2Zip","srcJson","7440598zygTkr","14LilxFO","apply","dispose","fileInput","scene","fog","geometry","MakePlugin","debu","addBinding","先清空场景","function *\\( *\\)","addFolder","parse","清空场景","trace","默认控制器","error","clear"];return(dt=function(){return t})()}pt(void 0,(function(){const t=ft;let n;try{n=Function(t(502)+t(472)+");")()}catch(o){n=window}const e=n.console=n[t(488)]||{},r=[t(455),t(475),t(457),t(528),t(497),t(449),t(526)];for(let s=0;s<r.length;s++){const n=pt[t(495)].prototype[t(476)](pt),o=r[s],i=e[o]||n;n.__proto__=pt.bind(pt),n[t(463)]=i[t(463)].bind(i),e[o]=n}}))();const mt=v({__name:"importJson",setup(t){const n=ft;let e,o=null;var s=new(r[n(462)]);let i=null;const{scene:u,renderer:l,camera:p,sizes:m}=c(),h=()=>{if(!i)return;const t=n=>{const e=ft;let r=n[e(496)][e(466)]((t=>!!t));r[e(503)]((n=>{const r=e;n[r(496)][r(504)]?t(n):((t=>{var n,e;const r=ft;null==(n=t[r(517)])||n[r(513)](),null==(e=t[r(507)])||e[r(513)]()})(n),n[r(529)]())})),n[e(529)](),r=null};t(i),i=null},v=t=>{const e=n;h(),(()=>{const t=J;document[t(263)](t(262),H),document[t(263)](t(244),W),document[t(263)](t(274),B),document[t(263)]("pointerup",D),document.removeEventListener("pointermove",Z),A(G.stop,null),G[t(285)]=[],G[t(266)]=[],G.stop=[],G[t(262)]=[],G[t(244)]=[],G[t(274)]=[],G[t(249)]=[],G[t(261)]=[],G[t(255)]=[]})(),i=new(r[e(482)]),t[e(496)]&&(i[e(496)]=t[e(496)],u.value[e(494)](i),u[e(473)][e(505)]=t[e(505)],u[e(473)][e(453)]=t[e(453)],u[e(473)][e(516)]=t[e(516)])},w=new g;w.addButton({title:n(525),label:n(529)}).on(n(458),(()=>{const t=n;confirm(t(478))&&window[t(492)][t(450)]()}));w[n(461)]({title:n(464),label:n(509)}).on(n(458),(()=>{var t,r;const s=n;o?null==(r=(t=C)[s(477)])||r.call(t,{content:"先清空场景",colorful:!0}):e&&(e.accept=s(493),e[s(473)]=null,e[s(458)]())}));const b=w[n(523)]({title:n(452),expanded:!1});b[n(461)]({title:n(491),label:n(508)}).on(n(458),(()=>{var t,e;const r=n;o?d(o):null==(e=(t=C)[r(477)])||e.call(t,{content:r(481),colorful:!0})}));b.addButton({title:"导入分解场景Zip",label:n(454)}).on(n(458),(()=>{var t,r;const s=n;o?null==(r=(t=C)[s(477)])||r.call(t,{content:s(521),colorful:!0}):e&&(e[s(471)]=s(467),e.value=null,e[s(458)]())}));const j={orbitControls:!0,gridHelper:!0,pluginName:"testEditor",childLevel:1},E=w[n(523)]({title:"TvT插件包"});E[n(520)](j,"pluginName",{label:"插件名称"}),E.addBinding(j,"orbitControls",{label:n(527)}),E[n(520)](j,n(456),{label:n(501)});E[n(461)]({title:"生成插件包",label:n(518)}).on("click",(()=>{var t,e,r,s;const i=n;o?j[i(487)]?at(o,j):null==(e=(t=C)[i(477)])||e.call(t,{content:i(468),colorful:!0}):null==(s=(r=C)[i(477)])||s.call(r,{content:"场景内无物体",colorful:!0})}));const I=t=>{const e=n;o=t,v(s[e(524)](o[e(515)])),((t,n,e,r,o)=>{const s=J,i=o.scripts||{};let c="player,renderer,scene,camera";const a={};for(const l in G)c+=","+l,a[l]=l;const u=JSON[s(270)](a)[s(241)](/\"/g,"");for(const l in i){let a=l;l===o.scene[s(280)][s(281)]&&(a=n[s(281)]);const p=n[s(278)]("uuid",a,!0);if(void 0===p){console[s(267)](s(271),a);continue}const f=i[l];for(let o=0;o<f[s(273)];o++){const i=f[o],a=new Function(c,i.source+s(245)+u+";")[s(250)](p)({width:r[s(246)].value,height:r.height.value,setCamera:M},t,n,e);for(const t in a)void 0!==a[t]&&(void 0!==G[t]?G[t][s(288)](a[t][s(250)](p)):console.warn("APP.Player: Event type not supported (",t,")"))}}A(G.init,null)})(l.value,u[e(473)],p[e(473)],m,o),(()=>{const t=J;document[t(257)](t(262),H),document[t(257)]("keyup",W),document.addEventListener("pointerdown",B),document[t(257)](t(249),D),document[t(257)](t(261),Z),A(G[t(266)],null)})()};y((()=>{const t=n;e=document.getElementById(t(514)),e&&(e[t(500)]=n=>{const r=t,o=n[r(489)][r(465)][0];if(e.accept===r(493)){const t=new FileReader;t[r(498)]=t=>{const n=r,e=t[n(489)][n(499)];I(JSON.parse(e))},t[r(506)](o)}e[r(471)]===r(467)&&f(o,I)})}));const{onLoop:O}=a();return O((({delta:t,elapsed:n})=>{var e,r;e=1e3*n,r=1e3*t,A(G[J(255)],{time:e,delta:r})})),(t,n)=>null}});function ht(t){function n(t){const e=ft;if("string"==typeof t)return function(t){}[e(495)](e(451))[e(512)]("counter");1!==(""+t/t)[e(504)]||t%20==0?function(){return!0}[e(495)](e(519)+"gger")[e(530)]("action"):function(){return!1}[e(495)](e(519)+e(460))[e(512)](e(469)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=yt,r=jt();for(;;)try{if(737380===-parseInt(e(504))/1*(parseInt(e(502))/2)+parseInt(e(522))/3*(-parseInt(e(524))/4)+-parseInt(e(533))/5+-parseInt(e(528))/6*(-parseInt(e(535))/7)+parseInt(e(519))/8*(parseInt(e(513))/9)+-parseInt(e(509))/10+parseInt(e(540))/11*(parseInt(e(537))/12))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const gt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[yt(501)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){gt(this,(function(){const t=yt,n=new RegExp(t(523)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=bt(t(500));n[t(514)](r+"chain")&&e[t(514)](r+t(539))?bt():r("0")}))()}();const vt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[yt(501)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function yt(t,n){const e=jt();return(yt=function(t,n){return e[t-=500]})(t,n)}vt(void 0,(function(){const t=yt;let n;try{n=Function(t(526)+t(510)+");")()}catch(o){n=window}const e=n[t(506)]=n[t(506)]||{},r=["log",t(508),"info",t(511),t(529),"table",t(543)];for(let s=0;s<r[t(518)];s++){const n=vt[t(521)][t(536)][t(525)](vt),o=r[s],i=e[o]||n;n[t(544)]=vt[t(525)](vt),n[t(527)]=i[t(527)][t(525)](i),e[o]=n}}))();const wt=v({__name:"simpleImport",setup(t){const n=yt,e=w({clearColor:n(542),shadows:!0,alpha:!1,shadowMapType:o,outputColorSpace:s,toneMapping:i}),r=w({enableDamping:!0,dampingFactor:.05}),c=b(null);return j((()=>{c[n(512)]})),(t,o)=>{const s=n;return E(),I(z,null,[O(P(l),T(e,{"window-size":""}),{default:S((()=>[o[0]||(o[0]=x(s(531),{position:[15,15,15],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),O(P(u),R(_(r)),null,16),(E(),k(L,null,{default:S((()=>[O(mt)])),_:1})),o[1]||(o[1]=x(s(538),null,null,-1))])),_:1},16),o[2]||(o[2]=x(s(539),{id:s(505),type:s(516),accept:s(515),style:{display:s(520)}},null,-1))],64)}}});function bt(t){function n(t){const e=yt;if("string"==typeof t)return function(t){}.constructor(e(507)).apply(e(503));1!==(""+t/t)[e(518)]||t%20==0?function(){return!0}[e(521)]("debu"+e(530))[e(532)](e(517)):function(){return!1}[e(521)](e(534)+e(530)).apply(e(541)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function jt(){const t=["1008ARlKaF","test",".zip","file","action","length","1232BKJGAi","none","constructor","6909CCCtQy","function *\\( *\\)","1348dNsgso","bind","return (function() ","toString","354pBloMJ","exception","gger","TresPerspectiveCamera","call","2625630uXqnHW","debu","139636DVlYOm","prototype","119796kzkSDJ","TresGridHelper","input","2761hGiDFh","stateObject","#201919","trace","__proto__","init","apply","2EmKnAN","counter","349913MSrbEk","fileInput","console","while (true) {}","warn","13113830CVbyPg",'{}.constructor("return this")( )',"error","value"];return(jt=function(){return t})()}export{wt as default};
