import{P as e}from"./tweakpane.CqZAnw7f1766395561759.js";import{F as a,N as s,J as o,_ as r,K as t}from"./@tresjs.BAA1xUmy1766395561759.js";import"./OimoPhysicsBuffer.CeBBkx9n1766395561759.js";import{_ as n}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.CLUrC8uK1766395561759.js";import"./shapeConfigurator.vue_vue_type_style_index_1_scoped_abbf0cc1_lang.BYqEDbJP1766395561759.js";import"./Resource.BvxQFOEE1766395561759.js";import"./three-custom-shader-material.CeYMC0bX1766395561759.js";import"./PackedMipMapGenerator.BosiWbnG1766395561759.js";import{o as i,k as l,cX as c,cV as u,cW as m,d as p,dr as d,dx as v,dy as f}from"./three.F31Lz30M1766395561759.js";import{d as j,c as h,w as _,q as g,G as b,H as w,o as y,I as P,u as M,r as x,g as D,b as k,e as U,h as q,ah as C,a9 as G,aa as S}from"./@vue.BxPWGdWw1766395561759.js";import"./three.quarks.Doo07ASV1766395561759.js";import"./postprocessing.DuhH-bFK1766395561759.js";import"./@vueuse.KwrREqpH1766395561759.js";import"./oimophysics.CfVKSiAm1766395561759.js";import"./dither.glsl.tNAdkJUa1766395561759.js";import"./Reflector.D55OIsUs1766395561759.js";import"./vite-plugin-qiankun.B06WoCqG1766395561759.js";import"./utils.CNife3_q1766395561759.js";import"./object-hash.Dv6AILmT1766395561759.js";import"./@amap.fjyZdsU91766395561759.js";import"./jszip.Zzi2WZWj1766395561759.js";import"./three-stdlib.CkaNLsGO1766395561759.js";import"./quarks.core.C3xH0YPO1766395561759.js";const T={key:0},F=["object"],z=["object"],B=["object"],I=j({__name:"mechaFloor",props:{color:{default:"#ffed00"}},setup(e){const{renderer:t,scene:n,camera:j,sizes:x}=a(),D=e;let k=null;const U={uniforms:{tDiffuse:{value:null},contrast:{value:1.8}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",fragmentShader:"\n        uniform sampler2D tDiffuse;\n        uniform float contrast;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb = (color.rgb - 0.5) * contrast + 0.8;\n            gl_FragColor = color;\n        }\n    "},{state:q}=s("https://opensource.cdn.icegl.cn/model/floor/baseModelJ.glb",{draco:!0,decoderPath:"./draco/"}),C=h(()=>q?.value?.scene),{state:G}=s("plugins/floor/models/topoBase/baseModelL.glb",{draco:!0,decoderPath:"./draco/"}),{state:S}=s("https://opensource.cdn.icegl.cn/model/floor/baseModelK.glb",{draco:!0,decoderPath:"./draco/"}),I=h(()=>S.value?.animations||[]),R=h(()=>S?.value?.scene),{actions:V}=o(I,R);_(V,e=>{e.Scene&&e.Scene.play()}),_(C,e=>{e&&e.traverse(e=>{e instanceof i&&(e.material.emissive=new l("#ffed00"),e.material.emissiveIntensity=20.5,e.material.toneMapped=!0,e.material.needsUpdate=!0)})});const{onRender:H}=r();return H(()=>{k&&k.render()}),g(()=>{(()=>{const e=new v(t),a=new f,s=e.fromScene(a).texture;n.value.environment=s,C.value&&C.value.traverse(e=>{e instanceof i&&e.material&&(e.material.envMap=s,e.material.needsUpdate=!0)}),a.dispose()})(),setTimeout(()=>{(()=>{if(!t||!j.value||!x.width.value)return;k=new c(t);const e=new u(n.value,j.value);k.addPass(e);const a=new m(new p(x.width.value,x.height.value),.1,.1,.1);k.addPass(a);const s=new d(U);s.uniforms.contrast.value=1.1,k.addPass(s)})()},200)}),_(()=>[D.color],([e])=>{C.value&&C.value.traverse(a=>{a instanceof i&&a.material&&(a.material.emissive=new l(e))})}),(e,a)=>C.value&&R.value?(y(),b("TresGroup",T,[P("primitive",{object:C.value,"position-y":.01},null,8,F),M(G)?(y(),b("primitive",{key:0,object:M(G)?.scene,"position-y":.1},null,8,z)):w("",!0),P("primitive",{object:R.value,"position-y":.1},null,8,B)])):w("",!0)}}),R=j({__name:"mechaFloor",setup(a){const s=x({color:"#ffed00"}),o=new e({expanded:!0}),r={reflectivity:1,showGridHelper:!1,scale:2,renderMode:"manual"};return o.addBinding(s,"color",{label:"颜色"}),(e,a)=>{const o=D("TresCanvas");return y(),k(o,{clearColor:"#000000","window-size":""},{default:U(()=>[a[0]||(a[0]=P("TresPerspectiveCamera",{position:[3,5,0],fov:45,near:.1,far:1e4},null,-1)),q(M(t),{enableDamping:""}),(y(),k(C,null,{default:U(()=>[q(M(I),G(S(s)),null,16)]),_:1})),q(n,G(S(r)),null,16)]),_:1})}}});export{R as default};
