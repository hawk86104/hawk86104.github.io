import{P as t}from"./tweakpane.yHWGBmom1734746792122.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.0q7P_q931734746792122.js";import{e}from"./@tresjs.vA_UT8oy1734746792122.js";import{z as r}from"./three-custom-shader-material.uwcZNtd-1734746792122.js";import{_ as i,a0 as u,C as c,cl as a,m as s,a$ as l}from"./three.1FILWcBb1734746792122.js";import{d as f,a3 as p,w as d,o as m,D as v,u as g,a6 as h,r as y,f as C,g as w,j as _,m as b}from"./@vue.-THQH3GC1734746792122.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1734746792122.js";import"./@vueuse.lqJslAkC1734746792122.js";const x=j;!function(t,n){const o=j,e=S();for(;;)try{if(412374===-parseInt(o(250))/1*(-parseInt(o(227))/2)+parseInt(o(261))/3+-parseInt(o(205))/4*(parseInt(o(210))/5)+-parseInt(o(232))/6*(parseInt(o(209))/7)+parseInt(o(255))/8*(parseInt(o(203))/9)+-parseInt(o(256))/10+parseInt(o(224))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=j,n=new RegExp(t(241)),o=new RegExp(t(253),"i"),e=O("init");n[t(262)](e+t(230))&&o.test(e+t(206))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[j(202)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=j,n=function(){const t=j;let n;try{n=Function(t(221)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(218)]=n.console||{},e=[t(223),t(211),t(248),"error",t(219),t(207),t(204)];for(let r=0;r<e[t(245)];r++){const n=M[t(217)][t(258)][t(254)](M),i=e[r],u=o[i]||n;n.__proto__=M[t(254)](M),n.toString=u.toString[t(254)](u),o[i]=n}}))();const T=["object"];function j(t,n){const o=S();return(j=function(t,n){return o[t-=199]})(t,n)}function S(){const t=["function *\\( *\\)","model","uniforms","clone","length","setStyle","#ffffff","info","city","72754QsAfVC","computeBoundingSphere","topColor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bind","88NKJNqC","5385690bjaPUK","value","prototype","counter","uColor","1784325biPQjX","test","action","children","forEach","stateObject","__csm","apply","218385XzvCyH","trace","412hxvPiO","input","table","Color","32277KaDHZF","38575dXmpWT","warn","opacity","land","landColor","gger","material","constructor","console","exception","uGradient","return (function() ","debu","log","1426854OTvxNh","bulidingsColor","dispose","22HMWCLi","gradient","call","chain","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","60qZmYeF","renderOrder","#ffff00","#112233","primitive","MeshBasicMaterial","isArray","color","DoubleSide"];return(S=function(){return t})()}const P=f({__name:"bModel",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:x(235)},topColor:{default:x(234)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,a=o.model[n(249)];o[n(242)][n(242)][n(264)][0][n(216)]=new(i[n(237)])({color:n(234)}),a[n(233)]=1001;const s=o[n(242)].land;(()=>{const t=n,{geometry:e}=a;e.computeBoundingBox(),e[t(251)]();const{max:u,min:s}=e.boundingBox;if(a[t(216)][t(201)])return;const l=new r({baseMaterial:a[t(216)],vertexShader:t(231),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:u},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(o[t(225)])},uOpacity:{value:o[t(212)]},uLightColor:{value:new c(t(247))},uTopColor:{value:new(i[t(208)])(o[t(252)])},uTime:{value:0},uGradient:{value:o[t(228)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(240)]});a.material[t(226)](),a[t(216)]=l})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a.material[o(243)].uTime[o(257)]+=t})),p((()=>{const t=n;o[t(225)]&&a[t(216)][t(243)][t(260)].value[t(246)](o[t(225)]),o[t(214)]&&((t,e)=>{const r=n;let i;"cu"===t||t===r(213)&&(i=Array[r(238)](s[r(216)])?s.material:[s[r(216)]],i[r(199)]((t=>{const n=r;t[e][n(246)](o.landColor),t.side=u})))})(t(213),t(239)),o[t(212)]&&(a[t(216)][t(243)].uOpacity[t(257)]=o.opacity)})),d(o,((t,o)=>{const e=n;a[e(216)][e(243)][e(220)][e(257)]=t[e(228)]}));const f=o[n(242)][n(242)][n(244)]();return(t,o)=>{const e=n;return m(),v(e(236),{object:g(f)},null,8,T)}}});function O(t){function n(t){const o=j;if("string"==typeof t)return function(t){}[o(217)]("while (true) {}")[o(202)](o(259));1!==(""+t/t)[o(245)]||t%20==0?function(){return!0}.constructor(o(222)+o(215))[o(229)](o(263)):function(){return!1}.constructor(o(222)+o(215))[o(202)](o(200)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function F(){const t=["value","object","35KQjqHw","counter","1900620mANtIT","12286400UNdBnU","45348LNBrar","uSrcColor","gradual","info","debu","init","function *\\( *\\)","uTime","19YTuGCH","length","geometry","srcColor","renderOrder","bLine","toString","test","scale","constructor","builds","456528xyvjqb","error","gger","#000","console","width","matrix","401884qJtePv","action","chain","call","table","clone","uniforms","bind","16GdHTzT","input","log","973932UFPcQO","string","apply","exception","1940883qkzWDj","speed","prototype","color",'{}.constructor("return this")( )'];return(F=function(){return t})()}const B=G;!function(t,n){const o=G,e=F();for(;;)try{if(344300===-parseInt(o(511))/1*(parseInt(o(503))/2)+parseInt(o(488))/3+-parseInt(o(529))/4+-parseInt(o(499))/5*(parseInt(o(522))/6)+parseInt(o(492))/7+parseInt(o(485))/8*(-parseInt(o(501))/9)+parseInt(o(502))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(490)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=G,n=new RegExp(t(509)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=H(t(508));n[t(518)](e+t(531))&&o.test(e+t(486))?H():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(490)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(t,n){const o=F();return(G=function(t,n){return o[t-=480]})(t,n)}z(void 0,(function(){const t=G,n=function(){const t=G;let n;try{n=Function("return (function() "+t(496)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(526)]||{},e=[t(487),"warn",t(506),t(523),t(491),t(481),"trace"];for(let r=0;r<e[t(512)];r++){const n=z[t(520)][t(494)][t(484)](z),i=e[r],u=o[i]||n;n.__proto__=z[t(484)](z),n[t(517)]=u[t(517)].bind(u),o[i]=n}}))();const E=[B(498)],Z=f({__name:B(516),props:{builds:{},color:{default:"#FFF"},srcColor:{default:B(525)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o[n(495)])},uSrcColor:{value:new c(o.srcColor)},uScale:{value:o[n(519)]},uTime:{value:0},uGradual:{value:o[n(505)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o[n(521)][n(513)])[n(482)]();u=u.applyMatrix4(o[n(521)][n(528)]);const f=new s(i);r=new l(u,f),r.material.linewidth=o[n(527)],r[n(515)]=1e3,p((()=>{const t=n;o.color&&(i[t(483)].uColor[t(497)]=new c(o[t(495)])),o[t(514)]&&(i[t(483)][t(504)].value=new c(o.srcColor)),o.scale&&(i[t(483)].uScale[t(497)]=o[t(519)]),o.gradual&&(i.uniforms.uGradual[t(497)]=o.gradual)}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i.uniforms[e(510)][e(497)]+=t*o[e(493)],i[e(483)][e(510)][e(497)]%=1})),(t,n)=>(m(),v("primitive",{object:g(r)},null,8,E))}});function H(t){function n(t){const o=G;if(typeof t===o(489))return function(t){}.constructor("while (true) {}").apply(o(500));1!==(""+t/t)[o(512)]||t%20==0?function(){return!0}[o(520)]("debu"+o(524))[o(480)](o(530)):function(){return!1}[o(520)](o(507)+"gger").apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=W;!function(t,n){const o=W,e=D();for(;;)try{if(953594===parseInt(o(199))/1+-parseInt(o(218))/2*(-parseInt(o(209))/3)+-parseInt(o(179))/4*(-parseInt(o(203))/5)+-parseInt(o(211))/6+-parseInt(o(180))/7+parseInt(o(205))/8+-parseInt(o(215))/9*(parseInt(o(183))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(212)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(){const t=["call","3xRhgAZ","init","2742408MhvxCY","apply","bind","线原颜色","16166043ywFisS","srcColor","toString","405470PIZKAY","info","扩散系数","buildingsEffectA","scale","debu","gradual","exception","table","效果参数","chain","gger","city","301268ckxmLM","2760345tCsMgR","stateObject","test","10VmIgbr","string","#FFF","length","#999","__proto__","#112233","log","trace","action","counter","return (function() ","function *\\( *\\)","constructor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","input","80529uBsBEP","#000","warn","model","115IYEGld","线扫颜色","12685352yhvCji","addBinding","console"];return(D=function(){return t})()}!function(){R(this,(function(){const t=W,n=new RegExp(t(195)),o=new RegExp(t(197),"i"),e=k(t(210));n[t(182)](e+t(176))&&o.test(e+t(198))?k():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(212)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function W(t,n){const o=D();return(W=function(t,n){return o[t-=167]})(t,n)}q(void 0,(function(){const t=W,n=function(){const t=W;let n;try{n=Function(t(194)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(207)]||{},e=[t(190),t(201),t(167),"error",t(173),t(174),t(191)];for(let r=0;r<e[t(186)];r++){const n=q[t(196)].prototype[t(213)](q),i=e[r],u=o[i]||n;n[t(188)]=q.bind(q),n[t(217)]=u[t(217)][t(213)](u),o[i]=n}}))();const $=f({__name:L(169),async setup(e){const r=L;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(185),srcColor:r(200),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(175),expanded:!0});return s[r(206)](a,r(216),{label:r(214)}),s[r(206)](a,"color",{label:r(204)}),s[r(206)](a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(206)](a,r(170),{label:"最大扩散",min:10,max:2e3,step:10}),s[r(206)](a,r(172),{label:r(168),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),C(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[_(P,{model:g(c),bulidingsColor:"#000000",landColor:e(189),topColor:e(187)},null,8,[e(202)]),_(Z,b({builds:g(c)[e(178)]},a),null,16,["builds"])])),_:1})}}});function k(t){function n(t){const o=W;if(typeof t===o(184))return function(t){}[o(196)]("while (true) {}")[o(212)](o(193));1!==(""+t/t)[o(186)]||t%20==0?function(){return!0}[o(196)](o(171)+o(177))[o(208)](o(192)):function(){return!1}[o(196)](o(171)+o(177)).apply(o(181)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
