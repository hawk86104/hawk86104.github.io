import{F as e,_ as s,K as t}from"./@tresjs.B_KjVy0E1761276103973.js";import{P as i}from"./tweakpane.CqZAnw7f1761276103973.js";import{A as o}from"./3d-tiles-renderer.CmKnR68Q1761276103973.js";import{a,b as r,i as l}from"./utils.DNSY7ZwV1761276103973.js";import{d as n,a as p,w as u,G as m,o as d,I as j,u as c,r as g,g as v,b as f,e as h,h as R,m as b}from"./@vue.CKlgtJke1761276103973.js";import{$ as w,a0 as T}from"./three.Bhn4-0ry1761276103973.js";import"./postprocessing.CeTFUAN_1761276103973.js";import"./@vueuse.wtfleElW1761276103973.js";import"./@tweenjs.C9YEcV0Y1761276103973.js";import"./utils.CI7v9zAv1761276103973.js";import"./@fesjs.DnM7nINA1761276103973.js";import"./vue-router.BFHj2xRz1761276103973.js";import"./lodash-es.DWe8oqPO1761276103973.js";import"./pinia.C8YT0eOZ1761276103973.js";import"./@qlin.y-0Z8WnK1761276103973.js";import"./@babel.BPq7uOAK1761276103973.js";import"./@floating-ui.Bhq4ibgf1761276103973.js";import"./@juggle.Vc7cP4_P1761276103973.js";import"./vanilla.esm.5.5.0.CRlEbOMK1761276103973.js";import"./object-hash.1qNYTrnD1761276103973.js";import"./@amap.fjyZdsU91761276103973.js";import"./jszip.y_yjJ09m1761276103973.js";import"./Resource.CSaxGSPI1761276103973.js";import"./useTexture.B3KXI5F11761276103973.js";import"./three-mesh-bvh.BX5J_Zhe1761276103973.js";import"./d3-geo.C51lZA-81761276103973.js";const x=["object"],U=n({__name:"obliquePhoto",props:{tilesUrl:{default:"./plugins/geokit/tiles/tileset.json"},isRotation:{type:Boolean,default:!1},isRranslation:{type:Boolean,default:!0}},setup(t,{expose:i}){const l=t,n=p(null),{camera:g,renderer:v,sizes:f}=e(),h=(e,s,t)=>{e.setCamera(s),e.setResolutionFromRenderer(s,t)},R=()=>{let e=new o(l.tilesUrl);return e.fetchOptions.mode="cors",e.addEventListener("load-tile-set",()=>{r(e,l.isRotation,l.isRranslation)}),e.addEventListener("dispose-model",({scene:e})=>{e.traverse(e=>{e.material&&e.material.dispose()})}),h(e,g.value,v),e};let b=R();u(()=>[l.isRotation,l.isRranslation],()=>{b.group&&a(b.group,l.isRotation,l.isRranslation)}),u(g,()=>{g.value&&h(b,g.value,v)},{immediate:!0});const{onBeforeRender:w}=s();return w(()=>{g.value&&f.width.value&&b.update&&(g.value.updateMatrixWorld(),b.update())}),u(()=>l.tilesUrl,e=>{e!==b.rootURL&&(b.dispose(),b=R())}),i({group:n,tilesGroup:b.group}),(e,s)=>(d(),m("TresGroup",{ref_key:"groupRef",ref:n},[j("primitive",{object:c(b).group},null,8,x)],512))}}),_=n({__name:"obliquePhotoPage",setup(e){const s={clearColor:"#201919",windowSize:!0,shadows:!0,toneMapping:T,toneMappingExposure:1,shadowMapType:w},o=g({tilesUrl:"https://opensource.cdn.icegl.cn/3Dtiles/simpleGIS/TilesetWithDiscreteLOD/tileset.json",isRotation:!0,isRranslation:!0}),a=p(o.tilesUrl),r=new i;r.addBinding(a,"value",{label:"tiles地址"});return r.addButton({title:"应用",label:"从url读取tiles"}).on("click",()=>{a.value!==o.tilesUrl&&(r.disabled=!0,l(a.value).then(e=>{e?o.tilesUrl=a.value:alert("这不是一个有效的3D Tiles地址"),r.disabled=!1}))}),r.addBinding(o,"isRotation",{label:"地心旋转"}),r.addBinding(o,"isRranslation",{label:"居中展示"}),(e,i)=>{const a=v("TresCanvas");return d(),f(a,b(s,{"window-size":""}),{default:h(()=>[i[0]||(i[0]=j("TresPerspectiveCamera",{position:[800,800,800],fov:60,near:1,far:2e4},null,-1)),R(c(t)),i[1]||(i[1]=j("TresAmbientLight",{intensity:1},null,-1)),i[2]||(i[2]=j("TresDirectionalLight",{position:[1,2,3],intensity:1.25},null,-1)),i[3]||(i[3]=j("TresAxesHelper",{args:[100]},null,-1)),R(U,b(o,{"rotation-x":o.isRotation?-Math.PI/2:0}),null,16,["rotation-x"])]),_:1},16)}}});export{_ as default};
