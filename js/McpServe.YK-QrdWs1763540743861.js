import{g as e,b as t,a as s}from"./index.CLV4nRY61763540743861.js";import{t as a,v as r,w as l,x as i,e as o}from"./index.vue_vue_type_script_setup_true_lang.YCkLl6gI1763540743861.js";import{d as p}from"./dayjs.Bq9h5by71763540743861.js";import{u,s as n,x as m,c as j,d as _,B as v,F as d,D as c,H as g,g as f}from"./naive-ui.qjPOP62h1763540743861.js";import{d as y,a as h,q as b,w as k,H as x,o as w,h as C,J as M,u as F,e as S,y as E,b as P,F as H,I,N as D}from"./@vue.Co_gxueH1763540743861.js";import{_ as N}from"./@fesjs.BEMFm_yJ1763540743861.js";import"./pinia.CEQ6XgE61763540743861.js";import"./index.CNDMsfVY1763540743861.js";import"./@tresjs.BCHtwiaC1763540743861.js";import"./three.rXKzP9fQ1763540743861.js";import"./postprocessing.51l5tmA-1763540743861.js";import"./@vueuse.CfFJ-iFV1763540743861.js";import"./index.Crdf3MNx1763540743861.js";import"./chalk.BHLFMujs1763540743861.js";/* empty css                                 */import"./iconify-icon.1JyQPtAK1763540743861.js";import"./@iconify.DDuAktjw1763540743861.js";import"./vite-plugin-qiankun.B06WoCqG1763540743861.js";import"./vue-router.BxG8XxK11763540743861.js";import"./dompurify.C4MEnGDh1763540743861.js";import"./oimophysics.CfVKSiAm1763540743861.js";import"./three-stdlib.DJsODJ8R1763540743861.js";import"./@pmndrs.C5SFDEDA1763540743861.js";import"./object-hash.DlZNhpf61763540743861.js";import"./@amap.D8CfaEsq1763540743861.js";import"./crypto-js.CLP5yTup1763540743861.js";import"./tweakpane.CqZAnw7f1763540743861.js";import"./lodash-es.B7GkVYRo1763540743861.js";import"./@qlin.y-0Z8WnK1763540743861.js";import"./@babel.BPq7uOAK1763540743861.js";import"./@floating-ui.Bhq4ibgf1763540743861.js";import"./@juggle.Vc7cP4_P1763540743861.js";import"./date-fns.eh-WGDI81763540743861.js";import"./@css-render.DtSd-BuN1763540743861.js";import"./css-render.Dlx27V_T1763540743861.js";import"./@emotion.DFFAhID71763540743861.js";import"./seemly.D2hUckm91763540743861.js";import"./vooks.CVMU_ROE1763540743861.js";import"./evtd.C4K_ichY1763540743861.js";import"./vueuc.CEvnhvIm1763540743861.js";import"./vdirs.DlTVi7SG1763540743861.js";import"./treemate.Qc8YxXqZ1763540743861.js";import"./date-fns-tz.CIz1xaH61763540743861.js";import"./async-validator.DJtlKCAR1763540743861.js";import"./index.QCDLN1HB1763540743861.js";import"./digitalGround.vue_vue_type_script_setup_true_lang.CuICn5MU1763540743861.js";import"./gridPlusCom.vue_vue_type_script_setup_true_lang.y6LQ7gS61763540743861.js";import"./whiteFloorMesh.vue_vue_type_script_setup_true_lang.DrBGeN8S1763540743861.js";import"./reflectorShaderMesh.vue_vue_type_script_setup_true_lang.j80LsBS51763540743861.js";import"./rubberTiles.vue_vue_type_script_setup_true_lang.DzQYh7wl1763540743861.js";import"./iceFloor.vue_vue_type_script_setup_true_lang.KukL8Ys41763540743861.js";import"./rippleFloor.vue_vue_type_script_setup_true_lang.CrhMxttz1763540743861.js";import"./forEditor.C2cJ_5Ze1763540743861.js";import"./localforage.DDqgAo791763540743861.js";import"./index.d2-zW_AZ1763540743861.js";import"./SPE.DlM1ZxbO1763540743861.js";import"./utils.DhJ-cORL1763540743861.js";import"./three-mesh-bvh.BY-MaG5X1763540743861.js";import"./Fetch.CIMEiaKn1763540743861.js";import"./three-custom-shader-material.C6taB_aY1763540743861.js";import"./clouds.vue_vue_type_script_setup_true_lang.BJSVkTJI1763540743861.js";import"./index.rkaFa8DS1763540743861.js";import"./lamina.CxI2-h101763540743861.js";import"./glsl-tokenizer.Cpn-d2QS1763540743861.js";import"./glsl-token-descope.24zcwi031763540743861.js";import"./glsl-token-depth.Duvdnvlt1763540743861.js";import"./glsl-token-scope.BdCfdvWe1763540743861.js";import"./glsl-token-properties.DKXemF9b1763540743861.js";import"./glsl-token-assignments.Ctx_yUgS1763540743861.js";import"./glsl-token-string.JgxMz1Ls1763540743861.js";import"./glsl-token-functions.K9W8Yo431763540743861.js";import"./utils.Q6g8Ca9b1763540743861.js";import"./basiceEnv.vue_vue_type_script_setup_true_lang.CjbLwkK31763540743861.js";const T={class:"mcp-serve"},q={style:{padding:"20px 10px"}},z=N(y({__name:"McpServe",setup(y){const N=u(),z=h(null),J=h(null);b(()=>{z.value=e(),z.value||(z.value=t())}),k(z,async e=>{if(e){document.cookie="token="+e.token+"; path=/;";const t=await a();t?J.value=t:(localStorage.removeItem("userInfor"),z.value=null)}},{immediate:!0});const O=async()=>{z.value=s()},A=h(""),G=h([]),L=h(!1),W=n(),Y=async()=>{!A.value||A.value.length<10||W.warning({title:"此操作会清空当前场景以及历史记录",content:"是否新建场景？",positiveText:"确定",negativeText:"取消",draggable:!1,onPositiveClick:async()=>{if(L.value)return;r(),L.value=!0;let e=N.loading("MCP大语言模型分析中，时间较长请耐心等待",{duration:0});const t=await l(A.value,window.modelServeConfig);e.destroy(),t.response?(J.value.leftnumber--,e=N.loading("场景载入中...",{duration:0}),await i(JSON.parse(t.response)),e.destroy(),N.success("载入成功，请继续编辑"),o("MCP","新增场景")):N.error("MCP大语言模型分析失败"),L.value=!1,G.value.push(p().format("MM-DD HH:mm:")+` <${t.response?"成功":"失败"}> `+A.value)},onNegativeClick:()=>{L.value}})};return(e,t)=>(w(),x("div",T,[C(F(m),{title:"此为测试版",type:"info",closable:""},{default:S(()=>[...t[1]||(t[1]=[E(" - 接入MCP服务，用于快速初始化场景",-1),M("br",null,null,-1),E(" - 因为token有限，免费:",-1),M("br",null,null,-1),E("3次/天/每人",-1),M("br",null,null,-1),E(" - 目前测试版使用豆包1.5pro32k模型，效果还待优化，完善后集成进插件包中。",-1),M("br",null,null,-1)])]),_:1}),M("div",q,[C(F(j),{"label-width":70},{default:S(()=>[z.value?(w(),x(H,{key:1},[C(F(_),{label:"用户昵称："},{default:S(()=>[C(F(d),{type:"success"},{default:S(()=>[E(D(z.value.nickname),1)]),_:1})]),_:1}),C(F(_),{label:"用户名："},{default:S(()=>[C(F(d),{type:"info"},{default:S(()=>[E(D(z.value.username),1)]),_:1})]),_:1}),J.value?(w(),x(H,{key:0},[C(F(_),{label:"当后天剩余次数："},{default:S(()=>[C(F(d),{type:"warning"},{default:S(()=>[E(D(J.value.leftnumber)+" / "+D(J.value.allnumber),1)]),_:1})]),_:1}),C(F(c),null,{default:S(()=>[...t[3]||(t[3]=[E("请求历史",-1)])]),_:1}),C(F(g),{log:G.value.join("\n"),rows:6},null,8,["log"]),J.value.leftnumber>0?(w(),x(H,{key:0},[C(F(c),null,{default:S(()=>[...t[4]||(t[4]=[E("当前场景要求",-1)])]),_:1}),C(F(f),{status:A.value.length<10||A.value.length>100?"warning":"success",maxlength:100,minlength:10,value:A.value,"onUpdate:value":t[0]||(t[0]=e=>A.value=e),type:"textarea",placeholder:"布局一个小型娱乐游戏室[描述请超过10个字]"},null,8,["status","value"]),C(F(v),{style:{left:"62%",top:"10px"},type:"primary",disabled:L.value,onClick:Y},{default:S(()=>[...t[5]||(t[5]=[E(" 提交需求 ",-1)])]),_:1},8,["disabled"])],64)):(w(),P(F(c),{key:1},{default:S(()=>[...t[6]||(t[6]=[E("次数已用完",-1)])]),_:1}))],64)):I("",!0)],64)):(w(),P(F(_),{key:0,label:"未登录，请点击登录后，体验"},{default:S(()=>[C(F(v),{type:"primary",onClick:O},{default:S(()=>[...t[2]||(t[2]=[E(" 登陆使用 ",-1)])]),_:1})]),_:1}))]),_:1})])]))}}),[["__scopeId","data-v-252df312"]]);export{z as default};
