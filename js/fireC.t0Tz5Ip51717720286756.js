import{_ as Ae}from"./pagesShow.vue_vue_type_script_setup_true_lang.9CP5jr0n1717720286756.js";import{c6 as _e,cx as ge,bS as xe,at as ze,cy as ve,aA as be,bB as Ce,be as Fe,ba as Me,br as U,bt as ke,a5 as te,aH as De,a8 as Pe,o as O,c as Ve,T as Be,ad as He,C as N,J as ee,ak as Oe,a as Re}from"./vendor.2VFT6kQ_1717720286756.js";import"./vanilla.U8Vi48_91717720286756.js";import"./object_hash.OT7ucz5J1717720286756.js";import"./_commonjsHelpers.5-cIlDoe1717720286756.js";import"./_commonjs-dynamic-modules.h-SxKiO41717720286756.js";import"./builtins-300es.Tm_BdSQ71717720286756.js";import"./LineSegments2.akaAw3rK1717720286756.js";const We=({startFrame:p,endFrame:d,fps:h,frameName:n,textureDataURL:S,textureImageURL:w,loop:A,numberOfFrames:v,autoPlay:se,animationNames:re,onStart:R,onEnd:W,onLoopEnd:Y,onFrame:L,play:X,pause:b,flipX:ae,alphaTest:m,asSprite:C})=>{let l={frames:[],meta:{version:"1.0",size:{w:1,h:1},scale:"1"}},j=!1,F=new _e;const M=new ge({toneMapped:!1,transparent:!0,map:F,alphaTest:m!=null?m:0}),G=new xe({toneMapped:!1,side:ze,map:F,transparent:!0,alphaTest:m!=null?m:0}),_=new ve(M),k=new be(new Ce(1,1),G);let o=M,y=_;const u=new Fe;u.add(y);let I=window.performance.now(),f=p||0,D=n||"";const J=1e3/(h||30),ne=e=>{F=e,o&&(o.map=e)},oe=new Me(1,1,1),ie=e=>{oe.copy(e)},$=ae?-1:1;let P=C!=null?C:!0;(e=>{P=e,P?(o=M,y=_,u.add(_),u.remove(k)):(o=G,y=k,u.remove(_),u.add(k))})(P);async function ce(e,t,r){const s=new U,i=fetch(e).then(a=>a.json()),c=new Promise(a=>{s.load(t,a)});await Promise.all([i,c]).then(a=>{r(a[0],a[1])})}const E=(e,t)=>{const r=t/e;return y.scale.set(1,r,1),y.scale},le=async()=>{if(S&&w)await ce(S,w,K);else if(w){const t=await new U().loadAsync(w);K(null,t)}},fe=e=>{n=e,D!==n&&n&&(f=0,D=n)},pe=()=>{b=!0},me=()=>{X=!0,b=!1},K=(e,t)=>{if(e===null){if(t&&v){const r=t.image.width,s=t.image.height,i=r/v,c=s;if(l={frames:[],meta:{version:"1.0",size:{w:r,h:s},scale:"1"}},parseInt(i.toString(),10)===i)for(let a=0;a<v;a++)l.frames.push({frame:{x:a*i,y:0,w:i,h:c},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:i,h:c},sourceSize:{w:i,h:s}})}}else if(t){l=e,l.frames=Array.isArray(e.frames)?e.frames:ue();const{w:r,h:s}=q(e.frames).sourceSize,i=E(r,s);ie(i),o&&(o.map=t)}t.premultiplyAlpha=!1,ne(t),de()},ue=()=>{const e={},t=l,r=re;if(r)for(let s=0;s<r.length;s++){e[r[s]]=[];for(const i in t.frames){const c=t.frames[i],a=c.frame,g=a.x,x=a.y,V=a.w,B=a.h,H=c.sourceSize.w,z=c.sourceSize.h;typeof i=="string"&&i.toLowerCase().indexOf(r[s].toLowerCase())!==-1&&e[r[s]].push({x:g,y:x,w:V,h:B,frame:a,sourceSize:{w:H,h:z}})}}return e},de=()=>{if(!(l&&o.map))return;const{meta:{size:e},frames:t}=l,{w:r,h:s}=Array.isArray(t)?t[0].sourceSize:n?t[n]?t[n][0].sourceSize:{w:0,h:0}:{w:0,h:0};o.map.wrapS=o.map.wrapT=ke,o.map.center.set(0,0),o.map.repeat.set(1*$/(e.w/r),1/(e.h/s));const c=1/((e.h-1)/s);o.map.offset.x=0,o.map.offset.y=1-c,R&&R({currentFrameName:n,currentFrame:f})},he=()=>{if(!(l&&o.map))return;const e=window.performance.now(),t=e-I,{meta:{size:r},frames:s}=l,{w:i,h:c}=q(s).sourceSize,a=Array.isArray(s)?s:n?s[n]:[];let g=0,x=0;const V=d||a.length-1;if(f>V&&(f=A&&p!=null?p:0,A?Y==null||Y({currentFrameName:n,currentFrame:f}):(W==null||W({currentFrameName:n,currentFrame:f}),j=!0),!A)||t<=J)return;I=e-t%J,E(i,c);const B=(r.w-1)/i,H=(r.h-1)/c,{frame:{x:z,y:ye},sourceSize:{w:Q,h:Se}}=a[f],Z=1/B,T=1/H;g=$>0?Z*(z/Q):Z*(z/Q)-o.map.repeat.x,x=Math.abs(1-T)-T*(ye/Se),o.map.offset.x=g,o.map.offset.y=x,f+=1},we=()=>{var e,t;!((e=l)!=null&&e.frames)||!((t=o)!=null&&t.map)||b||!j&&(se||X)&&(he(),L&&L({currentFrameName:D,currentFrame:f}))},q=e=>{if(Array.isArray(e))return e[0];if(typeof e=="object"&&e!==null){const t=Object.keys(e);return e[t[0]][0]}else return{w:0,h:0}};return{group:u,init:le,update:we,playAnimation:me,pauseAnimation:pe,setFrameName:fe}},Ye=["object"],Le=te({__name:"fireC",async setup(p){let d,h;const n=We({startFrame:0,fps:40,autoPlay:!0,loop:!0,textureImageURL:"./plugins/digitalCity/image/spriteAnimator/flame.png",textureDataURL:"./plugins/digitalCity/image/spriteAnimator/flame.json",alphaTest:.101,asSprite:!0});[d,h]=De(()=>n.init()),await d,h(),n.group.children[0].material.map.colorSpace=Pe;const{onLoop:S}=He();return S(()=>{n.update()}),(w,A)=>(O(),Ve("primitive",{object:Be(n).group,renderOrder:9999},null,8,Ye))}}),Qe=te({__name:"fireC",setup(p){return(d,h)=>(O(),N(Ae,null,{ability:ee(()=>[(O(),N(Oe,null,{default:ee(()=>[Re(Le,{position:[0,70,0],scale:100})]),_:1}))]),_:1}))}});export{Qe as default};
