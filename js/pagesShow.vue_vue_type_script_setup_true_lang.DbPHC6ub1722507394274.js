import{a6 as t,C as n,ca as o,cb as e,cc as r,cd as i,k as u,bW as c,ab as s,ad as a}from"./three.Brogx0uK1722507394274.js";import{f as l,$ as f,d as p}from"./@tresjs.bNNpPzYW1722507394274.js";import{C as d}from"./three-custom-shader-material.CeVv8ptL1722507394274.js";import"./object-hash.rImj7O_Q1722507394274.js";import"./@amap.B-BVafMU1722507394274.js";import"./glsl-tokenizer.D7fhDZQE1722507394274.js";import{d as h,b as m,a1 as y,w as g,o as w,D as v,u as b,r as C,a4 as _,e as I,f as x,g as M,J as T,j as S,aj as A,ak as R,F as B,I as O,G as j,m as W}from"./@vue.CFXy4cc91722507394274.js";function E(t,n){const o=H();return(E=function(t,n){return o[t-=264]})(t,n)}!function(t,n){const o=E,e=H();for(;;)try{if(709729===parseInt(o(289))/1+parseInt(o(292))/2+-parseInt(o(267))/3+-parseInt(o(294))/4+parseInt(o(281))/5*(parseInt(o(270))/6)+parseInt(o(268))/7+-parseInt(o(288))/8*(parseInt(o(295))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(300)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=E,n=new RegExp(t(269)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=G(t(296));n[t(293)](e+t(290))&&o.test(e+"input")?G():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(300)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["console","traverse",'{}.constructor("return this")( )',"bind","1813840oHhWtT","286258vpEoKr","chain","toString","1182344HpYSBC","test","327340WKSNbE","45OtmTlM","init","counter","debu","ROADS","apply","log","table","gger","info","1789863GjRdzW","1775445WbEUCJ","function *\\( *\\)","20604RJiCxE","call","LANDMASS","name","CITY_UNTRIANGULATED","warn","constructor","length","string","error","exception","2025HdSuTO","prototype","return (function() "];return(H=function(){return t})()}D(void 0,(function(){const t=E;let n;try{n=Function(t(283)+t(286)+");")()}catch(r){n=window}const o=n[t(284)]=n[t(284)]||{},e=[t(301),t(275),t(266),t(279),t(280),t(264),"trace"];for(let i=0;i<e[t(277)];i++){const n=D.constructor[t(282)][t(287)](D),r=e[i],u=o[r]||n;n.__proto__=D.bind(D),n[t(291)]=u.toString[t(287)](u),o[r]=n}}))();const F=async()=>{const t=E,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(285)]((n=>{const i=t;n[i(273)]===i(274)&&(o=n),n[i(273)]===i(272)&&(e=n),n.name===i(299)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function G(t){function n(t){const o=E;if(typeof t===o(278))return function(t){}[o(276)]("while (true) {}")[o(300)](o(297));1!==(""+t/t)[o(277)]||t%20==0?function(){return!0}[o(276)](o(298)+o(265))[o(271)]("action"):function(){return!1}[o(276)](o(298)+o(265)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=Y;!function(t,n){const o=Y,e=Z();for(;;)try{if(186912===-parseInt(o(175))/1*(-parseInt(o(165))/2)+-parseInt(o(153))/3+parseInt(o(122))/4*(parseInt(o(179))/5)+parseInt(o(160))/6+-parseInt(o(166))/7*(parseInt(o(143))/8)+parseInt(o(148))/9+-parseInt(o(158))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Y(144)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=Y,n=new RegExp(t(128)),o=new RegExp(t(133),"i"),e=N(t(151));n[t(124)](e+t(134))&&o[t(124)](e+"input")?N():e("0")}))()}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Y(144)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["313244QGMETp","#112233","test","constructor","model","bind","function *\\( *\\)","__proto__","exception","string","table","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","#ffff00","material","uColor","city","color","error","setStyle","opacity","8VcOUfu","apply","Color","land","landColor","2792430wMGZDT","action","__csm","init","warn","849912utCZym","dispose","while (true) {}","console","info","2877130QpXRxP","log","791958ksFEmW","topColor","length","debu","DoubleSide","4bdwHcB","492709SYqMuq","value",'{}.constructor("return this")( )',"computeBoundingSphere","gradient","bulidingsColor","uniforms","return (function() ","boundingBox","153871zonAbt","isArray","side","#ffffff","5YXitWF","gger","object","prototype","stateObject","toString"];return(Z=function(){return t})()}P(void 0,(function(){const t=Y;let n;try{n=Function(t(173)+t(168)+");")()}catch(r){n=window}const o=n.console=n[t(156)]||{},e=[t(159),t(152),t(157),t(140),t(130),t(132),"trace"];for(let i=0;i<e[t(162)];i++){const n=P.constructor[t(119)].bind(P),r=e[i],u=o[r]||n;n[t(129)]=P[t(127)](P),n[t(121)]=u[t(121)].bind(u),o[r]=n}}))();const $=[L(118)];function Y(t,n){const o=Z();return(Y=function(t,n){return o[t-=117]})(t,n)}const U=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:L(123)},topColor:{default:L(135)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=L,r=o,i=m(0),u=r[e(126)][e(138)];u.renderOrder=1001;const c=r[e(126)][e(146)];(()=>{const o=e,{geometry:c}=u;c.computeBoundingBox(),c[o(169)]();const{max:s,min:a}=c[o(174)];if(u[o(136)][o(150)])return;const l=new d({baseMaterial:u.material,vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(r[o(171)])},uOpacity:{value:r[o(142)]},uLightColor:{value:new(t[o(145)])(o(178))},uTopColor:{value:new(t[o(145)])(r[o(161)])},uTime:i,uGradient:{value:r[o(170)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(164)]});u[o(136)][o(154)](),u.material=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(167)]+=t})),y((()=>{const n=e;r[n(171)]&&u[n(136)][n(172)][n(137)][n(167)][n(141)](r.bulidingsColor),r[n(147)]&&((n,o)=>{const i=e;let u;n===i(146)&&(u=Array[i(176)](c[i(136)])?c[i(136)]:[c[i(136)]],u.forEach((n=>{const e=i;n[o][e(141)](r[e(147)]),n[e(177)]=t[e(164)]})))})("land",n(139)),r[n(142)]&&(u[n(136)][n(172)].uOpacity[n(167)]=r.opacity)})),g(r,((t,n)=>{const o=e;u[o(136)][o(172)].uGradient.value=t[o(170)]}));const a=r.model[e(126)].clone();return(t,n)=>(w(),v("primitive",{object:b(a)},null,8,$))}});function N(t){function n(t){const o=Y;if(typeof t===o(131))return function(t){}[o(125)](o(155))[o(144)]("counter");1!==(""+t/t)[o(162)]||t%20==0?function(){return!0}[o(125)](o(163)+o(117)).call(o(149)):function(){return!1}[o(125)](o(163)+o(117))[o(144)](o(120)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const X=tt;!function(t,n){const o=tt,e=q();for(;;)try{if(430210===parseInt(o(276))/1*(parseInt(o(281))/2)+parseInt(o(313))/3+parseInt(o(295))/4*(parseInt(o(324))/5)+parseInt(o(273))/6+parseInt(o(278))/7*(-parseInt(o(325))/8)+parseInt(o(300))/9+-parseInt(o(322))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){K(this,(function(){const t=tt,n=new RegExp(t(291)),o=new RegExp(t(292),"i"),e=nt(t(303));n[t(321)](e+t(302))&&o.test(e+t(271))?nt():e("0")}))()}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function q(){const t=["uniforms","matrix","test","15902730AeiWeI","innerWidth","5SKAeEF","1760nnvuWC","exception","error","string","input","return (function() ","2655894pSwRkd","value","material","3LRBkZF","info","14616nYCBME","builds","Shader","477614PXaHwc","innerHeight","prototype","linewidth","object","opacity","__proto__","#FFF","color","length","function *\\( *\\)","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","fromEdgesGeometry","set","2633408LXqDWJ","toString","geometry","Wireframe","console","1144062YeZyNb","bind","chain","init","call","style","counter"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","debu","while (true) {}","constructor","trace","apply","1605909CHDcVh","clone","gger","width","table","applyMatrix4"];return(q=function(){return t})()}J(void 0,(function(){const t=tt,n=function(){const t=tt;let n;try{n=Function(t(272)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(299)]||{},e=["log","warn",t(277),t(269),t(268),t(317),t(311)];for(let r=0;r<e[t(290)];r++){const n=J[t(310)][t(283)].bind(J),i=e[r],u=o[i]||n;n[t(287)]=J[t(301)](J),n[t(296)]=u[t(296)][t(301)](u),o[i]=n}}))();const V=[X(285)],Q=h({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:X(288)},opacity:{default:1},style:{default:"Wireframe"}},setup(t){const c=X,s=t;let a=null,l=null;if(s[c(305)]===c(298)){const t=new o(s[c(279)][c(297)]);let n=(new e)[c(293)](t),u=new r({color:s.color,linewidth:s[c(316)],opacity:s[c(286)],transparent:!0,depthWrite:!0,depthTest:!0});u.resolution[c(294)](window[c(323)],window[c(282)]),a=new i(n,u),a[c(318)](s[c(279)][c(320)][c(314)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(289)])},uOpacity:{value:s[c(286)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(307)};const t=new o(s[c(279)][c(297)]),e=new u(l);a=new LineSegments(t,e),a[c(318)](s[c(279)][c(320)][c(314)]()),a[c(275)][c(284)]=s[c(316)],a.renderOrder=1e3}return y((()=>{const t=c;s.style===t(280)&&(s[t(289)]&&(l[t(319)].uColor[t(274)]=new n(s.color)),s[t(286)]&&(l.uniforms.uOpacity.value=s.opacity)),s[t(305)]===t(298)&&(s.color&&(a[t(275)][t(289)]=new n(s[t(289)])),s.opacity&&(a[t(275)][t(286)]=s.opacity)),s[t(316)]&&(a[t(275)][t(284)]=s[t(316)])})),(t,n)=>(w(),v("primitive",{object:b(a)},null,8,V))}});function tt(t,n){const o=q();return(tt=function(t,n){return o[t-=268]})(t,n)}function nt(t){function n(t){const o=tt;if(typeof t===o(270))return function(t){}[o(310)](o(309))[o(312)](o(306));1!==(""+t/t)[o(290)]||t%20==0?function(){return!0}[o(310)]("debu"+o(315))[o(304)]("action"):function(){return!1}[o(310)](o(308)+o(315))[o(312)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=ft;function et(){const t=["while (true) {}","$slots","19709130cBfiWX","chain","34494PyESSa","perspectiveCameraRef","TresAxesHelper","TresAmbientLight","exception","gger","apply","showGridHelper","counter","console","8stZjom","bind","constructor","input","info","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","length","city","1522872ACBaUp","TresPerspectiveCamera","4yYPTiT","ability","pagesShow","autoRotate","554473YdAYTI","return (function() ","error","1153885NmCsSD","#000","debu","1056117CihgKd","__proto__","test","TresGridHelper","252UGWhRI","log","tcRef","trace","#ffffff","showAxesHelper","toString","7145568DcyKWa","TresDirectionalLight","disableRender","table","call"];return(et=function(){return t})()}!function(t,n){const o=ft,e=et();for(;;)try{if(526539===parseInt(o(511))/1+parseInt(o(507))/2*(parseInt(o(517))/3)+parseInt(o(497))/4*(parseInt(o(514))/5)+-parseInt(o(487))/6*(parseInt(o(521))/7)+parseInt(o(505))/8+parseInt(o(528))/9+-parseInt(o(485))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=ft,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(502),"i"),e=pt("init");n[t(519)](e+t(486))&&o[t(519)](e+t(500))?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(493)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=ft,n=function(){const t=ft;let n;try{n=Function(t(512)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(496)]=n[t(496)]||{},e=[t(522),"warn",t(501),t(513),t(491),t(531),t(524)];for(let r=0;r<e[t(503)];r++){const n=it[t(499)].prototype[t(498)](it),i=e[r],u=o[i]||n;n[t(518)]=it[t(498)](it),n[t(527)]=u[t(527)].bind(u),o[i]=n}}))();const ut=T(ot(490),{color:ot(525)},null,-1),ct=T(ot(529),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]},lt=h({__name:ot(509),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=C({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(530)]}),u=C({autoRotate:r[n(510)],enableDamping:!0});let l=null;r.showBuildings&&([o,e]=_((()=>F())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I("TresCanvas");return w(),x(c,W({ref_key:e(523),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(506),{ref_key:e(488),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(p),A(R(u)),null,16),ut,ct,r.showBuildings&&b(l)?(w(),v(B,{key:0},[S(U,{model:b(l)},null,8,["model"]),S(Q,{builds:b(l)[e(504)],color:e(515)},null,8,["builds"])],64)):O("",!0),j(t[e(484)],e(508)),r[e(526)]?(w(),v(e(489),st)):O("",!0),r[e(494)]?(w(),v(e(520),at)):O("",!0)])),_:3},16)}}});function ft(t,n){const o=et();return(ft=function(t,n){return o[t-=482]})(t,n)}function pt(t){function n(t){const o=ft;if("string"==typeof t)return function(t){}.constructor(o(483))[o(493)](o(495));1!==(""+t/t)[o(503)]||t%20==0?function(){return!0}[o(499)](o(516)+"gger")[o(482)]("action"):function(){return!1}[o(499)](o(516)+o(492))[o(493)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as _,Q as a,lt as b,F as l};
