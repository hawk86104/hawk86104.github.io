import{_ as t,ce as n,cf as o,cg as e,ch as r,C as i,m as u,bU as c,ak as s,am as a}from"./three.eGpwEcxC1731053920743.js";import{d as l,e as f,U as p}from"./@tresjs.hJVQLtpa1731053920743.js";import{z as d}from"./three-custom-shader-material.u9oeG2Gi1731053920743.js";import{d as h,b as m,a3 as y,w as g,o as w,D as v,u as b,r as _,a6 as C,e as I,f as x,g as M,J as T,j as R,aj as O,ak as S,F as A,I as j,G as B,m as P}from"./@vue.u2cBPEWn1731053920743.js";!function(t,n){const o=L,e=E();for(;;)try{if(125122===parseInt(o(265))/1*(-parseInt(o(258))/2)+parseInt(o(241))/3*(parseInt(o(236))/4)+-parseInt(o(247))/5*(-parseInt(o(237))/6)+-parseInt(o(248))/7+-parseInt(o(262))/8+parseInt(o(263))/9+parseInt(o(269))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(260)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function L(t,n){const o=E();return(L=function(t,n){return o[t-=232]})(t,n)}!function(){z(this,(function(){const t=L,n=new RegExp(t(238)),o=new RegExp(t(232),"i"),e=k(t(250));n[t(244)](e+t(233))&&o[t(244)](e+"input")?k():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(260)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function E(){const t=["return (function() ","3259150mtqREd","table","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","name","action","73596oWmBLX","696PhvUPY","function *\\( *\\)","constructor","info","18RzPUIJ","ROADS","prototype","test","traverse","length","3335gTnJkx","759332Nbhbnl","counter","init","gger","error","call","warn",'{}.constructor("return this")( )',"toString","LANDMASS","137758tCdvCt","log","apply","console","1246128dToSnq","120969YMzroP","stateObject","2Rrtxzd","trace","exception"];return(E=function(){return t})()}F(void 0,(function(){const t=L;let n;try{n=Function(t(268)+t(255)+");")()}catch(r){n=window}const o=n.console=n[t(261)]||{},e=[t(259),t(254),t(240),t(252),t(267),t(270),t(266)];for(let i=0;i<e[t(246)];i++){const n=F[t(239)][t(243)].bind(F),r=e[i],u=o[r]||n;n.__proto__=F.bind(F),n[t(256)]=u.toString.bind(u),o[r]=n}}))();const D=async()=>{const t=L,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(245)]((n=>{const i=t;"CITY_UNTRIANGULATED"===n.name&&(o=n),n.name===i(257)&&(e=n),n[i(234)]===i(242)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function k(t){function n(t){const o=L;if("string"==typeof t)return function(t){}[o(239)]("while (true) {}")[o(260)](o(249));1!==(""+t/t)[o(246)]||t%20==0?function(){return!0}[o(239)]("debu"+o(251))[o(253)](o(235)):function(){return!1}[o(239)]("debu"+o(251))[o(260)](o(264)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=$;!function(t,n){const o=$,e=H();for(;;)try{if(760727===-parseInt(o(152))/1+parseInt(o(147))/2+parseInt(o(139))/3*(parseInt(o(123))/4)+-parseInt(o(166))/5+-parseInt(o(122))/6*(parseInt(o(136))/7)+-parseInt(o(117))/8*(parseInt(o(171))/9)+-parseInt(o(140))/10*(-parseInt(o(151))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(121)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["setStyle","call","model","uColor","constructor","landColor","uGradient",'{}.constructor("return this")( )',"return (function() ","log","input","217jESCjO","side","computeBoundingSphere","1404LoRFJP","7056840Amarvy","chain","trace","#e523ff","value","debu","DoubleSide","2003518EAtONb","init","function *\\( *\\)","length","44KyDxPp","828453gAbvzf","topColor","counter","#112233","#ffffff","stateObject","__csm","primitive","info","renderOrder","uOpacity","prototype","color","gradient","6135305zvfWFP","toString","buildingsModelCustomShader","isArray","uniforms","105957FjhsyP","bind","#ffff00","table","test","object","land","warn","dispose","console","opacity","while (true) {}","bulidingsColor","forEach","472jWjTmv","exception","Color","material","apply","157446mCJhBw","4272XrNPfC","gger"];return(H=function(){return t})()}!function(){W(this,(function(){const t=$,n=new RegExp(t(149)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=U(t(148));n.test(e+t(141))&&o[t(175)](e+t(135))?U():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(121)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(t,n){const o=H();return($=function(t,n){return o[t-=109]})(t,n)}Z(void 0,(function(){const t=$,n=function(){const t=$;let n;try{n=Function(t(133)+t(132)+");")()}catch(o){n=window}return n}(),o=n[t(112)]=n[t(112)]||{},e=[t(134),t(110),t(160),"error",t(118),t(174),t(142)];for(let r=0;r<e[t(150)];r++){const n=Z[t(129)][t(163)][t(172)](Z),i=e[r],u=o[i]||n;n.__proto__=Z[t(172)](Z),n.toString=u[t(167)][t(172)](u),o[i]=n}}))();const N=[G(176)],J=h({__name:G(168),props:{model:{},bulidingsColor:{default:G(143)},landColor:{default:G(155)},topColor:{default:G(173)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=G,e=n,r=m(0),i=e[o(127)].city;i[o(161)]=1001;const u=e[o(127)].land;(()=>{const n=o,{geometry:u}=i;u.computeBoundingBox(),u[n(138)]();const{max:c,min:s}=u.boundingBox;if(i[n(120)][n(158)])return;const a=new d({baseMaterial:i[n(120)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(119)])(e.bulidingsColor)},uOpacity:{value:e[n(113)]},uLightColor:{value:new(t[n(119)])(n(156))},uTopColor:{value:new(t[n(119)])(e[n(153)])},uTime:r,uGradient:{value:e[n(165)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(146)]});i.material[n(111)](),i[n(120)]=a})();const{onLoop:c}=f();c((({delta:t})=>{r.value+=t})),y((()=>{const n=o;e[n(115)]&&i.material.uniforms[n(128)][n(144)][n(125)](e[n(115)]),e[n(130)]&&((n,r)=>{const i=o;let c;"cu"===n||n===i(109)&&(c=Array[i(169)](u[i(120)])?u[i(120)]:[u[i(120)]],c[i(116)]((n=>{const o=i;n[r].setStyle(e.landColor),n[o(137)]=t[o(146)]})))})("land",n(164)),e[n(113)]&&(i[n(120)][n(170)][n(162)].value=e.opacity)})),g(e,((t,n)=>{const e=o;i[e(120)].uniforms[e(131)].value=t[e(165)]}));const s=e[o(127)][o(127)].clone();return(t,n)=>{const e=o;return w(),v(e(159),{object:b(s)},null,8,N)}}});function U(t){function n(t){const o=$;if("string"==typeof t)return function(t){}[o(129)](o(114))[o(121)](o(154));1!==(""+t/t).length||t%20==0?function(){return!0}[o(129)]("debugger")[o(126)]("action"):function(){return!1}[o(129)](o(145)+o(124))[o(121)](o(157)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const X=K;!function(t,n){const o=K,e=Y();for(;;)try{if(199891===parseInt(o(246))/1+-parseInt(o(293))/2*(-parseInt(o(302))/3)+-parseInt(o(256))/4*(-parseInt(o(267))/5)+parseInt(o(249))/6+parseInt(o(262))/7*(-parseInt(o(298))/8)+parseInt(o(261))/9*(parseInt(o(292))/10)+-parseInt(o(251))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(257)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Q(this,(function(){const t=K,n=new RegExp(t(268)),o=new RegExp(t(299),"i"),e=nt(t(294));n[t(258)](e+t(278))&&o.test(e+t(297))?nt():e("0")}))()}();const V=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(257)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();V(void 0,(function(){const t=K,n=function(){const t=K;let n;try{n=Function("return (function() "+t(250)+");")()}catch(o){n=window}return n}(),o=n[t(245)]=n.console||{},e=[t(295),t(306),t(276),t(289),t(277),"table",t(247)];for(let r=0;r<e[t(285)];r++){const n=V[t(279)][t(273)].bind(V),i=e[r],u=o[i]||n;n[t(255)]=V.bind(V),n[t(264)]=u[t(264)][t(271)](u),o[i]=n}}))();const q=["object"];function Y(){const t=["1216508FlIjBe","apply","test","innerWidth","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","139761LXtEkE","2684381OvTVbW","applyMatrix4","toString","linewidth","buildingsLines","5UelRqh","function *\\( *\\)","opacity","string","bind","debu","prototype","geometry","matrix","info","exception","chain","constructor","width","set","call","gger","action","length","uniforms","fromEdgesGeometry","#FFF","error","innerHeight","clone","200QfIFeu","2uBQdgL","init","log","material","input","8YhXRBu","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","resolution","uOpacity","281805MVadiH","value","builds","style","warn","Shader","console","112220fvQKVe","trace","color","1882938mFspei",'{}.constructor("return this")( )',"6064421bGjzQV","counter","Wireframe","renderOrder","__proto__"];return(Y=function(){return t})()}function K(t,n){const o=Y();return(K=function(t,n){return o[t-=245]})(t,n)}const tt=h({__name:X(266),props:{builds:{},width:{default:1},color:{default:X(288)},opacity:{default:1},style:{default:X(253)}},setup(t){const c=X,s=t;let a=null,l=null;if("Wireframe"===s[c(305)]){const t=new n(s[c(304)][c(274)]);let i=(new o)[c(287)](t),u=new e({color:s.color,linewidth:s[c(280)],opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[c(300)][c(281)](window[c(259)],window[c(290)]),a=new r(i,u),a.applyMatrix4(s.builds[c(275)].clone())}else{l={transparent:!0,uniforms:{uColor:{value:new i(s[c(248)])},uOpacity:{value:s[c(269)]}},vertexShader:c(260),fragmentShader:" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const t=new n(s[c(304)][c(274)]),o=new u(l);a=new LineSegments(t,o),a[c(263)](s[c(304)][c(275)][c(291)]()),a.material[c(265)]=s.width,a[c(254)]=1e3}return y((()=>{const t=c;s[t(305)]===t(307)&&(s.color&&(l.uniforms.uColor.value=new i(s.color)),s[t(269)]&&(l[t(286)][t(301)][t(303)]=s[t(269)])),s[t(305)]===t(253)&&(s[t(248)]&&(a[t(296)][t(248)]=new i(s.color)),s[t(269)]&&(a[t(296)][t(269)]=s.opacity)),s[t(280)]&&(a[t(296)][t(265)]=s.width)})),(t,n)=>(w(),v("primitive",{object:b(a)},null,8,q))}});function nt(t){function n(t){const o=K;if(typeof t===o(270))return function(t){}[o(279)]("while (true) {}")[o(257)](o(252));1!==(""+t/t)[o(285)]||t%20==0?function(){return!0}[o(279)](o(272)+"gger")[o(282)](o(284)):function(){return!1}[o(279)](o(272)+o(283)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=et;function et(t,n){const o=st();return(et=function(t,n){return o[t-=255]})(t,n)}!function(t,n){const o=et,e=st();for(;;)try{if(350228===-parseInt(o(259))/1*(parseInt(o(283))/2)+parseInt(o(258))/3*(parseInt(o(304))/4)+parseInt(o(264))/5+-parseInt(o(280))/6+-parseInt(o(286))/7+-parseInt(o(297))/8+parseInt(o(265))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=et,n=new RegExp(t(255)),o=new RegExp(t(277),"i"),e=lt(t(267));n[t(279)](e+t(278))&&o[t(279)](e+t(296))?lt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[et(260)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=et;let n;try{n=Function("return (function() "+t(303)+");")()}catch(r){n=window}const o=n[t(298)]=n[t(298)]||{},e=[t(256),t(271),t(269),t(305),"exception",t(274),t(262)];for(let i=0;i<e[t(261)];i++){const n=it[t(302)][t(306)][t(285)](it),r=e[i],u=o[r]||n;n.__proto__=it[t(285)](it),n[t(275)]=u[t(275)].bind(u),o[r]=n}}))();const ut={key:1,args:[1e3],position:[0,19,0]},ct={key:2,args:[6e3,100],position:[0,19,0]};function st(){const t=["log","stateObject","69nPxwDX","61174uCmqAz","apply","length","trace","counter","1365430ipDMSn","10736289yQFORG","ability","init","gger","info","TresAmbientLight","warn","while (true) {}","model","table","toString","disableRender","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","test","3297342cIaHrJ","#ffffff","city","2ZAJoPd","autoRotate","bind","3327618mzOZRN","pagesShow","showBuildings","$slots","debu","builds","TresPerspectiveCamera","call","action","#000000","input","295720zwLZrP","console","TresCanvas","tcRef","TresDirectionalLight","constructor",'{}.constructor("return this")( )',"1268NBddLm","error","prototype","function *\\( *\\)"];return(st=function(){return t})()}const at=h({__name:ot(287),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(295),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(276)]}),u=_({autoRotate:r[n(284)],enableDamping:!0});let l=null;r.showBuildings&&([o,e]=C((()=>D())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I(e(299));return w(),x(c,P({ref_key:e(300),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(292),{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),R(b(p),O(S(u)),null,16),o[0]||(o[0]=T(e(270),{color:e(281)},null,-1)),o[1]||(o[1]=T(e(301),{position:[100,100,0],intensity:.5,color:e(281)},null,-1)),r[e(288)]&&b(l)?(w(),v(A,{key:0},[R(J,{model:b(l)},null,8,[e(273)]),R(tt,{builds:b(l)[e(282)],color:"#000"},null,8,[e(291)])],64)):j("",!0),B(t[e(289)],e(266)),r.showAxesHelper?(w(),v("TresAxesHelper",ut)):j("",!0),r.showGridHelper?(w(),v("TresGridHelper",ct)):j("",!0)])),_:3},16)}}});function lt(t){function n(t){const o=et;if("string"==typeof t)return function(t){}.constructor(o(272))[o(260)](o(263));1!==(""+t/t)[o(261)]||t%20==0?function(){return!0}[o(302)](o(290)+"gger")[o(293)](o(294)):function(){return!1}.constructor(o(290)+o(268)).apply(o(257)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{J as _,tt as a,at as b,D as l};
