{"version":3,"file":"reflectorRoundedBox.vue_vue_type_script_setup_true_lang.B0i-7O7p1767105581793.js","sources":["../../src/plugins/floor/components/reflectorRoundedBox.vue"],"sourcesContent":["<template>\n    <TresGroup>\n        <TresMesh :rotation-x=\"-Math.PI / 2\" :geometry=\"trbGeometry\">\n            <MeshReflectionMaterial\n                :color=\"color\"\n                v-bind=\"reflectionMaterialConfig\"\n                :roughness=\"roughness\"\n                :metalness=\"metalness\"\n                :reflectorOffset=\"reflectorOffset\"\n                :mix=\"mix\"\n                :sharpMix=\"sharpMix\"\n            />\n        </TresMesh>\n    </TresGroup>\n</template>\n\n<script setup lang=\"ts\">\nimport { watch, ref } from 'vue'\nimport * as THREE from 'three'\nimport { RoundedBoxGeometry } from 'three/examples/jsm/geometries/RoundedBoxGeometry'\nimport { extend } from '@tresjs/core'\nimport MeshReflectionMaterial from 'PLS/basic/components/forCientos/meshReflectionMaterial/index.vue'\n// import { MeshReflectionMaterial } from '@tresjs/cientos'\n\nconst props = withDefaults(\n    defineProps<{\n        color?: string\n        width?: number\n        height?: number\n        depth?: number\n        radius?: number\n        roughness?: number\n        metalness?: number\n        reflectorOffset?: number\n        mix?: number\n        sharpMix?: number\n    }>(),\n    {\n        color: '#FFFFFF',\n        width: 2,\n        height: 1,\n        depth: 1,\n        radius: 0.1, // 圆角半径\n        roughness: 0.5,\n        metalness: 0.6,\n        reflectorOffset: 0.1,\n        mix: 0.1,\n        sharpMix: 1,\n    },\n)\nextend({ RoundedBoxGeometry })\n\nconst trbGeometry = ref(null) as any\ntrbGeometry.value = new RoundedBoxGeometry(props.width, props.height, props.depth, props.radius)\n\nwatch(\n    () => [props.width, props.height, props.depth, props.radius],\n    ([width, height, depth, radius, smoothness]) => {\n        if (trbGeometry.value) {\n            trbGeometry.value.dispose()\n            trbGeometry.value = new RoundedBoxGeometry(width, height, depth, 4, radius)\n            trbGeometry.value.applyMatrix4(new THREE.Matrix4().makeRotationX(Math.PI / 2))\n            // trbGeometry.value.computeVertexNormals()\n            // trbGeometry.value.attributes.normal.needsUpdate = true\n            // trbGeometry.value.normalizeNormals() // 强制归一化\n            // // trbGeometry.value.computeTangents?.() // 如支持切线，尽量计算\n        }\n    },\n    { immediate: true },\n)\n\n// const pTexture = await useTexture(['./plugins/floor/image/polished_concrete_basecolor.jpg', './plugins/floor/image/waterdudv.jpg'])\n// for (let i = 0; i < pTexture.length; i++) {\n//     pTexture[i].colorSpace = THREE.LinearSRGBColorSpace\n//     pTexture[i].wrapS = THREE.RepeatWrapping\n//     pTexture[i].wrapT = THREE.RepeatWrapping\n//     pTexture[i].magFilter = THREE.LinearFilter\n//     pTexture[i].minFilter = THREE.LinearMipmapLinearFilter\n//     pTexture[i].repeat.set(1, 1)\n// }\n\nconst reflectionMaterialConfig = {\n    resolution: 1024,\n    blurDepthScale: 0.1,\n    // map: pTexture[0],\n    // normalMap: pTexture[1],\n    // normalScale: new THREE.Vector2(0.6, 0.6),\n    // normalMapType: THREE.ObjectSpaceNormalMap,\n}\n</script>\n"],"names":["extend","MeshReflectionMaterial","color","roughness","metalness","reflectorOffset","mix","sharpMix"],"mappings":"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"}