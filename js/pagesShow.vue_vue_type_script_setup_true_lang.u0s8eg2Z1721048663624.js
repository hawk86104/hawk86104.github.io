import{a5 as t,ca as n,cb as o,cc as e,cd as r,C as i,k as u,bR as s,aa as c,bS as a}from"./three.HEgnMaTu1721048663624.js";import{f as l,r as f,d as p}from"./@tresjs.Xiq_TH801721048663624.js";import{C as d}from"./three-custom-shader-material.AmV1WVUo1721048663624.js";import"./object-hash.E5Z0NA4F1721048663624.js";import"./@amap.IXBtourJ1721048663624.js";import"./glsl-tokenizer.bhImRDDx1721048663624.js";import{d as h,b as m,a2 as y,w as g,o as w,D as v,u as b,r as C,a3 as _,e as I,f as x,g as M,J as T,j as S,aj as j,ak as O,F as R,I as z,G as A,m as B}from"./@vue.ApkyOKE71721048663624.js";function E(t,n){const o=G();return(E=function(t,n){return o[t-=165]})(t,n)}!function(t,n){const o=E,e=G();for(;;)try{if(498238===-parseInt(o(205))/1*(-parseInt(o(190))/2)+parseInt(o(167))/3*(-parseInt(o(207))/4)+-parseInt(o(175))/5+parseInt(o(184))/6+-parseInt(o(187))/7+parseInt(o(172))/8*(-parseInt(o(171))/9)+parseInt(o(185))/10*(parseInt(o(177))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){L(this,(function(){const t=E,n=new RegExp(t(191)),o=new RegExp(t(200),"i"),e=F(t(186));n[t(201)](e+t(204))&&o[t(201)](e+t(169))?F():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(192)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(){const t=["counter","5433SlVLQQ","call","input","trace","27ZuXesM","1687184fJODhG","error","length","2249450HaICnx","toString","3384931hyfiVs","table","info","warn","stateObject","action","ROADS","3578508VONpIa","30EKVILC","init","475209MmLfoO","string","bind","128342SWnvxK","function *\\( *\\)","apply","exception","return (function() ",'{}.constructor("return this")( )',"name","console","prototype","log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","test","gger","while (true) {}","chain","3MhxgSq","constructor","140rEspfp","__proto__","traverse"];return(G=function(){return t})()}k(void 0,(function(){const t=E;let n;try{n=Function(t(194)+t(195)+");")()}catch(r){n=window}const o=n[t(197)]=n[t(197)]||{},e=[t(199),t(180),t(179),t(173),t(193),t(178),t(170)];for(let i=0;i<e[t(174)];i++){const n=k[t(206)][t(198)][t(189)](k),r=e[i],u=o[r]||n;n[t(208)]=k[t(189)](k),n[t(176)]=u[t(176)][t(189)](u),o[r]=n}}))();const D=async()=>{const t=E,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(165)]((n=>{const i=t;"CITY_UNTRIANGULATED"===n[i(196)]&&(o=n),"LANDMASS"===n[i(196)]&&(e=n),n[i(196)]===i(183)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function F(t){function n(t){const o=E;if(typeof t===o(188))return function(t){}[o(206)](o(203))[o(192)](o(166));1!==(""+t/t)[o(174)]||t%20==0?function(){return!0}[o(206)]("debu"+o(202))[o(168)](o(182)):function(){return!1}[o(206)]("debu"+o(202))[o(192)](o(181)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function H(){const t=["init","toString","string","2484835JpqymL","14333tzOqiz","opacity","40gTmFFG","log","topColor","city","boundingBox","info","call","debu","action","counter","trace","uniforms","uColor","length","constructor","DoubleSide","__proto__","#ffff00","3039168uFjkEY","#ffffff","console","isArray","3812792EijOZE","side","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uGradient","#112233","function *\\( *\\)","model","Color","78tKSYva","bind","stateObject","table","apply","input","709499MYKSEa","15073695qUhIMf","bulidingsColor","landColor","exception","test","setStyle","error","forEach","gger","material","1779640xzykVQ","return (function() ","gradient","value","buildingsModelCustomShader","uOpacity","primitive","land","dispose","prototype","warn","__csm","chain"];return(H=function(){return t})()}const P=$;!function(t,n){const o=$,e=H();for(;;)try{if(730118===-parseInt(o(424))/1*(parseInt(o(426))/2)+-parseInt(o(444))/3+parseInt(o(448))/4+parseInt(o(423))/5+-parseInt(o(456))/6*(parseInt(o(462))/7)+parseInt(o(407))/8+parseInt(o(463))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(460)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){W(this,(function(){const t=$,n=new RegExp(t(453)),o=new RegExp(t(450),"i"),e=U(t(420));n[t(467)](e+t(419))&&o[t(467)](e+t(461))?U():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(460)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(t,n){const o=H();return($=function(t,n){return o[t-=406]})(t,n)}Z(void 0,(function(){const t=$,n=function(){const t=$;let n;try{n=Function(t(408)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(446)]=n[t(446)]||{},e=[t(427),t(417),t(431),t(469),t(466),t(459),t(436)];for(let r=0;r<e[t(439)];r++){const n=Z[t(440)][t(416)][t(457)](Z),i=e[r],u=o[i]||n;n[t(442)]=Z[t(457)](Z),n[t(421)]=u[t(421)][t(457)](u),o[i]=n}}))();const q=["object"],V=h({__name:P(411),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:P(452)},topColor:{default:P(443)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=P,e=n,r=m(0),i=e[o(454)][o(429)];i.renderOrder=1001;const u=e[o(454)].land;(()=>{const n=o,{geometry:u}=i;u.computeBoundingBox(),u.computeBoundingSphere();const{max:s,min:c}=u[n(430)];if(i[n(406)][n(418)])return;const a=new d({baseMaterial:i[n(406)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:c},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(455)])(e.bulidingsColor)},uOpacity:{value:e[n(425)]},uLightColor:{value:new(t[n(455)])(n(445))},uTopColor:{value:new(t[n(455)])(e[n(428)])},uTime:r,uGradient:{value:e[n(409)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(441)]});i[n(406)][n(415)](),i.material=a})();const{onLoop:s}=f();s((({delta:t})=>{r.value+=t})),y((()=>{const n=o;e.bulidingsColor&&i.material.uniforms[n(438)][n(410)][n(468)](e[n(464)]),e[n(465)]&&((n,r)=>{const i=o;let s;"cu"===n||n===i(414)&&(s=Array[i(447)](u[i(406)])?u[i(406)]:[u[i(406)]],s[i(470)]((n=>{const o=i;n[r][o(468)](e[o(465)]),n[o(449)]=t[o(441)]})))})("land","color"),e[n(425)]&&(i[n(406)][n(437)][n(412)][n(410)]=e[n(425)])})),g(e,((t,n)=>{const e=o;i[e(406)][e(437)][e(451)].value=t[e(409)]}));const c=e[o(454)][o(454)].clone();return(t,n)=>{const e=o;return w(),v(e(413),{object:b(c)},null,8,q)}}});function U(t){function n(t){const o=$;if(typeof t===o(422))return function(t){}[o(440)]("while (true) {}")[o(460)](o(435));1!==(""+t/t).length||t%20==0?function(){return!0}[o(440)](o(433)+o(471))[o(432)](o(434)):function(){return!1}[o(440)](o(433)+"gger")[o(460)](o(458)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Q=N;!function(t,n){const o=N,e=X();for(;;)try{if(760521===parseInt(o(308))/1*(-parseInt(o(323))/2)+parseInt(o(327))/3+-parseInt(o(339))/4*(parseInt(o(345))/5)+-parseInt(o(334))/6+parseInt(o(349))/7+parseInt(o(346))/8*(parseInt(o(325))/9)+-parseInt(o(300))/10*(-parseInt(o(357))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(316)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Y(this,(function(){const t=N,n=new RegExp(t(304)),o=new RegExp(t(310),"i"),e=nt(t(326));n[t(314)](e+t(359))&&o.test(e+t(360))?nt():e("0")}))()}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(316)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();J(void 0,(function(){const t=N,n=function(){const t=N;let n;try{n=Function(t(338)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(361)]=n.console||{},e=["log",t(329),t(355),t(343),t(313),t(303),t(318)];for(let r=0;r<e[t(330)];r++){const n=J.constructor[t(321)][t(306)](J),i=e[r],u=o[i]||n;n[t(353)]=J[t(306)](J),n[t(333)]=u[t(333)][t(306)](u),o[i]=n}}))();const K=["object"];function N(t,n){const o=X();return(N=function(t,n){return o[t-=297]})(t,n)}function X(){const t=["action","790Uoizhs","renderOrder","debu","table","function *\\( *\\)","linewidth","bind","stateObject","187VPHnCy","material","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","clone","Wireframe","exception","test","uColor","apply","string","trace","#FFF","while (true) {}","prototype","set","11980lCRjCa","geometry","18ExWTva","init","1338384bkikAF","primitive","warn","length","style","width","toString","2990640YWHdGh","builds","constructor","applyMatrix4","return (function() ","25136vRHwyj","innerWidth","value","opacity","error","resolution","1180uBuoOn","3112808vjTSDm","matrix","gger","473193ooGITo","counter","innerHeight","color","__proto__","uOpacity","info","call","357874eTqJSQ","buildingsLines","chain","input","console","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","fromEdgesGeometry"];return(X=function(){return t})()}const tt=h({__name:Q(358),props:{builds:{},width:{default:1},color:{default:Q(319)},opacity:{default:1},style:{default:Q(312)}},setup(t){const s=Q,c=t;let a=null,l=null;if(c[s(331)]===s(312)){const t=new n(c[s(335)][s(324)]);let i=(new o)[s(298)](t),u=new e({color:c[s(352)],linewidth:c[s(332)],opacity:c.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[s(344)][s(322)](window[s(340)],window[s(351)]),a=new r(i,u),a[s(337)](c[s(335)][s(347)][s(311)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(c[s(352)])},uOpacity:{value:c[s(342)]}},vertexShader:s(297),fragmentShader:" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const t=new n(c.builds[s(324)]),o=new u(l);a=new LineSegments(t,o),a[s(337)](c[s(335)][s(347)][s(311)]()),a.material[s(305)]=c[s(332)],a[s(301)]=1e3}return y((()=>{const t=s;"Shader"===c.style&&(c[t(352)]&&(l.uniforms[t(315)][t(341)]=new i(c[t(352)])),c[t(342)]&&(l.uniforms[t(354)][t(341)]=c[t(342)])),c[t(331)]===t(312)&&(c[t(352)]&&(a.material[t(352)]=new i(c[t(352)])),c.opacity&&(a[t(309)][t(342)]=c[t(342)])),c[t(332)]&&(a.material[t(305)]=c.width)})),(t,n)=>{const o=s;return w(),v(o(328),{object:b(a)},null,8,K)}}});function nt(t){function n(t){const o=N;if(typeof t===o(317))return function(t){}[o(336)](o(320))[o(316)](o(350));1!==(""+t/t)[o(330)]||t%20==0?function(){return!0}[o(336)]("debu"+o(348))[o(356)](o(299)):function(){return!1}.constructor(o(302)+o(348))[o(316)](o(307)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=lt;function et(){const t=["chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","table","input","while (true) {}","city","init","TresCanvas","console","#ffffff","19640RDwytz","ability","prototype","__proto__","showBuildings","728982VkPzMg","TresAmbientLight","TresGridHelper","662uxGLCz","trace","#000000","TresAxesHelper","showAxesHelper","10zUsKWo","call","exception","tcRef","length","info","builds","gger","64Gqlhjd","#000","728OyCJPh","2570950gBjBtD","counter","function *\\( *\\)","291CQUTBL","apply","debu","constructor","toString","model","bind","9426xAQHvT","perspectiveCameraRef","5030795zqIqiF","disableRender","test",'{}.constructor("return this")( )',"15425509wYhpSz","showGridHelper"];return(et=function(){return t})()}!function(t,n){const o=lt,e=et();for(;;)try{if(360427===parseInt(o(408))/1*(-parseInt(o(393))/2)+-parseInt(o(412))/3*(parseInt(o(385))/4)+-parseInt(o(398))/5*(-parseInt(o(419))/6)+-parseInt(o(421))/7+parseInt(o(406))/8*(parseInt(o(390))/9)+-parseInt(o(409))/10+parseInt(o(373))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(413)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=lt,n=new RegExp(t(411)),o=new RegExp(t(376),"i"),e=pt(t(381));n[t(423)](e+t(375))&&o[t(423)](e+t(378))?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(413)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=lt;let n;try{n=Function("return (function() "+t(424)+");")()}catch(r){n=window}const o=n[t(383)]=n[t(383)]||{},e=["log","warn",t(403),"error",t(400),t(377),t(394)];for(let i=0;i<e[t(402)];i++){const n=it[t(415)][t(387)][t(418)](it),r=e[i],u=o[r]||n;n[t(388)]=it[t(418)](it),n[t(416)]=u.toString[t(418)](u),o[r]=n}}))();const ut=T(ot(391),{color:ot(384)},null,-1),st=T("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(t,n){const o=et();return(lt=function(t,n){return o[t-=373]})(t,n)}const ft=h({__name:"pagesShow",props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=C({clearColor:n(395),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:c,toneMapping:a,disableRender:r[n(422)]}),u=C({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r.showBuildings&&([o,e]=_((()=>D())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,s=I(e(382));return w(),x(s,B({ref_key:e(401),ref:d},i,{"window-size":""}),{default:M((()=>[T("TresPerspectiveCamera",{ref_key:e(420),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(p),j(O(u)),null,16),ut,st,r[e(389)]&&b(l)?(w(),v(R,{key:0},[S(V,{model:b(l)},null,8,[e(417)]),S(tt,{builds:b(l)[e(380)],color:e(407)},null,8,[e(404)])],64)):z("",!0),A(t.$slots,e(386)),r[e(397)]?(w(),v(e(396),ct)):z("",!0),r[e(374)]?(w(),v(e(392),at)):z("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=lt;if("string"==typeof t)return function(t){}.constructor(o(379))[o(413)](o(410));1!==(""+t/t)[o(402)]||t%20==0?function(){return!0}.constructor("debu"+o(405))[o(399)]("action"):function(){return!1}.constructor(o(414)+"gger")[o(413)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as _,tt as a,ft as b,D as l};
