import{a5 as t,C as n,ca as o,cb as e,cc as r,cd as i,k as u,bR as c,aa as s,bS as a}from"./three.erXpfL-r1718698100638.js";import{f as l,r as f,d as p}from"./@tresjs.aawOCoPx1718698100638.js";import{C as d}from"./three-custom-shader-material.tCYfd9sl1718698100638.js";import"./object-hash.SpRbwitp1718698100638.js";import"./@amap.TW6HTmRb1718698100638.js";import"./glsl-tokenizer.RLlRtTA81718698100638.js";import{d as h,b as m,a2 as y,w as g,o as w,D as v,u as b,r as _,a3 as I,e as C,f as x,g as M,J as j,j as S,aj as T,ak as R,F as A,I as O,G as E,m as k}from"./@vue.CpOXM7bB1718698100638.js";function z(){const t=["14634KLqWdm","warn","string","7600CowPsq","1296823vgVhlz","318Zdrggj","bind","toString","ROADS","name","length","285HSnHbU","12354474LINjPG","constructor","138615lMEAqQ","gger","prototype","error","function *\\( *\\)","LANDMASS","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","stateObject","info","39492IHLRdE","action","return (function() ","trace","14791ykEEVX","CITY_UNTRIANGULATED","call","__proto__","1944acauqN","log","debu","736776orfdfE","input","apply","counter","test","table"];return(z=function(){return t})()}!function(t,n){const o=L,e=z();for(;;)try{if(797884===parseInt(o(355))/1+-parseInt(o(386))/2+-parseInt(o(362))/3*(-parseInt(o(375))/4)+parseInt(o(365))/5*(-parseInt(o(356))/6)+parseInt(o(379))/7*(parseInt(o(383))/8)+parseInt(o(351))/9*(-parseInt(o(354))/10)+parseInt(o(363))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(388)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=L,n=new RegExp(t(369)),o=new RegExp(t(371),"i"),e=P("init");n.test(e+"chain")&&o[t(349)](e+t(387))?P():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(388)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();D(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(377)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=[t(384),t(352),t(374),t(368),"exception",t(350),t(378)];for(let r=0;r<e.length;r++){const n=D[t(364)][t(367)][t(357)](D),i=e[r],u=o[i]||n;n[t(382)]=D[t(357)](D),n[t(358)]=u[t(358)].bind(u),o[i]=n}}))();const H=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=L;t[r(360)]===r(380)&&(n=t),t[r(360)]===r(370)&&(o=t),t[r(360)]===r(359)&&(e=t)})),{model:t,city:n,land:o,roads:e}};function L(t,n){const o=z();return(L=function(t,n){return o[t-=348]})(t,n)}function P(t){function n(t){const o=L;if(typeof t===o(353))return function(t){}[o(364)](o(372))[o(388)](o(348));1!==(""+t/t)[o(361)]||t%20==0?function(){return!0}[o(364)](o(385)+o(366))[o(381)](o(376)):function(){return!1}[o(364)](o(385)+o(366))[o(388)](o(373)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=V;!function(t,n){const o=V,e=N();for(;;)try{if(125493===-parseInt(o(292))/1*(-parseInt(o(295))/2)+-parseInt(o(312))/3+-parseInt(o(299))/4+parseInt(o(310))/5+-parseInt(o(271))/6+-parseInt(o(302))/7*(-parseInt(o(287))/8)+-parseInt(o(297))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(284)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=V,n=new RegExp(t(305)),o=new RegExp(t(306),"i"),e=$(t(279));n[t(323)](e+t(315))&&o[t(323)](e+"input")?$():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(284)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();W(void 0,(function(){const t=V,n=function(){const t=V;let n;try{n=Function(t(311)+t(294)+");")()}catch(o){n=window}return n}(),o=n[t(326)]=n.console||{},e=[t(301),t(309),"info",t(329),"exception",t(322),t(320)];for(let r=0;r<e[t(308)];r++){const n=W.constructor[t(328)][t(290)](W),i=e[r],u=o[i]||n;n[t(270)]=W[t(290)](W),n[t(277)]=u[t(277)][t(290)](u),o[i]=n}}))();const F=["object"];function N(){const t=["bind","land","74iHwhag","color",'{}.constructor("return this")( )',"2438NFjrua","topColor","493794JcVQNv","__csm","58436eEDXwt","Color","log","14jNuoDP","side","while (true) {}","function *\\( *\\)","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uniforms","length","warn","340120uoWlNS","return (function() ","189012nlEQZY","dispose","#ffff00","chain","forEach","boundingBox","counter","debu","trace","gger","table","test","constructor","action","console","landColor","prototype","error","setStyle","stateObject","primitive","renderOrder","bulidingsColor","isArray","city","__proto__","224136pXtztD","value","opacity","string","uGradient","computeBoundingSphere","toString","computeBoundingBox","init","#e523ff","buildingsModelCustomShader","DoubleSide","call","apply","clone","material","548392qUkHRj","gradient","model"];return(N=function(){return t})()}function V(t,n){const o=N();return(V=function(t,n){return o[t-=267]})(t,n)}const q=h({__name:G(281),props:{model:{},bulidingsColor:{default:G(280)},landColor:{default:"#112233"},topColor:{default:G(314)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=G,r=o,i=m(0),u=r.model[e(269)];u[e(333)]=1001;const c=r[e(289)].land;(()=>{const o=e,{geometry:c}=u;c[o(278)](),c[o(276)]();const{max:s,min:a}=c[o(317)];if(u[o(286)][o(298)])return;const l=new d({baseMaterial:u.material,vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(300)])(r[o(267)])},uOpacity:{value:r[o(273)]},uLightColor:{value:new n("#ffffff")},uTopColor:{value:new(t[o(300)])(r[o(296)])},uTime:i,uGradient:{value:r[o(288)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(282)]});u.material[o(313)](),u[o(286)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(272)]+=t})),y((()=>{const n=e;r[n(267)]&&u[n(286)].uniforms.uColor[n(272)][n(330)](r[n(267)]),r[n(327)]&&((n,o)=>{const i=e;let u;"cu"===n||"land"===n&&(u=Array[i(268)](c[i(286)])?c[i(286)]:[c[i(286)]],u[i(316)]((n=>{const e=i;n[o][e(330)](r[e(327)]),n[e(303)]=t[e(282)]})))})(n(291),n(293)),r[n(273)]&&(u[n(286)][n(307)].uOpacity[n(272)]=r[n(273)])})),g(r,((t,n)=>{const o=e;u[o(286)][o(307)][o(275)].value=t.gradient}));const a=r[e(289)][e(289)][e(285)]();return(t,n)=>{const o=e;return w(),v(o(332),{object:b(a)},null,8,F)}}});function $(t){function n(t){const o=V;if(typeof t===o(274))return function(t){}.constructor(o(304))[o(284)](o(318));1!==(""+t/t)[o(308)]||t%20==0?function(){return!0}[o(324)]("debu"+o(321))[o(283)](o(325)):function(){return!1}.constructor(o(319)+o(321)).apply(o(331)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const U=J;!function(t,n){const o=J,e=Q();for(;;)try{if(927669===-parseInt(o(381))/1*(parseInt(o(386))/2)+parseInt(o(382))/3+-parseInt(o(387))/4*(-parseInt(o(361))/5)+-parseInt(o(354))/6+-parseInt(o(369))/7*(parseInt(o(392))/8)+-parseInt(o(379))/9+parseInt(o(393))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Q(){const t=["action","console","stateObject","builds","object","linewidth","Shader","306720sOAPkk","resolution","applyMatrix4","Wireframe","uniforms","uOpacity","matrix","835JntIZI","length","table","#FFF","clone","test","error","return (function() ","585634KDkUrs","primitive","color","gger","warn","bind","innerWidth","material","input","fromEdgesGeometry","8093745GdWxiV","toString","1777856qZQXJi","2533962KpaEqt","debu","renderOrder","trace","2yTlNQC","26932MoXzSr",'{}.constructor("return this")( )',"while (true) {}","width","apply","64aIyEeO","23561810wSOXkM","init","style","opacity","uColor","constructor","geometry"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","log","string","value","chain","info","__proto__"];return(Q=function(){return t})()}function J(t,n){const o=Q();return(J=function(t,n){return o[t-=335]})(t,n)}!function(){X(this,(function(){const t=J,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=nt(t(394));n[t(366)](e+t(344))&&o[t(366)](e+t(377))?nt():e("0")}))()}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();K(void 0,(function(){const t=J,n=function(){const t=J;let n;try{n=Function(t(368)+t(388)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(348)]||{},e=[t(341),t(373),t(345),t(367),"exception",t(363),t(385)];for(let r=0;r<e[t(362)];r++){const n=K.constructor.prototype[t(374)](K),i=e[r],u=o[i]||n;n[t(346)]=K[t(374)](K),n[t(380)]=u[t(380)][t(374)](u),o[i]=n}}))();const Y=[U(351)],tt=h({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:U(364)},opacity:{default:1},style:{default:U(357)}},setup(t){const c=U,s=t;let a=null,l=null;if("Wireframe"===s[c(335)]){const t=new o(s[c(350)].geometry);let n=(new e)[c(378)](t),u=new r({color:s[c(371)],linewidth:s.width,opacity:s[c(336)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(355)].set(window[c(375)],window.innerHeight),a=new i(n,u),a[c(356)](s[c(350)][c(360)][c(365)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(371)])},uOpacity:{value:s[c(336)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(340)};const t=new o(s[c(350)][c(339)]),e=new u(l);a=new LineSegments(t,e),a[c(356)](s.builds[c(360)][c(365)]()),a[c(376)][c(352)]=s[c(390)],a[c(384)]=1e3}return y((()=>{const t=c;s.style===t(353)&&(s.color&&(l.uniforms[t(337)][t(343)]=new n(s[t(371)])),s[t(336)]&&(l[t(358)][t(359)][t(343)]=s[t(336)])),s[t(335)]===t(357)&&(s.color&&(a[t(376)][t(371)]=new n(s[t(371)])),s.opacity&&(a[t(376)][t(336)]=s[t(336)])),s[t(390)]&&(a[t(376)][t(352)]=s.width)})),(t,n)=>{const o=c;return w(),v(o(370),{object:b(a)},null,8,Y)}}});function nt(t){function n(t){const o=J;if(typeof t===o(342))return function(t){}[o(338)](o(389)).apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(338)](o(383)+o(372)).call(o(347)):function(){return!1}[o(338)](o(383)+o(372))[o(391)](o(349)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=ft;!function(t,n){const o=ft,e=at();for(;;)try{if(528496===parseInt(o(391))/1+parseInt(o(378))/2*(-parseInt(o(367))/3)+parseInt(o(372))/4+parseInt(o(376))/5+-parseInt(o(353))/6*(-parseInt(o(351))/7)+-parseInt(o(385))/8*(parseInt(o(347))/9)+-parseInt(o(355))/10*(parseInt(o(382))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(344)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=ft,n=new RegExp(t(345)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=pt(t(386));n.test(e+t(357))&&o[t(348)](e+t(371))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(344)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=ft;let n;try{n=Function(t(366)+t(361)+");")()}catch(r){n=window}const o=n[t(362)]=n[t(362)]||{},e=[t(352),t(384),"info",t(380),"exception",t(365),t(340)];for(let i=0;i<e[t(379)];i++){const n=rt[t(363)][t(375)][t(364)](rt),r=e[i],u=o[r]||n;n[t(370)]=rt[t(364)](rt),n.toString=u[t(354)][t(364)](u),o[r]=n}}))();const it=j(ot(392),{color:ot(358)},null,-1),ut=j("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:ot(358)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(){const t=["4580770VjsGSq","showAxesHelper","31802XCfVBR","length","error","builds","18845123TzRbeI","#000000","warn","80Vljxoq","init","gger","ability","TresAxesHelper","disableRender","538936KMbWCC","TresAmbientLight","while (true) {}","trace","model","debu","autoRotate","apply","function *\\( *\\)","action","543852PjAvzI","test","pagesShow","TresPerspectiveCamera","14hHAoNR","log","1645746xkaZUp","toString","10zdUwzC","stateObject","chain","#ffffff","city","TresGridHelper",'{}.constructor("return this")( )',"console","constructor","bind","table","return (function() ","9VbSHDI","perspectiveCameraRef","showBuildings","__proto__","input","3560000VBLytS","showGridHelper","$slots","prototype"];return(at=function(){return t})()}const lt=h({__name:ot(349),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(383),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(390)]}),u=_({autoRotate:r[n(343)],enableDamping:!0});let l=null;r[n(369)]&&([o,e]=I((()=>H())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,k({ref_key:"tcRef",ref:d},i,{"window-size":""}),{default:M((()=>[j(e(350),{ref_key:e(368),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(p),T(R(u)),null,16),it,ut,r[e(369)]&&b(l)?(w(),v(A,{key:0},[S(q,{model:b(l)},null,8,[e(341)]),S(tt,{builds:b(l)[e(359)],color:"#000"},null,8,[e(381)])],64)):O("",!0),E(t[e(374)],e(388)),r[e(377)]?(w(),v(e(389),ct)):O("",!0),r[e(373)]?(w(),v(e(360),st)):O("",!0)])),_:3},16)}}});function ft(t,n){const o=at();return(ft=function(t,n){return o[t-=340]})(t,n)}function pt(t){function n(t){const o=ft;if("string"==typeof t)return function(t){}[o(363)](o(393))[o(344)]("counter");1!==(""+t/t)[o(379)]||t%20==0?function(){return!0}[o(363)](o(342)+"gger").call(o(346)):function(){return!1}[o(363)](o(342)+o(387))[o(344)](o(356)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{q as _,tt as a,lt as b,H as l};
