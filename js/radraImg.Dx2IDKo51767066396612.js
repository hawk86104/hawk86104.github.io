import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as t,K as a}from"./@tresjs.B1f7s3pS1767066396612.js";import{$ as r,p as n,e as o}from"./three-tile.D9ZubqJI1767066396612.js";import{a as i,c as l,s,i as p}from"./informationDiv.zYrf_U5j1767066396612.js";import{i as m}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.DS9PWjZT1767066396612.js";import"./index.vue_vue_type_script_setup_true_lang.iYOGhvYh1767066396612.js";import{P as c}from"./tweakpane.CqZAnw7f1767066396612.js";const{withAsyncContext:u,defineComponent:d}=await e("vue"),{unref:h,createElementVNode:g,openBlock:v,createElementBlock:f}=await e("vue"),w=["position"],y=["scale","material","rotateX","position-y"],x=await e("three"),{watch:_}=await e("vue"),S=d({__name:"radraImgShow",props:{map:{},height:{default:100},opacity:{default:.6}},async setup(e){let t,a;const r=e,n=new x.MeshPhongMaterial({displacementMap:new x.Texture,transparent:!0,side:x.DoubleSide,opacity:r.opacity,displacementScale:.5,displacementBias:0});n.onBeforeCompile=e=>{e.vertexShader="uniform sampler2D map;\n\t"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","transformed += normalize( objectNormal ) * ( texture2D(map, vMapUv ).a * displacementScale + displacementBias );")};const o=r.map.geo2pos(new x.Vector3(105,34,0));o.applyMatrix4(r.map.matrix);const l=i(r.map,{x:67,y:11},{x:140,y:57},1e3*r.height),s=[];for(let i=0;i<9;i++)s.push(`https://opensource.cdn.icegl.cn/images/simpleGIS/QPFRef_202405311${i}40.png`);let p=0;const c=([t,a]=u(()=>m(s)),t=await t,a(),t);n.map=c[p],_(()=>[r.color,r.opacity],([e,t])=>{n.opacity=t});let d=null,S=!1;return S?(clearInterval(d),d=null,S=!1):(d=setInterval(()=>{p=p<s.length-1?p+1:0,n.map=c[p],n.needsUpdate=!0,console.log(p)},1e3),S=!0),(e,t)=>(v(),f("TresGroup",{position:[...h(o)]},[g("TresMesh",{scale:[h(l).x,h(l).y,1e3*e.height],material:h(n),rotateX:-Math.PI/2,renderOrder:9999,"position-y":1e3*e.height/5},[...t[0]||(t[0]=[g("TresPlaneGeometry",{args:[1,1,529,420]},null,-1)])],8,y)],8,w))}}),{defineComponent:b}=await e("vue"),{createElementVNode:B,unref:T,mergeProps:j,createVNode:k,Suspense:P,withCtx:C,openBlock:I,createBlock:M,Fragment:D,createElementBlock:E}=await e("vue"),N=["object"],{watch:V,ref:z,reactive:F}=await e("vue"),L=await e("three"),G="pk.eyJ1IjoiaGF3azg2MTA0IiwiYSI6ImNrbTQ3cWtyeTAxejEzMHBtcW42bmc0N28ifQ.bvS9U_yWdHDh41jzaDS1dw",W=b({__name:"mapBoxShow3",setup(e){const a=F({height:200,opacity:1}),i=new c({title:"参数"});i.addBinding(a,"height",{label:"高度",min:10,max:300,step:1}),i.addBinding(a,"opacity",{label:"透明度",min:0,max:1,step:.1}),new r({token:G,dataType:"image",style:"mapbox.satellite"}),new r({token:G,dataType:"terrain-rgb",style:"mapbox.terrain-rgb",maxLevel:15});const p=new n({imgSource:[new o({style:"6"}),new o({style:"8"})],lon0:90,minLevel:2,maxLevel:20});p.rotateX(-Math.PI/2);const m=new L.Vector3(105,34,0),u=new L.Vector3(110,0,1e7),d=p.localToWorld(p.geo2map(m)),h=p.localToWorld(p.geo2map(u)),g=z(),{camera:v,controls:f,scene:w,renderer:y}=t();return v.value&&v.value.position.copy(h),V(()=>f.value,e=>{e&&(e.target.copy(d),l(e,v.value,w.value))}),V(()=>g.value,e=>{e&&e.target.position.copy(d)}),s(v.value,y.domElement,p),(e,t)=>(I(),E(D,null,[B("TresDirectionalLight",{ref_key:"tdLight",ref:g,position:[0,2e3,1e3],intensity:1},null,512),B("primitive",{object:T(p)},null,8,N),(I(),M(P,null,{default:C(()=>[k(S,j({map:T(p)},a),null,16,["map"])]),_:1}))],64))}}),{defineComponent:A}=await e("vue"),{createElementVNode:Q,unref:R,normalizeProps:U,guardReactiveProps:X,createVNode:H,resolveComponent:K,mergeProps:$,withCtx:J,Fragment:O,openBlock:Y,createElementBlock:q}=await e("vue"),{reactive:Z}=await e("vue"),ee=A({__name:"radraImg",setup(e){const t=Z({clearColor:"#dbf0ff",alpha:!0,antialias:!1,logarithmicDepthBuffer:!0,precision:"highp"}),r=Z({enableDamping:!0,makeDefault:!0,screenSpacePanning:!1,dampingFactor:.035,keyPanSpeed:5});return(e,n)=>{const o=K("TresCanvas");return Y(),q(O,null,[H(o,$(t,{"window-size":""}),{default:J(()=>[n[0]||(n[0]=Q("TresPerspectiveCamera",{position:[0,12,0],fov:70,near:.1,far:4e10},null,-1)),H(R(a),U(X(r)),null,16),n[1]||(n[1]=Q("TresAmbientLight",{intensity:1},null,-1)),H(W)]),_:1},16),H(p)],64)}}});export{ee as default};
