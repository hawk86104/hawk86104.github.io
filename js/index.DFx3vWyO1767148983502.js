import{importShared as Z}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import"./vanilla-BEVDQrzM.Dj-0RQjc1767148983502.js";import"./three-custom-shader-material.es.DIiohWIA1767148983502.js";import"./skyBoxAmesh.vue_vue_type_script_setup_true_lang.R4i3IxUx1767148983502.js";import"./skyBoxBmesh.vue_vue_type_script_setup_true_lang.D7En_9kn1767148983502.js";import"./skyBoxDmesh.vue_vue_type_script_setup_true_lang.ByNLPS1R1767148983502.js";import{zr as On,Fs as Rn}from"./index.DTe2qqjO1767148983502.js";import{unzlibSync as ue}from"./Resource.DwxffO9V1767148983502.js";import{version as Bn}from"./constants.D4Rj9O5x1767148983502.js";import{loadHDR as Dn}from"./utils.CnaizVLM1767148983502.js";const{Mesh:Pn,IcosahedronGeometry:Fn,ShaderMaterial:Ln,DoubleSide:Zn}=await Z("three"),Hn=Y=>Y&&Y.isCubeTexture;class zn extends Pn{constructor(C,B){var M,D;const g=Hn(C),K=((D=g?(M=C.image[0])==null?void 0:M.width:C.image.width)!=null?D:1024)/4,ie=Math.floor(Math.log2(K)),le=Math.pow(2,ie),ge=3*Math.max(le,16*7),ye=4*le,Se=[g?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/ge}`,`#define CUBEUV_TEXEL_HEIGHT ${1/ye}`,`#define CUBEUV_MAX_MIP ${ie}.0`],Ce=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,Ie=Se.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Bn>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,Ue={map:{value:C},height:{value:B?.height||15},radius:{value:B?.radius||100}},be=new Fn(1,16),xe=new Ln({uniforms:Ue,fragmentShader:Ie,vertexShader:Ce,side:Zn});super(be,xe)}set radius(C){this.material.uniforms.radius.value=C}get radius(){return this.material.uniforms.radius.value}set height(C){this.material.uniforms.height.value=C}get height(){return this.material.uniforms.height.value}}const{DataTextureLoader:Wn,DataUtils:Xe,FloatType:de,HalfFloatType:he,LinearFilter:Ge,LinearSRGBColorSpace:J,RedFormat:pe,RGFormat:se,RGBAFormat:ee}=await Z("three");class Yn extends Wn{constructor(C){super(C),this.type=he,this.outputFormat=ee}parse(C){const qe=Math.pow(2.7182818,2.2);function Ke(e,n){let t=0;for(let s=0;s<65536;++s)(s==0||e[s>>3]&1<<(s&7))&&(n[t++]=s);const r=t-1;for(;t<65536;)n[t++]=0;return r}function Ve(e){for(let n=0;n<16384;n++)e[n]={},e[n].len=0,e[n].lit=0,e[n].p=null}const z={l:0,c:0,lc:0};function Ae(e,n,t,r,s){for(;t<e;)n=n<<8|He(r,s),t+=8;t-=e,z.l=n>>t&(1<<e)-1,z.c=n,z.lc=t}const te=new Array(59);function Je(e){for(let t=0;t<=58;++t)te[t]=0;for(let t=0;t<65537;++t)te[e[t]]+=1;let n=0;for(let t=58;t>0;--t){const r=n+te[t]>>1;te[t]=n,n=r}for(let t=0;t<65537;++t){const r=e[t];r>0&&(e[t]=r|te[r]++<<6)}}function Qe(e,n,t,r,s,a){const o=n;let u=0,l=0;for(;r<=s;r++){if(o.value-n.value>t)return!1;Ae(6,u,l,e,o);const i=z.l;if(u=z.c,l=z.lc,a[r]=i,i==63){if(o.value-n.value>t)throw new Error("Something wrong with hufUnpackEncTable");Ae(8,u,l,e,o);let c=z.l+6;if(u=z.c,l=z.lc,r+c>s+1)throw new Error("Something wrong with hufUnpackEncTable");for(;c--;)a[r++]=0;r--}else if(i>=59){let c=i-59+2;if(r+c>s+1)throw new Error("Something wrong with hufUnpackEncTable");for(;c--;)a[r++]=0;r--}}Je(a)}function Ne(e){return e&63}function Te(e){return e>>6}function je(e,n,t,r){for(;n<=t;n++){const s=Te(e[n]),a=Ne(e[n]);if(s>>a)throw new Error("Invalid table entry");if(a>14){const o=r[s>>a-14];if(o.len)throw new Error("Invalid table entry");if(o.lit++,o.p){const u=o.p;o.p=new Array(o.lit);for(let l=0;l<o.lit-1;++l)o.p[l]=u[l]}else o.p=new Array(1);o.p[o.lit-1]=n}else if(a){let o=0;for(let u=1<<14-a;u>0;u--){const l=r[(s<<14-a)+o];if(l.len||l.p)throw new Error("Invalid table entry");l.len=a,l.lit=n,o++}}}return!0}const X={c:0,lc:0};function fe(e,n,t,r){e=e<<8|He(t,r),n+=8,X.c=e,X.lc=n}const G={c:0,lc:0};function we(e,n,t,r,s,a,o,u,l){if(e==n){r<8&&(fe(t,r,s,a),t=X.c,r=X.lc),r-=8;let i=t>>r;if(i=new Uint8Array([i])[0],u.value+i>l)return!1;const c=o[u.value-1];for(;i-- >0;)o[u.value++]=c}else if(u.value<l)o[u.value++]=e;else return!1;G.c=t,G.lc=r}function Ee(e){return e&65535}function Me(e){const n=Ee(e);return n>32767?n-65536:n}const A={a:0,b:0};function Q(e,n){const t=Me(e),s=Me(n),a=t+(s&1)+(s>>1),o=a,u=a-s;A.a=o,A.b=u}function j(e,n){const t=Ee(e),r=Ee(n),s=t-(r>>1)&65535,a=r+s-32768&65535;A.a=a,A.b=s}function en(e,n,t,r,s,a,o){const u=o<16384,l=t>s?s:t;let i=1,c,p;for(;i<=l;)i<<=1;for(i>>=1,c=i,i>>=1;i>=1;){p=0;const h=p+a*(s-c),f=a*i,_=a*c,m=r*i,E=r*c;let v,S,U,T;for(;p<=h;p+=_){let I=p;const d=p+r*(t-c);for(;I<=d;I+=E){const N=I+m,k=I+f,x=k+m;u?(Q(e[I+n],e[k+n]),v=A.a,U=A.b,Q(e[N+n],e[x+n]),S=A.a,T=A.b,Q(v,S),e[I+n]=A.a,e[N+n]=A.b,Q(U,T),e[k+n]=A.a,e[x+n]=A.b):(j(e[I+n],e[k+n]),v=A.a,U=A.b,j(e[N+n],e[x+n]),S=A.a,T=A.b,j(v,S),e[I+n]=A.a,e[N+n]=A.b,j(U,T),e[k+n]=A.a,e[x+n]=A.b)}if(t&i){const N=I+f;u?Q(e[I+n],e[N+n]):j(e[I+n],e[N+n]),v=A.a,e[N+n]=A.b,e[I+n]=v}}if(s&i){let I=p;const d=p+r*(t-c);for(;I<=d;I+=E){const N=I+m;u?Q(e[I+n],e[N+n]):j(e[I+n],e[N+n]),v=A.a,e[N+n]=A.b,e[I+n]=v}}c=i,i>>=1}return p}function nn(e,n,t,r,s,a,o,u,l){let i=0,c=0;const p=o,h=Math.trunc(r.value+(s+7)/8);for(;r.value<h;)for(fe(i,c,t,r),i=X.c,c=X.lc;c>=14;){const _=i>>c-14&16383,m=n[_];if(m.len)c-=m.len,we(m.lit,a,i,c,t,r,u,l,p),i=G.c,c=G.lc;else{if(!m.p)throw new Error("hufDecode issues");let E;for(E=0;E<m.lit;E++){const v=Ne(e[m.p[E]]);for(;c<v&&r.value<h;)fe(i,c,t,r),i=X.c,c=X.lc;if(c>=v&&Te(e[m.p[E]])==(i>>c-v&(1<<v)-1)){c-=v,we(m.p[E],a,i,c,t,r,u,l,p),i=G.c,c=G.lc;break}}if(E==m.lit)throw new Error("hufDecode issues")}}const f=8-s&7;for(i>>=f,c-=f;c>0;){const _=n[i<<14-c&16383];if(_.len)c-=_.len,we(_.lit,a,i,c,t,r,u,l,p),i=G.c,c=G.lc;else throw new Error("hufDecode issues")}return!0}function ke(e,n,t,r,s,a){const o={value:0},u=t.value,l=L(n,t),i=L(n,t);t.value+=4;const c=L(n,t);if(t.value+=4,l<0||l>=65537||i<0||i>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const p=new Array(65537),h=new Array(16384);Ve(h);const f=r-(t.value-u);if(Qe(e,t,f,l,i,p),c>8*(r-(t.value-u)))throw new Error("Something wrong with hufUncompress");je(p,l,i,h),nn(p,h,e,t,c,i,a,s,o)}function tn(e,n,t){for(let r=0;r<t;++r)n[r]=e[n[r]]}function Oe(e){for(let n=1;n<e.length;n++){const t=e[n-1]+e[n]-128;e[n]=t}}function Re(e,n){let t=0,r=Math.floor((e.length+1)/2),s=0;const a=e.length-1;for(;!(s>a||(n[s++]=e[t++],s>a));)n[s++]=e[r++]}function Be(e){let n=e.byteLength;const t=new Array;let r=0;const s=new DataView(e);for(;n>0;){const a=s.getInt8(r++);if(a<0){const o=-a;n-=o+1;for(let u=0;u<o;u++)t.push(s.getUint8(r++))}else{const o=a;n-=2;const u=s.getUint8(r++);for(let l=0;l<o+1;l++)t.push(u)}}return t}function on(e,n,t,r,s,a){let o=new DataView(a.buffer);const u=t[e.idx[0]].width,l=t[e.idx[0]].height,i=3,c=Math.floor(u/8),p=Math.ceil(u/8),h=Math.ceil(l/8),f=u-(p-1)*8,_=l-(h-1)*8,m={value:0},E=new Array(i),v=new Array(i),S=new Array(i),U=new Array(i),T=new Array(i);for(let d=0;d<i;++d)T[d]=n[e.idx[d]],E[d]=d<1?0:E[d-1]+p*h,v[d]=new Float32Array(64),S[d]=new Uint16Array(64),U[d]=new Uint16Array(p*64);for(let d=0;d<h;++d){let N=8;d==h-1&&(N=_);let k=8;for(let y=0;y<p;++y){y==p-1&&(k=f);for(let b=0;b<i;++b)S[b].fill(0),S[b][0]=s[E[b]++],De(m,r,S[b]),Pe(S[b],v[b]),Fe(v[b]);sn(v);for(let b=0;b<i;++b)Le(v[b],U[b],y*64)}let x=0;for(let y=0;y<i;++y){const b=t[e.idx[y]].type;for(let W=8*d;W<8*d+N;++W){x=T[y][W];for(let re=0;re<c;++re){const H=re*64+(W&7)*8;o.setUint16(x+0*2*b,U[y][H+0],!0),o.setUint16(x+1*2*b,U[y][H+1],!0),o.setUint16(x+2*2*b,U[y][H+2],!0),o.setUint16(x+3*2*b,U[y][H+3],!0),o.setUint16(x+4*2*b,U[y][H+4],!0),o.setUint16(x+5*2*b,U[y][H+5],!0),o.setUint16(x+6*2*b,U[y][H+6],!0),o.setUint16(x+7*2*b,U[y][H+7],!0),x+=8*2*b}}if(c!=p)for(let W=8*d;W<8*d+N;++W){const re=T[y][W]+8*c*2*b,H=c*64+(W&7)*8;for(let ae=0;ae<k;++ae)o.setUint16(re+ae*2*b,U[y][H+ae],!0)}}}const I=new Uint16Array(u);o=new DataView(a.buffer);for(let d=0;d<i;++d){t[e.idx[d]].decoded=!0;const N=t[e.idx[d]].type;if(t[d].type==2)for(let k=0;k<l;++k){const x=T[d][k];for(let y=0;y<u;++y)I[y]=o.getUint16(x+y*2*N,!0);for(let y=0;y<u;++y)o.setFloat32(x+y*2*N,w(I[y]),!0)}}}function rn(e,n,t,r,s,a){const o=new DataView(a.buffer),u=t[e],l=u.width,i=u.height,c=Math.ceil(l/8),p=Math.ceil(i/8),h=Math.floor(l/8),f=l-(c-1)*8,_=i-(p-1)*8,m={value:0};let E=0;const v=new Float32Array(64),S=new Uint16Array(64),U=new Uint16Array(c*64);for(let T=0;T<p;++T){let I=8;T==p-1&&(I=_);for(let d=0;d<c;++d)S.fill(0),S[0]=s[E++],De(m,r,S),Pe(S,v),Fe(v),Le(v,U,d*64);for(let d=8*T;d<8*T+I;++d){let N=n[e][d];for(let k=0;k<h;++k){const x=k*64+(d&7)*8;for(let y=0;y<8;++y)o.setUint16(N+y*2*u.type,U[x+y],!0);N+=8*2*u.type}if(c!=h){const k=h*64+(d&7)*8;for(let x=0;x<f;++x)o.setUint16(N+x*2*u.type,U[k+x],!0)}}}u.decoded=!0}function De(e,n,t){let r,s=1;for(;s<64;)r=n[e.value],r==65280?s=64:r>>8==255?s+=r&255:(t[s]=r,s++),e.value++}function Pe(e,n){n[0]=w(e[0]),n[1]=w(e[1]),n[2]=w(e[5]),n[3]=w(e[6]),n[4]=w(e[14]),n[5]=w(e[15]),n[6]=w(e[27]),n[7]=w(e[28]),n[8]=w(e[2]),n[9]=w(e[4]),n[10]=w(e[7]),n[11]=w(e[13]),n[12]=w(e[16]),n[13]=w(e[26]),n[14]=w(e[29]),n[15]=w(e[42]),n[16]=w(e[3]),n[17]=w(e[8]),n[18]=w(e[12]),n[19]=w(e[17]),n[20]=w(e[25]),n[21]=w(e[30]),n[22]=w(e[41]),n[23]=w(e[43]),n[24]=w(e[9]),n[25]=w(e[11]),n[26]=w(e[18]),n[27]=w(e[24]),n[28]=w(e[31]),n[29]=w(e[40]),n[30]=w(e[44]),n[31]=w(e[53]),n[32]=w(e[10]),n[33]=w(e[19]),n[34]=w(e[23]),n[35]=w(e[32]),n[36]=w(e[39]),n[37]=w(e[45]),n[38]=w(e[52]),n[39]=w(e[54]),n[40]=w(e[20]),n[41]=w(e[22]),n[42]=w(e[33]),n[43]=w(e[38]),n[44]=w(e[46]),n[45]=w(e[51]),n[46]=w(e[55]),n[47]=w(e[60]),n[48]=w(e[21]),n[49]=w(e[34]),n[50]=w(e[37]),n[51]=w(e[47]),n[52]=w(e[50]),n[53]=w(e[56]),n[54]=w(e[59]),n[55]=w(e[61]),n[56]=w(e[35]),n[57]=w(e[36]),n[58]=w(e[48]),n[59]=w(e[49]),n[60]=w(e[57]),n[61]=w(e[58]),n[62]=w(e[62]),n[63]=w(e[63])}function Fe(e){const n=.5*Math.cos(.7853975),t=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),s=.5*Math.cos(3*3.14159/16),a=.5*Math.cos(5*3.14159/16),o=.5*Math.cos(3*3.14159/8),u=.5*Math.cos(7*3.14159/16),l=new Array(4),i=new Array(4),c=new Array(4),p=new Array(4);for(let h=0;h<8;++h){const f=h*8;l[0]=r*e[f+2],l[1]=o*e[f+2],l[2]=r*e[f+6],l[3]=o*e[f+6],i[0]=t*e[f+1]+s*e[f+3]+a*e[f+5]+u*e[f+7],i[1]=s*e[f+1]-u*e[f+3]-t*e[f+5]-a*e[f+7],i[2]=a*e[f+1]-t*e[f+3]+u*e[f+5]+s*e[f+7],i[3]=u*e[f+1]-a*e[f+3]+s*e[f+5]-t*e[f+7],c[0]=n*(e[f+0]+e[f+4]),c[3]=n*(e[f+0]-e[f+4]),c[1]=l[0]+l[3],c[2]=l[1]-l[2],p[0]=c[0]+c[1],p[1]=c[3]+c[2],p[2]=c[3]-c[2],p[3]=c[0]-c[1],e[f+0]=p[0]+i[0],e[f+1]=p[1]+i[1],e[f+2]=p[2]+i[2],e[f+3]=p[3]+i[3],e[f+4]=p[3]-i[3],e[f+5]=p[2]-i[2],e[f+6]=p[1]-i[1],e[f+7]=p[0]-i[0]}for(let h=0;h<8;++h)l[0]=r*e[16+h],l[1]=o*e[16+h],l[2]=r*e[48+h],l[3]=o*e[48+h],i[0]=t*e[8+h]+s*e[24+h]+a*e[40+h]+u*e[56+h],i[1]=s*e[8+h]-u*e[24+h]-t*e[40+h]-a*e[56+h],i[2]=a*e[8+h]-t*e[24+h]+u*e[40+h]+s*e[56+h],i[3]=u*e[8+h]-a*e[24+h]+s*e[40+h]-t*e[56+h],c[0]=n*(e[h]+e[32+h]),c[3]=n*(e[h]-e[32+h]),c[1]=l[0]+l[3],c[2]=l[1]-l[2],p[0]=c[0]+c[1],p[1]=c[3]+c[2],p[2]=c[3]-c[2],p[3]=c[0]-c[1],e[0+h]=p[0]+i[0],e[8+h]=p[1]+i[1],e[16+h]=p[2]+i[2],e[24+h]=p[3]+i[3],e[32+h]=p[3]-i[3],e[40+h]=p[2]-i[2],e[48+h]=p[1]-i[1],e[56+h]=p[0]-i[0]}function sn(e){for(let n=0;n<64;++n){const t=e[0][n],r=e[1][n],s=e[2][n];e[0][n]=t+1.5747*s,e[1][n]=t-.1873*r-.4682*s,e[2][n]=t+1.8556*r}}function Le(e,n,t){for(let r=0;r<64;++r)n[t+r]=Xe.toHalfFloat(ln(e[r]))}function ln(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(qe,Math.abs(e)-1)}function _e(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function cn(e){const n=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),t=new Uint8Array(Be(n)),r=new Uint8Array(t.length);return Oe(t),Re(t,r),new DataView(r.buffer)}function ve(e){const n=e.array.slice(e.offset.value,e.offset.value+e.size),t=ue(n),r=new Uint8Array(t.length);return Oe(t),Re(t,r),new DataView(r.buffer)}function an(e){const n=e.viewer,t={value:e.offset.value},r=new Uint16Array(e.columns*e.lines*(e.inputChannels.length*e.type)),s=new Uint8Array(8192);let a=0;const o=new Array(e.inputChannels.length);for(let _=0,m=e.inputChannels.length;_<m;_++)o[_]={},o[_].start=a,o[_].end=o[_].start,o[_].nx=e.columns,o[_].ny=e.lines,o[_].size=e.type,a+=o[_].nx*o[_].ny*o[_].size;const u=oe(n,t),l=oe(n,t);if(l>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(u<=l)for(let _=0;_<l-u+1;_++)s[_+u]=$(n,t);const i=new Uint16Array(65536),c=Ke(s,i),p=L(n,t);ke(e.array,n,t,p,r,a);for(let _=0;_<e.inputChannels.length;++_){const m=o[_];for(let E=0;E<o[_].size;++E)en(r,m.start+E,m.nx,m.size,m.ny,m.nx*m.size,c)}tn(i,r,a);let h=0;const f=new Uint8Array(r.buffer.byteLength);for(let _=0;_<e.lines;_++)for(let m=0;m<e.inputChannels.length;m++){const E=o[m],v=E.nx*E.size,S=new Uint8Array(r.buffer,E.end*2,v*2);f.set(S,h),h+=v*2,E.end+=v}return new DataView(f.buffer)}function un(e){const n=e.array.slice(e.offset.value,e.offset.value+e.size),t=ue(n),r=e.inputChannels.length*e.lines*e.columns*e.totalBytes,s=new ArrayBuffer(r),a=new DataView(s);let o=0,u=0;const l=new Array(4);for(let i=0;i<e.lines;i++)for(let c=0;c<e.inputChannels.length;c++){let p=0;switch(e.inputChannels[c].pixelType){case 1:l[0]=o,l[1]=l[0]+e.columns,o=l[1]+e.columns;for(let f=0;f<e.columns;++f){const _=t[l[0]++]<<8|t[l[1]++];p+=_,a.setUint16(u,p,!0),u+=2}break;case 2:l[0]=o,l[1]=l[0]+e.columns,l[2]=l[1]+e.columns,o=l[2]+e.columns;for(let f=0;f<e.columns;++f){const _=t[l[0]++]<<24|t[l[1]++]<<16|t[l[2]++]<<8;p+=_,a.setUint32(u,p,!0),u+=4}break}}return a}function Ze(e){const n=e.viewer,t={value:e.offset.value},r=new Uint8Array(e.columns*e.lines*(e.inputChannels.length*e.type*2)),s={version:P(n,t),unknownUncompressedSize:P(n,t),unknownCompressedSize:P(n,t),acCompressedSize:P(n,t),dcCompressedSize:P(n,t),rleCompressedSize:P(n,t),rleUncompressedSize:P(n,t),rleRawSize:P(n,t),totalAcUncompressedCount:P(n,t),totalDcUncompressedCount:P(n,t),acCompression:P(n,t)};if(s.version<2)throw new Error("EXRLoader.parse: "+V.compression+" version "+s.version+" is unsupported");const a=new Array;let o=oe(n,t)-2;for(;o>0;){const m=ce(n.buffer,t),E=$(n,t),v=E>>2&3,S=(E>>4)-1,U=new Int8Array([S])[0],T=$(n,t);a.push({name:m,index:U,type:T,compression:v}),o-=m.length+3}const u=V.channels,l=new Array(e.inputChannels.length);for(let m=0;m<e.inputChannels.length;++m){const E=l[m]={},v=u[m];E.name=v.name,E.compression=0,E.decoded=!1,E.type=v.pixelType,E.pLinear=v.pLinear,E.width=e.columns,E.height=e.lines}const i={idx:new Array(3)};for(let m=0;m<e.inputChannels.length;++m){const E=l[m];for(let v=0;v<a.length;++v){const S=a[v];E.name==S.name&&(E.compression=S.compression,S.index>=0&&(i.idx[S.index]=m),E.offset=m)}}let c,p,h;if(s.acCompressedSize>0)switch(s.acCompression){case 0:c=new Uint16Array(s.totalAcUncompressedCount),ke(e.array,n,t,s.acCompressedSize,c,s.totalAcUncompressedCount);break;case 1:const m=e.array.slice(t.value,t.value+s.totalAcUncompressedCount),E=ue(m);c=new Uint16Array(E.buffer),t.value+=s.totalAcUncompressedCount;break}if(s.dcCompressedSize>0){const m={array:e.array,offset:t,size:s.dcCompressedSize};p=new Uint16Array(ve(m).buffer),t.value+=s.dcCompressedSize}if(s.rleRawSize>0){const m=e.array.slice(t.value,t.value+s.rleCompressedSize),E=ue(m);h=Be(E.buffer),t.value+=s.rleCompressedSize}let f=0;const _=new Array(l.length);for(let m=0;m<_.length;++m)_[m]=new Array;for(let m=0;m<e.lines;++m)for(let E=0;E<l.length;++E)_[E].push(f),f+=l[E].width*e.type*2;i.idx[0]!==void 0&&l[i.idx[0]]&&on(i,_,l,c,p,r);for(let m=0;m<l.length;++m){const E=l[m];if(!E.decoded)switch(E.compression){case 2:let v=0,S=0;for(let U=0;U<e.lines;++U){let T=_[m][v];for(let I=0;I<E.width;++I){for(let d=0;d<2*E.type;++d)r[T++]=h[S+d*E.width*E.height];S++}v++}break;case 1:rn(m,_,l,c,p,r);break;default:throw new Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(r.buffer)}function ce(e,n){const t=new Uint8Array(e);let r=0;for(;t[n.value+r]!=0;)r+=1;const s=new TextDecoder().decode(t.slice(n.value,n.value+r));return n.value=n.value+r+1,s}function hn(e,n,t){const r=new TextDecoder().decode(new Uint8Array(e).slice(n.value,n.value+t));return n.value=n.value+t,r}function pn(e,n){const t=F(e,n),r=L(e,n);return[t,r]}function mn(e,n){const t=L(e,n),r=L(e,n);return[t,r]}function F(e,n){const t=e.getInt32(n.value,!0);return n.value=n.value+4,t}function L(e,n){const t=e.getUint32(n.value,!0);return n.value=n.value+4,t}function He(e,n){const t=e[n.value];return n.value=n.value+1,t}function $(e,n){const t=e.getUint8(n.value);return n.value=n.value+1,t}const P=function(e,n){let t;return"getBigInt64"in DataView.prototype?t=Number(e.getBigInt64(n.value,!0)):t=e.getUint32(n.value+4,!0)+Number(e.getUint32(n.value,!0)<<32),n.value+=8,t};function O(e,n){const t=e.getFloat32(n.value,!0);return n.value+=4,t}function fn(e,n){return Xe.toHalfFloat(O(e,n))}function w(e){const n=(e&31744)>>10,t=e&1023;return(e>>15?-1:1)*(n?n===31?t?NaN:1/0:Math.pow(2,n-15)*(1+t/1024):6103515625e-14*(t/1024))}function oe(e,n){const t=e.getUint16(n.value,!0);return n.value+=2,t}function wn(e,n){return w(oe(e,n))}function En(e,n,t,r){const s=t.value,a=[];for(;t.value<s+r-1;){const o=ce(n,t),u=F(e,t),l=$(e,t);t.value+=3;const i=F(e,t),c=F(e,t);a.push({name:o,pixelType:u,pLinear:l,xSampling:i,ySampling:c})}return t.value+=1,a}function _n(e,n){const t=O(e,n),r=O(e,n),s=O(e,n),a=O(e,n),o=O(e,n),u=O(e,n),l=O(e,n),i=O(e,n);return{redX:t,redY:r,greenX:s,greenY:a,blueX:o,blueY:u,whiteX:l,whiteY:i}}function vn(e,n){const t=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],r=$(e,n);return t[r]}function dn(e,n){const t=F(e,n),r=F(e,n),s=F(e,n),a=F(e,n);return{xMin:t,yMin:r,xMax:s,yMax:a}}function gn(e,n){const t=["INCREASING_Y","DECREASING_Y","RANDOM_Y"],r=$(e,n);return t[r]}function yn(e,n){const t=["ENVMAP_LATLONG","ENVMAP_CUBE"],r=$(e,n);return t[r]}function Sn(e,n){const t=["ONE_LEVEL","MIPMAP_LEVELS","RIPMAP_LEVELS"],r=["ROUND_DOWN","ROUND_UP"],s=L(e,n),a=L(e,n),o=$(e,n);return{xSize:s,ySize:a,levelMode:t[o&15],roundingMode:r[o>>4]}}function Cn(e,n){const t=O(e,n),r=O(e,n);return[t,r]}function In(e,n){const t=O(e,n),r=O(e,n),s=O(e,n);return[t,r,s]}function Un(e,n,t,r,s){if(r==="string"||r==="stringvector"||r==="iccProfile")return hn(n,t,s);if(r==="chlist")return En(e,n,t,s);if(r==="chromaticities")return _n(e,t);if(r==="compression")return vn(e,t);if(r==="box2i")return dn(e,t);if(r==="envmap")return yn(e,t);if(r==="tiledesc")return Sn(e,t);if(r==="lineOrder")return gn(e,t);if(r==="float")return O(e,t);if(r==="v2f")return Cn(e,t);if(r==="v3f")return In(e,t);if(r==="int")return F(e,t);if(r==="rational")return pn(e,t);if(r==="timecode")return mn(e,t);if(r==="preview")return t.value+=s,"skipped";t.value+=s}function bn(e,n){const t=Math.log2(e);return n=="ROUND_DOWN"?Math.floor(t):Math.ceil(t)}function xn(e,n,t){let r=0;switch(e.levelMode){case"ONE_LEVEL":r=1;break;case"MIPMAP_LEVELS":r=bn(Math.max(n,t),e.roundingMode)+1;break;case"RIPMAP_LEVELS":throw new Error("THREE.EXRLoader: RIPMAP_LEVELS tiles currently unsupported.")}return r}function ze(e,n,t,r){const s=new Array(e);for(let a=0;a<e;a++){const o=1<<a;let u=n/o|0;r=="ROUND_UP"&&u*o<n&&(u+=1);const l=Math.max(u,1);s[a]=(l+t-1)/t|0}return s}function An(){const e=this,n=e.offset,t={value:0};for(let r=0;r<e.tileCount;r++){const s=F(e.viewer,n),a=F(e.viewer,n);n.value+=8,e.size=L(e.viewer,n);const o=s*e.blockWidth,u=a*e.blockHeight;e.columns=o+e.blockWidth>e.width?e.width-o:e.blockWidth,e.lines=u+e.blockHeight>e.height?e.height-u:e.blockHeight;const l=e.columns*e.totalBytes,c=e.size<e.lines*l?e.uncompress(e):_e(e);n.value+=e.size;for(let p=0;p<e.lines;p++){const h=p*e.columns*e.totalBytes;for(let f=0;f<e.inputChannels.length;f++){const _=V.channels[f].name,m=e.channelByteOffsets[_]*e.columns,E=e.decodeChannels[_];if(E===void 0)continue;t.value=h+m;const v=(e.height-(1+u+p))*e.outLineWidth;for(let S=0;S<e.columns;S++){const U=v+(S+o)*e.outputChannels+E;e.byteArray[U]=e.getter(c,t)}}}}}function Nn(){const e=this,n=e.offset,t={value:0};for(let r=0;r<e.height/e.blockHeight;r++){const s=F(e.viewer,n)-V.dataWindow.yMin;e.size=L(e.viewer,n),e.lines=s+e.blockHeight>e.height?e.height-s:e.blockHeight;const a=e.columns*e.totalBytes,u=e.size<e.lines*a?e.uncompress(e):_e(e);n.value+=e.size;for(let l=0;l<e.blockHeight;l++){const i=r*e.blockHeight,c=l+e.scanOrder(i);if(c>=e.height)continue;const p=l*a,h=(e.height-1-c)*e.outLineWidth;for(let f=0;f<e.inputChannels.length;f++){const _=V.channels[f].name,m=e.channelByteOffsets[_]*e.columns,E=e.decodeChannels[_];if(E!==void 0){t.value=p+m;for(let v=0;v<e.columns;v++){const S=h+v*e.outputChannels+E;e.byteArray[S]=e.getter(u,t)}}}}}}function Tn(e,n,t){const r={};if(e.getUint32(0,!0)!=20000630)throw new Error("THREE.EXRLoader: Provided file doesn't appear to be in OpenEXR format.");r.version=e.getUint8(4);const s=e.getUint8(5);r.spec={singleTile:!!(s&2),longName:!!(s&4),deepFormat:!!(s&8),multiPart:!!(s&16)},t.value=8;let a=!0;for(;a;){const o=ce(n,t);if(o==="")a=!1;else{const u=ce(n,t),l=L(e,t),i=Un(e,n,t,u,l);i===void 0?console.warn(`THREE.EXRLoader: Skipped unknown header attribute type '${u}'.`):r[o]=i}}if(s&-7)throw console.error("THREE.EXRHeader:",r),new Error("THREE.EXRLoader: Provided file is currently unsupported.");return r}function Mn(e,n,t,r,s,a){const o={size:0,viewer:n,array:t,offset:r,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,inputChannels:e.channels,channelByteOffsets:{},shouldExpand:!1,scanOrder:null,totalBytes:null,columns:null,lines:null,type:null,uncompress:null,getter:null,format:null,colorSpace:J};switch(e.compression){case"NO_COMPRESSION":o.blockHeight=1,o.uncompress=_e;break;case"RLE_COMPRESSION":o.blockHeight=1,o.uncompress=cn;break;case"ZIPS_COMPRESSION":o.blockHeight=1,o.uncompress=ve;break;case"ZIP_COMPRESSION":o.blockHeight=16,o.uncompress=ve;break;case"PIZ_COMPRESSION":o.blockHeight=32,o.uncompress=an;break;case"PXR24_COMPRESSION":o.blockHeight=16,o.uncompress=un;break;case"DWAA_COMPRESSION":o.blockHeight=32,o.uncompress=Ze;break;case"DWAB_COMPRESSION":o.blockHeight=256,o.uncompress=Ze;break;default:throw new Error("EXRLoader.parse: "+e.compression+" is unsupported")}const u={};for(const h of e.channels)switch(h.name){case"Y":case"R":case"G":case"B":case"A":u[h.name]=!0,o.type=h.pixelType}let l=!1,i=!1;if(u.R&&u.G&&u.B)o.outputChannels=4;else if(u.Y)o.outputChannels=1;else throw new Error("EXRLoader.parse: file contains unsupported data channels.");switch(o.outputChannels){case 4:a==ee?(l=!u.A,o.format=ee,o.colorSpace=J,o.outputChannels=4,o.decodeChannels={R:0,G:1,B:2,A:3}):a==se?(o.format=se,o.colorSpace=J,o.outputChannels=2,o.decodeChannels={R:0,G:1}):a==pe?(o.format=pe,o.colorSpace=J,o.outputChannels=1,o.decodeChannels={R:0}):i=!0;break;case 1:a==ee?(l=!0,o.format=ee,o.colorSpace=J,o.outputChannels=4,o.shouldExpand=!0,o.decodeChannels={Y:0}):a==se?(o.format=se,o.colorSpace=J,o.outputChannels=2,o.shouldExpand=!0,o.decodeChannels={Y:0}):a==pe?(o.format=pe,o.colorSpace=J,o.outputChannels=1,o.decodeChannels={Y:0}):i=!0;break;default:i=!0}if(i)throw new Error("EXRLoader.parse: invalid output format for specified file.");if(o.type==1)switch(s){case de:o.getter=wn;break;case he:o.getter=oe;break}else if(o.type==2)switch(s){case de:o.getter=O;break;case he:o.getter=fn}else throw new Error("EXRLoader.parse: unsupported pixelType "+o.type+" for "+e.compression+".");o.columns=o.width;const c=o.width*o.height*o.outputChannels;switch(s){case de:o.byteArray=new Float32Array(c),l&&o.byteArray.fill(1,0,c);break;case he:o.byteArray=new Uint16Array(c),l&&o.byteArray.fill(15360,0,c);break;default:console.error("THREE.EXRLoader: unsupported type: ",s);break}let p=0;for(const h of e.channels)o.decodeChannels[h.name]!==void 0&&(o.channelByteOffsets[h.name]=p),p+=h.pixelType*2;if(o.totalBytes=p,o.outLineWidth=o.width*o.outputChannels,e.lineOrder==="INCREASING_Y"?o.scanOrder=h=>h:o.scanOrder=h=>o.height-1-h,e.spec.singleTile){o.blockHeight=e.tiles.ySize,o.blockWidth=e.tiles.xSize;const h=xn(e.tiles,o.width,o.height),f=ze(h,o.width,e.tiles.xSize,e.tiles.roundingMode),_=ze(h,o.height,e.tiles.ySize,e.tiles.roundingMode);o.tileCount=f[0]*_[0];for(let m=0;m<h;m++)for(let E=0;E<_[m];E++)for(let v=0;v<f[m];v++)P(n,r);o.decode=An.bind(o)}else{o.blockWidth=o.width;const h=Math.ceil(o.height/o.blockHeight);for(let f=0;f<h;f++)P(n,r);o.decode=Nn.bind(o)}return o}const We={value:0},Ye=new DataView(C),kn=new Uint8Array(C),V=Tn(Ye,C,We),q=Mn(V,Ye,kn,We,this.type,this.outputFormat);if(q.decode(),q.shouldExpand){const e=q.byteArray;if(this.outputFormat==ee)for(let n=0;n<e.length;n+=4)e[n+2]=e[n+1]=e[n];else if(this.outputFormat==se)for(let n=0;n<e.length;n+=2)e[n+1]=e[n]}return{header:V,width:q.width,height:q.height,data:q.byteArray,format:q.format,colorSpace:q.colorSpace,type:this.type}}setDataType(C){return this.type=C,this}setOutputFormat(C){return this.outputFormat=C,this}load(C,B,M,D){function g(R,K){R.colorSpace=K.colorSpace,R.minFilter=Ge,R.magFilter=Ge,R.generateMipmaps=!1,R.flipY=!1,B&&B(R,K)}return super.load(C,g,M,D)}}await Z("three");const{defineComponent:vt}=await Z("vue"),{watchEffect:dt}=await Z("vue");await Z("three");const{withAsyncContext:Xn,defineComponent:Gn}=await Z("vue"),{unref:$n,openBlock:qn,createElementBlock:Kn}=await Z("vue"),Vn=["object","scale"],Jn=await Z("three"),gt=Gn({__name:"groundProjectedEnvCom",props:{texture:{default:"https://opensource.cdn.icegl.cn/images/skyBox/round_platform_1k.exr"},size:{default:100}},async setup(Y){let C,B;const M=Y,D=new Yn,g=([C,B]=Xn(()=>D.loadAsync(M.texture)),C=await C,B(),C);g.mapping=Jn.EquirectangularReflectionMapping;const{scene:R}=On();R.value.environment=g;const K=new zn(g);return(ie,le)=>(qn(),Kn("primitive",{object:$n(K),scale:M.size},null,8,Vn))}}),{defineComponent:Qn}=await Z("vue"),{ref:jn,watch:me}=await Z("vue"),ne=await Z("three"),yt=Qn({__name:"basiceEnv",props:{on:{default:!0},type:{default:"sunset"},environmentIntensity:{default:1},environmentRotations:{default:{x:0,y:0,z:0}}},setup(Y){const C=Y;function B(g){return g instanceof ne.Euler?g:Array.isArray(g)?new ne.Euler(g[0],g[1],g[2]):typeof g=="number"?new ne.Euler(g,g,g):g instanceof ne.Vector3?new ne.Euler(g.x,g.y,g.z):typeof g=="object"&&"x"in g&&"y"in g&&"z"in g?new ne.Euler(g.x,g.y,g.z):null}const{scene:M}=Rn(),D=jn(null);return me(()=>[C.on,D.value],([g,R])=>{M.value&&(g&&D.value?M.value.environment=D.value:M.value.environment=null)},{immediate:!0}),me(()=>C.type,async g=>{M.value&&$e[g]&&(D.value=await Dn(et+$e[g]),C.on&&(M.value.environment=D.value))},{immediate:!0}),me(()=>C.environmentIntensity,g=>{M.value&&(M.value.environmentIntensity=g)},{immediate:!0}),me(()=>C.environmentRotations,g=>{if(M.value){const R=B(g);R&&M.value.environmentRotation.copy(R)}},{immediate:!0,deep:!0}),(g,R)=>null}}),$e={sunset:"/images/water/belfast_sunset_puresky_1k.hdr",desert:"/images/skyBox/desert_1k.hdr",room:"/images/skyBox/newConvert/abandoned_games_room_02_1k.hdr",canary:"/images/skyBox/newConvert/canary_wharf_1k.hdr",outdoor:"/images/skyBox/newConvert/outdoor_umbrellas_1k.hdr",haven:"/images/skyBox/newConvert/poly_haven_studio_1k.hdr",shanghai:"/images/skyBox/newConvert/shanghai_bund_1k.hdr",hangar:"/images/skyBox/newConvert/small_hangar_01_1k.hdr",snowy:"/images/skyBox/newConvert/snowy_forest_path_01_1k.hdr"},et="https://opensource.cdn.icegl.cn";export{$e as HDRfileList,gt as _sfc_main,yt as _sfc_main$1};
