import{P as t}from"./tweakpane.yHWGBmom1732680436779.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.ygJk6Z9x1732680436779.js";import{e}from"./@tresjs.ozxSQdlw1732680436779.js";import{z as r}from"./three-custom-shader-material.9-Fy8s-01732680436779.js";import{_ as i,a0 as u,C as c,cd as a,m as s,b3 as l}from"./three.HQIWXjA-1732680436779.js";import{d as f,a3 as p,w as d,o as m,D as v,u as g,a6 as h,r as y,f as C,g as w,j as _,m as b}from"./@vue.u2cBPEWn1732680436779.js";import"./@vueuse.OVEejUj91732680436779.js";const x=T;!function(t,n){const o=T,e=j();for(;;)try{if(629204===-parseInt(o(413))/1+parseInt(o(441))/2*(-parseInt(o(456))/3)+parseInt(o(430))/4*(parseInt(o(404))/5)+-parseInt(o(396))/6*(parseInt(o(412))/7)+-parseInt(o(422))/8*(-parseInt(o(445))/9)+parseInt(o(405))/10*(parseInt(o(414))/11)+-parseInt(o(408))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(448)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=T,n=new RegExp(t(446)),o=new RegExp(t(418),"i"),e=O("init");n[t(435)](e+t(417))&&o[t(435)](e+t(398))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function T(t,n){const o=j();return(T=function(t,n){return o[t-=396]})(t,n)}M(void 0,(function(){const t=T,n=function(){const t=T;let n;try{n=Function("return (function() "+t(434)+");")()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=["log","warn","info",t(440),t(415),"table",t(444)];for(let r=0;r<e.length;r++){const n=M[t(427)][t(438)][t(449)](M),i=e[r],u=o[i]||n;n[t(437)]=M[t(449)](M),n[t(457)]=u.toString[t(449)](u),o[i]=n}}))();const S=[x(428)];function j(){const t=["DoubleSide",'{}.constructor("return this")( )',"test","gger","__proto__","prototype","uniforms","error","20ugheHk","dispose","setStyle","trace","462951ulTouN","function *\\( *\\)","model","apply","bind","material","Color","string","land","landColor","renderOrder","164694cMoLbU","toString","126WwHejO","debu","input","opacity","uTime","city","primitive","MeshBasicMaterial","295eiyqCf","130ACLVLP","gradient","uOpacity","1346484bTrJui","stateObject","bModel","side","119469PXHNhr","25501xThHXJ","197681AXBvJM","exception","bulidingsColor","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","isArray","length","color","40BObseR","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","#ffff00","action","__csm","constructor","object","uColor","80236UKwUBA","forEach","value"];return(j=function(){return t})()}const P=f({__name:x(410),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:"#112233"},topColor:{default:x(424)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,c=o[n(447)][n(401)];o.model[n(447)].children[0][n(450)]=new(i[n(403)])({color:"#ffff00"}),c[n(455)]=1001;const a=o.model[n(453)];(()=>{const t=n,{geometry:e}=c;e.computeBoundingBox(),e.computeBoundingSphere();const{max:a,min:s}=e.boundingBox;if(c[t(450)][t(426)])return;const l=new r({baseMaterial:c[t(450)],vertexShader:t(423),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(451)])(o.bulidingsColor)},uOpacity:{value:o[t(399)]},uLightColor:{value:new(i[t(451)])("#ffffff")},uTopColor:{value:new(i[t(451)])(o.topColor)},uTime:{value:0},uGradient:{value:o[t(406)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:u});c.material[t(442)](),c.material=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c.material[o(439)][o(400)].value+=t})),p((()=>{const t=n;o[t(416)]&&c[t(450)][t(439)][t(429)].value[t(443)](o[t(416)]),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(453)&&(u=Array[r(419)](a[r(450)])?a[r(450)]:[a[r(450)]],u[r(431)]((t=>{const n=r;t[e][n(443)](o[n(454)]),t[n(411)]=i[n(433)]})))})(t(453),t(421)),o[t(399)]&&(c[t(450)].uniforms[t(407)].value=o[t(399)])})),d(o,((t,o)=>{const e=n;c.material.uniforms.uGradient[e(432)]=t[e(406)]}));const l=o[n(447)][n(447)].clone();return(t,o)=>{const e=n;return m(),v(e(402),{object:g(l)},null,8,S)}}});function O(t){function n(t){const o=T;if(typeof t===o(452))return function(t){}[o(427)]("while (true) {}")[o(448)]("counter");1!==(""+t/t)[o(420)]||t%20==0?function(){return!0}[o(427)](o(397)+o(436)).call(o(425)):function(){return!1}[o(427)]("debugger")[o(448)](o(409)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const B=G;!function(t,n){const o=G,e=z();for(;;)try{if(573834===parseInt(o(454))/1*(parseInt(o(455))/2)+parseInt(o(438))/3+-parseInt(o(433))/4*(parseInt(o(417))/5)+parseInt(o(425))/6+-parseInt(o(400))/7*(-parseInt(o(427))/8)+parseInt(o(422))/9*(parseInt(o(399))/10)+parseInt(o(402))/11*(-parseInt(o(410))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(430)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=G,n=new RegExp(t(413)),o=new RegExp(t(443),"i"),e=H(t(452));n[t(446)](e+t(414))&&o[t(446)](e+t(445))?H():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(430)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(t,n){const o=z();return(G=function(t,n){return o[t-=397]})(t,n)}F(void 0,(function(){const t=G;let n;try{n=Function(t(432)+t(408)+");")()}catch(r){n=window}const o=n[t(404)]=n[t(404)]||{},e=[t(428),t(451),t(449),"error",t(415),t(448),t(434)];for(let i=0;i<e.length;i++){const n=F.constructor[t(420)][t(411)](F),r=e[i],u=o[r]||n;n[t(441)]=F.bind(F),n.toString=u[t(429)][t(411)](u),o[r]=n}}))();const R=[B(435)];function z(){const t=["1331778cxvQDZ","while (true) {}","width","__proto__","uniforms","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","matrix","input","test","primitive","table","info","scale","warn","init","#FFF","1115781jzHqPf","2cTlkVG","#000","clone","string","16310xyFRal","99764vThPIh","geometry","6996EQbxlH","value","console","action","color","gger",'{}.constructor("return this")( )',"speed","65412UGzkQl","bind","uSrcColor","function *\\( *\\)","chain","exception","renderOrder","5OoJIaM","uScale","bLine","prototype","constructor","5139gKuinw","uTime","builds","4804122KpvKGH","counter","488nmVipw","log","toString","apply","srcColor","return (function() ","481588CDMfrL","trace","object","debu","gradual"];return(z=function(){return t})()}const E=f({__name:B(419),props:{builds:{},color:{default:B(453)},srcColor:{default:B(456)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o[n(406)])},uSrcColor:{value:new c(o.srcColor)},uScale:{value:o[n(450)]},uTime:{value:0},uGradual:{value:o[n(437)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o.builds[n(401)])[n(397)]();u=u.applyMatrix4(o[n(424)][n(444)]);const f=new s(i);r=new l(u,f),r.material.linewidth=o[n(440)],r[n(416)]=1e3,p((()=>{const t=n;o.color&&(i.uniforms.uColor.value=new c(o[t(406)])),o.srcColor&&(i.uniforms[t(412)][t(403)]=new c(o[t(431)])),o[t(450)]&&(i[t(442)][t(418)].value=o[t(450)]),o[t(437)]&&(i[t(442)].uGradual[t(403)]=o[t(437)])}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i[e(442)][e(423)][e(403)]+=t*o[e(409)],i.uniforms[e(423)][e(403)]%=1})),(t,o)=>{const e=n;return m(),v(e(447),{object:g(r)},null,8,R)}}});function H(t){function n(t){const o=G;if(typeof t===o(398))return function(t){}[o(421)](o(439)).apply(o(426));1!==(""+t/t).length||t%20==0?function(){return!0}[o(421)](o(436)+o(407)).call(o(405)):function(){return!1}[o(421)]("debu"+o(407))[o(430)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function L(t,n){const o=D();return(L=function(t,n){return o[t-=226]})(t,n)}!function(t,n){const o=L,e=D();for(;;)try{if(281651===-parseInt(o(236))/1*(-parseInt(o(234))/2)+parseInt(o(259))/3*(-parseInt(o(240))/4)+parseInt(o(250))/5*(parseInt(o(267))/6)+-parseInt(o(263))/7+parseInt(o(270))/8+parseInt(o(247))/9*(parseInt(o(241))/10)+parseInt(o(251))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(253)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=L,n=new RegExp(t(238)),o=new RegExp(t(272),"i"),e=V(t(237));n.test(e+t(260))&&o[t(261)](e+"input")?V():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(253)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(){const t=["\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#112233","线原颜色","#999","#000","constructor","while (true) {}","__proto__",'{}.constructor("return this")( )',"info","string","效果参数","log","19532rulCwG","trace","4mVsRNN","init","function *\\( *\\)","speed","94996nqHjMy","130cByqye","action","线扫颜色","scale","prototype","error","92655UYshzo","toString","bind","395oPkTER","2145077UQZMcV","console","apply","return (function() ","exception","model","length","gger","51VRAocF","chain","test","最大扩散","3343753xwCUMM","addBinding","counter","#FFF","23742CvOELZ","srcColor","city","3860432GkcgTU","warn"];return(D=function(){return t})()}Z(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(254)+t(229)+");")()}catch(o){n=window}return n}(),o=n[t(252)]=n[t(252)]||{},e=[t(233),t(271),t(230),t(246),t(255),"table",t(235)];for(let r=0;r<e[t(257)];r++){const n=Z[t(226)][t(245)].bind(Z),i=e[r],u=o[i]||n;n[t(228)]=Z.bind(Z),n[t(248)]=u[t(248)][t(249)](u),o[i]=n}}))();const U=f({__name:"buildingsEffectA",async setup(e){const r=L;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(266),srcColor:r(276),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(232),expanded:!0});return s[r(264)](a,r(268),{label:r(274)}),s.addBinding(a,"color",{label:r(243)}),s.addBinding(a,r(239),{label:"速度",min:.1,max:1,step:.1}),s[r(264)](a,r(244),{label:r(262),min:10,max:2e3,step:10}),s[r(264)](a,"gradual",{label:"扩散系数",min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),C(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[_(P,{model:g(c),bulidingsColor:"#000000",landColor:e(273),topColor:e(275)},null,8,[e(256)]),_(E,b({builds:g(c)[e(269)]},a),null,16,["builds"])])),_:1})}}});function V(t){function n(t){const o=L;if(typeof t===o(231))return function(t){}[o(226)](o(227)).apply(o(265));1!==(""+t/t)[o(257)]||t%20==0?function(){return!0}[o(226)]("debugger").call(o(242)):function(){return!1}[o(226)]("debu"+o(258)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as default};
