import{P as t}from"./tweakpane.yDiyAAkA1738919103432.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.ArRVHI6l1738919103432.js";import{e}from"./@tresjs.G4idgyWs1738919103432.js";import{z as r}from"./three-custom-shader-material.Z8kEU4301738919103432.js";import{_ as i,a0 as u,C as c,cj as a,l as s,b9 as l}from"./three.CYhYNU4g1738919103432.js";import{d as f,a2 as p,w as d,o as m,H as v,u as g,a3 as h,r as y,f as C,g as w,j as b,m as _}from"./@vue.NRI7TcgI1738919103432.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1738919103432.js";import"./@vueuse.DL3Lluw_1738919103432.js";const x=M;!function(t,n){const o=M,e=T();for(;;)try{if(837942===-parseInt(o(435))/1*(-parseInt(o(437))/2)+parseInt(o(426))/3*(parseInt(o(450))/4)+-parseInt(o(464))/5*(parseInt(o(473))/6)+-parseInt(o(481))/7+-parseInt(o(423))/8+-parseInt(o(476))/9+-parseInt(o(463))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(t,n){const o=T();return(M=function(t,n){return o[t-=423]})(t,n)}!function(){I(this,(function(){const t=M,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=O("init");n[t(424)](e+t(439))&&o[t(424)](e+"input")?O():e("0")}))()}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(431)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();S(void 0,(function(){const t=M;let n;try{n=Function("return (function() "+t(448)+");")()}catch(r){n=window}const o=n[t(470)]=n[t(470)]||{},e=[t(432),t(451),t(471),"error","exception","table",t(486)];for(let i=0;i<e[t(442)];i++){const n=S[t(455)][t(483)].bind(S),r=e[i],u=o[r]||n;n[t(449)]=S[t(452)](S),n[t(430)]=u[t(430)][t(452)](u),o[r]=n}}))();const j=[x(459)];function T(){const t=["MeshBasicMaterial",'{}.constructor("return this")( )',"__proto__","48NYRDdR","warn","bind","#112233","value","constructor","setStyle","string","bModel","object","renderOrder","material","uGradient","6422320HCYSzX","5VWnkbm","gger","#ffff00","primitive","topColor","city","console","info","computeBoundingSphere","1818294mLTsjM","__csm","computeBoundingBox","421056RItOuC","bulidingsColor","uOpacity","landColor","call","5287457CVcbiD","counter","prototype","gradient","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","trace","889096ojQcsW","test","children","341622pZgBRn","action","DoubleSide","land","toString","apply","log","debu","clone","190001XWuidu","opacity","14XTILhZ","uTime","chain","uniforms","while (true) {}","length","model","color","boundingBox","isArray"];return(T=function(){return t})()}const B=f({__name:x(458),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:x(453)},topColor:{default:x(466)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,a=o.model[n(469)];o[n(443)][n(443)][n(425)][0].material=new(i[n(447)])({color:n(466)}),a[n(460)]=1001;const s=o[n(443)][n(429)];(()=>{const t=n,{geometry:e}=a;e[t(475)](),e[t(472)]();const{max:u,min:s}=e[t(445)];if(a[t(461)][t(474)])return;const l=new r({baseMaterial:a[t(461)],vertexShader:t(485),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:u},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(o[t(477)])},uOpacity:{value:o.opacity},uLightColor:{value:new c("#ffffff")},uTopColor:{value:new c(o[t(468)])},uTime:{value:0},uGradient:{value:o[t(484)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(428)]});a[t(461)].dispose(),a[t(461)]=l})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a[o(461)].uniforms[o(438)].value+=t})),p((()=>{const t=n;o[t(477)]&&a[t(461)][t(440)].uColor[t(454)][t(456)](o[t(477)]),o[t(479)]&&((t,e)=>{const r=n;let i;"cu"===t||t===r(429)&&(i=Array[r(446)](s.material)?s[r(461)]:[s[r(461)]],i.forEach((t=>{const n=r;t[e][n(456)](o[n(479)]),t.side=u})))})(t(429),t(444)),o[t(436)]&&(a[t(461)][t(440)][t(478)][t(454)]=o.opacity)})),d(o,((t,o)=>{const e=n;a.material[e(440)][e(462)][e(454)]=t[e(484)]}));const f=o.model.model[n(434)]();return(t,o)=>{const e=n;return m(),v(e(467),{object:g(f)},null,8,j)}}});function O(t){function n(t){const o=M;if(typeof t===o(457))return function(t){}[o(455)](o(441)).apply(o(482));1!==(""+t/t)[o(442)]||t%20==0?function(){return!0}.constructor(o(433)+o(465))[o(480)](o(427)):function(){return!1}.constructor(o(433)+"gger")[o(431)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function P(){const t=["gradual","debu","uniforms","test","2634432lJJLBi","stateObject","clone","error","speed","constructor","gger","width","113028wdbpdm","builds","uColor","action","scale","953866ciusyM","call","__proto__","renderOrder","4TWwbpW","uSrcColor","22984exqISb","init","trace","322237FUhyCN","length","1099CGSwpB","bind","srcColor","uTime","color","input","uGradual","8127144ThdpIL","140KsQNlo","apply","object","while (true) {}","warn","matrix","13555470JuDLzI","value","log","geometry","toString","return (function() ","prototype","info","console","exception","linewidth"];return(P=function(){return t})()}const z=A;!function(t,n){const o=A,e=P();for(;;)try{if(503906===-parseInt(o(306))/1+parseInt(o(297))/2+-parseInt(o(284))/3*(-parseInt(o(301))/4)+parseInt(o(263))/5*(-parseInt(o(292))/6)+parseInt(o(308))/7*(parseInt(o(303))/8)+parseInt(o(262))/9+-parseInt(o(269))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){F(this,(function(){const t=A,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=G(t(304));n[t(283)](e+"chain")&&o[t(283)](e+t(260))?G():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(264)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();L(void 0,(function(){const t=A,n=function(){const t=A;let n;try{n=Function(t(274)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(277)]=n.console||{},e=[t(271),t(267),t(276),t(287),t(278),"table",t(305)];for(let r=0;r<e[t(307)];r++){const n=L[t(289)][t(275)][t(309)](L),i=e[r],u=o[i]||n;n[t(299)]=L.bind(L),n[t(273)]=u[t(273)].bind(u),o[i]=n}}))();const R=[z(265)],W=f({__name:"bLine",props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=z,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o[n(259)])},uSrcColor:{value:new c(o.srcColor)},uScale:{value:o.scale},uTime:{value:0},uGradual:{value:o[n(280)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o[n(293)][n(272)])[n(286)]();u=u.applyMatrix4(o[n(293)][n(268)]);const f=new s(i);r=new l(u,f),r.material[n(279)]=o[n(291)],r[n(300)]=1e3,p((()=>{const t=n;o[t(259)]&&(i[t(282)][t(294)][t(270)]=new c(o.color)),o[t(310)]&&(i.uniforms[t(302)][t(270)]=new c(o.srcColor)),o[t(296)]&&(i[t(282)].uScale[t(270)]=o[t(296)]),o[t(280)]&&(i[t(282)][t(261)][t(270)]=o[t(280)])}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i[e(282)][e(311)][e(270)]+=t*o[e(288)],i[e(282)][e(311)][e(270)]%=1})),(t,n)=>(m(),v("primitive",{object:g(r)},null,8,R))}});function A(t,n){const o=P();return(A=function(t,n){return o[t-=259]})(t,n)}function G(t){function n(t){const o=A;if("string"==typeof t)return function(t){}[o(289)](o(266)).apply("counter");1!==(""+t/t)[o(307)]||t%20==0?function(){return!0}[o(289)]("debu"+o(290))[o(298)](o(295)):function(){return!1}[o(289)](o(281)+o(290)).apply(o(285)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const E=V;!function(t,n){const o=V,e=k();for(;;)try{if(286651===-parseInt(o(303))/1*(parseInt(o(269))/2)+-parseInt(o(277))/3+-parseInt(o(283))/4*(parseInt(o(270))/5)+parseInt(o(301))/6+-parseInt(o(311))/7+-parseInt(o(278))/8*(parseInt(o(300))/9)+parseInt(o(286))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(274)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=V,n=new RegExp(t(279)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=H(t(267));n[t(312)](e+t(298))&&o[t(312)](e+t(265))?H():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(274)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(){const t=["call","trace","addBinding","chain","gradual","4053123yhvzLs","1309704VfVvsS","scale","316343ojbWxP","bind","prototype","#000000","srcColor","exception","toString","color","251951YMXNVC","test","speed","model","table","input","buildingsEffectA","init","效果参数","2XpedRB","15JOqUZt","线原颜色","扩散系数","gger","apply","__proto__","debu","1612884obuEzI","8kskrna","function *\\( *\\)","string","info","builds","461696WIYGLn","console","length","17549500xdzaUs","city","counter","#000","action","log","线扫颜色",'{}.constructor("return this")( )',"constructor"];return(k=function(){return t})()}function V(t,n){const o=k();return(V=function(t,n){return o[t-=263]})(t,n)}D(void 0,(function(){const t=V,n=function(){const t=V;let n;try{n=Function("return (function() "+t(293)+");")()}catch(o){n=window}return n}(),o=n[t(284)]=n[t(284)]||{},e=[t(291),"warn",t(281),"error",t(308),t(264),t(296)];for(let r=0;r<e[t(285)];r++){const n=D[t(294)][t(305)][t(304)](D),i=e[r],u=o[i]||n;n[t(275)]=D.bind(D),n[t(309)]=u[t(309)][t(304)](u),o[i]=n}}))();const $=f({__name:E(266),async setup(e){const r=E;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:"#FFF",srcColor:r(289),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(268),expanded:!0});return s[r(297)](a,r(307),{label:r(271)}),s[r(297)](a,r(310),{label:r(292)}),s.addBinding(a,r(313),{label:"速度",min:.1,max:1,step:.1}),s[r(297)](a,r(302),{label:"最大扩散",min:10,max:2e3,step:10}),s[r(297)](a,r(299),{label:r(272),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),C(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[b(B,{model:g(c),bulidingsColor:e(306),landColor:"#112233",topColor:"#999"},null,8,[e(263)]),b(W,_({builds:g(c)[e(287)]},a),null,16,[e(282)])])),_:1})}}});function H(t){function n(t){const o=V;if(typeof t===o(280))return function(t){}[o(294)]("while (true) {}")[o(274)](o(288));1!==(""+t/t)[o(285)]||t%20==0?function(){return!0}[o(294)](o(276)+o(273))[o(295)](o(290)):function(){return!1}[o(294)](o(276)+"gger").apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
