import{$ as e,N as t}from"./@tresjs.bNNpPzYW1722507394274.js";import{a6 as o,cj as n}from"./three.Brogx0uK1722507394274.js";import{l as r}from"./utils.CuCN1ddQ1722507394274.js";import{i as s,m as a,a as i,b as l,c as p,u as c,f as u}from"./mapShow.DZNcURPz1722507394274.js";import{g as f}from"./gsap.BMhr3K_w1722507394274.js";import"./index.CtghvfIK1722507394274.js";import{d,w as m,b as h,a4 as y,q as g,o as v,D as x,J as S,F as z,V as C,u as b,I as T,f as I}from"./@vue.CFXy4cc91722507394274.js";import{a as w,_ as j}from"./three-mesh-ui.module.CptYztN01722507394274.js";import{m as N}from"./d3-geo.B-0wAziC1722507394274.js";const k=G;!function(e,t){const o=G,n=_();for(;;)try{if(452205===-parseInt(o(296))/1+parseInt(o(316))/2*(-parseInt(o(309))/3)+-parseInt(o(300))/4+parseInt(o(341))/5*(-parseInt(o(323))/6)+-parseInt(o(339))/7*(parseInt(o(312))/8)+parseInt(o(303))/9+parseInt(o(301))/10*(parseInt(o(335))/11))break;n.push(n.shift())}catch(r){n.push(n.shift())}}();const A=function(){let e=!0;return function(t,o){const n=e?function(){if(o){const e=o[G(305)](t,arguments);return o=null,e}}:function(){};return e=!1,n}}();function _(){const e=["DoubleSide","length","parent","log","debu","set","exception","gger","return (function() ","11fqGyvi","prototype","toString","function *\\( *\\)","119oGayhh","string","470yfqNAP","console","textContent","42060wHzYsc","init","Color","fontColor","1906960ZlMDji","15000730bNXZeC","provinceName","3256623IxsWNC","counter","apply","test","table","while (true) {}","170607cZqfKe","trace","error","149552LSFReZ","constructor","invertAlpha","input","2pjQhVQ","stateObject","action","threeMeshUIUpdate","bind","zIndex","add","32952YtQmKt","chain","info"];return(_=function(){return e})()}!function(){A(this,(function(){const e=G,t=new RegExp(e(338)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),n=L(e(297));t[e(306)](n+e(324))&&o[e(306)](n+e(315))?L():n("0")}))()}();const M=function(){let e=!0;return function(t,o){const n=e?function(){if(o){const e=o[G(305)](t,arguments);return o=null,e}}:function(){};return e=!1,n}}();function G(e,t){const o=_();return(G=function(e,t){return o[e-=294]})(e,t)}M(void 0,(function(){const e=G;let t;try{t=Function(e(334)+'{}.constructor("return this")( ));')()}catch(r){t=window}const o=t.console=t[e(294)]||{},n=[e(329),"warn",e(325),e(311),e(332),e(307),e(310)];for(let s=0;s<n[e(327)];s++){const t=M[e(313)][e(336)].bind(M),r=n[s],a=o[r]||t;t.__proto__=M[e(320)](M),t[e(337)]=a[e(337)][e(320)](a),o[r]=t}}))();const B=d({__name:k(302),props:{parent:{},textContent:{},fontColor:{default:"#fff"},fontSize:{default:6},invertAlpha:{type:Boolean,default:!1},zIndex:{default:0},threeMeshUIUpdate:{type:Boolean,default:!1}},setup(t){const n=k,r=t,s=new w({width:r.fontSize/10,textContent:r[n(295)],color:new(o[n(298)])(r[n(299)]),fontSide:o[n(326)],fontSize:r.fontSize/50,fontFamily:"./plugins/digitalMapBlock/font/province-msdf.json",fontTexture:"./plugins/digitalMapBlock/font/province.png",textAlign:"center",invertAlpha:r.invertAlpha});s.position[n(331)](0,0,.001*r[n(321)]),r[n(328)][n(322)](s);const{onLoop:a}=e();return a((()=>{r[n(319)]&&j()})),m((()=>[r[n(299)],r[n(314)],r.fontSize]),(([e,t,r])=>{const a=n;s[a(331)]({fontSize:r/50,color:new(o[a(298)])(e),width:r/10,invertAlpha:t})}),{immediate:!0}),(e,t)=>null}});function L(e){function t(e){const o=G;if(typeof e===o(340))return function(e){}.constructor(o(308))[o(305)](o(304));1!==(""+e/e)[o(327)]||e%20==0?function(){return!0}.constructor(o(330)+o(333)).call(o(318)):function(){return!1}[o(313)](o(330)+o(333))[o(305)](o(317)),t(++e)}try{if(e)return t;t(0)}catch(o){}}const O=["properties","pName"],U=["args"],R=["renderOrder","pName"],Z=["position"],E=["color"],P=["pName","position"],q=["position-z","scale","renderOrder"],F=["color","blending","map"],$={__name:"indexMeshUI",props:{lineColor:"#2bc4dc",topColor:"#f5f5f5",sideColor:"#00407c",iconColor:"#2bc4dc",fontColor:"#fff",fontSize:8,iconSize:.3,invertAlpha:!1,moveRoom:1.5,roughness:.8,metalness:.5,normalScale:6,geoJsonUrl:"",areaScale:{type:Number,default:10},centerCoordinates:{type:Array,default:[104,37.5]},showTextIcons:{type:Boolean,default:!0}},async setup(o){let d,w;const j=o,k=h(null);s();const A=N().center(j.centerCoordinates).scale(j.areaScale).translate([0,0]),_=h({depth:.66,bevelEnabled:!0,bevelSegments:1,bevelThickness:.1}),M=_.value.depth+.11,G=([d,w]=y((()=>r(j.geoJsonUrl,"features"))),d=await d,w(),d),{areaList:L,linesList:$,textList:D}=a(G,A),J=[([d,w]=y((()=>i(j.roughness,j.metalness,j.normalScale))),d=await d,w(),d),([d,w]=y((()=>l(j.sideColor))),d=await d,w(),d)],{onLoop:Q}=e();Q((()=>{J[1].map.offset.y+=.002}));const V=h(null);g((()=>{let{boxSize:e,box3:t}=p(V.value.children[0]);V.value.children[0].children.map(((o,n)=>{"Mesh"===o.type&&(o.geometry.computeBoundsTree(),c(o.geometry,e.x,e.y,t.min.x,t.min.y))})),V.value.rotation.x=-Math.PI/2,setTimeout((()=>{H(j.fontColor,j.shadowColor,j.fontSize)}),600)}));const K=(e,t)=>{let o=j.moveRoom,n=e.object;t||(n=e.eventObject,o=1);u(V.value,n.pName).map((e=>{"block"===e.pType&&f.to(e.scale,{duration:.3,z:o}),"line"===e.pType&&f.to(e.position,{duration:.3,z:M*o}),"text"===e.pType&&f.to(e.position,{duration:.3,z:M*o})}))},W=e=>{K(e,!0),document.body.style.cursor="pointer",e.stopPropagation()},Y=e=>{K(e,!1),document.body.style.cursor="default"};m((()=>[j.topColor,j.sideColor,j.roughness,j.metalness,j.normalScale]),(([e,t,o,n,r,s])=>{J[0].color.set(e),J[1].color.set(t),J[0].roughness=o,J[0].metalness=n,J[0].normalScale.set(r,r)}),{immediate:!0});const H=(e,t,o)=>{};m((()=>[j.fontColor,j.shadowColor,j.fontSize]),(([e,t,o])=>{}),{immediate:!0});const{map:X}=([d,w]=y((()=>t({map:"./plugins/digitalMapBlock/images/icon.png"}))),d=await d,w(),d);return(e,t)=>(v(),x("TresGroup",{ref_key:"groupRef",ref:V},[S("TresGroup",null,[(v(!0),x(z,null,C(b(L),((e,t)=>(v(),x("TresMesh",{key:"".concat(t),properties:e.properties,renderOrder:1,material:J,pName:e.pName,pType:"block",onPointerEnter:W,onPointerLeave:Y},[S("TresExtrudeGeometry",{args:[e.shape,_.value]},null,8,U)],40,O)))),128))]),S("TresGroup",null,[(v(!0),x(z,null,C(b($),((e,t)=>(v(),x("TresLine",{key:"".concat(t),renderOrder:t+1e4,pName:e.pName,"position-z":M,pType:"line"},[S("TresBufferGeometry",{position:[e.points,3]},null,8,Z),S("TresLineBasicMaterial",{color:o.lineColor},null,8,E)],8,R)))),128))]),o.showTextIcons?(v(),x("TresGroup",{key:0,ref_key:"tGroupText",ref:k},[(v(!0),x(z,null,C(b(D),((e,t)=>(v(),x("TresGroup",{key:"".concat(t),pName:e.pName,pType:"text",position:[e.position[0],e.position[1],M]},[k.value&&0!==k.value.children.length?(v(),I(B,{key:0,parent:k.value.children[t],textContent:e.pName,fontColor:j.fontColor,invertAlpha:j.invertAlpha,fontSize:j.fontSize,zIndex:t},null,8,["parent","textContent","fontColor","invertAlpha","fontSize","zIndex"])):T("",!0),S("TresSprite",{"position-z":o.iconSize,scale:o.iconSize,renderOrder:t+11e3},[S("TresSpriteMaterial",{color:o.iconColor,blending:n,map:b(X),transparent:"",depthWrite:!1,depthTest:""},null,8,F)],8,q)],8,P)))),128))],512)):T("",!0)],512))}};export{$ as _};
