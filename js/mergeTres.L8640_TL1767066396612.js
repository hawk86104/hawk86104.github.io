import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{A as a}from"./@amap.fjyZdsU91767066396612.js";import{_ as t}from"./@fesjs.BK66sTPr1767066396612.js";import{F as o}from"./@tresjs.B1f7s3pS1767066396612.js";import{d as n}from"./pinia.CiNhMlOJ1767066396612.js";const{shallowRef:r}=await e("vue"),l=n("mapStore",()=>({aMap:r(null),mapHandle:r(null),cameraState:r(null)})),{defineComponent:s}=await e("vue"),{openBlock:p,createElementBlock:m}=await e("vue"),c={id:"mapContainer"},{onMounted:u}=await e("vue"),i=t(s({__name:"mapContainer",props:{center:{default:[0,0]},zoom:{default:14},pitch:{default:50},mapStyle:{default:"normal"}},setup(e){const t=e,o=l();let n=null;return u(async()=>{await a.load({key:"0c7222955570f1b434c4adfcc1e955e8",version:"2.0"}).then(e=>{n=new e.Map("mapContainer",{center:t.center,zooms:[1,20],viewMode:"3D",zoom:t.zoom,pitch:t.pitch,mapStyle:"amap://styles/"+t.mapStyle}),n.on("click",e=>{const a=`您在 [ ${e.lnglat.getLng()},${e.lnglat.getLat()} ] 的位置单击了地图！`;console.log(a)}),o.$patch({aMap:e}),o.$patch({mapHandle:n})}).catch(e=>{console.log(e)})}),(e,a)=>(p(),m("div",c))}}),[["__scopeId","data-v-e1a7e2c4"]]),{watchEffect:d}=await e("vue"),f={__name:"mergeTres",props:{center:{default:[0,0]}},setup(e){const a=e,{camera:t,scene:n,renderer:r}=o(),s=l();let p=null,m=null;return d(()=>{s.aMap&&(p=s.mapHandle.customCoords,m=new s.aMap.CustomLayer(r.domElement,{zIndex:10,render:()=>{r.resetState(),p.setCenter(a.center);const{near:e,far:o,fov:l,up:m,lookAt:c,position:u}=p.getCameraParams();t.value.near=e,t.value.far=o,t.value.fov=l,s.$patch({cameraState:{near:e,far:o,fov:l,position:u}}),t.value.position.set(...u),t.value.up.set(...m),t.value.lookAt(...c),t.value.updateProjectionMatrix(),r.render(n.value,t.value),r.resetState()},alwaysRender:!0}),s.mapHandle.add(m))}),(e,a)=>null}};export{f as _,i as m,l as u};
