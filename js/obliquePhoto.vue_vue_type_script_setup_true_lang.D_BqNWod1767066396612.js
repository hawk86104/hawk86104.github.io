import{i as e,A as t}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as o,_ as r}from"./@tresjs.B1f7s3pS1767066396612.js";import{a as s,b as a}from"./utils.C8p1eAWw1767066396612.js";const{defineComponent:i}=await e("vue"),{unref:l,createElementVNode:n,openBlock:u,createElementBlock:p}=await e("vue"),d=["object"],{watch:m,ref:c}=await e("vue"),f=i({__name:"obliquePhoto",props:{tilesUrl:{default:"./plugins/geokit/tiles/tileset.json"},isRotation:{type:Boolean,default:!1},isRranslation:{type:Boolean,default:!0}},setup(e,{expose:i}){const f=e,v=c(null),{camera:R,renderer:g,sizes:j}=o(),w=(e,t,o)=>{e.setCamera(t),e.setResolutionFromRenderer(t,o)},B=()=>{let e=new t(f.tilesUrl);return e.fetchOptions.mode="cors",e.addEventListener("load-tile-set",()=>{a(e,f.isRotation,f.isRranslation)}),e.addEventListener("dispose-model",({scene:e})=>{e.traverse(e=>{e.material&&e.material.dispose()})}),w(e,R.value,g),e};let _=B();m(()=>[f.isRotation,f.isRranslation],()=>{_.group&&s(_.group,f.isRotation,f.isRranslation)}),m(R,()=>{R.value&&w(_,R.value,g)},{immediate:!0});const{onBeforeRender:b}=r();return b(()=>{R.value&&j.width.value&&_.update&&(R.value.updateMatrixWorld(),_.update())}),m(()=>f.tilesUrl,e=>{e!==_.rootURL&&(_.dispose(),_=B())}),i({group:v,tilesGroup:_.group}),(e,t)=>(u(),p("TresGroup",{ref_key:"groupRef",ref:v},[n("primitive",{object:l(_).group},null,8,d)],512))}});export{f as _};
