import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as r,r as o}from"./@tresjs.B1f7s3pS1767066396612.js";import{R as t,a as i}from"./OimoPhysicsController.DV_wbu041767066396612.js";import{f as l}from"./utils.CNife3_q1767066396612.js";const{defineComponent:n}=await e("vue"),{unref:a,createElementVNode:s,openBlock:f,createElementBlock:m,createCommentVNode:c}=await e("vue"),u={key:0},p=["object"],d=["object"],{Vector2:w,PlaneGeometry:h,Mesh:v,RepeatWrapping:g,Color:x,GridHelper:j}=await e("three"),{watchEffect:y,watch:S}=await e("vue"),b=n({__name:"reflectorShaderMesh",props:{reflectivity:{default:.2},mirror:{default:.1},mixStrength:{default:9},showGridHelper:{type:Boolean,default:!0},color:{default:"#ffffff"}},setup(e){const n=e,{scene:b}=r(),{textures:M,isLoading:_}=o(["./plugins/floor/image/concrete_wet_floor_basecolor.jpg","./plugins/floor/image/concrete_wet_floor_normal.jpg"]);let G=null,C=null,R=null;return S([M,_],([e,r])=>{if(e&&2===e.length&&!r){e[0].wrapS=g,e[0].wrapT=g,e[1].wrapS=g,e[1].wrapT=g;const r=new t;G=new i({reflectivity:n.reflectivity,mirror:n.mirror,mixStrength:n.mixStrength,color:new x(n.color),map:e[0],normalMap:e[1],normalScale:new w(5,5),fog:b.value.fog,dithering:!0}),G.uniforms.tReflect=r.renderTargetUniform,G.uniforms.uMatrix=r.textureMatrixUniform;const o=new h(10,10);C=new v(o,G),C.name="reflectorShaderMesh",C.position.y=-.01,C.rotation.x=-Math.PI/2,C.add(r),C.onBeforeRender=(e,o,t)=>{C.visible=!1,l(o),r.update(e,o,t),l(o,!1),C.visible=!0},R=new j(9.5,10),R.visible=n.showGridHelper}}),y(()=>{n.reflectivity&&G&&(G.uniforms.uReflectivity.value=n.reflectivity),n.mirror&&G&&(G.uniforms.uMirror.value=n.mirror),n.mixStrength&&G&&(G.uniforms.uMixStrength.value=n.mixStrength),n.color&&G&&(G.uniforms.uColor.value=new x(n.color))}),S(()=>n.showGridHelper,e=>{R.visible=e}),(e,r)=>a(_)?c("",!0):(f(),m("TresGroup",u,[s("primitive",{object:a(C)},null,8,p),s("primitive",{object:a(R),position:[0,.01,0]},null,8,d)]))}});export{b as _};
