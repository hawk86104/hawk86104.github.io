import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.1S7QjIhd1728703368826.js";import{bZ as n,_ as e,bX as o,c6 as r,m as i,C as s,ch as u}from"./three.VoknrmS61728703368826.js";import{p as c,U as a}from"./@tresjs.JhHPALEY1728703368826.js";import{d as l,a3 as p,r as f,o as d,f as v,g as m,j as h,aj as x,ak as w}from"./@vue.JNsx1iN61728703368826.js";import{P as g}from"./tweakpane.yHWGBmom1728703368826.js";import"./three-custom-shader-material.3rBk2L9x1728703368826.js";import"./object-hash.gPx1SZYa1728703368826.js";import"./@amap.LlG4vVLC1728703368826.js";import"./jszip.VrfDZcNx1728703368826.js";import"./glsl-tokenizer.N1Ao8h3g1728703368826.js";import"./glsl-token-string.bxQbWgRM1728703368826.js";import"./glsl-token-functions.5GJf-mGG1728703368826.js";import"./@vueuse.yeA714RM1728703368826.js";const P=y;!function(t,n){const e=y,o=b();for(;;)try{if(893638===parseInt(e(193))/1+-parseInt(e(223))/2*(-parseInt(e(224))/3)+-parseInt(e(214))/4*(-parseInt(e(215))/5)+parseInt(e(203))/6*(parseInt(e(209))/7)+parseInt(e(192))/8*(-parseInt(e(179))/9)+parseInt(e(176))/10+-parseInt(e(207))/11)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const S=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[y(225)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function b(){const t=["104NJjpOk","637062SRjutN","width","table","set","string","depthBuffer","stateObject","prototype","while (true) {}","init","6TxzjAf","#FFF","input","exception","33695475xLASya","material","7422457tbbaWK","uWidth","uPosition","test","trace","1689132SKVoAd","5SldGao","addPass","chain","buildingsPassA","DepthTexture","gger","error","length","1186Iwgmio","2433wLdfeY","apply","readBuffer","value","toString",'{}.constructor("return this")( )',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","16590270QVOakt","action","constructor","209619rVYeDK","color","debu","uniforms","call","uScalenum","depthTexture","uScaleone","Vector2","function *\\( *\\)","counter","Color","bind"];return(b=function(){return t})()}function y(t,n){const e=b();return(y=function(t,n){return e[t-=175]})(t,n)}!function(){S(this,(function(){const t=y,n=new RegExp(t(188)),e=new RegExp(t(175),"i"),o=_(t(202));n[t(212)](o+t(217))&&e[t(212)](o+t(205))?_():o("0")}))()}();const j=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();j(void 0,(function(){const t=y;let n;try{n=Function("return (function() "+t(229)+");")()}catch(r){n=window}const e=n.console=n.console||{},o=["log","warn","info",t(221),t(206),t(195),t(213)];for(let i=0;i<o[t(222)];i++){const n=j[t(178)][t(200)][t(191)](j),r=o[i],s=e[r]||n;n.__proto__=j.bind(j),n[t(228)]=s[t(228)].bind(s),e[r]=n}}))();const I=l({__name:P(218),props:{color:{default:P(204)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const l=t,{renderer:f,scene:d,camera:v,sizes:m}=c();let h,x=0,w=null,g=null;p((()=>{const t=y;m[t(194)][t(227)]&&(h=m[t(194)][t(227)],x=m.height.value,(()=>{const t=y;w=new n(f.value);const c=new(e[t(219)])(h,x);w.readBuffer[t(198)]=!0,w[t(226)][t(185)]=c;const a=new o(d[t(227)],v[t(227)]);w[t(216)](a),g=new r(new i({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:c},uProjectionInverse:{value:v[t(227)].projectionMatrixInverse},uMatrixWorld:{value:v[t(227)].matrixWorld},uColor:{value:new s(l[t(180)])},uScalenum:{value:l[t(184)]},uScaleone:{value:l[t(186)]},uWidth:{value:l[t(210)]},uPosition:{value:new(e[t(187)])(l[t(211)].x,l[t(211)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),w[t(216)](g);const p=new r(u);w.addPass(p)})())}));const{onLoop:P}=a();return P((({elapsed:t})=>{const n=y;w&&(w.render(),g[n(182)].time[n(227)]+=l.speed/60)})),p((()=>{const t=y;g&&(l.color&&(g[t(208)][t(182)].uColor[t(227)]=new(e[t(190)])(l.color)),l[t(184)]&&(g[t(208)].uniforms[t(184)][t(227)]=l.uScalenum),l[t(186)]&&(g[t(208)][t(182)][t(186)][t(227)]=l[t(186)]),l.uWidth&&(g[t(208)][t(182)][t(210)][t(227)]=l[t(210)]),l[t(211)]&&g[t(208)][t(182)][t(211)][t(227)][t(196)](l[t(211)].x,l[t(211)].y))})),(t,n)=>null}});function _(t){function n(t){const e=y;if(typeof t===e(197))return function(t){}[e(178)](e(201))[e(225)](e(189));1!==(""+t/t).length||t%20==0?function(){return!0}[e(178)]("debu"+e(220))[e(183)](e(177)):function(){return!1}[e(178)](e(181)+e(220))[e(225)](e(199)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function W(t,n){const e=A();return(W=function(t,n){return e[t-=110]})(t,n)}const D=W;!function(t,n){const e=W,o=A();for(;;)try{if(157449===-parseInt(e(126))/1+parseInt(e(125))/2*(parseInt(e(148))/3)+parseInt(e(121))/4+-parseInt(e(153))/5+-parseInt(e(115))/6+-parseInt(e(136))/7+parseInt(e(120))/8)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const z=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[W(144)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function A(){const t=["784710YiAIgs",'{}.constructor("return this")( )',"uPosition","uScaleone","constructor","3661280LEhsHs","881512StVypY","bind","counter","stateObject","2FDrDae","53769vvJBIu","log","warn","单条圈宽度","buildingsPassA","debu","table","error","__proto__","string","1278900CgrVye","length","test","最大范围","function *\\( *\\)","trace","speed","input","apply","addBinding","init","后期效果","54030xTYiiM","call","toString","单条圈间距","color","856725KmgDuo","inline","while (true) {}","gger","uWidth","圈颜色","console","info"];return(A=function(){return t})()}!function(){z(this,(function(){const t=W,n=new RegExp(t(140)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=C(t(146));n.test(o+"chain")&&e[t(138)](o+t(143))?C():o("0")}))()}();const F=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();F(void 0,(function(){const t=W;let n;try{n=Function("return (function() "+t(116)+");")()}catch(r){n=window}const e=n[t(113)]=n[t(113)]||{},o=[t(127),t(128),t(114),t(133),"exception",t(132),t(141)];for(let i=0;i<o[t(137)];i++){const n=F.constructor.prototype[t(122)](F),r=o[i],s=e[r]||n;n[t(134)]=F.bind(F),n[t(150)]=s.toString[t(122)](s),e[r]=n}}))();const k=l({__name:D(130),setup(n){const e=D,o=f({color:"#00b4fb",uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new g({title:e(147),expanded:!0});return r[e(145)](o,e(152),{label:e(112)}),r[e(145)](o,"uScalenum",{label:e(139),min:1,max:500,step:10}),r[e(145)](o,e(118),{label:e(151),min:1,max:100,step:1}),r[e(145)](o,e(111),{label:e(129),min:0,max:1,step:.01}),r[e(145)](o,e(142),{label:"速度",min:1,max:20,step:1}),r[e(145)](o,e(117),{picker:e(154),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(d(),v(t,{disableRender:!0,showAxesHelper:!1},{ability:m((()=>[h(I,x(w(o)),null,16)])),_:1}))}});function C(t){function n(t){const e=W;if(typeof t===e(135))return function(t){}[e(119)](e(155))[e(144)](e(123));1!==(""+t/t)[e(137)]||t%20==0?function(){return!0}[e(119)](e(131)+"gger")[e(149)]("action"):function(){return!1}[e(119)](e(131)+e(110))[e(144)](e(124)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{k as default};
