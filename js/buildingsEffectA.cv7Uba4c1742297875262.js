import{P as t}from"./tweakpane.yDiyAAkA1742297875262.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.SIpojq0z1742297875262.js";import{e}from"./@tresjs.oW7bfow21742297875262.js";import{z as r}from"./three-custom-shader-material.CRQk2ryt1742297875262.js";import{$ as i,_ as u,C as c,cs as a,l as s,b9 as l}from"./three.N4lg2KsY1742297875262.js";import{d as f,a2 as p,w as d,o as m,H as v,u as g,a3 as h,r as y,f as w,g as _,j as C,m as b}from"./@vue.NRI7TcgI1742297875262.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1742297875262.js";import"./postprocessing.9PKUyDJ51742297875262.js";import"./@vueuse.Y8_DCJgq1742297875262.js";const x=T;!function(t,n){const o=T,e=P();for(;;)try{if(491295===-parseInt(o(348))/1+parseInt(o(369))/2*(parseInt(o(390))/3)+parseInt(o(407))/4+parseInt(o(371))/5*(-parseInt(o(391))/6)+parseInt(o(392))/7*(-parseInt(o(399))/8)+parseInt(o(358))/9*(-parseInt(o(375))/10)+parseInt(o(376))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(381)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=T,n=new RegExp(t(374)),o=new RegExp(t(386),"i"),e=O(t(378));n[t(370)](e+"chain")&&o.test(e+t(344))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(381)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=T,n=function(){const t=T;let n;try{n=Function(t(351)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(346)]=n[t(346)]||{},e=[t(372),t(396),"info",t(353),t(343),t(408),t(382)];for(let r=0;r<e[t(410)];r++){const n=M[t(402)][t(354)][t(361)](M),i=e[r],u=o[i]||n;n[t(352)]=M[t(361)](M),n[t(380)]=u.toString.bind(u),o[i]=n}}))();const j=[x(406)];function T(t,n){const o=P();return(T=function(t,n){return o[t-=343]})(t,n)}const S=f({__name:"bModel",props:{model:{},bulidingsColor:{default:x(403)},landColor:{default:"#112233"},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,a=o.model[n(385)];o[n(366)].model[n(387)][0][n(347)]=new i({color:n(365)}),a[n(389)]=1001;const s=o.model[n(345)];(()=>{const t=n,{geometry:e}=a;e[t(388)](),e[t(362)]();const{max:i,min:s}=e[t(398)];if(a.material.__csm)return;const l=new r({baseMaterial:a[t(347)],vertexShader:t(379),fragmentShader:t(384),silent:!0,uniforms:{uMax:{value:i},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(o[t(394)])},uOpacity:{value:o[t(412)]},uLightColor:{value:new(u[t(359)])(t(367))},uTopColor:{value:new(u[t(359)])(o[t(405)])},uTime:{value:0},uGradient:{value:o[t(360)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:u[t(368)]});a[t(347)].dispose(),a.material=l})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a[o(347)][o(401)].uTime[o(411)]+=t})),p((()=>{const t=n;o[t(394)]&&a[t(347)][t(401)][t(395)].value[t(349)](o[t(394)]),o[t(404)]&&((t,e)=>{const r=n;let i;"cu"===t||t===r(345)&&(i=Array[r(373)](s[r(347)])?s.material:[s[r(347)]],i[r(377)]((t=>{const n=r;t[e][n(349)](o.landColor),t.side=u[n(368)]})))})(t(345),t(355)),o.opacity&&(a[t(347)][t(401)][t(356)][t(411)]=o.opacity)})),d(o,((t,o)=>{const e=n;a[e(347)].uniforms[e(409)][e(411)]=t[e(360)]}));const f=o[n(366)].model[n(364)]();return(t,n)=>(m(),v("primitive",{object:g(f)},null,8,j))}});function P(){const t=["boundingBox","5080kOlEGp","action","uniforms","constructor","#e523ff","landColor","topColor","object","2587168GJrZOy","table","uGradient","length","value","opacity","exception","input","land","console","material","571672jpMtDq","setStyle","debu","return (function() ","__proto__","error","prototype","color","uOpacity","while (true) {}","189TMsUdP","Color","gradient","bind","computeBoundingSphere","gger","clone","#ffff00","model","#ffffff","DoubleSide","1029338idtQoY","test","10OTlNjq","log","isArray","function *\\( *\\)","173560RpYTHh","10830413mpMEVT","forEach","init","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","toString","apply","trace","string","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","city","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","children","computeBoundingBox","renderOrder","3tvdpHc","1376658qhlOhK","2863qMtDPX","call","bulidingsColor","uColor","warn","stateObject"];return(P=function(){return t})()}function O(t){function n(t){const o=T;if(typeof t===o(383))return function(t){}[o(402)](o(357))[o(381)]("counter");1!==(""+t/t)[o(410)]||t%20==0?function(){return!0}[o(402)](o(350)+o(363))[o(393)](o(400)):function(){return!1}[o(402)](o(350)+o(363))[o(381)](o(397)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const F=G;!function(t,n){const o=G,e=z();for(;;)try{if(304169===parseInt(o(350))/1*(parseInt(o(338))/2)+-parseInt(o(354))/3+-parseInt(o(363))/4*(parseInt(o(349))/5)+-parseInt(o(321))/6*(parseInt(o(374))/7)+-parseInt(o(331))/8+-parseInt(o(352))/9*(parseInt(o(344))/10)+parseInt(o(322))/11*(parseInt(o(358))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(341)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=G,n=new RegExp(t(320)),o=new RegExp(t(359),"i"),e=D("init");n[t(366)](e+t(324))&&o[t(366)](e+"input")?D():e("0")}))()}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(341)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=G,n=function(){const t=G;let n;try{n=Function(t(373)+t(328)+");")()}catch(o){n=window}return n}(),o=n[t(325)]=n[t(325)]||{},e=[t(371),"warn",t(357),"error",t(323),t(364),t(369)];for(let r=0;r<e[t(330)];r++){const n=A[t(376)][t(337)][t(345)](A),i=e[r],u=o[i]||n;n[t(351)]=A.bind(A),n[t(367)]=u[t(367)][t(345)](u),o[i]=n}}))();const E=[F(356)];function G(t,n){const o=z();return(G=function(t,n){return o[t-=318]})(t,n)}const Z=f({__name:F(362),props:{builds:{},color:{default:F(332)},srcColor:{default:F(346)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=F,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o[n(365)])},uSrcColor:{value:new c(o[n(348)])},uScale:{value:o[n(329)]},uTime:{value:0},uGradual:{value:o[n(342)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o[n(319)][n(360)])[n(339)]();u=u.applyMatrix4(o[n(319)][n(326)]);const f=new s(i);r=new l(u,f),r.material[n(372)]=o.width,r[n(333)]=1e3,p((()=>{const t=n;o.color&&(i[t(353)].uColor.value=new c(o[t(365)])),o[t(348)]&&(i[t(353)][t(318)].value=new c(o[t(348)])),o[t(329)]&&(i[t(353)][t(347)][t(336)]=o[t(329)]),o[t(342)]&&(i[t(353)][t(334)][t(336)]=o.gradual)}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i[e(353)][e(361)][e(336)]+=t*o[e(340)],i[e(353)][e(361)][e(336)]%=1})),(t,o)=>{const e=n;return m(),v(e(355),{object:g(r)},null,8,E)}}});function z(){const t=["192071QBdHjj","exception","chain","console","matrix","counter",'{}.constructor("return this")( )',"scale","length","652104ZBKXvI","#FFF","renderOrder","uGradual","stateObject","value","prototype","266myKYcP","clone","speed","apply","gradual","gger","700aeqDuo","bind","#000","uScale","srcColor","67460kHqFip","4441wPjeyf","__proto__","44298FMXeHI","uniforms","1269675PbWKzO","primitive","object","info","516tYoFrT","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","geometry","uTime","bLine","12ICLOiT","table","color","test","toString","string","trace","action","log","linewidth","return (function() ","749qMaNPu","debu","constructor","uSrcColor","builds","function *\\( *\\)","8274otAyWc"];return(z=function(){return t})()}function D(t){function n(t){const o=G;if(typeof t===o(368))return function(t){}[o(376)]("while (true) {}")[o(341)](o(327));1!==(""+t/t)[o(330)]||t%20==0?function(){return!0}.constructor("debu"+o(343)).call(o(370)):function(){return!1}.constructor(o(375)+o(343))[o(341)](o(335)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const H=W;!function(t,n){const o=W,e=q();for(;;)try{if(346653===-parseInt(o(389))/1+-parseInt(o(424))/2+-parseInt(o(401))/3+parseInt(o(404))/4+-parseInt(o(393))/5+-parseInt(o(425))/6*(parseInt(o(427))/7)+parseInt(o(423))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(431)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){R(this,(function(){const t=W,n=new RegExp(t(426)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=$(t(406));n[t(422)](e+"chain")&&o[t(422)](e+"input")?$():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function q(){const t=["stateObject","test","9715144NiuuaP","190620UUNUnk","60ZebdKF","function *\\( *\\)","295211hYtacx","addBinding",'{}.constructor("return this")( )',"debu","apply","最大扩散","constructor","#999","counter","toString","效果参数","gger","info","403067qyIuwe","action","error","#FFF","580340tvylMD","while (true) {}","model","trace","#000000","线原颜色","扩散系数","length","324171jtQgJW","#000","call","1105968vRjiTn","srcColor","init","buildingsEffectA","return (function() ","table","exception","console","bind","warn","#112233","builds","__proto__","string","scale","prototype","log"];return(q=function(){return t})()}k(void 0,(function(){const t=W;let n;try{n=Function(t(408)+t(429)+");")()}catch(r){n=window}const o=n[t(411)]=n[t(411)]||{},e=[t(420),t(413),t(388),t(391),t(410),t(409),t(396)];for(let i=0;i<e[t(400)];i++){const n=k[t(382)][t(419)].bind(k),r=e[i],u=o[r]||n;n[t(416)]=k.bind(k),n[t(385)]=u[t(385)][t(412)](u),o[r]=n}}))();const L=f({__name:H(407),async setup(e){const r=H;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(392),srcColor:r(402),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(386),expanded:!0});return s[r(428)](a,r(405),{label:r(398)}),s[r(428)](a,"color",{label:"线扫颜色"}),s.addBinding(a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(428)](a,r(418),{label:r(432),min:10,max:2e3,step:10}),s.addBinding(a,"gradual",{label:r(399),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:_((()=>[C(S,{model:g(c),bulidingsColor:e(397),landColor:e(414),topColor:e(383)},null,8,[e(395)]),C(Z,b({builds:g(c).city},a),null,16,[e(415)])])),_:1})}}});function W(t,n){const o=q();return(W=function(t,n){return o[t-=382]})(t,n)}function $(t){function n(t){const o=W;if(typeof t===o(417))return function(t){}[o(382)](o(394))[o(431)](o(384));1!==(""+t/t)[o(400)]||t%20==0?function(){return!0}[o(382)](o(430)+o(387))[o(403)](o(390)):function(){return!1}.constructor(o(430)+o(387))[o(431)](o(421)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{L as default};
