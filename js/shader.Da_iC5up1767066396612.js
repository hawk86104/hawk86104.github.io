import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{_ as i,F as n,K as a,s as t,T as r}from"./@tresjs.B1f7s3pS1767066396612.js";import{P as o}from"./tweakpane.CqZAnw7f1767066396612.js";import{L as l}from"./three-subdivide.DUQhzu8i1767066396612.js";const{defineComponent:s}=await e("vue"),{normalizeProps:d,guardReactiveProps:c,createElementVNode:u,openBlock:m,createElementBlock:p}=await e("vue"),v=["scale"],f=await e("three"),{ref:g,watchEffect:h,watch:w}=await e("vue"),y=s({__name:"shineShader",props:{srcMesh:{},scale:{default:1.2},color:{default:"#ffff00"},subdivision:{type:Boolean,default:!0},c:{default:1.1},p:{default:1.4},side:{default:f.FrontSide},blending:{default:f.AdditiveBlending}},setup(e){const a=e,t=g(),r={uniforms:{c:{type:"f",value:a.c},p:{type:"f",value:a.p},glowColor:{type:"c",value:new f.Color(a.color)},viewVector:{type:"v3",value:{x:0,y:0,z:0}}},vertexShader:"\n          uniform vec3 viewVector;\n          uniform float c;\n          uniform float p;\n          varying float intensity;\n          void main() {\n            vec3 vNormal = normalize( normalMatrix * normal);\n            vec3 vNormel = normalize( normalMatrix * viewVector);\n            intensity = pow( c - dot(vNormal, vNormel), p );\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0);\n          }\n            ",fragmentShader:"\n          uniform vec3 glowColor;\n          varying float intensity;\n          void main() \n          {\n          \tvec3 glow = glowColor * intensity;\n\t\t\t\t\t\tif(intensity < 1.0){\n            \tgl_FragColor = vec4( glow, 1.0 );\n\t\t\t\t\t\t}\n          }\n        ",side:a.side,transparent:!0,depthWrite:!1,depthTest:!0,blending:a.blending};h(()=>{if(a.srcMesh&&t.value&&!t.value.geometry.attributes.position){let e=a.srcMesh.geometry.clone();a.subdivision&&(e=l.modify(e,2)),t.value.geometry=e,t.value.position.copy(a.srcMesh.position)}a.color&&(r.uniforms.glowColor.value=new f.Color(a.color)),a.c&&(r.uniforms.c.value=a.c),a.p&&(r.uniforms.p.value=a.p)}),w(()=>a.subdivision,e=>{let i=a.srcMesh.geometry.clone();e&&(i=l.modify(i,2)),t.value.geometry=i}),w(()=>a.side,e=>{t.value.material.side=e}),w(()=>a.blending,e=>{t.value.material.blending=e});const{onRender:o}=i(),{camera:s}=n();return o(()=>{s.value&&t.value&&(r.uniforms.viewVector.value=(new f.Vector3).subVectors(s.value.position,t.value.position))}),(e,i)=>(m(),p("TresMesh",{ref_key:"TSGref",ref:t,scale:a.scale},[u("TresShaderMaterial",d(c(r)),null,16)],8,v))}}),{defineComponent:M}=await e("vue"),{createElementVNode:B,unref:b,createVNode:T,withCtx:C,mergeProps:S,openBlock:_,createBlock:x,createCommentVNode:k,resolveComponent:V}=await e("vue"),N=["map"],j=["map"],A=await e("three"),{reactive:F,ref:P}=await e("vue"),z=M({__name:"shader",setup(e){const i={clearColor:"#222"},n=P(),l=P(),s=P(),d=F({scale:1.6,color:"#00dfff",subdivision:!0,c:1.1,p:1.4,side:A.FrontSide,blending:A.AdditiveBlending}),c=new o({title:"参数",expanded:!0});return c.addBinding(d,"color",{label:"颜色"}),c.addBinding(d,"scale",{label:"大小",min:1,max:3,step:.2}),c.addBinding(d,"subdivision",{label:"边缘处理"}),c.addBinding(d,"c",{label:"c",min:0,max:2,step:.1}),c.addBinding(d,"p",{label:"p",min:0,max:8,step:.2}),c.addBinding(d,"side",{options:{FrontSide:A.FrontSide,BackSide:A.BackSide,DoubleSide:A.DoubleSide}}),c.addBinding(d,"blending",{options:{AdditiveBlending:A.AdditiveBlending,NormalBlending:A.NormalBlending}}),(e,o)=>{const c=V("TresCanvas");return _(),x(c,S(i,{"window-size":""}),{default:C(()=>[o[2]||(o[2]=B("TresPerspectiveCamera",{position:[5,5,5]},null,-1)),o[3]||(o[3]=B("TresAmbientLight",{intensity:1},null,-1)),T(b(a)),o[4]||(o[4]=B("TresGridHelper",{args:[10,10]},null,-1)),T(b(t),{path:"./plugins/earthSample/image/earthA/earth.jpg"},{default:C(({state:e})=>[B("TresMesh",{ref_key:"TresMeshRefA",ref:n,position:[-2,1,0]},[o[0]||(o[0]=B("TresSphereGeometry",{args:[1,32,16]},null,-1)),B("TresMeshBasicMaterial",{map:e},null,8,N)],512)]),_:1}),T(y,S({srcMesh:n.value},d),null,16,["srcMesh"]),T(b(t),{path:"./logo.png"},{default:C(({state:e})=>[T(b(r),{ref_key:"TreBoxRef",ref:s,args:[1,1,1],position:[2,1,0]},{default:C(()=>[B("TresMeshBasicMaterial",{map:e},null,8,j)]),_:2},1536)]),_:1}),s.value&&s.value.instance?(_(),x(y,S({key:0,srcMesh:s.value.instance},d),null,16,["srcMesh"])):k("",!0),B("TresMesh",{ref_key:"TresMeshRefB",ref:l,position:[0,1,-2]},[...o[1]||(o[1]=[B("TresBoxGeometry",{args:[1,1,1,1,1]},null,-1),B("TresMeshBasicMaterial",{color:"#0ff"},null,-1)])],512),T(y,S({srcMesh:l.value},d),null,16,["srcMesh"])]),_:1},16)}}});export{z as default};
