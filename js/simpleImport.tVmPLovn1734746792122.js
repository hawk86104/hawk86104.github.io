var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;import{_ as r,bV as o,c0 as s,ak as i,am as c}from"./three.1FILWcBb1734746792122.js";import{m as a,e as u,U as l,c as p}from"./@tresjs.vA_UT8oy1734746792122.js";import{g as f,i as d,e as m}from"./utils.w5_FdyiC1734746792122.js";import{_ as h}from"./jszip.shhf2-t61734746792122.js";import{F as g}from"./file-saver.TdMqs0km1734746792122.js";import{P as v}from"./tweakpane.yHWGBmom1734746792122.js";import{d as y,q as w,r as b,X as j,a3 as E,o as I,D as O,j as S,g as L,J as P,u as R,aj as _,ak as T,f as x,al as k,m as z,F as J}from"./@vue.-THQH3GC1734746792122.js";import{v as C}from"./@fesjs.Y0rSBxCv1734746792122.js";import"./@vueuse.lqJslAkC1734746792122.js";import"./@amap.zNgKkCGX1734746792122.js";import"./vue-router.PPpNBBl21734746792122.js";import"./lodash-es.kYt-_xTG1734746792122.js";import"./@qlin.yHhFDldE1734746792122.js";import"./pinia.fA-Uqav61734746792122.js";import"./vue-demi.C4xddsk91734746792122.js";import"./@floating-ui.BPbuo5Gx1734746792122.js";import"./@juggle.7yjBMqoW1734746792122.js";const F=N;function N(t,n){const e=A();return(N=function(t,n){return e[t-=330]})(t,n)}function A(){const t=["scene","__proto__","34174tAbLWI","40gDSsUw","action","push","replace","getObjectByProperty","return (function() ","log","toString","addEventListener","2835780UxHROB","chain","bind","update","player,renderer,scene,camera","pointerdown","error","while (true) {}","stateObject","pointerup","972vLdJcN","3481444ygjfFr","console","length","table","prototype","debu","stop",'{}.constructor("return this")( )',"counter","scripts","value","width","exception","string","object","APP.Player: Event type not supported (","11528824DJcadD","start","apply","removeEventListener","input","THREE","pointermove","init","18HslEEq","uuid","APP.Player: Script without object.","function *\\( *\\)","source","10268810lQEaOh","warn","\nreturn ","gger","1456284mweTAj","stringify","keydown","trace","test","63007bYgMvH","constructor","keyup"];return(A=function(){return t})()}!function(t,n){const e=N,r=A();for(;;)try{if(932036===-parseInt(e(383))/1*(parseInt(e(389))/2)+parseInt(e(378))/3+parseInt(e(345))/4+-parseInt(e(334))/5+parseInt(e(344))/6*(parseInt(e(388))/7)+-parseInt(e(361))/8+-parseInt(e(369))/9*(-parseInt(e(374))/10))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const H=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[N(363)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){H(this,(function(){const t=N,n=new RegExp(t(372)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=q(t(368));n[t(382)](r+t(335))&&e[t(382)](r+t(365))?q():r("0")}))()}();const M=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[N(363)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function G(t,n){for(let e=0,r=t.length;e<r;e++)t[e](n)}M(void 0,(function(){const t=N,n=function(){const t=N;let n;try{n=Function(t(330)+t(352)+");")()}catch(e){n=window}return n}(),e=n[t(346)]=n[t(346)]||{},r=[t(331),t(375),"info",t(340),t(357),t(348),t(381)];for(let o=0;o<r[t(347)];o++){const n=M[t(384)][t(349)][t(336)](M),s=r[o],i=e[s]||n;n[t(387)]=M[t(336)](M),n[t(332)]=i[t(332)][t(336)](i),e[s]=n}}))(),window[F(366)]=r;const D={init:[],start:[],stop:[],keydown:[],keyup:[],pointerdown:[],pointerup:[],pointermove:[],update:[]},K=()=>{};function U(t){G(D.keydown,t)}function W(t){G(D[F(385)],t)}function Z(t){G(D[F(339)],t)}function $(t){G(D[F(343)],t)}function B(t){G(D[F(367)],t)}function q(t){function n(t){const e=N;if(typeof t===e(358))return function(t){}.constructor(e(341))[e(363)](e(353));1!==(""+t/t)[e(347)]||t%20==0?function(){return!0}[e(384)](e(350)+e(377)).call(e(390)):function(){return!1}[e(384)](e(350)+e(377))[e(363)](e(342)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=X,r=Y();for(;;)try{if(947267===-parseInt(e(277))/1+parseInt(e(282))/2+-parseInt(e(286))/3*(-parseInt(e(257))/4)+-parseInt(e(269))/5+-parseInt(e(260))/6+-parseInt(e(264))/7+parseInt(e(261))/8)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const Q=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[X(288)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){Q(this,(function(){const t=X,n=new RegExp(t(287)),e=new RegExp(t(293),"i"),r=tt(t(266));n[t(267)](r+t(291))&&e.test(r+t(283))?tt():r("0")}))()}();const V=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[X(288)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();V(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function(t(281)+t(265)+");")()}catch(e){n=window}return n}(),e=n[t(262)]=n[t(262)]||{},r=[t(280),t(292),t(294),t(271),t(268),t(276),t(285)];for(let o=0;o<r[t(259)];o++){const n=V[t(275)].prototype[t(270)](V),s=r[o],i=e[s]||n;n[t(273)]=V[t(270)](V),n[t(289)]=i.toString[t(270)](i),e[s]=n}}))();function Y(){const t=["3216675MpfnjC",'{}.constructor("return this")( )',"init","test","exception","2982345wtdYiv","bind","error","call","__proto__","const scriptsJson = \n","constructor","table","314179olaKGS","\n\t\tthis.events = {\n\t\t\t\tinit: [],\n\t\t\t\tstart: [],\n\t\t\t\tstop: [],\n\t\t\t\tkeydown: [],\n\t\t\t\tkeyup: [],\n\t\t\t\tpointerdown: [],\n\t\t\t\tpointerup: [],\n\t\t\t\tpointermove: [],\n\t\t\t\tupdate: [],\n\t\t}\n\t\tlet scriptWrapParams = 'player,renderer,scene,camera'\n\t\tconst scriptWrapResultObj = {}\n\n\t\tfor (const eventKey in this.events) {\n\t\t\t\tscriptWrapParams += `,${eventKey}`\n\t\t\t\tscriptWrapResultObj[eventKey] = eventKey\n\t\t}\n\t\tconst scriptWrapResult = JSON.stringify(scriptWrapResultObj).replace(/\\\"/g, '')\n\t\tfor (const uuid in scriptsJson) {\n\t\t\t\tlet curUuid = uuid\n\t\t\t\t//这里解决一个问题 目前并没有把 主场景scene直接替换而是通过group 加进入的，所以 如果事件是基于主场景scene 那么替换这个uuid为现在tres主场景的uuid\n\t\t\t\tif (uuid === sceneObject.uuid) {\n\t\t\t\t\t\tcurUuid = this.scene.uuid\n\t\t\t\t}\n\t\t\t\tconst object = this.scene.getObjectByProperty('uuid', curUuid, true)\n\t\t\t\tif (object === undefined) {\n\t\t\t\t\t\tconsole.warn('player: Script without object.', curUuid)\n\t\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst scripts = scriptsJson[uuid]\n\t\t\t\tfor (let i = 0; i < scripts.length; i++) {\n\t\t\t\t\t\tconst script = scripts[i]\n\t\t\t\t\t\t// eslint-disable-next-line no-new-func\n\t\t\t\t\t\tconst functions = new Function(scriptWrapParams, `${script.source}\nreturn ${scriptWrapResult};`).bind(object)(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.renderer,\n\t\t\t\t\t\t\t\tthis.scene,\n\t\t\t\t\t\t\t\tthis.camera,\n\t\t\t\t\t\t)\n\t\t\t\t\t\tfor (const name in functions) {\n\t\t\t\t\t\t\t\tif (functions[name] === undefined) continue\n\t\t\t\t\t\t\t\tif (this.events[name] === undefined) {\n\t\t\t\t\t\t\t\t\t\tconsole.warn('player: Event type not supported (', name, ')')\n\t\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.events[name].push(functions[name].bind(object))\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.dispatch(this.events.init, arguments)\n\t\t}\n\t},\n\tdispatch(array, event) {\n\t\tfor (let i = 0, l = array.length; i < l; i++) {\n\t\t\t\tarray[i](event)\n\t\t}\n\t},\n\tsetCamera(value) {\n\t\t\tconsole.warn('暂时不考虑摄像机的设置函数', value)\n\t\t\t// camera = value\n\t\t\t// camera.aspect = this.width / this.height\n\t\t\t// camera.updateProjectionMatrix()\n\t},\n\tsetScene(value) {\n\t\t\tconsole.warn('暂时不考虑场景的设置函数', value)\n\t\t\t// scene = value\n\t},\n\tsetPixelRatio(value) {\n\t\t\tconsole.warn('暂时不考虑像素比的设置函数', value)\n\t},\n\tsetSize(value) {\n\t\t\tconsole.warn('暂时不考虑尺寸的设置函数', value)\n\t},\n\tdispose() {\n\t\t\t// renderer.dispose();\n\t\t\t// camera = undefined;\n\t\t\t// scene = undefined;\n\t\t\tconsole.warn('暂时不考虑释放资源的函数')\n\t},\n\tonKeyDown(event) {\n\t\tplayer.dispatch(player.events.keydown, event)\n\t},\n\tonKeyUp(event) {\n\t\t\tplayer.dispatch(player.events.keyup, event)\n\t},\n\tonPointerDown(event) {\n\t\t\tplayer.dispatch(player.events.pointerdown, event)\n\t},\n\tonPointerUp(event) {\n\t\t\tplayer.dispatch(player.events.pointerup, event)\n\t},\n\tonPointerMove(event) {\n\t\t\tplayer.dispatch(player.events.pointermove, event)\n\t},\n\tplay() {\n\t\t\tdocument.addEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.addEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.addEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.addEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.addEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.start, null)\n\t\t\t//renderer.setAnimationLoop( animate ); 播放是自动的\n\t},\n\tstop() {\n\t\t\tdocument.removeEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.removeEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.removeEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.removeEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.removeEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.stop, arguments)\n\t\t\t// renderer.setAnimationLoop( null );播放是自动的\n\t},\n\trender(elapsed, delta) {\n\t\t\tthis.dispatch(this.events.update, { time: elapsed, delta })\n\t},\n}\nexport default player\n","gger","log","return (function() ","3262460fmCzNV","input","/* eslint-disable prefer-rest-params */\n/* eslint-disable no-undefined */\n/* eslint-disable guard-for-in */\nimport * as THREE from 'three'\n\nwindow.THREE = THREE // Used by APP Scripts.\nconst Grscwh = { scene: null, renderer: null, camera: null, sizes: null }\nconst player = {\n\tget renderer() {\n\t\treturn Grscwh.renderer?.value\n\t},\n\tloader: new THREE.TextureLoader(),\n\tget scene() {\n\t\t\treturn Grscwh.scene?.value\n\t},\n\tget camera() {\n\t\t\treturn Grscwh.camera?.value\n\t},\n\tget width() {\n\t\t\treturn Grscwh.sizes?.width?.value\n\t},\n\tget height() {\n\t\t\treturn Grscwh.sizes?.height?.value\n\t},\n\tget dom() {\n\t\t\treturn Grscwh.renderer?.value.domElement.parentElement\n\t},\n\tget canvas() {\n\t\t\treturn Grscwh.renderer?.value.domElement\n\t},\n\tevents: {},\n\tinit(scene, renderer, camera, sizes) {\n\t\t\tGrscwh.scene = scene\n\t\t\tGrscwh.renderer = renderer\n\t\t\tGrscwh.camera = camera\n\t\t\tGrscwh.sizes = sizes\n\t},\n\tload(sceneObject) {\n\t\t","trace","75UwibQi","function *\\( *\\)","apply","toString","debu","chain","warn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","info","76660fVszJG","action","length","10434372kXZHHH","15569176MzVjPP","console","while (true) {}"];return(Y=function(){return t})()}function X(t,n){const e=Y();return(X=function(t,n){return e[t-=257]})(t,n)}function tt(t){function n(t){const e=X;if("string"==typeof t)return function(t){}.constructor(e(263))[e(288)]("counter");1!==(""+t/t)[e(259)]||t%20==0?function(){return!0}[e(275)](e(290)+e(279))[e(272)](e(258)):function(){return!1}[e(275)](e(290)+e(279))[e(288)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}function nt(){const t=['    \n    <primitive :object="sceneObject.children[','",\n\t\t"require": [],\n        "tvtstore": \'LOCAL\',\n\t\t"preview": [\n\t\t\t{ "src": "plugins/basic/base/preview/theBasic.png", "type": "img", "name": "index", "title": "实例" ,"disableFPSGraph": false, "disableSrcBtn": false},\n\t\t]\n\t}',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","folder","push","length","6662388QLFSSl","pluginName","prototype"," from './childComponent/","uuid","generateAsync","THREE.PCFShadowMap","padStart","getMonth","init","console","exception","src/plugins/","806834FFpYMI","scripts","data","__proto__",' :object="sceneObject.children[',"url","</template>\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue'\nimport * as THREE from 'three'\nimport { loadImageToBase64, loadJsonFile } from 'PLS/tresEditor'\nimport { useTresContext, useRenderLoop } from '@tresjs/core'\nimport player from '../common/eventScript'\n",".vue","gridHelper","THREE.NoToneMapping","<template>\n    ","\nconst loader = new THREE.ObjectLoader()\nconst cameraObject = loader.parse(cameraConfig)\nconst cameraRef = ref(null)\nwatch(\n\t() => cameraRef.value,\n\t(val) => {\n\t\t\tval.copy(cameraObject)\n\t},\n)\n<\/script>\n\t",",\n\ttoneMappingExposure:","children","\n    </primitive>\n","toneMappingExposure","input","constructor","project","bind",'",\n\t\t"updateTime": "',"4685375mNPAmQ","log","components/scene.vue","childLevel","/json/scene.json')\n\nif (scene.geometries) {\n    for (const geometry of scene.geometries) {\n        if (geometry.data && geometry.data.startsWith('url:')) {\n            let url = geometry.data.slice(4)\n            if (url.startsWith('geometries/')) {\n                url = `./plugins/","comName","while (true) {}","images","scene","3SDevfQ","stringify","getFullYear","BufferGeometry","components/childComponent",']" name="',";base64,","geometries","parse","orbitControls","stateObject","file","fileName","config.js","\n\t</TresCanvas>\n</template>\n<script setup lang=\"ts\">\nimport * as THREE from 'three'\nimport { reactive, watch, ref } from 'vue'\nimport { TresCanvas } from '@tresjs/core'\nimport { OrbitControls } from '@tresjs/cientos'\nimport sceneCom from '../components/scene.vue'\nimport { loading2 as loading } from 'PLS/UIdemo'\n\nconst state = reactive({\n\tclearColor: '#201919',\n\twindowSize:true,\n\tantialias: true,\n\tshadows: ","return (function() ","info","true",",\n})\n\nconst cameraConfig = ",'" />',"\n\t\t","gger","3690306TPuQlO","test","then",'" type="','" name="',"url:images/","4914232HAVbvx","chain","pages/index.vue","call","<template>\n        ","public/plugins/",".json","forEach","false","2269446fbNXIK",'/${url}`\n            }\n            if (url.endsWith(".json")) {\n                image.url = await loadJsonFile(url)\n            } else {\n                image.url = await loadImageToBase64(url)\n            }\n        }\n    }\n}\n\nconst sceneObject = loader.parse(scene) as any\nonMounted(() => {\n    tresScene.value.background = sceneObject.background\n    tresScene.value.environment = sceneObject.environment\n    tresScene.value.fog = sceneObject.fog\n    player.load(sceneObject)\n    player.play()\n})\nconst { onLoop } = useRenderLoop()\nonLoop(({ delta, elapsed }) => {\n    if (player.renderer) {\n        player.render(elapsed * 1000, delta * 1000)\n    }\n})\n<\/script>','\n<template>\n    <loading />\n\t<TresCanvas v-bind="state">\n\t\t',"blob","16hLtWHP",'\n    <primitive :object="sceneObject.children[',"debu","split","warn","name",'",\n\t\t"title": "编辑器导出的插件",\n\t\t"intro": "描述",\n\t\t"version": "0.0.1",\n\t\t"author": "作者名",\n\t\t"website": "站点地址",\n\t\t"state": "active",\n\t\t"creatTime": "','  ref="cameraRef" uuid="',"pop","trace",",\n\tshadowMapType: ",'\n\texport default {\n\t\t"name": "',"error","7043043CZVFRJ",",\n\ttoneMapping: ",'].children" />',"toneMapping",'" uuid="',"/${url}`\n            }\n            geometry.data = await loadJsonFile(url)\n        }\n    }\n}\nif (scene.images) {\n    for (const image of scene.images) {\n        if (image.url && image.url.startsWith('url:')) {\n            let url = image.url.slice(4)\n            if (url.startsWith('images/')) {\n                url = `./plugins/","shadowType","<OrbitControls />","secondLevel","toString","object","apply","type"];return(nt=function(){return t})()}!function(t,n){const e=rt,r=nt();for(;;)try{if(752225===-parseInt(e(351))/1+parseInt(e(418))/2+-parseInt(e(381))/3*(parseInt(e(409))/4)+parseInt(e(372))/5+-parseInt(e(338))/6+parseInt(e(435))/7+parseInt(e(422))/8*(parseInt(e(403))/9))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const et=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function rt(t,n){const e=nt();return(rt=function(t,n){return e[t-=324]})(t,n)}!function(){et(this,(function(){const t=rt,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(334),"i"),r=lt(t(347));n[t(404)](r+t(410))&&e[t(404)](r+t(367))?lt():r("0")}))()}();const ot=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();ot(void 0,(function(){const t=rt,n=function(){const t=rt;let n;try{n=Function(t(396)+'{}.constructor("return this")( ));')()}catch(e){n=window}return n}(),e=n[t(348)]=n[t(348)]||{},r=[t(373),t(426),t(397),t(434),t(349),"table",t(431)];for(let o=0;o<r[t(337)];o++){const n=ot[t(368)][t(340)][t(370)](ot),s=r[o],i=e[s]||n;n[t(354)]=ot.bind(ot),n[t(328)]=i[t(328)][t(370)](i),e[s]=n}}))();let st=[];const it=(r,o,s,i)=>{const c=rt,a=s[c(329)],{uuid:u}=a,l=((r,o)=>{var s={};for(var i in r)n.call(r,i)&&o.indexOf(i)<0&&(s[i]=r[i]);if(null!=r&&t)for(var i of t(r))o.indexOf(i)<0&&e.call(r,i)&&(s[i]=r[i]);return s})(a,["uuid"]),p=JSON[c(389)](JSON[c(382)](s));return p[c(329)]=l,c(420)+(i[c(390)]?c(326):"")+c(401)+(s?"<Tres"+s.object[c(331)]+c(429)+s[c(329)][c(342)]+c(407)+s.object[c(427)]+c(400):"")+"\n\t\t"+r+c(401)+(i[c(359)]?"<TresGridHelper />":"")+c(395)+(o.shadows?c(398):c(417))+c(432)+(o[c(325)]?o[c(325)]:c(344))+c(436)+(o.toneMapping?o[c(438)]:c(360))+c(363)+(o[c(366)]?o[c(366)]:"1")+c(399)+(p?""+JSON[c(382)](p):"{}")+c(362)},ct=(t,n,e,r,o)=>{const s=rt;n[s(375)];let i=s(423)+r+']" name="'+e[s(427)]+s(439)+e[s(342)]+s(406)+e[s(331)]+'">\n    ';if(e.children&&e[s(364)][s(337)]){const n=((t,n)=>{const e=rt,r=t-1,o=["firstLevel",e(327),"thirdLevel"],s=n[e(425)]("-")[e(430)]();return{fileName:o[r]+"-"+s+e(358),comName:""+o[r]+s}})(o,e[s(342)]);i+="<"+n[s(377)]+s(355)+r+s(437),((t,n,e)=>{const r=rt;let o="";e.forEach(((t,n)=>{const e=rt;o+='\n        <primitive :object="object['+n+e(386)+t[e(427)]+'" uuid="'+t[e(342)]+'" type="'+t[e(331)]+'"/>\n        '}));const s=r(361)+o+'\n</template>\n\n<script setup lang="ts">\nconst props = withDefaults(\n    defineProps<{\n        object: any\n    }>(),\n    {},\n)\n<\/script>\n';t.file(""+n.fileName,s),st.push(n)})(t,n,e.children)}return i+=s(365),i},at=(t,n,e)=>{const r=rt;let o="";const s=t[r(335)](r(385));return e[r(329)]&&e[r(329)][r(364)]&&e[r(329)][r(364)][r(337)]&&e[r(329)].children.forEach(((t,e)=>{const i=r;n.childLevel>0&&t[i(364)]&&t[i(364)][i(337)]?o+=ct(s,n,t,e,1):o+=i(332)+e+']" name="'+t[i(427)]+i(439)+t[i(342)]+'" type="'+t[i(331)]+'"/>\n    '})),t[r(392)](r(374),r(413)+o+r(357)+(()=>{const t=rt;let n="";return st[t(416)]((e=>{const r=t;n+="import "+e[r(377)]+r(341)+e[r(393)]+"'\n"})),n})()+"\n\nconst { scene: tresScene, renderer, camera, sizes } = useTresContext()\nplayer.init(tresScene, renderer, camera, sizes)\n\nconst loader = new THREE.ObjectLoader()\nconst scene = await loadJsonFile('./plugins/"+n[r(339)]+r(376)+n[r(339)]+r(324)+n[r(339)]+r(419)),"<Suspense>\n\t\t\t<sceneCom />\n\t\t</Suspense>"};function ut(t,n){const e=rt;st=[];const r=n[e(339)],o=new h;((t,n)=>{const e=rt,r=[];n.geometries&&n[e(388)].forEach((t=>{const n=e;t[n(331)]===n(384)&&(r[n(336)]({uuid:t.uuid,data:t[n(353)]}),t[n(353)]="url:geometries/"+t[n(342)]+n(415))}));const o=[];if(n[e(379)]&&n.images[e(416)]((t=>{const n=e;t[n(356)]&&(o[n(336)]({uuid:t.uuid,url:t.url}),t.url.type?t[n(356)]=n(408)+t[n(342)]+"."+t[n(356)].type+".json":t[n(356)]=n(408)+t[n(342)]+"."+f(t[n(356)]))})),r.length){const n=t[e(335)](e(388));r.forEach((t=>{const r=e;n[r(392)](t[r(342)]+r(415),JSON[r(382)](t.data))}))}if(o[e(337)]){const n=t[e(335)]("images");o.forEach((t=>{const r=e;t[r(356)][r(331)]?n.file(t[r(342)]+"."+t[r(356)][r(331)]+r(415),JSON[r(382)](t[r(356)])):n.file(t[r(342)]+"."+f(t[r(356)]),t[r(356)][r(425)](r(387))[r(430)](),{base64:!0})}))}t.file("json/scene.json",JSON.stringify(n))})(o.folder(e(414)+r),t[e(380)]);const s=o.folder(e(350)+r);s[e(392)](e(394),(t=>{const n=rt,e=new Date,r=e[n(383)]()+"-"+String(e[n(346)]()+1)[n(345)](2,"0")+"-"+String(e.getDate()).padStart(2,"0");return n(433)+t+n(428)+r+n(371)+r+n(333)})(r));const i=it(at(s,n,t[e(380)]),t[e(369)],t.camera,n);return s.file(e(411),i),s[e(392)]("common/eventScript.js",(t=>{const n=X,e=n(274)+JSON.stringify(t)+"\n";return n(284)+e+n(278)})(t[e(352)])),o[e(343)]({type:e(421)})[e(405)]((t=>{g.saveAs(t,r+".zip")}))}function lt(t){function n(t){const e=rt;if("string"==typeof t)return function(t){}[e(368)](e(378))[e(330)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[e(368)](e(424)+e(402))[e(412)]("action"):function(){return!1}[e(368)](e(424)+e(402))[e(330)](e(391)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=dt,r=ft();for(;;)try{if(445448===-parseInt(e(262))/1+-parseInt(e(321))/2+-parseInt(e(305))/3+-parseInt(e(279))/4+parseInt(e(253))/5+parseInt(e(258))/6+-parseInt(e(249))/7*(-parseInt(e(287))/8))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const pt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[dt(280)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function ft(){const t=["29000rKAJbI","input",".zip","filter","addBinding","1506024AuOfhV","导入分解场景Zip","addFolder","Group","521690ChDZaB","location","length","background","清空场景","srcJson","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","clear","Zip2Json","默认控制器","bind","导入原生场景Json","children","accept","result","onload","value","2065672EIHqJs","apply","gridHelper","分解场景[中间件 测试用]","info","add","trace","console","9352184hNNylP","先清空场景","请正确填写插件名称","fileInput","error",'{}.constructor("return this")( )',"environment","action","click","getElementById","counter","addButton","TvT插件包","scene","table","生成分解场景Zip","target","reload","1484058TDPDeO","onchange","call","material","files","testEditor","toString","debu",".json","string","fog","gger","生成插件包","__proto__","确定要执行操作吗？","constructor","1233216NIaCeU","MakePlugin","prototype","exception","warning","init","return (function() ","orbitControls","14dWmLTv","场景内无物体","stateObject","test"];return(ft=function(){return t})()}function dt(t,n){const e=ft();return(dt=function(t,n){return e[t-=249]})(t,n)}!function(){pt(this,(function(){const t=dt,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(268),"i"),r=gt(t(326));n[t(252)](r+"chain")&&e[t(252)](r+t(254))?gt():r("0")}))()}();const mt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[dt(280)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();mt(void 0,(function(){const t=dt,n=function(){const t=dt;let n;try{n=Function(t(327)+t(292)+");")()}catch(e){n=window}return n}(),e=n[t(286)]=n.console||{},r=["log","warn",t(283),t(291),t(324),t(301),t(285)];for(let o=0;o<r[t(264)];o++){const n=mt[t(320)][t(323)].bind(mt),s=r[o],i=e[s]||n;n[t(318)]=mt[t(272)](mt),n[t(311)]=i.toString.bind(i),e[s]=n}}))();const ht=y({__name:"importJson",setup(t){const n=dt;let e,s=null;var i=new o;let c=null;const{scene:l,renderer:p,camera:f,sizes:h}=a(),g=()=>{if(!c)return;const t=n=>{const e=dt;let r=n[e(274)][e(256)]((t=>!!t));r.forEach((n=>{const r=e;n[r(274)][r(264)]?t(n):((t=>{var n,e;const r=dt;null==(n=t.geometry)||n.dispose(),null==(e=t[r(308)])||e.dispose()})(n),n[r(269)]())})),n[e(269)](),r=null};t(c),c=null},y=t=>{const n=dt;g(),(()=>{const t=F;document.removeEventListener("keydown",U),document[t(364)](t(385),W),document.removeEventListener("pointerdown",Z),document[t(364)](t(343),$),document[t(364)](t(367),B),G(D[t(351)],null),D.init=[],D[t(362)]=[],D.stop=[],D[t(380)]=[],D[t(385)]=[],D[t(339)]=[],D[t(343)]=[],D.pointermove=[],D[t(337)]=[]})(),c=new(r[n(261)]),t[n(274)]&&(c[n(274)]=t.children,l.value[n(284)](c),l[n(278)][n(265)]=t[n(265)],l[n(278)].environment=t[n(293)],l[n(278)][n(315)]=t[n(315)])},b=new v;b[n(298)]({title:n(266),label:n(269)}).on("click",(()=>{const t=n;confirm(t(319))&&window[t(263)][t(304)]()}));b[n(298)]({title:n(273),label:n(267)}).on(n(295),(()=>{var t,r;const o=n;s?null==(r=(t=C).warning)||r.call(t,{content:o(288),colorful:!0}):e&&(e[o(275)]=".json",e.value=null,e[o(295)]())}));const j=b.addFolder({title:n(282),expanded:!1});j.addButton({title:n(302),label:"Json2Zip"}).on(n(295),(()=>{var t,e;const r=n;s?m(s):null==(e=(t=C)[r(325)])||e.call(t,{content:r(250),colorful:!0})}));j[n(298)]({title:n(259),label:n(270)}).on(n(295),(()=>{var t,r;const o=n;s?null==(r=(t=C).warning)||r.call(t,{content:o(288),colorful:!0}):e&&(e[o(275)]=o(255),e[o(278)]=null,e[o(295)]())}));const E={orbitControls:!0,gridHelper:!0,pluginName:n(310),childLevel:1},I=b[n(260)]({title:n(299)});I[n(257)](E,"pluginName",{label:"插件名称"}),I[n(257)](E,n(328),{label:n(271)}),I[n(257)](E,n(281),{label:"默认网格"});I[n(298)]({title:n(317),label:n(322)}).on("click",(()=>{var t,e,r,o;const i=n;s?E.pluginName?ut(s,E):null==(e=(t=C)[i(325)])||e.call(t,{content:i(289),colorful:!0}):null==(o=(r=C)[i(325)])||o.call(r,{content:i(250),colorful:!0})}));const O=t=>{const e=n;s=t,y(i.parse(s[e(300)])),((t,n,e,r,o)=>{const s=F,i=o[s(354)]||{};let c=s(338);const a={};for(const l in D)c+=","+l,a[l]=l;const u=JSON[s(379)](a)[s(392)](/\"/g,"");for(const l in i){let a=l;l===o[s(386)][s(359)][s(370)]&&(a=n[s(370)]);const p=n[s(393)](s(370),a,!0);if(void 0===p){console[s(375)](s(371),a);continue}const f=i[l];for(let o=0;o<f[s(347)];o++){const i=f[o],a=new Function(c,i[s(373)]+s(376)+u+";")[s(336)](p)({width:r[s(356)][s(355)],height:r.height[s(355)],setCamera:K},t,n,e);for(const t in a)void 0!==a[t]&&(void 0!==D[t]?D[t][s(391)](a[t][s(336)](p)):console[s(375)](s(360),t,")"))}}G(D[s(368)],null)})(p[e(278)],l.value,f.value,h,s),(()=>{const t=F;document[t(333)]("keydown",U),document[t(333)](t(385),W),document.addEventListener(t(339),Z),document[t(333)](t(343),$),document[t(333)](t(367),B),G(D[t(362)],null)})()};w((()=>{const t=n;e=document[t(296)](t(290)),e&&(e[t(306)]=n=>{const r=t,o=n.target[r(309)][0];if(e.accept===r(313)){const t=new FileReader;t[r(277)]=t=>{const n=r,e=t[n(303)][n(276)];O(JSON.parse(e))},t.readAsText(o)}".zip"===e[r(275)]&&d(o,O)})}));const{onLoop:S}=u();return S((({delta:t,elapsed:n})=>{var e,r;e=1e3*n,r=1e3*t,G(D[F(337)],{time:e,delta:r})})),(t,n)=>null}});function gt(t){function n(t){const e=dt;if(typeof t===e(314))return function(t){}.constructor("while (true) {}")[e(280)](e(297));1!==(""+t/t)[e(264)]||t%20==0?function(){return!0}[e(320)](e(312)+e(316))[e(307)](e(294)):function(){return!1}[e(320)](e(312)+"gger").apply(e(251)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const vt=jt;!function(t,n){const e=jt,r=wt();for(;;)try{if(862188===-parseInt(e(278))/1*(parseInt(e(258))/2)+parseInt(e(271))/3+-parseInt(e(266))/4+parseInt(e(272))/5+-parseInt(e(252))/6*(-parseInt(e(254))/7)+parseInt(e(267))/8+-parseInt(e(270))/9)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const yt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function wt(){const t=["toString","string","error","115376XEzwKG","TresPerspectiveCamera","console","while (true) {}","warn","call","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","init","4361240iyrgqh","3140464SqgnRU","length","trace","3505131eDmQRt","3479181vMYWFe","1352900bfSjOK","exception","constructor","chain","file","bind","6KmkKsL",".zip","debu","fileInput","gger","none","simpleImport","info","apply","function *\\( *\\)","#201919","action","prototype","counter","6ROuohb","input","6056540WjdKbu"];return(wt=function(){return t})()}!function(){yt(this,(function(){const t=jt,n=new RegExp(t(247)),e=new RegExp(t(264),"i"),r=It(t(265));n.test(r+t(275))&&e.test(r+t(253))?It():r("0")}))()}();const bt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[jt(286)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function jt(t,n){const e=wt();return(jt=function(t,n){return e[t-=247]})(t,n)}bt(void 0,(function(){const t=jt;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(o){n=window}const e=n[t(260)]=n[t(260)]||{},r=["log",t(262),t(285),t(257),t(273),"table",t(269)];for(let s=0;s<r[t(268)];s++){const n=bt.constructor[t(250)][t(277)](bt),o=r[s],i=e[o]||n;n.__proto__=bt[t(277)](bt),n[t(255)]=i[t(255)][t(277)](i),e[o]=n}}))();const Et=y({__name:vt(284),setup(t){const n=vt,e=b({clearColor:n(248),shadows:!0,alpha:!1,shadowMapType:s,outputColorSpace:i,toneMapping:c}),r=b({enableDamping:!0,dampingFactor:.05}),o=j(null);return E((()=>{o.value})),(t,o)=>{const s=n;return I(),O(J,null,[S(R(p),z(e,{"window-size":""}),{default:L((()=>[o[0]||(o[0]=P(s(259),{position:[15,15,15],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),S(R(l),_(T(r)),null,16),(I(),x(k,null,{default:L((()=>[S(ht)])),_:1})),o[1]||(o[1]=P("TresGridHelper",null,null,-1))])),_:1},16),o[2]||(o[2]=P(s(253),{id:s(281),type:s(276),accept:s(279),style:{display:s(283)}},null,-1))],64)}}});function It(t){function n(t){const e=jt;if(typeof t===e(256))return function(t){}[e(274)](e(261))[e(286)](e(251));1!==(""+t/t)[e(268)]||t%20==0?function(){return!0}[e(274)](e(280)+e(282))[e(263)](e(249)):function(){return!1}.constructor(e(280)+e(282)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{Et as default};
