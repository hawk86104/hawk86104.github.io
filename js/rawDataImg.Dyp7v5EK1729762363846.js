import{_ as t,n,z as e,p as o,aB as r,b$ as a,ak as i,am as c}from"./three.CQvcOG671729762363846.js";import{z as s,p as l,U as u,Y as p,L as f}from"./@tresjs.CmAaFQUS1729762363846.js";import{u as d,_ as m}from"./colorList.BIPTYY_W1729762363846.js";import{P as h}from"./tweakpane.BCjFYDHx1729762363846.js";import{d as x,r as g,a5 as S,w as b,o as v,E as C,L as w,aj as y,ak as z,f as j,g as I,j as _,u as D,al as P,m as T,F as M}from"./@vue.n8X62v121729762363846.js";import"./@vueuse.DvZn62wO1729762363846.js";import"./pinia.DOkF60i-1729762363846.js";import"./@fesjs.CZZ05Yp51729762363846.js";import"./vue-router.Du5s6fg51729762363846.js";import"./lodash-es.BBTWvufR1729762363846.js";import"./@qlin.BIlp8Yi21729762363846.js";import"./@babel.Bwyie5id1729762363846.js";import"./@amap.irWeW_Ar1729762363846.js";import"./@floating-ui.B75jtkXD1729762363846.js";import"./@juggle.BnTvdTVm1729762363846.js";const A=k;!function(t,n){const e=k,o=R();for(;;)try{if(310943===parseInt(e(204))/1+parseInt(e(172))/2+parseInt(e(159))/3+parseInt(e(165))/4*(-parseInt(e(187))/5)+-parseInt(e(191))/6*(-parseInt(e(163))/7)+parseInt(e(170))/8*(parseInt(e(195))/9)+parseInt(e(178))/10*(-parseInt(e(177))/11))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const F=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[k(160)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){F(this,(function(){const t=k,n=new RegExp(t(199)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=B(t(197));n.test(o+"chain")&&e[t(184)](o+t(206))?B():o("0")}))()}();const E=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function R(){const t=["6uBXGhP","console","while (true) {}","trace","90vNmbRA","TresMesh","init","bind","function *\\( *\\)","ratio","exception","rtTexture","LinearFilter","428106JBahYK","toString","input","TresShaderMaterial","error","addBinding","482433gycKMQ","apply","length","colorsStops","2483257Byrabk","constructor","606976FLvgBP","string","对比度","steps","secondPass","5032OHqUpY","boxSize","1160654KOmpig","log","debu","TresBoxGeometry","alphaCorrection","45342nxpuBa","2590EMshIW","warn","__proto__","generateMipmaps","uniforms","循环次数","test","value","counter","5enaRfp","gger","updateTransferFunction","info"];return(R=function(){return t})()}E(void 0,(function(){const t=k;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(r){n=window}const e=n.console=n[t(192)]||{},o=[t(173),t(179),t(190),t(157),t(201),"table",t(194)];for(let a=0;a<o[t(161)];a++){const n=E[t(164)].prototype.bind(E),r=o[a],i=e[r]||n;n[t(180)]=E.bind(E),n[t(205)]=i[t(205)][t(198)](i),e[r]=n}}))();const L=["args"];function k(t,n){const e=R();return(k=function(t,n){return e[t-=156]})(t,n)}const W=x({__name:A(169),props:{rtTexture:{default:{texture:null}},boxSize:{}},async setup(o){const r=A;let a,i;const c=g({steps:156,alphaCorrection:3,ratio:.5}),l=new h;l[r(158)](c,r(168),{label:r(183),min:1,max:300,step:1}),l[r(158)](c,r(176),{label:"亮度",min:0,max:10,step:.1}),l[r(158)](c,"ratio",{label:r(167),min:0,max:1,step:.1});const u=d(),p=o,f=([a,i]=S((()=>s(["./plugins/tvtVolumeRendering/rawData/bonsai.raw.png"]))),a=await a,i(),a);f[r(181)]=!1,f.minFilter=t[r(203)],f.magFilter=n;const m={vertexShader:"varying vec3 worldSpaceCoords;\nvarying vec4 projectedCoords;\n\nuniform float boxWidth;\nuniform float boxHeight;\nuniform float boxDepth;\n\nvoid main()\n{\n\tworldSpaceCoords=(modelMatrix*vec4(position+vec3(boxWidth/2.,boxHeight/2.,boxDepth/2.),1.)).xyz;\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n\tprojectedCoords=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}",fragmentShader:"varying vec3 worldSpaceCoords;\nvarying vec4 projectedCoords;\nuniform sampler2D tex,cubeTex,transferTex;\nuniform float steps;\nuniform float alphaCorrection;\nuniform float boxWidth;\nuniform float boxHeight;\nuniform float boxDepth;\nuniform float uRatio;\n\nconst int MAX_STEPS=887;\n\nfloat linearScale(float domainStart,float domainEnd,float rangeStart,float rangeEnd,float value){\n\treturn((rangeEnd-rangeStart)*(value-domainStart))/(domainEnd-domainStart)+rangeStart;\n}\n\nconst float slicesPerSide=16.;\nconst float zDepth=slicesPerSide*slicesPerSide-1.;\n\nvec4 sampleAs3DTexture(vec3 texCoord)\n{\n\ttexCoord.x=linearScale(0.,boxWidth,0.,1.,texCoord.x);\n\ttexCoord.y=linearScale(0.,boxHeight,0.,1.,texCoord.y);\n\t\n\tvec4 colorSlice1,colorSlice2;\n\tvec2 texCoordSlice1,texCoordSlice2;\n\t\n\t\n\t\n\tfloat zSliceNumber1=floor(texCoord.z*zDepth);\n\t\n\t\n\tfloat zSliceNumber2=min(zSliceNumber1+1.,zDepth);\n\t\n\t\n\t\n\ttexCoord.xy/=slicesPerSide;\n\t\n\ttexCoordSlice1=texCoordSlice2=texCoord.xy;\n\t\n\t\n\ttexCoordSlice1.x+=(mod(zSliceNumber1,slicesPerSide)/slicesPerSide);\n\ttexCoordSlice1.y+=floor((zDepth-zSliceNumber1)/slicesPerSide)/slicesPerSide;\n\t\n\ttexCoordSlice2.x+=(mod(zSliceNumber2,slicesPerSide)/slicesPerSide);\n\ttexCoordSlice2.y+=floor((zDepth-zSliceNumber2)/slicesPerSide)/slicesPerSide;\n\t\n\t\n\t\n\tcolorSlice1=texture2D(cubeTex,texCoordSlice1);\n\tcolorSlice2=texture2D(cubeTex,texCoordSlice2);\n\t\n\t\n\tcolorSlice1.rgb=texture2D(transferTex,vec2(colorSlice1.a,1.)).rgb;\n\tcolorSlice2.rgb=texture2D(transferTex,vec2(colorSlice2.a,1.)).rgb;\n\t\n\t\n\tfloat zDifference=mod(texCoord.z*zDepth,1.);\n\t\n\t\n\treturn mix(colorSlice1,colorSlice2,zDifference);\n}\n\nvoid main(void){\n\t\n\t\n\tvec2 texc=vec2(((projectedCoords.x/projectedCoords.w)+1.)/2.,\n\t((projectedCoords.y/projectedCoords.w)+1.)/2.);\n\t\n\t\n\tvec3 backPos=texture2D(tex,texc).xyz;\n\t\n\t\n\tvec3 frontPos=worldSpaceCoords;\n\t\n\t\n\t\n\tif((backPos.x==0.)&&(backPos.y==0.))\n\t{\n\t\tgl_FragColor=vec4(0.);\n\t\treturn;\n\t}\n\t\n\t\n\tvec3 dir=backPos-frontPos;\n\t\n\tfloat rayLength=length(dir);\n\t\n\t\n\tfloat delta=1./steps;\n\t\n\t\n\tvec3 deltaDirection=normalize(dir)*delta;\n\tfloat deltaDirectionLength=length(deltaDirection);\n\t\n\t\n\tvec3 currentPosition=frontPos;\n\t\n\t\n\tvec4 accumulatedColor=vec4(.0,.0,.0,uRatio);\n\t\n\t\n\tfloat accumulatedAlpha=0.;\n\t\n\t\n\tfloat accumulatedLength=0.;\n\t\n\t\n\t\n\tfloat alphaScaleFactor=25.6*delta;\n\t\n\tvec4 colorSample;\n\tfloat alphaSample;\n\t\n\t\n\tfor(int i=0;i<MAX_STEPS;i++)\n\t{\n\t\t\n\t\tcolorSample=sampleAs3DTexture(currentPosition);\n\t\t\n\t\t\n\t\talphaSample=colorSample.a*alphaCorrection;\n\t\t\n\t\t\n\t\talphaSample*=(1.-accumulatedAlpha);\n\t\t\n\t\t\n\t\talphaSample*=alphaScaleFactor;\n\t\t\n\t\t\n\t\taccumulatedColor+=colorSample*alphaSample;\n\t\t\n\t\t\n\t\taccumulatedAlpha+=alphaSample;\n\t\t\n\t\t\n\t\tcurrentPosition+=deltaDirection;\n\t\taccumulatedLength+=deltaDirectionLength;\n\t\t\n\t\t\n\t\tif(accumulatedLength>=rayLength||accumulatedAlpha>=1.)\n\t\tbreak;\n\t}\n\t\n\tgl_FragColor=accumulatedColor;\n\t\n}",side:e,uniforms:{tex:{value:p[r(202)].texture},cubeTex:{value:f},transferTex:{value:null},steps:{value:c[r(168)]},alphaCorrection:{value:c.alphaCorrection},boxWidth:{value:p.boxSize[0]},boxHeight:{value:p[r(171)][1]},boxDepth:{value:p[r(171)][2]},uRatio:{value:c[r(200)]}}};return b((()=>u[r(162)]),(()=>{const t=r;m[t(182)].transferTex[t(185)]=u[t(189)]()}),{deep:!0,immediate:!0}),b((()=>[c[r(168)],c[r(176)],c.ratio]),(([t,n,e])=>{const o=r;m[o(182)][o(168)][o(185)]=t,m.uniforms[o(176)][o(185)]=n,m.uniforms.uRatio.value=e})),(t,n)=>{const e=r;return v(),C(e(196),null,[w(e(175),{args:o[e(171)]},null,8,L),w(e(156),y(z(m)),null,16)])}}});function B(t){function n(t){const e=k;if(typeof t===e(166))return function(t){}[e(164)](e(193))[e(160)](e(186));1!==(""+t/t)[e(161)]||t%20==0?function(){return!0}[e(164)](e(174)+e(188)).call("action"):function(){return!1}[e(164)](e(174)+"gger").apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=O,o=X();for(;;)try{if(963787===-parseInt(e(400))/1+-parseInt(e(390))/2*(parseInt(e(408))/3)+-parseInt(e(373))/4+-parseInt(e(364))/5*(-parseInt(e(404))/6)+parseInt(e(376))/7+-parseInt(e(381))/8+parseInt(e(396))/9)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const N=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){N(this,(function(){const t=O,n=new RegExp(t(369)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=$("init");n[t(380)](o+"chain")&&e[t(380)](o+t(375))?$():o("0")}))()}();const H=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[O(383)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function O(t,n){const e=X();return(O=function(t,n){return e[t-=363]})(t,n)}function X(){const t=["log","350409DrqwpI","bind","545iXAPAW","constructor","Scene","NearestFilter","RGBAFormat","function *\\( *\\)","add","ShaderMaterial","debu","4947584nBYKiK","BackSide","input","1238909pwhnCd","render","action","value","test","12346328xGSxwi","warn","apply","length","console","toneMappingExposure","height","info","rtTexture","14smmjjX","WebGLRenderTarget","ClampToEdgeWrapping","table","width","ACESFilmicToneMapping","43056900fLXNYO","Mesh","toString","setRenderTarget","1195519cmOpvz","call","toneMapping","gger","43818GvCULR","while (true) {}","__proto__"];return(X=function(){return t})()}H(void 0,(function(){const t=O,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),e=n[t(385)]=n[t(385)]||{},o=[t(407),t(382),t(388),"error","exception",t(393),"trace"];for(let r=0;r<o.length;r++){const n=H[t(365)].prototype.bind(H),a=o[r],i=e[a]||n;n[t(406)]=H[t(363)](H),n[t(398)]=i.toString[t(363)](i),e[a]=n}}))();const Z=x({__name:"firstScene",setup(n){const e=O,a=[1,1,1],{camera:i,renderer:c,scene:s,sizes:p}=l();c[e(379)][e(402)]=t[e(395)],c.value[e(386)]=100000.2;const f=new(t[e(391)])(p[e(394)][e(379)],p[e(387)][e(379)],{minFilter:t[e(367)],magFilter:t[e(367)],wrapS:t[e(392)],wrapT:t[e(392)],format:t[e(368)],type:o,generateMipmaps:!1,stencilBuffer:!0}),d=new(t[e(366)]),m=new r(...a),h=new(t[e(371)])({vertexShader:"varying vec3 worldSpaceCoords;\n\nuniform float boxWidth;\nuniform float boxHeight;\nuniform float boxDepth;\n\nvoid main()\n{\n  \n  worldSpaceCoords=position+vec3(boxWidth/2.,boxHeight/2.,boxDepth/2.);\n  gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}",fragmentShader:"varying vec3 worldSpaceCoords;\n\nvoid main()\n{\n  \n  gl_FragColor=vec4(worldSpaceCoords.x,worldSpaceCoords.y,worldSpaceCoords.z,1);\n}",side:t[e(374)],uniforms:{boxWidth:{value:a[0]},boxHeight:{value:a[1]},boxDepth:{value:a[2]}}});d[e(370)](new(t[e(397)])(m,h));const{onLoop:x}=u();return x((()=>{const t=e;c.value[t(399)](f),c.value[t(377)](d,i[t(379)]),c[t(379)][t(399)](null),c.value[t(377)](s.value,i[t(379)])})),(t,n)=>{const o=e;return v(),j(P,null,{default:I((()=>[_(W,{rtTexture:D(f),boxSize:a},null,8,[o(389)])])),_:1})}}});function $(t){function n(t){const e=O;if("string"==typeof t)return function(t){}[e(365)](e(405)).apply("counter");1!==(""+t/t)[e(384)]||t%20==0?function(){return!0}[e(365)](e(372)+"gger")[e(401)](e(378)):function(){return!1}.constructor("debu"+e(403))[e(383)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}const G=q;!function(t,n){const e=q,o=V();for(;;)try{if(992186===parseInt(e(179))/1+-parseInt(e(170))/2*(parseInt(e(156))/3)+parseInt(e(158))/4+-parseInt(e(192))/5*(-parseInt(e(186))/6)+parseInt(e(182))/7*(parseInt(e(177))/8)+parseInt(e(171))/9+parseInt(e(191))/10*(-parseInt(e(162))/11))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const K=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[q(173)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){K(this,(function(){const t=q,n=new RegExp(t(188)),e=new RegExp(t(183),"i"),o=Q(t(168));n[t(172)](o+t(175))&&e.test(o+t(181))?Q():o("0")}))()}();const Y=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[q(173)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();Y(void 0,(function(){const t=q;let n;try{n=Function(t(165)+t(157)+");")()}catch(r){n=window}const e=n[t(161)]=n[t(161)]||{},o=[t(160),t(185),t(167),"error",t(190),t(169),t(154)];for(let a=0;a<o[t(180)];a++){const n=Y.constructor[t(187)][t(184)](Y),r=o[a],i=e[r]||n;n.__proto__=Y[t(184)](Y),n.toString=i[t(178)][t(184)](i),e[r]=n}}))();const U=w(G(176),{position:[2,2,2],fov:40,near:.01,far:3e3},null,-1);function V(){const t=["stateObject","21363NsunYU",'{}.constructor("return this")( )',"6212072fVrZZB","rawDataImg","log","console","30571805rAQdjp","gger","action","return (function() ","string","info","init","table","70HWsXIz","1694511gpDoee","test","apply","while (true) {}","chain","TresPerspectiveCamera","312UnIoOR","toString","1852326kleWMJ","length","input","284893rFrDOn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bind","warn","9714282ufKMyh","prototype","function *\\( *\\)","manual","exception","20qQaETf","5JJTXCs","constructor","debu","trace"];return(V=function(){return t})()}function q(t,n){const e=V();return(q=function(t,n){return e[t-=152]})(t,n)}const J=x({__name:G(159),setup(t){const n=g({shadowMapType:a,outputColorSpace:i,toneMapping:c,renderMode:G(189)});return(t,e)=>(v(),C(M,null,[_(m),_(D(f),T(n,{"window-size":""}),{default:I((()=>[U,_(D(p)),_(Z)])),_:1},16)],64))}});function Q(t){function n(t){const e=q;if(typeof t===e(166))return function(t){}[e(152)](e(174))[e(173)]("counter");1!==(""+t/t)[e(180)]||t%20==0?function(){return!0}[e(152)]("debu"+e(163)).call(e(164)):function(){return!1}[e(152)](e(153)+e(163))[e(173)](e(155)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{J as default};
