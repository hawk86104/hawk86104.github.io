import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{i as r,r as t,d as a}from"./ice-utils.DHSeSyjo1767066396612.js";import{c as n,p as i,r as E,l as o,m as T}from"./gl-matrix.XZzMrBim1767066396612.js";const{defineComponent:_}=await e("vue"),{openBlock:R,createElementBlock:u}=await e("vue"),A={id:"canvaswebgl",style:{height:"500px",width:"500px"}},{onMounted:c}=await e("vue"),f=_({__name:"webglFrameBuffer",setup(e){const _=function(){const e=document.querySelector("#canvaswebgl"),_=e?.getContext("webgl");if(!_)return;var R=r(_,"\nattribute vec4 a_position;\nattribute vec2 a_texcoord;\nuniform mat4 u_matrix;\nvarying vec2 v_texcoord;\nvoid main() {\n  gl_Position = u_matrix * a_position;\n  v_texcoord = a_texcoord;\n}","\nprecision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nvoid main(){\n\tgl_FragColor=texture2D(u_texture, v_texcoord.xy);\n}\n"),u=_.getAttribLocation(R,"a_position"),A=_.getAttribLocation(R,"a_texcoord"),c=_.getUniformLocation(R,"u_matrix"),f=_.getUniformLocation(R,"u_texture"),F=_.createBuffer();_.bindBuffer(_.ARRAY_BUFFER,F),function(e){var r=new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5]);e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}(_);var m=_.createBuffer();_.bindBuffer(_.ARRAY_BUFFER,m),function(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW)}(_);var s=_.createTexture();_.bindTexture(_.TEXTURE_2D,s);{const e=0,r=_.RGBA,t=1,a=1,n=0,i=_.RGBA,E=_.UNSIGNED_BYTE,o=new Uint8Array([255,255,0,255]),T=1;_.pixelStorei(_.UNPACK_ALIGNMENT,T),_.texImage2D(_.TEXTURE_2D,e,r,t,a,n,i,E,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE)}const x=_.createTexture();_.bindTexture(_.TEXTURE_2D,x);{const e=0,r=_.RGBA,t=0,a=_.RGBA,n=_.UNSIGNED_BYTE,i=null;_.texImage2D(_.TEXTURE_2D,e,r,256,256,t,a,n,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE)}const U=_.createFramebuffer();_.bindFramebuffer(_.FRAMEBUFFER,U);const l=_.COLOR_ATTACHMENT0;_.framebufferTexture2D(_.FRAMEBUFFER,l,_.TEXTURE_2D,x,0);var v=a(0),b=0;function d(e){_.useProgram(R),_.enableVertexAttribArray(u),_.bindBuffer(_.ARRAY_BUFFER,F);var r=3,t=_.FLOAT,a=!1,s=0,x=0;_.vertexAttribPointer(u,r,t,a,s,x),_.enableVertexAttribArray(A),_.bindBuffer(_.ARRAY_BUFFER,m);r=2,t=_.FLOAT,a=!1,s=0,x=0;_.vertexAttribPointer(A,r,t,a,s,x);var U=n();i(U,-30,e,.1,1e4);let l=n();l=E(l,l,v,[0,1,0]);var b=n();o(b,[0,0,2],[0,0,0],[0,1,0]);let d=n();T(d,b,l);var B=n();T(B,U,d),_.uniformMatrix4fv(c,!1,B),_.uniform1i(f,0),_.drawArrays(_.TRIANGLES,0,36)}requestAnimationFrame(function e(r){var a=(r*=.001)-b;b=r,v+=-.4*a,t(_.canvas),_.enable(_.CULL_FACE),_.enable(_.DEPTH_TEST);_.bindFramebuffer(_.FRAMEBUFFER,U),_.bindTexture(_.TEXTURE_2D,s),_.viewport(0,0,256,256),_.clearColor(0,1,0,1),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);d(1);_.bindFramebuffer(_.FRAMEBUFFER,null),_.bindTexture(_.TEXTURE_2D,x),_.viewport(0,0,_.canvas.width,_.canvas.height),_.clearColor(1,1,1,1),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);d(_.canvas.clientWidth/_.canvas.clientHeight);requestAnimationFrame(e)})};return c(()=>{_()}),(e,r)=>(R(),u("canvas",A))}});export{f as default};
