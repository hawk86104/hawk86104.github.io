class t{constructor(){this.middlewares=[]}use(t){return this.middlewares.push(t),this}compose(){return(t,e)=>{let r=-1;const n=o=>{if(o<=r)return Promise.reject(new Error("next() called multiple times"));r=o;let c=this.middlewares[o];if(r===this.middlewares.length&&(c=e),!c)return Promise.resolve();try{return Promise.resolve(c(t,n.bind(null,o+1)))}catch(i){return Promise.reject(i)}};return n(0)}}}const e=async(t,e)=>{t.config.method?t.config.method=t.config.method.toUpperCase():t.config.method="POST",await e()};var r="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,o=r||n||Function("return this")(),c=o.Symbol,i=Object.prototype,a=i.hasOwnProperty,u=i.toString,s=c?c.toStringTag:void 0;var f=Object.prototype.toString;var l=c?c.toStringTag:void 0;function p(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?function(t){var e=a.call(t,s),r=t[s];try{t[s]=void 0;var n=!0}catch{}var o=u.call(t);return n&&(e?t[s]=r:delete t[s]),o}(t):function(t){return f.call(t)}(t)}function y(t){return null!=t&&"object"==typeof t}function h(t){return"symbol"==typeof t||y(t)&&"[object Symbol]"==p(t)}function g(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var b=Array.isArray,d=c?c.prototype:void 0,v=d?d.toString:void 0;function m(t){if("string"==typeof t)return t;if(b(t))return g(t,m)+"";if(h(t))return v?v.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function j(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function w(t){if(!j(t))return!1;var e=p(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var _,O=o["__core-js_shared__"],$=(_=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"";var S=Function.prototype.toString;function A(t){if(null!=t){try{return S.call(t)}catch{}try{return t+""}catch{}}return""}var T=/^\[object .+?Constructor\]$/,x=Function.prototype,E=Object.prototype,P=x.toString,k=E.hasOwnProperty,I=RegExp("^"+P.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function q(t){return!(!j(t)||function(t){return!!$&&$ in t}(t))&&(w(t)?I:T).test(A(t))}function M(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return q(r)?r:void 0}var U=M(o,"WeakMap"),z=Object.create,D=function(){function t(){}return function(e){if(!j(e))return{};if(z)return z(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var F=Date.now;function C(t){return function(){return t}}var N=function(){try{var t=M(Object,"defineProperty");return t({},"",{}),t}catch{}}(),R=N?function(t,e){return N(t,"toString",{configurable:!0,enumerable:!1,value:C(e),writable:!0})}:function(t){return t},J=function(t){var e=0,r=0;return function(){var n=F(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(R);var B=/^(?:0|[1-9]\d*)$/;function H(t,e){var r=typeof t;return!!(e=e??9007199254740991)&&("number"==r||"symbol"!=r&&B.test(t))&&t>-1&&t%1==0&&t<e}function L(t,e,r){"__proto__"==e&&N?N(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function V(t,e){return t===e||t!=t&&e!=e}var W=Object.prototype.hasOwnProperty;function G(t,e,r){var n=t[e];(!W.call(t,e)||!V(n,r)||void 0===r&&!(e in t))&&L(t,e,r)}function Q(t,e,r,n){var o=!r;r||(r={});for(var c=-1,i=e.length;++c<i;){var a=e[c],u=void 0;void 0===u&&(u=t[a]),o?L(r,a,u):G(r,a,u)}return r}var K=Math.max;function X(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Y(t){return null!=t&&X(t.length)&&!w(t)}var Z=Object.prototype;function tt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Z)}function et(t){return y(t)&&"[object Arguments]"==p(t)}var rt=Object.prototype,nt=rt.hasOwnProperty,ot=rt.propertyIsEnumerable,ct=et(function(){return arguments}())?et:function(t){return y(t)&&nt.call(t,"callee")&&!ot.call(t,"callee")};var it="object"==typeof exports&&exports&&!exports.nodeType&&exports,at=it&&"object"==typeof module&&module&&!module.nodeType&&module,ut=at&&at.exports===it?o.Buffer:void 0,st=(ut?ut.isBuffer:void 0)||function(){return!1},ft={};function lt(t){return function(e){return t(e)}}ft["[object Float32Array]"]=ft["[object Float64Array]"]=ft["[object Int8Array]"]=ft["[object Int16Array]"]=ft["[object Int32Array]"]=ft["[object Uint8Array]"]=ft["[object Uint8ClampedArray]"]=ft["[object Uint16Array]"]=ft["[object Uint32Array]"]=!0,ft["[object Arguments]"]=ft["[object Array]"]=ft["[object ArrayBuffer]"]=ft["[object Boolean]"]=ft["[object DataView]"]=ft["[object Date]"]=ft["[object Error]"]=ft["[object Function]"]=ft["[object Map]"]=ft["[object Number]"]=ft["[object Object]"]=ft["[object RegExp]"]=ft["[object Set]"]=ft["[object String]"]=ft["[object WeakMap]"]=!1;var pt="object"==typeof exports&&exports&&!exports.nodeType&&exports,yt=pt&&"object"==typeof module&&module&&!module.nodeType&&module,ht=yt&&yt.exports===pt&&r.process,gt=function(){try{return yt&&yt.require&&yt.require("util").types||ht&&ht.binding&&ht.binding("util")}catch{}}(),bt=gt&&gt.isTypedArray,dt=bt?lt(bt):function(t){return y(t)&&X(t.length)&&!!ft[p(t)]},vt=Object.prototype.hasOwnProperty;function mt(t,e){var r=b(t),n=!r&&ct(t),o=!r&&!n&&st(t),c=!r&&!n&&!o&&dt(t),i=r||n||o||c,a=i?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],u=a.length;for(var s in t)(e||vt.call(t,s))&&(!i||!("length"==s||o&&("offset"==s||"parent"==s)||c&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||H(s,u)))&&a.push(s);return a}function jt(t,e){return function(r){return t(e(r))}}var wt=jt(Object.keys,Object),_t=Object.prototype.hasOwnProperty;function Ot(t){return Y(t)?mt(t):function(t){if(!tt(t))return wt(t);var e=[];for(var r in Object(t))_t.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}var $t=Object.prototype.hasOwnProperty;function St(t){if(!j(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=tt(t),r=[];for(var n in t)"constructor"==n&&(e||!$t.call(t,n))||r.push(n);return r}function At(t){return Y(t)?mt(t,!0):St(t)}var Tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xt=/^\w*$/;var Et=M(Object,"create");var Pt=Object.prototype.hasOwnProperty;var kt=Object.prototype.hasOwnProperty;function It(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function qt(t,e){for(var r=t.length;r--;)if(V(t[r][0],e))return r;return-1}It.prototype.clear=function(){this.__data__=Et?Et(null):{},this.size=0},It.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},It.prototype.get=function(t){var e=this.__data__;if(Et){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Pt.call(e,t)?e[t]:void 0},It.prototype.has=function(t){var e=this.__data__;return Et?void 0!==e[t]:kt.call(e,t)},It.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Et&&void 0===e?"__lodash_hash_undefined__":e,this};var Mt=Array.prototype.splice;function Ut(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ut.prototype.clear=function(){this.__data__=[],this.size=0},Ut.prototype.delete=function(t){var e=this.__data__,r=qt(e,t);return!(r<0)&&(r==e.length-1?e.pop():Mt.call(e,r,1),--this.size,!0)},Ut.prototype.get=function(t){var e=this.__data__,r=qt(e,t);return r<0?void 0:e[r][1]},Ut.prototype.has=function(t){return qt(this.__data__,t)>-1},Ut.prototype.set=function(t,e){var r=this.__data__,n=qt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var zt=M(o,"Map");function Dt(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Ft(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ft.prototype.clear=function(){this.size=0,this.__data__={hash:new It,map:new(zt||Ut),string:new It}},Ft.prototype.delete=function(t){var e=Dt(this,t).delete(t);return this.size-=e?1:0,e},Ft.prototype.get=function(t){return Dt(this,t).get(t)},Ft.prototype.has=function(t){return Dt(this,t).has(t)},Ft.prototype.set=function(t,e){var r=Dt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Ct(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],c=r.cache;if(c.has(o))return c.get(o);var i=t.apply(this,n);return r.cache=c.set(o,i)||c,i};return r.cache=new(Ct.Cache||Ft),r}Ct.Cache=Ft;var Nt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rt=/\\(\\)?/g,Jt=function(t){var e=Ct(t,function(t){return 500===r.size&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Nt,function(t,r,n,o){e.push(n?o.replace(Rt,"$1"):r||t)}),e});function Bt(t,e){return b(t)?t:function(t,e){if(b(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!h(t))||xt.test(t)||!Tt.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:Jt(function(t){return null==t?"":m(t)}(t))}function Ht(t){if("string"==typeof t||h(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Lt(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var Vt=c?c.isConcatSpreadable:void 0;function Wt(t){return b(t)||ct(t)||!!(Vt&&t&&t[Vt])}function Gt(t){return(null==t?0:t.length)?function(t,e,r,n,o){var c=-1,i=t.length;for(r||(r=Wt),o||(o=[]);++c<i;){var a=t[c];r(a)?Lt(o,a):o[o.length]=a}return o}(t):[]}var Qt=jt(Object.getPrototypeOf,Object),Kt=Function.prototype,Xt=Object.prototype,Yt=Kt.toString,Zt=Xt.hasOwnProperty,te=Yt.call(Object);function ee(t){if(!y(t)||"[object Object]"!=p(t))return!1;var e=Qt(t);if(null===e)return!0;var r=Zt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Yt.call(r)==te}function re(t){var e=this.__data__=new Ut(t);this.size=e.size}re.prototype.clear=function(){this.__data__=new Ut,this.size=0},re.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},re.prototype.get=function(t){return this.__data__.get(t)},re.prototype.has=function(t){return this.__data__.has(t)},re.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Ut){var n=r.__data__;if(!zt||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ft(n)}return r.set(t,e),this.size=r.size,this};var ne="object"==typeof exports&&exports&&!exports.nodeType&&exports,oe=ne&&"object"==typeof module&&module&&!module.nodeType&&module,ce=oe&&oe.exports===ne?o.Buffer:void 0,ie=ce?ce.allocUnsafe:void 0;function ae(){return[]}var ue=Object.prototype.propertyIsEnumerable,se=Object.getOwnPropertySymbols,fe=se?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,c=[];++r<n;){var i=t[r];e(i,r,t)&&(c[o++]=i)}return c}(se(t),function(e){return ue.call(t,e)}))}:ae;var le=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Lt(e,fe(t)),t=Qt(t);return e}:ae;function pe(t,e,r){var n=e(t);return b(t)?n:Lt(n,r(t))}function ye(t){return pe(t,Ot,fe)}function he(t){return pe(t,At,le)}var ge=M(o,"DataView"),be=M(o,"Promise"),de=M(o,"Set"),ve="[object Map]",me="[object Promise]",je="[object Set]",we="[object WeakMap]",_e="[object DataView]",Oe=A(ge),$e=A(zt),Se=A(be),Ae=A(de),Te=A(U),xe=p;(ge&&xe(new ge(new ArrayBuffer(1)))!=_e||zt&&xe(new zt)!=ve||be&&xe(be.resolve())!=me||de&&xe(new de)!=je||U&&xe(new U)!=we)&&(xe=function(t){var e=p(t),r="[object Object]"==e?t.constructor:void 0,n=r?A(r):"";if(n)switch(n){case Oe:return _e;case $e:return ve;case Se:return me;case Ae:return je;case Te:return we}return e});var Ee=Object.prototype.hasOwnProperty;var Pe=o.Uint8Array;function ke(t){var e=new t.constructor(t.byteLength);return new Pe(e).set(new Pe(t)),e}var Ie=/\w*$/;var qe=c?c.prototype:void 0,Me=qe?qe.valueOf:void 0;function Ue(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return ke(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return function(t,e){var r=e?ke(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var r=e?ke(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,Ie.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return function(t){return Me?Object(Me.call(t)):{}}(t)}}var ze=gt&&gt.isMap,De=ze?lt(ze):function(t){return y(t)&&"[object Map]"==xe(t)};var Fe=gt&&gt.isSet,Ce=Fe?lt(Fe):function(t){return y(t)&&"[object Set]"==xe(t)},Ne="[object Arguments]",Re="[object Function]",Je="[object Object]",Be={};function He(t,e,r,n,o,c){var i,a=1&e,u=2&e,s=4&e;if(r&&(i=o?r(t,n,o,c):r(t)),void 0!==i)return i;if(!j(t))return t;var f=b(t);if(f){if(i=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Ee.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!a)return function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t,i)}else{var l=xe(t),p=l==Re||"[object GeneratorFunction]"==l;if(st(t))return function(t,e){if(e)return t.slice();var r=t.length,n=ie?ie(r):new t.constructor(r);return t.copy(n),n}(t,a);if(l==Je||l==Ne||p&&!o){if(i=u||p?{}:function(t){return"function"!=typeof t.constructor||tt(t)?{}:D(Qt(t))}(t),!a)return u?function(t,e){return Q(t,le(t),e)}(t,function(t,e){return t&&Q(e,At(e),t)}(i,t)):function(t,e){return Q(t,fe(t),e)}(t,function(t,e){return t&&Q(e,Ot(e),t)}(i,t))}else{if(!Be[l])return o?t:{};i=Ue(t,l,a)}}c||(c=new re);var y=c.get(t);if(y)return y;c.set(t,i),Ce(t)?t.forEach(function(n){i.add(He(n,e,r,n,t,c))}):De(t)&&t.forEach(function(n,o){i.set(o,He(n,e,r,o,t,c))});var h=f?void 0:(s?u?he:ye:u?At:Ot)(t);return function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););}(h||t,function(n,o){h&&(n=t[o=n]),G(i,o,He(n,e,r,o,t,c))}),i}Be[Ne]=Be["[object Array]"]=Be["[object ArrayBuffer]"]=Be["[object DataView]"]=Be["[object Boolean]"]=Be["[object Date]"]=Be["[object Float32Array]"]=Be["[object Float64Array]"]=Be["[object Int8Array]"]=Be["[object Int16Array]"]=Be["[object Int32Array]"]=Be["[object Map]"]=Be["[object Number]"]=Be[Je]=Be["[object RegExp]"]=Be["[object Set]"]=Be["[object String]"]=Be["[object Symbol]"]=Be["[object Uint8Array]"]=Be["[object Uint8ClampedArray]"]=Be["[object Uint16Array]"]=Be["[object Uint32Array]"]=!0,Be["[object Error]"]=Be[Re]=Be["[object WeakMap]"]=!1;function Le(t){return He(t,5)}function Ve(t,e){return e.length<2?t:function(t,e){for(var r=0,n=(e=Bt(e,t)).length;null!=t&&r<n;)t=t[Ht(e[r++])];return r&&r==n?t:void 0}(t,function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var c=Array(o);++n<o;)c[n]=t[n+e];return c}(e,0,-1))}function We(t,e){return null==(t=Ve(t,e=Bt(e,t)))||delete t[Ht(function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}(e))]}function Ge(t){return ee(t)?void 0:t}var Qe=function(t){return J(function(t,e,r){return e=K(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,c=K(n.length-e,0),i=Array(c);++o<c;)i[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(i),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(t,void 0,Gt),t+"")}(function(t,e){var r={};if(null==t)return r;var n=!1;e=g(e,function(e){return e=Bt(e,t),n||(n=e.length>1),e}),Q(t,he(t),r),n&&(r=He(r,7,Ge));for(var o=e.length;o--;)We(r,e[o]);return r});function Ke(t){return"[object URLSearchParams]"===Object.prototype.toString.call(t)}function Xe(t){return{GET:{request_body:!1},POST:{request_body:!0},PUT:{request_body:!0},DELETE:{request_body:!0},HEAD:{request_body:!1},OPTIONS:{request_body:!1},PATCH:{request_body:!0}}[t=t.toUpperCase()].request_body}function Ye(t){ee(t)&&Object.entries(t).forEach(([e,r])=>{"string"==typeof r?t[e]=r.trim():ee(r)&&Ye(r)})}const Ze=async(t,e)=>{Xe(t.config.method)&&Ye(t.config.params),await e()};const tr=async(t,e)=>{t.reqHeaders=new Headers(t.config.headers),t.reqHeaders.has("Content-Type")||(t.config.params instanceof FormData?function(t){for(const[e,r]of t.entries())if(r instanceof Blob)return!0;return!1}(t.config.params)||t.reqHeaders.set("Content-Type","multipart/form-data"):ee(t.config.params)&&t.reqHeaders.set("Content-Type","application/json")),await e()};const er=async(t,e)=>{t.config.baseURL&&!function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}(t.config.url)&&(t.config.url=function(t,e){return e?`${t.replace(/\/+$/,"")}/${e.replace(/^\/+/,"")}`:t}(t.config.baseURL,t.config.url)),await e()};function rr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nr={exports:{}};!function(t,e){const{hasOwnProperty:r}=Object.prototype,n=p();n.configure=p,n.stringify=n,n.default=n,e.stringify=n,e.configure=p,t.exports=n;const o=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function c(t){return t.length<5e3&&!o.test(t)?`"${t}"`:JSON.stringify(t)}function i(t,e){if(t.length>200||e)return t.sort(e);for(let r=1;r<t.length;r++){const e=t[r];let n=r;for(;0!==n&&t[n-1]>e;)t[n]=t[n-1],n--;t[n]=e}return t}const a=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function u(t){return void 0!==a.call(t)&&0!==t.length}function s(t,e,r){t.length<r&&(r=t.length);const n=","===e?"":" ";let o=`"0":${n}${t[0]}`;for(let c=1;c<r;c++)o+=`${e}"${c}":${n}${t[c]}`;return o}function f(t,e){let n;if(r.call(t,e)){if(n=t[e],"number"!=typeof n)throw new TypeError(`The "${e}" argument must be of type number`);if(!Number.isInteger(n))throw new TypeError(`The "${e}" argument must be an integer`);if(n<1)throw new RangeError(`The "${e}" argument must be >= 1`)}return void 0===n?1/0:n}function l(t){return 1===t?"1 item":`${t} items`}function p(t){const e=function(t){if(r.call(t,"strict")){const e=t.strict;if("boolean"!=typeof e)throw new TypeError('The "strict" argument must be of type boolean');if(e)return t=>{let e="Object can not safely be stringified. Received type "+typeof t;throw"function"!=typeof t&&(e+=` (${t.toString()})`),new Error(e)}}}(t={...t});e&&(void 0===t.bigint&&(t.bigint=!1),"circularValue"in t||(t.circularValue=Error));const n=function(t){if(r.call(t,"circularValue")){const e=t.circularValue;if("string"==typeof e)return`"${e}"`;if(null==e)return e;if(e===Error||e===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(t),o=function(t,e){let n;if(r.call(t,e)&&(n=t[e],"boolean"!=typeof n))throw new TypeError(`The "${e}" argument must be of type boolean`);return void 0===n||n}(t,"bigint"),a=function(t){let e;if(r.call(t,"deterministic")&&(e=t.deterministic,"boolean"!=typeof e&&"function"!=typeof e))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return void 0===e||e}(t),p="function"==typeof a?a:void 0,y=f(t,"maximumDepth"),h=f(t,"maximumBreadth");function g(t,r,s,f,b,d){let v=r[t];switch("object"==typeof v&&null!==v&&"function"==typeof v.toJSON&&(v=v.toJSON(t)),v=f.call(r,t,v),typeof v){case"string":return c(v);case"object":{if(null===v)return"null";if(-1!==s.indexOf(v))return n;let t="",e=",";const r=d;if(Array.isArray(v)){if(0===v.length)return"[]";if(y<s.length+1)return'"[Array]"';s.push(v),""!==b&&(t+=`\n${d+=b}`,e=`,\n${d}`);const n=Math.min(v.length,h);let o=0;for(;o<n-1;o++){const r=g(String(o),v,s,f,b,d);t+=void 0!==r?r:"null",t+=e}const c=g(String(o),v,s,f,b,d);if(t+=void 0!==c?c:"null",v.length-1>h){t+=`${e}"... ${l(v.length-h-1)} not stringified"`}return""!==b&&(t+=`\n${r}`),s.pop(),`[${t}]`}let o=Object.keys(v);const m=o.length;if(0===m)return"{}";if(y<s.length+1)return'"[Object]"';let j="",w="";""!==b&&(e=`,\n${d+=b}`,j=" ");const _=Math.min(m,h);a&&!u(v)&&(o=i(o,p)),s.push(v);for(let n=0;n<_;n++){const r=o[n],i=g(r,v,s,f,b,d);void 0!==i&&(t+=`${w}${c(r)}:${j}${i}`,w=e)}if(m>h){t+=`${w}"...":${j}"${l(m-h)} not stringified"`,w=e}return""!==b&&w.length>1&&(t=`\n${d}${t}\n${r}`),s.pop(),`{${t}}`}case"number":return isFinite(v)?String(v):e?e(v):"null";case"boolean":return!0===v?"true":"false";case"undefined":return;case"bigint":if(o)return String(v);default:return e?e(v):void 0}}function b(t,r,i,a,u,s){switch("object"==typeof r&&null!==r&&"function"==typeof r.toJSON&&(r=r.toJSON(t)),typeof r){case"string":return c(r);case"object":{if(null===r)return"null";if(-1!==i.indexOf(r))return n;const t=s;let e="",o=",";if(Array.isArray(r)){if(0===r.length)return"[]";if(y<i.length+1)return'"[Array]"';i.push(r),""!==u&&(e+=`\n${s+=u}`,o=`,\n${s}`);const n=Math.min(r.length,h);let c=0;for(;c<n-1;c++){const t=b(String(c),r[c],i,a,u,s);e+=void 0!==t?t:"null",e+=o}const f=b(String(c),r[c],i,a,u,s);if(e+=void 0!==f?f:"null",r.length-1>h){e+=`${o}"... ${l(r.length-h-1)} not stringified"`}return""!==u&&(e+=`\n${t}`),i.pop(),`[${e}]`}i.push(r);let f="";""!==u&&(o=`,\n${s+=u}`,f=" ");let p="";for(const n of a){const t=b(n,r[n],i,a,u,s);void 0!==t&&(e+=`${p}${c(n)}:${f}${t}`,p=o)}return""!==u&&p.length>1&&(e=`\n${s}${e}\n${t}`),i.pop(),`{${e}}`}case"number":return isFinite(r)?String(r):e?e(r):"null";case"boolean":return!0===r?"true":"false";case"undefined":return;case"bigint":if(o)return String(r);default:return e?e(r):void 0}}function d(t,r,f,g,b){switch(typeof r){case"string":return c(r);case"object":{if(null===r)return"null";if("function"==typeof r.toJSON){if("object"!=typeof(r=r.toJSON(t)))return d(t,r,f,g,b);if(null===r)return"null"}if(-1!==f.indexOf(r))return n;const e=b;if(Array.isArray(r)){if(0===r.length)return"[]";if(y<f.length+1)return'"[Array]"';f.push(r);let t=`\n${b+=g}`;const n=`,\n${b}`,o=Math.min(r.length,h);let c=0;for(;c<o-1;c++){const e=d(String(c),r[c],f,g,b);t+=void 0!==e?e:"null",t+=n}const i=d(String(c),r[c],f,g,b);if(t+=void 0!==i?i:"null",r.length-1>h){t+=`${n}"... ${l(r.length-h-1)} not stringified"`}return t+=`\n${e}`,f.pop(),`[${t}]`}let o=Object.keys(r);const v=o.length;if(0===v)return"{}";if(y<f.length+1)return'"[Object]"';const m=`,\n${b+=g}`;let j="",w="",_=Math.min(v,h);u(r)&&(j+=s(r,m,h),o=o.slice(r.length),_-=r.length,w=m),a&&(o=i(o,p)),f.push(r);for(let t=0;t<_;t++){const e=o[t],n=d(e,r[e],f,g,b);void 0!==n&&(j+=`${w}${c(e)}: ${n}`,w=m)}if(v>h){j+=`${w}"...": "${l(v-h)} not stringified"`,w=m}return""!==w&&(j=`\n${b}${j}\n${e}`),f.pop(),`{${j}}`}case"number":return isFinite(r)?String(r):e?e(r):"null";case"boolean":return!0===r?"true":"false";case"undefined":return;case"bigint":if(o)return String(r);default:return e?e(r):void 0}}function v(t,r,f){switch(typeof r){case"string":return c(r);case"object":{if(null===r)return"null";if("function"==typeof r.toJSON){if("object"!=typeof(r=r.toJSON(t)))return v(t,r,f);if(null===r)return"null"}if(-1!==f.indexOf(r))return n;let e="";const o=void 0!==r.length;if(o&&Array.isArray(r)){if(0===r.length)return"[]";if(y<f.length+1)return'"[Array]"';f.push(r);const t=Math.min(r.length,h);let n=0;for(;n<t-1;n++){const t=v(String(n),r[n],f);e+=void 0!==t?t:"null",e+=","}const o=v(String(n),r[n],f);if(e+=void 0!==o?o:"null",r.length-1>h){e+=`,"... ${l(r.length-h-1)} not stringified"`}return f.pop(),`[${e}]`}let g=Object.keys(r);const b=g.length;if(0===b)return"{}";if(y<f.length+1)return'"[Object]"';let d="",m=Math.min(b,h);o&&u(r)&&(e+=s(r,",",h),g=g.slice(r.length),m-=r.length,d=","),a&&(g=i(g,p)),f.push(r);for(let t=0;t<m;t++){const n=g[t],o=v(n,r[n],f);void 0!==o&&(e+=`${d}${c(n)}:${o}`,d=",")}if(b>h){e+=`${d}"...":"${l(b-h)} not stringified"`}return f.pop(),`{${e}}`}case"number":return isFinite(r)?String(r):e?e(r):"null";case"boolean":return!0===r?"true":"false";case"undefined":return;case"bigint":if(o)return String(r);default:return e?e(r):void 0}}return function(t,e,r){if(arguments.length>1){let n="";if("number"==typeof r?n=" ".repeat(Math.min(r,10)):"string"==typeof r&&(n=r.slice(0,10)),null!=e){if("function"==typeof e)return g("",{"":t},[],e,n,"");if(Array.isArray(e))return b("",t,[],function(t){const e=new Set;for(const r of t)("string"==typeof r||"number"==typeof r)&&e.add(String(r));return e}(e),n,"")}if(0!==n.length)return d("",t,[],n,"")}return v("",t,[])}}}(nr,nr.exports);const or=rr(nr.exports);or.configure;const cr=t=>Ke(t)?t.toString():"string"==typeof t||function(t){return"number"==typeof t||y(t)&&"[object Number]"==p(t)}(t)?t:ee(t)||Array.isArray(t)?or(t):"";async function ir(t,e){if(t.config.params){const e=cr(t.config.params);e&&(t.key=`${t.config.url}${e}${t.config.method}`)}else t.key=`${t.config.url}${t.config.method}`;await e()}const ar=()=>{const t=new Map,e=new Map,r=new Map;return async(n,o)=>{if(n.key)if(n.config.mergeRequest){const t=await function(t){if(e.get(t.key))return new Promise(e=>{const n=r.get(t.key)||[];r.set(t.key,n.concat(e))});e.set(t.key,!0)}(n);if(t)return void Object.keys(t).forEach(e=>{n[e]=t[e]})}else t.get(n.key)&&!n.config.mergeRequest&&console.warn("[request]: 重复请求, 可通过 mergeRequest 参数优化",n.config),t.set(n.key,!0);await o(),n.key&&(n.config.mergeRequest?function(t){const n=r.get(t.key);n&&n.length>0&&n.forEach(e=>{t.error?e({error:t.error}):e({response:t.response})}),r.delete(t.key),e.delete(t.key)}(n):t.delete(n.key))}},ur="__REQUEST_CACHE:",sr={ram:"ram",session:"sessionStorage",local:"localStorage"},fr=18e4;function lr(t,e="ram"){return e!==sr.ram?`${ur}${t}`:t}function pr(t){return ee(t)||function(t){return"string"==typeof t||!b(t)&&y(t)&&"[object String]"==p(t)}(t)||Array.isArray(t)||Ke(t)}function yr({expire:t,cacheTime:e}){return!(!e||t>=Date.now())}class hr{constructor(){this.data=new Map}get(t){const e=this.data.get(t);return e&&yr(e)?(this.data.delete(t),null):e?Le(e.data):null}set(t,e){this.data.forEach((t,e,r)=>{yr(t)&&r.delete(e)}),this.data.size>1e3?console.warn("Request: raw cache is exceed 1000 item, please check cache size"):this.data.set(t,Le(e))}delete(t){this.data.delete(t)}}const gr=()=>{const t=new hr;const e=new Map,r=new Map;return async(n,o)=>{if(function(t){return!(!(t.config.cacheData||t.config.cache&&"string"!=typeof t.config.cache)||!t.key&&(console.warn(`request: ${t.config.url} 请求参数无法序列化，无法缓存，请移除相关配置`),1))}(n)){const c=function(t){return"object"==typeof t.config.cacheData?t.config.cacheData:"object"==typeof t.config.cache?t.config.cache:{cacheType:"ram",cacheTime:fr}}(n);if(c.force)!function({key:e,cacheType:r="ram"}){const n=lr(e,r);if(r===sr.ram)return t.delete(n);window[sr[r]].removeItem(n)}({key:n.key,cacheType:c.cacheType});else{const e=function({key:e,cacheType:r="ram"}){const n=lr(e,r);if(r===sr.ram)return t.get(n);{const t=window[sr[r]],e=t.getItem(n)||null;try{const r=JSON.parse(e);return r&&!yr(r)?r.data:(t.removeItem(n),null)}catch{return t.removeItem(n),null}}}({key:n.key,cacheType:c.cacheType});if(e)return void(n.response=e)}const i=await function(t,n){const o=lr(t.key,n.cacheType);if(e.get(o))return new Promise(t=>{const e=r.get(o)||[];r.set(o,e.concat(t))});e.set(o,!0)}(n,c);if(i)return void Object.keys(i).forEach(t=>{n[t]=i[t]});await o(),n.response&&!pr(n.response)&&console.warn(`request: ${n.config.url} 响应数据无法序列化，无法缓存，请移除相关配置`),!n.error&&n.response&&pr(n.response)?(function(t,n){const o=lr(t.key,n.cacheType),c=r.get(o);c&&c.length>0&&c.forEach(e=>{e({response:t.response})}),r.delete(o),e.delete(o)}(n,c),function({key:e,cacheType:r="ram",data:n,cacheTime:o=fr}){const c=lr(e,r),i={cacheType:r,data:n,cacheTime:o,expire:Date.now()+o};if(r!==sr.ram){const t=window[sr[r]];try{t.setItem(c,JSON.stringify(i))}catch{for(const e in t)e.startsWith(ur)&&Object.prototype.hasOwnProperty.call(t,e)&&t.removeItem(e)}}else t.set(c,i)}({key:n.key,data:n.response,...c})):function(t,n){const o=lr(t.key,n.cacheType),c=r.get(o);c&&c.length>0?(c.shift()(),r.set(o,c)):(r.delete(o),e.delete(o))}(n,c)}else await o()}},br=t=>new Promise((e,r)=>{setTimeout(()=>{r({type:"TIMEOUT",msg:"请求超时"})},t||1e4)}),dr=t=>{if(Xe(t.config.method)){const e=t.config.params;if(ee(e)){if("application/x-www-form-urlencoded"===t.reqHeaders.get("Content-Type")){const t=new URLSearchParams;return Object.keys(e).forEach(r=>{t.set(r,e[r])}),t.toString()}if("multipart/form-data"===t.reqHeaders.get("Content-Type")){const t=new FormData;return Object.keys(e).forEach(r=>{t.append(r,e[r])}),t}return JSON.stringify(e)}return Array.isArray(e)?JSON.stringify(e):e}},vr=t=>{const e={};return t.forEach((t,r)=>{e[r]=t}),e};async function mr(t,e){const r=e.headers.get("content-type");try{const n=function(t,e){return t.config.responseType?t.config.responseType:e?/application\/json/i.test(e)?"json":/text|xml/.test(e)?"text":"blob":t.config.defaultResponseType||"blob"}(t,r);let o;return o="json"===n?await e.json():"text"===n?await e.text():"blob"===n?await e.blob():"arrayBuffer"===n?await e.arrayBuffer():"formData"===n?await e.formData():await e.blob(),o}catch(n){throw new Error(`response body parsing failed: ${n.message}`)}}const jr=t=>{const e=["baseURL","timeout","requestInterceptor","requestInterceptors","responseInterceptor","responseInterceptors","transformData","errorHandler","responseType"];return"string"!=typeof t.config.cache&&e.push("cache"),fetch((t=>{if(!Xe(t.config.method)){let e;return Ke(t.config.params)&&(e=t.config.params.toString()),ee(t.config.params)&&(e=new URLSearchParams(t.config.params).toString()),e?`${t.config.url}?${e}`:t.config.url}return t.config.url})(t),{...Qe(t.config,e),headers:vr(t.reqHeaders),body:dr(t)}).then(async e=>("opaqueredirect"===e.type&&(location.href=e.url),e.ok?{status:e.status,data:await mr(t,e),headers:vr(e.headers),config:t.config}:Promise.reject({response:{status:e.status,data:await mr(t,e),headers:vr(e.headers),config:t.config}})))};async function wr(t,e){await function(t){return new Promise((e,r)=>{const n=[],o=t.map(t=>t.then(t=>{const e={status:"fulfilled",value:t};return n.push(e),e},t=>{const e={status:"rejected",reason:t};return n.push(e),e}));Promise.race(o).then(async t=>{var o;"fulfilled"===t.status?e(t.value):"TIMEOUT"===(null==(o=t.reason)?void 0:o.type)?setTimeout(()=>{n.find(t=>"fulfilled"===t.status)?e(t.value):r(t.reason)}):r(t.reason)})})}([jr(t),br(t.config.timeout)]).then(async e=>{"function"==typeof t.config.responseInterceptor&&(e=await t.config.responseInterceptor(e)),w(t.config.transformData)&&(e.data=await t.config.transformData(e.data,e)),t.response=e}).catch(e=>{t.error=e}),await e()}function _r(t){let e=[];return"function"==typeof t?e=[t]:Array.isArray(t)&&(e=t),e}function Or(t){const e=_r(t);return async(t,r)=>{let n=t;for(const o of e)n=await o(n,r);return n}}function $r(t){const e=_r(t);return 0===e.length?null:async(t,r)=>{let n=t;for(const o of e)n=await o(n,r);return n}}function Sr(t={}){return t.requestInterceptor||t.requestInterceptors}function Ar(t={}){return t.responseInterceptor||t.responseInterceptors}function Tr(r){const n=(new t).use(e).use(er).use(tr).use(Ze).use(ir).use(gr()).use(ar()).use(wr).compose(),o={credentials:"include",...r};let c=Or(Sr(o)),i=$r(Ar(o));const a=async(t,e,r)=>{var a,u;"string"==typeof r&&(r={method:r});const s={config:{url:t,params:e,...o,...r}};try{return Sr(r)?s.config=await Or(Sr(r))(s.config,c):Sr(o)&&(s.config=await c(s.config)),Ar(r)?s.config.responseInterceptor=t=>$r(Ar(r))(t,i):s.config.responseInterceptor=i||null,n(s).then(async()=>{var t,e;return s.response?s.response:(s.error.config||(s.error.config=s.config),null==(e=(t=s.config).errorHandler)||e.call(t,s.error),Promise.reject(s.error))})}catch(f){throw null==(u=(a=s.config).errorHandler)||u.call(a,f),f}};return a.setConfig=function(t){Object.assign(o,{...t}),c=Or(Sr(o)),i=$r(Ar(o))},a}export{Tr as J};
