import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.rJvMOgN81722217438692.js";import{$ as o}from"./@tresjs.vs5lCFs11722217438692.js";import{C as e}from"./three-custom-shader-material.KBQJQbKq1722217438692.js";import"./object-hash.H_vbRcKd1722217438692.js";import{Y as r,a6 as i,C as u,Z as c,cb as a,k as s,b0 as l}from"./three.ej3u8izI1722217438692.js";import"./@amap.FTf_Qzi31722217438692.js";import"./glsl-tokenizer.BRlB_-gZ1722217438692.js";import{d as f,a1 as p,w as d,o as m,D as v,u as g,a4 as h,r as y,f as b,g as w,j as C,m as _}from"./@vue.Q1VpS3901722217438692.js";import{P as x}from"./tweakpane.yHWGBmom1722217438692.js";import"./@vueuse.mG9rDBoo1722217438692.js";import"./glsl-token-string.R7dCM80c1722217438692.js";import"./glsl-token-functions.DFHfxlmC1722217438692.js";import"./jszip.FHAQs96M1722217438692.js";const M=I;function j(){const t=["color","material","toString","test","renderOrder","land","2672GQKwXj","uTime","while (true) {}","city","DoubleSide","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","Color",'{}.constructor("return this")( )',"gger","forEach","setStyle","topColor","isArray","input","uOpacity","side","model","gradient","warn","6201qjMPAb","length","bind","constructor","prototype","249552AVFope","computeBoundingBox","computeBoundingSphere","boundingBox","console","return (function() ","action","trace","init","log","landColor","uniforms","bulidingsColor","__proto__","7ikujGt","197620anNZuZ","1584948ExckUh","228lqMkTJ","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","chain","#e523ff","185875iMnabq","apply","opacity","exception","primitive","value","274034psxYsp","30KzdRbm","#ffffff","info","debu","#ffff00"];return(j=function(){return t})()}function I(t,n){const o=j();return(I=function(t,n){return o[t-=192]})(t,n)}!function(t,n){const o=I,e=j();for(;;)try{if(240458===parseInt(o(223))/1+-parseInt(o(213))/2*(parseInt(o(255))/3)+parseInt(o(212))/4+parseInt(o(217))/5*(-parseInt(o(224))/6)+-parseInt(o(210))/7*(parseInt(o(235))/8)+-parseInt(o(196))/9+parseInt(o(211))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(218)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){S(this,(function(){const t=I,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(240),"i"),e=F(t(204));n[t(232)](e+t(215))&&o[t(232)](e+t(249))?F():e("0")}))()}();const T=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(218)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();T(void 0,(function(){const t=I;let n;try{n=Function(t(201)+t(243)+");")()}catch(r){n=window}const o=n.console=n[t(200)]||{},e=[t(205),t(254),t(226),"error",t(220),"table",t(203)];for(let i=0;i<e[t(192)];i++){const n=T[t(194)][t(195)].bind(T),r=e[i],u=o[r]||n;n[t(209)]=T[t(193)](T),n.toString=u[t(231)].bind(u),o[r]=n}}))();const k=["object"],P=f({__name:"bModel",props:{model:{},bulidingsColor:{default:M(216)},landColor:{default:"#112233"},topColor:{default:M(228)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=M,a=t,s=a.model[n(238)];a[n(252)][n(252)].children[0].material=new r({color:"#ffff00"}),s[n(233)]=1001;const l=a[n(252)].land;(()=>{const t=n,{geometry:o}=s;o[t(197)](),o[t(198)]();const{max:r,min:l}=o[t(199)];if(s[t(230)].__csm)return;const f=new e({baseMaterial:s[t(230)],vertexShader:t(214),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:r},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(a[t(208)])},uOpacity:{value:a[t(219)]},uLightColor:{value:new u(t(225))},uTopColor:{value:new(i[t(242)])(a[t(247)])},uTime:{value:0},uGradient:{value:a[t(253)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:c});s.material.dispose(),s[t(230)]=f})();const{onLoop:f}=o();f((({delta:t})=>{const o=n;s.material.uniforms[o(236)].value+=t})),p((()=>{const t=n;a[t(208)]&&s[t(230)][t(207)].uColor[t(222)][t(246)](a[t(208)]),a[t(206)]&&((t,o)=>{const e=n;let r;"cu"===t||t===e(234)&&(r=Array[e(248)](l[e(230)])?l.material:[l[e(230)]],r[e(245)]((t=>{const n=e;t[o].setStyle(a[n(206)]),t[n(251)]=i[n(239)]})))})(t(234),t(229)),a[t(219)]&&(s[t(230)][t(207)][t(250)][t(222)]=a[t(219)])})),d(a,((t,o)=>{const e=n;s.material.uniforms.uGradient.value=t[e(253)]}));const h=a[n(252)][n(252)].clone();return(t,o)=>{const e=n;return m(),v(e(221),{object:g(h)},null,8,k)}}});function F(t){function n(t){const o=I;if(typeof t===o(241))return function(t){}[o(194)](o(237))[o(218)]("counter");1!==(""+t/t)[o(192)]||t%20==0?function(){return!0}[o(194)](o(227)+o(244)).call(o(202)):function(){return!1}[o(194)](o(227)+"gger")[o(218)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=B;!function(t,n){const o=B,e=E();for(;;)try{if(317123===parseInt(o(233))/1+parseInt(o(222))/2*(parseInt(o(245))/3)+parseInt(o(230))/4+parseInt(o(199))/5*(-parseInt(o(188))/6)+-parseInt(o(238))/7+parseInt(o(219))/8+parseInt(o(207))/9*(-parseInt(o(235))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function B(t,n){const o=E();return(B=function(t,n){return o[t-=188]})(t,n)}!function(){z(this,(function(){const t=B,n=new RegExp(t(198)),o=new RegExp(t(214),"i"),e=Z(t(211));n[t(194)](e+t(224))&&o[t(194)](e+t(218))?Z():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[B(227)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();G(void 0,(function(){const t=B,n=function(){const t=B;let n;try{n=Function(t(244)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=[t(243),t(193),t(197),"error",t(237),"table","trace"];for(let r=0;r<e[t(195)];r++){const n=G[t(215)][t(229)][t(240)](G),i=e[r],u=o[i]||n;n[t(203)]=G[t(240)](G),n[t(204)]=u[t(204)][t(240)](u),o[i]=n}}))();const A=[O(232)];function E(){const t=["2663920FtXTXH","bLine","bind","matrix","color","log","return (function() ","12zkSxkS","426vsQLzg","geometry","uGradual","builds","uSrcColor","warn","test","length","uniforms","info","function *\\( *\\)","22465VwBVlk","value","material","scale","__proto__","toString","applyMatrix4","while (true) {}","36bhEaFx","uTime","gger","primitive","init","#000","clone","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","#FFF","linewidth","input","224792BcVKMO","width","counter","252410zqMdGt","string","chain","gradual","action","apply","call","prototype","786248bmPEjn","srcColor","object","315321fysppC","debu","70290cVkMxZ","renderOrder","exception"];return(E=function(){return t})()}const R=f({__name:O(239),props:{builds:{},color:{default:O(216)},srcColor:{default:O(212)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e[n(242)])},uSrcColor:{value:new u(e[n(231)])},uScale:{value:e[n(202)]},uTime:{value:0},uGradual:{value:e[n(225)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let c=new a(e.builds[n(189)])[n(213)]();c=c[n(205)](e[n(191)][n(241)]);const f=new s(i);r=new l(c,f),r[n(201)][n(217)]=e[n(220)],r[n(236)]=1e3,p((()=>{const t=n;e[t(242)]&&(i[t(196)].uColor.value=new u(e[t(242)])),e[t(231)]&&(i[t(196)][t(192)][t(200)]=new u(e[t(231)])),e[t(202)]&&(i[t(196)].uScale[t(200)]=e[t(202)]),e[t(225)]&&(i[t(196)][t(190)][t(200)]=e.gradual)}));const{onLoop:d}=o();return d((({delta:t})=>{const o=n;i[o(196)].uTime.value+=t*e.speed,i.uniforms[o(208)][o(200)]%=1})),(t,o)=>{const e=n;return m(),v(e(210),{object:g(r)},null,8,A)}}});function Z(t){function n(t){const o=B;if(typeof t===o(223))return function(t){}[o(215)](o(206))[o(227)](o(221));1!==(""+t/t)[o(195)]||t%20==0?function(){return!0}[o(215)]("debu"+o(209))[o(228)](o(226)):function(){return!1}[o(215)](o(234)+o(209))[o(227)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=$;function $(t,n){const o=V();return($=function(t,n){return o[t-=298]})(t,n)}!function(t,n){const o=$,e=V();for(;;)try{if(860245===parseInt(o(301))/1+-parseInt(o(304))/2*(parseInt(o(325))/3)+parseInt(o(322))/4+parseInt(o(333))/5+parseInt(o(319))/6+-parseInt(o(324))/7+parseInt(o(311))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(307)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){D(this,(function(){const t=$,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(331),"i"),e=q("init");n[t(315)](e+"chain")&&o.test(e+"input")?q():e("0")}))()}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(307)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function V(){const t=["trace","buildingsEffectA","console","1519816kGLUUN","exception","model","debu","test","prototype","return (function() ","call","2406288kvsojN","error","gradual","3969496EaCxSG","#000000","8518104tNtRlK","1637067hHHgbG","constructor","效果参数","counter","string","table","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","最大扩散","1109910mQUOXM","city","gger","srcColor","log","线扫颜色","scale","warn","#112233","length","addBinding",'{}.constructor("return this")( )',"扩散系数","__proto__","stateObject","#999","color","1363114sQPkJF","speed","toString","4NsCIig","action","bind","apply"];return(V=function(){return t})()}H(void 0,(function(){const t=$;let n;try{n=Function(t(317)+t(344)+");")()}catch(r){n=window}const o=n[t(310)]=n.console||{},e=[t(337),t(340),"info",t(320),t(312),t(330),t(308)];for(let i=0;i<e[t(342)];i++){const n=H.constructor[t(316)][t(306)](H),r=e[i],u=o[r]||n;n[t(346)]=H.bind(H),n[t(303)]=u[t(303)][t(306)](u),o[r]=n}}))();const N=f({__name:L(309),async setup(o){const e=L;let r,i;const u=([r,i]=h((()=>n())),r=await r,i(),r),c=y({color:"#FFF",srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),a=new x({title:e(327),expanded:!0});return a[e(343)](c,e(336),{label:"线原颜色"}),a.addBinding(c,e(300),{label:e(338)}),a[e(343)](c,e(302),{label:"速度",min:.1,max:1,step:.1}),a.addBinding(c,e(339),{label:e(332),min:10,max:2e3,step:10}),a[e(343)](c,e(321),{label:e(345),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return m(),b(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(P,{model:g(u),bulidingsColor:r(323),landColor:r(341),topColor:r(299)},null,8,[r(313)]),C(R,_({builds:g(u)[r(334)]},c),null,16,["builds"])])),_:1})}}});function q(t){function n(t){const o=$;if(typeof t===o(329))return function(t){}[o(326)]("while (true) {}")[o(307)](o(328));1!==(""+t/t)[o(342)]||t%20==0?function(){return!0}[o(326)](o(314)+"gger")[o(318)](o(305)):function(){return!1}[o(326)](o(314)+o(335))[o(307)](o(298)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{N as default};
