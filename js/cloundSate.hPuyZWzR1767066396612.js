import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as t,K as a}from"./@tresjs.B1f7s3pS1767066396612.js";import{p as o,e as n}from"./three-tile.D9ZubqJI1767066396612.js";import{a as r,c as l,s as i,i as c}from"./informationDiv.zYrf_U5j1767066396612.js";import{i as p}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.DS9PWjZT1767066396612.js";import"./index.vue_vue_type_script_setup_true_lang.iYOGhvYh1767066396612.js";import{P as s}from"./tweakpane.CqZAnw7f1767066396612.js";const{withAsyncContext:m,defineComponent:u}=await e("vue"),{unref:d,createElementVNode:h,openBlock:g,createElementBlock:_}=await e("vue"),f=["position"],v=["scale","material","rotateX","position-y"],S=await e("three"),{watch:w}=await e("vue"),y=u({__name:"cloundSateShow",props:{map:{},height:{default:100},color:{default:"#cccccc"},opacity:{default:.6}},async setup(e){let t,a;const o=e,n=new S.MeshPhongMaterial({displacementMap:new S.Texture,transparent:!0,side:S.DoubleSide,opacity:o.opacity,color:new S.Color(o.color)});n.onBeforeCompile=e=>{e.vertexShader="uniform sampler2D map;\n\t\t"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","transformed += normalize( objectNormal ) * ( texture2D(map, vMapUv ).a * 0.5 + 0.0 );"),e.fragmentShader=e.fragmentShader.replace("#include <alphamap_fragment>","\n            #include <alphamap_fragment>\n            float h = texture2D(map, vMapUv ).a;\n            diffuseColor.rgb *= h;\n            diffuseColor.a = clamp(diffuseColor.a * 2.0, 0.0, 1.0);\n            ")};const l=o.map.geo2map(new S.Vector3(105,34,0));l.applyMatrix4(o.map.matrix);const i=r(o.map,{x:67,y:11},{x:140,y:57},1e3*o.height),c=["https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171300.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171400.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171500.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171600.HDF.png"];let s=0;const u=([t,a]=m(()=>p(c)),t=await t,a(),t);n.map=u[s],w(()=>[o.color,o.opacity],([e,t])=>{n.color.setStyle(e),n.opacity=t});let y=null,x=!1;return x?(clearInterval(y),y=null,x=!1):(y=setInterval(()=>{s=s<c.length-1?s+1:0,n.map=u[s],n.needsUpdate=!0,console.log(s)},1e3),x=!0),(e,t)=>(g(),_("TresGroup",{position:[...d(l)]},[h("TresMesh",{scale:[d(i).x,d(i).y,1e3*e.height],material:d(n),rotateX:-Math.PI/2,renderOrder:9999,"position-y":1e3*e.height/5},[...t[0]||(t[0]=[h("TresPlaneGeometry",{args:[1,1,529,420]},null,-1)])],8,v)],8,f))}}),{defineComponent:x}=await e("vue"),{createElementVNode:M,unref:B,mergeProps:D,createVNode:I,Suspense:C,withCtx:F,openBlock:T,createBlock:P,Fragment:V,createElementBlock:b}=await e("vue"),j=["object"],{watch:k,ref:E,reactive:G}=await e("vue"),N=await e("three"),L=x({__name:"mapBoxShow2",setup(e){const a=G({height:500,color:"#cccccc",opacity:.6}),r=new s({title:"参数"});r.addBinding(a,"color",{label:"颜色"}),r.addBinding(a,"height",{label:"高度",min:10,max:5e3,step:10}),r.addBinding(a,"opacity",{label:"透明度",min:0,max:1,step:.1});const c=o.create({imgSource:[new n({style:"6"}),new n({style:"8"})],minLevel:2,maxLevel:18,lon0:90});c.rotateX(-Math.PI/2);const p=new N.Vector3(105,34,0),m=new N.Vector3(110,0,1e7),u=c.localToWorld(c.geo2map(p)),d=c.localToWorld(c.geo2map(m)),h=E(),{camera:g,controls:_,scene:f,renderer:v}=t();return g.value&&g.value.position.copy(d),k(()=>_.value,e=>{e&&(e.target.copy(u),l(e,g.value,f.value))}),k(()=>h.value,e=>{e&&e.target.position.copy(u)}),i(g.value,v.domElement,c),(e,t)=>(T(),b(V,null,[M("TresDirectionalLight",{ref_key:"tdLight",ref:h,position:[0,2e3,1e3],intensity:1},null,512),M("primitive",{object:B(c)},null,8,j),(T(),P(C,null,{default:F(()=>[I(y,D({map:B(c)},a),null,16,["map"])]),_:1}))],64))}}),{defineComponent:A}=await e("vue"),{createElementVNode:R,unref:W,normalizeProps:O,guardReactiveProps:H,createVNode:z,resolveComponent:U,mergeProps:X,withCtx:K,Fragment:Q,openBlock:q,createElementBlock:J}=await e("vue"),{reactive:Y}=await e("vue"),Z=A({__name:"cloundSate",setup(e){const t=Y({clearColor:"#dbf0ff",alpha:!0,antialias:!1,logarithmicDepthBuffer:!0,precision:"highp"}),o=Y({enableDamping:!0,makeDefault:!0,screenSpacePanning:!1,keyPanSpeed:5});return(e,n)=>{const r=U("TresCanvas");return q(),J(Q,null,[z(r,X(t,{"window-size":""}),{default:K(()=>[n[0]||(n[0]=R("TresPerspectiveCamera",{position:[0,12,0],fov:70,near:1,far:4e10},null,-1)),z(W(a),O(H(o)),null,16),n[1]||(n[1]=R("TresAmbientLight",{intensity:1},null,-1)),z(L)]),_:1},16),z(c)],64)}}});export{Z as default};
