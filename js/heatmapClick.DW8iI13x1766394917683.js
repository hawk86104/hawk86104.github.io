import{K as e}from"./@tresjs.CC-VM6g11766394917683.js";import{P as t}from"./tweakpane.CqZAnw7f1766394917683.js";import{z as a,q as s,a6 as o,j as n,$ as r,A as i}from"./three.F31Lz30M1766394917683.js";import"./shapeConfigurator.vue_vue_type_style_index_1_scoped_abbf0cc1_lang.CXJ66YiI1766394917683.js";import"./Resource.CDqX8L841766394917683.js";import{u as l}from"./index.XhuLVvN11766394917683.js";import"./three-custom-shader-material.-uIL0IHF1766394917683.js";import{h as p}from"./heatmap.js-fix.DFCt0R6f1766394917683.js";import{d as u,ac as d,a3 as m,G as c,o as h,ae as v,u as f,r as g,g as y,b as _,e as j,I as b,h as x,ah as w,a9 as C,aa as B,m as M}from"./@vue.BxPWGdWw1766394917683.js";import"./postprocessing.DnKKyAPS1766394917683.js";import"./@vueuse.PX2Ih8Bm1766394917683.js";import"./object-hash.BlsCJiuO1766394917683.js";import"./@amap.fjyZdsU91766394917683.js";import"./jszip.CCQtYoU41766394917683.js";import"./three-stdlib.DKf5n1fq1766394917683.js";import"./useLoader.VuwfYjb91766394917683.js";const z=["object"],T=u({__name:"heatmapClickCom",props:{show2dCanvas:{type:Boolean,default:!0},radius:{default:20}},async setup(e){let t,r;const i=e,{nodes:u}=([t,r]=d(()=>l("https://opensource.cdn.icegl.cn/model/heatmap/test.glb")),t=await t,r(),t);u.mesh_0.position.set(-5088.96,-3.08,39374.7),u.mesh_0.scale.setScalar(.01);let g=null,y=null,_=null;y=new a((_=document.createElement("heatmap-canvas"),_.style.position="absolute",_.style.top="40px",_.style.left="0",document.body.appendChild(_),g=p.create({container:_,width:256,height:256,blur:"0.8",radius:i.radius}),g._renderer.canvas.style.border="1px solid #5384ff",g._renderer.canvas.onclick=function(e){g.addData({x:e.layerX,y:e.layerY,value:1,radius:i.radius}),g.setDataMax(1),y&&(y.needsUpdate=!0)},g)._renderer.canvas);const j=new s({vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\tvUv = uv;\n\t}\n\t",fragmentShader:"\n\tuniform sampler2D heightMap;\n\tuniform float uOpacity;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_FragColor = vec4(texture2D(heightMap, vUv.xy).rgb, uOpacity);\n\t}\n\t",uniforms:{uOpacity:{value:1},heightMap:{type:"t",value:y}},depthWrite:!0,depthTest:!0,transparent:!0,side:o});u.mesh_0.material=j;return(e=>{e.computeBoundingBox();const{max:t,min:a}=e.boundingBox;e.deleteAttribute("uv");const s=t.x-a.x,o=t.z-a.z,r=[];for(let n=0;n<e.attributes.position.count;n++)r.push((e.attributes.position.getX(n)-a.x)/s),r.push((e.attributes.position.getZ(n)-a.z)/o);const i=new Float32Array(r);e.setAttribute("uv",new n(i,2))})(u.mesh_0.geometry),m(()=>{_.style.display=""+(i.show2dCanvas?"block":"none")}),(e,t)=>(h(),c("primitive",{object:v(f(u).mesh_0)},null,8,z))}}),k=u({__name:"heatmapClick",setup(a){const s={clearColor:"#030311",shadows:!0,alpha:!0,outputColorSpace:i,shadowMapType:r,useLegacyLights:!0,antialias:!0},o=g({show2dCanvas:!0,radius:20}),n=new t({title:"参数",expanded:!0});return n.addBinding(o,"show2dCanvas",{label:"显示二维图"}),n.addBinding(o,"radius",{label:"圆圈的大小",min:.1,max:30,step:.1}),n.addButton({title:"点击左侧蓝色画框"}),(t,a)=>{const n=y("TresCanvas");return h(),_(n,M(s,{"window-size":""}),{default:j(()=>[a[0]||(a[0]=b("TresPerspectiveCamera",{position:[21,34,55],fov:60,near:1,far:1e5},null,-1)),x(f(e),{autoRotate:!1,autoRotateSpeed:2}),a[1]||(a[1]=b("TresDirectionalLight",{position:[5,10,7.5],color:"#ffffff",intensity:5},null,-1)),a[2]||(a[2]=b("TresGridHelper",{args:[50,25]},null,-1)),(h(),_(w,null,{default:j(()=>[x(T,C(B(o)),null,16)]),_:1}))]),_:1},16)}}});export{k as default};
