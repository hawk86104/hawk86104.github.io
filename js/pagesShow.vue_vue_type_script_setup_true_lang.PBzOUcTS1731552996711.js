import{a0 as t,_ as n,cc as e,cd as o,ce as r,cf as i,C as u,m as c,bU as s,ak as a,am as l}from"./three.KG0QRRig1731552996711.js";import{d as f,e as p,U as d}from"./@tresjs.01P8tiuF1731552996711.js";import{z as m}from"./three-custom-shader-material.B7Wbwjde1731552996711.js";import{d as h,b as y,a3 as g,w,o as v,D as _,u as b,r as I,a6 as C,e as x,f as M,g as T,J as O,j as S,aj as j,ak as A,F as R,I as B,G as Z,m as E}from"./@vue.-THQH3GC1731552996711.js";!function(t,n){const e=z,o=H();for(;;)try{if(478119===-parseInt(e(239))/1*(parseInt(e(245))/2)+parseInt(e(223))/3+parseInt(e(227))/4*(-parseInt(e(220))/5)+-parseInt(e(219))/6*(-parseInt(e(251))/7)+-parseInt(e(226))/8+-parseInt(e(216))/9+parseInt(e(237))/10)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const D=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[z(215)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function H(){const t=["gger","1OAvQPr","test","exception","prototype","length","log","1294730BjKUJi","toString","traverse","stateObject","CITY_UNTRIANGULATED","debu","11116KNLaTT","function *\\( *\\)","action","apply","5885469xYYnyx","info","while (true) {}","1902PDSEwi","25sadgEl","return (function() ","error","2219625IRHuXD","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","call","5843520OUrEZZ","379380wWOvmy",'{}.constructor("return this")( )',"warn","trace","name","input","constructor","bind","counter","init","17408190EtzrZN"];return(H=function(){return t})()}function z(t,n){const e=H();return(z=function(t,n){return e[t-=215]})(t,n)}!function(){D(this,(function(){const t=z,n=new RegExp(t(252)),e=new RegExp(t(224),"i"),o=F(t(236));n[t(240)](o+"chain")&&e[t(240)](o+t(232))?F():o("0")}))()}();const L=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();L(void 0,(function(){const t=z;let n;try{n=Function(t(221)+t(228)+");")()}catch(r){n=window}const e=n.console=n.console||{},o=[t(244),t(229),t(217),t(222),t(241),"table",t(230)];for(let i=0;i<o[t(243)];i++){const n=L[t(233)][t(242)].bind(L),r=o[i],u=e[r]||n;n.__proto__=L.bind(L),n[t(246)]=u[t(246)][t(234)](u),e[r]=n}}))();const P=async()=>{const t=z,n=await f("./plugins/digitalCity/model/shanghai.FBX");let e=null,o=null,r=null;return n[t(247)]((n=>{const i=t;n.name===i(249)&&(e=n),"LANDMASS"===n[i(231)]&&(o=n),"ROADS"===n.name&&(r=n)})),{model:n,city:e,land:o,roads:r}};function F(t){function n(t){const e=z;if("string"==typeof t)return function(t){}[e(233)](e(218)).apply(e(235));1!==(""+t/t)[e(243)]||t%20==0?function(){return!0}.constructor(e(250)+e(238))[e(225)](e(253)):function(){return!1}[e(233)](e(250)+e(238))[e(215)](e(248)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const k=U;!function(t,n){const e=U,o=$();for(;;)try{if(304270===-parseInt(e(244))/1*(parseInt(e(288))/2)+-parseInt(e(298))/3+parseInt(e(264))/4*(parseInt(e(280))/5)+-parseInt(e(275))/6*(parseInt(e(256))/7)+-parseInt(e(269))/8+parseInt(e(268))/9*(parseInt(e(243))/10)+-parseInt(e(266))/11*(-parseInt(e(247))/12))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const G=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[U(271)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){G(this,(function(){const t=U,n=new RegExp(t(259)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=K(t(281));n.test(o+t(240))&&e[t(252)](o+t(251))?K():o("0")}))()}();const N=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[U(271)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function U(t,n){const e=$();return(U=function(t,n){return e[t-=233]})(t,n)}N(void 0,(function(){const t=U,n=function(){const t=U;let n;try{n=Function(t(235)+t(248)+");")()}catch(e){n=window}return n}(),e=n[t(291)]=n[t(291)]||{},o=[t(239),t(277),t(255),t(296),t(273),t(286),t(233)];for(let r=0;r<o.length;r++){const n=N[t(284)].prototype[t(294)](N),i=o[r],u=e[i]||n;n.__proto__=N[t(294)](N),n[t(287)]=u.toString[t(294)](u),e[i]=n}}))();const W=[k(292)];function $(){const t=["8162yFXyag","computeBoundingBox","bulidingsColor","function *\\( *\\)","uOpacity","clone","isArray","stateObject","1848292SmOSRy","land","1016851obKIOl","color","16542cflPUU","3013568hvZdAQ","while (true) {}","apply","primitive","exception","city","1266CaqDAw","call","warn","setStyle","opacity","5aBTIGv","init","topColor","value","constructor","gger","table","toString","22bHaCqX","#e523ff","debu","console","object","gradient","bind","uGradient","error","__csm","1211748QbHrNB","uniforms","trace","string","return (function() ","counter","Color","model","log","chain","side","DoubleSide","2390dKHOnq","44987MvuRsR","landColor","#ffff00","120ETjzDZ",'{}.constructor("return this")( )',"length","material","input","test","boundingBox","#ffffff","info"];return($=function(){return t})()}const Q=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:k(289)},landColor:{default:"#112233"},topColor:{default:k(246)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const o=k,r=e,i=y(0),u=r.model[o(274)];u.renderOrder=1001;const c=r[o(238)][o(265)];(()=>{const t=o,{geometry:e}=u;e[t(257)](),e.computeBoundingSphere();const{max:c,min:s}=e[t(253)];if(u[t(250)][t(297)])return;const a=new m({baseMaterial:u[t(250)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(n[t(237)])(r[t(258)])},uOpacity:{value:r[t(279)]},uLightColor:{value:new(n[t(237)])(t(254))},uTopColor:{value:new(n[t(237)])(r[t(282)])},uTime:i,uGradient:{value:r[t(293)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:n[t(242)]});u[t(250)].dispose(),u[t(250)]=a})();const{onLoop:s}=p();s((({delta:t})=>{i[o(283)]+=t})),g((()=>{const n=o;r[n(258)]&&u.material[n(299)].uColor[n(283)].setStyle(r[n(258)]),r[n(245)]&&((n,e)=>{const i=o;let u;"cu"===n||n===i(265)&&(u=Array[i(262)](c[i(250)])?c.material:[c.material],u.forEach((n=>{const o=i;n[e][o(278)](r[o(245)]),n[o(241)]=t})))})(n(265),n(267)),r[n(279)]&&(u[n(250)][n(299)][n(260)].value=r[n(279)])})),w(r,((t,n)=>{const e=o;u[e(250)][e(299)][e(295)][e(283)]=t.gradient}));const a=r[o(238)].model[o(261)]();return(t,n)=>{const e=o;return v(),_(e(272),{object:b(a)},null,8,W)}}});function K(t){function n(t){const e=U;if(typeof t===e(234))return function(t){}[e(284)](e(270))[e(271)](e(236));1!==(""+t/t)[e(249)]||t%20==0?function(){return!0}[e(284)](e(290)+e(285))[e(276)]("action"):function(){return!1}[e(284)]("debu"+e(285))[e(271)](e(263)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function X(){const t=["linewidth","bind","width","call","uOpacity","45HoZaON","exception","1285yjzuBd","debu","8090138yzNHaE","913914TpseVC","11224UxfAeX","test","renderOrder","12fqifYY","43ZpvjZj","innerHeight","color","error","innerWidth","constructor","return (function() ","applyMatrix4","apply","trace","chain","buildingsLines","938790cnGttg","warn","table","opacity","3325920clKKOZ","init","Wireframe","primitive","matrix","while (true) {}","stateObject","uColor","style","value","geometry","counter","36198fvlgZp","36pXmdVZ",'{}.constructor("return this")( )',"builds","toString","input","uniforms","gger","length","object","fromEdgesGeometry","log","prototype","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","material","5313242NaOtEe"];return(X=function(){return t})()}const q=Y;function Y(t,n){const e=X();return(Y=function(t,n){return e[t-=475]})(t,n)}!function(t,n){const e=Y,o=X();for(;;)try{if(784224===-parseInt(e(485))/1*(parseInt(e(481))/2)+parseInt(e(480))/3*(-parseInt(e(484))/4)+parseInt(e(477))/5*(-parseInt(e(513))/6)+parseInt(e(479))/7+parseInt(e(501))/8+parseInt(e(475))/9*(parseInt(e(497))/10)+parseInt(e(528))/11*(parseInt(e(514))/12))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const V=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[Y(493)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){V(this,(function(){const t=Y,n=new RegExp("function *\\( *\\)"),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=et(t(502));n[t(482)](o+t(495))&&e.test(o+t(518))?et():o("0")}))()}();const J=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[Y(493)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();J(void 0,(function(){const t=Y;let n;try{n=Function(t(491)+t(515)+");")()}catch(r){n=window}const e=n.console=n.console||{},o=[t(524),t(498),"info",t(488),t(476),t(499),t(494)];for(let i=0;i<o.length;i++){const n=J[t(490)][t(525)].bind(J),r=o[i],u=e[r]||n;n.__proto__=J[t(530)](J),n[t(517)]=u[t(517)][t(530)](u),e[r]=n}}))();const tt=[q(522)],nt=h({__name:q(496),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:q(503)}},setup(t){const n=q,s=t;let a=null,l=null;if(s[n(509)]===n(503)){const t=new e(s[n(516)][n(511)]);let u=(new o)[n(523)](t),c=new r({color:s[n(487)],linewidth:s[n(531)],opacity:s[n(500)],transparent:!0,depthWrite:!0,depthTest:!0});c.resolution.set(window[n(489)],window[n(486)]),a=new i(u,c),a[n(492)](s[n(516)][n(505)].clone())}else{l={transparent:!0,uniforms:{uColor:{value:new u(s[n(487)])},uOpacity:{value:s[n(500)]}},vertexShader:n(526),fragmentShader:" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const t=new e(s[n(516)][n(511)]),o=new c(l);a=new LineSegments(t,o),a[n(492)](s[n(516)].matrix.clone()),a[n(527)][n(529)]=s[n(531)],a[n(483)]=1e3}return g((()=>{const t=n;"Shader"===s.style&&(s[t(487)]&&(l.uniforms[t(508)][t(510)]=new u(s[t(487)])),s.opacity&&(l[t(519)][t(533)].value=s[t(500)])),s[t(509)]===t(503)&&(s[t(487)]&&(a[t(527)][t(487)]=new u(s[t(487)])),s[t(500)]&&(a[t(527)][t(500)]=s.opacity)),s[t(531)]&&(a[t(527)][t(529)]=s.width)})),(t,e)=>{const o=n;return v(),_(o(504),{object:b(a)},null,8,tt)}}});function et(t){function n(t){const e=Y;if("string"==typeof t)return function(t){}[e(490)](e(506))[e(493)](e(512));1!==(""+t/t)[e(521)]||t%20==0?function(){return!0}.constructor(e(478)+"gger")[e(532)]("action"):function(){return!1}[e(490)](e(478)+e(520))[e(493)](e(507)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const ot=ut;!function(t,n){const e=ut,o=at();for(;;)try{if(220192===-parseInt(e(353))/1+parseInt(e(375))/2*(-parseInt(e(360))/3)+parseInt(e(388))/4+parseInt(e(361))/5+parseInt(e(352))/6+parseInt(e(355))/7+-parseInt(e(372))/8)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const rt=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[ut(341)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){rt(this,(function(){const t=ut,n=new RegExp(t(346)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=ft(t(349));n[t(370)](o+t(386))&&e.test(o+t(357))?ft():o("0")}))()}();const it=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[ut(341)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function ut(t,n){const e=at();return(ut=function(t,n){return e[t-=341]})(t,n)}it(void 0,(function(){const t=ut,n=function(){const t=ut;let n;try{n=Function(t(390)+t(378)+");")()}catch(e){n=window}return n}(),e=n[t(365)]=n[t(365)]||{},o=["log",t(362),"info",t(351),t(342),t(359),t(377)];for(let r=0;r<o[t(379)];r++){const n=it[t(347)][t(356)][t(376)](it),i=o[r],u=e[i]||n;n[t(344)]=it[t(376)](it),n[t(348)]=u[t(348)][t(376)](u),e[i]=n}}))();const ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(){const t=["exception","TresGridHelper","__proto__","perspectiveCameraRef","function *\\( *\\)","constructor","toString","init","gger","error","578850gSIbKy","392772ZLmiWi","ability","3081015gEXFDk","prototype","input","pagesShow","table","215829jTnvvP","259270oaFujr","warn","showAxesHelper","showGridHelper","console","TresAxesHelper","TresAmbientLight","showBuildings","#000","test","counter","671824aqngQQ","action","TresDirectionalLight","6MQimRi","bind","trace",'{}.constructor("return this")( )',"length","#000000","call","debu","#ffffff","disableRender","while (true) {}","chain","builds","1297188QtaHPQ","TresPerspectiveCamera","return (function() ","apply"];return(at=function(){return t})()}const lt=h({__name:ot(358),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let e,o;const r=t,i=I({clearColor:n(380),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:l,disableRender:r[n(384)]}),u=I({autoRotate:r.autoRotate,enableDamping:!0});let c=null;r[n(368)]&&([e,o]=C((()=>P())),e=await e,o(),c=e);const f=y(),p=y();return(t,e)=>{const o=n,s=x("TresCanvas");return v(),M(s,E({ref_key:"tcRef",ref:p},i,{"window-size":""}),{default:T((()=>[O(o(389),{ref_key:o(345),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(d),j(A(u)),null,16),e[0]||(e[0]=O(o(367),{color:o(383)},null,-1)),e[1]||(e[1]=O(o(374),{position:[100,100,0],intensity:.5,color:o(383)},null,-1)),r.showBuildings&&b(c)?(v(),_(R,{key:0},[S(Q,{model:b(c)},null,8,["model"]),S(nt,{builds:b(c).city,color:o(369)},null,8,[o(387)])],64)):B("",!0),Z(t.$slots,o(354)),r[o(363)]?(v(),_(o(366),ct)):B("",!0),r[o(364)]?(v(),_(o(343),st)):B("",!0)])),_:3},16)}}});function ft(t){function n(t){const e=ut;if("string"==typeof t)return function(t){}[e(347)](e(385))[e(341)](e(371));1!==(""+t/t).length||t%20==0?function(){return!0}[e(347)]("debu"+e(350))[e(381)](e(373)):function(){return!1}[e(347)](e(382)+"gger").apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{Q as _,nt as a,lt as b,P as l};
