import{P as t}from"./tweakpane.yHWGBmom1734239885681.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.8bnMX6f01734239885681.js";import{e}from"./@tresjs.qWeugQU61734239885681.js";import{z as r}from"./three-custom-shader-material._Q1qyIV-1734239885681.js";import{_ as i,C as u,cn as c,m as a,a$ as s}from"./three.NPKhDGTA1734239885681.js";import{d as l,a3 as f,w as p,o as d,D as m,u as v,a6 as g,r as h,f as y,g as w,j as C,m as _}from"./@vue.-THQH3GC1734239885681.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1734239885681.js";import"./@vueuse.GyFlY0FM1734239885681.js";function b(){const t=["__csm","info","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uTime","setStyle","#ffffff","apply","length","prototype","console","value","object","MeshBasicMaterial","computeBoundingBox","uniforms","clone","test","log","forEach","24912UGTOPW","computeBoundingSphere","555486uRvJtu","land","side","4350ZVCZgh","warn","material","4iXbJXx","init","1665246PROwse","error","gradient","string","DoubleSide","function *\\( *\\)","return (function() ","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","Color","uOpacity","#112233","8875176lQLWyJ","84lCaUya","3699fDMdjM","dispose","#ffff00","gger","children","input","stateObject","exception","landColor","uColor","model","debu","10802SAZIhG","constructor","5618855STFeyf","bind","uGradient","46kWImhc","color","13646PhjkZm","city","bulidingsColor","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","while (true) {}"];return(b=function(){return t})()}const x=I;function I(t,n){const o=b();return(I=function(t,n){return o[t-=337]})(t,n)}!function(t,n){const o=I,e=b();for(;;)try{if(710543===-parseInt(o(357))/1*(parseInt(o(359))/2)+-parseInt(o(393))/3+-parseInt(o(391))/4*(parseInt(o(354))/5)+-parseInt(o(385))/6*(-parseInt(o(339))/7)+-parseInt(o(383))/8*(-parseInt(o(340))/9)+-parseInt(o(388))/10*(parseInt(o(352))/11)+parseInt(o(338))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){M(this,(function(){const t=I,n=new RegExp(t(398)),o=new RegExp(t(366),"i"),e=T(t(392));n[t(380)](e+"chain")&&o[t(380)](e+t(345))?T():e("0")}))()}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(370)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();S(void 0,(function(){const t=I,n=function(){const t=I;let n;try{n=Function(t(399)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(373)]=n[t(373)]||{},e=[t(381),t(389),t(365),t(394),t(347),"table","trace"];for(let r=0;r<e.length;r++){const n=S.constructor[t(372)][t(355)](S),i=e[r],u=o[i]||n;n.__proto__=S[t(355)](S),n.toString=u.toString.bind(u),o[i]=n}}))();const P=[x(375)],j=l({__name:"bModel",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:x(337)},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,c=o[n(350)][n(360)];o[n(350)].model[n(344)][0][n(390)]=new(i[n(376)])({color:n(342)}),c.renderOrder=1001;const a=o.model[n(386)];(()=>{const t=n,{geometry:e}=c;e[t(377)](),e[t(384)]();const{max:a,min:s}=e.boundingBox;if(c[t(390)][t(364)])return;const l=new r({baseMaterial:c[t(390)],vertexShader:t(400),fragmentShader:t(362),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(401)])(o.bulidingsColor)},uOpacity:{value:o.opacity},uLightColor:{value:new u(t(369))},uTopColor:{value:new u(o.topColor)},uTime:{value:0},uGradient:{value:o[t(395)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(397)]});c[t(390)][t(341)](),c[t(390)]=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(390)][o(378)][o(367)][o(374)]+=t})),f((()=>{const t=n;o.bulidingsColor&&c[t(390)][t(378)][t(349)][t(374)][t(368)](o[t(361)]),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(386)&&(u=Array.isArray(a.material)?a[r(390)]:[a[r(390)]],u[r(382)]((t=>{const n=r;t[e][n(368)](o[n(348)]),t[n(387)]=i[n(397)]})))})("land",t(358)),o.opacity&&(c.material[t(378)][t(402)][t(374)]=o.opacity)})),p(o,((t,o)=>{const e=n;c.material.uniforms[e(356)][e(374)]=t[e(395)]}));const l=o[n(350)][n(350)][n(379)]();return(t,n)=>(d(),m("primitive",{object:v(l)},null,8,P))}});function T(t){function n(t){const o=I;if(typeof t===o(396))return function(t){}[o(353)](o(363))[o(370)]("counter");1!==(""+t/t)[o(371)]||t%20==0?function(){return!0}.constructor(o(351)+o(343)).call("action"):function(){return!1}[o(353)](o(351)+o(343))[o(370)](o(346)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=A;!function(t,n){const o=A,e=G();for(;;)try{if(161275===parseInt(o(407))/1+parseInt(o(370))/2*(parseInt(o(399))/3)+parseInt(o(364))/4*(-parseInt(o(381))/5)+parseInt(o(395))/6*(parseInt(o(374))/7)+-parseInt(o(402))/8*(parseInt(o(408))/9)+-parseInt(o(388))/10+-parseInt(o(409))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(369)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=A,n=new RegExp(t(384)),o=new RegExp(t(380),"i"),e=W(t(375));n[t(391)](e+"chain")&&o.test(e+t(390))?W():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();F(void 0,(function(){const t=A;let n;try{n=Function(t(392)+t(373)+");")()}catch(r){n=window}const o=n[t(403)]=n.console||{},e=["log",t(385),"info",t(377),t(362),"table","trace"];for(let i=0;i<e[t(400)];i++){const n=F.constructor[t(414)][t(396)](F),r=e[i],u=o[r]||n;n[t(379)]=F[t(396)](F),n.toString=u[t(367)][t(396)](u),o[r]=n}}))();const R=[O(405)];function A(t,n){const o=G();return(A=function(t,n){return o[t-=361]})(t,n)}function G(){const t=["uniforms","gradual","1087300QuzwjU","color","input","test","return (function() ","srcColor","counter","210QWCAKS","bind","value","bLine","565797UhlGqp","length","scale","97288rUgOKX","console","#FFF","object","uScale","181437vLsdtP","36QeOJbR","449097lmPPit","constructor","debu","applyMatrix4","renderOrder","prototype","material","builds","#000","exception","speed","20RPMDZJ","linewidth","geometry","toString","gger","apply","2QJJvMr","matrix","uTime",'{}.constructor("return this")( )',"40817MyWwer","init","call","error","action","__proto__","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","214645BBxMSh","uGradual","stateObject","function *\\( *\\)","warn"];return(G=function(){return t})()}const z=l({__name:O(398),props:{builds:{},color:{default:O(404)},srcColor:{default:O(361)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(389)])},uSrcColor:{value:new u(o[n(393)])},uScale:{value:o.scale},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(416)][n(366)]).clone();l=l[n(412)](o[n(416)][n(371)]);const p=new a(i);r=new s(l,p),r[n(415)][n(365)]=o.width,r[n(413)]=1e3,f((()=>{const t=n;o[t(389)]&&(i.uniforms.uColor.value=new u(o[t(389)])),o[t(393)]&&(i[t(386)].uSrcColor.value=new u(o[t(393)])),o.scale&&(i[t(386)][t(406)][t(397)]=o[t(401)]),o[t(387)]&&(i.uniforms[t(382)][t(397)]=o[t(387)])}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(386)].uTime.value+=t*o[e(363)],i[e(386)][e(372)][e(397)]%=1})),(t,n)=>(d(),m("primitive",{object:v(r)},null,8,R))}});function W(t){function n(t){const o=A;if("string"==typeof t)return function(t){}.constructor("while (true) {}")[o(369)](o(394));1!==(""+t/t).length||t%20==0?function(){return!0}[o(410)](o(411)+o(368))[o(376)](o(378)):function(){return!1}[o(410)]("debu"+o(368))[o(369)](o(383)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Z=J;!function(t,n){const o=J,e=L();for(;;)try{if(682388===-parseInt(o(328))/1+parseInt(o(312))/2*(parseInt(o(321))/3)+parseInt(o(335))/4*(parseInt(o(307))/5)+-parseInt(o(322))/6*(parseInt(o(314))/7)+-parseInt(o(306))/8+parseInt(o(329))/9*(parseInt(o(301))/10)+parseInt(o(303))/11*(parseInt(o(326))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(302)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function L(){const t=["color","882260zVRcnL","9ItQPVe","init","length","string","action","#999","2502268cTwpMk","city","#112233","debu","stateObject","info","table","builds",'{}.constructor("return this")( )',"#FFF","#000","最大扩散","speed","#000000","test","log","input","model","9639530suetof","apply","18084561hgfqvW","buildingsEffectA","constructor","7660480oXbflM","5DJysvi","__proto__","chain","trace","while (true) {}","2NFPVGh","prototype","112BHCcRO","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bind","gger","gradual","call","线原颜色","1910247QttlzH","505542WvjjwP","扩散系数","console","addBinding","12nSXndl"];return(L=function(){return t})()}!function(){D(this,(function(){const t=J,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(315),"i"),e=Q(t(330));n[t(297)](e+t(309))&&o.test(e+t(299))?Q():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(302)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function J(t,n){const o=L();return(J=function(t,n){return o[t-=293]})(t,n)}E(void 0,(function(){const t=J,n=function(){const t=J;let n;try{n=Function("return (function() "+t(343)+");")()}catch(o){n=window}return n}(),o=n[t(324)]=n[t(324)]||{},e=[t(298),"warn",t(340),"error","exception",t(341),t(310)];for(let r=0;r<e[t(331)];r++){const n=E[t(305)][t(313)].bind(E),i=e[r],u=o[i]||n;n[t(308)]=E[t(316)](E),n.toString=u.toString[t(316)](u),o[i]=n}}))();const k=l({__name:Z(304),async setup(e){const r=Z;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:r(344),srcColor:r(293),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:"效果参数",expanded:!0});return s[r(325)](a,"srcColor",{label:r(320)}),s[r(325)](a,r(327),{label:"线扫颜色"}),s[r(325)](a,r(295),{label:"速度",min:.1,max:1,step:.1}),s.addBinding(a,"scale",{label:r(294),min:10,max:2e3,step:10}),s.addBinding(a,r(318),{label:r(323),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(j,{model:v(c),bulidingsColor:e(296),landColor:e(337),topColor:e(334)},null,8,[e(300)]),C(z,_({builds:v(c)[e(336)]},a),null,16,[e(342)])])),_:1})}}});function Q(t){function n(t){const o=J;if(typeof t===o(332))return function(t){}[o(305)](o(311))[o(302)]("counter");1!==(""+t/t)[o(331)]||t%20==0?function(){return!0}.constructor(o(338)+o(317))[o(319)](o(333)):function(){return!1}[o(305)]("debu"+o(317))[o(302)](o(339)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{k as default};
