import{importShared as a,Ai as _}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{Fs as v,_l as g}from"./index.DTe2qqjO1767148983502.js";import{applyTransform as h,alignmentCenter as k}from"./utils.Dy5vlvhc1767148983502.js";const{defineComponent:w}=await a("vue"),{unref:B,createElementVNode:E,openBlock:C,createElementBlock:x}=await a("vue"),y=["object"],{watch:s,ref:U}=await a("vue"),N=w({__name:"obliquePhoto",props:{tilesUrl:{default:"./plugins/geokit/tiles/tileset.json"},isRotation:{type:Boolean,default:!1},isRranslation:{type:Boolean,default:!0}},setup(m,{expose:c}){const o=m,l=U(null),{camera:r,renderer:p,sizes:f}=v(),u=(e,n,i)=>{e.setCamera(n),e.setResolutionFromRenderer(n,i)},d=()=>{let e=new _(o.tilesUrl);return e.fetchOptions.mode="cors",e.addEventListener("load-tile-set",()=>{k(e,o.isRotation,o.isRranslation)}),e.addEventListener("dispose-model",({scene:n})=>{n.traverse(i=>{i.material&&i.material.dispose()})}),u(e,r.value,p),e};let t=d();s(()=>[o.isRotation,o.isRranslation],()=>{t.group&&h(t.group,o.isRotation,o.isRranslation)}),s(r,()=>{r.value&&u(t,r.value,p)},{immediate:!0});const{onBeforeRender:R}=g();return R(()=>{r.value&&f.width.value&&t.update&&(r.value.updateMatrixWorld(),t.update())}),s(()=>o.tilesUrl,e=>{e!==t.rootURL&&(t.dispose(),t=d())}),c({group:l,tilesGroup:t.group}),(e,n)=>(C(),x("TresGroup",{ref_key:"groupRef",ref:l},[E("primitive",{object:B(t).group},null,8,y)],512))}});export{N as _sfc_main};
