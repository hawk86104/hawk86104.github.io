var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;import{_ as r,c as o,bU as s,ak as i,am as c}from"./three.YiCjTDWq1728554291399.js";import{p as a,U as u,Y as l,L as p}from"./@tresjs.IlQvaTJ91728554291399.js";import{g as f,i as d,e as m}from"./utils.62Bk-wf_1728554291399.js";import{_ as h}from"./jszip.ZN8xj_JH1728554291399.js";import{F as g}from"./file-saver.fOWTR40M1728554291399.js";import{P as v}from"./tweakpane.yHWGBmom1728554291399.js";import{d as y,q as w,r as b,Y as j,a3 as E,o as I,E as S,j as O,g as L,u as x,aj as P,ak as T,f as _,al as R,m as k,F as z,L as C}from"./@vue.JNsx1iN61728554291399.js";import{w as J}from"./@fesjs.GdZzFg1i1728554291399.js";import"./@vueuse.nb-8z3af1728554291399.js";import"./@amap.pS6gfiLZ1728554291399.js";import"./vue-router.NPtXaYpe1728554291399.js";import"./lodash-es.kYt-_xTG1728554291399.js";import"./@qlin.yHhFDldE1728554291399.js";import"./pinia.puw_7oLs1728554291399.js";import"./@floating-ui.BPbuo5Gx1728554291399.js";import"./@juggle.7yjBMqoW1728554291399.js";const N=Z;!function(t,n){const e=Z,r=W();for(;;)try{if(757755===parseInt(e(357))/1+-parseInt(e(321))/2*(-parseInt(e(339))/3)+parseInt(e(367))/4+-parseInt(e(366))/5+-parseInt(e(354))/6*(parseInt(e(361))/7)+-parseInt(e(341))/8*(-parseInt(e(337))/9)+-parseInt(e(316))/10)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const G=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[Z(327)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){G(this,(function(){const t=Z,n=new RegExp(t(329)),e=new RegExp(t(324),"i"),r=q(t(325));n[t(336)](r+"chain")&&e[t(336)](r+t(312))?q():r("0")}))()}();const M=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[Z(327)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function A(t,n){for(let e=0,r=t.length;e<r;e++)t[e](n)}M(void 0,(function(){const t=Z,n=function(){const t=Z;let n;try{n=Function("return (function() "+t(313)+");")()}catch(e){n=window}return n}(),e=n[t(332)]=n.console||{},r=[t(363),t(359),t(315),t(352),t(319),t(365),t(320)];for(let o=0;o<r[t(345)];o++){const n=M[t(342)][t(318)][t(317)](M),s=r[o],i=e[s]||n;n[t(335)]=M[t(317)](M),n[t(356)]=i[t(356)][t(317)](i),e[s]=n}}))(),window[N(355)]=r;const F={init:[],start:[],stop:[],keydown:[],keyup:[],pointerdown:[],pointerup:[],pointermove:[],update:[]},H=()=>{};function B(t){A(F[N(334)],t)}function D(t){A(F[N(311)],t)}function K(t){A(F.pointerdown,t)}function U(t){A(F.pointerup,t)}function Z(t,n){const e=W();return(Z=function(t,n){return e[t-=309]})(t,n)}function W(){const t=["length","call","push","getObjectByProperty","pointerup","stringify","debu","error","player,renderer,scene,camera","48ethSDr","THREE","toString","1362141juBMkY","counter","warn","addEventListener","1000139xmpZjc","uuid","log","height","table","5126985pQGmij","1431536oHNqSr","stop","pointermove","keyup","input",'{}.constructor("return this")( )',"value","info","6147480slqUKp","bind","prototype","exception","trace","13104NtfSKd","scripts","replace","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","init","pointerdown","apply","\nreturn ","function *\\( *\\)","while (true) {}","removeEventListener","console","width","keydown","__proto__","test","8722179TBPdYA","object","390MhKihF","APP.Player: Script without object.","8gHgOmU","constructor","start","stateObject"];return(W=function(){return t})()}function $(t){A(F[N(310)],t)}function q(t){function n(t){const e=Z;if("string"==typeof t)return function(t){}.constructor(e(330))[e(327)](e(358));1!==(""+t/t)[e(345)]||t%20==0?function(){return!0}[e(342)](e(351)+"gger")[e(346)]("action"):function(){return!1}[e(342)](e(351)+"gger")[e(327)](e(344)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=X,r=V();for(;;)try{if(271967===parseInt(e(199))/1*(-parseInt(e(211))/2)+-parseInt(e(182))/3*(-parseInt(e(215))/4)+parseInt(e(198))/5+parseInt(e(195))/6*(-parseInt(e(194))/7)+-parseInt(e(202))/8+-parseInt(e(207))/9*(parseInt(e(205))/10)+parseInt(e(197))/11)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const Y=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[X(186)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){Y(this,(function(){const t=X,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(185),"i"),r=tt(t(213));n[t(210)](r+t(203))&&e[t(210)](r+t(181))?tt():r("0")}))()}();const Q=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[X(186)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function V(){const t=["call","test","205346doTisa","const scriptsJson = \n","init","\n\t\tthis.events = {\n\t\t\t\tinit: [],\n\t\t\t\tstart: [],\n\t\t\t\tstop: [],\n\t\t\t\tkeydown: [],\n\t\t\t\tkeyup: [],\n\t\t\t\tpointerdown: [],\n\t\t\t\tpointerup: [],\n\t\t\t\tpointermove: [],\n\t\t\t\tupdate: [],\n\t\t}\n\t\tlet scriptWrapParams = 'player,renderer,scene,camera'\n\t\tconst scriptWrapResultObj = {}\n\n\t\tfor (const eventKey in this.events) {\n\t\t\t\tscriptWrapParams += `,${eventKey}`\n\t\t\t\tscriptWrapResultObj[eventKey] = eventKey\n\t\t}\n\t\tconst scriptWrapResult = JSON.stringify(scriptWrapResultObj).replace(/\\\"/g, '')\n\t\tfor (const uuid in scriptsJson) {\n\t\t\t\tlet curUuid = uuid\n\t\t\t\t//这里解决一个问题 目前并没有把 主场景scene直接替换而是通过group 加进入的，所以 如果事件是基于主场景scene 那么替换这个uuid为现在tres主场景的uuid\n\t\t\t\tif (uuid === sceneObject.uuid) {\n\t\t\t\t\t\tcurUuid = this.scene.uuid\n\t\t\t\t}\n\t\t\t\tconst object = this.scene.getObjectByProperty('uuid', curUuid, true)\n\t\t\t\tif (object === undefined) {\n\t\t\t\t\t\tconsole.warn('player: Script without object.', curUuid)\n\t\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst scripts = scriptsJson[uuid]\n\t\t\t\tfor (let i = 0; i < scripts.length; i++) {\n\t\t\t\t\t\tconst script = scripts[i]\n\t\t\t\t\t\t// eslint-disable-next-line no-new-func\n\t\t\t\t\t\tconst functions = new Function(scriptWrapParams, `${script.source}\nreturn ${scriptWrapResult};`).bind(object)(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tthis.renderer,\n\t\t\t\t\t\t\t\tthis.scene,\n\t\t\t\t\t\t\t\tthis.camera,\n\t\t\t\t\t\t)\n\t\t\t\t\t\tfor (const name in functions) {\n\t\t\t\t\t\t\t\tif (functions[name] === undefined) continue\n\t\t\t\t\t\t\t\tif (this.events[name] === undefined) {\n\t\t\t\t\t\t\t\t\t\tconsole.warn('player: Event type not supported (', name, ')')\n\t\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.events[name].push(functions[name].bind(object))\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.dispatch(this.events.init, arguments)\n\t\t}\n\t},\n\tdispatch(array, event) {\n\t\tfor (let i = 0, l = array.length; i < l; i++) {\n\t\t\t\tarray[i](event)\n\t\t}\n\t},\n\tsetCamera(value) {\n\t\t\tconsole.warn('暂时不考虑摄像机的设置函数', value)\n\t\t\t// camera = value\n\t\t\t// camera.aspect = this.width / this.height\n\t\t\t// camera.updateProjectionMatrix()\n\t},\n\tsetScene(value) {\n\t\t\tconsole.warn('暂时不考虑场景的设置函数', value)\n\t\t\t// scene = value\n\t},\n\tsetPixelRatio(value) {\n\t\t\tconsole.warn('暂时不考虑像素比的设置函数', value)\n\t},\n\tsetSize(value) {\n\t\t\tconsole.warn('暂时不考虑尺寸的设置函数', value)\n\t},\n\tdispose() {\n\t\t\t// renderer.dispose();\n\t\t\t// camera = undefined;\n\t\t\t// scene = undefined;\n\t\t\tconsole.warn('暂时不考虑释放资源的函数')\n\t},\n\tonKeyDown(event) {\n\t\tplayer.dispatch(player.events.keydown, event)\n\t},\n\tonKeyUp(event) {\n\t\t\tplayer.dispatch(player.events.keyup, event)\n\t},\n\tonPointerDown(event) {\n\t\t\tplayer.dispatch(player.events.pointerdown, event)\n\t},\n\tonPointerUp(event) {\n\t\t\tplayer.dispatch(player.events.pointerup, event)\n\t},\n\tonPointerMove(event) {\n\t\t\tplayer.dispatch(player.events.pointermove, event)\n\t},\n\tplay() {\n\t\t\tdocument.addEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.addEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.addEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.addEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.addEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.start, null)\n\t\t\t//renderer.setAnimationLoop( animate ); 播放是自动的\n\t},\n\tstop() {\n\t\t\tdocument.removeEventListener('keydown', this.onKeyDown)\n\t\t\tdocument.removeEventListener('keyup', this.onKeyUp)\n\t\t\tdocument.removeEventListener('pointerdown', this.onPointerDown)\n\t\t\tdocument.removeEventListener('pointerup', this.onPointerUp)\n\t\t\tdocument.removeEventListener('pointermove', this.onPointerMove)\n\t\t\tthis.dispatch(this.events.stop, arguments)\n\t\t\t// renderer.setAnimationLoop( null );播放是自动的\n\t},\n\trender(elapsed, delta) {\n\t\t\tthis.dispatch(this.events.update, { time: elapsed, delta })\n\t},\n}\nexport default player\n","2832MvwSBy","table","constructor","return (function() ","prototype","console","warn","toString","gger","input","2271wADIGE","counter","bind","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","apply","string","/* eslint-disable prefer-rest-params */\n/* eslint-disable no-undefined */\n/* eslint-disable guard-for-in */\nimport * as THREE from 'three'\n\nwindow.THREE = THREE // Used by APP Scripts.\nconst Grscwh = { scene: null, renderer: null, camera: null, sizes: null }\nconst player = {\n\tget renderer() {\n\t\treturn Grscwh.renderer?.value\n\t},\n\tloader: new THREE.TextureLoader(),\n\tget scene() {\n\t\t\treturn Grscwh.scene?.value\n\t},\n\tget camera() {\n\t\t\treturn Grscwh.camera?.value\n\t},\n\tget width() {\n\t\t\treturn Grscwh.sizes?.width?.value\n\t},\n\tget height() {\n\t\t\treturn Grscwh.sizes?.height?.value\n\t},\n\tget dom() {\n\t\t\treturn Grscwh.renderer?.value.domElement.parentElement\n\t},\n\tget canvas() {\n\t\t\treturn Grscwh.renderer?.value.domElement\n\t},\n\tevents: {},\n\tinit(scene, renderer, camera, sizes) {\n\t\t\tGrscwh.scene = scene\n\t\t\tGrscwh.renderer = renderer\n\t\t\tGrscwh.camera = camera\n\t\t\tGrscwh.sizes = sizes\n\t},\n\tload(sceneObject) {\n\t\t","exception","error","length",'{}.constructor("return this")( )',"debu","3679123wODPDs","6XnAlpv","info","9789010TwKzzN","995750QTmMaN","4LyCuqm","__proto__","trace","1527712mpstGj","chain","stringify","188170llwEXw","while (true) {}","108lTSaBo","stateObject"];return(V=function(){return t})()}Q(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function(t(175)+t(192)+");")()}catch(e){n=window}return n}(),e=n[t(177)]=n[t(177)]||{},r=["log",t(178),t(196),t(190),t(189),t(216),t(201)];for(let o=0;o<r[t(191)];o++){const n=Q[t(174)][t(176)][t(184)](Q),s=r[o],i=e[s]||n;n[t(200)]=Q[t(184)](Q),n.toString=i[t(179)].bind(i),e[s]=n}}))();function X(t,n){const e=V();return(X=function(t,n){return e[t-=174]})(t,n)}function tt(t){function n(t){const e=X;if(typeof t===e(187))return function(t){}.constructor(e(206))[e(186)](e(183));1!==(""+t/t)[e(191)]||t%20==0?function(){return!0}.constructor(e(193)+e(180))[e(209)]("action"):function(){return!1}[e(174)](e(193)+e(180))[e(186)](e(208)),n(++t)}try{if(t)return n;n(0)}catch(e){}}!function(t,n){const e=rt,r=ot();for(;;)try{if(701311===-parseInt(e(506))/1*(-parseInt(e(546))/2)+parseInt(e(492))/3*(parseInt(e(565))/4)+-parseInt(e(518))/5*(-parseInt(e(584))/6)+parseInt(e(495))/7*(-parseInt(e(489))/8)+-parseInt(e(560))/9+-parseInt(e(564))/10+parseInt(e(474))/11)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const nt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){nt(this,(function(){const t=rt,n=new RegExp(t(480)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),r=lt(t(488));n.test(r+t(523))&&e[t(553)](r+t(479))?lt():r("0")}))()}();const et=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[rt(570)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function rt(t,n){const e=ot();return(rt=function(t,n){return e[t-=473]})(t,n)}function ot(){const t=["\nconst loader = new THREE.ObjectLoader()\nconst cameraObject = loader.parse(cameraConfig)\nconst cameraRef = ref(null)\nwatch(\n\t() => cameraRef.value,\n\t(val) => {\n\t\t\tval.copy(cameraObject)\n\t},\n)\n<\/script>\n\t","padStart","\n\t\t",'{}.constructor("return this")( )',"gridHelper","2479590ZdNLSf",",\n\tshadowMapType: ","components/scene.vue","toneMappingExposure","10521320rVgMXq","16cOVqyk",'",\n\t\t"updateTime": "',"info",'",\n\t\t"title": "编辑器导出的插件",\n\t\t"intro": "描述",\n\t\t"version": "0.0.1",\n\t\t"author": "作者名",\n\t\t"website": "站点地址",\n\t\t"state": "active",\n\t\t"creatTime": "',".json","apply","BufferGeometry","THREE.PCFShadowMap","constructor","<Suspense>\n\t\t\t<sceneCom />\n\t\t</Suspense>","firstLevel","toString","string","object","project","table","console"," from './childComponent/","toneMapping","1199580StQWNF","exception","false","debu",'\n<template>\n    <loading />\n\t<TresCanvas v-bind="state">\n\t\t','">\n    ',"shadows",'  ref="cameraRef" uuid="','/${url}`\n            }\n            if (url.endsWith(".json")) {\n                image.url = await loadJsonFile(url)\n            } else {\n                image.url = await loadImageToBase64(url)\n            }\n        }\n    }\n}\n\nconst sceneObject = loader.parse(scene) as any\nonMounted(() => {\n    tresScene.value.background = sceneObject.background\n    tresScene.value.environment = sceneObject.environment\n    tresScene.value.fog = sceneObject.fog\n    player.load(sceneObject)\n    player.play()\n})\nconst { onLoop } = useRenderLoop()\nonLoop(({ delta, elapsed }) => {\n    if (player.renderer) {\n        player.render(elapsed * 1000, delta * 1000)\n    }\n})\n<\/script>',"\n\nconst { scene: tresScene, renderer, camera, sizes } = useTresContext()\nplayer.init(tresScene, renderer, camera, sizes)\n\nconst loader = new THREE.ObjectLoader()\nconst scene = await loadJsonFile('./plugins/",'\n        <primitive :object="object[',"getMonth",'\n</template>\n\n<script setup lang="ts">\nconst props = withDefaults(\n    defineProps<{\n        object: any\n    }>(),\n    {},\n)\n<\/script>\n',".vue","13459710ffBlcc",'" />',"scripts","images","getFullYear","input","function *\\( *\\)","shadowType","<template>\n    ","url","name","children","url:images/",']" name="',"init","12808pBtCvP","\n\t</TresCanvas>\n</template>\n<script setup lang=\"ts\">\nimport * as THREE from 'three'\nimport { reactive, watch, ref } from 'vue'\nimport { TresCanvas } from '@tresjs/core'\nimport { OrbitControls } from '@tresjs/cientos'\nimport sceneCom from '../components/scene.vue'\nimport { loading2 as loading } from 'PLS/UIdemo'\n\nconst state = reactive({\n\tclearColor: '#201919',\n\twindowSize:true,\n\tantialias: true,\n\tshadows: ","type","296115rxCyvW","config.js","THREE.NoToneMapping","2653FbCHbz","parse","stringify","childLevel",' :object="sceneObject.children[',"geometries","__proto__","forEach","counter","length","warn","52189idAzZs","folder","file",'"/>\n    ',"camera",",\n})\n\nconst cameraConfig = ","error","orbitControls","then","import ","<TresGridHelper />",'" uuid="',"15ljvGNS","components/childComponent","push","generateAsync",'" name="',"chain","log","pop","scene","data",'",\n\t\t"require": [],\n        "tvtstore": \'LOCAL\',\n\t\t"preview": [\n\t\t\t{ "src": "plugins/basic/base/preview/theBasic.png", "type": "img", "name": "index", "title": "实例" ,"disableFPSGraph": false, "disableSrcBtn": false},\n\t\t]\n\t}','\n    <primitive :object="sceneObject.children[',"blob","<Tres","trace","split",'" type="',"pages/index.vue",",\n\ttoneMapping: ","secondLevel","pluginName","comName","bind","fileName","src/plugins/","uuid","public/plugins/","action","16yWOWYk",'].children" />',"stateObject","gger",",\n\ttoneMappingExposure:",'"/>\n        ','    \n    <primitive :object="sceneObject.children[',"test","prototype"];return(ot=function(){return t})()}et(void 0,(function(){const t=rt,n=function(){const t=rt;let n;try{n=Function("return (function() "+t(558)+");")()}catch(e){n=window}return n}(),e=n[t(581)]=n[t(581)]||{},r=[t(524),t(505),t(567),t(512),t(585),t(580),t(532)];for(let o=0;o<r[t(504)];o++){const n=et[t(573)][t(554)][t(540)](et),s=r[o],i=e[s]||n;n[t(501)]=et[t(540)](et),n[t(576)]=i[t(576)][t(540)](i),e[s]=n}}))();let st=[];const it=(r,o,s,i)=>{const c=rt,a=s[c(578)],{uuid:u}=a,l=((r,o)=>{var s={};for(var i in r)n.call(r,i)&&o.indexOf(i)<0&&(s[i]=r[i]);if(null!=r&&t)for(var i of t(r))o.indexOf(i)<0&&e.call(r,i)&&(s[i]=r[i]);return s})(a,["uuid"]),p=JSON[c(496)](JSON[c(497)](s));return p.object=l,c(588)+(i[c(513)]?"<OrbitControls />":"")+c(557)+(s?c(531)+s[c(578)][c(491)]+c(591)+s[c(578)][c(543)]+c(522)+s[c(578)][c(484)]+c(475):"")+c(557)+r+c(557)+(i[c(559)]?c(516):"")+c(490)+(o[c(590)]?"true":c(586))+c(561)+(o[c(481)]?o[c(481)]:c(572))+c(536)+(o[c(583)]?o[c(583)]:c(494))+c(550)+(o[c(563)]?o.toneMappingExposure:"1")+c(511)+(p?""+JSON.stringify(p):"{}")+c(555)},ct=(t,n,e,r,o)=>{const s=rt;n[s(498)];let i=s(529)+r+']" name="'+e.name+s(517)+e.uuid+'" type="'+e.type+s(589);if(e.children&&e[s(485)][s(504)]){const n=((t,n)=>{const e=rt,r=t-1,o=[e(575),e(537),"thirdLevel"],s=n.split("-")[e(525)]();return{fileName:o[r]+"-"+s+e(473),comName:""+o[r]+s}})(o,e[s(543)]);i+="<"+n[s(539)]+s(499)+r+s(547),((t,n,e)=>{const r=rt;let o="";e.forEach(((t,n)=>{const e=rt;o+=e(594)+n+e(487)+t[e(484)]+'" uuid="'+t[e(543)]+e(534)+t.type+e(551)}));const s=r(482)+o+r(596);t[r(508)](""+n[r(541)],s),st[r(520)](n)})(t,n,e.children)}return i+="\n    </primitive>\n",i},at=(t,n,e)=>{const r=rt;let o="";const s=t[r(507)](r(519));return e.object&&e[r(578)][r(485)]&&e.object[r(485)][r(504)]&&e[r(578)][r(485)][r(502)](((t,e)=>{const i=r;n.childLevel>0&&t[i(485)]&&t.children[i(504)]?o+=ct(s,n,t,e,1):o+=i(552)+e+']" name="'+t[i(484)]+i(517)+t[i(543)]+i(534)+t[i(491)]+i(509)})),t.file(r(562),"<template>\n        "+o+"</template>\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue'\nimport * as THREE from 'three'\nimport { loadImageToBase64, loadJsonFile } from 'PLS/tresEditor'\nimport { useTresContext, useRenderLoop } from '@tresjs/core'\nimport player from '../common/eventScript'\n"+(()=>{let t="";return st.forEach((n=>{const e=rt;t+=e(515)+n[e(539)]+e(582)+n[e(541)]+"'\n"})),t})()+r(593)+n[r(538)]+"/json/scene.json')\n\nif (scene.geometries) {\n    for (const geometry of scene.geometries) {\n        if (geometry.data && geometry.data.startsWith('url:')) {\n            let url = geometry.data.slice(4)\n            if (url.startsWith('geometries/')) {\n                url = `./plugins/"+n[r(538)]+"/${url}`\n            }\n            geometry.data = await loadJsonFile(url)\n        }\n    }\n}\nif (scene.images) {\n    for (const image of scene.images) {\n        if (image.url && image.url.startsWith('url:')) {\n            let url = image.url.slice(4)\n            if (url.startsWith('images/')) {\n                url = `./plugins/"+n.pluginName+r(592)),r(574)};function ut(t,n){const e=rt;st=[];const r=n[e(538)],o=new h;((t,n)=>{const e=rt,r=[];n.geometries&&n[e(500)][e(502)]((t=>{const n=e;t[n(491)]===n(571)&&(r[n(520)]({uuid:t.uuid,data:t[n(527)]}),t[n(527)]="url:geometries/"+t[n(543)]+".json")}));const o=[];if(n[e(477)]&&n[e(477)][e(502)]((t=>{const n=e;t[n(483)]&&(o.push({uuid:t[n(543)],url:t[n(483)]}),t.url.type?t[n(483)]=n(486)+t[n(543)]+"."+t.url[n(491)]+n(569):t[n(483)]=n(486)+t[n(543)]+"."+f(t[n(483)]))})),r[e(504)]){const n=t.folder(e(500));r.forEach((t=>{const r=e;n[r(508)](t[r(543)]+r(569),JSON[r(497)](t[r(527)]))}))}if(o[e(504)]){const n=t[e(507)](e(477));o.forEach((t=>{const r=e;t[r(483)][r(491)]?n[r(508)](t[r(543)]+"."+t.url[r(491)]+".json",JSON[r(497)](t[r(483)])):n[r(508)](t[r(543)]+"."+f(t[r(483)]),t[r(483)][r(533)](";base64,")[r(525)](),{base64:!0})}))}t[e(508)]("json/scene.json",JSON.stringify(n))})(o[e(507)](e(544)+r),t[e(526)]);const s=o.folder(e(542)+r);s[e(508)](e(493),(t=>{const n=rt,e=new Date,r=e[n(478)]()+"-"+String(e[n(595)]()+1).padStart(2,"0")+"-"+String(e.getDate())[n(556)](2,"0");return'\n\texport default {\n\t\t"name": "'+t+n(568)+r+n(566)+r+n(528)})(r));const i=it(at(s,n,t[e(526)]),t[e(579)],t[e(510)],n);return s[e(508)](e(535),i),s.file("common/eventScript.js",(t=>{const n=X,e=n(212)+JSON[n(204)](t)+"\n";return n(188)+e+n(214)})(t[e(476)])),o[e(521)]({type:e(530)})[e(514)]((t=>{g.saveAs(t,r+".zip")}))}function lt(t){function n(t){const e=rt;if(typeof t===e(577))return function(t){}.constructor("while (true) {}")[e(570)](e(503));1!==(""+t/t)[e(504)]||t%20==0?function(){return!0}[e(573)]("debu"+e(549)).call(e(545)):function(){return!1}[e(573)](e(587)+"gger")[e(570)](e(548)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const pt=mt;!function(t,n){const e=mt,r=vt();for(;;)try{if(963367===-parseInt(e(263))/1*(-parseInt(e(269))/2)+parseInt(e(283))/3*(-parseInt(e(262))/4)+-parseInt(e(295))/5+-parseInt(e(292))/6+-parseInt(e(239))/7+parseInt(e(299))/8*(parseInt(e(271))/9)+parseInt(e(261))/10*(parseInt(e(251))/11))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const ft=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[mt(265)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){ft(this,(function(){const t=mt,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(249),"i"),r=gt(t(227));n[t(275)](r+t(257))&&e[t(275)](r+t(290))?gt():r("0")}))()}();const dt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[mt(265)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function mt(t,n){const e=vt();return(mt=function(t,n){return e[t-=224]})(t,n)}dt(void 0,(function(){const t=mt;let n;try{n=Function(t(243)+t(294)+");")()}catch(o){n=window}const e=n[t(281)]=n[t(281)]||{},r=["log",t(247),t(250),t(272),t(224),t(232),t(229)];for(let s=0;s<r[t(301)];s++){const n=dt[t(260)][t(296)][t(238)](dt),o=r[s],i=e[o]||n;n[t(298)]=dt[t(238)](dt),n[t(226)]=i[t(226)][t(238)](i),e[o]=n}}))();const ht=y({__name:pt(300),setup(t){const n=pt;let e,s=null;var i=new(r[n(246)]);let c=null;const{scene:l,renderer:p,camera:f,sizes:h}=a(),g=()=>{if(!c)return;const t=n=>{const e=mt;let r=n[e(267)][e(286)]((t=>!!t));r[e(277)]((n=>{const r=e;n[r(267)][r(301)]?t(n):((t=>{var n,e;const r=mt;null==(n=t[r(278)])||n.dispose(),null==(e=t.material)||e[r(287)]()})(n),n.clear())})),n[e(266)](),r=null};t(c),c=null},y=t=>{const e=n;g(),(()=>{const t=N;document.removeEventListener(t(334),B),document.removeEventListener(t(311),D),document[t(331)]("pointerdown",K),document[t(331)](t(349),U),document[t(331)](t(310),$),A(F[t(309)],null),F[t(325)]=[],F.start=[],F[t(309)]=[],F[t(334)]=[],F[t(311)]=[],F[t(326)]=[],F[t(349)]=[],F[t(310)]=[],F.update=[]})(),c=new o,t[e(267)]&&(c[e(267)]=t.children,l[e(274)][e(230)](c),l[e(274)][e(264)]=t[e(264)],l[e(274)][e(268)]=t[e(268)],l[e(274)].fog=t[e(302)])},b=new v;b[n(228)]({title:n(259),label:n(266)}).on(n(242),(()=>{const t=n;confirm("确定要执行操作吗？")&&window[t(237)][t(285)]()}));b[n(228)]({title:n(234),label:n(288)}).on(n(242),(()=>{var t,r;const o=n;s?null==(r=(t=J)[o(240)])||r.call(t,{content:"先清空场景",colorful:!0}):e&&(e.accept=o(252),e.value=null,e[o(242)]())}));const j=b[n(256)]({title:"分解场景[中间件 测试用]",expanded:!1});j[n(228)]({title:n(282),label:"Json2Zip"}).on(n(242),(()=>{var t,e;const r=n;s?m(s):null==(e=(t=J)[r(240)])||e.call(t,{content:r(293),colorful:!0})}));j[n(228)]({title:"导入分解场景Zip",label:n(233)}).on(n(242),(()=>{var t,r;const o=n;s?null==(r=(t=J)[o(240)])||r.call(t,{content:"先清空场景",colorful:!0}):e&&(e[o(225)]=".zip",e[o(274)]=null,e.click())}));const E={orbitControls:!0,gridHelper:!0,pluginName:"testEditor",childLevel:1},I=b[n(256)]({title:n(253)});I[n(236)](E,n(255),{label:"插件名称"}),I[n(236)](E,n(254),{label:n(235)}),I[n(236)](E,"gridHelper",{label:n(244)});I[n(228)]({title:n(279),label:n(245)}).on(n(242),(()=>{var t,e,r,o;const i=n;s?E[i(255)]?ut(s,E):null==(e=(t=J)[i(240)])||e.call(t,{content:i(291),colorful:!0}):null==(o=(r=J)[i(240)])||o.call(r,{content:i(293),colorful:!0})}));const S=t=>{const e=n;s=t,y(i[e(297)](s[e(273)])),((t,n,e,r,o)=>{const s=N,i=o[s(322)]||{};let c=s(353);const a={};for(const l in F)c+=","+l,a[l]=l;const u=JSON[s(350)](a)[s(323)](/\"/g,"");for(const l in i){let a=l;l===o.scene[s(338)].uuid&&(a=n[s(362)]);const p=n[s(348)]("uuid",a,!0);if(void 0===p){console.warn(s(340),a);continue}const f=i[l];for(let o=0;o<f[s(345)];o++){const i=f[o],a=new Function(c,i.source+s(328)+u+";")[s(317)](p)({width:r[s(333)].value,height:r[s(364)][s(314)],setCamera:H},t,n,e);for(const t in a)void 0!==a[t]&&(void 0!==F[t]?F[t][s(347)](a[t][s(317)](p)):console[s(359)]("APP.Player: Event type not supported (",t,")"))}}A(F[s(325)],null)})(p.value,l[e(274)],f[e(274)],h,s),(()=>{const t=N;document[t(360)](t(334),B),document[t(360)]("keyup",D),document[t(360)](t(326),K),document.addEventListener(t(349),U),document[t(360)](t(310),$),A(F[t(343)],null)})()};w((()=>{const t=n;e=document.getElementById("fileInput"),e&&(e[t(289)]=n=>{const r=t,o=n.target.files[0];if(e.accept===r(252)){const t=new FileReader;t[r(258)]=t=>{const n=r,e=t[n(270)].result;S(JSON[n(297)](e))},t.readAsText(o)}".zip"===e[r(225)]&&d(o,S)})}));const{onLoop:O}=u();return O((({delta:t,elapsed:n})=>{var e,r;e=1e3*n,r=1e3*t,A(F.update,{time:e,delta:r})})),(t,n)=>null}});function gt(t){function n(t){const e=mt;if(typeof t===e(241))return function(t){}[e(260)](e(280)).apply("counter");1!==(""+t/t)[e(301)]||t%20==0?function(){return!0}[e(260)](e(248)+e(276)).call(e(231)):function(){return!1}[e(260)](e(248)+e(276)).apply(e(284)),n(++t)}try{if(t)return n;n(0)}catch(e){}}function vt(){const t=["input","请正确填写插件名称","11348502SyhmLl","场景内无物体",'{}.constructor("return this")( )',"336135cFQEdq","prototype","parse","__proto__","86288rMEsud","importJson","length","fog","exception","accept","toString","init","addButton","trace","add","action","table","Zip2Json","导入原生场景Json","默认控制器","addBinding","location","bind","5369035SGDhJm","warning","string","click","return (function() ","默认网格","MakePlugin","ObjectLoader","warn","debu","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","info","110jkIcDw",".json","TvT插件包","orbitControls","pluginName","addFolder","chain","onload","清空场景","constructor","5231400OBrqim","4uUiyVU","12723RyYsIT","background","apply","clear","children","environment","6pmxGdm","target","288HeKJfo","error","scene","value","test","gger","forEach","geometry","生成插件包","while (true) {}","console","生成分解场景Zip","5777115tBlPkl","stateObject","reload","filter","dispose","srcJson","onchange"];return(vt=function(){return t})()}const yt=wt;function wt(t,n){const e=Et();return(wt=function(t,n){return e[t-=333]})(t,n)}!function(t,n){const e=wt,r=Et();for(;;)try{if(628422===-parseInt(e(338))/1*(-parseInt(e(343))/2)+-parseInt(e(334))/3+-parseInt(e(363))/4+parseInt(e(337))/5*(parseInt(e(356))/6)+parseInt(e(368))/7+parseInt(e(342))/8+-parseInt(e(369))/9*(parseInt(e(357))/10))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const bt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,r}}();!function(){bt(this,(function(){const t=wt,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(370),"i"),r=xt(t(333));n[t(361)](r+t(340))&&e[t(361)](r+t(372))?xt():r("0")}))()}();const jt=function(){let t=!0;return function(n,e){const r=t?function(){if(e){const t=e[wt(346)](n,arguments);return e=null,t}}:function(){};return t=!1,r}}();function Et(){const t=["bind","error","1451532cmSGiI","3011020Dtsirp","TresPerspectiveCamera","call","TresGridHelper","test","toString","58988zlGiHS","info","file","warn","exception","6893740DKtNjt","36iiVRrJ","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","value","input","simpleImport","__proto__","init","482499XMIdxJ","string","gger","10QwDmBt","1cKyKla","action","chain","fileInput","2843184wJakbx","368696ymuYGR","length","stateObject","apply","constructor",".zip","console","log","trace","table","debu"];return(Et=function(){return t})()}jt(void 0,(function(){const t=wt;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(o){n=window}const e=n[t(349)]=n[t(349)]||{},r=[t(350),t(366),t(364),t(355),t(367),t(352),t(351)];for(let s=0;s<r[t(344)];s++){const n=jt[t(347)].prototype[t(354)](jt),o=r[s],i=e[o]||n;n[t(374)]=jt[t(354)](jt),n[t(362)]=i[t(362)][t(354)](i),e[o]=n}}))();const It=C(yt(358),{position:[15,15,15],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1),St=C(yt(360),null,null,-1),Ot=C(yt(372),{id:yt(341),type:yt(365),accept:yt(348),style:{display:"none"}},null,-1),Lt=y({__name:yt(373),setup(t){const n=b({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:s,outputColorSpace:i,toneMapping:c}),e=b({enableDamping:!0,dampingFactor:.05}),r=j(null);return E((()=>{r[wt(371)]})),(t,r)=>(I(),S(z,null,[O(x(p),k(n,{"window-size":""}),{default:L((()=>[It,O(x(l),P(T(e)),null,16),(I(),_(R,null,{default:L((()=>[O(ht)])),_:1})),St])),_:1},16),Ot],64))}});function xt(t){function n(t){const e=wt;if(typeof t===e(335))return function(t){}.constructor("while (true) {}").apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[e(347)](e(353)+e(336))[e(359)](e(339)):function(){return!1}[e(347)](e(353)+e(336))[e(346)](e(345)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{Lt as default};
