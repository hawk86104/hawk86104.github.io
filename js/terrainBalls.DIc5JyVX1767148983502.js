import{importShared as l}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{_l as N,ol as R,Kk as P}from"./index.DTe2qqjO1767148983502.js";import{createNoise2D as V}from"./simplex-noise.DV0DHqK31767148983502.js";import{World as x,Sphere as D,Body as S,Heightfield as L,Vec3 as $}from"./cannon-es.CjqBMEnX1767148983502.js";const{defineComponent:b}=await l("vue"),z=b({__name:"terrainBallsCannon",props:{sphereGroup:{default:null},plane:{default:null}},setup(y){const o=y,a=new x;a.gravity.set(0,-9.82,0);const t=[];o.sphereGroup.children.forEach(e=>{const i=e.geometry.parameters.radius,v=1,M=new D(i),f=new S({mass:v});f.addShape(M),f.position.copy(e.position),t.push(f),a.addBody(f)});let c=[];const r=o.plane.geometry.getAttribute("position"),p=o.plane.geometry.parameters.widthSegments+1,n=o.plane.geometry.parameters.heightSegments+1;for(let e=0;e<n;e++)c.push([]);for(let e=0;e<p;e++)for(let i=0;i<n;i++)c[i][e]=r.getZ((p-1-e)*n+i);const d=new L(c,{elementSize:o.plane.geometry.parameters.width/(p-1)}),s=new S({mass:0});s.addShape(d,new $(-o.plane.geometry.parameters.width/2,-o.plane.geometry.parameters.height/2,0)),s.quaternion.set(...o.plane.quaternion.toArray()),a.addBody(s);const{onRender:u}=N();return u(({delta:e})=>{a.fixedStep(1/120,e),t.forEach((i,v)=>{o.sphereGroup.children[v].position.copy(i.position)})}),(e,i)=>null}}),{defineComponent:A}=await l("vue"),{renderList:B,Fragment:_,openBlock:h,createElementBlock:g,createElementVNode:m,unref:F,createBlock:Z,createCommentVNode:q}=await l("vue"),H=["position"],j=["geometry","rotation-x"],I=["side"],{ref:k}=await l("vue"),T=await l("three"),K=A({__name:"terrainBallsThree",setup(y){const o=k(),a=k(),t=V(),c=(d,s)=>{var u=3.2*t(.1*d,.1*s),e=.2*t(.3*d,.3*s);return(u+e)*1.2},r=new T.PlaneGeometry(100,100,49,49),p=r.getAttribute("position");for(var n=0;n<p.count;n++)p.setZ(n,c(p.getX(n),p.getY(n)));return r.computeBoundingSphere(),r.computeVertexNormals(),console.log(r),(d,s)=>(h(),g(_,null,[m("TresGroup",{ref_key:"sphereGroupRef",ref:o},[(h(),g(_,null,B(10,u=>(h(),g(_,{key:u},[(h(),g(_,null,B(10,e=>m("TresMesh",{key:e,position:[u*10-55,26,e*10-55],"cast-shadow":""},[...s[0]||(s[0]=[m("TresSphereGeometry",{args:[.6,16,16]},null,-1),m("TresMeshStandardMaterial",{color:"#ffffff"},null,-1)])],8,H)),64))],64))),64))],512),m("TresMesh",{ref_key:"planeRef",ref:a,geometry:F(r),"rotation-x":-Math.PI/2,"receive-shadow":""},[m("TresMeshPhysicalMaterial",{roughness:1,metalness:0,color:"gray",side:T.DoubleSide},null,8,I)],8,j),a.value?(h(),Z(z,{key:0,sphereGroup:o.value,plane:a.value},null,8,["sphereGroup","plane"])):q("",!0)],64))}}),{defineComponent:W}=await l("vue"),{createElementVNode:w,unref:C,normalizeProps:X,guardReactiveProps:Y,createVNode:G,mergeProps:J,withCtx:O,openBlock:Q,createBlock:U}=await l("vue"),{SRGBColorSpace:ee,BasicShadowMap:te,NoToneMapping:oe}=await l("three"),{reactive:E,shallowRef:re,watchEffect:ae}=await l("vue"),pe=W({__name:"terrainBalls",setup(y){const o=E({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:te,outputColorSpace:ee,toneMapping:oe}),a=E({enableDamping:!0,dampingFactor:.05,enableZoom:!0,autoRotate:!1}),t=re();return ae(()=>{t.value&&(t.value.shadow.mapSize.set(1e3,1e3),t.value.shadow.camera.near=.5,t.value.shadow.camera.far=5e4,t.value.shadow.camera.top=20,t.value.shadow.camera.right=20,t.value.shadow.camera.left=-20,t.value.shadow.camera.bottom=-20)}),(c,r)=>(Q(),U(C(R),J(o,{"window-size":""}),{default:O(()=>[r[0]||(r[0]=w("TresPerspectiveCamera",{position:[110,70,20],fov:45,near:.1,far:1e3},null,-1)),G(C(P),X(Y(a)),null,16),r[1]||(r[1]=w("TresAmbientLight",{intensity:2},null,-1)),w("TresDirectionalLight",{ref_key:"TDirectionalLight",ref:t,position:[10,8,4],intensity:2,"cast-shadow":""},null,512),r[2]||(r[2]=w("TresDirectionalLight",{position:[10,2,4],intensity:2,"cast-shadow":""},null,-1)),G(K)]),_:1},16))}});export{pe as default};
