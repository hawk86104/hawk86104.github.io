import{n as e,l as a,d2 as o,d0 as s,d1 as n,f as t,d7 as r,dp as i,du as l}from"./three.rXKzP9fQ1763540743861.js";import{F as c,c as d,H as v,_ as u}from"./@tresjs.BCHtwiaC1763540743861.js";import{d as m,c as p,w as f,q as g,H as b,I as h,o as w,J as j,u as y}from"./@vue.Co_gxueH1763540743861.js";const M={key:0},P=["object"],x=["object"],U=["object"],_=m({__name:"mechaFloor",props:{color:{default:"#ffed00"}},setup(m){const{renderer:_,scene:D,camera:S,sizes:F}=c(),k=m;let H=null;const I={uniforms:{tDiffuse:{value:null},contrast:{value:1.8}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",fragmentShader:"\n        uniform sampler2D tDiffuse;\n        uniform float contrast;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb = (color.rgb - 0.5) * contrast + 0.8;\n            gl_FragColor = color;\n        }\n    "},{state:J}=d("https://opensource.cdn.icegl.cn/model/floor/baseModelJ.glb",{draco:!0,decoderPath:"./draco/"}),T=p(()=>J?.value?.scene),{state:q}=d("plugins/floor/models/topoBase/baseModelL.glb",{draco:!0,decoderPath:"./draco/"}),{state:z}=d("https://opensource.cdn.icegl.cn/model/floor/baseModelK.glb",{draco:!0,decoderPath:"./draco/"}),B=p(()=>z.value?.animations||[]),C=p(()=>z?.value?.scene),{actions:G}=v(B,C);f(G,e=>{e.Scene&&e.Scene.play()}),f(T,o=>{o&&o.traverse(o=>{o instanceof e&&(o.material.emissive=new a("#ffed00"),o.material.emissiveIntensity=20.5,o.material.toneMapped=!0,o.material.needsUpdate=!0)})});const{onRender:K}=u();return K(()=>{H&&H.render()}),g(()=>{(()=>{const a=new i(_),o=new l,s=a.fromScene(o).texture;D.value.environment=s,T.value&&T.value.traverse(a=>{a instanceof e&&a.material&&(a.material.envMap=s,a.material.needsUpdate=!0)}),o.dispose()})(),setTimeout(()=>{(()=>{if(!_||!S.value||!F.width.value)return;H=new o(_);const e=new s(D.value,S.value);H.addPass(e);const a=new n(new t(F.width.value,F.height.value),.1,.1,.1);H.addPass(a);const i=new r(I);i.uniforms.contrast.value=1.1,H.addPass(i)})()},200)}),f(()=>[k.color],([o])=>{T.value&&T.value.traverse(s=>{s instanceof e&&s.material&&(s.material.emissive=new a(o))})}),(e,a)=>T.value&&C.value?(w(),b("TresGroup",M,[j("primitive",{object:T.value,"position-y":.01},null,8,P),y(q)?(w(),b("primitive",{key:0,object:y(q)?.scene,"position-y":.1},null,8,x)):h("",!0),j("primitive",{object:C.value,"position-y":.1},null,8,U)])):h("",!0)}});export{_};
