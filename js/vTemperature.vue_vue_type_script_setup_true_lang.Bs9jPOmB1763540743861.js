import{u as e}from"./colorList.DbCLsRg71763540743861.js";import{r as a,a as t}from"./rawData.lQ4T1IdU1763540743861.js";import{P as r}from"./tweakpane.CqZAnw7f1763540743861.js";import{u as s}from"./rawData.Bm5IktqG1763540743861.js";import{_ as o}from"./surfaceSection.vue_vue_type_script_setup_true_lang.CZyitb8G1763540743861.js";import{d as l,a8 as n,a as i,c as u,w as p,H as m,o as d,u as v,J as c,b as h,I as x,m as f}from"./@vue.Co_gxueH1763540743861.js";import{V as g,bL as w,be as y,af as b,b1 as T,aE as E,aG as j,r as k,bK as _,ae as B}from"./three.rXKzP9fQ1763540743861.js";const S=["position","rotation"],A=["scale","visible"],C=["object"],F=l({__name:"vTemperature",props:{map:{}},async setup(l){let F,M;const R=l,z=R.map.geo2pos(new g(118.724419,32.010354,25e3));z.applyMatrix4(R.map.matrix);const D=s(),G=([F,M]=n(()=>fetch("./plugins/tvtVolumeRendering/rawData/rada.json").then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).catch(e=>{console.error("Fetch error:",e)})),F=await F,M(),F),I=new Uint8Array(G.datas.length);for(let e=0;e<G.datas.length;e++)I[e]=Math.round(G.datas[e]/60*255);D.byteArray=I,D.xExtent=G.row,D.yExtent=G.col,D.zExtent=G.height;const L=e(),P=new w(new y(new b(1,1,1)),new T({color:10066329})),U=i(G.row),V=i(D.yExtent/D.xExtent*G.col),H=i(D.zExtent/D.xExtent*G.height*10),J=u(()=>!(U.value<=.01&&U.value>=-.01)&&(!(V.value<=.01&&V.value>=-.01)&&!(H.value<=.01&&H.value>=-.01))),K=new E(D.byteArray,D.xExtent,D.yExtent,D.zExtent);K.format=j,K.type=D.getThreeType(),K.minFilter=k,K.magFilter=k,K.wrapS=_,K.wrapT=_,K.wrapR=_,K.needsUpdate=!0;const N={uniforms:{dataTexture:{value:K},colorTexture:{value:L.updateTransferFunction()},samplingRate:{value:1},threshold:{value:.5},alphaScale:{value:2},invertColor:{value:!1},composeType:{value:1}},vertexShader:t,fragmentShader:a,side:B,transparent:!0,depthWrite:!1,depthTest:!0,alphaToCoverage:!0},O=i(!0),W=(new r).addTab({pages:[{title:"三维体"},{title:"面剖"}]}),q=W.pages[0],Q=i(null);q.addBlade({view:"list",label:"模式",options:[{text:"maximumIntensity",value:1},{text:"thresholding",value:2},{text:"emissionAbsorption",value:3}],value:N.uniforms.composeType.value}).on("change",e=>{N.uniforms.composeType.value=e.value}),q.addBinding(N.uniforms.samplingRate,"value",{label:"体积采样率",min:0,max:4,step:.01}),q.addBinding(N.uniforms.threshold,"value",{label:"体绘制的阈值",min:0,max:1,step:.01}),q.addBinding(N.uniforms.alphaScale,"value",{label:"透明度",min:0,max:2,step:.01}),q.addBinding(N.uniforms.invertColor,"value",{label:"是否反色"}),q.addBinding(O,"value",{label:"显示边框"}),q.addBlade({view:"separator"});const X=i(!0);return q.addBinding(X,"value",{label:"显示三维体"}),p(()=>L.colorsStops,()=>{N.uniforms.colorTexture.value=L.updateTransferFunction()},{deep:!0,immediate:!0}),(e,a)=>(d(),m("TresGroup",{position:[...v(z)],rotation:[-Math.PI/2,0,0],scale:1e3},[c("TresMesh",{scale:[U.value,V.value,H.value],visible:J.value&&X.value,renderOrder:99990},[a[0]||(a[0]=c("TresBoxGeometry",{args:[1,1,1]},null,-1)),c("TresShaderMaterial",f(N,{ref_key:"smRef",ref:Q}),null,16),O.value?(d(),m("primitive",{key:0,object:v(P)},null,8,C)):x("",!0)],8,A),v(D).byteArray?(d(),h(o,{key:0,scale:[U.value,V.value,H.value],paneControl:v(W).pages[1]},null,8,["scale","paneControl"])):x("",!0)],8,S))}});export{F as _};
