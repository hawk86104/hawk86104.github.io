import{P as t}from"./tweakpane.yDiyAAkA1741168315107.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.J34yLRyD1741168315107.js";import{e}from"./@tresjs.Ea5Oq_-I1741168315107.js";import{z as r}from"./three-custom-shader-material.q4QTPw9f1741168315107.js";import{_ as i,C as u,cm as c,l as a,b9 as s}from"./three.FxqAALWt1741168315107.js";import{d as l,a2 as f,w as p,o as d,H as m,u as v,a3 as g,r as h,f as y,g as b,j as w,m as _}from"./@vue.NRI7TcgI1741168315107.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741168315107.js";import"./postprocessing.hfy6Kqg11741168315107.js";import"./@vueuse.Z8xAfE_A1741168315107.js";const C=T;function x(){const t=["bind","action","console","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","806464lepMlT","model","while (true) {}","object","bModel","clone","opacity",'{}.constructor("return this")( )',"36GEeBJQ","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","length","2546535zifaRZ","toString","return (function() ","material","26kVJXRe","value","chain","city","constructor","#ffff00","842296uAaeUw","color","renderOrder","gger","landColor","setStyle","#112233","input","info","uOpacity","boundingBox","counter","exception","474344mJmbfq","DoubleSide","1110225ZQCoDx","uColor","apply","MeshBasicMaterial","log","init","uGradient","dispose","debu","bulidingsColor","6XIWFrL","land","stateObject","gradient","uniforms","test","trace","isArray","46014tYSulb","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","computeBoundingBox","children","computeBoundingSphere","8935399sceetb","20IuMfSq"];return(x=function(){return t})()}!function(t,n){const o=T,e=x();for(;;)try{if(302938===parseInt(o(380))/1*(-parseInt(o(354))/2)+-parseInt(o(401))/3+-parseInt(o(365))/4+-parseInt(o(376))/5*(parseInt(o(346))/6)+parseInt(o(386))/7+parseInt(o(399))/8*(parseInt(o(373))/9)+parseInt(o(360))/10*(parseInt(o(359))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(403)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=T,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(355),"i"),e=P(t(341));n[t(351)](e+t(382))&&o[t(351)](e+t(393))?P():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(403)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=T;let n;try{n=Function(t(378)+t(372)+");")()}catch(r){n=window}const o=n[t(363)]=n[t(363)]||{},e=[t(405),"warn",t(394),"error",t(398),"table",t(352)];for(let i=0;i<e[t(375)];i++){const n=M[t(384)].prototype[t(361)](M),r=e[i],u=o[r]||n;n.__proto__=M[t(361)](M),n[t(377)]=u.toString.bind(u),o[r]=n}}))();const S=[C(368)];function T(t,n){const o=x();return(T=function(t,n){return o[t-=341]})(t,n)}const j=l({__name:C(369),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:C(392)},topColor:{default:C(385)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=C,o=t,c=o[n(366)][n(383)];o[n(366)][n(366)][n(357)][0][n(379)]=new(i[n(404)])({color:n(385)}),c[n(388)]=1001;const a=o[n(366)][n(347)];(()=>{const t=n,{geometry:e}=c;e[t(356)](),e[t(358)]();const{max:a,min:s}=e[t(396)];if(c[t(379)].__csm)return;const l=new r({baseMaterial:c[t(379)],vertexShader:t(374),fragmentShader:t(364),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(o.bulidingsColor)},uOpacity:{value:o.opacity},uLightColor:{value:new u("#ffffff")},uTopColor:{value:new u(o.topColor)},uTime:{value:0},uGradient:{value:o[t(349)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(400)]});c[t(379)][t(343)](),c[t(379)]=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(379)][o(350)].uTime.value+=t})),f((()=>{const t=n;o[t(345)]&&c[t(379)].uniforms[t(402)][t(381)].setStyle(o[t(345)]),o[t(390)]&&((t,e)=>{const r=n;let u;"cu"===t||t===r(347)&&(u=Array[r(353)](a.material)?a[r(379)]:[a[r(379)]],u.forEach((t=>{const n=r;t[e][n(391)](o[n(390)]),t.side=i[n(400)]})))})("land",t(387)),o.opacity&&(c[t(379)][t(350)][t(395)][t(381)]=o[t(371)])})),p(o,((t,o)=>{const e=n;c.material[e(350)][e(342)].value=t[e(349)]}));const l=o[n(366)][n(366)][n(370)]();return(t,n)=>(d(),m("primitive",{object:v(l)},null,8,S))}});function P(t){function n(t){const o=T;if("string"==typeof t)return function(t){}[o(384)](o(367))[o(403)](o(397));1!==(""+t/t)[o(375)]||t%20==0?function(){return!0}[o(384)](o(344)+"gger").call(o(362)):function(){return!1}.constructor(o(344)+o(389))[o(403)](o(348)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=E;!function(t,n){const o=E,e=A();for(;;)try{if(699610===-parseInt(o(466))/1*(-parseInt(o(450))/2)+parseInt(o(483))/3+parseInt(o(453))/4+parseInt(o(446))/5*(-parseInt(o(490))/6)+parseInt(o(494))/7+-parseInt(o(489))/8*(parseInt(o(464))/9)+parseInt(o(487))/10*(-parseInt(o(455))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(458)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function A(){const t=["27923OqQbTo","trace","table","uniforms","while (true) {}","geometry","input","value","__proto__","srcColor","debu","test","uColor","bind","call","length","scale","990042KHCEIw","renderOrder","console","builds","80kWMcMy","linewidth","16HqHOus","174wWZgZz","speed","gger","function *\\( *\\)","8867250hwAbHW","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)",'{}.constructor("return this")( )',"info","114445dcEhWY","material","uSrcColor","toString","38ZzoSoo","applyMatrix4","clone","1945872VpovyZ","init","1294656XfPTXG","object","color","apply","return (function() ","uScale","error","constructor","string","1389645ZqooiA","gradual"];return(A=function(){return t})()}!function(){z(this,(function(){const t=E,n=new RegExp(t(493)),o=new RegExp(t(496),"i"),e=G(t(454));n[t(477)](e+"chain")&&o[t(477)](e+t(472))?G():e("0")}))()}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();B(void 0,(function(){const t=E,n=function(){const t=E;let n;try{n=Function(t(459)+t(497)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(485)]||{},e=["log","warn",t(445),t(461),"exception",t(468),t(467)];for(let r=0;r<e.length;r++){const n=B.constructor.prototype.bind(B),i=e[r],u=o[i]||n;n[t(474)]=B[t(479)](B),n.toString=u[t(449)][t(479)](u),o[i]=n}}))();const F=[O(456)],Z=l({__name:"bLine",props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(457)])},uSrcColor:{value:new u(o[n(475)])},uScale:{value:o[n(482)]},uTime:{value:0},uGradual:{value:o[n(465)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(486)][n(471)])[n(452)]();l=l[n(451)](o.builds.matrix);const p=new a(i);r=new s(l,p),r[n(447)][n(488)]=o.width,r[n(484)]=1e3,f((()=>{const t=n;o.color&&(i.uniforms[t(478)][t(473)]=new u(o[t(457)])),o[t(475)]&&(i[t(469)][t(448)][t(473)]=new u(o[t(475)])),o[t(482)]&&(i[t(469)][t(460)][t(473)]=o[t(482)]),o[t(465)]&&(i[t(469)].uGradual[t(473)]=o[t(465)])}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(469)].uTime[e(473)]+=t*o[e(491)],i[e(469)].uTime.value%=1})),(t,n)=>(d(),m("primitive",{object:v(r)},null,8,F))}});function E(t,n){const o=A();return(E=function(t,n){return o[t-=445]})(t,n)}function G(t){function n(t){const o=E;if(typeof t===o(463))return function(t){}[o(462)](o(470))[o(458)](o(495));1!==(""+t/t)[o(481)]||t%20==0?function(){return!0}[o(462)](o(476)+o(492))[o(480)]("action"):function(){return!1}.constructor(o(476)+"gger").apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const W=R;!function(t,n){const o=R,e=H();for(;;)try{if(597945===parseInt(o(450))/1+-parseInt(o(428))/2*(-parseInt(o(436))/3)+parseInt(o(454))/4*(-parseInt(o(441))/5)+-parseInt(o(443))/6*(-parseInt(o(445))/7)+-parseInt(o(456))/8*(-parseInt(o(438))/9)+-parseInt(o(444))/10*(-parseInt(o(431))/11)+-parseInt(o(467))/12*(parseInt(o(455))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(425)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=R,n=new RegExp(t(430)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=D(t(440));n[t(466)](e+t(457))&&o.test(e+t(448))?D():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["trace","model","test","12phWyub","action","speed","return (function() ","prototype","bind","#112233","string","buildingsEffectA","apply","stateObject","gger","30VbaVqP","call","function *\\( *\\)","137324UBzXPn","debu","length","扩散系数","console","121893xaSTpT","__proto__","10127826wlmsSz","table","init","6260tnbHzP","city","59898tpvFTd","790MSizOk","581lKmSqk","color","counter","input","#000000","663704uqOnLt","#999","builds","error","2180GAvBoE","38129299Iqlfhb","8EpxWAt","chain","warn","toString","constructor","log","addBinding","while (true) {}"];return(H=function(){return t})()}function R(t,n){const o=H();return(R=function(t,n){return o[t-=424]})(t,n)}q(void 0,(function(){const t=R;let n;try{n=Function(t(470)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(435)]=n[t(435)]||{},e=[t(461),t(458),"info",t(453),"exception",t(439),t(464)];for(let i=0;i<e[t(433)];i++){const n=q.constructor[t(471)][t(472)](q),r=e[i],u=o[r]||n;n[t(437)]=q.bind(q),n[t(459)]=u.toString.bind(u),o[r]=n}}))();const L=l({__name:W(424),async setup(e){const r=W;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:"#FFF",srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:"效果参数",expanded:!0});return s[r(462)](a,"srcColor",{label:"线原颜色"}),s[r(462)](a,r(446),{label:"线扫颜色"}),s[r(462)](a,r(469),{label:"速度",min:.1,max:1,step:.1}),s[r(462)](a,"scale",{label:"最大扩散",min:10,max:2e3,step:10}),s[r(462)](a,"gradual",{label:r(434),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:b((()=>[w(j,{model:v(c),bulidingsColor:e(449),landColor:e(473),topColor:e(451)},null,8,[e(465)]),w(Z,_({builds:v(c)[e(442)]},a),null,16,[e(452)])])),_:1})}}});function D(t){function n(t){const o=R;if(typeof t===o(474))return function(t){}[o(460)](o(463))[o(425)](o(447));1!==(""+t/t).length||t%20==0?function(){return!0}[o(460)]("debu"+o(427))[o(429)](o(468)):function(){return!1}.constructor(o(432)+o(427))[o(425)](o(426)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{L as default};
