import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.zU671vpm1718612273914.js";import{r as o}from"./@tresjs.W42D3qe_1718612273914.js";import{C as e}from"./three-custom-shader-material.TWM8Wx7T1718612273914.js";import"./object-hash.NQGxxEoE1718612273914.js";import{a5 as r,Z as i,C as u,cb as c,k as a,a$ as s}from"./three.HHcT7YAr1718612273914.js";import"./@amap.zA6BxCQR1718612273914.js";import"./glsl-tokenizer.yImbcCwc1718612273914.js";import{d as l,a2 as f,w as p,o as d,D as m,u as v,a3 as g,r as h,f as y,g as w,j as C,m as _}from"./@vue.CpOXM7bB1718612273914.js";import{P as b}from"./tweakpane.qqn77PB81718612273914.js";import"./@vueuse.YjRg4c7n1718612273914.js";import"./glsl-token-string.GsokCkw11718612273914.js";import"./glsl-token-functions.M4ENNoPy1718612273914.js";import"./jszip.ceBEBY8K1718612273914.js";const x=j;!function(t,n){const o=j,e=M();for(;;)try{if(339494===-parseInt(o(485))/1*(-parseInt(o(459))/2)+-parseInt(o(449))/3+-parseInt(o(490))/4+parseInt(o(506))/5*(parseInt(o(484))/6)+-parseInt(o(507))/7*(-parseInt(o(463))/8)+-parseInt(o(504))/9*(parseInt(o(477))/10)+-parseInt(o(479))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[j(473)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function j(t,n){const o=M();return(j=function(t,n){return o[t-=449]})(t,n)}function M(){const t=["land","topColor","606198jshjuj","prototype","error","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","8kKFpYr",'{}.constructor("return this")( )',"value","gger","exception","model","side","renderOrder","clone","warn","apply","string","uniforms","MeshBasicMaterial","790jBNqZd","landColor","819929KDOhVV","test","#112233","input","boundingBox","3344028AQhLmq","1aTSMSu","bind","function *\\( *\\)","uTime","bulidingsColor","1734124EBRceL","toString","counter","isArray","console","debu","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","dispose","object","uOpacity","Color","__proto__","children","65466KyLayI","gradient","5HLTRVt","4294073CkoYJB","while (true) {}","table","constructor","computeBoundingBox","154998GXPKPo","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","#ffff00","color","material","log","bModel","length"];return(M=function(){return t})()}!function(){I(this,(function(){const t=j,n=new RegExp(t(487)),o=new RegExp(t(496),"i"),e=B("init");n[t(480)](e+t(497))&&o.test(e+t(482))?B():e("0")}))()}();const T=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[j(473)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();T(void 0,(function(){const t=j,n=function(){const t=j;let n;try{n=Function("return (function() "+t(464)+");")()}catch(o){n=window}return n}(),o=n[t(494)]=n[t(494)]||{},e=[t(454),t(472),"info",t(461),t(467),t(509),"trace"];for(let r=0;r<e[t(456)];r++){const n=T[t(510)][t(460)][t(486)](T),i=e[r],u=o[i]||n;n[t(502)]=T.bind(T),n[t(491)]=u[t(491)][t(486)](u),o[i]=n}}))();const S=[x(499)],P=l({__name:x(455),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:x(481)},topColor:{default:x(451)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,u=t,c=u[n(468)].city;u.model[n(468)][n(503)][0][n(453)]=new(r[n(476)])({color:n(451)}),c[n(470)]=1001;const a=u[n(468)][n(457)];(()=>{const t=n,{geometry:o}=c;o[t(511)](),o.computeBoundingSphere();const{max:a,min:s}=o[t(483)];if(c[t(453)].__csm)return;const l=new e({baseMaterial:c.material,vertexShader:t(462),fragmentShader:t(450),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(501)])(u[t(489)])},uOpacity:{value:u.opacity},uLightColor:{value:new(r[t(501)])("#ffffff")},uTopColor:{value:new(r[t(501)])(u[t(458)])},uTime:{value:0},uGradient:{value:u[t(505)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i});c[t(453)][t(498)](),c[t(453)]=l})();const{onLoop:s}=o();s((({delta:t})=>{const o=n;c[o(453)][o(475)][o(488)].value+=t})),f((()=>{const t=n;u.bulidingsColor&&c.material[t(475)].uColor.value.setStyle(u.bulidingsColor),u[t(478)]&&((t,o)=>{const e=n;let r;"cu"===t||t===e(457)&&(r=Array[e(493)](a.material)?a[e(453)]:[a.material],r.forEach((t=>{const n=e;t[o].setStyle(u[n(478)]),t[n(469)]=i})))})("land",t(452)),u.opacity&&(c[t(453)].uniforms[t(500)].value=u.opacity)})),p(u,((t,o)=>{const e=n;c[e(453)][e(475)].uGradient[e(465)]=t[e(505)]}));const l=u[n(468)].model[n(471)]();return(t,n)=>(d(),m("primitive",{object:v(l)},null,8,S))}});function B(t){function n(t){const o=j;if(typeof t===o(474))return function(t){}[o(510)](o(508))[o(473)](o(492));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(495)+o(466)).call("action"):function(){return!1}[o(510)]("debu"+o(466)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=A;!function(t,n){const o=A,e=k();for(;;)try{if(867789===-parseInt(o(252))/1*(-parseInt(o(244))/2)+-parseInt(o(240))/3+parseInt(o(241))/4+-parseInt(o(249))/5+parseInt(o(215))/6+-parseInt(o(210))/7+parseInt(o(216))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(237)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){F(this,(function(){const t=A,n=new RegExp(t(225)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=R("init");n[t(223)](e+t(257))&&o[t(223)](e+"input")?R():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(237)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(){const t=["uniforms","#000","constructor","trace","uColor","matrix","primitive","return (function() ","builds","gger","apply","table","geometry","1067319ZsYUje","5653780lKJscY","speed","applyMatrix4","625032nhwbiw","string","warn","toString","length","1855170TEIwPC","#FFF","bind","2mwjZsj","clone","uGradual","while (true) {}","value","chain","console","__proto__","gradual","action","7661094hFlPIh","object","debu","log","info","3877986BWUCOZ","33840OYPLsg","uSrcColor","material","bLine","srcColor","uTime","scale","test","linewidth","function *\\( *\\)","error"];return(k=function(){return t})()}function A(t,n){const o=k();return(A=function(t,n){return o[t-=207]})(t,n)}L(void 0,(function(){const t=A;let n;try{n=Function(t(234)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(258)]=n[t(258)]||{},e=[t(213),t(246),t(214),t(226),"exception",t(238),t(230)];for(let i=0;i<e[t(248)];i++){const n=L[t(229)].prototype[t(251)](L),r=e[i],u=o[r]||n;n[t(207)]=L[t(251)](L),n[t(247)]=u[t(247)][t(251)](u),o[r]=n}}))();const Z=[O(211)],E=l({__name:O(219),props:{builds:{},color:{default:O(250)},srcColor:{default:O(228)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e.color)},uSrcColor:{value:new u(e[n(220)])},uScale:{value:e[n(222)]},uTime:{value:0},uGradual:{value:e[n(208)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(e.builds[n(239)])[n(253)]();l=l[n(243)](e[n(235)][n(232)]);const p=new a(i);r=new s(l,p),r[n(218)][n(224)]=e.width,r.renderOrder=1e3,f((()=>{const t=n;e.color&&(i.uniforms[t(231)][t(256)]=new u(e.color)),e[t(220)]&&(i.uniforms[t(217)].value=new u(e[t(220)])),e[t(222)]&&(i[t(227)].uScale.value=e.scale),e.gradual&&(i[t(227)][t(254)][t(256)]=e.gradual)}));const{onLoop:g}=o();return g((({delta:t})=>{const o=n;i[o(227)][o(221)][o(256)]+=t*e[o(242)],i[o(227)].uTime[o(256)]%=1})),(t,o)=>{const e=n;return d(),m(e(233),{object:v(r)},null,8,Z)}}});function R(t){function n(t){const o=A;if(typeof t===o(245))return function(t){}[o(229)](o(255))[o(237)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(229)](o(212)+o(236)).call(o(209)):function(){return!1}[o(229)](o(212)+o(236))[o(237)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function z(t,n){const o=$();return(z=function(t,n){return o[t-=132]})(t,n)}const G=z;!function(t,n){const o=z,e=$();for(;;)try{if(982874===-parseInt(o(177))/1*(-parseInt(o(132))/2)+parseInt(o(141))/3*(-parseInt(o(136))/4)+-parseInt(o(175))/5*(-parseInt(o(174))/6)+-parseInt(o(135))/7+parseInt(o(147))/8+parseInt(o(169))/9+-parseInt(o(165))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(161)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(){const t=["counter","扩散系数","warn","14198562IwZQCC","buildingsEffectA","length","info","线原颜色","75306bQlLIo","365WaByNo","prototype","1kkqwQA","debu","test","return (function() ","2084254mMQbEL","toString","#112233","10013829DTFLTP","138328pxRXKG","chain","error","model","while (true) {}","24dmFgex","bind","call","console","gger","#999","4427416PJRWPd","log","exception","string","最大扩散","srcColor","city","builds","trace","scale","speed","gradual","constructor","addBinding","apply","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#000","input","13993180XcCMWI"];return($=function(){return t})()}!function(){W(this,(function(){const t=z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(162),"i"),e=Q("init");n[t(179)](e+t(137))&&o.test(e+t(164))?Q():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(161)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();D(void 0,(function(){const t=z;let n;try{n=Function(t(180)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(144)]=n[t(144)]||{},e=[t(148),t(168),t(172),t(138),t(149),"table",t(155)];for(let i=0;i<e[t(171)];i++){const n=D[t(159)][t(176)][t(142)](D),r=e[i],u=o[r]||n;n.__proto__=D[t(142)](D),n[t(133)]=u[t(133)].bind(u),o[r]=n}}))();const K=l({__name:G(170),async setup(o){const e=G;let r,i;const u=([r,i]=g((()=>n())),r=await r,i(),r),c=h({color:"#FFF",srcColor:e(163),scale:2e3,gradual:6.6,speed:.3}),a=new b({title:"效果参数",expanded:!0});return a[e(160)](c,e(152),{label:e(173)}),a.addBinding(c,"color",{label:"线扫颜色"}),a[e(160)](c,e(157),{label:"速度",min:.1,max:1,step:.1}),a[e(160)](c,e(156),{label:e(151),min:10,max:2e3,step:10}),a[e(160)](c,e(158),{label:e(167),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return d(),y(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(P,{model:v(u),bulidingsColor:"#000000",landColor:r(134),topColor:r(146)},null,8,[r(139)]),C(E,_({builds:v(u)[r(153)]},c),null,16,[r(154)])])),_:1})}}});function Q(t){function n(t){const o=z;if(typeof t===o(150))return function(t){}[o(159)](o(140)).apply(o(166));1!==(""+t/t)[o(171)]||t%20==0?function(){return!0}.constructor(o(178)+o(145))[o(143)]("action"):function(){return!1}[o(159)](o(178)+o(145))[o(161)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{K as default};
