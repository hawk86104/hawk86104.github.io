import{_ as t,ce as n,cf as o,cg as e,ch as r,C as i,m as u,bU as c,ak as s,am as a}from"./three.YiCjTDWq1728554291399.js";import{c as l,U as f,Y as p}from"./@tresjs.IlQvaTJ91728554291399.js";import{C as d}from"./three-custom-shader-material.jyK-33IL1728554291399.js";import"./object-hash.T8hJJgjS1728554291399.js";import"./@amap.pS6gfiLZ1728554291399.js";import"./glsl-tokenizer.y_V5nCRK1728554291399.js";import{d as h,b as m,a3 as g,w as y,o as w,E as v,u as b,r as _,a4 as I,e as C,f as x,g as M,L as T,j as S,aj as j,ak as A,F as O,J as B,H as R,m as L}from"./@vue.JNsx1iN61728554291399.js";!function(t,n){const o=H,e=D();for(;;)try{if(299072===parseInt(o(451))/1*(parseInt(o(456))/2)+-parseInt(o(425))/3*(parseInt(o(455))/4)+parseInt(o(448))/5+parseInt(o(450))/6+-parseInt(o(440))/7+-parseInt(o(447))/8+parseInt(o(454))/9*(-parseInt(o(446))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(431)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=H,n=new RegExp(t(423)),o=new RegExp(t(452),"i"),e=W("init");n[t(430)](e+t(453))&&o[t(430)](e+t(443))?W():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(431)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(t,n){const o=D();return(H=function(t,n){return o[t-=422]})(t,n)}E(void 0,(function(){const t=H,n=function(){const t=H;let n;try{n=Function(t(449)+t(437)+");")()}catch(o){n=window}return n}(),o=n[t(438)]=n[t(438)]||{},e=["log",t(457),"info","error","exception","table",t(441)];for(let r=0;r<e[t(433)];r++){const n=E[t(444)].prototype[t(422)](E),i=e[r],u=o[i]||n;n[t(445)]=E[t(422)](E),n[t(434)]=u[t(434)][t(422)](u),o[i]=n}}))();const z=async()=>{const t=H,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(424)]((n=>{const i=t;n[i(427)]===i(435)&&(o=n),n[i(427)]===i(436)&&(e=n),n[i(427)]===i(432)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function D(){const t=["bind","function *\\( *\\)","traverse","4917sJAzUT","debu","name","gger","call","test","apply","ROADS","length","toString","CITY_UNTRIANGULATED","LANDMASS",'{}.constructor("return this")( )',"console","stateObject","1116563iWEhZd","trace","while (true) {}","input","constructor","__proto__","10Pnlldf","137144iIVNmw","1202315cBTAiW","return (function() ","2202246ZFVbRR","178WEzOtO","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","1416141xjuDem","892EWnKLu","4394byYGsw","warn","string"];return(D=function(){return t})()}function W(t){function n(t){const o=H;if(typeof t===o(458))return function(t){}.constructor(o(442)).apply("counter");1!==(""+t/t)[o(433)]||t%20==0?function(){return!0}.constructor("debugger")[o(429)]("action"):function(){return!1}[o(444)](o(426)+o(428))[o(431)](o(439)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const F=$;!function(t,n){const o=$,e=G();for(;;)try{if(974456===-parseInt(o(428))/1*(parseInt(o(458))/2)+-parseInt(o(483))/3+-parseInt(o(477))/4*(-parseInt(o(436))/5)+parseInt(o(445))/6+-parseInt(o(450))/7*(parseInt(o(487))/8)+-parseInt(o(480))/9*(-parseInt(o(439))/10)+parseInt(o(441))/11*(parseInt(o(440))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(427)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=$,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(473),"i"),e=U(t(471));n[t(452)](e+t(474))&&o[t(452)](e+t(455))?U():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(427)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(){const t=["action","object","145204vTyLUp","opacity","bulidingsColor","131364cyoqdA","computeBoundingSphere","table","2414094pjewiV","call","length","string","2738024NwSAcu","#ffffff","stateObject","info","uColor","bind","apply","43060kQfaYc","__csm","exception","landColor","setStyle","DoubleSide","computeBoundingBox","toString","90uHksHx","buildingsModelCustomShader","uGradient","240FSMeRN","276zeSJlW","573507wXxHpp","constructor","model","color","544644mkuYow","dispose","Color","land","debu","7wdLAVF","forEach","test","city","value","input",'{}.constructor("return this")( )',"while (true) {}","8ckNQSp","material","trace","warn","error","gradient","#112233","prototype","boundingBox","console","uOpacity","uniforms","return (function() ","init","log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain"];return(G=function(){return t})()}Y(void 0,(function(){const t=$;let n;try{n=Function(t(470)+t(456)+");")()}catch(r){n=window}const o=n[t(467)]=n.console||{},e=[t(472),t(461),t(490),t(462),t(430),t(482),t(460)];for(let i=0;i<e[t(485)];i++){const n=Y[t(442)][t(465)].bind(Y),r=e[i],u=o[r]||n;n.__proto__=Y[t(426)](Y),n.toString=u[t(435)][t(426)](u),o[r]=n}}))();const P=[F(476)];function $(t,n){const o=G();return($=function(t,n){return o[t-=426]})(t,n)}const N=h({__name:F(437),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:F(464)},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=F,e=n,r=m(0),i=e[o(443)][o(453)];i.renderOrder=1001;const u=e[o(443)][o(448)];(()=>{const n=o,{geometry:u}=i;u[n(434)](),u[n(481)]();const{max:c,min:s}=u[n(466)];if(i[n(459)][n(429)])return;const a=new d({baseMaterial:i[n(459)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(447)])(e.bulidingsColor)},uOpacity:{value:e[n(478)]},uLightColor:{value:new(t[n(447)])(n(488))},uTopColor:{value:new(t[n(447)])(e.topColor)},uTime:r,uGradient:{value:e.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(433)]});i[n(459)][n(446)](),i.material=a})();const{onLoop:c}=f();c((({delta:t})=>{r[o(454)]+=t})),g((()=>{const n=o;e[n(479)]&&i[n(459)][n(469)][n(491)][n(454)][n(432)](e[n(479)]),e[n(431)]&&((n,r)=>{const i=o;let c;"cu"===n||n===i(448)&&(c=Array.isArray(u[i(459)])?u[i(459)]:[u[i(459)]],c[i(451)]((n=>{const o=i;n[r][o(432)](e[o(431)]),n.side=t[o(433)]})))})("land",n(444)),e.opacity&&(i[n(459)][n(469)][n(468)][n(454)]=e[n(478)])})),y(e,((t,n)=>{const e=o;i[e(459)][e(469)][e(438)].value=t[e(463)]}));const s=e.model[o(443)].clone();return(t,n)=>(w(),v("primitive",{object:b(s)},null,8,P))}});function U(t){function n(t){const o=$;if(typeof t===o(486))return function(t){}[o(442)](o(457))[o(427)]("counter");1!==(""+t/t)[o(485)]||t%20==0?function(){return!0}[o(442)](o(449)+"gger")[o(484)](o(475)):function(){return!1}[o(442)](o(449)+"gger")[o(427)](o(489)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const V=K;!function(t,n){const o=K,e=Q();for(;;)try{if(385110===parseInt(o(154))/1*(parseInt(o(171))/2)+-parseInt(o(206))/3*(parseInt(o(173))/4)+parseInt(o(201))/5+parseInt(o(190))/6*(-parseInt(o(183))/7)+parseInt(o(176))/8*(-parseInt(o(186))/9)+-parseInt(o(148))/10+parseInt(o(167))/11*(parseInt(o(181))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(163)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=K,n=new RegExp(t(185)),o=new RegExp(t(150),"i"),e=nt(t(209));n[t(160)](e+t(207))&&o.test(e+t(199))?nt():e("0")}))()}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(163)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();X(void 0,(function(){const t=K,n=function(){const t=K;let n;try{n=Function(t(153)+t(151)+");")()}catch(o){n=window}return n}(),o=n[t(195)]=n.console||{},e=["log","warn",t(200),t(187),t(210),t(182),t(156)];for(let r=0;r<e[t(179)];r++){const n=X.constructor.prototype[t(197)](X),i=e[r],u=o[i]||n;n[t(161)]=X.bind(X),n[t(208)]=u[t(208)].bind(u),o[i]=n}}))();const q=[V(152)];function K(t,n){const o=Q();return(K=function(t,n){return o[t-=148]})(t,n)}function Q(){const t=["innerWidth","stateObject","2fMrMuq","Shader","3692GpzZuF","constructor","while (true) {}","664BORcEm","width","color","length","matrix","60rXDkuC","table","9170goBZYl","gger","function *\\( *\\)","67599SeBYCE","error","fromEdgesGeometry","counter","2454aRKtxg","#FFF","geometry","uniforms","applyMatrix4","console","Wireframe","bind","resolution","input","info","1291700aLhjkW","opacity"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","string","builds","630DyxZTD","chain","toString","init","exception","2827050PEdoui","debu","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)",'{}.constructor("return this")( )',"object","return (function() ","563713HIbjKt","clone","trace","renderOrder","material","call","test","__proto__","linewidth","apply","action","value","style","2637349XxhIVl","innerHeight"];return(Q=function(){return t})()}const tt=h({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:V(191)},opacity:{default:1},style:{default:V(196)}},setup(t){const c=V,s=t;let a=null,l=null;if(s[c(166)]===c(196)){const t=new n(s[c(205)][c(192)]);let i=(new o)[c(188)](t),u=new e({color:s.color,linewidth:s[c(177)],opacity:s[c(202)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(198)].set(window[c(169)],window[c(168)]),a=new r(i,u),a.applyMatrix4(s.builds[c(180)][c(155)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(s.color)},uOpacity:{value:s[c(202)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(203)};const t=new n(s[c(205)][c(192)]),o=new u(l);a=new LineSegments(t,o),a[c(194)](s[c(205)].matrix[c(155)]()),a.material.linewidth=s[c(177)],a[c(157)]=1e3}return g((()=>{const t=c;s[t(166)]===t(172)&&(s[t(178)]&&(l[t(193)].uColor[t(165)]=new i(s[t(178)])),s[t(202)]&&(l[t(193)].uOpacity[t(165)]=s[t(202)])),s[t(166)]===t(196)&&(s[t(178)]&&(a[t(158)][t(178)]=new i(s[t(178)])),s[t(202)]&&(a[t(158)][t(202)]=s[t(202)])),s[t(177)]&&(a[t(158)][t(162)]=s[t(177)])})),(t,n)=>(w(),v("primitive",{object:b(a)},null,8,q))}});function nt(t){function n(t){const o=K;if(typeof t===o(204))return function(t){}[o(174)](o(175))[o(163)](o(189));1!==(""+t/t)[o(179)]||t%20==0?function(){return!0}[o(174)](o(149)+o(184))[o(159)](o(164)):function(){return!1}[o(174)](o(149)+"gger")[o(163)](o(170)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=it;!function(t,n){const o=it,e=ut();for(;;)try{if(647373===parseInt(o(183))/1+parseInt(o(160))/2*(-parseInt(o(174))/3)+parseInt(o(167))/4*(parseInt(o(159))/5)+-parseInt(o(163))/6+-parseInt(o(196))/7+parseInt(o(194))/8+-parseInt(o(165))/9*(-parseInt(o(185))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(193)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=it,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(187),"i"),e=pt(t(192));n[t(184)](e+"chain")&&o[t(184)](e+t(172))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(193)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(t,n){const o=ut();return(it=function(t,n){return o[t-=151]})(t,n)}function ut(){const t=["info","#ffffff","length","TresAxesHelper","866569lkHsos","test","110HsOaBe","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","call","return (function() ","TresCanvas","model","init","apply","4785904otYKsN","disableRender","8128519TneYfa","pagesShow","string","toString","showGridHelper","bind","TresGridHelper","console","#000000","206425gYWXll","18hhJLYg",'{}.constructor("return this")( )',"while (true) {}","418554wYiqLj","city","192762ckdDxB","tcRef","100NpqSuA","builds","trace","constructor","gger","input","action","284727WJLAfL","perspectiveCameraRef","warn","stateObject","debu"];return(ut=function(){return t})()}rt(void 0,(function(){const t=it,n=function(){const t=it;let n;try{n=Function(t(189)+t(161)+");")()}catch(o){n=window}return n}(),o=n[t(157)]=n[t(157)]||{},e=["log",t(176),t(179),"error","exception","table",t(169)];for(let r=0;r<e[t(181)];r++){const n=rt.constructor.prototype.bind(rt),i=e[r],u=o[i]||n;n.__proto__=rt.bind(rt),n[t(153)]=u[t(153)][t(155)](u),o[i]=n}}))();const ct=T("TresAmbientLight",{color:ot(180)},null,-1),st=T("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]},ft=h({__name:ot(151),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(158),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(195)]}),u=_({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r.showBuildings&&([o,e]=I((()=>z())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C(e(190));return w(),x(c,L({ref_key:e(166),ref:d},i,{"window-size":""}),{default:M((()=>[T("TresPerspectiveCamera",{ref_key:e(175),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(p),j(A(u)),null,16),ct,st,r.showBuildings&&b(l)?(w(),v(O,{key:0},[S(N,{model:b(l)},null,8,[e(191)]),S(tt,{builds:b(l)[e(164)],color:"#000"},null,8,[e(168)])],64)):B("",!0),R(t.$slots,"ability"),r.showAxesHelper?(w(),v(e(182),at)):B("",!0),r[e(154)]?(w(),v(e(156),lt)):B("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=it;if(typeof t===o(152))return function(t){}[o(170)](o(162)).apply(o(186));1!==(""+t/t)[o(181)]||t%20==0?function(){return!0}[o(170)](o(178)+"gger")[o(188)](o(173)):function(){return!1}.constructor("debu"+o(171))[o(193)](o(177)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{N as _,tt as a,ft as b,z as l};
