import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.P6hbCPpV1723189171640.js";import{$ as o}from"./@tresjs.LTwFwASm1723189171640.js";import{C as e}from"./three-custom-shader-material.XueWmqLp1723189171640.js";import"./object-hash.jMAsrj6h1723189171640.js";import{a6 as r,C as i,cb as u,k as c,b0 as s}from"./three.5MXJ6W7w1723189171640.js";import"./@amap.Lu-L8G0q1723189171640.js";import"./glsl-tokenizer.lazMVlew1723189171640.js";import{d as a,a1 as l,w as f,o as p,D as d,u as m,a4 as v,r as g,f as h,g as y,j as w,m as C}from"./@vue.Q1VpS3901723189171640.js";import{P as _}from"./tweakpane.yHWGBmom1723189171640.js";import"./@vueuse.oQlm8k6P1723189171640.js";import"./glsl-token-string.HJw4RHIk1723189171640.js";import"./glsl-token-functions.95Du-VYb1723189171640.js";import"./jszip.WwTqi4J91723189171640.js";const b=S;function x(){const t=["#e523ff","children","bulidingsColor","chain","__proto__","info","__csm","gradient","forEach",'{}.constructor("return this")( )',"action","counter","test","stateObject","Color","14170murbBk","dispose","material","uGradient","call","boundingBox","console","uniforms","28130vjQcUh","MeshBasicMaterial","toString","table","apply","function *\\( *\\)","uTime","388541dQJBRN","value","prototype","2095056cpdnNW","exception","88aPcLPP","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","isArray","setStyle","computeBoundingBox","bind","renderOrder","side","1669454CwGqEA","414eErFVe","uColor","color","land","debu","opacity","model","#ffff00","#ffffff","bModel","warn","error","4716wwehUq","primitive","topColor","init","string","47733PNhALY","DoubleSide","4877072XeoZQN","length","while (true) {}","constructor","uOpacity","input"];return(x=function(){return t})()}!function(t,n){const o=S,e=x();for(;;)try{if(505693===-parseInt(o(420))/1+parseInt(o(364))/2+-parseInt(o(354))/3+-parseInt(o(356))/4*(parseInt(o(413))/5)+-parseInt(o(365))/6*(parseInt(o(382))/7)+parseInt(o(384))/8+parseInt(o(377))/9*(parseInt(o(405))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(417)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=S,n=new RegExp(t(418)),o=new RegExp(t(357),"i"),e=P(t(380));n[t(402)](e+t(393))&&o.test(e+t(389))?P():e("0")}))()}();const j=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(417)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();j(void 0,(function(){const t=S,n=function(){const t=S;let n;try{n=Function("return (function() "+t(399)+");")()}catch(o){n=window}return n}(),o=n[t(411)]=n[t(411)]||{},e=["log",t(375),t(395),t(376),t(355),t(416),"trace"];for(let r=0;r<e[t(385)];r++){const n=j.constructor[t(353)][t(361)](j),i=e[r],u=o[i]||n;n[t(394)]=j[t(361)](j),n[t(415)]=u.toString[t(361)](u),o[i]=n}}))();const M=["object"];function S(t,n){const o=x();return(S=function(t,n){return o[t-=353]})(t,n)}const T=a({__name:b(374),props:{model:{},bulidingsColor:{default:b(390)},landColor:{default:"#112233"},topColor:{default:b(372)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,u=t,c=u[n(371)].city;u[n(371)][n(371)][n(391)][0][n(407)]=new(r[n(414)])({color:"#ffff00"}),c[n(362)]=1001;const s=u.model[n(368)];(()=>{const t=n,{geometry:o}=c;o[t(360)](),o.computeBoundingSphere();const{max:s,min:a}=o[t(410)];if(c.material[t(396)])return;const l=new e({baseMaterial:c[t(407)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(404)])(u[t(392)])},uOpacity:{value:u[t(370)]},uLightColor:{value:new i(t(373))},uTopColor:{value:new(r[t(404)])(u[t(379)])},uTime:{value:0},uGradient:{value:u[t(397)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(383)]});c[t(407)][t(406)](),c[t(407)]=l})();const{onLoop:a}=o();a((({delta:t})=>{const o=n;c[o(407)][o(412)][o(419)][o(421)]+=t})),l((()=>{const t=n;u.bulidingsColor&&c[t(407)][t(412)][t(366)][t(421)][t(359)](u.bulidingsColor),u.landColor&&((t,o)=>{const e=n;let i;"cu"===t||t===e(368)&&(i=Array[e(358)](s[e(407)])?s[e(407)]:[s[e(407)]],i[e(398)]((t=>{const n=e;t[o][n(359)](u.landColor),t[n(363)]=r[n(383)]})))})(t(368),t(367)),u[t(370)]&&(c[t(407)][t(412)][t(388)][t(421)]=u.opacity)})),f(u,((t,o)=>{const e=n;c[e(407)].uniforms[e(408)][e(421)]=t[e(397)]}));const v=u[n(371)].model.clone();return(t,o)=>{const e=n;return p(),d(e(378),{object:m(v)},null,8,M)}}});function P(t){function n(t){const o=S;if(typeof t===o(381))return function(t){}[o(387)](o(386))[o(417)](o(401));1!==(""+t/t)[o(385)]||t%20==0?function(){return!0}[o(387)](o(369)+"gger")[o(409)](o(400)):function(){return!1}[o(387)](o(369)+"gger")[o(417)](o(403)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=A;!function(t,n){const o=A,e=E();for(;;)try{if(730834===parseInt(o(412))/1+parseInt(o(404))/2*(-parseInt(o(436))/3)+parseInt(o(442))/4+-parseInt(o(405))/5*(parseInt(o(416))/6)+-parseInt(o(428))/7+parseInt(o(440))/8+-parseInt(o(403))/9*(-parseInt(o(398))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(431)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function A(t,n){const o=E();return(A=function(t,n){return o[t-=397]})(t,n)}!function(){B(this,(function(){const t=A,n=new RegExp(t(414)),o=new RegExp(t(424),"i"),e=G(t(401));n[t(419)](e+t(411))&&o[t(419)](e+"input")?G():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(431)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();F(void 0,(function(){const t=A,n=function(){const t=A;let n;try{n=Function(t(421)+t(408)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(413)]||{},e=["log",t(415),t(435),"error","exception","table",t(426)];for(let r=0;r<e.length;r++){const n=F[t(444)].prototype[t(422)](F),i=e[r],u=o[i]||n;n.__proto__=F[t(422)](F),n[t(402)]=u[t(402)][t(422)](u),o[i]=n}}))();const k=[O(397)],z=a({__name:O(423),props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,e=t;let r=null;const a={transparent:!0,uniforms:{uColor:{value:new i(e[n(417)])},uSrcColor:{value:new i(e.srcColor)},uScale:{value:e[n(410)]},uTime:{value:0},uGradual:{value:e.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e[n(441)].geometry)[n(432)]();f=f[n(418)](e.builds[n(400)]);const v=new c(a);r=new s(f,v),r.material.linewidth=e[n(439)],r.renderOrder=1e3,l((()=>{const t=n;e.color&&(a.uniforms[t(406)][t(438)]=new i(e[t(417)])),e[t(430)]&&(a[t(425)].uSrcColor.value=new i(e[t(430)])),e[t(410)]&&(a.uniforms[t(399)].value=e.scale),e[t(437)]&&(a[t(425)][t(407)].value=e[t(437)])}));const{onLoop:g}=o();return g((({delta:t})=>{const o=n;a[o(425)][o(433)][o(438)]+=t*e.speed,a[o(425)][o(433)].value%=1})),(t,o)=>{const e=n;return p(),d(e(429),{object:m(r)},null,8,k)}}});function E(){const t=["gradual","value","width","10824088fCjJne","builds","1167320cDhmuO","stateObject","constructor","object","195950fgXbaB","uScale","matrix","init","toString","459rpNjzD","30MztJdH","725035yaQPkP","uColor","uGradual",'{}.constructor("return this")( )',"counter","scale","chain","269030Yhvnau","console","function *\\( *\\)","warn","30NDJyOZ","color","applyMatrix4","test","gger","return (function() ","bind","bLine","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uniforms","trace","action","7009534IQellb","primitive","srcColor","apply","clone","uTime","debu","info","91197KkLsII"];return(E=function(){return t})()}function G(t){function n(t){const o=A;if("string"==typeof t)return function(t){}[o(444)]("while (true) {}").apply(o(409));1!==(""+t/t).length||t%20==0?function(){return!0}[o(444)](o(434)+o(420)).call(o(427)):function(){return!1}[o(444)]("debu"+o(420))[o(431)](o(443)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function D(t,n){const o=L();return(D=function(t,n){return o[t-=401]})(t,n)}function L(){const t=["最大扩散","color","info","17111679YrThUS","45159FBDwGd","console","return (function() ","#999","call","apply","test","112BUxpLt","builds","498506GwYAOx","#112233","效果参数","constructor","debu","#000000","530870JvqFPp","2960ugYAcT","11Vsqctv","14405ETgSol","144809fOQSYP","gradual","5139mvCAbR","扩散系数","trace","12uswjNV","bind","error","while (true) {}",'{}.constructor("return this")( )',"model","#000","scale","20cOmUQQ","toString","function *\\( *\\)","srcColor","city","table","exception","stateObject","init","12vyPSTc","#FFF","gger","addBinding","log","action","length"];return(L=function(){return t})()}!function(t,n){const o=D,e=L();for(;;)try{if(280848===-parseInt(o(408))/1+parseInt(o(431))/2*(-parseInt(o(451))/3)+parseInt(o(406))/4*(-parseInt(o(417))/5)+parseInt(o(440))/6*(-parseInt(o(418))/7)+-parseInt(o(415))/8*(parseInt(o(420))/9)+parseInt(o(414))/10*(-parseInt(o(416))/11)+parseInt(o(423))/12*(parseInt(o(450))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){R(this,(function(){const t=D,n=new RegExp(t(433)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=N(t(439));n[t(405)](e+"chain")&&o.test(e+"input")?N():e("0")}))()}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Q(void 0,(function(){const t=D;let n;try{n=Function(t(401)+t(427)+");")()}catch(r){n=window}const o=n.console=n[t(452)]||{},e=[t(444),"warn",t(449),t(425),t(437),t(436),t(422)];for(let i=0;i<e[t(446)];i++){const n=Q[t(411)].prototype[t(424)](Q),r=e[i],u=o[r]||n;n.__proto__=Q.bind(Q),n[t(432)]=u[t(432)][t(424)](u),o[r]=n}}))();const Z=a({__name:"buildingsEffectA",async setup(o){const e=D;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=g({color:e(441),srcColor:e(429),scale:2e3,gradual:6.6,speed:.3}),s=new _({title:e(410),expanded:!0});return s[e(443)](c,e(434),{label:"线原颜色"}),s[e(443)](c,e(448),{label:"线扫颜色"}),s[e(443)](c,"speed",{label:"速度",min:.1,max:1,step:.1}),s[e(443)](c,e(430),{label:e(447),min:10,max:2e3,step:10}),s[e(443)](c,e(419),{label:e(421),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[w(T,{model:m(u),bulidingsColor:r(413),landColor:r(409),topColor:r(402)},null,8,[r(428)]),w(z,C({builds:m(u)[r(435)]},c),null,16,[r(407)])])),_:1})}}});function N(t){function n(t){const o=D;if("string"==typeof t)return function(t){}.constructor(o(426))[o(404)]("counter");1!==(""+t/t)[o(446)]||t%20==0?function(){return!0}.constructor(o(412)+o(442))[o(403)](o(445)):function(){return!1}.constructor(o(412)+o(442))[o(404)](o(438)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Z as default};
