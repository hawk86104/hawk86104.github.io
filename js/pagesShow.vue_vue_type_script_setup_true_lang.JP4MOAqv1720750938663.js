import{a5 as t,ca as n,cb as o,cc as e,cd as r,C as i,k as u,bR as s,aa as a,bS as c}from"./three.c_4mN3mZ1720750938663.js";import{f as l,r as f,d as p}from"./@tresjs.toBU36DO1720750938663.js";import{C as d}from"./three-custom-shader-material.vDIhSa4e1720750938663.js";import"./object-hash.uK40h2Gd1720750938663.js";import"./@amap.aVWyhucH1720750938663.js";import"./glsl-tokenizer.bTdSVbty1720750938663.js";import{d as h,b as m,a2 as y,w as g,o as w,D as v,u as b,r as _,a3 as I,e as C,f as x,g as M,J as T,j as S,aj as j,ak as O,F as R,I as A,G as B,m as k}from"./@vue.ApkyOKE71720750938663.js";!function(t,n){const o=P,e=z();for(;;)try{if(207754===-parseInt(o(167))/1*(-parseInt(o(165))/2)+parseInt(o(175))/3+-parseInt(o(155))/4*(-parseInt(o(146))/5)+parseInt(o(149))/6+-parseInt(o(153))/7*(-parseInt(o(177))/8)+-parseInt(o(151))/9+-parseInt(o(152))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=P,n=new RegExp(t(144)),o=new RegExp(t(143),"i"),e=H(t(171));n[t(140)](e+t(141))&&o[t(140)](e+"input")?H():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[P(142)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function P(t,n){const o=z();return(P=function(t,n){return o[t-=139]})(t,n)}function z(){const t=["toString","459252gbprxC","debu","9944vvQMNI","exception","test","chain","apply","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","function *\\( *\\)","LANDMASS","703975KmvdGs","return (function() ","console","183768vWxqtQ","stateObject","20142JmJTtL","7795660XHKxKq","2051zTxJUm","constructor","8lodkCB","while (true) {}","trace","warn","string","name","length","__proto__","ROADS","error","320114kgnGth","bind","1wsOtUI","log","call","action","init","CITY_UNTRIANGULATED","gger"];return(z=function(){return t})()}G(void 0,(function(){const t=P;let n;try{n=Function(t(147)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(148)]=n[t(148)]||{},e=[t(168),t(158),"info",t(164),t(139),"table",t(157)];for(let i=0;i<e[t(161)];i++){const n=G[t(154)].prototype[t(166)](G),r=e[i],u=o[r]||n;n[t(162)]=G.bind(G),n[t(174)]=u[t(174)][t(166)](u),o[r]=n}}))();const F=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=P;t[r(160)]===r(172)&&(n=t),t.name===r(145)&&(o=t),t[r(160)]===r(163)&&(e=t)})),{model:t,city:n,land:o,roads:e}};function H(t){function n(t){const o=P;if(typeof t===o(159))return function(t){}[o(154)](o(156)).apply("counter");1!==(""+t/t)[o(161)]||t%20==0?function(){return!0}[o(154)](o(176)+"gger")[o(169)](o(170)):function(){return!1}[o(154)]("debu"+o(173)).apply(o(150)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=$;!function(t,n){const o=$,e=Q();for(;;)try{if(903586===parseInt(o(263))/1*(parseInt(o(267))/2)+-parseInt(o(260))/3+-parseInt(o(225))/4+-parseInt(o(235))/5+parseInt(o(275))/6*(-parseInt(o(276))/7)+-parseInt(o(286))/8+-parseInt(o(243))/9*(-parseInt(o(272))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(240)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){D(this,(function(){const t=$,n=new RegExp(t(253)),o=new RegExp(t(270),"i"),e=U(t(232));n[t(234)](e+"chain")&&o.test(e+t(236))?U():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(240)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=$;let n;try{n=Function(t(281)+t(279)+");")()}catch(r){n=window}const o=n[t(221)]=n[t(221)]||{},e=[t(251),t(269),"info",t(226),t(287),t(277),"trace"];for(let i=0;i<e[t(224)];i++){const n=Z[t(238)][t(259)].bind(Z),r=e[i],u=o[r]||n;n[t(262)]=Z[t(231)](Z),n[t(271)]=u[t(271)][t(231)](u),o[r]=n}}))();const W=[L(237)];function $(t,n){const o=Q();return($=function(t,n){return o[t-=221]})(t,n)}const J=h({__name:L(265),props:{model:{},bulidingsColor:{default:L(266)},landColor:{default:L(257)},topColor:{default:L(273)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=L,e=n,r=m(0),i=e[o(249)][o(228)];i[o(222)]=1001;const u=e[o(249)][o(229)];(()=>{const n=o,{geometry:u}=i;u[n(250)](),u[n(239)]();const{max:s,min:a}=u[n(248)];if(i[n(288)][n(285)])return;const c=new d({baseMaterial:i[n(288)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(244)])(e[n(283)])},uOpacity:{value:e[n(230)]},uLightColor:{value:new(t[n(244)])("#ffffff")},uTopColor:{value:new(t[n(244)])(e[n(254)])},uTime:r,uGradient:{value:e.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(227)]});i.material[n(278)](),i[n(288)]=c})();const{onLoop:s}=f();s((({delta:t})=>{r[o(241)]+=t})),y((()=>{const n=o;e.bulidingsColor&&i.material[n(261)][n(256)][n(241)][n(233)](e[n(283)]),e[n(268)]&&((n,r)=>{const i=o;let s;"cu"===n||n===i(229)&&(s=Array.isArray(u.material)?u[i(288)]:[u[i(288)]],s.forEach((n=>{const o=i;n[r].setStyle(e.landColor),n[o(252)]=t[o(227)]})))})(n(229),n(274)),e.opacity&&(i[n(288)][n(261)][n(255)][n(241)]=e.opacity)})),g(e,((t,n)=>{const e=o;i[e(288)][e(261)][e(258)][e(241)]=t[e(246)]}));const a=e[o(249)][o(249)][o(264)]();return(t,n)=>(w(),v("primitive",{object:b(a)},null,8,W))}});function Q(){const t=["7onyuhj","table","dispose",'{}.constructor("return this")( )',"counter","return (function() ","while (true) {}","bulidingsColor","gger","__csm","12102384SFsgyr","exception","material","console","renderOrder","debu","length","5828520sdhQTe","error","DoubleSide","city","land","opacity","bind","init","setStyle","test","3390760IdfsEW","input","object","constructor","computeBoundingSphere","apply","value","call","45mbNYXO","Color","stateObject","gradient","action","boundingBox","model","computeBoundingBox","log","side","function *\\( *\\)","topColor","uOpacity","uColor","#112233","uGradient","prototype","3100548rGYalI","uniforms","__proto__","4516iIyTFA","clone","buildingsModelCustomShader","#e523ff","748JoQSfo","landColor","warn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","toString","8218030SdPPPo","#ffff00","color","1276902PJuHZN"];return(Q=function(){return t})()}function U(t){function n(t){const o=$;if("string"==typeof t)return function(t){}.constructor(o(282))[o(240)](o(280));1!==(""+t/t)[o(224)]||t%20==0?function(){return!0}[o(238)](o(223)+"gger")[o(242)](o(247)):function(){return!1}[o(238)]("debu"+o(284)).apply(o(245)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const q=X;!function(t,n){const o=X,e=K();for(;;)try{if(331743===parseInt(o(516))/1+parseInt(o(488))/2*(-parseInt(o(528))/3)+-parseInt(o(473))/4+-parseInt(o(498))/5*(parseInt(o(500))/6)+parseInt(o(522))/7*(parseInt(o(482))/8)+parseInt(o(526))/9+parseInt(o(478))/10*(-parseInt(o(496))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const N=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){N(this,(function(){const t=X,n=new RegExp(t(510)),o=new RegExp(t(494),"i"),e=nt("init");n[t(523)](e+t(515))&&o[t(523)](e+t(475))?nt():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(479)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function K(){const t=["trace","table","constructor","3958381Fysvpq","test","prototype","resolution","2940345RENAKa","length","4191YPGIEe","opacity","console","694124CkTJZH","Wireframe","input","innerWidth","log","9320yJbIeU","apply","matrix","color","8pRkTxk","gger","return (function() ","object","fromEdgesGeometry","bind","904rVTnrq","string","material","exception","builds","applyMatrix4","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","innerHeight","957jibkBu","width","5RKSHQG","uniforms","364188MlxuQI","set","call","buildingsLines","toString","uColor",'{}.constructor("return this")( )',"uOpacity","counter","linewidth","function *\\( *\\)"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","geometry","style","value","chain","386312yngejE","debu","clone"];return(K=function(){return t})()}Y(void 0,(function(){const t=X;let n;try{n=Function(t(484)+t(506)+");")()}catch(r){n=window}const o=n[t(472)]=n[t(472)]||{},e=[t(477),"warn","info","error",t(491),t(520),t(519)];for(let i=0;i<e[t(527)];i++){const n=Y[t(521)][t(524)][t(487)](Y),r=e[i],u=o[r]||n;n.__proto__=Y.bind(Y),n[t(504)]=u[t(504)].bind(u),o[r]=n}}))();const V=[q(485)];function X(t,n){const o=K();return(X=function(t,n){return o[t-=471]})(t,n)}const tt=h({__name:q(503),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:q(474)}},setup(t){const s=q,a=t;let c=null,l=null;if(a[s(513)]===s(474)){const t=new n(a[s(492)].geometry);let i=(new o)[s(486)](t),u=new e({color:a[s(481)],linewidth:a[s(497)],opacity:a.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[s(525)][s(501)](window[s(476)],window[s(495)]),c=new r(i,u),c.applyMatrix4(a[s(492)].matrix[s(518)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(a[s(481)])},uOpacity:{value:a[s(471)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:s(511)};const t=new n(a.builds[s(512)]),o=new u(l);c=new LineSegments(t,o),c[s(493)](a[s(492)][s(480)][s(518)]()),c.material[s(509)]=a[s(497)],c.renderOrder=1e3}return y((()=>{const t=s;"Shader"===a[t(513)]&&(a[t(481)]&&(l[t(499)][t(505)].value=new i(a[t(481)])),a.opacity&&(l.uniforms[t(507)][t(514)]=a[t(471)])),a[t(513)]===t(474)&&(a.color&&(c[t(490)].color=new i(a[t(481)])),a[t(471)]&&(c[t(490)][t(471)]=a[t(471)])),a[t(497)]&&(c[t(490)].linewidth=a.width)})),(t,n)=>(w(),v("primitive",{object:b(c)},null,8,V))}});function nt(t){function n(t){const o=X;if(typeof t===o(489))return function(t){}[o(521)]("while (true) {}")[o(479)](o(508));1!==(""+t/t).length||t%20==0?function(){return!0}[o(521)](o(517)+"gger")[o(502)]("action"):function(){return!1}[o(521)](o(517)+o(483))[o(479)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function ot(){const t=["model",'{}.constructor("return this")( )',"console","function *\\( *\\)","warn","bind","debu","error","log","554EIjOiS","ability","9445849czrgqz","TresGridHelper","34585BuvaAE","table","trace","#000000","pagesShow","exception","showBuildings","counter","5613DmaYTq","1113096calmUC","TresCanvas","test","builds","return (function() ","244GQdRFP","8829252UtQrqh","length","gger","init","disableRender","apply","info","#000","call","TresAmbientLight","stateObject","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","8HMtGef","TresAxesHelper","input","toString","constructor","chain","action","8225190ewOeVs","autoRotate","20511950BLySuY"];return(ot=function(){return t})()}const et=lt;!function(t,n){const o=lt,e=ot();for(;;)try{if(704815===parseInt(o(258))/1+-parseInt(o(245))/2*(parseInt(o(257))/3)+parseInt(o(213))/4*(parseInt(o(249))/5)+parseInt(o(233))/6+-parseInt(o(247))/7*(-parseInt(o(226))/8)+-parseInt(o(214))/9+-parseInt(o(235))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=lt,n=new RegExp(t(239)),o=new RegExp(t(225),"i"),e=pt(t(217));n[t(260)](e+t(231))&&o[t(260)](e+t(228))?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=lt,n=function(){const t=lt;let n;try{n=Function(t(212)+t(237)+");")()}catch(o){n=window}return n}(),o=n[t(238)]=n[t(238)]||{},e=[t(244),t(240),t(220),t(243),t(254),t(250),t(251)];for(let r=0;r<e[t(215)];r++){const n=it[t(230)].prototype.bind(it),i=e[r],u=o[i]||n;n.__proto__=it[t(241)](it),n[t(229)]=u[t(229)][t(241)](u),o[i]=n}}))();const ut=T(et(223),{color:"#ffffff"},null,-1),st=T("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),at={key:1,args:[1e3],position:[0,19,0]},ct={key:2,args:[6e3,100],position:[0,19,0]};function lt(t,n){const o=ot();return(lt=function(t,n){return o[t-=212]})(t,n)}const ft=h({__name:et(253),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=_({clearColor:n(252),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:c,disableRender:r[n(218)]}),u=_({autoRotate:r[n(234)],enableDamping:!0});let l=null;r[n(255)]&&([o,e]=I((()=>F())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,s=C(e(259));return w(),x(s,k({ref_key:"tcRef",ref:d},i,{"window-size":""}),{default:M((()=>[T("TresPerspectiveCamera",{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(p),j(O(u)),null,16),ut,st,r[e(255)]&&b(l)?(w(),v(R,{key:0},[S(J,{model:b(l)},null,8,[e(236)]),S(tt,{builds:b(l).city,color:e(221)},null,8,[e(261)])],64)):A("",!0),B(t.$slots,e(246)),r.showAxesHelper?(w(),v(e(227),at)):A("",!0),r.showGridHelper?(w(),v(e(248),ct)):A("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=lt;if("string"==typeof t)return function(t){}[o(230)]("while (true) {}")[o(219)](o(256));1!==(""+t/t)[o(215)]||t%20==0?function(){return!0}[o(230)](o(242)+o(216))[o(222)](o(232)):function(){return!1}[o(230)](o(242)+o(216))[o(219)](o(224)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{J as _,tt as a,ft as b,F as l};
