import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.u0s8eg2Z1721048663624.js";import{r as o}from"./@tresjs.Xiq_TH801721048663624.js";import{C as e}from"./three-custom-shader-material.AmV1WVUo1721048663624.js";import"./object-hash.E5Z0NA4F1721048663624.js";import{a5 as r,C as i,ca as u,k as c,a$ as s}from"./three.HEgnMaTu1721048663624.js";import"./@amap.IXBtourJ1721048663624.js";import"./glsl-tokenizer.bhImRDDx1721048663624.js";import{d as a,a2 as l,w as f,o as p,D as d,u as m,a3 as v,r as g,f as h,g as y,j as C,m as w}from"./@vue.ApkyOKE71721048663624.js";import{P as _}from"./tweakpane.yHWGBmom1721048663624.js";import"./@vueuse.2IVIyoVR1721048663624.js";import"./glsl-token-string.fSxiDrag1721048663624.js";import"./glsl-token-functions.tTTlKCMK1721048663624.js";import"./jszip.PK6xEuxJ1721048663624.js";const b=I;!function(t,n){const o=I,e=M();for(;;)try{if(348787===parseInt(o(205))/1*(parseInt(o(180))/2)+parseInt(o(172))/3+parseInt(o(178))/4*(parseInt(o(235))/5)+parseInt(o(221))/6+parseInt(o(171))/7+-parseInt(o(193))/8*(parseInt(o(202))/9)+-parseInt(o(227))/10*(-parseInt(o(206))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(200)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function I(t,n){const o=M();return(I=function(t,n){return o[t-=171]})(t,n)}!function(){x(this,(function(){const t=I,n=new RegExp(t(192)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=P(t(232));n[t(229)](e+t(204))&&o[t(229)](e+t(186))?P():e("0")}))()}();const j=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(200)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(){const t=["4VPNrtq","action","11454rcxkrL","primitive","city","#e523ff","constructor","side","input","renderOrder","object","isArray","while (true) {}","console","function *\\( *\\)","925264aNhxKy","computeBoundingBox","#ffff00","land","topColor","boundingBox","computeBoundingSphere","apply","string","45CwGWBC","dispose","chain","10LbHFuF","3592336qPIovj","log","debu","length","toString","children","Color","__csm","DoubleSide",'{}.constructor("return this")( )',"clone","value","material","MeshBasicMaterial","uColor","318330fzvIHv","bulidingsColor","bind","counter","gradient","uniforms","10PiDxLE","forEach","test","setStyle","gger","init","info","uTime","541465odDrLN","opacity","prototype","trace","240961PtmzSB","1042380LxSGte","table","error","model","uOpacity","stateObject"];return(M=function(){return t})()}j(void 0,(function(){const t=I,n=function(){const t=I;let n;try{n=Function("return (function() "+t(215)+");")()}catch(o){n=window}return n}(),o=n[t(191)]=n[t(191)]||{},e=[t(207),"warn",t(233),t(174),"exception",t(173),t(238)];for(let r=0;r<e[t(209)];r++){const n=j.constructor[t(237)][t(223)](j),i=e[r],u=o[i]||n;n.__proto__=j[t(223)](j),n[t(210)]=u[t(210)][t(223)](u),o[i]=n}}))();const S=[b(188)],T=a({__name:"bModel",props:{model:{},bulidingsColor:{default:b(183)},landColor:{default:"#112233"},topColor:{default:b(195)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,i=t,u=i.model[n(182)];i[n(175)][n(175)][n(211)][0][n(218)]=new(r[n(219)])({color:"#ffff00"}),u[n(187)]=1001;const c=i[n(175)][n(196)];(()=>{const t=n,{geometry:o}=u;o[t(194)](),o[t(199)]();const{max:c,min:s}=o[t(198)];if(u[t(218)][t(213)])return;const a=new e({baseMaterial:u[t(218)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(212)])(i[t(222)])},uOpacity:{value:i[t(236)]},uLightColor:{value:new(r[t(212)])("#ffffff")},uTopColor:{value:new(r[t(212)])(i[t(197)])},uTime:{value:0},uGradient:{value:i[t(225)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(214)]});u[t(218)][t(203)](),u[t(218)]=a})();const{onLoop:s}=o();s((({delta:t})=>{const o=n;u[o(218)][o(226)][o(234)][o(217)]+=t})),l((()=>{const t=n;i[t(222)]&&u[t(218)][t(226)][t(220)][t(217)][t(230)](i[t(222)]),i.landColor&&((t,o)=>{const e=n;let u;"cu"===t||"land"===t&&(u=Array[e(189)](c[e(218)])?c[e(218)]:[c[e(218)]],u[e(228)]((t=>{const n=e;t[o].setStyle(i.landColor),t[n(185)]=r[n(214)]})))})(t(196),"color"),i[t(236)]&&(u.material[t(226)][t(176)].value=i[t(236)])})),f(i,((t,o)=>{const e=n;u[e(218)][e(226)].uGradient[e(217)]=t[e(225)]}));const a=i[n(175)][n(175)][n(216)]();return(t,o)=>{const e=n;return p(),d(e(181),{object:m(a)},null,8,S)}}});function P(t){function n(t){const o=I;if(typeof t===o(201))return function(t){}[o(184)](o(190))[o(200)](o(224));1!==(""+t/t)[o(209)]||t%20==0?function(){return!0}[o(184)](o(208)+o(231)).call(o(179)):function(){return!1}[o(184)](o(208)+"gger").apply(o(177)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function O(t,n){const o=F();return(O=function(t,n){return o[t-=368]})(t,n)}const L=O;function F(){const t=["function *\\( *\\)","281701RyTMCy","#FFF","bLine","matrix","log","counter","5aZzSpi","applyMatrix4","width","return (function() ","gger","exception","input","color","11uoJEnE","uTime","stateObject","test","srcColor","24TiuAGx","uGradual","783530LmYRky","7803972mXVSdY","clone","#000","4187148UWSxPE","while (true) {}","value","3qNHKeb","speed","primitive","apply","35194hXpLjO","debu","200748DktFLc","trace","info","call","warn","material","uScale","uColor","18wiPDkE","prototype","object","bind","init","length","1043830VKUgmT","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","console","scale",'{}.constructor("return this")( )',"uniforms","constructor","gradual","toString","linewidth"];return(F=function(){return t})()}!function(t,n){const o=O,e=F();for(;;)try{if(358488===-parseInt(o(423))/1*(-parseInt(o(390))/2)+-parseInt(o(386))/3*(-parseInt(o(392))/4)+-parseInt(o(379))/5+parseInt(o(383))/6+parseInt(o(417))/7*(parseInt(o(377))/8)+parseInt(o(400))/9*(parseInt(o(406))/10)+parseInt(o(372))/11*(-parseInt(o(380))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=O,n=new RegExp(t(416)),o=new RegExp(t(407),"i"),e=B(t(404));n[t(375)](e+"chain")&&o.test(e+t(370))?B():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[O(389)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=O,n=function(){const t=O;let n;try{n=Function(t(426)+t(410)+");")()}catch(o){n=window}return n}(),o=n[t(408)]=n[t(408)]||{},e=[t(421),t(396),t(394),"error",t(369),"table",t(393)];for(let r=0;r<e[t(405)];r++){const n=z[t(412)][t(401)].bind(z),i=e[r],u=o[i]||n;n.__proto__=z[t(403)](z),n[t(414)]=u.toString[t(403)](u),o[i]=n}}))();const R=[L(402)],A=a({__name:L(419),props:{builds:{},color:{default:L(418)},srcColor:{default:L(382)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=L,e=t;let r=null;const a={transparent:!0,uniforms:{uColor:{value:new i(e.color)},uSrcColor:{value:new i(e[n(376)])},uScale:{value:e.scale},uTime:{value:0},uGradual:{value:e[n(413)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e.builds.geometry)[n(381)]();f=f[n(424)](e.builds[n(420)]);const v=new c(a);r=new s(f,v),r[n(397)][n(415)]=e[n(425)],r.renderOrder=1e3,l((()=>{const t=n;e.color&&(a.uniforms[t(399)][t(385)]=new i(e[t(371)])),e.srcColor&&(a[t(411)].uSrcColor[t(385)]=new i(e[t(376)])),e.scale&&(a[t(411)][t(398)].value=e[t(409)]),e[t(413)]&&(a.uniforms[t(378)][t(385)]=e[t(413)])}));const{onLoop:g}=o();return g((({delta:t})=>{const o=n;a[o(411)].uTime[o(385)]+=t*e[o(387)],a[o(411)][o(373)][o(385)]%=1})),(t,o)=>{const e=n;return p(),d(e(388),{object:m(r)},null,8,R)}}});function B(t){function n(t){const o=O;if("string"==typeof t)return function(t){}[o(412)](o(384))[o(389)](o(422));1!==(""+t/t)[o(405)]||t%20==0?function(){return!0}[o(412)]("debu"+o(368))[o(395)]("action"):function(){return!1}.constructor(o(391)+o(368))[o(389)](o(374)),n(++t)}try{if(t)return n;n(0)}catch(o){}}!function(t,n){const o=G,e=$();for(;;)try{if(271517===parseInt(o(190))/1*(-parseInt(o(188))/2)+-parseInt(o(208))/3+-parseInt(o(209))/4*(-parseInt(o(203))/5)+-parseInt(o(212))/6*(parseInt(o(218))/7)+-parseInt(o(192))/8+-parseInt(o(232))/9*(parseInt(o(194))/10)+parseInt(o(217))/11*(parseInt(o(191))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(198)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=G,n=new RegExp(t(189)),o=new RegExp(t(193),"i"),e=H(t(199));n[t(205)](e+t(214))&&o[t(205)](e+t(195))?H():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(198)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(t,n){const o=$();return(G=function(t,n){return o[t-=182]})(t,n)}D(void 0,(function(){const t=G;let n;try{n=Function(t(222)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n[t(231)]||{},e=[t(230),t(215),t(206),t(226),"exception","table","trace"];for(let i=0;i<e[t(221)];i++){const n=D[t(223)][t(184)][t(216)](D),r=e[i],u=o[r]||n;n[t(207)]=D[t(216)](D),n[t(229)]=u[t(229)].bind(u),o[r]=n}}))();const Z=a({__name:"buildingsEffectA",async setup(o){const e=G;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=g({color:"#FFF",srcColor:e(228),scale:2e3,gradual:6.6,speed:.3}),s=new _({title:e(187),expanded:!0});return s[e(204)](c,"srcColor",{label:e(186)}),s[e(204)](c,e(210),{label:e(202)}),s[e(204)](c,"speed",{label:"速度",min:.1,max:1,step:.1}),s[e(204)](c,e(227),{label:e(183),min:10,max:2e3,step:10}),s[e(204)](c,e(185),{label:"扩散系数",min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[C(T,{model:m(u),bulidingsColor:r(182),landColor:r(219),topColor:r(225)},null,8,[r(197)]),C(A,w({builds:m(u)[r(211)]},c),null,16,[r(201)])])),_:1})}}});function $(){const t=["#112233","stateObject","length","return (function() ","constructor","while (true) {}","#999","error","scale","#000","toString","log","console","2056527ArOtes","#000000","最大扩散","prototype","gradual","线原颜色","效果参数","76324yQLxnh","function *\\( *\\)","9kNMaVR","39180GZWKtS","284184ZziDId","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","20mIlfDM","input","string","model","apply","init","debu","builds","线扫颜色","1150210IssZRi","addBinding","test","info","__proto__","31281NRdZRY","8nHTjaA","color","city","326946oOJejx","counter","chain","warn","bind","3685oPjTnN","56LsVRJC"];return($=function(){return t})()}function H(t){function n(t){const o=G;if(typeof t===o(196))return function(t){}[o(223)](o(224))[o(198)](o(213));1!==(""+t/t)[o(221)]||t%20==0?function(){return!0}[o(223)](o(200)+"gger").call("action"):function(){return!1}[o(223)](o(200)+"gger")[o(198)](o(220)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Z as default};
