import{b as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.gP9bIAYD1721721076264.js";import{bX as t,a6 as e,bV as o,c5 as i,k as r,cg as s}from"./three.fnkrvySq1721721076264.js";import{p as u,$ as a}from"./@tresjs.tWkmYPO61721721076264.js";import{d as c,a1 as l,r as p,o as f,f as d,g as m,j as v,aj as h,ak as P}from"./@vue.Q1VpS3901721721076264.js";import{P as g}from"./tweakpane.yHWGBmom1721721076264.js";import"./three-custom-shader-material.UAECXI501721721076264.js";import"./object-hash.n-lQHd521721721076264.js";import"./@amap.b3gYyCW_1721721076264.js";import"./jszip.vimxEq251721721076264.js";import"./glsl-tokenizer.rVSxTaVo1721721076264.js";import"./glsl-token-string.qKZvKI-H1721721076264.js";import"./glsl-token-functions.nzsekdRK1721721076264.js";import"./@vueuse._hUvP73U1721721076264.js";function x(){const n=["uniforms","speed","info","445319ntEhmn","2379300wQUcoM","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","depthTexture",'{}.constructor("return this")( )',"trace","bind","stateObject","constructor","return (function() ","init","error","height","log","1005530TqDbgj","4KOGHyl","uPosition","chain","call","gger","6sHdyuq","input","5249685uAUQNR","buildingsPassA","__proto__","warn","action","uWidth","table","debu","48902BIncXy","33063036ToGyBu","DepthTexture","value","#FFF","projectionMatrixInverse","3850677PsrwcY","length","apply","set","20ExMmiM","prototype","13JkCAID","6zMXUjF","addPass","depthBuffer","Color","test","uColor","color","counter","Vector2","uScalenum","console","exception","uScaleone","width","material","readBuffer","8VbgkXJ"];return(x=function(){return n})()}const w=b;!function(n,t){const e=b,o=x();for(;;)try{if(582520===-parseInt(e(108))/1+parseInt(e(124))/2*(-parseInt(e(137))/3)+parseInt(e(109))/4*(-parseInt(e(116))/5)+parseInt(e(114))/6*(-parseInt(e(157))/7)+parseInt(e(153))/8*(parseInt(e(130))/9)+parseInt(e(134))/10*(-parseInt(e(158))/11)+-parseInt(e(125))/12*(-parseInt(e(136))/13))break;o.push(o.shift())}catch(i){o.push(o.shift())}}();const S=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[b(132)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){S(this,(function(){const n=b,t=new RegExp("function *\\( *\\)"),e=new RegExp(n(159),"i"),o=j(n(104));t[n(141)](o+n(111))&&e.test(o+n(115))?j():o("0")}))()}();const y=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[b(132)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function b(n,t){const e=x();return(b=function(n,t){return e[n-=100]})(n,t)}y(void 0,(function(){const n=b;let t;try{t=Function(n(103)+n(161)+");")()}catch(i){t=window}const e=t[n(147)]=t[n(147)]||{},o=[n(107),n(119),n(156),n(105),n(148),n(122),n(162)];for(let r=0;r<o.length;r++){const t=y[n(102)][n(135)].bind(y),i=o[r],s=e[i]||t;t[n(118)]=y[n(100)](y),t.toString=s.toString[n(100)](s),e[i]=t}}))();const I=c({__name:w(117),props:{color:{default:w(128)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(n){const c=n,{renderer:p,scene:f,camera:d,sizes:m}=u();let v,h=0,P=null,g=null;l((()=>{const n=b;m[n(150)][n(127)]&&(v=m[n(150)][n(127)],h=m[n(106)][n(127)],(()=>{const n=b;P=new t(p[n(127)]);const u=new(e[n(126)])(v,h);P[n(152)][n(139)]=!0,P[n(152)][n(160)]=u;const a=new o(f.value,d[n(127)]);P.addPass(a),g=new i(new r({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:u},uProjectionInverse:{value:d.value[n(129)]},uMatrixWorld:{value:d[n(127)].matrixWorld},uColor:{value:new(e[n(140)])(c.color)},uScalenum:{value:c[n(146)]},uScaleone:{value:c[n(149)]},uWidth:{value:c[n(121)]},uPosition:{value:new(e[n(145)])(c[n(110)].x,c.uPosition.y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),P[n(138)](g);const l=new i(s);P.addPass(l)})())}));const{onLoop:x}=a();return x((({elapsed:n})=>{const t=b;P&&(P.render(),g[t(154)].time[t(127)]+=c[t(155)]/60)})),l((()=>{const n=b;g&&(c[n(143)]&&(g[n(151)].uniforms[n(142)][n(127)]=new(e[n(140)])(c[n(143)])),c[n(146)]&&(g.material[n(154)][n(146)][n(127)]=c.uScalenum),c[n(149)]&&(g[n(151)][n(154)].uScaleone.value=c[n(149)]),c[n(121)]&&(g.material[n(154)].uWidth[n(127)]=c[n(121)]),c.uPosition&&g.material[n(154)][n(110)][n(127)][n(133)](c.uPosition.x,c[n(110)].y))})),(n,t)=>null}});function j(n){function t(n){const e=b;if("string"==typeof n)return function(n){}[e(102)]("while (true) {}")[e(132)](e(144));1!==(""+n/n)[e(131)]||n%20==0?function(){return!0}[e(102)](e(123)+e(113))[e(112)](e(120)):function(){return!1}[e(102)](e(123)+"gger")[e(132)](e(101)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const _=z;function W(){const n=["15ouyikO","9450pNxYeY","gger","bind","input","1192378XFTBym","250UDHgUK","buildingsPassA","后期效果","constructor","table","stateObject","trace","toString","prototype","apply","debu","exception","return (function() ","addBinding","inline","speed","uScalenum","63sSfoEY","10830nPeCCM","590992FSHmqj","color","while (true) {}","action","test","error","4618712Wubvgb","4937812EpggCr","string","734390xiCCNU","圈颜色","console","单条圈宽度","init","length","#00b4fb","uPosition","140KSkNQo","function *\\( *\\)"];return(W=function(){return n})()}function z(n,t){const e=W();return(z=function(n,t){return e[n-=237]})(n,t)}!function(n,t){const e=z,o=W();for(;;)try{if(693252===parseInt(e(278))/1+parseInt(e(242))/2*(parseInt(e(268))/3)+parseInt(e(276))/4+-parseInt(e(244))/5*(-parseInt(e(245))/6)+parseInt(e(275))/7+parseInt(e(269))/8*(parseInt(e(267))/9)+-parseInt(e(250))/10*(parseInt(e(249))/11))break;o.push(o.shift())}catch(i){o.push(o.shift())}}();const D=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){D(this,(function(){const n=z,t=new RegExp(n(243)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=F(n(238));t[n(273)](o+"chain")&&e[n(273)](o+n(248))?F():o("0")}))()}();const k=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[z(259)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();k(void 0,(function(){const n=z,t=function(){const n=z;let t;try{t=Function(n(262)+'{}.constructor("return this")( ));')()}catch(e){t=window}return t}(),e=t[n(280)]=t.console||{},o=["log","warn","info",n(274),n(261),n(254),n(256)];for(let i=0;i<o.length;i++){const t=k[n(253)][n(258)].bind(k),r=o[i],s=e[r]||t;t.__proto__=k[n(247)](k),t[n(257)]=s[n(257)][n(247)](s),e[r]=t}}))();const C=c({__name:_(251),setup(t){const e=_,o=p({color:e(240),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),i=new g({title:e(252),expanded:!0});return i[e(263)](o,e(270),{label:e(279)}),i.addBinding(o,e(266),{label:"最大范围",min:1,max:500,step:10}),i[e(263)](o,"uScaleone",{label:"单条圈间距",min:1,max:100,step:1}),i[e(263)](o,"uWidth",{label:e(237),min:0,max:1,step:.01}),i[e(263)](o,e(265),{label:"速度",min:1,max:20,step:1}),i[e(263)](o,e(241),{picker:e(264),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(t,e)=>(f(),d(n,{disableRender:!0,showAxesHelper:!1},{ability:m((()=>[v(I,h(P(o)),null,16)])),_:1}))}});function F(n){function t(n){const e=z;if(typeof n===e(277))return function(n){}[e(253)](e(271)).apply("counter");1!==(""+n/n)[e(239)]||n%20==0?function(){return!0}[e(253)](e(260)+e(246)).call(e(272)):function(){return!1}[e(253)](e(260)+e(246))[e(259)](e(255)),t(++n)}try{if(n)return t;t(0)}catch(e){}}export{C as default};
