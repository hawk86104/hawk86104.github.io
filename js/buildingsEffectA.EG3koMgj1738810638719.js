import{P as t}from"./tweakpane.yDiyAAkA1738810638719.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.Y1YyTabW1738810638719.js";import{e}from"./@tresjs.8axf5yqM1738810638719.js";import{z as r}from"./three-custom-shader-material.srZQa-4o1738810638719.js";import{_ as i,C as u,ck as c,l as a,b9 as s}from"./three.6w8Allze1738810638719.js";import{d as l,a2 as f,w as p,o as d,H as m,u as v,a3 as g,r as h,f as y,g as w,j as C,m as _}from"./@vue.NRI7TcgI1738810638719.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1738810638719.js";import"./@vueuse.hJpps2zM1738810638719.js";const b=I;!function(t,n){const o=I,e=T();for(;;)try{if(879453===parseInt(o(269))/1*(-parseInt(o(263))/2)+-parseInt(o(305))/3+-parseInt(o(301))/4+parseInt(o(314))/5*(-parseInt(o(296))/6)+parseInt(o(266))/7+parseInt(o(302))/8*(-parseInt(o(284))/9)+-parseInt(o(317))/10*(-parseInt(o(307))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(298)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function I(t,n){const o=T();return(I=function(t,n){return o[t-=253]})(t,n)}!function(){x(this,(function(){const t=I,n=new RegExp(t(295)),o=new RegExp(t(261),"i"),e=O(t(318));n.test(e+t(315))&&o[t(297)](e+t(283))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(298)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=I,n=function(){const t=I;let n;try{n=Function(t(303)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(309)]||{},e=[t(272),t(280),t(287),t(300),"exception",t(310),t(290)];for(let r=0;r<e[t(316)];r++){const n=M[t(278)][t(313)][t(265)](M),i=e[r],u=o[i]||n;n.__proto__=M[t(265)](M),n.toString=u[t(264)][t(265)](u),o[i]=n}}))();const S=[b(308)],j=l({__name:b(279),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:"#112233"},topColor:{default:b(306)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,c=o[n(319)].city;o.model.model[n(277)][0][n(262)]=new(i[n(281)])({color:n(306)}),c.renderOrder=1001;const a=o[n(319)][n(282)];(()=>{const t=n,{geometry:e}=c;e[t(260)](),e.computeBoundingSphere();const{max:a,min:s}=e[t(294)];if(c[t(262)][t(259)])return;const l=new r({baseMaterial:c[t(262)],vertexShader:t(274),fragmentShader:t(256),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(o[t(254)])},uOpacity:{value:o[t(304)]},uLightColor:{value:new(i[t(258)])("#ffffff")},uTopColor:{value:new(i[t(258)])(o[t(267)])},uTime:{value:0},uGradient:{value:o[t(255)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(275)]});c[t(262)][t(257)](),c[t(262)]=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(262)].uniforms[o(299)].value+=t})),f((()=>{const t=n;o[t(254)]&&c[t(262)][t(311)][t(291)][t(286)][t(268)](o[t(254)]),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||"land"===t&&(u=Array[r(289)](a[r(262)])?a[r(262)]:[a[r(262)]],u[r(271)]((t=>{const n=r;t[e][n(268)](o[n(292)]),t[n(253)]=i[n(275)]})))})(t(282),"color"),o[t(304)]&&(c[t(262)][t(311)].uOpacity[t(286)]=o[t(304)])})),p(o,((t,o)=>{const e=n;c[e(262)][e(311)][e(273)].value=t[e(255)]}));const l=o[n(319)][n(319)][n(270)]();return(t,o)=>{const e=n;return d(),m(e(285),{object:v(l)},null,8,S)}}});function T(){const t=["40350jmtgnm","init","model","side","bulidingsColor","gradient","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","dispose","Color","__csm","computeBoundingBox","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","material","227024vKesmS","toString","bind","5701290nardsN","topColor","setStyle","5faZMqe","clone","forEach","log","uGradient","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","DoubleSide","gger","children","constructor","bModel","warn","MeshBasicMaterial","land","input","9dQZHXX","primitive","value","info","action","isArray","trace","uColor","landColor","debu","boundingBox","function *\\( *\\)","103848IwyKwB","test","apply","uTime","error","4842700TAKnej","2667464JieAcL","return (function() ","opacity","1290198RSrpFL","#ffff00","8569yuqNPJ","object","console","table","uniforms","while (true) {}","prototype","155ZIAjVG","chain","length"];return(T=function(){return t})()}function O(t){function n(t){const o=I;if("string"==typeof t)return function(t){}.constructor(o(312))[o(298)]("counter");1!==(""+t/t)[o(316)]||t%20==0?function(){return!0}[o(278)]("debu"+o(276)).call(o(288)):function(){return!1}.constructor(o(293)+"gger")[o(298)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=z;!function(t,n){const o=z,e=G();for(;;)try{if(354807===parseInt(o(242))/1+-parseInt(o(264))/2*(parseInt(o(251))/3)+parseInt(o(271))/4+parseInt(o(268))/5*(-parseInt(o(241))/6)+parseInt(o(243))/7+-parseInt(o(266))/8+parseInt(o(281))/9*(parseInt(o(278))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(239)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(237),"i"),e=k(t(265));n[t(254)](e+t(244))&&o[t(254)](e+t(259))?k():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();F(void 0,(function(){const t=z,n=function(){const t=z;let n;try{n=Function(t(285)+t(253)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(289)]||{},e=[t(257),t(235),"info",t(252),t(256),t(273),t(255)];for(let r=0;r<e[t(246)];r++){const n=F[t(280)].prototype[t(267)](F),i=e[r],u=o[i]||n;n.__proto__=F.bind(F),n.toString=u[t(262)][t(267)](u),o[i]=n}}))();const A=[P(279)];function G(){const t=["stateObject","apply","speed","594UzvhjY","253950mKepyD","4043249cbOHBt","chain","clone","length","action","builds","uGradual","uTime","6dxrTLz","error",'{}.constructor("return this")( )',"test","trace","exception","log","matrix","input","debu","while (true) {}","toString","gradual","73442zXVfJk","init","2061816iCtGHS","bind","18660dFBbIo","uniforms","value","461276TpfMFD","gger","table","call","width","uSrcColor","geometry","6620kQGaXA","object","constructor","1476DWvByV","#FFF","uColor","color","return (function() ","primitive","srcColor","string","console","applyMatrix4","warn","uScale","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)"];return(G=function(){return t})()}function z(t,n){const o=G();return(z=function(t,n){return o[t-=235]})(t,n)}const Z=l({__name:"bLine",props:{builds:{},color:{default:P(282)},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(284)])},uSrcColor:{value:new u(o[n(287)])},uScale:{value:o.scale},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(248)][n(277)])[n(245)]();l=l[n(290)](o[n(248)][n(258)]);const p=new a(i);r=new s(l,p),r.material.linewidth=o[n(275)],r.renderOrder=1e3,f((()=>{const t=n;o[t(284)]&&(i[t(269)][t(283)][t(270)]=new u(o[t(284)])),o[t(287)]&&(i[t(269)][t(276)][t(270)]=new u(o[t(287)])),o.scale&&(i[t(269)][t(236)][t(270)]=o.scale),o[t(263)]&&(i[t(269)][t(249)].value=o[t(263)])}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(269)][e(250)][e(270)]+=t*o[e(240)],i[e(269)][e(250)].value%=1})),(t,o)=>{const e=n;return d(),m(e(286),{object:v(r)},null,8,A)}}});function k(t){function n(t){const o=z;if(typeof t===o(288))return function(t){}.constructor(o(261))[o(239)]("counter");1!==(""+t/t)[o(246)]||t%20==0?function(){return!0}[o(280)]("debu"+o(272))[o(274)](o(247)):function(){return!1}[o(280)](o(260)+o(272))[o(239)](o(238)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=L;function L(t,n){const o=R();return(L=function(t,n){return o[t-=218]})(t,n)}!function(t,n){const o=L,e=R();for(;;)try{if(227108===parseInt(o(251))/1+parseInt(o(242))/2*(-parseInt(o(266))/3)+parseInt(o(259))/4+parseInt(o(228))/5*(parseInt(o(220))/6)+-parseInt(o(260))/7*(-parseInt(o(225))/8)+parseInt(o(255))/9+-parseInt(o(271))/10*(parseInt(o(226))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=L,n=new RegExp(t(262)),o=new RegExp(t(233),"i"),e=W(t(223));n[t(256)](e+"chain")&&o[t(256)](e+t(219))?W():e("0")}))()}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(243)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function R(){const t=["constructor","prototype","warn","srcColor","线扫颜色","109790kdGQcq","apply","color","model","gradual","return (function() ","string",'{}.constructor("return this")( )',"city","380771LOmnSm","scale","#112233","#FFF","1584873krZgTh","test","while (true) {}","#999","134584vBgwPG","14jSZElD","扩散系数","function *\\( *\\)","线原颜色","error","action","9SROgpP","bind","addBinding","#000","buildingsEffectA","6393370jpKWHz","__proto__","input","344562kTOZeK","call","#000000","init","stateObject","1303048VFnCyM","11XryHUv","counter","10DKtcFf","gger","builds","效果参数","toString","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","console","length","trace"];return(R=function(){return t})()}H(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(247)+t(249)+");")()}catch(o){n=window}return n}(),o=n[t(234)]=n[t(234)]||{},e=["log",t(239),"info",t(264),"exception","table",t(236)];for(let r=0;r<e[t(235)];r++){const n=H[t(237)][t(238)].bind(H),i=e[r],u=o[i]||n;n[t(218)]=H[t(267)](H),n[t(232)]=u[t(232)][t(267)](u),o[i]=n}}))();const K=l({__name:D(270),async setup(e){const r=D;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:r(254),srcColor:r(269),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(231),expanded:!0});return s[r(268)](a,r(240),{label:r(263)}),s[r(268)](a,r(244),{label:r(241)}),s.addBinding(a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(268)](a,r(252),{label:"最大扩散",min:10,max:2e3,step:10}),s[r(268)](a,r(246),{label:r(261),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(j,{model:v(c),bulidingsColor:e(222),landColor:e(253),topColor:e(258)},null,8,[e(245)]),C(Z,_({builds:v(c)[e(250)]},a),null,16,[e(230)])])),_:1})}}});function W(t){function n(t){const o=L;if(typeof t===o(248))return function(t){}[o(237)](o(257))[o(243)](o(227));1!==(""+t/t).length||t%20==0?function(){return!0}[o(237)]("debu"+o(229))[o(221)](o(265)):function(){return!1}.constructor("debugger").apply(o(224)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{K as default};
