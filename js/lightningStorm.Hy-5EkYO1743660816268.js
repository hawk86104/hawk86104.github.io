import{_ as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.YKMl6SIC1743660816268.js";import{e as i,I as s,K as e}from"./@tresjs.zc7faK4J1743660816268.js";import{B as n,b as r,cD as a,ak as o,a8 as h,a as c,au as u,A as l,l as d,C as m}from"./three.2wx8FU0g1743660816268.js";import{a as p}from"./simplex-noise.jB2HxhHB1743660816268.js";import{d as g,a2 as f,o as y,H as b,u as S,r as x,j as v,g as P,F as w,m as I}from"./@vue.B5PFBfKs1743660816268.js";import"./index.05kvU0z71743660816268.js";import{_ as M}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.8WhWJfPe1743660816268.js";import"./three-custom-shader-material.uMc5A1EX1743660816268.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1743660816268.js";import"./postprocessing.ApTwx-211743660816268.js";import"./@vueuse.jtbb8I7w1743660816268.js";import"./all.three.q3DPAGr01743660816268.js";import"./oimophysics.WhCxc1Ho1743660816268.js";import"./reflectorDiffuse.5zy0dW_U1743660816268.js";import"./vite-plugin-qiankun.DT7p3NC_1743660816268.js";import"./index.wgv4wbeG1743660816268.js";import"./object-hash.6N1Uf8kA1743660816268.js";import"./@amap.c8pGcSIC1743660816268.js";import"./jszip.rGR265Ak1743660816268.js";import"./three-stdlib.rtqrSiFZ1743660816268.js";import"./whiteFloor.45lmiqp31743660816268.js";import"./@pmndrs.z8R6f5wQ1743660816268.js";const T=C;!function(t,i){const s=C,e=_();for(;;)try{if(407559===parseInt(s(392))/1+parseInt(s(495))/2+-parseInt(s(405))/3+parseInt(s(452))/4+parseInt(s(385))/5*(parseInt(s(382))/6)+-parseInt(s(342))/7*(parseInt(s(437))/8)+-parseInt(s(500))/9)break;e.push(e.shift())}catch(n){e.push(e.shift())}}();const R=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s.apply(i,arguments);return s=null,t}}:function(){};return t=!1,e}}();function _(){const t=["sin","initSubray","forwards","fractalRay","currentSegmentIndex","RAY_INITIALIZED","onDecideSubrayCreation","init","up1","test","createTriangleVerticesWithUVs","fraction0","middlePos","radius1Factor","beginVanishingTime","stateObject","RAY_PROPAGATING","multiplyScalar","seedGenerator","6FQzJSs","LightningStrike","log","550210xEkiRL","min","add","destOffset","random","isStatic","fillMesh","767434mKgEmU","counter","debu","isEternal","constructor","minRadius","trace","info","pos1","drawRange","positionAttribute","gger","fractalRayRecursive","1251579TbZkXu","subrayDutyCycle","input","isLightningStrike","createTriangleVerticesWithoutUVs","uvsAttribute","__proto__","straightness","currentUVCoordinate","rayParameters","vanishingTimeFactor","currentSeed","clone","radius1","index","SIN30DEG","while (true) {}","copyParameters","setAttribute","seed","cross1","recursionProbability","crossVectors","currentSubray","currentCoordinate","action","createSegment","call","ramification","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","vertices","createRandomGenerator","8RIVliS","warn","ceil","subrayConePosition","visible","pos0","forwardsFill","lerp","currentVertex","pow","isInitialSegment","currentCreateTriangleVertices","createSubray","timeScale","length","2363780xppUle","side","RAY_VANISHING","push","apply","chain","floor","setIndex","maxSubrayRecursion","subrayPeriod","radius0","subVectors","uvs","getSeed","currentSegmentCallback","array","time","normalize","RAY_STEADY","state","propagationTimeFactor","timeFraction","createDefaultSubrayCreationCallbacks","console","COS30DEG","noiseSeed","createMesh","positionVariationFactor","copy","type","up0","subrayCylinderPosition","sourceOffset","getNewSegment","subrayProbability","raySegments","count","newPos","recursion","simplexZ","onSubrayCreation","max","endPropagationTime","452400kAMcwK","roughness","currentIndex","linPos0","toString","1066932XMeZRG","error","iteration","generateUVs","RAY_EXTINGUISHED","maxRaySegments","simplexY","position","setSeed","updateMesh","addNewSubray","radius0Factor","birthTime","needsUpdate","5259247BRbPsB","bind","maxIterations","indices","deathTime","table","randomGenerator","fraction1","lerpVectors","linPos1","sub","middleLinPos","exception","set","subrays","simplexX","createPrism","down","numSubrays","usage","maxSubrays"];return(_=function(){return t})()}function C(t,i){const s=_();return C=function(t,i){return s[t-=329]},C(t,i)}!function(){R(this,(function(){const t=C,i=new RegExp("function *\\( *\\)"),s=new RegExp(t(434),"i"),e=F(t(370));i[t(372)](e+t(457))&&s.test(e+t(407))?F():e("0")}))()}();const A=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s[C(456)](i,arguments);return s=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=C;let i;try{i=Function('return (function() {}.constructor("return this")( ));')()}catch(n){i=window}const s=i[t(475)]=i.console||{},e=[t(384),t(438),t(399),t(329),t(354),t(347),t(398)];for(let r=0;r<e.length;r++){const i=A[t(396)].prototype[t(343)](A),n=e[r],a=s[n]||i;i[t(411)]=A.bind(A),i[t(499)]=a[t(499)][t(343)](a),s[n]=i}}))();class V extends n{constructor(t={}){const i=C;super(),this[i(408)]=!0,this[i(481)]=i(383),this.init(V.copyParameters(t,t)),this[i(478)]()}static createRandomGenerator(){const t=C,i=2053,s=[];for(let n=0;n<i;n++)s.push(Math[t(389)]());const e={currentSeed:0,random:function(){const n=t,r=s[e[n(416)]];return e[n(416)]=(e[n(416)]+1)%i,r},getSeed:function(){return e[t(416)]/i},setSeed:function(s){const n=t;e.currentSeed=Math[n(458)](s*i)%i}};return e}static[T(422)](t={},i={}){const s=T,e=function(s){return i===t?s:s[C(417)]()};return t.sourceOffset=void 0!==i[s(484)]?e(i[s(484)]):new r(0,100,0),t[s(388)]=void 0!==i[s(388)]?e(i.destOffset):new r(0,0,0),t[s(450)]=void 0!==i[s(450)]?i.timeScale:1,t[s(496)]=void 0!==i[s(496)]?i[s(496)]:.9,t.straightness=void 0!==i.straightness?i[s(412)]:.7,t[s(482)]=void 0!==i[s(482)]?e(i[s(482)]):new r(0,0,1),t[s(371)]=void 0!==i[s(371)]?e(i[s(371)]):new r(0,0,1),t[s(462)]=void 0!==i[s(462)]?i[s(462)]:1,t.radius1=void 0!==i.radius1?i[s(418)]:1,t.radius0Factor=void 0!==i[s(339)]?i[s(339)]:.5,t.radius1Factor=void 0!==i[s(376)]?i[s(376)]:.2,t[s(397)]=void 0!==i[s(397)]?i.minRadius:.2,t[s(395)]=void 0!==i[s(395)]?i[s(395)]:void 0===i.birthTime||void 0===i[s(346)],t[s(340)]=i.birthTime,t.deathTime=i[s(346)],t[s(472)]=void 0!==i[s(472)]?i.propagationTimeFactor:.1,t[s(415)]=void 0!==i.vanishingTimeFactor?i[s(415)]:.9,t[s(461)]=void 0!==i[s(461)]?i[s(461)]:4,t[s(406)]=void 0!==i[s(406)]?i[s(406)]:.6,t[s(344)]=void 0!==i[s(344)]?i[s(344)]:9,t[s(390)]=void 0!==i.isStatic&&i.isStatic,t.ramification=void 0!==i[s(433)]?i.ramification:5,t[s(460)]=void 0!==i[s(460)]?i[s(460)]:3,t.recursionProbability=void 0!==i[s(426)]?i.recursionProbability:.6,t[s(331)]=void 0!==i.generateUVs&&i.generateUVs,t.randomGenerator=i[s(348)],t[s(477)]=i.noiseSeed,t[s(369)]=i.onDecideSubrayCreation,t[s(492)]=i.onSubrayCreation,t}update(t){const i=T;this[i(390)]||(this.rayParameters[i(395)]||this[i(414)][i(340)]<=t&&t<=this.rayParameters[i(346)]?(this[i(337)](t),t<this[i(356)][0][i(494)]?this.state=V.RAY_PROPAGATING:t>this.subrays[0][i(377)]?this[i(471)]=V[i(454)]:this[i(471)]=V.RAY_STEADY,this.visible=!0):(this[i(441)]=!1,t<this[i(414)][i(340)]?this[i(471)]=V.RAY_UNBORN:this[i(471)]=V[i(332)]))}[T(370)](t){const i=T;this[i(414)]=t,this[i(344)]=void 0!==t[i(344)]?Math[i(458)](t[i(344)]):9,t[i(344)]=this.maxIterations,this[i(390)]=void 0!==t[i(390)]&&t[i(390)],t.isStatic=this[i(390)],this[i(433)]=void 0!==t[i(433)]?Math[i(458)](t.ramification):5,t[i(433)]=this[i(433)],this[i(460)]=void 0!==t[i(460)]?Math[i(458)](t[i(460)]):3,t[i(460)]=this.maxSubrayRecursion,this.recursionProbability=void 0!==t.recursionProbability?t[i(426)]:.6,t[i(426)]=this[i(426)],this[i(331)]=void 0!==t.generateUVs&&t[i(331)],t[i(331)]=this.generateUVs,void 0!==t[i(348)]?(this[i(348)]=t[i(348)],this[i(381)]=t[i(348)],void 0!==t[i(477)]&&this[i(381)][i(336)](t[i(477)])):(this[i(348)]=V[i(436)](),this.seedGenerator=Math),void 0!==t.onDecideSubrayCreation?this[i(369)]=t[i(369)]:(this[i(474)](),void 0!==t[i(492)]&&(this.onSubrayCreation=t.onSubrayCreation)),this[i(471)]=V[i(368)],this[i(362)]=Math[i(439)](1+Math[i(446)](this[i(433)],Math[i(493)](0,this[i(460)]-1))),t[i(362)]=this.maxSubrays,this[i(333)]=2*(1<<this[i(344)]),this[i(356)]=[];for(let s=0;s<this[i(362)];s++)this[i(356)][i(455)](this[i(449)]());this.raySegments=[];for(let s=0;s<this[i(333)];s++)this[i(487)][i(455)](this[i(431)]());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this[i(331)]?this[i(373)]:this[i(409)],this[i(360)]=0,this[i(428)]=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this[i(486)]=0,this[i(445)]=0,this[i(497)]=0,this.currentCoordinate=0,this[i(413)]=0,this[i(435)]=null,this[i(464)]=null,this[i(345)]=null,this[i(402)]=null,this[i(410)]=null,this[i(357)]=p(this[i(381)][i(389)]),this.simplexY=p(this[i(381)][i(389)]),this[i(491)]=p(this[i(381)][i(389)]),this.forwards=new r,this[i(443)]=new r,this[i(453)]=new r,this.down=new r,this[i(375)]=new r,this[i(353)]=new r,this[i(489)]=new r,this.vPos=new r,this[i(425)]=new r}[T(478)](){const t=T,i=1<<this[t(344)],s=3*(i+1)*this[t(362)],e=18*i*this.maxSubrays;this[t(435)]=new Float32Array(3*s),this.indices=new Uint32Array(e),this[t(331)]&&(this[t(464)]=new Float32Array(2*s)),this.fillMesh(0),this[t(459)](new a(this[t(345)],1)),this[t(402)]=new o(this[t(435)],3),this[t(423)](t(335),this[t(402)]),this[t(331)]&&(this[t(410)]=new o(new Float32Array(this.uvs),2),this[t(423)]("uv",this[t(410)])),!this[t(390)]&&(this.index[t(361)]=h,this[t(402)][t(361)]=h,this[t(331)]&&(this[t(410)].usage=h)),this.vertices=this[t(402)].array,this.indices=this[t(419)].array,this[t(331)]&&(this[t(464)]=this[t(410)][t(467)])}[T(337)](t){const i=T;this[i(391)](t),this[i(401)][i(488)]=this[i(497)],this[i(419)].needsUpdate=!0,this[i(402)][i(341)]=!0,this[i(331)]&&(this[i(410)].needsUpdate=!0)}[T(391)](t){const i=T,s=this;this[i(445)]=0,this.currentIndex=0,this[i(429)]=0,this[i(413)]=0,this[i(366)](t,(function(e){const n=i,r=s[n(428)];t<r[n(340)]||(this.rayParameters[n(395)]&&0==s[n(428)][n(490)]?(s[n(358)](e),s[n(369)](e,s)):t<r[n(494)]?s[n(473)]>=e[n(374)]*r[n(472)]&&(s[n(358)](e),s[n(369)](e,s)):t<r[n(377)]?(s.createPrism(e),s[n(369)](e,s)):(s.timeFraction<=r[n(415)]+e[n(349)]*(1-r[n(415)])&&s[n(358)](e),s[n(369)](e,s)))}))}addNewSubray(){const t=T;return this[t(356)][this[t(360)]++]}[T(364)](t,i){const s=T;t.pos0[s(480)](i[s(484)]),t[s(400)][s(480)](i[s(388)]),t.up0[s(480)](i[s(482)]),t[s(371)].copy(i[s(371)]),t.radius0=i[s(462)],t[s(418)]=i[s(418)],t.birthTime=i[s(340)],t[s(346)]=i[s(346)],t.timeScale=i.timeScale,t[s(496)]=i.roughness,t[s(412)]=i.straightness,t[s(472)]=i[s(472)],t[s(415)]=i[s(415)],t[s(344)]=this[s(344)],t[s(424)]=void 0!==i[s(477)]?i[s(477)]:0,t[s(490)]=0}[T(366)](t,i){const s=T;this[s(468)]=t,this[s(466)]=i,this[s(360)]=0,this[s(364)](this[s(338)](),this[s(414)]);for(let e=0;e<this[s(360)];e++){const i=this[s(356)][e];this[s(428)]=i,this[s(348)].setSeed(i[s(424)]),i.endPropagationTime=c[s(444)](i[s(340)],i[s(346)],i[s(472)]),i[s(377)]=c.lerp(i[s(346)],i[s(340)],1-i.vanishingTimeFactor);const n=this[s(348)][s(389)];i[s(498)][s(355)](n(),n(),n())[s(380)](1e3),i[s(351)][s(355)](n(),n(),n())[s(380)](1e3),this.timeFraction=(t-i.birthTime)/(i[s(346)]-i[s(340)]),this[s(367)]=0,this[s(447)]=!0;const r=this[s(485)]();r[s(330)]=0,r[s(442)][s(480)](i.pos0),r[s(400)][s(480)](i[s(400)]),r[s(498)].copy(i[s(498)]),r[s(351)].copy(i[s(351)]),r.up0[s(480)](i[s(482)]),r[s(371)].copy(i[s(371)]),r.radius0=i[s(462)],r[s(418)]=i.radius1,r[s(374)]=0,r[s(349)]=1,r[s(479)]=1-i[s(412)],this[s(486)]=this.ramification*Math.pow(this[s(426)],i[s(490)])/(1<<i[s(344)]),this.fractalRayRecursive(r)}this[s(466)]=null,this[s(428)]=null}[T(404)](t){const i=T;if(t[i(330)]>=this[i(428)].maxIterations)return void this[i(466)](t);this[i(365)][i(463)](t[i(400)],t.pos0);let s=this[i(365)][i(451)]();s<1e-6&&(this[i(365)].set(0,0,.01),s=this[i(365)][i(451)]());const e=.5*(t[i(462)]+t[i(418)]),n=.5*(t[i(374)]+t.fraction1),r=this[i(468)]*this[i(428)][i(450)]*Math.pow(2,t[i(330)]);this[i(375)][i(350)](t.pos0,t[i(400)],.5),this[i(353)][i(350)](t[i(498)],t[i(351)],.5);const a=this[i(353)];this[i(489)][i(355)](this[i(357)](a.x,a.y,a.z,r),this[i(334)](a.x,a.y,a.z,r),this.simplexZ(a.x,a.y,a.z,r)),this[i(489)][i(380)](t[i(479)]*s),this.newPos[i(387)](this[i(375)]);const o=this[i(485)]();o[i(442)][i(480)](t.pos0),o.pos1.copy(this[i(489)]),o[i(498)][i(480)](t[i(498)]),o[i(351)][i(480)](this[i(353)]),o[i(482)][i(480)](t[i(482)]),o[i(371)].copy(t[i(371)]),o[i(462)]=t.radius0,o.radius1=e,o.fraction0=t[i(374)],o[i(349)]=n,o[i(479)]=t.positionVariationFactor*this.currentSubray[i(496)],o[i(330)]=t[i(330)]+1;const h=this[i(485)]();h.pos0[i(480)](this[i(489)]),h[i(400)][i(480)](t[i(400)]),h.linPos0[i(480)](this.middleLinPos),h[i(351)][i(480)](t.linPos1),this[i(425)][i(427)](t.up0,this.forwards[i(469)]()),h.up0[i(427)](this.forwards,this.cross1)[i(469)](),h[i(371)][i(480)](t.up1),h[i(462)]=e,h[i(418)]=t[i(418)],h[i(374)]=n,h.fraction1=t[i(349)],h[i(479)]=t[i(479)]*this[i(428)][i(496)],h[i(330)]=t[i(330)]+1,this[i(404)](o),this[i(404)](h)}[T(358)](t){const i=T;this[i(443)].subVectors(t[i(400)],t.pos0)[i(469)](),this.isInitialSegment&&(this.currentCreateTriangleVertices(t[i(442)],t[i(482)],this[i(443)],t.radius0,0),this.isInitialSegment=!1),this[i(448)](t[i(400)],t[i(482)],this[i(443)],t[i(418)],t.fraction1),this.createPrismFaces()}[T(409)](t,i,s,e){const n=T;this[n(453)].crossVectors(i,s)[n(380)](e*V[n(476)]),this.down.copy(i)[n(380)](-e*V[n(420)]);const r=this.vPos,a=this.vertices;r[n(480)](t)[n(352)](this[n(453)]).add(this.down),a[this[n(429)]++]=r.x,a[this[n(429)]++]=r.y,a[this.currentCoordinate++]=r.z,r[n(480)](t)[n(387)](this[n(453)])[n(387)](this.down),a[this.currentCoordinate++]=r.x,a[this[n(429)]++]=r.y,a[this[n(429)]++]=r.z,r.copy(i)[n(380)](e).add(t),a[this.currentCoordinate++]=r.x,a[this.currentCoordinate++]=r.y,a[this[n(429)]++]=r.z,this[n(445)]+=3}[T(373)](t,i,s,e,n){const r=T;this[r(453)][r(427)](i,s).multiplyScalar(e*V.COS30DEG),this[r(359)][r(480)](i)[r(380)](-e*V[r(420)]);const a=this.vPos,o=this.vertices,h=this[r(464)];a[r(480)](t)[r(352)](this[r(453)]).add(this[r(359)]),o[this[r(429)]++]=a.x,o[this[r(429)]++]=a.y,o[this.currentCoordinate++]=a.z,h[this.currentUVCoordinate++]=n,h[this[r(413)]++]=0,a[r(480)](t)[r(387)](this[r(453)])[r(387)](this[r(359)]),o[this[r(429)]++]=a.x,o[this[r(429)]++]=a.y,o[this[r(429)]++]=a.z,h[this[r(413)]++]=n,h[this[r(413)]++]=.5,a[r(480)](i).multiplyScalar(e)[r(387)](t),o[this[r(429)]++]=a.x,o[this.currentCoordinate++]=a.y,o[this[r(429)]++]=a.z,h[this[r(413)]++]=n,h[this[r(413)]++]=1,this.currentVertex+=3}createPrismFaces(t){const i=T,s=this[i(345)];t=this[i(445)]-6,s[this[i(497)]++]=t+1,s[this.currentIndex++]=t+2,s[this.currentIndex++]=t+5,s[this[i(497)]++]=t+1,s[this.currentIndex++]=t+5,s[this[i(497)]++]=t+4,s[this.currentIndex++]=t+0,s[this[i(497)]++]=t+1,s[this[i(497)]++]=t+4,s[this[i(497)]++]=t+0,s[this[i(497)]++]=t+4,s[this.currentIndex++]=t+3,s[this[i(497)]++]=t+2,s[this[i(497)]++]=t+0,s[this.currentIndex++]=t+3,s[this.currentIndex++]=t+2,s[this.currentIndex++]=t+3,s[this[i(497)]++]=t+5}[T(474)](){const t=T,i=this.randomGenerator[t(389)];this[t(369)]=function(s,e){const n=t,r=e.currentSubray,a=e[n(414)].subrayPeriod,o=e.rayParameters[n(406)],h=e[n(414)].isEternal&&0==r.recursion?-i()*a:c.lerp(r.birthTime,r.endPropagationTime,s[n(374)])-i()*a,u=e.time-h,l=Math[n(458)](u/a),d=i()*(l+1);let m=0;if(u%a<=o*a&&(m=e.subrayProbability),r[n(490)]<e[n(460)]&&e[n(360)]<e[n(362)]&&i()<m){const t=e[n(338)](),c=e[n(348)][n(465)]();t[n(424)]=d,e[n(348)][n(336)](d),t[n(490)]=r[n(490)]+1,t[n(344)]=Math.max(1,r.maxIterations-1),t.linPos0[n(355)](i(),i(),i()).multiplyScalar(1e3),t[n(351)].set(i(),i(),i())[n(380)](1e3),t[n(482)][n(480)](r[n(482)]),t[n(371)][n(480)](r.up1),t[n(462)]=s.radius0*e[n(414)][n(339)],t[n(418)]=Math[n(386)](e[n(414)].minRadius,s[n(418)]*e.rayParameters[n(376)]),t[n(340)]=h+l*a,t[n(346)]=t[n(340)]+a*o,!e.rayParameters[n(395)]&&0==r[n(490)]&&(t[n(340)]=Math[n(493)](t[n(340)],r.birthTime),t[n(346)]=Math[n(386)](t[n(346)],r.deathTime)),t[n(450)]=2*r[n(450)],t[n(496)]=r[n(496)],t.straightness=r[n(412)],t[n(472)]=r[n(472)],t[n(415)]=r[n(415)],e[n(492)](s,r,t,e),e[n(348)][n(336)](c)}};const s=new r,e=new r,n=new r,a=new r;this[t(492)]=function(i,s,e,n){n[t(483)](i,s,e,.5,.6,.2)},this[t(440)]=function(r,o,h,c,u,l){const d=t;h.pos0[d(480)](r.pos0),s.subVectors(o[d(400)],o.pos0),e[d(480)](s)[d(469)](),s.multiplyScalar(r.fraction0+(1-r[d(374)])*(i()*c));const m=s[d(451)]();n[d(427)](o[d(482)],e);const p=2*Math.PI*i();n[d(380)](Math.cos(p)),a[d(480)](o[d(482)])[d(380)](Math.sin(p)),h.pos1[d(480)](n)[d(387)](a)[d(380)](m*u*(l+i()*(1-l)))[d(387)](s).add(o.pos0)},this.subrayCylinderPosition=function(r,o,h,c,u,l){const d=t;h[d(442)].copy(r[d(442)]),s[d(463)](o[d(400)],o[d(442)]),e[d(480)](s)[d(469)](),s.multiplyScalar(r.fraction0+(1-r[d(374)])*((2*i()-1)*c));const m=s[d(451)]();n.crossVectors(o[d(482)],e);const p=2*Math.PI*i();n[d(380)](Math.cos(p)),a.copy(o[d(482)])[d(380)](Math.sin(p)),h.pos1[d(480)](n)[d(387)](a).multiplyScalar(m*u*(l+i()*(1-l)))[d(387)](s)[d(387)](o.pos0)}}[T(449)](){return{seed:0,maxIterations:0,recursion:0,pos0:new r,pos1:new r,linPos0:new r,linPos1:new r,up0:new r,up1:new r,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}[T(431)](){return{iteration:0,pos0:new r,pos1:new r,linPos0:new r,linPos1:new r,up0:new r,up1:new r,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}[T(485)](){const t=T;return this[t(487)][this[t(367)]++]}[T(480)](t){const i=T;return super[i(480)](t),this.init(V[i(422)]({},t[i(414)])),this}[T(417)](){const t=T;return new this.constructor(V[t(422)]({},this[t(414)]))}}function F(t){function i(t){const s=C;if("string"==typeof t)return function(t){}[s(396)](s(421))[s(456)](s(393));1!==(""+t/t)[s(451)]||t%20==0?function(){return!0}[s(396)](s(394)+s(403))[s(432)](s(430)):function(){return!1}[s(396)](s(394)+s(403)).apply(s(378)),i(++t)}try{if(t)return i;i(0)}catch(s){}}function j(){const t=["lightningParameters","length","deadLightningsMeshes","size","rayParameters","inited","toString","lightningMaxDuration","call","state","constructor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","add","trace","log","init","RAY_PROPAGATING","isEternal","remove","action","multiplyScalar","819vDVFfo","birthTime","onLightningDown","RAY_EXTINGUISHED","6052942KtSDWr","deathTime","counter","error","lightningsMeshes","lightningMinDuration","pop","__proto__","10vzUOsY","destOffset","3858124pPGMmb","15470QJBuGq","test","lightningMaterial","minHeight","gger","geometry","maxHeight","maxLightnings","nextLightningTime","485820qTeQGE","stateObject","set","sourceOffset","lightningMaxPeriod","string","copy","1940826qVIgze",'{}.constructor("return this")( )',"apply","random","2xwHnUR","indexOf","debu","isLightningStorm","console","366326TvLmsB","onRayPosition","chain","getNextLightningTime","stormParams","table","update","lightningMinPeriod","push","input","maxSlope","bind","11670087taSanu","copyParameters","16OPDfYS"];return(j=function(){return t})()}V[T(368)]=0,V.RAY_UNBORN=1,V[T(379)]=2,V[T(470)]=3,V.RAY_VANISHING=4,V.RAY_EXTINGUISHED=5,V.COS30DEG=Math.cos(30*Math.PI/180),V[T(420)]=Math[T(363)](30*Math.PI/180);const D=G;!function(t,i){const s=G,e=j();for(;;)try{if(922475===-parseInt(s(372))/1*(parseInt(s(377))/2)+parseInt(s(361))/3+parseInt(s(351))/4+parseInt(s(349))/5*(-parseInt(s(368))/6)+-parseInt(s(341))/7*(-parseInt(s(391))/8)+parseInt(s(337))/9*(parseInt(s(352))/10)+-parseInt(s(389))/11)break;e.push(e.shift())}catch(n){e.push(e.shift())}}();const H=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s.apply(i,arguments);return s=null,t}}:function(){};return t=!1,e}}();!function(){H(this,(function(){const t=G,i=new RegExp("function *\\( *\\)"),s=new RegExp(t(327),"i"),e=E(t(331));i[t(353)](e+t(379))&&s[t(353)](e+t(386))?E():e("0")}))()}();const z=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s[G(370)](i,arguments);return s=null,t}}:function(){};return t=!1,e}}();function G(t,i){const s=j();return G=function(t,i){return s[t-=324]},G(t,i)}z(void 0,(function(){const t=G,i=function(){const t=G;let i;try{i=Function("return (function() "+t(369)+");")()}catch(s){i=window}return i}(),s=i[t(376)]=i[t(376)]||{},e=[t(330),"warn","info",t(344),"exception",t(382),t(329)];for(let n=0;n<e[t(393)];n++){const i=z[t(326)].prototype[t(388)](z),r=e[n],a=s[r]||i;i[t(348)]=z[t(388)](z),i[t(398)]=a[t(398)][t(388)](a),s[r]=i}}))();class L extends u{constructor(t={}){const i=G;super(),this[i(375)]=!0,this[i(381)]=t,t[i(395)]=void 0!==t.size?t.size:1e3,t.minHeight=void 0!==t[i(355)]?t[i(355)]:80,t[i(358)]=void 0!==t[i(358)]?t[i(358)]:100,t.maxSlope=void 0!==t.maxSlope?t[i(387)]:1.1,t[i(359)]=void 0!==t.maxLightnings?t[i(359)]:3,t[i(384)]=void 0!==t[i(384)]?t.lightningMinPeriod:3,t[i(365)]=void 0!==t[i(365)]?t[i(365)]:7,t.lightningMinDuration=void 0!==t[i(346)]?t[i(346)]:1,t[i(399)]=void 0!==t[i(399)]?t[i(399)]:2.5,this[i(392)]=V[i(390)](t.lightningParameters,t.lightningParameters),this.lightningParameters[i(333)]=!1,this[i(354)]=void 0!==t[i(354)]?t.lightningMaterial:new l({color:11599871}),void 0!==t[i(378)]?this[i(378)]=t[i(378)]:this[i(378)]=function(s,e){const n=i;e[n(363)]((Math.random()-.5)*t[n(395)],0,(Math.random()-.5)*t.size);const r=c.lerp(t[n(355)],t[n(358)],Math[n(371)]());s.set(t[n(387)]*(2*Math[n(371)]()-1),1,t[n(387)]*(2*Math[n(371)]()-1))[n(336)](r)[n(328)](e)},this.onLightningDown=t[i(339)],this[i(397)]=!1,this.nextLightningTime=0,this[i(345)]=[],this.deadLightningsMeshes=[];for(let s=0;s<this[i(381)][i(359)];s++){const t=new V(V[i(390)]({},this[i(392)])),s=new d(t,this[i(354)]);this.deadLightningsMeshes.push(s)}}[D(383)](t){const i=D;if(!this[i(397)]&&(this[i(360)]=this.getNextLightningTime(t)*Math[i(371)](),this[i(397)]=!0),t>=this[i(360)]){const s=this[i(394)][i(347)]();if(s){const e=V[i(390)](s[i(357)][i(396)],this[i(392)]);e[i(338)]=t,e[i(342)]=t+c.lerp(this[i(381)][i(346)],this[i(381)][i(399)],Math[i(371)]()),this[i(378)](e[i(364)],e[i(350)]),e.noiseSeed=Math.random(),this[i(328)](s),this[i(345)][i(385)](s)}this[i(360)]=this[i(380)](t)}let s=0,e=this.lightningsMeshes.length;for(;s<e;){const n=this[i(345)][s],r=n[i(357)],a=r[i(325)];r.update(t),a===V[i(332)]&&r[i(325)]>a&&this[i(339)]&&this[i(339)](r),r.state===V[i(340)]?(this[i(345)].splice(this[i(345)][i(373)](n),1),this[i(394)].push(n),this[i(334)](n),e--):s++}}[D(380)](t){const i=D;return t+c.lerp(this[i(381)][i(384)],this.stormParams[i(365)],Math[i(371)]())/(this.stormParams[i(359)]+1)}copy(t,i){const s=D;return super[s(367)](t,i),this[s(381)][s(395)]=t[s(381)][s(395)],this[s(381)][s(355)]=t.stormParams[s(355)],this.stormParams[s(358)]=t[s(381)].maxHeight,this[s(381)][s(387)]=t[s(381)][s(387)],this[s(381)].maxLightnings=t[s(381)].maxLightnings,this[s(381)][s(384)]=t[s(381)].lightningMinPeriod,this[s(381)][s(365)]=t[s(381)].lightningMaxPeriod,this.stormParams[s(346)]=t[s(381)][s(346)],this[s(381)].lightningMaxDuration=t[s(381)].lightningMaxDuration,this.lightningParameters=V[s(390)]({},t.lightningParameters),this.lightningMaterial=t[s(381)][s(354)],this[s(339)]=t[s(339)],this}clone(){const t=D;return new(this[t(326)])(this[t(381)])[t(367)](this)}}function E(t){function i(t){const s=G;if(typeof t===s(366))return function(t){}[s(326)]("while (true) {}")[s(370)](s(343));1!==(""+t/t)[s(393)]||t%20==0?function(){return!0}[s(326)](s(374)+s(356))[s(324)](s(335)):function(){return!1}[s(326)](s(374)+s(356))[s(370)](s(362)),i(++t)}try{if(t)return i;i(0)}catch(s){}}const O=["object"],U=g({__name:"lightStorm",props:{color:{default:"#b0ffff"},size:{default:2e3},minHeight:{default:100},maxHeight:{default:500},maxLightnings:{default:18},roughness:{default:.85},straightness:{default:.65},radius0:{default:1},radius1:{default:.5},timeScale:{default:.15},subrayPeriod:{default:4},subrayDutyCycle:{default:.6}},setup(t){const s=t,e=new m(s.color),n=new l({color:e}),a=new r(0,-1,0);let o=0;const h=new r,c=new r,u={roughness:s.roughness,straightness:s.straightness,radius0:s.radius0,radius1:s.radius1,timeScale:s.timeScale,subrayPeriod:s.subrayPeriod,subrayDutyCycle:s.subrayDutyCycle,minRadius:.3,maxIterations:7,propagationTimeFactor:.2,vanishingTimeFactor:.9,maxSubrayRecursion:3,ramification:3,recursionProbability:.4,onSubrayCreation:function(t,i,s,e){e.subrayConePosition(t,i,s,.6,.6,.5),o=e.rayParameters.sourceOffset.y,h.subVectors(s.pos1,e.rayParameters.sourceOffset);const n=a.dot(h);c.copy(a).multiplyScalar(n),h.sub(c);const r=n/o>.5?o/n:1;c.multiplyScalar(r),h.add(c),s.pos1.addVectors(h,e.rayParameters.sourceOffset)}},d=new L({size:s.size,minHeight:s.minHeight,maxHeight:s.maxHeight,maxSlope:.6,maxLightnings:s.maxLightnings,lightningParameters:u,lightningMaterial:n});f((()=>{const t=d.stormParams;t.size=s.size,t.minHeight=s.minHeight,t.maxHeight=s.maxHeight,n.color.set(s.color),u.roughness=s.roughness,u.straightness=s.straightness,u.radius0=s.radius0,u.radius1=s.radius1,u.timeScale=s.timeScale}));const{onLoop:p}=i();return p((({elapsed:t})=>{d.update(t)})),(t,i)=>(y(),b("primitive",{object:S(d),renderOrder:9999},null,8,O))}}),N=g({__name:"lightningStorm",setup(i){const n=x({cellSize:60,cellThickness:1,cellColor:"#6f6f6f",sectionColor:"#92399e",sectionSize:330,sectionThickness:1.5,fadeDistance:3600,fadeStrength:1,followCamera:!1,infiniteGrid:!0}),{minHeight:r,maxHeight:a,color:o,roughness:h,straightness:c,radius0:u,radius1:l,timeScale:d}=s({minHeight:{label:"最低",value:100,min:10,max:500,step:10},maxHeight:{label:"最高",value:1e3,min:50,max:2e3,step:10},color:"#ffbde7",roughness:{label:"粗糙度",value:.85,min:0,max:1,step:.01},straightness:{label:"直度度",value:.65,min:0,max:1,step:.01},radius0:{label:"端部半径",value:1,min:.1,max:10,step:.01},radius1:{label:"未部半径",value:.5,min:.1,max:10,step:.01},timeScale:{label:"时间缩放",value:.15,min:.01,max:1,step:.01}});return(i,s)=>(y(),b(w,null,[v(t,{showAxesHelper:!1,showGridHelper:!1},{ability:P((()=>[v(U,{minHeight:S(r).value,maxHeight:S(a).value,color:S(o).value,roughness:S(h).value,straightness:S(c).value,radius0:S(u).value,radius1:S(l).value,timeScale:S(d).value},null,8,["minHeight","maxHeight","color","roughness","straightness","radius0","radius1","timeScale"]),v(S(M),I({args:[100,100]},n,{position:[0,-50,0]}),null,16)])),_:1}),v(S(e))],64))}});export{N as default};
