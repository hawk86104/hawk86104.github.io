import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.ss_nL2AI1725416517797.js";import{bY as n,a6 as e,bW as o,c6 as i,k as r,C as s,cg as u}from"./three.VTQVqxMx1725416517797.js";import{p as a,$ as c}from"./@tresjs.5lh7VmqZ1725416517797.js";import{d as l,a2 as p,r as f,o as d,f as m,g as v,j as h,aj as P,ak as w}from"./@vue._6MD2XyK1725416517797.js";import{P as g}from"./tweakpane.yHWGBmom1725416517797.js";import"./three-custom-shader-material.R9Qrt3ei1725416517797.js";import"./object-hash.UdqO8HjX1725416517797.js";import"./@amap.LUDXTi4z1725416517797.js";import"./jszip.7CKSmb6c1725416517797.js";import"./glsl-tokenizer.dGVPr_M11725416517797.js";import"./glsl-token-string.7HmLwuvT1725416517797.js";import"./glsl-token-functions.fONiiOsX1725416517797.js";import"./@vueuse.L-salR9N1725416517797.js";const x=j;!function(t,n){const e=j,o=I();for(;;)try{if(313873===-parseInt(e(225))/1+-parseInt(e(230))/2+parseInt(e(218))/3*(parseInt(e(224))/4)+parseInt(e(215))/5*(-parseInt(e(214))/6)+parseInt(e(255))/7*(parseInt(e(226))/8)+-parseInt(e(223))/9*(-parseInt(e(220))/10)+-parseInt(e(244))/11*(-parseInt(e(238))/12))break;o.push(o.shift())}catch(i){o.push(o.shift())}}();const S=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){S(this,(function(){const t=j,n=new RegExp("function *\\( *\\)"),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=_(t(210));n[t(240)](o+t(202))&&e[t(240)](o+"input")?_():o("0")}))()}();const y=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function I(){const t=["DepthTexture","table","error","height","constructor","prototype","length","182UryewM","string","value","apply","matrixWorld","readBuffer","addPass","chain","buildingsPassA","while (true) {}","info","call","toString","Vector2","uPosition","init","set","color","uniforms","890310HPbNNO","5oWZgTA","trace","warn","6kPfNpy","log","200600xMZjUT","debu","width","117eQRzvc","184724oiNkgt","141962WXBXRd","31312eihRsu","speed",'{}.constructor("return this")( )',"depthBuffer","462824GncTMV","uWidth","bind","material","action","render","uScalenum","time","4568712PpnIEf","uScaleone","test","__proto__","console","depthTexture","11lzLBSr","gger","#FFF","projectionMatrixInverse"];return(I=function(){return t})()}y(void 0,(function(){const t=j,n=function(){const t=j;let n;try{n=Function("return (function() "+t(228)+");")()}catch(e){n=window}return n}(),e=n[t(242)]=n[t(242)]||{},o=[t(219),t(217),t(205),t(250),"exception",t(249),t(216)];for(let i=0;i<o[t(254)];i++){const n=y.constructor[t(253)][t(232)](y),r=o[i],s=e[r]||n;n[t(241)]=y[t(232)](y),n[t(207)]=s[t(207)][t(232)](s),e[r]=n}}))();const b=l({__name:x(203),props:{color:{default:x(246)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const l=t,{renderer:f,scene:d,camera:m,sizes:v}=a();let h,P=0,w=null,g=null;p((()=>{const t=j;v[t(222)][t(257)]&&(h=v[t(222)][t(257)],P=v[t(251)].value,(()=>{const t=j;w=new n(f[t(257)]);const a=new(e[t(248)])(h,P);w[t(260)][t(229)]=!0,w[t(260)][t(243)]=a;const c=new o(d[t(257)],m[t(257)]);w.addPass(c),g=new i(new r({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:a},uProjectionInverse:{value:m[t(257)][t(247)]},uMatrixWorld:{value:m[t(257)][t(259)]},uColor:{value:new s(l[t(212)])},uScalenum:{value:l.uScalenum},uScaleone:{value:l.uScaleone},uWidth:{value:l[t(231)]},uPosition:{value:new(e[t(208)])(l[t(209)].x,l.uPosition.y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),w[t(201)](g);const p=new i(u);w[t(201)](p)})())}));const{onLoop:x}=c();return x((({elapsed:t})=>{const n=j;w&&(w[n(235)](),g[n(213)][n(237)][n(257)]+=l[n(227)]/60)})),p((()=>{const t=j;g&&(l[t(212)]&&(g[t(233)].uniforms.uColor[t(257)]=new s(l[t(212)])),l[t(236)]&&(g.material[t(213)][t(236)][t(257)]=l.uScalenum),l[t(239)]&&(g.material[t(213)][t(239)][t(257)]=l[t(239)]),l[t(231)]&&(g.material.uniforms.uWidth[t(257)]=l.uWidth),l.uPosition&&g.material[t(213)].uPosition[t(257)][t(211)](l.uPosition.x,l.uPosition.y))})),(t,n)=>null}});function j(t,n){const e=I();return(j=function(t,n){return e[t-=201]})(t,n)}function _(t){function n(t){const e=j;if(typeof t===e(256))return function(t){}[e(252)](e(204)).apply("counter");1!==(""+t/t)[e(254)]||t%20==0?function(){return!0}.constructor(e(221)+"gger")[e(206)](e(234)):function(){return!1}[e(252)](e(221)+e(245))[e(258)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}const W=F;!function(t,n){const e=F,o=k();for(;;)try{if(868747===-parseInt(e(450))/1*(parseInt(e(443))/2)+-parseInt(e(442))/3*(parseInt(e(469))/4)+parseInt(e(453))/5+parseInt(e(457))/6*(parseInt(e(439))/7)+-parseInt(e(449))/8*(-parseInt(e(466))/9)+parseInt(e(462))/10*(-parseInt(e(460))/11)+parseInt(e(483))/12*(parseInt(e(456))/13))break;o.push(o.shift())}catch(i){o.push(o.shift())}}();const z=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[F(463)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){z(this,(function(){const t=F,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(474),"i"),o=M(t(480));n[t(478)](o+t(473))&&e[t(478)](o+t(465))?M():o("0")}))()}();const D=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[F(463)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function k(){const t=["693604iOjIsM","buildingsPassA","#00b4fb","bind","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","return (function() ","while (true) {}","test","圈颜色","init","uPosition","addBinding","11504004tmOrAY","warn","length","单条圈间距","35KiRSYk","call","gger","9EgJQQQ","584566QCfLLs","uWidth",'{}.constructor("return this")( )',"debu","uScaleone","counter","2130344tlRbzA","1flXwKr","toString","color","2379450EUlDEF","console","error","13CjoRSw","740676ZjgwKj","最大范围","speed","304579oEFHZF","constructor","230xhgomv","apply","exception","input","9pEIORo","__proto__","log"];return(k=function(){return t})()}function F(t,n){const e=k();return(F=function(t,n){return e[t-=436]})(t,n)}D(void 0,(function(){const t=F,n=function(){const t=F;let n;try{n=Function(t(476)+t(445)+");")()}catch(e){n=window}return n}(),e=n[t(454)]=n[t(454)]||{},o=[t(468),t(436),"info",t(455),t(464),"table","trace"];for(let i=0;i<o[t(437)];i++){const n=D[t(461)].prototype[t(472)](D),r=o[i],s=e[r]||n;n[t(467)]=D[t(472)](D),n.toString=s[t(451)][t(472)](s),e[r]=n}}))();const R=l({__name:W(470),setup(n){const e=W,o=f({color:e(471),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),i=new g({title:"后期效果",expanded:!0});return i[e(482)](o,e(452),{label:e(479)}),i.addBinding(o,"uScalenum",{label:e(458),min:1,max:500,step:10}),i.addBinding(o,e(447),{label:e(438),min:1,max:100,step:1}),i[e(482)](o,e(444),{label:"单条圈宽度",min:0,max:1,step:.01}),i[e(482)](o,e(459),{label:"速度",min:1,max:20,step:1}),i[e(482)](o,e(481),{picker:"inline",label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(d(),m(t,{disableRender:!0,showAxesHelper:!1},{ability:v((()=>[h(b,P(w(o)),null,16)])),_:1}))}});function M(t){function n(t){const e=F;if(typeof t===e(475))return function(t){}[e(461)](e(477)).apply(e(448));1!==(""+t/t)[e(437)]||t%20==0?function(){return!0}[e(461)](e(446)+e(441))[e(440)]("action"):function(){return!1}[e(461)]("debu"+e(441)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{R as default};
