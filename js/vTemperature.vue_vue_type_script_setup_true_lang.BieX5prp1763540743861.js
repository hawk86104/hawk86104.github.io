import{u as e}from"./colorList.DbCLsRg71763540743861.js";import{r as a,a as t}from"./rawData.lQ4T1IdU1763540743861.js";import{P as l}from"./tweakpane.CqZAnw7f1763540743861.js";import{u as s}from"./rawData.Bm5IktqG1763540743861.js";import"./index.Bs4zbcIs1763540743861.js";import{_ as r}from"./surfaceSection.vue_vue_type_script_setup_true_lang.xPwKDf6U1763540743861.js";import{b as n}from"./utils.CihGrXpu1763540743861.js";import{d as i,a8 as o,a as u,c as p,w as m,H as v,o as d,u as x,J as c,b as f,I as y,m as g}from"./@vue.Co_gxueH1763540743861.js";import{V as w,bL as b,be as T,af as h,b1 as _,A as j,aE as B,aG as k,r as A,bK as E,ae as S}from"./three.rXKzP9fQ1763540743861.js";const z=["position"],C=["scale","visible"],R=["object"],D=i({__name:"vTemperature",props:{map:{}},async setup(i){let D,F;const P=i,G=P.map.geo2pos(new w(118.724419,32.010354,25e3));G.applyMatrix4(P.map.matrix);const L=s(),M=([D,F]=o(()=>n("./plugins/tvtVolumeRendering/rawData/tem_512x28x512_Uint8_[-10-50].raw.zip")),D=await D,F(),D);L.byteArray=([D,F]=o(()=>M.files["tem_512x28x512_Uint8_[-10-50].raw"].async("uint8array")),D=await D,F(),D);const U=e(),I=new b(new T(new h(1,1,1)),new _({color:10066329})),O=u(350),V=u(L.yExtent/L.xExtent*900),H=u(L.zExtent/L.xExtent*350),J=p(()=>!(O.value<=.01&&O.value>=-.01)&&(!(V.value<=.01&&V.value>=-.01)&&!(H.value<=.01&&H.value>=-.01))),K=[new j(-1,0,0,G.x),new j(0,-1,0,3*G.y),new j(0,0,-1,G.z)],W=new B(L.byteArray,L.xExtent,L.yExtent,L.zExtent);W.format=k,W.type=L.getThreeType(),W.minFilter=A,W.magFilter=A,W.wrapS=E,W.wrapT=E,W.wrapR=E,W.needsUpdate=!0;const q={uniforms:{dataTexture:{value:W},colorTexture:{value:U.updateTransferFunction()},samplingRate:{value:1},threshold:{value:.5},alphaScale:{value:1},invertColor:{value:!1},composeType:{value:1},clipPlanesArray:{value:K}},vertexShader:t,fragmentShader:a,side:S,transparent:!0,depthWrite:!1,depthTest:!0,alphaToCoverage:!0},N=u(!0),Q=(new l).addTab({pages:[{title:"三维体"},{title:"面剖"}]}),X=Q.pages[0],Y=u(null);X.addBinding(q.uniforms.clipPlanesArray.value[0],"w",{label:"x",min:G.x-1e3*O.value,max:G.x+1e3*O.value,step:1e3}),X.addBinding(q.uniforms.clipPlanesArray.value[2],"w",{label:"z",min:G.z-1e3*H.value,max:G.z+1e3*H.value,step:1e3}),X.addBlade({view:"list",label:"模式",options:[{text:"maximumIntensity",value:1},{text:"thresholding",value:2},{text:"emissionAbsorption",value:3}],value:q.uniforms.composeType.value}).on("change",e=>{q.uniforms.composeType.value=e.value}),X.addBinding(q.uniforms.samplingRate,"value",{label:"体积采样率",min:0,max:4,step:.01}),X.addBinding(q.uniforms.threshold,"value",{label:"体绘制的阈值",min:0,max:1,step:.01}),X.addBinding(q.uniforms.alphaScale,"value",{label:"透明度",min:0,max:1,step:.01}),X.addBinding(q.uniforms.invertColor,"value",{label:"是否反色"}),X.addBinding(N,"value",{label:"显示边框"}),X.addBlade({view:"separator"});const Z=u(!0);return X.addBinding(Z,"value",{label:"显示三维体"}),m(()=>U.colorsStops,()=>{q.uniforms.colorTexture.value=U.updateTransferFunction()},{deep:!0,immediate:!0}),(e,a)=>(d(),v("TresGroup",{position:[...x(G)],scale:1e3},[c("TresMesh",{scale:[O.value,V.value,H.value],visible:J.value&&Z.value,renderOrder:99990},[a[0]||(a[0]=c("TresBoxGeometry",{args:[1,1,1]},null,-1)),c("TresShaderMaterial",g(q,{ref_key:"smRef",ref:Y}),null,16),N.value?(d(),v("primitive",{key:0,object:x(I)},null,8,R)):y("",!0)],8,C),x(L).byteArray?(d(),f(r,{key:0,scale:[O.value,V.value,H.value],paneControl:x(Q).pages[1]},null,8,["scale","paneControl"])):y("",!0)],8,z))}});export{D as _};
