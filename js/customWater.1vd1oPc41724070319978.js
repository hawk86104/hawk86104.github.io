import{a6 as t,C as e,Z as n}from"./three.QUrV0R7c1724070319978.js";import{$ as r,T as a,d as s,x as o}from"./@tresjs.2JnKj_Yj1724070319978.js";import{a as i}from"./index.CwiXkxnG1724070319978.js";import"./index.rmnsjwue1724070319978.js";import{C as l}from"./three-custom-shader-material.JQ_xA23o1724070319978.js";import"./object-hash.-UynEDWH1724070319978.js";import"./@amap.PfcO2up21724070319978.js";import"./glsl-tokenizer.P_7ZdKiw1724070319978.js";import{p as c}from"./gl-noise.BrVtymbx1724070319978.js";import{d as u,b as p,a1 as f,w as g,o as h,D as m,J as v,j as d,u as _,r as b,f as w,g as y,aj as M,ak as j,m as x,al as C}from"./@vue.Q1VpS3901724070319978.js";import{P as z}from"./tweakpane.yHWGBmom1724070319978.js";import{_ as I}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.55SJu1q41724070319978.js";import"./@vueuse.2Yfo77CO1724070319978.js";import"./three-stdlib.xC_Fy68c1724070319978.js";import"./@pmndrs.vVECOsOu1724070319978.js";import"./reflectorDiffuse.vue_vue_type_script_setup_true_lang.DpBWRw-u1724070319978.js";import"./all.three.mO32oPaM1724070319978.js";import"./oimophysics.x0jH7fze1724070319978.js";import"./reflectorDUDV.vue_vue_type_script_setup_true_lang.3O-IoCm41724070319978.js";import"./reflectorShaderMesh.vue_vue_type_script_setup_true_lang.P5qlr7aE1724070319978.js";import"./whiteFloorMesh.vue_vue_type_script_setup_true_lang.qpXMhQSm1724070319978.js";import"./videoFloor.vue_vue_type_script_setup_true_lang.wxRnkyJb1724070319978.js";import"./glsl-token-string.l3IeKluQ1724070319978.js";import"./glsl-token-functions.UEj-2zyG1724070319978.js";import"./jszip.ZVB-p0R-1724070319978.js";const S=D;!function(t,e){const n=D,r=H();for(;;)try{if(650254===parseInt(n(524))/1*(-parseInt(n(508))/2)+parseInt(n(547))/3*(parseInt(n(536))/4)+parseInt(n(529))/5+-parseInt(n(520))/6*(parseInt(n(497))/7)+-parseInt(n(545))/8+parseInt(n(540))/9*(parseInt(n(510))/10)+parseInt(n(552))/11)break;r.push(r.shift())}catch(a){r.push(r.shift())}}();const T=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[D(523)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();!function(){T(this,(function(){const t=D,e=new RegExp("function *\\( *\\)"),n=new RegExp(t(511),"i"),r=O(t(513));e[t(506)](r+t(518))&&n[t(506)](r+t(519))?O():r("0")}))()}();const B=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[D(523)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function H(){const t=["rotation-x","needsUpdate","action","value",'{}.constructor("return this")( )',"MeshPhysicalMaterial","4oOVJgX","brightness","constructor","toString","1206UYNJlx","__proto__","vertex","waterColor","warn","8341808ApVLOw","console","3378117RCJZFZ","baseMaterial","args","length","log","16029519aPfDYH","side","fragmentShader","string","3562167gbgnre","trace","fragment","convertLinearToSRGB","tmRef","flatShading","gger","TresBoxGeometry","waterHighlight","test","customWaterMesh","2474nLSgkD","bind","42090WiTCre","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","\nvarying float vHeight;\nuniform vec3 waterColor;\nuniform vec3 waterHighlight;\nuniform float offset;\nuniform float contrast;\nuniform float brightness;\n\nvec3 calcColor() {\n  float mask = (pow(vHeight, 2.) - offset) * contrast;\n  vec3 diffuseColor = mix(waterColor, waterHighlight, mask);\n  diffuseColor *= brightness;\n  return diffuseColor;\n}\n\nvoid main() {\n  csm_DiffuseColor = vec4(calcColor(), 1.0);\n}\n\t","init","info","Flatshading","height","prototype","chain","input","6sBlCaV","stateObject","material","apply","938cHWzYZ","#b3ffff","debu","exception","Color","1074465LRJiNt"];return(H=function(){return t})()}B(void 0,(function(){const t=D;let e;try{e=Function("return (function() "+t(534)+");")()}catch(a){e=window}const n=e[t(546)]=e[t(546)]||{},r=[t(551),t(544),t(514),"error",t(527),"table",t(498)];for(let s=0;s<r[t(550)];s++){const e=B[t(538)][t(517)][t(509)](B),a=r[s],o=n[a]||e;e[t(541)]=B[t(509)](B),e[t(539)]=o[t(539)][t(509)](o),n[a]=e}}))();const P=[S(530)],W=[S(549)];function D(t,e){const n=H();return(D=function(t,e){return n[t-=496]})(t,e)}const G=u({__name:S(507),props:{height:{default:.2},Flatshading:{type:Boolean,default:!1},waterColor:{default:"#52a7f7"},waterHighlight:{default:S(525)},brightness:{default:1},baseMaterial:{default:t[S(535)]}},setup(s){const o=S,i=s,u=p(null),b={vertex:"\nuniform float uTime;\nuniform float uHeight;\nvarying float vHeight;\n\nvec3 displace(vec3 point) {\n  vec3 p = point;\n  p.y += uTime * 2.0;\n  gln_tFBMOpts fbmOpts = gln_tFBMOpts(1.0, 0.4, 2.3, 0.4, 1.0, 5, false, false);\n  gln_tGerstnerWaveOpts A = gln_tGerstnerWaveOpts(vec2(0.0, -1.0), 0.5, 2.0);\n  gln_tGerstnerWaveOpts B = gln_tGerstnerWaveOpts(vec2(0.0, 1.0), 0.25, 4.0);\n  gln_tGerstnerWaveOpts C = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.15, 6.0);\n  gln_tGerstnerWaveOpts D = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.4, 2.0);\n  vec3 n = vec3(0.0);\n  if(p.z >= uHeight / 2.0) {\n      n.z += gln_normalize(gln_pfbm(p.xy + (uTime * 0.5), fbmOpts));\n      n += gln_GerstnerWave(p, A, uTime).xzy;\n      n += gln_GerstnerWave(p, B, uTime).xzy * 0.5;\n      n += gln_GerstnerWave(p, C, uTime).xzy * 0.25;\n      n += gln_GerstnerWave(p, D, uTime).xzy * 0.2;\n  }\n  vHeight = n.z;\n  return point + n;\n}\n\nvec3 orthogonal(vec3 v) {\n  return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0)\n  : vec3(0.0, -v.z, v.y));\n}\n\nvec3 recalcNormals(vec3 newPos) {\n  float offset = 0.001;\n  vec3 tangent = orthogonal(normal);\n  vec3 bitangent = normalize(cross(normal, tangent));\n  vec3 neighbour1 = position + tangent * offset;\n  vec3 neighbour2 = position + bitangent * offset;\n\n  vec3 displacedNeighbour1 = displace(neighbour1);\n  vec3 displacedNeighbour2 = displace(neighbour2);\n\n  vec3 displacedTangent = displacedNeighbour1 - newPos;\n  vec3 displacedBitangent = displacedNeighbour2 - newPos;\n\n  return normalize(cross(displacedTangent, displacedBitangent));\n}\n\nvoid main() {\n  csm_Position = displace(position);\n  csm_Normal = recalcNormals(csm_Position);\n}\n\t",fragment:o(512)},w={uTime:{value:0},waterColor:{value:new e(i[o(543)])[o(500)]()},waterHighlight:{value:new(t[o(528)])(i[o(505)])[o(500)]()},offset:{value:.4},contrast:{value:3.1},brightness:{value:i[o(537)]},uHeight:{value:i[o(516)]}},{onLoop:y}=r();return y((({elapsed:t})=>{const e=o;w.uTime[e(533)]=-t/5})),f((()=>{const n=o;i[n(516)]&&(w.uHeight.value=i[n(516)]),i[n(543)]&&(w[n(543)][n(533)]=new(t[n(528)])(i[n(543)])[n(500)]()),i.waterHighlight&&(w[n(505)][n(533)]=new e(i[n(505)])[n(500)]()),i[n(537)]&&(w[n(537)][n(533)]=i[n(537)])})),g((()=>i.Flatshading),(t=>{const e=o;u[e(533)].material[e(531)]=!0})),g((()=>i[o(548)]),(e=>{const r=o,a=new l({baseMaterial:t[e],vertexShader:c(b.vertex),fragmentShader:b[r(499)],uniforms:w,flatShading:i[r(515)],side:n,roughness:.2,metalness:.1,silent:!0});u[r(533)][r(522)].dispose(),u[r(533)][r(522)]=a})),(e,r)=>{const s=o;return h(),m("TresMesh",{ref_key:s(501),ref:u,"rotation-x":-Math.PI/2},[v(s(504),{args:[5,5,e[s(516)],64,64,1]},null,8,W),d(_(a),{baseMaterial:t[s(535)],vertexShader:_(c)(b[s(542)]),fragmentShader:b[s(499)],uniforms:w,side:n,roughness:.2,metalness:.1,flatShading:e.Flatshading,silent:""},null,8,[s(548),"vertexShader",s(554),s(553),s(502)])],8,P)}}});function O(t){function e(t){const n=D;if(typeof t===n(496))return function(t){}[n(538)]("while (true) {}").apply("counter");1!==(""+t/t)[n(550)]||t%20==0?function(){return!0}[n(538)](n(526)+n(503)).call(n(532)):function(){return!1}[n(538)](n(526)+n(503))[n(523)](n(521)),e(++t)}try{if(t)return e;e(0)}catch(n){}}function k(){const t=["gger","Flatshading","string","pos-x.jpg","MeshBasicMaterial","test","TresAmbientLight",'{}.constructor("return this")( )',"MeshToonMaterial","addBlade","action","prototype","6139030RtIyMw","console","MeshNormalMaterial","720175ZsXaRj","trace","exception","水体颜色","1871540WcPJlU","waterHighlight","length","6sebZuf","input","counter","23094NxVQdC","93iJDKrL","ACESFilmicToneMapping","function *\\( *\\)","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","MeshPhongMaterial","target","#52a7f7","chain","baseMaterial","#627179","__proto__","call","addBinding","#b3ffff","return (function() ","stateObject","constructor","neg-z.jpg","95333lwqzBU","MeshDepthMaterial","height","pos-y.jpg","error","336BmIKPg","1683156CIDSGS","bind","warn","change","10929015RYSBAp","log","TresPerspectiveCamera","6upmzwh","customWater","MeshLambertMaterial","neg-x.jpg","waterColor","debu","init","apply","MeshStandardMaterial","while (true) {}","浪头颜色","toString"];return(k=function(){return t})()}const F=J;!function(t,e){const n=J,r=k();for(;;)try{if(625962===parseInt(n(518))/1*(-parseInt(n(517))/2)+-parseInt(n(480))/3*(-parseInt(n(473))/4)+-parseInt(n(507))/5*(parseInt(n(514))/6)+parseInt(n(467))/7*(parseInt(n(472))/8)+parseInt(n(477))/9+-parseInt(n(504))/10+-parseInt(n(511))/11)break;r.push(r.shift())}catch(a){r.push(r.shift())}}();const R=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[J(487)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();!function(){R(this,(function(){const t=J,e=new RegExp(t(520)),n=new RegExp(t(521),"i"),r=E(t(486));e[t(497)](r+t(525))&&n.test(r+t(515))?E():r("0")}))()}();const N=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[J(487)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();N(void 0,(function(){const t=J,e=function(){const t=J;let e;try{e=Function(t(532)+t(499)+");")()}catch(n){e=window}return e}(),n=e[t(505)]=e.console||{},r=[t(478),t(475),"info",t(471),t(509),"table",t(508)];for(let a=0;a<r[t(513)];a++){const e=N.constructor[t(503)][t(474)](N),s=r[a],o=n[s]||e;e[t(528)]=N.bind(N),e[t(491)]=o[t(491)].bind(o),n[s]=e}}))();const A=v(F(479),{position:[5,5,5],fov:45,near:.1,far:1e3},null,-1),L=v(F(498),{intensity:.5},null,-1),Z=v("TresDirectionalLight",{position:[15,15,15],intensity:1},null,-1);function J(t,e){const n=k();return(J=function(t,e){return n[t-=464]})(t,e)}const $=u({__name:F(481),setup(e){const n=F,r=b({alpha:!0,toneMapping:t[n(519)],windowSize:!0,clearColor:10066329}),a=b({enableDamping:!0,autoRotate:!1}),l=b({cellSize:.6,cellThickness:1.1,cellColor:n(527),sectionColor:"#3a78a2",sectionSize:2.4,sectionThickness:1.8,fadeDistance:27,fadeStrength:.76,followCamera:!1,infiniteGrid:!0}),c=b({height:.2,Flatshading:!1,waterColor:n(524),waterHighlight:n(531),brightness:1,baseMaterial:"MeshPhysicalMaterial"}),u=new z;return u[n(530)](c,n(469),{label:"高度",min:.1,max:5,step:.1}),u[n(530)](c,n(484),{label:n(510)}),u[n(530)](c,n(512),{label:n(490)}),u[n(530)](c,"brightness",{label:"亮度",min:0,max:1,step:.01}),u[n(530)](c,"Flatshading",{label:n(493)}),u[n(501)]({view:"list",label:"材质",options:[{text:"MeshPhysicalMaterial",value:"MeshPhysicalMaterial"},{text:"MeshBasicMaterial",value:n(496)},{text:n(506),value:n(506)},{text:n(488),value:n(488)},{text:n(522),value:"MeshPhongMaterial"},{text:n(500),value:n(500)},{text:n(482),value:n(482)},{text:n(468),value:"MeshDepthMaterial"}],value:c[n(526)]}),u.on(n(476),(t=>{const e=n;"材质"===t[e(523)].label&&(c[e(526)]=t.value)})),(t,e)=>{const u=n;return h(),w(_(o),x(r,{"window-size":""}),{default:y((()=>[A,d(_(s),M(j(a)),null,16),L,Z,d(G,M(j(c)),null,16),d(_(I),x({args:[3,3]},l,{position:[0,-.5,0]}),null,16),(h(),w(C,null,{default:y((()=>[d(_(i),{files:[u(495),u(483),u(470),"neg-y.jpg","pos-z.jpg",u(466)],path:"https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/images/skyBox/6jpg/"})])),_:1}))])),_:1},16)}}});function E(t){function e(t){const n=J;if(typeof t===n(494))return function(t){}.constructor(n(489)).apply(n(516));1!==(""+t/t)[n(513)]||t%20==0?function(){return!0}[n(465)](n(485)+n(492))[n(529)](n(502)):function(){return!1}[n(465)]("debugger").apply(n(464)),e(++t)}try{if(t)return e;e(0)}catch(n){}}export{$ as default};
