import{M as e}from"./mqttTvt.BiJsvMtQ1763540743861.js";import{_ as l}from"./@fesjs.BEMFm_yJ1763540743861.js";import{u as a,c as t,d as s,F as u,g as o,G as n,a as r,B as i,D as v,H as d,N as c}from"./naive-ui.qjPOP62h1763540743861.js";import{r as p,a as m,W as f,H as j,o as b,h as _,e as g,u as h,y,F as w,X as T,b as k,N as U}from"./@vue.Co_gxueH1763540743861.js";import"./events.BU9utmI-1763540743861.js";import"./mqtt.DXh7Xpg31763540743861.js";import"./vue-router.BxG8XxK11763540743861.js";import"./lodash-es.B7GkVYRo1763540743861.js";import"./@vueuse.CfFJ-iFV1763540743861.js";import"./pinia.CEQ6XgE61763540743861.js";import"./@qlin.y-0Z8WnK1763540743861.js";import"./@babel.BPq7uOAK1763540743861.js";import"./@floating-ui.Bhq4ibgf1763540743861.js";import"./@juggle.Vc7cP4_P1763540743861.js";import"./date-fns.eh-WGDI81763540743861.js";import"./@css-render.DtSd-BuN1763540743861.js";import"./css-render.Dlx27V_T1763540743861.js";import"./@emotion.DFFAhID71763540743861.js";import"./seemly.D2hUckm91763540743861.js";import"./vooks.CVMU_ROE1763540743861.js";import"./evtd.C4K_ichY1763540743861.js";import"./vueuc.CEvnhvIm1763540743861.js";import"./vdirs.DlTVi7SG1763540743861.js";import"./treemate.Qc8YxXqZ1763540743861.js";import"./date-fns-tz.CIz1xaH61763540743861.js";import"./async-validator.DJtlKCAR1763540743861.js";const q={class:"w-full",style:{"background-color":"#ffffff"}},x=l({__name:"MqttTesterUI",setup(l){const x=a(),M=p({host:"a5183db3.ala.asia-southeast1.emqxsl.com",port:8084,protocol:"wss",clientId:`tvt-test-client-${Math.random().toString(16).slice(2,8)}`,username:"tvt.js",password:"test",topic:"tvtDevices/#"}),I=m("tvtDevices/uiDemo"),$=m('{ "hello": "world" }'),C=m(null),D=m(!1),N=m([]),Q=m(!1);function S(){C.value&&(C.value.removeAllListeners(),C.value.disconnect(),C.value=null,D.value=!1)}function J(){S(),Q.value=!0,C.value=new e(M),C.value.on("connected",()=>{D.value=!0,Q.value=!1,x.success("MQTT 连接成功")}),C.value.on("close",()=>{D.value=!1,Q.value=!1,x.warning("MQTT 连接关闭")}),C.value.on("error",e=>{Q.value=!1,console.error(e),x.error(`MQTT 错误: ${e.message}`)}),C.value.on("message",(e,l)=>{N.value.push(`[${e}] ${JSON.stringify(l)}`),N.value.length>100&&N.value.shift()}),C.value.connect()}const F=m(new Set);function H(){if(C.value)for(const e of F.value)C.value.unsubscribe(e);F.value.clear(),S(),x.success("已断开连接")}function O(){if(!C.value||!D.value)return void x.warning("尚未连接 MQTT");const e=M.topic?.trim();e?F.value.has(e)?x.info(`已订阅该主题：${e}`):(C.value.subscribe(e),F.value.add(e),x.success(`订阅成功：${e}`)):x.warning("请输入订阅主题")}function A(){try{const e=JSON.parse($.value);C.value.publish(I.value,e),x.info("已发送消息")}catch(e){x.error("JSON 格式错误")}}return f(()=>{H()}),(e,l)=>(b(),j("div",q,[_(h(c),{title:"MQTT 调试面板",class:"max-w-4xl mx-auto"},{default:g(()=>[_(h(t),{model:M,"label-width":"100"},{default:g(()=>[_(h(s),{label:"注意："},{default:g(()=>[_(h(u),{style:{"margin-left":"10px"},type:"warning"},{default:g(()=>[...l[8]||(l[8]=[y("免费服务每月流量/次数有限，若连接失败请自行更换自己的mqtt服务",-1)])]),_:1})]),_:1}),_(h(s),{label:"地址"},{default:g(()=>[_(h(o),{value:M.host,"onUpdate:value":l[0]||(l[0]=e=>M.host=e),placeholder:"例如: broker.hivemq.com"},null,8,["value"])]),_:1}),_(h(s),{label:"端口"},{default:g(()=>[_(h(n),{value:M.port,"onUpdate:value":l[1]||(l[1]=e=>M.port=e),min:1},null,8,["value"]),_(h(u),{style:{"margin-left":"10px"},type:"info"},{default:g(()=>[...l[9]||(l[9]=[y("浏览器端只支持：wws方式 的 mqtt",-1)])]),_:1})]),_:1}),_(h(s),{label:"Client ID"},{default:g(()=>[_(h(o),{value:M.clientId,"onUpdate:value":l[2]||(l[2]=e=>M.clientId=e),placeholder:"随机生成也可"},null,8,["value"])]),_:1}),_(h(s),{label:"用户名"},{default:g(()=>[_(h(o),{value:M.username,"onUpdate:value":l[3]||(l[3]=e=>M.username=e)},null,8,["value"])]),_:1}),_(h(s),{label:"密码"},{default:g(()=>[_(h(o),{value:M.password,"onUpdate:value":l[4]||(l[4]=e=>M.password=e)},null,8,["value"])]),_:1}),_(h(s),{label:"订阅主题"},{default:g(()=>[_(h(o),{value:M.topic,"onUpdate:value":l[5]||(l[5]=e=>M.topic=e),placeholder:"例如: tvt/demo"},null,8,["value"])]),_:1}),_(h(r),null,{default:g(()=>[_(h(i),{type:"primary",disabled:D.value||Q.value,loading:Q.value,onClick:J},{default:g(()=>[...l[10]||(l[10]=[y("连接",-1)])]),_:1},8,["disabled","loading"]),_(h(i),{type:"warning",disabled:!D.value,onClick:H},{default:g(()=>[...l[11]||(l[11]=[y("断开",-1)])]),_:1},8,["disabled"]),_(h(i),{type:"success",disabled:!D.value,onClick:O},{default:g(()=>[...l[12]||(l[12]=[y("订阅",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"]),_(h(v),null,{default:g(()=>[...l[13]||(l[13]=[y("已订阅主题",-1)])]),_:1}),_(h(r),null,{default:g(()=>[(b(!0),j(w,null,T(Array.from(F.value),e=>(b(),k(h(u),{key:e,type:"info",round:""},{default:g(()=>[y(U(e),1)]),_:2},1024))),128))]),_:1}),_(h(v),null,{default:g(()=>[...l[14]||(l[14]=[y("发送消息 [主题/json消息]",-1)])]),_:1}),_(h(o),{value:I.value,"onUpdate:value":l[6]||(l[6]=e=>I.value=e),placeholder:"主题",class:"mb-2"},null,8,["value"]),_(h(o),{value:$.value,"onUpdate:value":l[7]||(l[7]=e=>$.value=e),type:"textarea",placeholder:'{ "key": "value" }',rows:4},null,8,["value"]),_(h(i),{type:"info",class:"mt-2",disabled:!D.value,onClick:A},{default:g(()=>[...l[15]||(l[15]=[y("发送",-1)])]),_:1},8,["disabled"]),_(h(v),null,{default:g(()=>[...l[16]||(l[16]=[y("收到的消息",-1)])]),_:1}),_(h(d),{log:N.value.join("\n"),rows:12},null,8,["log"])]),_:1})]))}},[["__scopeId","data-v-e8d1d438"]]);export{x as default};
