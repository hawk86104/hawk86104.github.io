{"version":3,"file":"precipitation.vue_vue_type_script_setup_true_lang.DHN0dZRK1767105581793.js","sources":["../../src/plugins/digitalCity/components/weather/precipitation.vue"],"sourcesContent":["<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-03-22 11:14:44\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-10-08 11:27:55\n-->\n<script setup lang=\"ts\">\nimport { watch } from 'vue'\nimport { Precipitation } from '@tresjs/cientos'\nimport * as THREE from 'three'\n\nconst props = withDefaults(\n\tdefineProps<{\n\t\tspeed?: number\n\t\trandomness?: number\n\t\tcount?: number\n\t\tsize?: number\n\t\tareaX?: number\n\t\tareaY?: number\n\t\tareaZ?: number\n\t\ttype?: string\n\t\tcolor?: string\n\t}>(),\n\t{\n\t\tspeed: 12,\n\t\trandomness: 0,\n\t\tcount: 6000,\n\t\tsize: 7,\n\t\tareaX: 1500,\n\t\tareaY: 1000,\n\t\tareaZ: 1500,\n\t\tcolor: '#fff',\n\t\ttype: 'snow', // snow rain point\n\t},\n)\n\nconst imgList: Record<string, string> = {\n\tsnow: './plugins/digitalCity/image/snow.png',\n\train: './plugins/digitalCity/image/rain.png',\n\tpoint: './plugins/digitalCity/image/cilcle.png',\n}\n\nconst textureCache: Record<string, THREE.Texture> = {}\nconst preloadTextures = async () => {\n\tconst loader = new THREE.TextureLoader()\n\tconst promises = Object.entries(imgList).map(([key, url]) => {\n\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\tloader.load(\n\t\t\t\turl,\n\t\t\t\t(tex) => {\n\t\t\t\t\ttex.wrapS = tex.wrapT = THREE.ClampToEdgeWrapping\n\t\t\t\t\ttex.needsUpdate = true\n\t\t\t\t\ttextureCache[key] = tex\n\t\t\t\t\tresolve()\n\t\t\t\t},\n\t\t\t\tundefined,\n\t\t\t\treject\n\t\t\t)\n\t\t})\n\t})\n\tawait Promise.all(promises)\n\tconsole.log('✅ 所有图片预加载完成:', Object.keys(textureCache))\n}\nconst getTexture = (key: keyof typeof imgList) => {\n\treturn textureCache[key]\n}\nawait preloadTextures()\nlet curRexture = null\nwatch(\n\t() => props.type,\n\t(nv, ov) => {\n\t\tif (nv !== ov) {\n\t\t\tcurRexture = getTexture(nv)\n\t\t}\n\t},\n\t{\n\t\timmediate: true,\n\t}\n)\n</script>\n\n<template>\n\t<Precipitation ref=\"precipitationRef\" :position=\"[0, props.areaY / 2, 0]\" :speed=\"props.speed\" :color=\"props.color\"\n\t\t:alphaTest=\"0.5\" :area=\"[props.areaX, props.areaY, props.areaZ]\" :count=\"props.count\" :depthWrite=\"true\"\n\t\t:randomness=\"props.randomness\" :size=\"props.size\" :opacity=\"1.0\" :map=\"curRexture\" :alphaMap=\"curRexture\" />\n</template>\n"],"names":["Precipitation"],"mappings":"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"}