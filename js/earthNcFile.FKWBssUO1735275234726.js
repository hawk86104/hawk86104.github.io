import"./index.TLT00pgR1735275234726.js";import{_ as n,p as t,V as e,b3 as r,aD as o,n as a,bf as i}from"./three.jpi2UCEx1735275234726.js";import{m as s,j as c}from"./@tresjs.fCqPNEAw1735275234726.js";import{d as u,v as l,w as p,b as f,U as m,u as d,o as y,D as g,I as v,a6 as h,a as b,J as x,aj as I,ak as w,j as _,f as j,g as z,al as T,F as S,r as D,e as A,m as P}from"./@vue.u2cBPEWn1735275234726.js";import{M as E}from"./three-stdlib.FRPXc4iL1735275234726.js";import{_ as R}from"./three-tile.rGySB-KI1735275234726.js";import{N as F}from"./netcdfjs.NSmi_VwF1735275234726.js";import{u as k,a as M,_ as B}from"./colorList.567T_HVv1735275234726.js";import{P as C}from"./tweakpane.yHWGBmom1735275234726.js";import{s as L,c as O}from"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.Vqf2IIpe1735275234726.js";import{a as N}from"./mapBoxShow.vue_vue_type_script_setup_true_lang.m9zUQLfh1735275234726.js";import{i as Z}from"./informationDiv.5Sp-_-9Z1735275234726.js";import"./three-custom-shader-material.6yZB66Qf1735275234726.js";import"./3d-tiles-renderer.ZM11wK2X1735275234726.js";import"./index.lfv-WZoG1735275234726.js";import"./@mapbox.csZ6D8nW1735275234726.js";import"./@amap.Ndko9EDY1735275234726.js";import"./three-mesh-bvh.4sDkzARF1735275234726.js";import"./utils.fUTai4E91735275234726.js";import"./@tweenjs.oXZvc3ug1735275234726.js";import"./utils.kAQQYNep1735275234726.js";import"./@fesjs.Okr_vpx41735275234726.js";import"./vue-router.bq4JfoTS1735275234726.js";import"./lodash-es.guXTxyfJ1735275234726.js";import"./@qlin.yHhFDldE1735275234726.js";import"./pinia.BXllYoho1735275234726.js";import"./vue-demi.C4xddsk91735275234726.js";import"./@floating-ui.BPbuo5Gx1735275234726.js";import"./@juggle.7yjBMqoW1735275234726.js";import"./d3-geo.x9XnJzvq1735275234726.js";import"./d3-array.AhNJy1f41735275234726.js";import"./http.b15ZA3tF1735275234726.js";import"./axios.Ng308AU61735275234726.js";import"./color.xvgJ6c6C1735275234726.js";import"./color-string.nM7yNXxR1735275234726.js";import"./color-name.ATxH9ThD1735275234726.js";import"./simple-swizzle.n4jro9WC1735275234726.js";import"./is-arrayish.maCmYx6O1735275234726.js";import"./color-convert.YaFMCFuo1735275234726.js";import"./lodash.dF9mtFPa1735275234726.js";import"./naive-ui.R1K5pKrL1735275234726.js";import"./date-fns.5Hiebz9E1735275234726.js";import"./@css-render.vQx0qtar1735275234726.js";import"./seemly.SjiSeX2v1735275234726.js";import"./css-render.othunQqw1735275234726.js";import"./@emotion.ZD_ZYAgY1735275234726.js";import"./vooks.uTCm0eHJ1735275234726.js";import"./evtd.DtfwxtIl1735275234726.js";import"./vueuc.grpJrXZx1735275234726.js";import"./vdirs.iwfkb0301735275234726.js";import"./treemate.dcEdf2le1735275234726.js";import"./date-fns-tz.VdnYgkU-1735275234726.js";import"./async-validator.-YBkpS4I1735275234726.js";import"./@vueuse.8jEBPPFT1735275234726.js";import"./iobuffer.X3Ykb-iF1735275234726.js";!function(n,t){const e=V,r=J();for(;;)try{if(537112===-parseInt(e(396))/1*(parseInt(e(377))/2)+parseInt(e(378))/3*(-parseInt(e(376))/4)+-parseInt(e(399))/5*(-parseInt(e(388))/6)+-parseInt(e(397))/7+parseInt(e(375))/8*(-parseInt(e(391))/9)+-parseInt(e(362))/10*(parseInt(e(374))/11)+parseInt(e(358))/12)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const G=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[V(365)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();function V(n,t){const e=J();return(V=function(n,t){return e[n-=358]})(n,t)}!function(){G(this,(function(){const n=V,t=new RegExp(n(382)),e=new RegExp(n(368),"i"),r=X(n(381));t[n(400)](r+n(369))&&e.test(r+n(386))?X():r("0")}))()}();const q=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[V(365)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();q(void 0,(function(){const n=V;let t;try{t=Function("return (function() "+n(387)+");")()}catch(o){t=window}const e=t[n(367)]=t[n(367)]||{},r=[n(370),"warn",n(390),n(392),n(383),"table","trace"];for(let a=0;a<r[n(373)];a++){const t=q[n(363)][n(366)].bind(q),o=r[a],i=e[o]||t;t[n(404)]=q[n(360)](q),t[n(393)]=i[n(393)][n(360)](i),e[o]=t}}))();const H=u({__name:"skyBoxMesh",props:{texture:{}},setup(t){const e=V,r=t,{scene:o}=s(),a=(new(n[e(364)]))[e(403)](r[e(389)]).load([e(394),e(372),e(380),e(402),e(379),"neg-z.png"]);return o[e(395)].environment=a,o[e(395)][e(384)]=a,(n,t)=>null}});function J(){const n=["neg-x.png","length","4240291ezqGgX","4432CgewBC","72zusgkS","1098866dDDulL","112737ImlJxo","pos-z.png","pos-y.png","init","function *\\( *\\)","exception","background","gger","input",'{}.constructor("return this")( )',"720oOakSJ","texture","info","3825ozdFix","error","toString","pos-x.png","value","1mTpikF","1909733EVRsuK","debu","2815GtDWYz","test","counter","neg-y.png","setPath","__proto__","31069884pCHhMi","action","bind","while (true) {}","10icNUal","constructor","CubeTextureLoader","apply","prototype","console","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","log","string"];return(J=function(){return n})()}function X(n){function t(n){const e=V;if(typeof n===e(371))return function(n){}[e(363)](e(361))[e(365)](e(401));1!==(""+n/n)[e(373)]||n%20==0?function(){return!0}[e(363)](e(398)+e(385)).call(e(359)):function(){return!1}[e(363)](e(398)+"gger")[e(365)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(e){}}const Y=Q;!function(n,t){const e=Q,r=nn();for(;;)try{if(325757===-parseInt(e(342))/1+parseInt(e(309))/2*(-parseInt(e(328))/3)+-parseInt(e(343))/4*(parseInt(e(326))/5)+-parseInt(e(350))/6+parseInt(e(340))/7+-parseInt(e(319))/8*(parseInt(e(300))/9)+-parseInt(e(313))/10*(-parseInt(e(337))/11))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const $=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,r}}();!function(){$(this,(function(){const n=Q,t=new RegExp(n(304)),e=new RegExp(n(348),"i"),r=tn("init");t[n(318)](r+"chain")&&e[n(318)](r+n(316))?tn():r("0")}))()}();const U=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[Q(325)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();U(void 0,(function(){const n=Q;let t;try{t=Function(n(344)+n(329)+");")()}catch(o){t=window}const e=t[n(353)]=t[n(353)]||{},r=[n(347),"warn","info",n(306),"exception",n(356),n(331)];for(let a=0;a<r[n(335)];a++){const t=U[n(333)][n(320)].bind(U),o=r[a],i=e[o]||t;t[n(314)]=U[n(323)](U),t[n(334)]=i.toString[n(323)](i),e[o]=t}}))();const W=["args",Y(336),Y(305),"enable-damping",Y(354),"enable-pan",Y(308),Y(357),Y(297),Y(298),"max-polar-angle",Y(338),Y(341),Y(299),Y(359),Y(349),Y(317),Y(322),Y(321),Y(302)];function Q(n,t){const e=nn();return(Q=function(n,t){return e[n-=295]})(n,t)}const K=u({__name:Y(310),props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number[Y(301)]},minAzimuthAngle:{default:Number[Y(315)]},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number[Y(301)]},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change",Y(324),Y(312)],setup(n,{expose:t,emit:e}){const r=n,{autoRotate:o,autoRotateSpeed:a,enableDamping:i,dampingFactor:u,enablePan:h,keyPanSpeed:b,maxAzimuthAngle:x,minAzimuthAngle:I,maxPolarAngle:w,minPolarAngle:_,minDistance:j,maxDistance:z,minZoom:T,maxZoom:S,enableZoom:D,zoomSpeed:A,enableRotate:P,rotateSpeed:R}=l(r),{camera:F,renderer:k,extend:M,controls:B,invalidate:C}=s();p(r,(()=>{C()}));const L=f(null);M({MapControls:E}),p(L,(n=>{const t=Q;n&&r[t(332)]?B[t(355)]=n:B[t(355)]=null}));const{onBeforeRender:O}=c();return O((({invalidate:n})=>{const t=Q;L.value&&(i[t(355)]||o[t(355)])&&(L[t(355)][t(346)](),n())})),m((()=>{const n=Q;L[n(355)]&&L[n(355)][n(296)]()})),t({instance:L}),(n,t)=>{const e=Q;return(n.camera||d(F))&&(n[e(311)]||d(k))?(y(),g("TresMapControls",{key:0,ref_key:e(352),ref:L,args:[n[e(358)]||d(F),n[e(311)]||d(k)[e(311)]],"auto-rotate":d(o),"auto-rotate-speed":d(a),"enable-damping":d(i),"damping-factor":d(u),"enable-pan":d(h),"key-pan-speed":d(b),keys:n[e(357)],"max-azimuth-angle":d(x),"min-azimuth-angle":d(I),"max-polar-angle":d(w),"min-polar-angle":d(_),"min-distance":d(j),"max-distance":d(z),"min-zoom":d(T),"max-zoom":d(S),"enable-zoom":d(D),"zoom-speed":d(A),"enable-rotate":d(P),"rotate-speed":d(R)},null,8,W)):v("",!0)}}});function nn(){const n=["__proto__","NEGATIVE_INFINITY","input","enable-zoom","test","121112KWWYjj","prototype","enable-rotate","zoom-speed","bind","start","apply","1597705EVoTqX","string","1977DJjUlN",'{}.constructor("return this")( )',"change","trace","makeDefault","constructor","toString","length","auto-rotate","45551xiiuuO","min-polar-angle","action","3773147RbCfZe","min-distance","488780fIMeep","4lYCzeC","return (function() ","stateObject","update","log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","max-zoom","2437524pqiUZb","gger","controlsRef","console","damping-factor","value","table","keys","camera","min-zoom","counter","dispose","max-azimuth-angle","min-azimuth-angle","max-distance","45dFIaBk","POSITIVE_INFINITY","rotate-speed","while (true) {}","function *\\( *\\)","auto-rotate-speed","error","debu","key-pan-speed","1218yHCBob","MapControls","domElement","end","3570cqfazd"];return(nn=function(){return n})()}function tn(n){function t(n){const e=Q;if(typeof n===e(327))return function(n){}[e(333)](e(303))[e(325)](e(295));1!==(""+n/n)[e(335)]||n%20==0?function(){return!0}[e(333)](e(307)+e(351)).call(e(339)):function(){return!1}.constructor("debu"+e(351))[e(325)](e(345)),t(++n)}try{if(n)return t;t(0)}catch(e){}}function en(n,t){const e=an();return(en=function(n,t){return e[n-=463]})(n,t)}!function(n,t){const e=en,r=an();for(;;)try{if(201044===-parseInt(e(520))/1*(-parseInt(e(478))/2)+parseInt(e(538))/3*(-parseInt(e(544))/4)+-parseInt(e(546))/5+-parseInt(e(523))/6+parseInt(e(496))/7+parseInt(e(487))/8*(parseInt(e(486))/9)+parseInt(e(465))/10)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const rn=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,r}}();!function(){rn(this,(function(){const n=en,t=new RegExp(n(499)),e=new RegExp(n(533),"i"),r=ln(n(485));t.test(r+n(474))&&e[n(466)](r+n(504))?ln():r("0")}))()}();const on=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,r}}();function an(){const n=["short","call","variable","prototype","UnsignedByteType","body","variables","log","status","HTTP error! status: ","max","2eBqYnc","unsupported type : ","console","1589418EfPpRO","getInt16","getInt32","length","stateObject","bytesReceived","cancel","trace","toString","data","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","size","table","int","27toNMrw","read","xLength","dimensions","recordDimension","constructor","115808cqBGBG","type","930765iADNWP","getFloat64","yLength","format","getReader","FloatType","reader","name","__proto__","buffer","magFilter","Accept-Ranges","Data3DTexture","Content-Length","3427980RnmWev","test","record","min","double","headers","zLength","arrayBuffer","error","chain","RedFormat","LinearFilter","info","198392JVpIGX","then","float","warn","done","while (true) {}","netcdf header头文件不合法!","init","51354OFbiYe","72PAejOD",'{}.constructor("return this")( )',"debu","gger","subarray","minFilter","set","bind","getInt8","2240868bVGFRP","needsUpdate","bytes=","function *\\( *\\)","byte","acceptRanges","value","unpackAlignment","input","url","resolve","get","bytes"];return(an=function(){return n})()}on(void 0,(function(){const n=en,t=function(){const n=en;let t;try{t=Function("return (function() "+n(488)+");")()}catch(e){t=window}return t}(),e=t[n(522)]=t[n(522)]||{},r=["log",n(481),n(477),n(473),"exception",n(536),n(530)];for(let o=0;o<r[n(526)];o++){const t=on.constructor[n(512)].bind(on),a=r[o],i=e[a]||t;t[n(554)]=on[n(494)](on),t.toString=i[n(531)].bind(i),e[a]=t}}))();function sn(n,t,e=0){const r=en,o=function(n,t,e){const r=en;switch(e){case r(500):return e=>n[r(495)](t+e,!1);case"short":return e=>n[r(524)](t+2*e,!1);case r(537):return e=>n[r(525)](t+4*e,!1);case"float":return e=>n.getFloat32(t+4*e,!1);case r(469):return e=>n[r(547)](t+8*e,!1);default:return console[r(473)](r(521),e),()=>0}}(new DataView(n),e,t.type);t[r(532)]=function(n){const t=en;switch(n.type){case"byte":return new Uint8Array(n[t(535)]);case t(509):return new Float32Array(n.size);case t(537):return new Float32Array(n[t(535)]);case t(480):return new Float32Array(n.size);case t(469):return new Float32Array(n[t(535)]);default:return console[t(473)](t(521),n.type),()=>0}}(t),t[r(468)]=1/0,t.max=-1/0,t[r(467)]&&console.warn("decoding of record data is not fully supported yet",t[r(467)]);for(let a=0;a<t[r(535)];a++){const n=o(a);t[r(532)][a]=n,t[r(468)]>n&&(t.min=n),t[r(519)]<n&&(t[r(519)]=n)}return t}function cn(n,t,e){const r=en;if(e>=t[r(541)][r(526)])return 1;const o=t[r(541)][e],a=n[r(542)];return o===a.id?a.length:n[r(541)][o][r(535)]}function un(e){const r=en;if(function(e){const r=en;switch(e){case r(500):return n[r(513)];case r(509):case"int":return n[r(551)];case r(480):return t;case r(469):return n[r(551)];default:return void console[r(473)](r(521),e)}}(e[r(545)])!==n[r(551)])return e;for(let n=0;n<e[r(535)];n++)e[r(532)][n]=Math[r(468)](1,Math.max(0,(e[r(532)][n]-e[r(468)])/(e[r(519)]-e[r(468)])));return e}function ln(n){function t(n){const e=en;if("string"==typeof n)return function(n){}[e(543)](e(483)).apply(e(534));1!==(""+n/n)[e(526)]||n%20==0?function(){return!0}[e(543)](e(489)+e(490))[e(510)]("action"):function(){return!1}[e(543)](e(489)+"gger").apply(e(527)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const pn=hn;function fn(){const n=["primitive","filter","LinearFilter","list","scale","44454YrwsrD","TresBoxGeometry","yLength","3589747fvnQiG","setArrayBuffer","type","Data3DTexture","addBlade","maximumIntensity","length","u_clim","init","zExtent","console","info","573150ZXGzPT","Vector2","needsUpdate","updateTransferFunction","是否反色","chain","action","TresShaderMaterial","log","map","wrapS","variables",'{}.constructor("return this")( )',"thresholding","colorsStops","minFilter","EdgesGeometry","exception","uniforms","zLength","RedFormat","454840VTzoGd","test","TresMesh","position","384766CySyld","table","gger","prototype","toString","input","composeType","dimensions","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","matrix","object","value","error","rotation","threshold","xExtent","alphaScale","apply","wrapT","addBinding","while (true) {}","return (function() ","constructor","__proto__","yExtent","显示边框","warn","string","bind","体绘制的阈值","46884TpXxFJ","geo2pos","setDataTypeFromJSdata","LineBasicMaterial","clim2","data","BackSide","clim1","THT","TresGroup","byteArray","name","debu","applyMatrix4","invertColor","stateObject","function *\\( *\\)","getThreeType","364192bQLzXH","trace","format"];return(fn=function(){return n})()}!function(n,t){const e=hn,r=fn();for(;;)try{if(302497===-parseInt(e(538))/1+parseInt(e(490))/2+-parseInt(e(498))/3+parseInt(e(472))/4+parseInt(e(534))/5+-parseInt(e(513))/6+parseInt(e(501))/7)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const mn=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,r}}();!function(){mn(this,(function(){const n=hn,t=new RegExp(n(488)),e=new RegExp(n(546),"i"),r=xn(n(509));t[n(535)](r+n(518))&&e[n(535)](r+n(543))?xn():r("0")}))()}();const dn=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[hn(459)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();dn(void 0,(function(){const n=hn;let t;try{t=Function(n(463)+n(525)+");")()}catch(o){t=window}const e=t[n(511)]=t.console||{},r=[n(521),n(468),n(512),n(550),n(530),n(539),n(491)];for(let a=0;a<r[n(507)];a++){const t=dn.constructor[n(541)][n(470)](dn),o=r[a],i=e[o]||t;t[n(465)]=dn[n(470)](dn),t[n(542)]=i[n(542)][n(470)](i),e[o]=t}}))();const yn=[pn(537),pn(551)],gn=[pn(497),"visible"],vn=[pn(548)];function hn(n,t){const e=fn();return(hn=function(n,t){return e[n-=459]})(n,t)}const bn=u({__name:"volumeMesh",props:{map:{}},async setup(t){const s=pn;let c,u;const l=t,m=l[s(522)][s(473)](new e(118.724419,32.010354,200.8));m[s(485)](l[s(522)][s(547)]);const _=f(1),j=f(1),z=f(1),T=k(),S=new r(new(n[s(529)])(new o(1,1,1)),new(n[s(475)])({color:10066329})),D=([c,u]=h((()=>(async n=>{const t=en,e=await fetch(n,{method:"GET"});if(!e.ok)throw new Error(t(518)+e[t(517)]);const r=e[t(514)][t(550)]();let o=0,a=null;return await r[t(539)]()[t(479)]((function n(i){const s=t,c=o+i[s(502)].length;if(a){const n=a[s(491)](0,o);a=new Uint8Array(c),a[s(493)](n,0,o),a[s(493)](i.value,o)}else a=i[s(502)];o=c;try{const n=new F(a);return n[s(505)]=e.url,n.reader=r,n.bytesTotal=e[s(470)][s(507)](s(464)),n[s(501)]=e[s(470)][s(507)](s(557))===s(508),n.bytesReceived=o,n}catch(u){return i[s(482)]?void console[s(516)](s(484)):r.read().then(n)}}))})("https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/ncFile/2003.nc"))),c=await c,u(),c),A=D[s(524)][s(494)]((n=>3==n[s(545)].length)),P=f(s(480)),E=M(),R=async()=>{const n=s,t=un(await function(n,t,e=!1){const r=en;void 0===n.bytesReceived&&(n[r(528)]=n[r(555)].byteLength);const o=e||n[r(501)],a=n[r(515)].find((n=>n.name===t)),i={variable:t,xLength:cn(n,a,0),yLength:cn(n,a,1),zLength:cn(n,a,2),type:a[r(545)]};a.record&&(i[r(467)]=n[r(542)]),i[r(535)]=i[r(540)]*i[r(548)]*i[r(471)];const s=a.offset,c=s+a[r(535)]-1;if(!o&&c>=n[r(528)])return fetch(n[r(505)])[r(479)]((n=>n.arrayBuffer())).then((n=>sn(n,i,s)));if(n.reader&&(n[r(552)][r(529)](),n[r(552)]=void 0),c<n[r(528)])return Promise[r(506)](sn(n.buffer.buffer,i,s));const u=new Headers({Range:r(498)+s+"-"+c});return fetch(n[r(505)],{headers:u})[r(479)]((n=>n[r(472)]()))[r(479)]((n=>sn(n,i)))}(D,P[n(549)]));console.log(t),E[n(474)](t[n(477)]),E[n(553)]=t.xLength,E.yExtent=t[n(500)],E.zExtent=t[n(532)],E[n(502)](t[n(477)]),_.value=400,j[n(549)]=E[n(466)]/E[n(553)]*400,z[n(549)]=E[n(510)]/E.xExtent*400};[c,u]=h((()=>R())),await c,u();const B=b((()=>{const n=s;return!(_[n(549)]<=.01&&_[n(549)]>=-.01)&&(!(j[n(549)]<=.01&&j[n(549)]>=-.01)&&!(z[n(549)]<=.01&&z[n(549)]>=-.01))})),L=()=>{const t=s,e=new(n[t(504)])(E[t(482)],E[t(553)],E[t(466)],E[t(510)]);return e[t(492)]=n[t(533)],e[t(503)]=E[t(489)](),e[t(528)]=n[t(495)],e.magFilter=a,e[t(523)]=i,e[t(460)]=i,e.wrapR=i,e[t(515)]=!0,e},O={uniforms:{dataTexture:{value:L()},colorTexture:{value:T.updateTransferFunction()},samplingRate:{value:4},threshold:{value:.5},alphaScale:{value:1},invertColor:{value:!1},composeType:{value:1},u_clim:{value:new(n[s(514)])(.093,-.001)}},vertexShader:"out vec3 vOrigin; \nout vec3 vDirection;  \nvarying vec3 vPosition;\n\nvoid main() {\n  vPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n  \n  \n  vOrigin = vec3(inverse(modelMatrix) * vec4(cameraPosition, 1.0)).xyz;\n  \n  vDirection = position - vOrigin;\n\n  \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"precision highp sampler3D; \nprecision highp float;     \n\nuniform sampler3D dataTexture;  \nuniform sampler2D colorTexture; \nuniform float samplingRate;     \nuniform float threshold;  \nuniform float alphaScale; \nuniform bool invertColor; \nuniform float composeType;\n\nin vec3 vOrigin;    \nin vec3 vDirection; \n\nuniform vec4 clipPlanesArray[3]; \nvarying vec3 vPosition;\nuniform vec2 u_clim;\n\nfloat sampleData(vec3 texcoords) {\n\t\treturn (texture(dataTexture, texcoords.xyz).r - u_clim[0]) / (u_clim[1] - u_clim[0]);\n}\n\nvec4 sampleColor(float value) {\n  \n  \n  float x = invertColor ? 1. - value : value;\n  return texture(colorTexture, vec2(x, .5));\n}\n\nvec2 intersectAABB(vec3 rayOrigin, vec3 rayDir, vec3 boxMin, vec3 boxMax) {\n  vec3 tMin = (boxMin - rayOrigin) / rayDir;\n  vec3 tMax = (boxMax - rayOrigin) / rayDir;\n  vec3 t1 = min(tMin, tMax);\n  vec3 t2 = max(tMin, tMax);\n  float tNear = max(max(t1.x, t1.y), t1.z);\n  float tFar = min(min(t2.x, t2.y), t2.z);\n\n  return vec2(tNear, tFar);\n}\n\nvec4 compose_maximumIntensity(vec4 color, vec3 entryPoint, vec3 rayDir,\n                              float samples, float tStart, float tEnd,\n                              float tIncr) {\n  \n  \n  float density = 0.;\n  for (float i = 0.; i < samples; i += 1.) {\n    \n    float t = tStart + tIncr * i;     \n    vec3 p = entryPoint + rayDir * t; \n\n    \n    float value = sampleData(p);\n\n    \n    if (value > density) {\n      \n      density = value;\n    }\n\n    \n    \n    if (density >= 1. || t > tEnd) {\n      break;\n    }\n  }\n\n  \n  color.rgb = sampleColor(density).rgb;\n  \n  color.a = alphaScale * (invertColor ? 1. - density : density);\n\n  \n  return color;\n}\n\nvec4 compose_thresholding(vec4 color, vec3 entryPoint, vec3 rayDir,\n                          float samples, float tStart, float tEnd,\n                          float tIncr) {\n  \n  \n\n  \n  \n  for (float i = 0.; i < samples; i += 1.) {\n    \n    float t = tStart + tIncr * i;     \n    vec3 p = entryPoint + rayDir * t; \n\n    \n    float value = sampleData(p);\n\n    \n    if (value >= threshold || t > tEnd) {\n      \n      color.rgb = sampleColor(value).rgb;\n      \n      color.a = alphaScale;\n      break;\n    }\n  }\n\n  \n  return color;\n}\nvec4 compose_emissionAbsorption(vec4 color, vec3 entryPoint, vec3 rayDir,\n                                float samples, float tStart, float tEnd,\n                                float tIncr) {\n  \n\n  \n  \n  for (float i = 0.; i < samples; i += 1.) {\n    \n    float t = tStart + tIncr * i;     \n    vec3 p = entryPoint + rayDir * t; \n\n    \n    float value = sampleData(p);\n    \n    vec4 valueColor = sampleColor(value);\n\n    \n    valueColor.a *= value * alphaScale;\n    valueColor.rgb *= valueColor.a;\n\n    color.rgb += (1. - color.a) * valueColor.rgb;\n    color.a += (1. - color.a) * valueColor.a;\n\n    \n    \n    if (color.a >= .99 || t > tEnd) {\n      break;\n    }\n  }\n\n  \n  return color;\n}\nvec4 compose(vec4 color, vec3 entryPoint, vec3 rayDir, float samples,\n             float tStart, float tEnd, float tIncr) {\n  if (composeType == 1.) {\n    return compose_maximumIntensity(color, entryPoint, rayDir, samples, tStart,\n                                    tEnd, tIncr);\n  }\n  if (composeType == 2.) {\n    return compose_thresholding(color, entryPoint, rayDir, samples, tStart,\n                                tEnd, tIncr);\n  }\n  if (composeType == 3.) {\n    return compose_emissionAbsorption(color, entryPoint, rayDir, samples,\n                                      tStart, tEnd, tIncr);\n  }\n}\n\nvoid main() {\n  \n  vec3 rayDir = normalize(vDirection);\n  vec3 aabbmin = vec3(-.5);\n  vec3 aabbmax = vec3(.5);\n  vec2 intersection = intersectAABB(vOrigin, rayDir, aabbmin, aabbmax);\n\n  \n  vec4 color = vec4(0.);\n\n  \n  \n  if (intersection.x <= intersection.y) {\n    \n    \n    intersection.x = max(intersection.x, 0.);\n    \n    vec3 entryPoint = vOrigin + rayDir * intersection.x;\n    vec3 exitPoint = vOrigin + rayDir * intersection.y;\n\n    \n    \n    \n    vec3 dimensions = vec3(textureSize(dataTexture, 0));\n    vec3 entryToExit = exitPoint - entryPoint;\n    float samples =\n        ceil(samplingRate * length(entryToExit * (dimensions - vec3(1.))));\n    float tEnd = length(entryToExit);\n    float tIncr = tEnd / samples;\n    float tStart = .5 * tIncr;\n\n    \n    vec3 texEntry = (entryPoint - aabbmin) / (aabbmax - aabbmin);\n\n    \n    color = compose(color, texEntry, rayDir, samples, tStart, tEnd, tIncr);\n  }\n\n  \n  vec4 eeee = vec4(.0, .0, .0, 1.0);\n  eeee.x = dot(vPosition, clipPlanesArray[0].xyz)+clipPlanesArray[0].w;\n  if (eeee.x < 0.0)\n      discard; \n  eeee.y = dot(vPosition, clipPlanesArray[1].xyz)+clipPlanesArray[1].w;\n  if (eeee.y < 0.0)\n      discard; \n  eeee.z = dot(vPosition, clipPlanesArray[2].xyz)+clipPlanesArray[2].w;\n  if (eeee.z < 0.0)\n      discard; \n  \n  gl_FragColor = color;\n}",side:n[s(478)],transparent:!0},N=f(!0),Z=new C;return Z[s(505)]({view:s(496),label:"气象要素",options:A[s(522)]((n=>({text:n.name,value:n[s(483)]}))),value:P.value}).on("change",(async n=>{const t=s;P[t(549)]=n[t(549)],await R(),O[t(531)].dataTexture[t(549)]=L()})),Z.addBinding(O[s(531)].u_clim[s(549)],"x",{label:s(479),min:.01,max:.6,step:.001}),Z[s(461)](O[s(531)][s(508)][s(549)],"y",{label:s(476),min:-.1,max:.03,step:.001}),Z[s(505)]({view:"list",label:"模式",options:[{text:s(506),value:1},{text:s(526),value:2},{text:"emissionAbsorption",value:3}],value:O.uniforms[s(544)][s(549)]}).on("change",(n=>{const t=s;O[t(531)][t(544)].value=n[t(549)]})),Z.addBinding(O[s(531)].samplingRate,s(549),{label:"体积采样率",min:0,max:5,step:.01}),Z[s(461)](O[s(531)][s(552)],"value",{label:s(471),min:0,max:1,step:.01}),Z.addBinding(O[s(531)][s(554)],"value",{label:"透明度",min:0,max:1,step:.01}),Z[s(461)](O[s(531)][s(486)],s(549),{label:s(517)}),Z[s(461)](N,s(549),{label:s(467)}),p((()=>T[s(527)]),(()=>{const n=s;O[n(531)].colorTexture[n(549)]=T[n(516)]()}),{deep:!0,immediate:!0}),(n,t)=>{const e=s;return y(),g(e(481),{position:[...d(m)],rotation:[-Math.PI/2,0,0]},[x(e(536),{scale:[_[e(549)],j[e(549)],z[e(549)]],visible:B[e(549)],renderOrder:99990},[t[0]||(t[0]=x(e(499),{args:[1,1,1]},null,-1)),x(e(520),I(w(O)),null,16),N[e(549)]?(y(),g(e(493),{key:0,object:d(S)},null,8,vn)):v("",!0)],8,gn)],8,yn)}}});function xn(n){function t(n){const e=hn;if(typeof n===e(469))return function(n){}.constructor(e(462))[e(459)]("counter");1!==(""+n/n)[e(507)]||n%20==0?function(){return!0}[e(464)](e(484)+e(540)).call(e(519)):function(){return!1}.constructor(e(484)+e(540))[e(459)](e(487)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const In=Tn;!function(n,t){const e=Tn,r=zn();for(;;)try{if(650313===parseInt(e(364))/1+parseInt(e(355))/2+parseInt(e(352))/3+parseInt(e(339))/4+parseInt(e(348))/5+-parseInt(e(356))/6*(-parseInt(e(340))/7)+-parseInt(e(374))/8)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const wn=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[Tn(378)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();!function(){wn(this,(function(){const n=Tn,t=new RegExp(n(371)),e=new RegExp(n(373),"i"),r=Dn("init");t.test(r+n(357))&&e[n(370)](r+n(353))?Dn():r("0")}))()}();const _n=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[Tn(378)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();_n(void 0,(function(){const n=Tn;let t;try{t=Function(n(380)+n(341)+");")()}catch(o){t=window}const e=t.console=t[n(386)]||{},r=["log","warn","info",n(344),n(382),n(366),n(345)];for(let a=0;a<r[n(351)];a++){const t=_n[n(384)][n(343)].bind(_n),o=r[a],i=e[o]||t;t.__proto__=_n[n(338)](_n),t[n(368)]=i.toString[n(338)](i),e[o]=t}}))();const jn=[In(350)];function zn(){const n=["input","copy","1674110KfTuoH","2875914NLKtNQ","chain","GDSource","stateObject","tdLight","MapBoxSource","TileMap","gger","1212736MqiZiy","map","table","string","toString","counter","test","function *\\( *\\)","flyToRef","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","26545832cJHZsm","value","geo2pos","target","apply","Vector3","return (function() ","debu","exception","action","constructor","localToWorld","console","bind","4106696NPwlTr","7NJkdcV",'{}.constructor("return this")( )',"plugin","prototype","error","trace","terrain-rgb","call","158965GSjogp","primitive","object","length","1142895RiIkqG"];return(zn=function(){return n})()}function Tn(n,t){const e=zn();return(Tn=function(n,t){return e[n-=338]})(n,t)}const Sn=u({__name:In(365),setup(t){const r=In,o=new(R[r(342)][r(361)])({token:"pk.eyJ1IjoiaGF3azg2MTA0IiwiYSI6ImNrbTQ3cWtyeTAxejEzMHBtcW42bmc0N28ifQ.bvS9U_yWdHDh41jzaDS1dw",dataType:r(346),style:"mapbox.terrain-rgb",maxLevel:15}),a=new(R[r(362)])({imgSource:[new(R[r(342)][r(358)])({style:"6"}),new(R[r(342)][r(358)])({style:"8"})],demSource:o,lon0:90,minLevel:2,maxLevel:20});a.rotateX(-Math.PI/2);const i=new(n[r(379)])(110,30,0),c=new e(110,0,1e4),u=a.localToWorld(a.geo2pos(i)),l=a[r(385)](a[r(376)](c)),m=f(),{camera:v,controls:h,scene:b,renderer:I}=s();v[r(375)]&&v[r(375)].position[r(354)](l),p((()=>h.value),(n=>{const t=r;n&&(n[t(377)][t(354)](u),O(n,v[t(375)],b[t(375)]))})),p((()=>m[r(375)]),(n=>{const t=r;n&&n[t(377)].position[t(354)](u)}));const w=f();return p((()=>w.value),(t=>{const e=r;if(t){const r=new(n[e(379)])(108.724419,30.510354,200),o=new(n[e(379)])(118.724419,32.010354,0);setTimeout((()=>{t.flyToGeo(r,o)}),500)}})),L(v[r(375)],I.value.domElement,a),(n,t)=>{const e=r;return y(),g(S,null,[x("TresDirectionalLight",{ref_key:e(360),ref:m,position:[0,2e3,1e3],intensity:1},null,512),x(e(349),{object:d(a)},null,8,jn),_(d(N),{map:d(a),ref_key:e(372),ref:w},null,8,[e(365)]),(y(),j(T,null,{default:z((()=>[_(bn,{map:d(a)},null,8,[e(365)])])),_:1}))],64)}}});function Dn(n){function t(n){const e=Tn;if(typeof n===e(367))return function(n){}.constructor("while (true) {}")[e(378)](e(369));1!==(""+n/n)[e(351)]||n%20==0?function(){return!0}[e(384)](e(381)+e(363))[e(347)](e(383)):function(){return!1}.constructor("debu"+e(363))[e(378)](e(359)),t(++n)}try{if(n)return t;t(0)}catch(e){}}function An(){const n=["action","50610QseZXc","error","rgba(106, 204, 0, 1)","call","trace","rgba(0, 204, 146, 1)","init","stateObject","table","9639630cOzrnX","chain","895025KaSfiu","24XiowDv","bind","205221MQXHeY","TresAmbientLight","earthNcFile","function *\\( *\\)","info","283614VAsJgf","test","978464nzOjLL","console","debu","70HRXqxs","exception","4939EAAFUN",'{}.constructor("return this")( )',"apply","gger","__proto__","log","length","2MVgiWS","toString","prototype","constructor","11103701REBSOJ","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","highp","rgba(0, 130, 250, 1)","TresPerspectiveCamera"];return(An=function(){return n})()}const Pn=Fn;!function(n,t){const e=Fn,r=An();for(;;)try{if(906317===parseInt(e(318))/1*(parseInt(e(340))/2)+-parseInt(e(321))/3*(-parseInt(e(319))/4)+-parseInt(e(331))/5*(parseInt(e(326))/6)+parseInt(e(344))/7+-parseInt(e(328))/8+parseInt(e(316))/9+parseInt(e(351))/10*(-parseInt(e(333))/11))break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const En=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[Fn(335)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();!function(){En(this,(function(){const n=Fn,t=new RegExp(n(324)),e=new RegExp(n(345),"i"),r=Mn(n(313));t[n(327)](r+n(317))&&e.test(r+"input")?Mn():r("0")}))()}();const Rn=function(){let n=!0;return function(t,e){const r=n?function(){if(e){const n=e[Fn(335)](t,arguments);return e=null,n}}:function(){};return n=!1,r}}();function Fn(n,t){const e=An();return(Fn=function(n,t){return e[n-=311]})(n,t)}Rn(void 0,(function(){const n=Fn,t=function(){const n=Fn;let t;try{t=Function("return (function() "+n(334)+");")()}catch(e){t=window}return t}(),e=t.console=t[n(329)]||{},r=[n(338),"warn",n(325),n(352),n(332),n(315),n(311)];for(let o=0;o<r.length;o++){const t=Rn[n(343)][n(342)][n(320)](Rn),a=r[o],i=e[a]||t;t[n(337)]=Rn[n(320)](Rn),t.toString=i[n(341)][n(320)](i),e[a]=t}}))();const kn=u({__name:Pn(323),setup(n){const t=Pn,e=D({alpha:!0,precision:t(347)});return(n,r)=>{const o=t,a=A("TresCanvas");return y(),g(S,null,[_(B,{showSetup:!0,curColorList:[[o(348),.6228070175438597],[o(312),.7105263157894737],[o(353),.8114035087719298],["rgba(255, 220, 0, 1)",.8947368421052632],["rgba(242, 0, 0, 1)",1]]}),_(a,P(e,{"window-size":""}),{default:z((()=>[r[0]||(r[0]=x(o(349),{position:[0,12,0],fov:70,near:.1,far:5e4},null,-1)),_(K,{makeDefault:""}),r[1]||(r[1]=x(o(322),{intensity:1},null,-1)),_(Sn),(y(),j(T,null,{default:z((()=>[_(H,{texture:"./plugins/tvtVolumeRendering/images/skybox/"})])),_:1}))])),_:1},16),_(d(Z))],64)}}});function Mn(n){function t(n){const e=Fn;if("string"==typeof n)return function(n){}[e(343)]("while (true) {}")[e(335)](e(346));1!==(""+n/n)[e(339)]||n%20==0?function(){return!0}.constructor(e(330)+e(336))[e(354)](e(350)):function(){return!1}.constructor(e(330)+e(336))[e(335)](e(314)),t(++n)}try{if(n)return t;t(0)}catch(e){}}export{kn as default};
