import{importShared as e}from"./3d-tiles-renderer.DFcJBJdg1769412424343.js";import{Pane as t}from"./tweakpane.BbuIEN141769412424343.js";import{useLoop as a,OrbitControls_default as s}from"./index.B2-FHinZ1769412424343.js";function i(e,t){return Math.random()*(t-e)+e}function r(e,t){return Math.floor(e+Math.random()*(t-e+1))}let n=0,o=0,l=null;let h=0;const p=[];let d=10;class c{constructor(){this.path=[],this.rspeed=i(1,2),this.count=r(10,30),this.x=n/2+1,this.y=o/2+1,this.target={x:n/2,y:o/2},this.dist=0,this.angle=0,this.hue=h/5,this.life=1,this.updateAngle(),this.updateDist()}step(e){this.speed=this.rspeed*d,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.updateDist(),this.dist<this.speed&&(this.x=this.target.x,this.y=this.target.y,this.changeTarget()),this.path.push({x:this.x,y:this.y}),this.path.length>this.count&&this.path.shift(),this.life-=.001,this.life<=0&&(this.path=null,p.splice(e,1))}updateDist(){const e=this.target.x-this.x,t=this.target.y-this.y;this.dist=Math.sqrt(e*e+t*t)}updateAngle(){const e=this.target.x-this.x,t=this.target.y-this.y;this.angle=Math.atan2(t,e)}changeTarget(){switch(r(0,3)){case 0:this.target.y=this.y-30;break;case 1:this.target.x=this.x+30;break;case 2:this.target.y=this.y+30;break;case 3:this.target.x=this.x-30}this.updateAngle()}draw(){l.beginPath();const e=i(0,10);for(let a=0,s=this.path.length;a<s;a++)l[0===a?"moveTo":"lineTo"](this.path[a].x+i(-e,e),this.path[a].y+i(-e,e));let t=this.hue;t=30,l.strokeStyle=`hsla(${i(0,30)}, 0%, 80%, ${this.life/3})`,l.lineWidth=i(.1,2),l.stroke()}}const u=()=>{h%10==0&&p.push(new c),function(){let e=p.length;for(;e--;)p[e].step(e)}(),l.globalCompositeOperation="destination-out",l.fillStyle="hsla(0, 0%, 10%, 0.1)",l.fillRect(0,0,n,o),l.globalCompositeOperation="lighter",function(){l.save(),l.translate(n/2,o/2),l.translate(-n/2,-o/2);let e=p.length;for(;e--;)p[e].draw(e);l.restore()}(),h++},{defineComponent:g}=await e("vue"),{createElementVNode:f,normalizeProps:m,guardReactiveProps:x,openBlock:y,createElementBlock:v}=await e("vue"),w=["rotation-x"],T=["args"],b=await e("three"),{watch:M,reactive:C,createVNode:k,render:B}=await e("vue"),P=g({__name:"lightningPattern",props:{size:{default:[10,10]},color:{default:"#fff"},opacity:{default:.95},textureRepeat:{default:[1,1]},speed:{default:10}},setup(e){const t=e,s=k("canvas",{width:1024,height:768,style:{backgroundColor:"green"}});B(s,document.createElement("div")),((e,t,a,s)=>{n=e,o=t,l=a,h=0,d=s;for(let i=0;i<10;i++)p.push(new c)})(1024,768,s.el.getContext("2d"),t.speed);const i=new b.CanvasTexture(s.el);i.wrapS=b.RepeatWrapping,i.wrapT=b.RepeatWrapping,i.repeat.set(t.textureRepeat[0],t.textureRepeat[1]);const r=C({color:t.color,map:i,side:b.DoubleSide,transparent:!0,opacity:t.opacity,blending:b.AdditiveBlending,flatShading:!0,depthTest:!0});M(()=>t.color,e=>{r.color=new b.Color(e)}),M(()=>t.opacity,e=>{r.opacity=e}),M(()=>t.speed,e=>{var a;a=t.speed,d=a});const{onBeforeRender:g}=a();return g(()=>{u(),i.needsUpdate=!0}),(e,a)=>(y(),v("TresMesh",{"rotation-x":-Math.PI/2},[f("TresPlaneGeometry",{args:t.size},null,8,T),f("TresMeshStandardMaterial",m(x(r)),null,16)],8,w))}}),{defineComponent:R}=await e("vue"),{createElementVNode:A,unref:D,createVNode:S,normalizeProps:z,guardReactiveProps:N,resolveComponent:_,withCtx:E,openBlock:V,createBlock:j}=await e("vue"),{reactive:G}=await e("vue"),W=R({__name:"canvasFloor",setup(e){const a=G({color:"#1a79fe",opacity:.95,speed:10}),i=new t({title:"canvas地面",expanded:!0});return i.addBinding(a,"color",{label:"颜色"}),i.addBinding(a,"opacity",{label:"透明度",min:0,max:1,step:.01}),i.addBinding(a,"speed",{label:"速度",min:0,max:20,step:1}),(e,t)=>{const i=_("TresCanvas");return V(),j(i,{clearColor:"#000000","window-size":""},{default:E(()=>[t[0]||(t[0]=A("TresPerspectiveCamera",{position:[15,20,0],fov:45,near:.1,far:1e4},null,-1)),S(D(s),{enableDamping:"","auto-rotate":""}),t[1]||(t[1]=A("TresAmbientLight",{intensity:6},null,-1)),t[2]||(t[2]=A("TresDirectionalLight",{position:[0,8,0],intensity:1,color:"#fff"},null,-1)),t[3]||(t[3]=A("TresMesh",{position:[0,1,0]},[A("TresBoxGeometry",{args:[1,1,1]}),A("TresMeshNormalMaterial")],-1)),S(P,z(N(a)),null,16),t[4]||(t[4]=A("TresAxesHelper",{args:[10],position:[0,0,0]},null,-1)),t[5]||(t[5]=A("TresGridHelper",{args:[10,10],position:[0,0,0]},null,-1))]),_:1})}}});export{W as default};
