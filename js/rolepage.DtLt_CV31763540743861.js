import{K as t,p as e,q as n,v as r,u as a,x as o}from"./@tresjs.BCHtwiaC1763540743861.js";import{i}from"./index.Crdf3MNx1763540743861.js";import{_ as s}from"./@fesjs.BEMFm_yJ1763540743861.js";import{ae as l,b8 as m,l as u,q as p,f as c,k as v}from"./three.rXKzP9fQ1763540743861.js";import{H as g}from"./HolographicMaterial._xGBXFix1763540743861.js";import{u as d}from"./vue-router.BxG8XxK11763540743861.js";import{a as f,r as y,q as b,g as x,H as h,o as j,J as q,b as z,I as _,N as k,F as M,X as w,L as I,y as S,O as A,u as C,e as P,h as B,m as L}from"./@vue.Co_gxueH1763540743861.js";import"./postprocessing.51l5tmA-1763540743861.js";import"./@vueuse.CfFJ-iFV1763540743861.js";import"./chalk.BHLFMujs1763540743861.js";/* empty css                                 */import"./iconify-icon.1JyQPtAK1763540743861.js";import"./@iconify.DDuAktjw1763540743861.js";import"./pinia.CEQ6XgE61763540743861.js";import"./vite-plugin-qiankun.B06WoCqG1763540743861.js";import"./dompurify.C4MEnGDh1763540743861.js";import"./oimophysics.CfVKSiAm1763540743861.js";import"./three-stdlib.DJsODJ8R1763540743861.js";import"./@pmndrs.C5SFDEDA1763540743861.js";import"./object-hash.DlZNhpf61763540743861.js";import"./@amap.D8CfaEsq1763540743861.js";import"./crypto-js.CLP5yTup1763540743861.js";import"./naive-ui.qjPOP62h1763540743861.js";import"./date-fns.eh-WGDI81763540743861.js";import"./@css-render.DtSd-BuN1763540743861.js";import"./css-render.Dlx27V_T1763540743861.js";import"./@emotion.DFFAhID71763540743861.js";import"./seemly.D2hUckm91763540743861.js";import"./vooks.CVMU_ROE1763540743861.js";import"./evtd.C4K_ichY1763540743861.js";import"./vueuc.CEvnhvIm1763540743861.js";import"./vdirs.DlTVi7SG1763540743861.js";import"./@juggle.Vc7cP4_P1763540743861.js";import"./lodash-es.B7GkVYRo1763540743861.js";import"./treemate.Qc8YxXqZ1763540743861.js";import"./date-fns-tz.CIz1xaH61763540743861.js";import"./async-validator.DJtlKCAR1763540743861.js";import"./tweakpane.CqZAnw7f1763540743861.js";import"./@qlin.y-0Z8WnK1763540743861.js";import"./@babel.BPq7uOAK1763540743861.js";import"./@floating-ui.Bhq4ibgf1763540743861.js";const E={class:"info"},F={class:"container"},H=["onClick"],T=["src"],D={class:"level"},O={class:"outer-black"},U={class:"outer-iron"},X={class:"inner-black"},J={class:"inner-black-2"},N={class:"inner-black-3"},Y=["object","rotation"],Z=["object","rotation"],G=["src"],K=s({__name:"rolepage",setup(s){const K=i.getItem("robot").scene,$=i.getItem("neon_stage").scene,R=i.getItem("neon_stage").nodes,V=R.frame_frame1_0;R.Cube_light_Cube_light2_0;const Q=d();i.getItem("stratMusic");const W=f(null),tt=f(null),et=f("./plugins/communityMetaverse/music/心跳.mp3"),nt=f([{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"},{img:"./plugins/communityMetaverse/image/robot.png",name:"robot"}]),rt=y({}),at=y({enableZoom:!0,enableRotate:!0,enablePan:!1,maxDistance:1200,minAzimuthAngle:-Math.PI/4,maxAzimuthAngle:Math.PI/4,minPolarAngle:1.4,maxPolarAngle:Math.PI/2});let ot=null;const it=f(null),st=f(20),lt=f(!1),mt=f({transform:`rotateX(${st.value}deg) translateY(-110px)`}),ut=0,pt=0,ct=15,vt=1.3,gt="#e05b0f",dt=new g({blendMode:m,hologramBrightness:2.5,side:l});dt.uniforms.fresnelAmount.value=ut,dt.uniforms.scanlineSize.value=ct,dt.uniforms.signalSpeed.value=vt,dt.uniforms.fresnelOpacity.value=pt,dt.uniforms.hologramColor.value=new u(gt),dt.uniforms.enableBlinking.value=!1,dt.depthTest=!0;(t=>{t.computeBoundingBox();const{max:e,min:n}=t.boundingBox;t.deleteAttribute("uv");const r=e.x-n.x,a=e.z-n.z,o=[];for(let s=0;s<t.attributes.position.count;s++)o.push((t.attributes.position.getX(s)-n.x)/r),o.push((t.attributes.position.getZ(s)-n.z)/a);const i=new Float32Array(o);t.setAttribute("uv",new v(i,2))})(V.geometry);const{xLength:ft,yHeight:yt}=(t=>{t.geometry.computeBoundingBox();const e=t.geometry.boundingBox;return{xLength:e.max.x-e.min.x,yHeight:e.max.y-e.min.y}})(V),bt=new p({uniforms:{u_resolution:{value:new c(ft,yt)},u_mouse:{value:new c(0,0)},u_time:{value:0}},vertexShader:"varying vec2 vUv;\r\nvoid main(){\r\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\r\n\tvUv=uv;\r\n}",fragmentShader:"#ifdef GL_ES\r\nprecision mediump float;\r\n#endif\n\nuniform vec2 u_resolution;\r\nuniform vec3 u_mouse;\r\nuniform float u_time;\r\nvarying vec2 vUv;\r\nvec3 palette(float t){\r\n\tvec3 a=vec3(.5,.5,.5);\r\n\tvec3 b=vec3(.5,.5,.5);\r\n\tvec3 c=vec3(1.,1.,1.);\r\n\tvec3 d=vec3(.263,.416,.557);\r\n\t\r\n\treturn a+b*cos(6.28318*(c*t+d));\r\n}\n\nmat2 rot2D(float angle){\r\n\tfloat s=sin(angle);\r\n\tfloat c=cos(angle);\r\n\treturn mat2(c,-s,s,c);\r\n}\n\nfloat sdPyramid(vec3 p,float h)\r\n{\r\n\tfloat m2=h*h+.25;\r\n\t\r\n\tp.xz=abs(p.xz);\r\n\tp.xz=(p.z>p.x)?p.zx:p.xz;\r\n\tp.xz-=.5;\r\n\t\r\n\tvec3 q=vec3(p.z,h*p.y-.5*p.x,h*p.x+.5*p.y);\r\n\t\r\n\tfloat s=max(-q.x,0.);\r\n\tfloat t=clamp((q.y-.5*p.z)/(m2+.25),0.,1.);\r\n\t\r\n\tfloat a=m2*(q.x+s)*(q.x+s)+q.y*q.y;\r\n\tfloat b=m2*(q.x+.5*t)*(q.x+.5*t)+(q.y-m2*t)*(q.y-m2*t);\r\n\t\r\n\tfloat d2=min(q.y,-q.x*m2-q.y*.5)>0.?0.:min(a,b);\r\n\t\r\n\treturn sqrt((d2+q.z*q.z)/m2)*sign(max(q.z,-p.y));\r\n}\r\nfloat sdBoxFrame(vec3 p,vec3 b,float e)\r\n{\r\n\tp=abs(p)-b;\r\n\tvec3 q=abs(p+e)-e;\r\n\treturn min(min(\r\n\t\t\tlength(max(vec3(p.x,q.y,q.z),0.))+min(max(p.x,max(q.y,q.z)),0.),\r\n\t\t\tlength(max(vec3(q.x,p.y,q.z),0.))+min(max(q.x,max(p.y,q.z)),0.)),\r\n\t\t\tlength(max(vec3(q.x,q.y,p.z),0.))+min(max(q.x,max(q.y,p.z)),0.));\r\n\t\t}\r\n\t\tfloat map(vec3 p){\r\n\t\t\tp.z+=u_time*.4;\r\n\t\t\t\r\n\t\t\tp.xy=fract(p.xy)-.5;\r\n\t\t\tp.z=mod(p.z,.25)-.125;\r\n\t\t\tfloat box=sdBoxFrame(p*8.,vec3(.5,.3,.5),.025)/8.;\r\n\t\t\t\n\t\t\treturn box;\r\n\t\t}\r\n\t\t\r\n\t\tvoid main(){\r\n\t\t\tvec2 uv=vUv-vec2(.5);\r\n\t\t\tvec2 m=(u_mouse.xy*2.-u_resolution.xy)/u_resolution.y;\r\n\t\t\t\r\n\t\t\t\n\t\t\tvec3 ro=vec3(0.,0.,-3.);\r\n\t\t\tvec3 rd=normalize(vec3(uv,1.));\r\n\t\t\tvec3 col=vec3(0);\r\n\t\t\t\r\n\t\t\tfloat t=0.;\r\n\t\t\t\r\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\r\n\t\t\t\n\t\t\tint i;\r\n\t\t\tfor(i=0;i<80;i++){\r\n\t\t\t\tvec3 p=ro+rd*t;\r\n\t\t\t\t\r\n\t\t\t\tp.xy*=rot2D(t*.2);\r\n\t\t\t\tp.y+=sin(t*(1.)*.5)*.35;\r\n\t\t\t\t\r\n\t\t\t\tfloat d=map(p);\r\n\t\t\t\t\r\n\t\t\t\tt+=d;\r\n\t\t\t\t\r\n\t\t\t\tif(d<.001||t>100.)break;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\n\t\t\tcol=palette(t*.04+float(i)*.005);\r\n\t\t\t\r\n\t\t\tgl_FragColor=vec4(col,1.);\r\n\t\t}"});V.material=bt;const xt=()=>{null==ot?alert("请选择你的人物模型！"):(lt.value=!lt.value,setTimeout(()=>{Q.push({path:"./indexMain"})},1e3))},ht=t=>{38===t.keyCode?st.value+=5:40===t.keyCode&&(st.value-=5),mt.value={transform:`rotateX(${st.value}deg) translateY(-110px)`}};b(()=>{const t=JSON.parse(localStorage.getItem("iceglUserInfor"));tt.value=t.username;document.getElementById("lllll").addEventListener("mousemove",()=>{const t=W.value;void 0!==t&&t.play().then(()=>{}).catch(t=>{})}),window.addEventListener("keydown",ht)}),K.children[0].children.forEach(t=>{"SkinnedMesh"==t.type&&(t.material=dt.clone(),t.material.uniforms.hologramColor.value=new u("blue"),t.material.uniforms.fresnelOpacity.value=1.1,t.material.uniforms.fresnelAmount.value=.1,t.material.uniforms.scanlineSize.value=.1,t.material.uniforms.signalSpeed.value=.4)});const jt=()=>{bt.uniforms.u_time.value+=.01,bt.uniforms.u_mouse.value=new c(0,0),K.rotation.y+=.01,dt.update(),K.children[0].children.forEach(t=>{"SkinnedMesh"==t.type&&t.material.update()})};return(s,l)=>{const m=x("TresCanvas");return j(),h(M,null,[q("div",E,"Hi!"+k(tt.value)+"请选择你的模型！",1),q("div",F,[(j(!0),h(M,null,w(nt.value,(t,e)=>(j(),h("div",{key:e,class:I([{selected:it.value===e},"card"]),onClick:n=>function(t,e){ot=t,it.value=e}(t,e)},[q("img",{src:t.img,alt:"Character"},null,8,T),q("p",D,k(t.name),1)],10,H))),128))]),q("div",{id:"wrapper",style:A(mt.value)},[q("div",O,[q("div",U,[l[1]||(l[1]=q("div",{class:"glare"},null,-1)),q("div",X,[q("div",J,[q("div",N,[q("button",{class:I(["engine",{active:lt.value}]),onClick:xt},[...l[0]||(l[0]=[q("div",{class:"light"},null,-1),q("span",null,[S("Engine"),q("br")],-1),q("span",null,[S("Start"),q("br"),S("Stop"),q("br")],-1)])],2)])])])])])],4),C(i).hasAllFinished.value?(j(),z(m,L({key:0},rt,{id:"lllll","window-size":"",onLoop:jt}),{default:P(()=>[l[2]||(l[2]=q("TresPerspectiveCamera",{position:[0,150,1300],fov:45,near:1,far:2e4,up:[0,1,0]},null,-1)),B(C(t),L(at,{makeDefault:!0,enableDamping:""}),null,16),l[3]||(l[3]=q("TresAmbientLight",{color:"#1c7cdf",intensity:1},null,-1)),l[4]||(l[4]=q("TresDirectionalLight",{position:[0,100,0],intensity:1,color:"#62456e"},null,-1)),q("primitive",{object:C(K),scale:[100,100,100],name:"robot",position:[-150,-30,40],rotation:[0,Math.PI,0]},null,8,Y),q("primitive",{object:C($),scale:[30,30,30],name:"robot",position:[-150,-80,40],rotation:[0,Math.PI/4,0]},null,8,Z),B(C(e),null,{default:P(()=>[B(C(n),{radius:.3,strength:.3,threshold:.3}),B(C(r),{width:1920,height:1080}),B(C(a),{dtSize:512}),B(C(o))]),_:1})]),_:1},16)):_("",!0),q("audio",{ref_key:"audioPlayer",ref:W,controls:"",style:{visibility:"hidden"}},[q("source",{src:et.value,type:"audio/mpeg"},null,8,G),l[5]||(l[5]=S(" 您的浏览器不支持 audio 元素。 ",-1))],512)],64)}}},[["__scopeId","data-v-6d2aebcb"]]);export{K as default};
