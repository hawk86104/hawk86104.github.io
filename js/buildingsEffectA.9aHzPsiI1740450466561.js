import{P as t}from"./tweakpane.yDiyAAkA1740450466561.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.sU7DdiRS1740450466561.js";import{e}from"./@tresjs.9lmhsV6t1740450466561.js";import{z as r}from"./three-custom-shader-material.PpIb7yur1740450466561.js";import{_ as i,C as u,ck as c,l as a,b9 as s}from"./three.HaMTRCf61740450466561.js";import{d as l,a2 as f,w as p,o as d,H as m,u as v,a3 as h,r as g,f as y,g as C,j as w,m as _}from"./@vue.NRI7TcgI1740450466561.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1740450466561.js";import"./@vueuse.q8gKo7tC1740450466561.js";function b(){const t=["return (function() ","stateObject","apply","57725qKnyov","uOpacity","constructor","log","land","test","info","length","DoubleSide","string","exception","34yRcvlq","value","744xefrCk","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","computeBoundingSphere","landColor","renderOrder","gradient","3fHcXnu","#112233","model",'{}.constructor("return this")( )',"object","uniforms","console","4835675PrXaQx","10282977UoGPuJ","29134GJFnGU","bind","trace","computeBoundingBox","chain","warn","30633160RUXGwU","action","Color","gger","while (true) {}","2490008NWddLN","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","opacity","function *\\( *\\)","setStyle","debu","topColor","7713056blBxnJ","toString","counter","bulidingsColor","bModel","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#ffff00","material","side","error","MeshBasicMaterial","boundingBox","children","#e523ff"];return(b=function(){return t})()}const x=M;!function(t,n){const o=M,e=b();for(;;)try{if(885415===-parseInt(o(390))/1*(-parseInt(o(401))/2)+parseInt(o(409))/3*(-parseInt(o(429))/4)+parseInt(o(416))/5+-parseInt(o(403))/6*(-parseInt(o(418))/7)+parseInt(o(436))/8+parseInt(o(417))/9+-parseInt(o(424))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(t,n){const o=b();return(M=function(t,n){return o[t-=377]})(t,n)}!function(){I(this,(function(){const t=M,n=new RegExp(t(432)),o=new RegExp(t(378),"i"),e=P("init");n[t(395)](e+t(422))&&o[t(395)](e+"input")?P():e("0")}))()}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(389)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();S(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(387)+t(412)+");")()}catch(o){n=window}return n}(),o=n[t(415)]=n[t(415)]||{},e=[t(393),t(423),t(396),t(382),t(400),"table",t(420)];for(let r=0;r<e[t(397)];r++){const n=S.constructor.prototype.bind(S),i=e[r],u=o[i]||n;n.__proto__=S[t(419)](S),n.toString=u[t(437)].bind(u),o[i]=n}}))();const T=[x(413)],j=l({__name:x(377),props:{model:{},bulidingsColor:{default:x(386)},landColor:{default:x(410)},topColor:{default:x(379)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,c=o.model.city;o[n(411)][n(411)][n(385)][0][n(380)]=new(i[n(383)])({color:n(379)}),c[n(407)]=1001;const a=o[n(411)][n(394)];(()=>{const t=n,{geometry:e}=c;e[t(421)](),e[t(405)]();const{max:a,min:s}=e[t(384)];if(c.material.__csm)return;const l=new r({baseMaterial:c[t(380)],vertexShader:t(430),fragmentShader:t(404),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(o[t(439)])},uOpacity:{value:o[t(431)]},uLightColor:{value:new(i[t(426)])("#ffffff")},uTopColor:{value:new(i[t(426)])(o[t(435)])},uTime:{value:0},uGradient:{value:o[t(408)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(398)]});c[t(380)].dispose(),c[t(380)]=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(380)][o(414)].uTime[o(402)]+=t})),f((()=>{const t=n;o[t(439)]&&c.material[t(414)].uColor[t(402)][t(433)](o[t(439)]),o[t(406)]&&((t,e)=>{const r=n;let u;"cu"===t||t===r(394)&&(u=Array.isArray(a[r(380)])?a.material:[a.material],u.forEach((t=>{const n=r;t[e][n(433)](o[n(406)]),t[n(381)]=i[n(398)]})))})(t(394),"color"),o[t(431)]&&(c.material[t(414)][t(391)].value=o.opacity)})),p(o,((t,o)=>{const e=n;c[e(380)][e(414)].uGradient[e(402)]=t.gradient}));const l=o[n(411)][n(411)].clone();return(t,n)=>(d(),m("primitive",{object:v(l)},null,8,T))}});function P(t){function n(t){const o=M;if(typeof t===o(399))return function(t){}[o(392)](o(428))[o(389)](o(438));1!==(""+t/t)[o(397)]||t%20==0?function(){return!0}.constructor("debu"+o(427)).call(o(425)):function(){return!1}[o(392)](o(434)+o(427))[o(389)](o(388)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=L;!function(t,n){const o=L,e=F();for(;;)try{if(468391===parseInt(o(371))/1+parseInt(o(353))/2*(-parseInt(o(337))/3)+-parseInt(o(339))/4*(parseInt(o(341))/5)+parseInt(o(357))/6+-parseInt(o(333))/7*(-parseInt(o(338))/8)+parseInt(o(358))/9*(parseInt(o(354))/10)+-parseInt(o(367))/11*(-parseInt(o(359))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(332)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){G(this,(function(){const t=L,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(368),"i"),e=R(t(318));n[t(376)](e+t(344))&&o[t(376)](e+t(340))?R():e("0")}))()}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(332)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(363)+t(356)+");")()}catch(o){n=window}return n}(),o=n[t(365)]=n[t(365)]||{},e=[t(327),t(375),t(326),t(349),t(350),t(330),t(372)];for(let r=0;r<e[t(342)];r++){const n=A[t(374)][t(361)][t(343)](A),i=e[r],u=o[i]||n;n.__proto__=A[t(343)](A),n[t(325)]=u[t(325)][t(343)](u),o[i]=n}}))();const B=[O(346)];function F(){const t=["error","exception","uniforms","primitive","2JnrBQP","432230cxKCRx","width",'{}.constructor("return this")( )',"3089940AnYOnm","54WNUVVN","25260schlNe","srcColor","prototype","scale","return (function() ","gger","console","renderOrder","187hMAVCK","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","gradual","689012mrxXvs","trace","uGradual","constructor","warn","test","matrix","debu","counter","init","call","color","bLine","action","#000","speed","toString","info","log","clone","#FFF","table","builds","apply","229530rczCEN","linewidth","value","uTime","2652009Qthyjb","136dyywxk","2816644CTflho","input","5zfdpuT","length","bind","chain","applyMatrix4","object","geometry","uColor"];return(F=function(){return t})()}const z=l({__name:O(321),props:{builds:{},color:{default:O(329)},srcColor:{default:O(323)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(320)])},uSrcColor:{value:new u(o.srcColor)},uScale:{value:o[n(362)]},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o.builds[n(347)])[n(328)]();l=l[n(345)](o[n(331)][n(377)]);const p=new a(i);r=new s(l,p),r.material[n(334)]=o[n(355)],r[n(366)]=1e3,f((()=>{const t=n;o[t(320)]&&(i[t(351)][t(348)][t(335)]=new u(o[t(320)])),o[t(360)]&&(i[t(351)].uSrcColor.value=new u(o.srcColor)),o[t(362)]&&(i[t(351)].uScale[t(335)]=o[t(362)]),o[t(370)]&&(i.uniforms[t(373)][t(335)]=o[t(370)])}));const{onLoop:h}=e();return h((({delta:t})=>{const e=n;i[e(351)][e(336)][e(335)]+=t*o[e(324)],i[e(351)][e(336)][e(335)]%=1})),(t,o)=>{const e=n;return d(),m(e(352),{object:v(r)},null,8,B)}}});function L(t,n){const o=F();return(L=function(t,n){return o[t-=317]})(t,n)}function R(t){function n(t){const o=L;if(typeof t===o(369))return function(t){}[o(374)]("while (true) {}").apply(o(317));1!==(""+t/t)[o(342)]||t%20==0?function(){return!0}.constructor("debu"+o(364))[o(319)](o(322)):function(){return!1}[o(374)](o(378)+o(364))[o(332)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const W=N;!function(t,n){const o=N,e=k();for(;;)try{if(583434===parseInt(o(470))/1*(-parseInt(o(489))/2)+-parseInt(o(503))/3+parseInt(o(474))/4+-parseInt(o(490))/5*(parseInt(o(491))/6)+parseInt(o(499))/7*(parseInt(o(479))/8)+-parseInt(o(477))/9*(-parseInt(o(475))/10)+-parseInt(o(484))/11*(-parseInt(o(476))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(493)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=N,n=new RegExp(t(501)),o=new RegExp(t(494),"i"),e=D(t(487));n[t(507)](e+t(504))&&o[t(507)](e+t(473))?D():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(493)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(){const t=["414227hGQYmj","gger","length","init","gradual","2CoynLu","31485SOyTuJ","78LpljxG","toString","apply","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","#999","string","stateObject","5223911bATQnf","扩散系数","function *\\( *\\)",'{}.constructor("return this")( )',"3451188nZzOOD","chain","bind","info","test","model","prototype","scale","console","#000000","debu","#112233","效果参数","counter","error","buildingsEffectA","call","log","constructor","855WBsYtQ","addBinding","table","input","1848420PGZcbA","1260fbQbmW","24ezdWoU","38061uamwLH","srcColor","8cKFNZK","#FFF","trace","线原颜色","color"];return(k=function(){return t})()}function N(t,n){const o=k();return(N=function(t,n){return o[t-=467]})(t,n)}Z(void 0,(function(){const t=N,n=function(){const t=N;let n;try{n=Function("return (function() "+t(502)+");")()}catch(o){n=window}return n}(),o=n[t(511)]=n[t(511)]||{},e=[t(468),"warn",t(506),t(517),"exception",t(472),t(481)];for(let r=0;r<e.length;r++){const n=Z.constructor[t(509)][t(505)](Z),i=e[r],u=o[i]||n;n.__proto__=Z[t(505)](Z),n.toString=u[t(492)][t(505)](u),o[i]=n}}))();const Q=l({__name:W(518),async setup(e){const r=W;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=g({color:r(480),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(515),expanded:!0});return s[r(471)](a,r(478),{label:r(482)}),s[r(471)](a,r(483),{label:"线扫颜色"}),s[r(471)](a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(471)](a,r(510),{label:"最大扩散",min:10,max:2e3,step:10}),s[r(471)](a,r(488),{label:r(500),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[w(j,{model:v(c),bulidingsColor:e(512),landColor:e(514),topColor:e(496)},null,8,[e(508)]),w(z,_({builds:v(c).city},a),null,16,["builds"])])),_:1})}}});function D(t){function n(t){const o=N;if(typeof t===o(497))return function(t){}[o(469)](o(495))[o(493)](o(516));1!==(""+t/t)[o(486)]||t%20==0?function(){return!0}[o(469)](o(513)+o(485))[o(467)]("action"):function(){return!1}[o(469)](o(513)+o(485))[o(493)](o(498)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Q as default};
