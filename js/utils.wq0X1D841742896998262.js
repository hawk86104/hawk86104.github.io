import"./@fesjs.ATKJ6WD31742896998262.js";import{_ as t}from"./jszip.jzMwTE8j1742896998262.js";import{F as n}from"./file-saver.qXwGE4CQ1742896998262.js";import{_ as e,z as s}from"./three.0CcRceKb1742896998262.js";const o=r;function r(t,n){const e=i();return r=function(t,n){return e[t-=326]},r(t,n)}!function(t,n){const e=r,s=i();for(;;)try{if(290075===parseInt(e(350))/1*(-parseInt(e(406))/2)+-parseInt(e(338))/3+parseInt(e(420))/4*(-parseInt(e(399))/5)+parseInt(e(339))/6+-parseInt(e(418))/7*(-parseInt(e(383))/8)+parseInt(e(343))/9+parseInt(e(403))/10)break;s.push(s.shift())}catch(o){s.push(s.shift())}}();const a=function(){let t=!0;return function(n,e){const s=t?function(){if(e){const t=e[r(371)](n,arguments);return e=null,t}}:function(){};return t=!1,s}}();!function(){a(this,(function(){const t=r,n=new RegExp(t(341)),e=new RegExp(t(386),"i"),s=b(t(361));n[t(407)](s+t(372))&&e[t(407)](s+t(380))?b():s("0")}))()}();const c=function(){let t=!0;return function(n,e){const s=t?function(){if(e){const t=e[r(371)](n,arguments);return e=null,t}}:function(){};return t=!1,s}}();function i(){const t=["manager","log","json","data:image/jpeg;base64,","url:images/","counter","action","readAsDataURL","bind","1593390ZeZIeX","2226240zXwNly","result","function *\\( *\\)","pop","4545756HgDUZJ","非标准文件：不存在 app.json","stateObject","info","load","PNG","toUpperCase","203742VMQoQq","url:","Loader","app.json","type","gger","onerror","image/jpeg","get","loadAsync","parse","init","data:image/webp;base64,",'{}.constructor("return this")( )',"error","uuid","while (true) {}","endsWith","trace","data:image/PNG;base64,","stringify","apply","chain","__proto__","forEach","setResponseType","console","startsWith","url","slice","input",".json","async","6088zPGZGR","data:image/png;base64,","then","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","blob","url:geometries/","name","warn","length","data:","onloadend",";base64,","exception","table","application/octet-stream","5jDrhSs","files","split","images","4294190NyjCdj","base64","Cache","2WrkiHc","test","file","geometries","data:image/GIF;base64,","data","generateAsync","config.zip","FileLoader","data:image/gif;base64,","catch","scene","2569QLWqZS","debu","2239532QBQZuv","WEBP","call","message","Unknown","toLowerCase","constructor","data:image/JPEG;base64,"];return(i=function(){return t})()}async function u(t){const n=o,s=new(e[n(414)]);return new Promise(((e,o)=>{s[n(347)](t,(t=>e(JSON.parse(t))),void 0,(t=>o(t)))}))}c(void 0,(function(){const t=r;let n;try{n=Function("return (function() "+t(363)+");")()}catch(o){n=window}const e=n[t(376)]=n[t(376)]||{},s=[t(330),t(391),t(346),"error",t(396),t(397),t(368)];for(let r=0;r<s[t(392)];r++){const n=c[t(327)].prototype[t(337)](c),o=s[r],a=e[o]||n;n[t(373)]=c[t(337)](c),n.toString=a.toString[t(337)](a),e[o]=n}}))(),e[o(405)].enabled=!0;class p extends e[o(352)]{constructor(t){super(t)}[o(347)](t,n,e,r){const a=o,c=new s(this[a(329)]);c.setResponseType(a(331)),c[a(347)](t,(t=>n&&n(t)),e,r)}}async function f(t){const n=o,s=new(e[n(414)]);return new Promise(((e,r)=>{const a=n;s[a(375)](a(388)),s[a(347)](t,(n=>{const s=a,c=new FileReader;c[s(394)]=()=>{const n=s,r=function(t){const n=o,e=t[n(401)](".").pop()[n(326)]();return{jpg:n(357),jpeg:n(357),png:"image/png",gif:"image/gif",bmp:"image/bmp",webp:"image/webp"}[e]||n(398)}(t),a=c[n(340)].split(",")[1];e(n(393)+r+n(395)+a)},c[s(356)]=t=>{r(t)},c[s(336)](n)}),void 0,(t=>r(t)))}))}class l extends e[o(352)]{constructor(t){super(t)}[o(347)](n,s,r,a){const c=o,i=new(e[c(414)])(this.manager);i.setResponseType(c(388)),i[c(347)](n,(async n=>{try{const e=await t.loadAsync(n);s&&s(e)}catch(e){a&&a(e)}}),r,a)}}const g=t=>{const n=o,e=t.substring(0,15),s=n(332),r=n(328),a=n(384),c=n(369),i=n(415),u=n(410),p=n(362);return s.startsWith(e)||r[n(377)](e)?"JPEG":a[n(377)](e)||c[n(377)](e)?n(348):i.startsWith(e)||u[n(377)](e)?"GIF":p[n(377)](e||"data:image/WEBP;base64,"[n(377)](e))?n(421):n(424)},d=e=>{const s=o,r=[];e[s(417)][s(409)]&&e[s(417)].geometries.forEach((t=>{const n=s;"BufferGeometry"===t[n(354)]&&(r.push({uuid:t.uuid,data:t[n(411)]}),t[n(411)]=n(389)+t.uuid+".json")}));const a=[];e[s(417)][s(402)]&&e[s(417)][s(402)][s(374)]((t=>{const n=s;t[n(378)]&&(a.push({uuid:t[n(365)],url:t.url}),t[n(378)][n(354)]?t[n(378)]="url:images/"+t[n(365)]+"."+t[n(378)][n(354)]+".json":t[n(378)]=n(333)+t.uuid+"."+g(t.url))}));const c=new t;if(r.length){const t=c.folder(s(409));r[s(374)]((n=>{const e=s;t[e(408)](n[e(365)]+e(381),JSON[e(370)](n[e(411)]))}))}if(a.length){const t=c.folder(s(402));a[s(374)]((n=>{const e=s;n[e(378)].type?t.file(n.uuid+"."+n[e(378)][e(354)]+e(381),JSON[e(370)](n[e(378)])):t[e(408)](n.uuid+"."+g(n[e(378)]),n[e(378)].split(e(395))[e(342)](),{base64:!0})}))}const i=JSON[s(370)](e);return c[s(408)](s(353),i),c[s(412)]({type:s(388)})[s(385)]((t=>{const e=s;n.saveAs(t,e(413))}))},m=(t,n,e)=>{const s=o;t[s(409)]<=0&&t[s(402)]<=0&&e(n)},h=(n,e)=>{const s=o;let r=null;return t[s(359)](n).then((t=>{const n=s;t[n(400)][n(353)]?t[n(400)][n(353)][n(382)](n(387))[n(385)]((s=>{const a=n;r=JSON[a(360)](s);const c=(t=>{const n=o,e={geometries:0,images:0};return t.scene[n(409)]?.[n(374)]((t=>{const s=n;t.data.startsWith("url:")&&e[s(409)]++})),t.scene[n(402)]?.[n(374)]((t=>{const s=n;t[s(378)][s(377)](s(351))&&e.images++})),e})(r);m(c,r,e),r[a(417)][a(409)]?.[a(374)]((n=>{const s=a;n.data[s(377)]("url:")&&t[s(400)][n.data.slice(4)].async(s(387))[s(385)]((t=>{const o=s;n[o(411)]=JSON[o(360)](t),c.geometries--,m(c,r,e)}))})),r[a(417)][a(402)]?.[a(374)]((n=>{const s=a;if(n[s(378)][s(377)](s(351))){const o=n[s(378)][s(379)](4);o[s(367)](s(381))?t.files[o][s(382)](s(387))[s(385)]((t=>{const o=s;n[o(378)]=JSON[o(360)](t),c[o(402)]--,m(c,r,e)})):t[s(400)][o][s(382)](s(404)).then((t=>{const a=s,i=o[a(401)]("."),u=i[i[a(392)]-1][a(349)]();n[a(378)]="data:image/"+u+a(395)+t,c.images--,m(c,r,e)}))}}))})):console.error(n(344))}),(t=>{const e=s;console.error(n[e(390)]+": "+t[e(423)])})),r};function b(t){function n(t){const e=r;if(typeof t===e(387))return function(t){}.constructor(e(366))[e(371)](e(334));1!==(""+t/t).length||t%20==0?function(){return!0}[e(327)](e(419)+e(355))[e(422)](e(335)):function(){return!1}[e(327)](e(419)+e(355))[e(371)](e(345)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{p as J,l as Z,f as a,d as e,g,h as i,u as l};
