import{a1 as L,ad as T,ak as A,a7 as E,X as I,b6 as $,o as h,c as q,L as r,ap as F,a9 as G,a2 as f,ba as N,aq as V,x as y,E as w,a8 as K,bb as O,a as c,aa as C,ab as R,ac as U,Y as n,ag as X}from"./vendor.OBP08amX1714040370083.js";import{_ as Y}from"./component.vue_vue_type_script_setup_true_lang.T7wmJsKW1714040370083.js";import"./index.vue_vue_type_script_setup_true_lang.w3FlBR-31714040370083.js";import{u as D}from"./index.5knN_y7X1714040370083.js";import{M as S}from"./MeshTransmissionMaterial.uoVu98zc1714040370083.js";import{M as H}from"./MeshDiscardMaterial.L-Cih7bW1714040370083.js";import"./OimoPhysicsBuffer.b5DejoFC1714040370083.js";import"./PackedMipMapGenerator.wq4ddLY_1714040370083.js";import{_ as J}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.yScFKsxk1714040370083.js";import"./shaderMaterial.GVneR3NE1714040370083.js";const Q=["buffer","side"],W=0,Z=L({__name:"index",props:{backside:{type:Boolean,default:!0},thickness:{default:1},backsideThickness:{default:.5},fboResolution:{default:256}},setup(v,{expose:m}){const s=T(),{extend:a,scene:e,renderer:i,camera:p}=A(),t=T(),o=v;a({MeshTransmissionMaterial:S});function P(u,B){let x;return u.traverse(d=>{d.isMesh&&d.material&&d.material.uuid===B&&(x=d)}),x}const j=new H,{onBeforeLoop:z}=G(),g=D({width:o.fboResolution,height:o.fboResolution,isLoop:!1}),l=D({width:o.fboResolution,height:o.fboResolution,isLoop:!1});E(async()=>{await I(),t.value=P(e.value,s.value.uuid)});let b,_,k,M;return z(({elapsed:u})=>{s.value.time=u,s.value.buffer===l.value.texture&&t.value&&(k=i.value.toneMapping,b=e.value.background,_=s.value.envMapIntensity,M=t.value.material.side,t.value.material=j,o.backside&&(i.value.setRenderTarget(g.value),i.value.render(e.value,p.value),t.value.material=s.value,t.value.material.thickness=o.backsideThickness,t.value.material.buffer=g.value.texture,t.value.material.side=$,t.value.material.envMapIntensity=W),i.value.setRenderTarget(l.value),i.value.render(e.value,p.value),t.value.material.buffer=l.value.texture,t.value.material=s.value,t.value.material.thickness=o.thickness,t.value.material.side=M,t.value.material.envMapIntensity=_,e.value.background=b,i.value.setRenderTarget(null),i.value.toneMapping=k)}),m({root:s,constructor:S}),(u,B)=>(h(),q("TresMeshTransmissionMaterial",{ref_key:"MeshTransmissionMaterialClass",ref:s,buffer:r(l).texture,side:r(F)},null,8,Q))}}),ee=n("TresPerspectiveCamera",{position:[10,10,10],fov:45,near:1,far:1e3},null,-1),ae=n("TresAmbientLight",{intensity:.5},null,-1),te=n("TresDirectionalLight",{position:[15,15,15],intensity:1},null,-1),se={position:[0,1.9,0],name:"torus"},ie=n("TresTorusKnotGeometry",{args:[1,.35,100,32]},null,-1),ne=n("TresMesh",{position:[-2.5,1.5,2.5],"receive-shadow":"","cast-shadow":"",name:"cube"},[n("TresCylinderGeometry",{args:[1.5,1.5,2]}),n("TresMeshStandardMaterial",{color:"#ff33ff",roughness:0,metalness:1})],-1),ve=L({__name:"transmissionMaterial",setup(v){const m=f({alpha:!0,toneMapping:N,windowSize:!0,clearColor:0,disableRender:!1}),s=f({enableDamping:!0,autoRotate:!1}),a=f({color:"#ffffff",roughness:0,reflectivity:.5,attenuationColor:"#ffffff",attenuationDistance:2,chromaticAberration:.05,anisotropicBlur:.1,distortion:0,temporalDistortion:0,backside:!0,thickness:1,backsideThickness:.5}),e=new V;return e.addBinding(a,"color",{label:"颜色"}),e.addBinding(a,"roughness",{label:"roughness",min:0,max:1,step:.01}),e.addBinding(a,"reflectivity",{label:"reflectivity",min:0,max:1,step:.01}),e.addBinding(a,"attenuationColor",{label:"attenuationColor"}),e.addBinding(a,"attenuationDistance",{label:"attenuationDistance",min:0,max:2,step:.01}),e.addBinding(a,"chromaticAberration",{label:"chromaticAberration",min:0,max:2,step:.01}),e.addBinding(a,"anisotropicBlur",{label:"anisotropicBlur",min:0,max:10,step:.01}),e.addBinding(a,"distortion",{label:"distortion",min:0,max:10,step:.01}),e.addBinding(a,"temporalDistortion",{label:"temporalDistortion",min:0,max:1,step:.01}),e.addBinding(a,"backside",{label:"backside"}),e.addBinding(a,"thickness",{label:"thickness",min:0,max:4,step:.01}),e.addBinding(a,"backsideThickness",{label:"backsideThickness",min:0,max:4,step:.01}),(i,p)=>(h(),y(r(O),K(m,{"window-size":""}),{default:w(()=>[ee,c(r(U),C(R(s)),null,16),ae,te,n("TresMesh",se,[ie,c(r(Z),C(R(a)),null,16)]),ne,c(r(J),{args:[3,3]}),(h(),y(X,null,{default:w(()=>[c(r(Y),{blur:.3,background:"",files:["pos-x.jpg","neg-x.jpg","pos-y.jpg","neg-y.jpg","pos-z.jpg","neg-z.jpg"],path:"https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/images/skyBox/6jpg/"},null,8,["files"])]),_:1}))]),_:1},16))}});export{ve as default};
