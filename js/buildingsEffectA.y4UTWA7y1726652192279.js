import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.n_49xkgO1726652192279.js";import{U as o}from"./@tresjs.UGbbWZf51726652192279.js";import{C as e}from"./three-custom-shader-material.1UWxr2-p1726652192279.js";import"./object-hash.659hUnW-1726652192279.js";import{_ as r,C as i,cc as u,m as c,a$ as s}from"./three.3esZ7Hzr1726652192279.js";import"./@amap.-LPMSFvH1726652192279.js";import"./glsl-tokenizer.lP_hSvTG1726652192279.js";import{d as a,a3 as l,w as f,o as p,E as d,u as m,a4 as g,r as v,f as h,g as y,j as C,m as w}from"./@vue.JNsx1iN61726652192279.js";import{P as _}from"./tweakpane.yHWGBmom1726652192279.js";import"./@vueuse.OdTlFP151726652192279.js";import"./glsl-token-string.0mUiHG4f1726652192279.js";import"./glsl-token-functions.lY9NGLSv1726652192279.js";import"./jszip.uBbFte4W1726652192279.js";const b=S;!function(t,n){const o=S,e=j();for(;;)try{if(423558===parseInt(o(416))/1+-parseInt(o(419))/2*(-parseInt(o(437))/3)+-parseInt(o(445))/4+parseInt(o(428))/5+parseInt(o(443))/6*(-parseInt(o(442))/7)+-parseInt(o(451))/8*(-parseInt(o(405))/9)+-parseInt(o(452))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=S,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(406),"i"),e=O(t(395));n[t(394)](e+"chain")&&o[t(394)](e+t(436))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(441)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=S,n=function(){const t=S;let n;try{n=Function("return (function() "+t(438)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(421)]||{},e=[t(411),t(453),t(401),t(398),"exception","table",t(426)];for(let r=0;r<e[t(430)];r++){const n=M[t(400)].prototype[t(446)](M),i=e[r],u=o[i]||n;n[t(418)]=M[t(446)](M),n[t(448)]=u[t(448)][t(446)](u),o[i]=n}}))();const I=[b(413)];function S(t,n){const o=j();return(S=function(t,n){return o[t-=394]})(t,n)}function j(){const t=["input","27786DeCIJv",'{}.constructor("return this")( )',"string","primitive","apply","231QdPCLr","73128XvRTnN","side","181892umSRLg","bind","__csm","toString","#e523ff","renderOrder","5001208MpfzUb","11010770aIHuZe","warn","isArray","material","opacity","Color","dispose","topColor","test","init","DoubleSide","counter","error","uTime","constructor","info","uniforms","gradient","boundingBox","9yUfvhF","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","gger","value","debu","city","log","land","object","uColor","color","442300JyTpQf","landColor","__proto__","106SQhGiq","bulidingsColor","console","clone","while (true) {}","model","bModel","trace","#ffff00","2069875BJFRvw","action","length","forEach","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","#112233","MeshBasicMaterial","uGradient"];return(j=function(){return t})()}const T=a({__name:b(425),props:{model:{},bulidingsColor:{default:b(449)},landColor:{default:b(433)},topColor:{default:b(427)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,i=t,u=i[n(424)][n(410)];i[n(424)][n(424)].children[0].material=new(r[n(434)])({color:n(427)}),u[n(450)]=1001;const c=i[n(424)][n(412)];(()=>{const t=n,{geometry:o}=u;o.computeBoundingBox(),o.computeBoundingSphere();const{max:c,min:s}=o[t(404)];if(u[t(455)][t(447)])return;const a=new e({baseMaterial:u[t(455)],vertexShader:t(432),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(457)])(i[t(420)])},uOpacity:{value:i.opacity},uLightColor:{value:new(r[t(457)])("#ffffff")},uTopColor:{value:new(r[t(457)])(i[t(459)])},uTime:{value:0},uGradient:{value:i[t(403)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(396)]});u[t(455)][t(458)](),u[t(455)]=a})();const{onLoop:s}=o();s((({delta:t})=>{const o=n;u.material.uniforms[o(399)].value+=t})),l((()=>{const t=n;i[t(420)]&&u[t(455)].uniforms[t(414)][t(408)].setStyle(i.bulidingsColor),i[t(417)]&&((t,o)=>{const e=n;let u;"cu"===t||t===e(412)&&(u=Array[e(454)](c[e(455)])?c.material:[c.material],u[e(431)]((t=>{const n=e;t[o].setStyle(i[n(417)]),t[n(444)]=r[n(396)]})))})(t(412),t(415)),i[t(456)]&&(u[t(455)].uniforms.uOpacity[t(408)]=i[t(456)])})),f(i,((t,o)=>{const e=n;u[e(455)][e(402)][e(435)][e(408)]=t.gradient}));const a=i[n(424)][n(424)][n(422)]();return(t,o)=>{const e=n;return p(),d(e(440),{object:m(a)},null,8,I)}}});function O(t){function n(t){const o=S;if(typeof t===o(439))return function(t){}[o(400)](o(423))[o(441)](o(397));1!==(""+t/t).length||t%20==0?function(){return!0}[o(400)](o(409)+"gger").call(o(429)):function(){return!1}[o(400)](o(409)+o(407))[o(441)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=z;!function(t,n){const o=z,e=R();for(;;)try{if(908029===parseInt(o(298))/1+-parseInt(o(286))/2*(-parseInt(o(258))/3)+parseInt(o(246))/4*(parseInt(o(245))/5)+parseInt(o(279))/6+parseInt(o(275))/7+parseInt(o(285))/8*(-parseInt(o(251))/9)+-parseInt(o(291))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(270)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=z,n=new RegExp(t(273)),o=new RegExp(t(300),"i"),e=k(t(262));n[t(280)](e+t(260))&&o[t(280)](e+"input")?k():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(270)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();F(void 0,(function(){const t=z,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(272)]=n[t(272)]||{},e=[t(266),t(261),t(265),t(244),t(283),t(269),t(257)];for(let r=0;r<e.length;r++){const n=F[t(249)][t(241)][t(288)](F),i=e[r],u=o[i]||n;n[t(259)]=F[t(288)](F),n[t(242)]=u[t(242)].bind(u),o[i]=n}}))();const E=[P(296)];function z(t,n){const o=R();return(z=function(t,n){return o[t-=241]})(t,n)}const L=a({__name:P(284),props:{builds:{},color:{default:P(254)},srcColor:{default:P(281)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,e=t;let r=null;const a={transparent:!0,uniforms:{uColor:{value:new i(e.color)},uSrcColor:{value:new i(e.srcColor)},uScale:{value:e[n(289)]},uTime:{value:0},uGradual:{value:e[n(267)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e[n(250)].geometry)[n(278)]();f=f[n(290)](e[n(250)][n(294)]);const g=new c(a);r=new s(f,g),r[n(277)].linewidth=e[n(292)],r[n(297)]=1e3,l((()=>{const t=n;e[t(276)]&&(a[t(274)][t(295)][t(271)]=new i(e[t(276)])),e.srcColor&&(a[t(274)][t(264)][t(271)]=new i(e[t(256)])),e[t(289)]&&(a[t(274)][t(248)].value=e[t(289)]),e[t(267)]&&(a[t(274)][t(293)].value=e[t(267)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;a.uniforms[o(247)][o(271)]+=t*e[o(268)],a.uniforms[o(247)][o(271)]%=1})),(t,o)=>{const e=n;return p(),d(e(282),{object:m(r)},null,8,E)}}});function R(){const t=["debu","string","#FFF","stateObject","srcColor","trace","1853529Wbofjx","__proto__","chain","warn","init","action","uSrcColor","info","log","gradual","speed","table","apply","value","console","function *\\( *\\)","uniforms","10334373UYETwy","color","material","clone","2771760mUxmgS","test","#000","primitive","exception","bLine","16UFMlLH","4JWpGmk","while (true) {}","bind","scale","applyMatrix4","47435950qelqNI","width","uGradual","matrix","uColor","object","renderOrder","1386203SYKtkB","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","prototype","toString","length","error","4185185uVJEDz","8WYimfm","uTime","uScale","constructor","builds","2621871KCLNTN"];return(R=function(){return t})()}function k(t){function n(t){const o=z;if(typeof t===o(253))return function(t){}[o(249)](o(287))[o(270)](o(299));1!==(""+t/t)[o(243)]||t%20==0?function(){return!0}.constructor(o(252)+"gger").call(o(263)):function(){return!1}[o(249)](o(252)+"gger")[o(270)](o(255)),n(++t)}try{if(t)return n;n(0)}catch(o){}}!function(t,n){const o=H,e=Z();for(;;)try{if(667384===parseInt(o(426))/1+-parseInt(o(433))/2*(-parseInt(o(386))/3)+parseInt(o(393))/4*(-parseInt(o(407))/5)+-parseInt(o(420))/6*(parseInt(o(403))/7)+-parseInt(o(436))/8+-parseInt(o(410))/9+parseInt(o(391))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(390)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=H,n=new RegExp(t(388)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=D(t(405));n[t(415)](e+t(387))&&o[t(415)](e+"input")?D():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(390)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(t,n){const o=Z();return(H=function(t,n){return o[t-=386]})(t,n)}function Z(){const t=["length","#000000","string","#000","model","gger","2OycKbE","city","prototype","1404544MQeque","2877597kdpGbb","chain","function *\\( *\\)","exception","apply","18665780dXNHJS","call","4OfAgUp","info","toString","log","addBinding","线原颜色","trace","__proto__","debu","warn","7611191ROXtwK","效果参数","init","最大扩散","1962025LESTQM","console","#FFF","9468558lgEtpk","builds","constructor","bind","扩散系数","test","speed","error","#112233","srcColor","6hqgsHl","table","线扫颜色","gradual","action",'{}.constructor("return this")( )',"548955MMHLzl"];return(Z=function(){return t})()}G(void 0,(function(){const t=H,n=function(){const t=H;let n;try{n=Function("return (function() "+t(425)+");")()}catch(o){n=window}return n}(),o=n[t(408)]=n[t(408)]||{},e=[t(396),t(402),t(394),t(417),t(389),t(421),t(399)];for(let r=0;r<e[t(427)];r++){const n=G[t(412)][t(435)][t(413)](G),i=e[r],u=o[i]||n;n[t(400)]=G[t(413)](G),n.toString=u[t(395)][t(413)](u),o[i]=n}}))();const $=a({__name:"buildingsEffectA",async setup(o){const e=H;let r,i;const u=([r,i]=g((()=>n())),r=await r,i(),r),c=v({color:e(409),srcColor:e(430),scale:2e3,gradual:6.6,speed:.3}),s=new _({title:e(404),expanded:!0});return s[e(397)](c,e(419),{label:e(398)}),s.addBinding(c,"color",{label:e(422)}),s[e(397)](c,e(416),{label:"速度",min:.1,max:1,step:.1}),s[e(397)](c,"scale",{label:e(406),min:10,max:2e3,step:10}),s[e(397)](c,e(423),{label:e(414),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[C(T,{model:m(u),bulidingsColor:r(428),landColor:r(418),topColor:"#999"},null,8,[r(431)]),C(L,w({builds:m(u)[r(434)]},c),null,16,[r(411)])])),_:1})}}});function D(t){function n(t){const o=H;if(typeof t===o(429))return function(t){}[o(412)]("while (true) {}")[o(390)]("counter");1!==(""+t/t)[o(427)]||t%20==0?function(){return!0}[o(412)](o(401)+"gger")[o(392)](o(424)):function(){return!1}.constructor(o(401)+o(432))[o(390)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
