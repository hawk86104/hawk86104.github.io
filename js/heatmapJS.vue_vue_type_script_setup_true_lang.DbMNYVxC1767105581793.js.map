{"version":3,"file":"heatmapJS.vue_vue_type_script_setup_true_lang.DbMNYVxC1767105581793.js","sources":["../../src/plugins/heatMap/components/heatmapJS.vue"],"sourcesContent":["<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2023-11-08 10:41:23\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2023-11-08 14:04:46\n-->\n<script lang=\"ts\" setup>\nimport { watchEffect, defineExpose } from 'vue';\nimport { DoubleSide, Texture } from 'three'\nimport h337 from 'heatmap.js-fix'\nconst props = withDefaults(\n\tdefineProps<{\n\t\tPlane?: Array<number>\n\t\tshow2dCanvas?: boolean\n\t\theightRatio?: number\n\t}>(),\n\t{\n\t\tPlane: [50, 50, 1000, 1000],\n\t\tshow2dCanvas: true,\n\t\theightRatio: 6\n\t},\n)\nlet heatmap = null\nconst getRandom = (max: number, min: number) => {\n\treturn Math.round((Math.random() * (max - min + 1) + min) * 10) / 10;\n}\n\nlet heatmapCanvas = null\nconst initHeatmap = () => {\n\theatmapCanvas = document.createElement(\"heatmap-canvas\")\n\theatmapCanvas.width = 100\n\theatmapCanvas.height = 100\n\theatmapCanvas.style.position = 'absolute'\n\theatmapCanvas.style.top = '0'\n\theatmapCanvas.style.left = '0'\n\tdocument.body.appendChild(heatmapCanvas)\n\theatmap = h337.create({\n\t\tcontainer: heatmapCanvas,\n\t\twidth: 256,\n\t\theight: 256,\n\t\tblur: '.8',\n\t\tradius: 10\n\t});\n\treturn heatmap\n}\nconst setData = (data: Array) => {\n\tconst max = 12\n\tif (data) {\n\n\t} else {\n\t\tlet i = 0\n\t\tdata = [];\n\t\twhile (i < 2000) {\n\t\t\tdata.push({ x: getRandom(1, 256), y: getRandom(1, 256), value: getRandom(1, 6) });\n\t\t\ti++;\n\t\t}\n\t}\n\theatmap.setData({\n\t\tmax,\n\t\tdata\n\t});\n\ttexture.needsUpdate = true\n}\nconst texture = new Texture(initHeatmap()._renderer.canvas)\nsetData()\nconst shader = {\n\ttransparent: true,\n\tside: DoubleSide,\n\tvertexShader: `\n\tuniform sampler2D heightMap;\n\tuniform float heightRatio;\n\tvarying vec2 vUv;\n\tvarying float hValue;\n\tvarying vec3 cl;\n\tvoid main() {\n\t  vUv = uv;\n\t  vec3 pos = position;\n\t  cl = texture2D(heightMap, vUv).rgb;\n\t  hValue = texture2D(heightMap, vUv).r;\n\t  pos.y = hValue * heightRatio;\n\t  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos,1.0);\n\t}`,\n\tfragmentShader: `\n\tvarying float hValue;\n\tvarying vec3 cl;\n\tvoid main() {\n\t\tfloat v = abs(hValue - 1.);\n\t\tgl_FragColor = vec4(cl, .8 - v * v*1.1) ; \n\t}`,\n\tuniforms: {\n\t\theightMap: {\n\t\t\ttype: 't',\n\t\t\tvalue: texture\n\t\t},\n\t\theightRatio: { value: props.heightRatio }\n\t},\n}\nwatchEffect(() => {\n\theatmapCanvas.style.display = `${props.show2dCanvas ? 'block' : 'none'}`\n\tif (props.heightRatio) {\n\t\tshader.uniforms.heightRatio.value = props.heightRatio\n\t}\n})\ndefineExpose({\n\tsetData\n})\n// function onPointerMove(ev) {\n// \tif (ev) {\n// \t\tconsole.log(ev)\n// \t}\n// }\n</script>\n<template>\n\t<TresMesh>\n\t\t<!-- @pointer-move=\"onPointerMove\" -->\n\t\t<!-- <BoxGeometry :args=\"[50, 10, 50]\"></BoxGeometry> -->\n\t\t<TresPlaneGeometry :args=\"props.Plane\" :rotate-x=\"-Math.PI * 0.5\" />\n\t\t<TresShaderMaterial v-bind=\"shader\" />\n\t</TresMesh>\n</template>"],"names":[],"mappings":"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"}