import{i as e}from"./index.Crdf3MNx1763540743861.js";import{l as t}from"./utils.DhJ-cORL1763540743861.js";import"./@fesjs.BEMFm_yJ1763540743861.js";import"./index.CJ5-9CVy1763540743861.js";import{b as r}from"./three-mesh-ui.module.BVA20N0s1763540743861.js";import{c as n,d as o,a}from"./three-mesh-bvh.BY-MaG5X1763540743861.js";import{j as s,n as i,az as p,u,ae as m,f as l,V as c,B as f,bS as g,l as d}from"./three.rXKzP9fQ1763540743861.js";const h=t=>{const r=e.getItem("side.png");r.wrapS=r.wrapT=p,r.repeat.set(1,1);let n=new u({color:t,map:r,opacity:1,transparent:!0,side:m});return((e,t,r)=>{e.onBeforeCompile=e=>{e.uniforms={...e.uniforms,uColor1:{value:new d(t)},uColor2:{value:new d(r)}},e.vertexShader=e.vertexShader.replace("void main() {","\n\t\t\tattribute float alpha;\n\t\t\tvarying vec3 vPosition;\n\t\t\tvarying float vAlpha;\n\t\t\tvoid main() {\n\t\t\t\tvAlpha = alpha;\n\t\t\t\tvPosition = position;\n\t\t"),e.fragmentShader=e.fragmentShader.replace("void main() {","\n\t\t\tvarying vec3 vPosition;\n\t\t\tvarying float vAlpha;\n\t\t\tuniform vec3 uColor1;\n\t\t\tuniform vec3 uColor2;\n\t\t\n\t\t\tvoid main() {\n\t\t"),e.fragmentShader=e.fragmentShader.replace("#include <opaque_fragment>","\n\t\t#ifdef OPAQUE\n\t\tdiffuseColor.a = 1.0;\n\t\t#endif\n\t\t\n\t\t#ifdef USE_TRANSMISSION\n\t\tdiffuseColor.a *= transmissionAlpha + 0.1;\n\t\t#endif\n\t\tvec3 gradient = mix(uColor1, uColor2, vPosition.z/1.2);\n\t\t\n\t\toutgoingLight = outgoingLight*gradient;\n\t\t\n\t\tgl_FragColor = vec4( outgoingLight, diffuseColor.a  );\n\t\t")}})(n,"#ffffff","#666666"),n},v=(t,r,n)=>{const o=e.getItem("grayscaleMap.jpg");o.wrapS=o.wrapT=p,o.offset.set(0,.066),o.repeat.set(1,1-.066),o.needsUpdate=!0;const a=e.getItem("topNormal.jpg");return a.wrapS=a.wrapT=p,a.offset.set(0,.066),a.repeat.set(1,1-.066),a.needsUpdate=!0,new u({color:400967,map:o,transparent:!0,normalMap:a,normalScale:new l(n,n),opacity:1,roughness:t,metalness:r,side:m})};function y(e){var t=new c,r=new f;r.expandByObject(e);var n=new c;r.getSize(n);var o=new c;r.getCenter(o);let a={box3:r,boxSize:n,center:o,size:null};if(e.geometry){e.geometry.computeBoundingBox(),e.geometry.computeBoundingSphere();const{max:r,min:n}=e.geometry.boundingBox;t.x=r.x-n.x,t.y=r.y-n.y,t.z=r.z-n.z,a.size=t}return a}const x=(e,t,r,n,o)=>{const a=e.attributes.position,s=e.attributes.uv,i=e.groups[0].count;for(let p=0;p<i;p++){const e=(a.getX(p)-n)/t,i=(a.getY(p)-o)/r;s.setXY(p,e,i)}s.needsUpdate=!0,e.computeVertexNormals()},S=(e,t,r)=>{const n=new g;for(let o=0;o<e.length;o++){const[t,a]=r(e[o]);0===o&&n.moveTo(t,-a),n.lineTo(t,-a)}return{shape:n,properties:t.properties,pName:t.properties.name}},w=(e,t,r)=>{const n=[];for(let o=0;o<e.length;o++){const[t,a]=r(e[o]);n.push(t,-a,0)}return{points:new Float32Array(n),pName:t}},j=(e,t)=>{const r=[],n=[],o=[];return e.forEach(e=>{if(!e.properties.name)return;e.geometry.coordinates.forEach(o=>{o.length>3?r.push(S(o,e,t)):o.forEach(n=>{r.push(S(n,e,t))}),o.length>3?n.push(w(o,e.properties.name,t)):o.forEach(r=>{n.push(w(r,e.properties.name,t))})});let a=e.properties.centroid||e.properties.center||[0,0];a=t(a),a=[a[0],-a[1],0],o.push({pName:e.properties.name,position:a})}),{areaList:r,linesList:n,textList:o}},C=()=>{s.prototype.computeBoundsTree=n,s.prototype.disposeBoundsTree=o,i.prototype.raycast=a};function b(e,t){let r=[];return e.traverse(e=>{e.pName===t&&r.push(e)}),r}function z(e){return e.reduce((e,t,r)=>(r%3==0&&e.push([]),e[e.length-1].push(t),e),[])}const B=async()=>{const e=[],r=await t("./plugins/simpleGIS/json/china.json","features");return e.push({adcode:1e5,text:"中国",name:"中国",center:[104,37.5],centroid:[104,37.5],childrenNum:56,parent:{adcode:0},value:-1}),r.forEach((t,r)=>{t.properties.name&&"台湾省"!==t.properties.name&&"香港特别行政区"!==t.properties.name&&"澳门特别行政区"!==t.properties.name&&e.push({...t.properties,text:t.properties.name,value:r})}),{areaJson:r,provinceInfoList:e}},N=(e,t,r)=>{let n=e.toString(),o=new RegExp(t+"=([^&]*)"),a=n.replace(o,t+"="+r);return a==n&&(a=a+(a.indexOf("?")>0?"&":"?")+t+"="+r),a},T=()=>{r()};export{T,v as a,h as b,y as c,z as d,b as f,B as g,C as i,j as m,N as r,x as u};
