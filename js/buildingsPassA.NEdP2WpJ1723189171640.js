import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.P6hbCPpV1723189171640.js";import{bY as n,m as e,bW as o,c5 as r,a6 as i,C as u,cg as s}from"./three.5MXJ6W7w1723189171640.js";import{p as a,$ as c}from"./@tresjs.LTwFwASm1723189171640.js";import{d as l,a1 as p,r as f,o as d,f as v,g as m,j as h,aj as w,ak as x}from"./@vue.Q1VpS3901723189171640.js";import{P}from"./tweakpane.yHWGBmom1723189171640.js";import"./three-custom-shader-material.XueWmqLp1723189171640.js";import"./object-hash.jMAsrj6h1723189171640.js";import"./@amap.Lu-L8G0q1723189171640.js";import"./jszip.WwTqi4J91723189171640.js";import"./glsl-tokenizer.lazMVlew1723189171640.js";import"./glsl-token-string.HJw4RHIk1723189171640.js";import"./glsl-token-functions.95Du-VYb1723189171640.js";import"./@vueuse.oQlm8k6P1723189171640.js";const g=b;!function(t,n){const e=b,o=j();for(;;)try{if(424595===-parseInt(e(534))/1+parseInt(e(503))/2+-parseInt(e(488))/3*(parseInt(e(530))/4)+-parseInt(e(486))/5*(-parseInt(e(532))/6)+parseInt(e(483))/7*(-parseInt(e(493))/8)+-parseInt(e(531))/9+parseInt(e(525))/10)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const S=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[b(537)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function b(t,n){const e=j();return(b=function(t,n){return e[t-=482]})(t,n)}!function(){S(this,(function(){const t=b,n=new RegExp(t(540)),e=new RegExp(t(520),"i"),o=_(t(528));n.test(o+t(523))&&e[t(526)](o+t(505))?_():o("0")}))()}();const y=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[b(537)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function j(){const t=["length","buildingsPassA","uPosition","readBuffer","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uColor","__proto__","chain","table","10222600GzkQBz","test","debu","init","bind","853544VrrzXD","5531859juJeTH","6frpiUv","Vector2","268106pUZuey","while (true) {}","gger","apply","width","uWidth","function *\\( *\\)","time","addPass","140hxALDR","depthBuffer","material","2663275TwXvwI","uScalenum","6lXBLZB",'{}.constructor("return this")( )',"error","counter","stateObject","155392Uhbayf","uniforms","speed","prototype","color","action","#FFF","console","return (function() ","ShaderMaterial","1135378NlBpap","call","input","render","depthTexture","constructor","exception","set","string","value","trace","toString","uScaleone"];return(j=function(){return t})()}y(void 0,(function(){const t=b,n=function(){const t=b;let n;try{n=Function(t(501)+t(489)+");")()}catch(e){n=window}return n}(),e=n[t(500)]=n[t(500)]||{},o=["log","warn","info",t(490),t(509),t(524),t(513)];for(let r=0;r<o[t(516)];r++){const n=y[t(508)][t(496)].bind(y),i=o[r],u=e[i]||n;n[t(522)]=y.bind(y),n[t(514)]=u[t(514)][t(529)](u),e[i]=n}}))();const I=l({__name:g(517),props:{color:{default:g(499)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const l=t,{renderer:f,scene:d,camera:v,sizes:m}=a();let h,w=0,x=null,P=null;p((()=>{const t=b;m.width[t(512)]&&(h=m[t(538)].value,w=m.height[t(512)],(()=>{const t=b;x=new n(f[t(512)]);const a=new e(h,w);x[t(519)][t(484)]=!0,x.readBuffer[t(507)]=a;const c=new o(d[t(512)],v[t(512)]);x[t(482)](c),P=new r(new(i[t(502)])({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:a},uProjectionInverse:{value:v.value.projectionMatrixInverse},uMatrixWorld:{value:v[t(512)].matrixWorld},uColor:{value:new u(l[t(497)])},uScalenum:{value:l[t(487)]},uScaleone:{value:l[t(515)]},uWidth:{value:l[t(539)]},uPosition:{value:new(i[t(533)])(l.uPosition.x,l[t(518)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),x.addPass(P);const p=new r(s);x[t(482)](p)})())}));const{onLoop:g}=c();return g((({elapsed:t})=>{const n=b;x&&(x[n(506)](),P[n(494)][n(541)].value+=l[n(495)]/60)})),p((()=>{const t=b;P&&(l[t(497)]&&(P[t(485)][t(494)][t(521)][t(512)]=new u(l[t(497)])),l[t(487)]&&(P.material[t(494)][t(487)][t(512)]=l.uScalenum),l[t(515)]&&(P[t(485)][t(494)].uScaleone[t(512)]=l[t(515)]),l[t(539)]&&(P.material[t(494)].uWidth.value=l.uWidth),l[t(518)]&&P.material[t(494)][t(518)].value[t(510)](l[t(518)].x,l[t(518)].y))})),(t,n)=>null}});function _(t){function n(t){const e=b;if(typeof t===e(511))return function(t){}[e(508)](e(535))[e(537)](e(491));1!==(""+t/t).length||t%20==0?function(){return!0}[e(508)](e(527)+e(536))[e(504)](e(498)):function(){return!1}[e(508)](e(527)+e(536))[e(537)](e(492)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const W=M;!function(t,n){const e=M,o=D();for(;;)try{if(712565===-parseInt(e(506))/1+parseInt(e(501))/2+-parseInt(e(516))/3*(parseInt(e(488))/4)+-parseInt(e(524))/5+-parseInt(e(512))/6+parseInt(e(493))/7+-parseInt(e(515))/8*(-parseInt(e(508))/9))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const z=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function D(){const t=["uScalenum","warn","4920dBnbGS","3AjiiVM","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","buildingsPassA","uScaleone","__proto__","uWidth","exception","548590fAjLUI","error",'{}.constructor("return this")( )',"action","counter","string","chain","bind","log","apply","console","gger","3372OYIrKO","单条圈宽度","stateObject","test","call","9317000UmCMIK","while (true) {}","color","#00b4fb","后期效果","trace","inline","uPosition","64390vxNflN","最大范围","return (function() ","toString","addBinding","1127407odNHlv","table","21123FHPeKh","constructor","prototype","单条圈间距","5136402xwZawr"];return(D=function(){return t})()}!function(){z(this,(function(){const t=M,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(517),"i"),o=k("init");n[t(491)](o+t(530))&&e[t(491)](o+"input")?k():o("0")}))()}();const F=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function M(t,n){const e=D();return(M=function(t,n){return e[t-=486]})(t,n)}F(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(503)+t(526)+");")()}catch(e){n=window}return n}(),e=n[t(486)]=n[t(486)]||{},o=[t(532),t(514),"info",t(525),t(523),t(507),t(498)];for(let r=0;r<o.length;r++){const n=F[t(509)][t(510)][t(531)](F),i=o[r],u=e[i]||n;n[t(521)]=F[t(531)](F),n[t(504)]=u[t(504)][t(531)](u),e[i]=n}}))();const U=l({__name:W(519),setup(n){const e=W,o=f({color:e(496),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new P({title:e(497),expanded:!0});return r[e(505)](o,e(495),{label:"圈颜色"}),r[e(505)](o,e(513),{label:e(502),min:1,max:500,step:10}),r.addBinding(o,e(520),{label:e(511),min:1,max:100,step:1}),r[e(505)](o,e(522),{label:e(489),min:0,max:1,step:.01}),r[e(505)](o,"speed",{label:"速度",min:1,max:20,step:1}),r[e(505)](o,e(500),{picker:e(499),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(d(),v(t,{disableRender:!0,showAxesHelper:!1},{ability:m((()=>[h(I,w(x(o)),null,16)])),_:1}))}});function k(t){function n(t){const e=M;if(typeof t===e(529))return function(t){}[e(509)](e(494))[e(533)](e(528));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(e(518)+e(487))[e(492)](e(527)):function(){return!1}.constructor(e(518)+e(487))[e(533)](e(490)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{U as default};
