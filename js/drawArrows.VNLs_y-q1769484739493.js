import{importShared as e}from"./3d-tiles-renderer.qyEDeaaW1769484739493.js";import{useTres as t,OrbitControls_default as n}from"./index.CuW8EyFk1769484739493.js";import{Pane as o}from"./tweakpane.BbuIEN141769484739493.js";const{defineComponent:a}=await e("vue"),{onMounted:i,watchEffect:r,ref:l}=await e("vue"),s=await e("three"),c=a({__name:"drawArrows",setup(e){const{camera:n,scene:a}=t(),c=l(new s.Raycaster),u=new s.Vector2,d=[];l(null);const w=new s.PlaneGeometry(200,200),m=new s.MeshBasicMaterial({color:65280,side:s.DoubleSide}),p=new s.Mesh(w,m);p.rotation.set(0,0,Math.PI/2),a.value.add(p);let v="";let h=function(e){e.preventDefault(),window.removeEventListener("click",f,!1),window.removeEventListener("contextmenu",h,!1)},f=function(e){u.x=e.clientX/window.innerWidth*2-1,u.y=-e.clientY/window.innerHeight*2+1,c.value.setFromCamera(u,n.value);const t=c.value.intersectObject(p);if(t.length>0){const e=t[0].point;if(d.push(new s.Vector3(e.x,e.y,0)),"line"===v)M(t[0].normal)}},M=function(e){if(2==d.length){const t=new s.CatmullRomCurve3(d),n=new s.TubeGeometry(t,20,2,8,!1),o=new s.MeshBasicMaterial({color:16711680}),i=new s.Mesh(n,o);a.value.add(i);const r=e,l=C(t,r,Math.PI/5);a.value.add(l);const c=C(t,r,-Math.PI/5);a.value.add(c);const u=b(d[1]);a.value.add(u),d.length=0}},b=function(e){const t=new s.SphereGeometry(1.8,32,32),n=new s.MeshBasicMaterial({color:16711680}),o=new s.Mesh(t,n);return o.position.copy(e),o},C=function(e,t,n){const o=new s.CatmullRomCurve3([e.getPointAt(.8),e.getPointAt(1)]),a=new s.TubeGeometry(o,30,2,8,!1),i=new s.MeshBasicMaterial({color:16711680}),r=new s.Mesh(a,i).clone(),l=new s.Group;return l.add(r),l.position.copy(d[1]),r.position.sub(d[1]),l.rotation.set(Math.abs(t.x)*n,Math.abs(t.y)*n,Math.abs(t.z)*n),l};const y=function(){new o({title:"箭头",expanded:!0}).addFolder({title:"参数(鼠标间断点两个点，分别作为箭头的起点)，点击鼠标右键移除绘制"}).addButton({title:"绘制箭头",label:"激活"}).on("click",()=>{window.removeEventListener("click",f,!1),window.addEventListener("contextmenu",h,!1),v="line",window.addEventListener("click",f,!1)})};return i(()=>{y()}),r(()=>{}),(e,t)=>null}}),{defineComponent:u}=await e("vue"),{createElementVNode:d,unref:w,normalizeProps:m,guardReactiveProps:p,createVNode:v,Suspense:h,withCtx:f,openBlock:M,createBlock:b,resolveComponent:C,mergeProps:y}=await e("vue"),{reactive:P}=await e("vue"),g=u({__name:"drawArrows",setup(e){const t=P({windowSize:!0,alpha:!0,antialias:!0}),o=P({enableDamping:!0,enableZoom:!0,enablePan:!0,enableRotate:!0,makeDefault:!0});return(e,a)=>{const i=C("TresCanvas");return M(),b(i,y({clearColor:"#201919"},t),{default:f(()=>[a[0]||(a[0]=d("TresPerspectiveCamera",{fov:60,near:.1,far:2e3,position:[0,0,200],"look-at":[0,0,0]},null,-1)),a[1]||(a[1]=d("TresAmbientLight",{intensity:2},null,-1)),v(w(n),m(p(o)),null,16),(M(),b(h,null,{default:f(()=>[v(c)]),_:1}))]),_:1},16)}}});export{g as default};
