{"version":3,"file":"mergeTres.BqzN14ph1767105581793.js","sources":["../../src/plugins/AMapGIS/stores/mapStore.js","../../src/plugins/AMapGIS/components/mapContainer.vue","../../src/plugins/AMapGIS/components/mergeTres.vue"],"sourcesContent":["/*\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-21 14:31:55\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2024-02-22 10:11:00\n */\nimport { defineStore } from 'pinia'\nimport { shallowRef } from 'vue'\n\nexport const useMapStore = defineStore('mapStore', () => {\n\tconst aMap = shallowRef(null)\n\tconst mapHandle = shallowRef(null)\n\tconst cameraState = shallowRef(null)\n\n\t//导出参数\n\treturn { aMap, mapHandle, cameraState }\n})","<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-21 13:47:51\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2024-02-22 12:32:43\n-->\n<template>\n\t<div id=\"mapContainer\"></div>\n</template>\n\n<script setup lang=\"ts\">\nimport AMapLoader from \"@amap/amap-jsapi-loader\"\nimport { onMounted } from \"vue\"\nimport { useMapStore } from '../stores/mapStore'\n\nconst props = withDefaults(defineProps<{\n\tcenter?: Array<Number>\n\tzoom?: Number\n\tpitch?: Number\n\tmapStyle?: String\n}>(), {\n\tcenter: [0, 0],\n\tzoom: 14,\n\tpitch: 50,\n\tmapStyle: 'normal',\n})\n\nconst mapStore = useMapStore()\nlet map = null\nonMounted(async () => {\n\tawait AMapLoader.load({\n\t\tkey: \"0c7222955570f1b434c4adfcc1e955e8\", //可自行修改成自己得高德API key\n\t\tversion: \"2.0\",\n\t})\n\t\t.then((_AMap) => {\n\t\t\tmap = new _AMap.Map('mapContainer', {\n\t\t\t\tcenter: props.center,\n\t\t\t\tzooms: [1, 20],\n\t\t\t\tviewMode: '3D',\n\t\t\t\tzoom: props.zoom,\n\t\t\t\tpitch: props.pitch,\n\t\t\t\tmapStyle: 'amap://styles/'+props.mapStyle,\n\t\t\t})\n\t\t\tmap.on('click', (e) => {\n\t\t\t\tconst text = `您在 [ ${e.lnglat.getLng()},${e.lnglat.getLat()} ] 的位置单击了地图！`\n\t\t\t\tconsole.log(text)\n\t\t\t})\n\t\t\tmapStore.$patch({ aMap: _AMap })\n\t\t\tmapStore.$patch({ mapHandle: map })\n\t\t})\n\t\t.catch((e) => {\n\t\t\tconsole.log(e)\n\t\t})\n})\n\n</script>\n\n<style lang=\"less\" scoped>\n#mapContainer {\n\theight: 100vh;\n}\n</style>","<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-21 14:17:12\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-24 18:33:32\n-->\n<template></template>\n<script setup>\nimport { watchEffect } from 'vue'\nimport { useTres } from '@tresjs/core'\nimport { useMapStore } from '../stores/mapStore'\n\nconst props = defineProps({\n\tcenter: {\n\t\tdefault: [0, 0]\n\t}\n})\n\nconst { camera, scene, renderer } = useTres()\nconst mapStore = useMapStore()\nlet customCoords = null\nlet customLayer = null\nwatchEffect(() => {\n\tif (mapStore.aMap) {\n\t\t// renderer.autoClear = false\n\t\tcustomCoords = mapStore.mapHandle.customCoords\n\t\tcustomLayer = new mapStore.aMap.CustomLayer(renderer.domElement, {\n\t\t\tzIndex: 10,\n\t\t\trender: () => {\n\t\t\t\trenderer.resetState()\n\t\t\t\tcustomCoords.setCenter(props.center)\n\t\t\t\tconst { near, far, fov, up, lookAt, position } =\n\t\t\t\t\tcustomCoords.getCameraParams()\n\t\t\t\t// 这里的顺序不能颠倒，否则可能会出现绘制卡顿的效果。\n\t\t\t\tcamera.value.near = near\n\t\t\t\tcamera.value.far = far\n\t\t\t\tcamera.value.fov = fov\n\t\t\t\tmapStore.$patch({\n\t\t\t\t\tcameraState: {\n\t\t\t\t\t\tnear, far, fov, position\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tcamera.value.position.set(...position)\n\t\t\t\tcamera.value.up.set(...up)\n\t\t\t\tcamera.value.lookAt(...lookAt)\n\t\t\t\tcamera.value.updateProjectionMatrix()\n\t\t\t\trenderer.render(scene.value, camera.value)\n\t\t\t\trenderer.resetState()\n\t\t\t},\n\t\t\talwaysRender: true\n\t\t})\n\t\tmapStore.mapHandle.add(customLayer)\n\t}\n})\n</script>"],"names":["useTres"],"mappings":"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"}