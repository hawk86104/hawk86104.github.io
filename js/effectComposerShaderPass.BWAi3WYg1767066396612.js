import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as r,_ as a,K as n}from"./@tresjs.B1f7s3pS1767066396612.js";import{f as t,U as s,E as l,a5 as o}from"./three.BD1hRFgo1767066396612.js";const{defineComponent:u}=await e("vue"),{createElementVNode:i,Fragment:v,openBlock:d,createElementBlock:c}=await e("vue"),{watchEffect:m,ref:f}=await e("vue"),p=await e("three"),w=u({__name:"ecLayerShaderPass",setup(e){const n=f(),u=f(),{camera:w,renderer:h,scene:x,sizes:T}=r(),g=.572,y=.51,_=0;let M=null,C=null,b=null;m(()=>{n.value&&n.value.layers.set(0),u.value&&u.value.layers.set(1),T.width.value&&(((e,r,a,n,o)=>{M=new t(e,r);const u=new s(new p.Vector2(n,o),g,y,_);C=new l(a),C.renderToScreen=!1,C.addPass(M),C.addPass(u)})(x.value,w.value,h,T.width.value,T.height.value),(e=>{b=new l(e);const r=new p.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:C.renderTarget2.texture}},vertexShader:"\n            varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }\n        ",fragmentShader:"\n            uniform sampler2D baseTexture;\n            uniform sampler2D bloomTexture;\n            varying vec2 vUv;\n            void main() {\n                gl_FragColor = ( vec4( 1.0 ) *texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) );\n            }\n        ",defines:{}}),a=new o(r,"baseTexture");a.needsSwap=!0,b.addPass(M),b.addPass(a)})(h))});const{onRender:B}=a();return B(()=>{C&&b&&w.value&&(h.clear(),w.value.layers.set(1),C.render(),h.clearDepth(),w.value.layers.set(0),b.render(x.value,w.value))}),(e,r)=>(d(),c(v,null,[i("TresMesh",{ref_key:"normalBox",ref:n,position:[3,2,1]},[...r[0]||(r[0]=[i("TresBoxGeometry",{args:[1,1,1]},null,-1),i("TresMeshNormalMaterial",null,null,-1)])],512),i("TresMesh",{ref_key:"shineBox",ref:u,position:[0,2,-4]},[...r[1]||(r[1]=[i("TresBoxGeometry",{args:[1,1,1]},null,-1),i("TresMeshNormalMaterial",null,null,-1)])],512)],64))}}),{defineComponent:h}=await e("vue"),{createElementVNode:x,unref:T,createVNode:g,resolveComponent:y,withCtx:_,openBlock:M,createBlock:C}=await e("vue"),{watchEffect:b,ref:B}=await e("vue"),P=h({__name:"effectComposerShaderPass",setup(e){const r=B();return b(()=>{if(r.value){r.value.context.renderer.instance.autoClear=!1}}),(e,a)=>{const t=y("TresCanvas");return M(),C(t,{renderMode:"manual","window-size":"",ref_key:"tcRef",ref:r},{default:_(()=>[a[0]||(a[0]=x("TresPerspectiveCamera",{position:[10,10,10]},null,-1)),a[1]||(a[1]=x("TresAmbientLight",{intensity:1},null,-1)),g(T(n)),a[2]||(a[2]=x("TresGridHelper",{args:[10,10]},null,-1)),g(w)]),_:1},512)}}});export{P as default};
