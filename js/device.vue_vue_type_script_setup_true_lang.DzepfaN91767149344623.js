import{importShared as e,mergeGeometries as t}from"./3d-tiles-renderer.de6b_qgz1767149344623.js";import{Fs as r,_l as a}from"./index.Btae5S5d1767149344623.js";import{RenderPass as o,EffectComposer as n,ShaderPass as s}from"./RenderPass.D5QCtMRU1767149344623.js";import{UnrealBloomPass as i}from"./UnrealBloomPass.ByzRH1Rw1767149344623.js";import{OutputPass as l}from"./OutputPass.os0o4pq61767149344623.js";import"./customShaderMaterial.vue_vue_type_script_setup_true_lang.C_pYeFAB1767149344623.js";import"./index.vue_vue_type_script_setup_true_lang.C9DbtXj-1767149344623.js";import{useGLTF as d}from"./index.zGefaP3R1767149344623.js";const u=await e("three");let c=new u.Color("#0fb1fb");const m=new u.MeshBasicMaterial({color:c,transparent:!0,opacity:.3}),h=new u.LineBasicMaterial({color:new u.Color(c),depthTest:!0,transparent:!0}),p=0,v=.972,f=.21,{withAsyncContext:w,defineComponent:_}=await e("vue"),{unref:b,openBlock:g,createElementBlock:x}=await e("vue"),P=["object"],{MeshBasicMaterial:y,Color:M}=await e("three"),{watchEffect:j,toRaw:S}=await e("vue"),C=_({__name:"device",props:{threshold:{default:0},strength:{default:.972},radius:{default:.21}},async setup(e){let c,_;const C=e,{nodes:T}=([c,_]=w(()=>d("https://opensource.cdn.icegl.cn/model/industry4/modelDraco.glb")),c=await c,_(),c),B=(e=>{const r=[];e.traverse(e=>{e.isMesh&&(r.push(e.geometry),e.material=m)});const a=t(r),o=new u.EdgesGeometry(a,6.137*Math.PI),n=new u.LineSegments(o);return h.opacity=1,n.material=h,n})(T.Sketchfab_model),{camera:k,renderer:R,scene:U,sizes:D}=r();let E=null,L=null,z=null;const A=new y({color:"black"});j(()=>{if(k.value){R.setPixelRatio(window.devicePixelRatio),U.value.add(B);const{finalComposer:e,effectComposer:t,bloomPass:r}=((e,t,r,a,d)=>{const c=new o(e,t),m=new i(new u.Vector2(a,d),v,f,p),h=new n(r);h.renderToScreen=!1,h.addPass(c),h.addPass(m);const w=new s(new u.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:h.renderTarget2.texture}},vertexShader:"varying vec2 vUv;\nvoid main(){\n\tvUv=uv;\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}",fragmentShader:"uniform sampler2D baseTexture;\nuniform sampler2D bloomTexture;\nvarying vec2 vUv;\nvoid main(){\n\tgl_FragColor=(texture2D(baseTexture,vUv)+vec4(1.)*texture2D(bloomTexture,vUv));\n}",defines:{}}),"baseTexture");w.needsSwap=!0;const _=new l,b=new n(r);return b.addPass(c),b.addPass(w),b.addPass(_),{finalComposer:b,effectComposer:h,renderScene:c,bloomPass:m}})(U.value,k.value,R,D.width.value,D.height.value);E=e,L=t,z=r,z.threshold=C.threshold,z.strength=C.strength,z.radius=C.radius}C.threshold&&(z.threshold=C.threshold),C.strength&&(z.strength=C.strength),C.radius&&(z.radius=C.radius)});const G={},{onBeforeRender:N}=a();let O=T.Sketchfab_model.getObjectByName("canister_turbine_011_Nickel-Light-PBR_0"),V=O.material.clone(),F=new y({color:new M("red"),transparent:!0,opacity:1});return N(({elapsed:e})=>{T.hull_turbine&&(T.hull_turbine.rotation.x+=.03,T.blades_turbine_003.rotation.x+=.03),Math.floor(e)%2?O.material=V:O.material=F},-1),N(({elapsed:e})=>{L&&(U.value.traverse(e=>{var t;((t=e).isMesh||"GridHelper"===t.type||"reflectorShaderMesh"===t.name)&&(G[t.uuid]=t.material,t.material=A)}),L.render(e)),E&&(U.value.traverse(e=>{var t;G[(t=e).uuid]&&(t.material=G[t.uuid],delete G[t.uuid])}),E.render(e))},1),(e,t)=>(g(),x("primitive",{object:S(b(T).Sketchfab_model)},null,8,P))}});export{C as _sfc_main};
