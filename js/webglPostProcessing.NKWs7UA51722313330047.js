import{i as n}from"./ice-utils.2MwDSnQz1722313330047.js";import{m as t,_ as e}from"./gl-matrix.dcoIu8f11722313330047.js";import{P as o}from"./tweakpane.yHWGBmom1722313330047.js";import{d as r,r as i,q as a,o as c,D as s,J as u,u as f}from"./@vue.Q1VpS3901722313330047.js";const l="\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoords;\n\nuniform mat4 uProjection;\nuniform mat4 uView;\nuniform mat4 uModel;\n\nvarying vec2 texCoords;\n\nvoid main()\n{\n    texCoords=aTexCoords;\n    gl_Position=uProjection*uView*uModel*vec4(aPosition,1.);\n}",m="\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D textureSampler;\n\nvoid main()\n{\n    gl_FragColor=texture2D(textureSampler,texCoords);\n}",d=x;function x(n,t){const e=T();return(x=function(n,t){return e[n-=327]})(n,t)}!function(n,t){const e=x,o=T();for(;;)try{if(490615===parseInt(e(346))/1*(parseInt(e(428))/2)+parseInt(e(385))/3+parseInt(e(368))/4+-parseInt(e(379))/5*(-parseInt(e(397))/6)+-parseInt(e(353))/7+parseInt(e(356))/8+-parseInt(e(401))/9)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const _=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[x(327)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){_(this,(function(){const n=x,t=new RegExp("function *\\( *\\)"),e=new RegExp(n(383),"i"),o=b(n(369));t[n(338)](o+n(407))&&e.test(o+"input")?b():o("0")}))()}();const E=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[x(327)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();E(void 0,(function(){const n=x;let t;try{t=Function(n(414)+n(382)+");")()}catch(r){t=window}const e=t[n(350)]=t[n(350)]||{},o=[n(333),"warn","info","error",n(330),"table",n(334)];for(let i=0;i<o[n(390)];i++){const t=E[n(339)][n(427)][n(332)](E),r=o[i],a=e[r]||t;t[n(398)]=E[n(332)](E),t[n(359)]=a[n(359)].bind(a),e[r]=t}}))();const g={id:d(387)},p=[d(341)];function T(){const n=["framebufferTexture2D","15562170dDRPPR","createTexture","hidden","height","createFramebuffer","width","chain","TEXTURE_WRAP_S","getElementById","gger","UNSIGNED_BYTE","slider","NEAREST","return (function() ","create","ONE_MINUS_SRC_ALPHA","SRC_ALPHA","getUniformLocation","ARRAY_BUFFER","是否后处理","bindBuffer","bindFramebuffer","offset_left_top","call","action","drawElements","prototype","1165908fsWFhk","debu","apply","enable","string","exception","uView","bind","log","trace","#canvaswebgl","uniformMatrix4fv","BYTES_PER_ELEMENT","test","constructor","FRAMEBUFFER","src","TEXTURE_MIN_FILTER","scale","COLOR_BUFFER_BIT","createBuffer","1iKVmVZ","bindTexture","offset_left_bottom","texImage2D","console","value","bufferData","5040840oqiNJU","STATIC_DRAW","logo-texture","7093240LdzGZb","ortho","lookAt","toString","ELEMENT_ARRAY_BUFFER","counter","mat4","innerWidth","clearColor","RGBA","TEXTURE_WRAP_T","innerHeight","3192268tvTfeR","init","clear","TEXTURE_2D","BLEND","FLOAT","mixParam","inline","texParameteri","none","stateObject","669620XFXzPQ","CLAMP_TO_EDGE","translate",'{}.constructor("return this")( )',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","useProgram","409479nRQbfS","uModel","canvaswebgl","offset_right_bottom","addBinding","length","vertexAttribPointer","while (true) {}","querySelector","change","blendFunc","TRIANGLES","24WQiurp","__proto__","offset_right_top"];return(T=function(){return n})()}const R=r({__name:"webglPostProcessing",setup(r){const x=d;let _,E,T,R,b,A,F,y,v,P,h,w,C;const U=1,B=.71,I=.76,L=new o({title:"参数"}),S=i({hidden:!0,offset_right_top:{x:.5,y:.5},offset_right_bottom:{x:.5,y:.5},offset_left_top:{x:.5,y:.5},offset_left_bottom:{x:.5,y:.5},overlay:{r:1,g:0,b:.33}});L.addBlade({view:x(412),label:"颜色",min:0,max:1,value:.5}).on(x(394),(n=>{const t=x;k(),E.uniform1f(w,n[t(351)])}));let D=new Float32Array([.5,.5,0,1,1,.5,-.5,0,1,0,-.5,-.5,0,0,0,-.5,.5,0,0,1]);L[x(389)](S,x(403),{label:x(420)}),L[x(389)](S,x(399),{picker:"inline",x:{min:0,max:1},y:{min:0,max:1}}).on(x(394),(n=>{const t=x;D[0]=S[t(399)].x,D[1]=S[t(399)].y,k()})),L[x(389)](S,x(388),{picker:x(375),x:{min:-1,max:1},y:{min:-1,max:1}}).on(x(394),(n=>{const t=x;D[5]=S[t(388)].x,D[6]=S.offset_right_bottom.y,k()})),L.addBinding(S,x(348),{picker:x(375),x:{min:-1,max:1},y:{min:-1,max:1}}).on(x(394),(n=>{const t=x;D[10]=S[t(348)].x,D[11]=S[t(348)].y,k()})),L.addBinding(S,"offset_left_top",{picker:"inline",x:{min:-1,max:1},y:{min:-1,max:1}}).on(x(394),(n=>{const t=x;D[15]=S[t(423)].x,D[16]=S[t(423)].y,k()})),a((()=>{M()}));const M=function(){const t=x;_=document[t(393)](t(335)),_[t(406)]=window[t(363)],_[t(404)]=window[t(367)],E=_.getContext("webgl"),E&&(function(){const t=x,e=new Float32Array([.5,.5,0,1,1,.5,-.5,0,1,0,-.5,-.5,0,0,0,-.5,.5,0,0,1]),o=new Uint8Array([0,1,2,0,2,3]);R=j(e,o),T=n(E,l,m),v=E[t(418)](T,"uProjection"),P=E.getUniformLocation(T,t(331)),h=E.getUniformLocation(T,t(386)),C=X(document[t(409)](t(355)))}(),k(),E[t(328)](E[t(372)]),E[t(395)](E[t(417)],E[t(416)]),N())};function N(){const n=x;E.bindFramebuffer(E[n(340)],F),E.clearColor(U,B,I,1),E[n(370)](E.COLOR_BUFFER_BIT),function(){const n=x;E.useProgram(T),E[n(421)](E[n(419)],R);const o=t[n(415)]();e[n(362)][n(357)](o,0,_.width,_[n(404)],0,.1,100),E[n(336)](v,!1,o);const r=e[n(362)].create();t[n(358)](r,[0,0,1],[0,0,0],[0,1,0]),E[n(336)](P,!1,r),O(C,600,600),O(C,400,400)}(),E[n(422)](E[n(340)],null),S.hidden&&(E[n(370)](E[n(344)]),E[n(364)](0,0,1,1),E[n(421)](E[n(419)],b),E[n(384)](A),E.bindTexture(E[n(371)],y)),E[n(426)](E[n(396)],6,E[n(411)],0),requestAnimationFrame(N)}function O(n,o,r){const i=x;let a=e[i(362)].create();t[i(381)](a,a,[o,r,0]),e[i(362)][i(343)](a,a,[250,250,0]),E[i(336)](h,!1,a),E.bindTexture(E[i(371)],n),E.drawElements(E.TRIANGLES,6,E[i(411)],0)}function k(){const t=x,e=new Uint8Array([0,1,2,0,2,3]);b=j(D,e),A=n(E,"\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoords;\n\nvarying vec2 texCoords;\n\nvoid main()\n{\n    texCoords=aTexCoords;\n    gl_Position=vec4(aPosition,1.);\n}","\nprecision mediump float;\n\nvarying vec2 texCoords;\n\nuniform sampler2D textureSampler;\nuniform float mixParam;\nvoid main()\n{\n    // float luminance=dot(texture2D(textureSampler,texCoords).rgb,vec3(.3451,.2118,.302));\n    vec4 color=mix(texture2D(textureSampler,texCoords),vec4(.1098,.6784,.1843,1.),mixParam);\n    gl_FragColor=color;\n}"),w=E.getUniformLocation(A,t(374)),E.getUniformLocation(A,"color"),function(){const n=x;y=X(_),F=E[n(405)](),E[n(422)](E.FRAMEBUFFER,F),E[n(400)](E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E[n(371)],y,0),E[n(422)](E.FRAMEBUFFER,null)}()}function X(n){const t=x,e=E[t(402)]();return E[t(347)](E[t(371)],e),n instanceof HTMLImageElement?E[t(349)](E[t(371)],0,E[t(365)],E[t(365)],E[t(411)],n):E[t(349)](E[t(371)],0,E[t(365)],n[t(406)],n[t(404)],0,E[t(365)],E[t(411)],null),E[t(376)](E[t(371)],E[t(342)],E[t(413)]),E[t(376)](E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E[t(413)]),E[t(376)](E[t(371)],E[t(408)],E[t(380)]),E.texParameteri(E.TEXTURE_2D,E[t(366)],E[t(380)]),e}function j(n,t){const e=x,o=E[e(345)]();E[e(421)](E[e(419)],o),E[e(352)](E[e(419)],n,E[e(354)]);const r=3*Float32Array[e(337)]+2*Float32Array[e(337)];E[e(391)](0,3,E[e(373)],!1,r,0),E.enableVertexAttribArray(0),E[e(391)](1,2,E[e(373)],!1,r,3*Float32Array.BYTES_PER_ELEMENT),E.enableVertexAttribArray(1);const i=E[e(345)]();return E[e(421)](E[e(360)],i),E[e(352)](E[e(360)],t,E[e(354)]),E[e(421)](E[e(419)],null),o}return(n,t)=>{const e=x;return c(),s("canvas",g,[u("img",{id:e(355),src:f("./")+"/plugins/postProcessing/image/logo.png",style:{display:e(377)}},null,8,p)])}}});function b(n){function t(n){const e=x;if(typeof n===e(329))return function(n){}[e(339)](e(392))[e(327)](e(361));1!==(""+n/n)[e(390)]||n%20==0?function(){return!0}[e(339)](e(429)+e(410))[e(424)](e(425)):function(){return!1}[e(339)](e(429)+e(410))[e(327)](e(378)),t(++n)}try{if(n)return t;t(0)}catch(e){}}export{R as default};
