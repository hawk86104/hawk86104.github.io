import{c as e,_ as a}from"./@tresjs.BCHtwiaC1763540743861.js";import{ae as t,l as s,u as o,be as n,df as i,cY as r,dg as u}from"./three.rXKzP9fQ1763540743861.js";import{B as l}from"./three-custom-shader-material.C6taB_aY1763540743861.js";import{i as d,s as m}from"./utils.DhJ-cORL1763540743861.js";import{b as c,a as p}from"./buildingsCustomShaderMaterial.DyBo--wu1763540743861.js";import{_ as h}from"./importantBuildings.vue_vue_type_script_setup_true_lang.qA8Tg5S71763540743861.js";import{d as v,a as g,w as f,a9 as w,H as j,o as y,I as _,b,F as x}from"./@vue.Co_gxueH1763540743861.js";const B=["object"],T=v({__name:"buildingsMode",setup(v){d();const{state:T}=e("https://opensource.cdn.icegl.cn/model/digitalCity/shanghaiDraco/shanghaiDraco.gltf",{draco:!0,decoderPath:"./draco/"}),C=g(null);f(()=>T.value,e=>{e?.scene&&(C.value=e.scene.clone(),C.value.traverse(async e=>{if(e.isMesh&&(-1!==e.name.indexOf("Shanghai")||-1!==e.name.indexOf("Object")))if(-1!==e.name.indexOf("Floor"));else if(-1!==e.name.indexOf("River")){const a=await m(w(e));a.position.set(0,0,1800),e.add(a)}else O(w(e)),S(w(e))}))});const M=g(0),O=e=>{const{geometry:a}=e;a.computeBoundingBox(),a.computeBoundingSphere(),a.computeBoundsTree();const{max:n,min:i}=a.boundingBox,r=new l({baseMaterial:o,vertexShader:p,fragmentShader:c,silent:!0,uniforms:{uMax:{value:n},uMin:{value:i},uBorderWidth:{value:.006},uCircleTime:{value:3},uColor:{value:new s("#005c58")},uOpacity:{value:.8},uLightColor:{value:new s("#990")},uTopColor:{value:new s("#888800")},uTime:M,uGradient:{value:!0}},depthWrite:!0,depthTest:!0,transparent:!0,side:t});e.material.dispose(),e.material=r},S=e=>{const a=new n(e.geometry,1e3);let t=(new i).fromEdgesGeometry(a);t.computeBoundsTree();let o=new r({color:new s("#000"),linewidth:.8,opacity:.6,transparent:!0,depthWrite:!0,depthTest:!0});o.resolution.set(window.innerWidth,window.innerHeight),e.add(new u(t,o))},{onBeforeRender:W}=a();return W(({delta:e})=>{M.value+=e}),(e,a)=>(y(),j(x,null,[C.value?(y(),j("primitive",{key:0,object:w(C.value),position:[1,0,1]},null,8,B)):_("",!0),C.value?(y(),b(h,{key:1,group:w(C.value)},null,8,["group"])):_("",!0)],64))}});export{T as _};
