import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as t,_ as r,K as a}from"./@tresjs.B1f7s3pS1767066396612.js";import{f as n,E as l,U as s,a7 as o,a8 as u,a5 as i,a9 as v}from"./three.BD1hRFgo1767066396612.js";const{defineComponent:d}=await e("vue"),{createElementVNode:c,Fragment:m,openBlock:f,createElementBlock:T}=await e("vue"),{watchEffect:h,ref:p}=await e("vue"),x=await e("three"),w=d({__name:"ecLayerMultiple",setup(e){const a=p(),d=p(),w=p(),g=p();h(()=>{a.value&&a.value.layers.set(0),d.value&&d.value.layers.set(1),w.value&&w.value.layers.set(2),g.value&&g.value.layers.set(3)});const{camera:y,renderer:M,scene:_,sizes:B}=t(),P=.572,D=.51,S=0;let k=null,C=null;let b=null;let U=null;let N=null;h(()=>{B.width.value&&(((e,t,r,a,o)=>{k=new n(e,t),C=new l(r),C.renderToScreen=!1,C.addPass(k);const u=new s(new x.Vector2(a,o),P,D,S);C.addPass(u)})(_.value,y.value,M,B.width.value,B.height.value),(e=>{U=new l(e),U.renderToScreen=!1,U.addPass(k);const t=new u;U.addPass(t)})(M),(e=>{b=new l(e),b.renderToScreen=!1,b.addPass(k);const t=new o;b.addPass(t)})(M),(e=>{N=new l(e),N.addPass(k);const t=new x.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:C.renderTarget2.texture},filmTexture:{value:b.renderTarget2.texture},glitchTexture:{value:U.renderTarget2.texture}},vertexShader:"\n            varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }\n        ",fragmentShader:"\n            uniform sampler2D baseTexture;\n            uniform sampler2D bloomTexture;\n\t\t\t\t\t\tuniform sampler2D filmTexture;\n\t\t\t\t\t\tuniform sampler2D glitchTexture;\n            varying vec2 vUv;\n            void main() {\n                gl_FragColor = ( \n\t\t\t\t\t\t\t\t\tvec4( 1.0 ) * texture2D( baseTexture, vUv )  + \n\t\t\t\t\t\t\t\t\tvec4( 1.0 ) * texture2D( bloomTexture, vUv ) + \n\t\t\t\t\t\t\t\t\tvec4( 1.0 ) * texture2D( filmTexture, vUv ) + \n\t\t\t\t\t\t\t\t\tvec4( 1.0 ) * texture2D( glitchTexture, vUv ) \n\t\t\t\t\t\t\t\t);\n            }\n        ",defines:{}}),r=new i(t,"baseTexture");r.needsSwap=!0,N.addPass(r);const{width:a,height:n}=e.getDrawingBufferSize(new x.Vector2),s=new i(v);s.uniforms.resolution.value.set(1/a,1/n),N.addPass(s)})(M))});const{onRender:E}=r();return E(()=>{C&&N&&y.value&&(M.clear(),y.value.layers.set(1),C.render(),y.value.layers.set(2),b.render(),y.value.layers.set(3),U.render(),M.clearDepth(),y.value.layers.set(0),N.render(_.value,y.value))}),(e,t)=>(f(),T(m,null,[c("TresMesh",{ref_key:"normalBox",ref:a,position:[3,2,1]},[...t[0]||(t[0]=[c("TresBoxGeometry",{args:[1,1,1]},null,-1),c("TresMeshNormalMaterial",null,null,-1)])],512),c("TresMesh",{ref_key:"shineBox",ref:d,position:[0,2,-4]},[...t[1]||(t[1]=[c("TresBoxGeometry",{args:[1,1,1]},null,-1),c("TresMeshNormalMaterial",null,null,-1)])],512),c("TresMesh",{ref_key:"filmBox",ref:w,position:[1,2,3]},[...t[2]||(t[2]=[c("TresBoxGeometry",{args:[1,1,1]},null,-1),c("TresMeshNormalMaterial",null,null,-1)])],512),c("TresMesh",{ref_key:"glitchSphere",ref:g,position:[-3,2,0]},[...t[3]||(t[3]=[c("TresSphereGeometry",{args:[.8,32,16]},null,-1),c("TresMeshNormalMaterial",null,null,-1)])],512)],64))}}),{defineComponent:g}=await e("vue"),{createElementVNode:y,unref:M,createVNode:_,resolveComponent:B,withCtx:P,openBlock:D,createBlock:S}=await e("vue"),{watchEffect:k,ref:C}=await e("vue"),b=g({__name:"effectComposerMultiple",setup(e){const t=C();return k(()=>{if(t.value){t.value.context.renderer.instance.autoClear=!1}}),(e,r)=>{const n=B("TresCanvas");return D(),S(n,{renderMode:"manual","window-size":"",ref_key:"tcRef",ref:t},{default:P(()=>[r[0]||(r[0]=y("TresPerspectiveCamera",{position:[10,10,10]},null,-1)),r[1]||(r[1]=y("TresAmbientLight",{intensity:1},null,-1)),_(M(a)),r[2]||(r[2]=y("TresGridHelper",{args:[10,10]},null,-1)),_(w)]),_:1},512)}}});export{b as default};
