import{n as e,_ as a,K as n}from"./@tresjs.CC-VM6g11766394917683.js";import{P as o}from"./tweakpane.CqZAnw7f1766394917683.js";import{_ as r}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.B10xVLCB1766394917683.js";import"./OimoPhysicsBuffer.CZ5jbQLF1766394917683.js";import"./shapeConfigurator.vue_vue_type_style_index_1_scoped_abbf0cc1_lang.CXJ66YiI1766394917683.js";import"./Resource.CDqX8L841766394917683.js";import"./three-custom-shader-material.-uIL0IHF1766394917683.js";import"./PackedMipMapGenerator._063ERT-1766394917683.js";import{d as t,r as s,a as i,w as l,G as c,o as u,I as m,m as v,g as p,b as d,e as f,h as k,u as g,a9 as h,aa as j}from"./@vue.BxPWGdWw1766394917683.js";import{k as S,bK as _,a6 as w,aE as C}from"./three.F31Lz30M1766394917683.js";import"./three.quarks.zV5tjxhZ1766394917683.js";import"./postprocessing.DnKKyAPS1766394917683.js";import"./@vueuse.PX2Ih8Bm1766394917683.js";import"./dither.glsl.tNAdkJUa1766394917683.js";import"./Reflector.oCCTq04i1766394917683.js";import"./vite-plugin-qiankun.B06WoCqG1766394917683.js";import"./utils.CNife3_q1766394917683.js";import"./oimophysics.CfVKSiAm1766394917683.js";import"./object-hash.BlsCJiuO1766394917683.js";import"./@amap.fjyZdsU91766394917683.js";import"./jszip.CCQtYoU41766394917683.js";import"./three-stdlib.DKf5n1fq1766394917683.js";import"./quarks.core.C3xH0YPO1766394917683.js";const M=["rotation-x"],T=t({__name:"shaderCircleWave",props:{color:{default:"#ffffff"},colorDark:{default:"#000000"},speed:{default:1}},setup(n){const o=n,r=s({side:w,transparent:!0,blending:_,flatShading:!0,depthTest:!0,depthWrite:!1,uniforms:{uTime:{type:"f",value:0},uScanTex:{type:"t",value:null},uScanColor:{type:"v3",value:new S(o.color)},uScanColorDark:{type:"v3",value:new S(o.colorDark)}},vertexShader:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}\n",fragmentShader:"\n#define uScanOrigin vec3(0.,0.,0.)\n#define uScanWaveRatio1 3.2\n#define uScanWaveRatio2 2.8\n\nuniform float uTime;\nuniform sampler2D uScanTex;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nuniform vec3 uScanColor;\nuniform vec3 uScanColorDark;\n\nfloat circleWave(vec3 p,vec3 origin,float distRatio){\n    float t=uTime;\n    float dist=distance(p,origin)*distRatio;\n    float radialMove=fract(dist-t);\n    float fadeOutMask=1.-smoothstep(1.,3.,dist);\n    radialMove*=fadeOutMask;\n    float cutInitialMask=1.-step(t,dist);\n    radialMove*=cutInitialMask;\n    return radialMove;\n}\n\nvec3 getScanColor(vec3 worldPos,vec2 uv,vec3 col){\n    // mask\n    float scanMask=texture(uScanTex,uv).r;\n    // waves\n    float cw=circleWave(worldPos,uScanOrigin,uScanWaveRatio1);\n    float cw2=circleWave(worldPos,uScanOrigin,uScanWaveRatio2);\n    // scan\n    float mask1=smoothstep(.3,0.,1.-cw);\n    mask1*=(1.+scanMask*.7);\n    \n    float mask2=smoothstep(.07,0.,1.-cw2)*.8;\n    mask1+=mask2;\n    \n    float mask3=smoothstep(.09,0.,1.-cw)*1.5;\n    mask1+=mask3;\n\n    // color\n    vec3 scanCol=mix(uScanColorDark,uScanColor,mask1);\n    col=mix(col,scanCol,mask1);\n    \n    return col;\n\t\t// return vec3(cw);\n\t\t// return vec3(scanMask);\n\t\t// return worldPos;\n\t\t// return vec3(mask1);\n\t\t// return scanCol;\n}\n\nvoid main()\n{\n    vec3 col=vec3(0.);\n    col=getScanColor(vPosition,vUv*10.0,col);\n    gl_FragColor=vec4(col,1.);\n}\n"}),t=i(null),{state:p}=e("./plugins/floor/image/scan.png");l(()=>p.value,e=>{e&&(e.wrapS=C,e.wrapT=C,r.uniforms.uScanTex.value=e,t.value.needsUpdate=!0,t.value.uniformsNeedUpdate=!0)}),l(()=>[o.color,o.colorDark],([e,a])=>{r.uniforms.uScanColor.value=new S(e),r.uniforms.uScanColorDark.value=new S(a)});const{onBeforeRender:d}=a();return d(()=>{r.uniforms.uTime.value+=.01*o.speed}),(e,a)=>(u(),c("TresGroup",null,[m("TresMesh",{"rotation-x":-Math.PI/2},[a[0]||(a[0]=m("TresPlaneGeometry",{args:[1,1]},null,-1)),m("TresShaderMaterial",v({ref_key:"tsmRef",ref:t},r),null,16)],8,M)]))}}),x=t({__name:"circleWave",setup(e){const a=s({reflectivity:.1,showGridHelper:!1,scale:1}),t=s({color:"#ffffff",colorDark:"#000000",speed:1,scale:2}),i=new o({title:"shaderCircleWave地面",expanded:!0});return i.addBinding(t,"color",{label:"圈颜色"}),i.addBinding(t,"colorDark",{label:"圈渐变色"}),i.addBinding(t,"speed",{label:"速度",min:.1,max:5,step:.1}),i.addBinding(t,"scale",{label:"大小",min:.1,max:10,step:.1}),(e,o)=>{const s=p("TresCanvas");return u(),d(s,{clearColor:"#201919","window-size":""},{default:f(()=>[o[0]||(o[0]=m("TresPerspectiveCamera",{position:[3,3,0],fov:45,near:.1,far:1e4},null,-1)),k(g(n),{enableDamping:""}),o[1]||(o[1]=m("TresAmbientLight",{intensity:6},null,-1)),k(g(T),h(j(t)),null,16),k(r,v({position:[0,-.5,0]},a),null,16)]),_:1})}}});export{x as default};
