import{a0 as t,C as n,_ as o,cc as e,cd as r,ce as i,cf as u,m as s,bU as c,ak as a,am as l}from"./three.874nNzAX1726273176332.js";import{c as f,U as p,Y as d}from"./@tresjs.BFyWuCYn1726273176332.js";import{C as m}from"./three-custom-shader-material.rb-2297Q1726273176332.js";import"./object-hash.POLi8wZH1726273176332.js";import"./@amap.5r4w7xpt1726273176332.js";import"./glsl-tokenizer.pufBtMwG1726273176332.js";import{d as h,b as g,a3 as y,w,o as v,E as b,u as _,r as I,a4 as C,e as x,f as M,g as T,L as j,j as A,aj as O,ak as S,F as R,J as B,H,m as L}from"./@vue.JNsx1iN61726273176332.js";!function(t,n){const o=z,e=P();for(;;)try{if(263849===parseInt(o(208))/1+parseInt(o(235))/2*(-parseInt(o(227))/3)+parseInt(o(231))/4+-parseInt(o(233))/5*(-parseInt(o(215))/6)+parseInt(o(234))/7+parseInt(o(219))/8*(parseInt(o(224))/9)+parseInt(o(199))/10*(-parseInt(o(223))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(217)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(214),"i"),e=F(t(236));n[t(207)](e+t(206))&&o[t(207)](e+t(204))?F():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(217)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();E(void 0,(function(){const t=z;let n;try{n=Function(t(200)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(202)]=n[t(202)]||{},e=[t(240),t(221),t(228),t(213),t(205),t(209),t(230)];for(let i=0;i<e[t(229)];i++){const n=E.constructor[t(238)][t(201)](E),r=e[i],u=o[r]||n;n[t(216)]=E[t(201)](E),n[t(226)]=u.toString[t(201)](u),o[r]=n}}))();const G=async()=>{const t=z,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(239)]((n=>{const i=t;n[i(225)]===i(203)&&(o=n),n[i(225)]===i(222)&&(e=n),n.name===i(232)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function z(t,n){const o=P();return(z=function(t,n){return o[t-=199]})(t,n)}function F(t){function n(t){const o=z;if("string"==typeof t)return function(t){}[o(210)](o(211))[o(217)]("counter");1!==(""+t/t)[o(229)]||t%20==0?function(){return!0}[o(210)](o(220)+o(237))[o(212)](o(218)):function(){return!1}.constructor(o(220)+o(237))[o(217)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function P(){const t=["exception","chain","test","244215hrzmOs","table","constructor","while (true) {}","call","error","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","247584sbstZj","__proto__","apply","action","152IWLjeu","debu","warn","LANDMASS","8006064FCpeNS","169929OaPCle","name","toString","63ZxKAId","info","length","trace","264652pBGfxu","ROADS","40dRrTUr","324310nNIubb","5132VVxUNw","init","gger","prototype","traverse","log","10CEGUub","return (function() ","bind","console","CITY_UNTRIANGULATED","input"];return(P=function(){return t})()}const W=D;function D(t,n){const o=N();return(D=function(t,n){return o[t-=234]})(t,n)}!function(t,n){const o=D,e=N();for(;;)try{if(939986===parseInt(o(255))/1*(-parseInt(o(290))/2)+-parseInt(o(259))/3+-parseInt(o(235))/4+-parseInt(o(266))/5*(-parseInt(o(294))/6)+-parseInt(o(260))/7+parseInt(o(285))/8+-parseInt(o(293))/9*(-parseInt(o(264))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(247)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=D,n=new RegExp(t(272)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=K(t(273));n[t(239)](e+t(261))&&o[t(239)](e+"input")?K():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(247)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function N(){const t=["landColor","debu","toString","stateObject","gradient","bind","apply","boundingBox","prototype","model","material","setStyle","gger","computeBoundingSphere","1LKUxMk","object","__proto__","bulidingsColor","3858255AKEOtc","5943497QJHLff","chain","length",'{}.constructor("return this")( )',"30692450HfmxOd","log","11335AWMvsm","error","uGradient","land","while (true) {}","clone","function *\\( *\\)","init","value","counter","city","buildingsModelCustomShader","uOpacity","renderOrder","#112233","Color","opacity","isArray","trace","763504iMIHwn","forEach","warn","uniforms","computeBoundingBox","371846GgijdV","console","#e523ff","9qBqbcX","294wruEaP","dispose","58804vOflMY","color","constructor","call","test","uColor"];return(N=function(){return t})()}$(void 0,(function(){const t=D;let n;try{n=Function("return (function() "+t(263)+");")()}catch(r){n=window}const o=n[t(291)]=n.console||{},e=[t(265),t(287),"info",t(267),"exception","table",t(284)];for(let i=0;i<e[t(262)];i++){const n=$[t(237)][t(249)][t(246)]($),r=e[i],u=o[r]||n;n[t(257)]=$[t(246)]($),n[t(243)]=u.toString.bind(u),o[r]=n}}))();const U=[W(256)],V=h({__name:W(277),props:{model:{},bulidingsColor:{default:W(292)},landColor:{default:W(280)},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=W,i=e,u=g(0),s=i[r(250)][r(276)];s[r(279)]=1001;const c=i[r(250)][r(269)];(()=>{const e=r,{geometry:c}=s;c[e(289)](),c[e(254)]();const{max:a,min:l}=c[e(248)];if(s[e(251)].__csm)return;const f=new m({baseMaterial:s[e(251)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:a},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(i.bulidingsColor)},uOpacity:{value:i[e(282)]},uLightColor:{value:new(o[e(281)])("#ffffff")},uTopColor:{value:new(o[e(281)])(i.topColor)},uTime:u,uGradient:{value:i[e(245)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t});s.material[e(234)](),s[e(251)]=f})();const{onLoop:a}=p();a((({delta:t})=>{u.value+=t})),y((()=>{const n=r;i[n(258)]&&s[n(251)][n(288)][n(240)][n(274)].setStyle(i[n(258)]),i[n(241)]&&((n,o)=>{const e=r;let u;"cu"===n||n===e(269)&&(u=Array[e(283)](c.material)?c[e(251)]:[c.material],u[e(286)]((n=>{const r=e;n[o][r(252)](i[r(241)]),n.side=t})))})(n(269),n(236)),i[n(282)]&&(s[n(251)][n(288)][n(278)].value=i[n(282)])})),w(i,((t,n)=>{const o=r;s[o(251)][o(288)][o(268)][o(274)]=t.gradient}));const l=i.model[r(250)][r(271)]();return(t,n)=>(v(),b("primitive",{object:_(l)},null,8,U))}});function K(t){function n(t){const o=D;if("string"==typeof t)return function(t){}[o(237)](o(270))[o(247)](o(275));1!==(""+t/t)[o(262)]||t%20==0?function(){return!0}.constructor(o(242)+o(253))[o(238)]("action"):function(){return!1}[o(237)]("debugger")[o(247)](o(244)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Y=X;function q(){const t=["Shader","innerWidth","info","set","8Ijondt","uniforms","linewidth","string","log"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","value","uOpacity","while (true) {}","bind","console","opacity","call","length","primitive","buildingsLines","10780DeqaKF","uColor","571674dHSGam","apply","gger","builds","fromEdgesGeometry","input","Wireframe","geometry",'{}.constructor("return this")( )',"18112zyoihR","applyMatrix4","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","resolution","1344768NweDnC","__proto__","constructor","function *\\( *\\)","trace","639xBcBuG","style","439385YITvXi","chain","133QugiAH","toString","test","175NTkpWK","#FFF","width","1042cVccAU","color","init","matrix","5612574aEJazW","error","clone","material","prototype"];return(q=function(){return t})()}!function(t,n){const o=X,e=q();for(;;)try{if(146605===-parseInt(o(157))/1*(parseInt(o(160))/2)+-parseInt(o(132))/3+parseInt(o(173))/4*(parseInt(o(152))/5)+-parseInt(o(145))/6+-parseInt(o(154))/7*(-parseInt(o(141))/8)+-parseInt(o(150))/9*(parseInt(o(189))/10)+parseInt(o(164))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=X,n=new RegExp(t(148)),o=new RegExp(t(143),"i"),e=ot(t(162));n[t(156)](e+t(153))&&o[t(156)](e+t(137))?ot():e("0")}))()}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(133)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function X(t,n){const o=q();return(X=function(t,n){return o[t-=131]})(t,n)}Q(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function("return (function() "+t(140)+");")()}catch(o){n=window}return n}(),o=n[t(183)]=n.console||{},e=[t(177),"warn",t(171),t(165),"exception","table",t(149)];for(let r=0;r<e[t(186)];r++){const n=Q.constructor[t(168)].bind(Q),i=e[r],u=o[i]||n;n[t(146)]=Q[t(182)](Q),n.toString=u[t(155)].bind(u),o[i]=n}}))();const tt=["object"],nt=h({__name:Y(188),props:{builds:{},width:{default:1},color:{default:Y(158)},opacity:{default:1},style:{default:"Wireframe"}},setup(t){const o=Y,c=t;let a=null,l=null;if(c[o(151)]===o(138)){const t=new e(c[o(135)][o(139)]);let n=(new r)[o(136)](t),s=new i({color:c[o(161)],linewidth:c.width,opacity:c[o(184)],transparent:!0,depthWrite:!0,depthTest:!0});s[o(144)][o(172)](window[o(170)],window.innerHeight),a=new u(n,s),a.applyMatrix4(c[o(135)][o(163)][o(166)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(c.color)},uOpacity:{value:c[o(184)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:o(178)};const t=new e(c[o(135)].geometry),r=new s(l);a=new LineSegments(t,r),a[o(142)](c.builds.matrix[o(166)]()),a[o(167)][o(175)]=c[o(159)],a.renderOrder=1e3}return y((()=>{const t=o;c.style===t(169)&&(c[t(161)]&&(l[t(174)][t(131)].value=new n(c[t(161)])),c[t(184)]&&(l.uniforms[t(180)][t(179)]=c[t(184)])),c[t(151)]===t(138)&&(c[t(161)]&&(a[t(167)][t(161)]=new n(c[t(161)])),c.opacity&&(a[t(167)].opacity=c[t(184)])),c[t(159)]&&(a[t(167)][t(175)]=c[t(159)])})),(t,n)=>{const e=o;return v(),b(e(187),{object:_(a)},null,8,tt)}}});function ot(t){function n(t){const o=X;if(typeof t===o(176))return function(t){}[o(147)](o(181)).apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(147)]("debugger")[o(185)]("action"):function(){return!1}[o(147)]("debu"+o(134))[o(133)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=ft;!function(t,n){const o=ft,e=lt();for(;;)try{if(768392===-parseInt(o(319))/1+-parseInt(o(312))/2*(parseInt(o(331))/3)+-parseInt(o(362))/4*(parseInt(o(311))/5)+-parseInt(o(309))/6*(parseInt(o(344))/7)+parseInt(o(349))/8*(parseInt(o(354))/9)+parseInt(o(356))/10+parseInt(o(317))/11*(parseInt(o(343))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(357)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=ft,n=new RegExp(t(339)),o=new RegExp(t(365),"i"),e=dt(t(360));n[t(313)](e+t(320))&&o[t(313)](e+t(329))?dt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(357)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=ft;let n;try{n=Function(t(310)+t(346)+");")()}catch(r){n=window}const o=n[t(353)]=n[t(353)]||{},e=[t(322),t(347),"info",t(359),t(316),t(336),t(351)];for(let i=0;i<e[t(364)];i++){const n=it[t(342)][t(318)].bind(it),r=e[i],u=o[r]||n;n[t(324)]=it[t(341)](it),n[t(330)]=u[t(330)][t(341)](u),o[r]=n}}))();const ut=j(et(328),{color:et(327)},null,-1),st=j(et(352),{position:[100,100,0],intensity:.5,color:et(327)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(){const t=["prototype","1309783QLxttk","chain","#000","log","TresCanvas","__proto__","showGridHelper","city","#ffffff","TresAmbientLight","input","toString","2688591urxaaR","counter","gger","pagesShow","action","table","#000000","TresPerspectiveCamera","function *\\( *\\)","$slots","bind","constructor","12YgHFMt","84lxkCAQ","ability",'{}.constructor("return this")( )',"warn","disableRender","11132600VYiVvH","while (true) {}","trace","TresDirectionalLight","console","9JOhKft","model","3780080NHlhVA","apply","perspectiveCameraRef","error","init","string","114748gRryMf","showBuildings","length","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","734658qspwmj","return (function() ","15KGsHfc","2fLkjrP","test","builds","stateObject","exception","30361826shESmT"];return(lt=function(){return t})()}function ft(t,n){const o=lt();return(ft=function(t,n){return o[t-=309]})(t,n)}const pt=h({__name:et(334),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=I({clearColor:n(337),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:a,toneMapping:l,disableRender:r[n(348)]}),u=I({autoRotate:r.autoRotate,enableDamping:!0});let s=null;r.showBuildings&&([o,e]=C((()=>G())),o=await o,e(),s=o);const f=g(),p=g();return(t,o)=>{const e=n,c=x(e(323));return v(),M(c,L({ref_key:"tcRef",ref:p},i,{"window-size":""}),{default:T((()=>[j(e(338),{ref_key:e(358),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),A(_(d),O(S(u)),null,16),ut,st,r[e(363)]&&_(s)?(v(),b(R,{key:0},[A(V,{model:_(s)},null,8,[e(355)]),A(nt,{builds:_(s)[e(326)],color:e(321)},null,8,[e(314)])],64)):B("",!0),H(t[e(340)],e(345)),r.showAxesHelper?(v(),b("TresAxesHelper",ct)):B("",!0),r[e(325)]?(v(),b("TresGridHelper",at)):B("",!0)])),_:3},16)}}});function dt(t){function n(t){const o=ft;if(typeof t===o(361))return function(t){}[o(342)](o(350))[o(357)](o(332));1!==(""+t/t)[o(364)]||t%20==0?function(){return!0}[o(342)](o(366)+o(333)).call(o(335)):function(){return!1}[o(342)](o(366)+o(333))[o(357)](o(315)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as _,nt as a,pt as b,G as l};
