import{m as n,e as t}from"./@tresjs.dTM0HLnZ1735031078130.js";import{_ as o,Q as e,cm as r,cn as i,co as u,a0 as c,cI as a}from"./three.bc6MLGU_1735031078130.js";import{z as s}from"./three-custom-shader-material.uc9Xgl3q1735031078130.js";import{T as f}from"./3d-tiles-renderer.swrpju-81735031078130.js";import{d as l,b as p,a3 as d,o as m,D as h,J as g,u as v}from"./@vue.-THQH3GC1735031078130.js";import{P as w,U as y,M as x,T as _,a as b}from"./index.EOMlTmYa1735031078130.js";import"./mapBoxShow.vue_vue_type_script_setup_true_lang.BeurypcD1735031078130.js";import"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.QdO0dz2a1735031078130.js";import"./utils.NoZDRSqk1735031078130.js";!function(n,t){const o=M,e=j();for(;;)try{if(688952===-parseInt(o(204))/1*(parseInt(o(210))/2)+parseInt(o(174))/3+parseInt(o(177))/4+parseInt(o(180))/5*(-parseInt(o(213))/6)+-parseInt(o(182))/7+-parseInt(o(187))/8*(-parseInt(o(186))/9)+parseInt(o(190))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[M(202)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function M(n,t){const o=j();return(M=function(n,t){return o[n-=171]})(n,t)}!function(){I(this,(function(){const n=M,t=new RegExp("function *\\( *\\)"),o=new RegExp(n(172),"i"),e=T(n(217));t[n(185)](e+n(176))&&o[n(185)](e+"input")?T():e("0")}))()}();const C=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[M(202)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function j(){const n=["12019720HYpMeN","normalize","crossVectors","Matrix4","dot","action","getOrientedBounds","trace","onLoadTileSet","debu","setFromMatrixPosition","warn","apply","Box3","93YDAfRL","group","Vector3","quaternion","gger","__proto__","260XerNjo","clone","position","8157966ggSnDV","while (true) {}","log",'{}.constructor("return this")( )',"init","Sphere","stateObject","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","getBoundingSphere","2225409GQGeeA","center","chain","3684528QzlDGD","return (function() ","bind","5qbZetI","console","9262491oiajzo","length","exception","test","27DfsopP","1384024tVrafQ","constructor","toString"];return(j=function(){return n})()}C(void 0,(function(){const n=M,t=function(){const n=M;let t;try{t=Function(n(178)+n(216)+");")()}catch(o){t=window}return t}(),o=t[n(181)]=t[n(181)]||{},e=[n(215),n(201),"info","error",n(184),"table",n(197)];for(let r=0;r<e[n(183)];r++){const t=C[n(188)].prototype[n(179)](C),i=e[r],u=o[i]||t;t[n(209)]=C[n(179)](C),t[n(189)]=u[n(189)][n(179)](u),o[i]=t}}))();const z=n=>{const t=M;n[t(198)]=r=>{const i=t,u=new(o[i(203)]),c=new(o[i(218)]),a=new(o[i(193)]);let s=null,f=0;n[i(196)](u,a)?(s=(new(o[i(206)]))[i(200)](a),f=s[i(183)]()):n[i(173)](c)&&(s=c[i(175)][i(211)](),f=s[i(183)]());const l=((n,t)=>{const r=M,i=new e,u=(new(o[r(206)]))[r(192)](n,t);return i.x=u.x,i.y=u.y,i.z=u.z,i.w=1+n[r(211)]()[r(194)](t),i[r(191)](),i})(null==s?void 0:s[i(191)](),new(o[i(206)])(0,1,0));n[i(205)][i(207)].x=l.x,n[i(205)][i(207)].y=l.y,n.group.quaternion.z=l.z,n.group.quaternion.w=l.w,n[i(205)][i(212)].z=-f}};function T(n){function t(n){const o=M;if("string"==typeof n)return function(n){}.constructor(o(214))[o(202)]("counter");1!==(""+n/n)[o(183)]||n%20==0?function(){return!0}.constructor(o(199)+o(208)).call(o(195)):function(){return!1}.constructor(o(199)+o(208))[o(202)](o(171)),t(++n)}try{if(n)return t;t(0)}catch(o){}}const B=P;!function(n,t){const o=P,e=A();for(;;)try{if(480885===-parseInt(o(172))/1*(parseInt(o(157))/2)+-parseInt(o(171))/3+-parseInt(o(166))/4*(-parseInt(o(138))/5)+-parseInt(o(177))/6*(parseInt(o(162))/7)+parseInt(o(126))/8+parseInt(o(137))/9*(-parseInt(o(153))/10)+parseInt(o(158))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function A(){const n=["733034vPWDUA","toString","input","log","console","9570JSvteB","MeshPhongMaterial","camera","error","call","onLoadModel","boundingBox","debu","receiveShadow","castShadow","constructor","action","https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json","info","parent","prototype","#e523ff","isMesh","#ffff00","table","6245400VdxMBP","dispose","width","EdgesGeometry","errorTarget","computeBoundingBox","apply","bind","material","TresGroup","setResolutionFromRenderer","179649vbTigR","65qTMnkV","function *\\( *\\)","test","primitive","traverse","#ffffff","innerWidth","geometry","value","__proto__","resolution","applyMatrix4","object","gradient","counter","50ICjcNh","fromEdgesGeometry","init","innerHeight","2xIZoCj","12039181jmnJwA","setCamera","stateObject","length","2674BtwlDR","while (true) {}","return (function() ","chain","181928LPSTrF","gger","Color","clone","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","1630194DaJAmc"];return(A=function(){return n})()}!function(){S(this,(function(){const n=P,t=new RegExp(n(139)),o=new RegExp(n(170),"i"),e=O(n(155));t[n(140)](e+n(165))&&o.test(e+n(174))?O():e("0")}))()}();const D=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[P(132)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function P(n,t){const o=A();return(P=function(n,t){return o[n-=126]})(n,t)}D(void 0,(function(){const n=P;let t;try{t=Function(n(164)+'{}.constructor("return this")( ));')()}catch(r){t=window}const o=t.console=t[n(176)]||{},e=[n(175),"warn",n(190),n(180),"exception",n(196),"trace"];for(let i=0;i<e[n(161)];i++){const t=D.constructor[n(192)].bind(D),r=e[i],u=o[r]||t;t[n(147)]=D[n(133)](D),t[n(173)]=u[n(173)][n(133)](u),o[r]=t}}))();const R=[B(150)],Z=l({__name:"tilesBuildings",props:{bulidingsColor:{default:B(193)},topColor:{default:B(195)},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(e){const a=B,l=e,w=p(0),y=new f(a(189));y[a(130)]=2,y[a(182)]=n=>{const t=a;n.scene[t(142)]((n=>{const e=t;if(n[e(194)]){(n=>{const t=P,{geometry:e}=n;e[t(131)](),e.computeBoundingSphere();const{max:r,min:i}=e[t(183)],u=new s({baseMaterial:new(o[t(178)]),vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor; // 顶部颜色\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main() {\n  // 转世界坐标\n  uMax_world = modelMatrix * vec4(uMax, 1.);\n  uMin_world = modelMatrix * vec4(uMin, 1.);\n  vec3 distColor = uColor;\n  float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n  float rate = residue / uCircleTime;\n  float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n  if (uMin_world.y + lightOffset < vPosition.y &&\n      uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n    csm_DiffuseColor = vec4(uLightColor, uOpacity);\n  } else {\n    csm_DiffuseColor = vec4(distColor, uOpacity);\n  }\n\n  // 根据高度计算颜色\n  if (uGradient) {\n    float rateHight =\n        (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y);\n    // vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight * 0.6);\n    float mixNumber = clamp(rateHight * 2.3 - 1.5, 0., 1.);\n    vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, mixNumber);\n\n    csm_DiffuseColor = vec4(outColor, uOpacity);\n  }\n}",silent:!0,uniforms:{uMax:{value:r},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(o[t(168)])(l.bulidingsColor)},uOpacity:{value:l.opacity},uLightColor:{value:new(o[t(168)])(t(143))},uTopColor:{value:new(o[t(168)])(l.topColor)},uTime:w,uGradient:{value:l[t(151)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:c});n.material[t(127)](),n[t(134)]=u})(n),n[e(185)]=!1,n[e(186)]=!1;const t=new(o[e(129)])(n[e(145)][e(169)]());let a=(new r)[e(154)](t),f=new i({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});f[e(148)].set(window[e(144)],window[e(156)]);const p=new u(a,f);p[e(149)](n.matrix[e(169)]()),n[e(191)].add(p)}}))},z(y);const{renderer:x,sizes:_}=n();d((()=>{const n=a;_.width[n(146)]&&(y[n(159)](l.camera),y[n(136)](l[n(179)],x.value))}));const{onBeforeLoop:b}=t();return b((({delta:n})=>{const t=a;w[t(146)]+=2*n,l[t(179)]&&_[t(128)][t(146)]&&(l[t(179)].updateMatrixWorld(),y.update())})),(n,t)=>{const o=a;return m(),h(o(135),null,[g(o(141),{object:v(y).group},null,8,R)])}}});function O(n){function t(n){const o=P;if("string"==typeof n)return function(n){}[o(187)](o(163))[o(132)](o(152));1!==(""+n/n).length||n%20==0?function(){return!0}.constructor(o(184)+o(167))[o(181)](o(188)):function(){return!1}.constructor(o(184)+o(167))[o(132)](o(160)),t(++n)}try{if(n)return t;t(0)}catch(o){}}const E=L;!function(n,t){const o=L,e=V();for(;;)try{if(546014===-parseInt(o(424))/1*(-parseInt(o(381))/2)+-parseInt(o(432))/3*(parseInt(o(383))/4)+-parseInt(o(379))/5*(-parseInt(o(403))/6)+parseInt(o(370))/7*(parseInt(o(412))/8)+parseInt(o(433))/9*(parseInt(o(390))/10)+parseInt(o(405))/11+-parseInt(o(425))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[L(436)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function L(n,t){const o=V();return(L=function(n,t){return o[n-=364]})(n,t)}!function(){F(this,(function(){const n=L,t=new RegExp(n(404)),o=new RegExp(n(375),"i"),e=H("init");t.test(e+"chain")&&o[n(373)](e+n(387))?H():e("0")}))()}();const N=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function V(){const n=["2017704RdWgzV","https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}","counter","Vector3","toString","object","gger","log","showTileNo","mapCenter","return (function() ","domElement","7ZbNnhB","19996452adZwpq","source","prototype","string","position0","length","enableDamping","179307RwFvji","9yHIAha","__proto__","lookAt","apply","position","console","while (true) {}","filter","constructor","flatShading","21ynpQuj","info","useWorker","test","coordType","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","abs","updateProjectionMatrix","set","25vQKxzX","wireframe","37218duAPFu","primitive","8yZVHwQ","table","target","rotation","input","bind","monochrome","392470TrsxVe","warn","call","#4688b5","render","camera","action","value","debu",'{}.constructor("return this")( )',"exception","trace","maxZoom","437652UNxMlj","function *\\( *\\)","11451704JvhCWr","update","provider","bbox","Color","showBoundingBox","stateObject"];return(V=function(){return n})()}N(void 0,(function(){const n=L;let t;try{t=Function(n(422)+n(399)+");")()}catch(r){t=window}const o=t[n(365)]=t[n(365)]||{},e=[n(419),n(391),n(371),"error",n(400),n(384),n(401)];for(let i=0;i<e[n(430)];i++){const t=N[n(368)][n(427)][n(388)](N),r=e[i],u=o[r]||t;t[n(434)]=N[n(388)](N),t.toString=u[n(416)][n(388)](u),o[r]=t}}))();const W=[E(417),E(386)],G=l({__name:"tileMapBuildingsMesh",props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(e,{expose:r}){const i=E,u=e,{renderer:c,scene:s}=n(),f=new w;f[i(374)]=y;const l=new x;l[i(426)]=i(413),l[i(420)]=!1,l[i(372)]=!0;const p=new _(f,l);p[i(410)]=!1,p[i(380)]=!1,p[i(369)]=!1,p[i(367)]={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let g=new(o[i(409)])(i(393));p[i(367)][i(389)]={r:g.r,g:g.g,b:g.b};const I=new b;I[i(407)]=p,I[i(408)]=u[i(408)],I[i(402)]=u[i(402)],u.camera.up=new(o[i(415)])(0,1,0),u.camera.position[i(378)](u[i(421)][0],u.mapCenter[2],2e3-u[i(421)][1]),u[i(395)][i(435)](new(o[i(415)])(u.camera.position.x,0,u[i(395)].position.z-3e3)),I[i(395)]=u[i(395)];let M=null;d((()=>{const n=i;c.value&&(M=new a(u[n(395)],c[n(397)][n(423)]),M[n(431)]=!0,M.dampingFactor=.05,M.minDistance=600,M[n(429)].set(u[n(395)][n(364)].x,u[n(395)].position.y,u[n(395)][n(364)].z),M[n(385)][n(378)](u[n(395)][n(364)].x,0,u[n(395)].position.z-2e3))}));const{onLoop:C}=t();return C((()=>{const n=i;if(c.value){const t=50*Math[n(376)](u[n(395)].position.y);u[n(395)].far=t+5e3,u[n(395)][n(377)](),M&&(M[n(406)](),M[n(385)].y=0),I[n(406)](),c[n(397)][n(394)](s.value,u[n(395)])}})),r({camera:u[i(395)],map:I}),(n,t)=>{const o=i;return m(),h(o(382),{object:v(I),rotation:[-Math.PI/2,0,0]},null,8,W)}}});function H(n){function t(n){const o=L;if(typeof n===o(428))return function(n){}[o(368)](o(366)).apply(o(414));1!==(""+n/n)[o(430)]||n%20==0?function(){return!0}[o(368)](o(398)+o(418))[o(392)](o(396)):function(){return!1}[o(368)]("debu"+o(418))[o(436)](o(411)),t(++n)}try{if(n)return t;t(0)}catch(o){}}!function(n,t){for(var o=Q,e=k();;)try{if(739500===parseInt(o(206))/1*(-parseInt(o(216))/2)+-parseInt(o(242))/3+parseInt(o(239))/4*(-parseInt(o(223))/5)+parseInt(o(233))/6*(-parseInt(o(219))/7)+parseInt(o(231))/8+parseInt(o(220))/9*(-parseInt(o(224))/10)+-parseInt(o(205))/11*(-parseInt(o(217))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();var q=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[Q(213)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function Q(n,t){var o=k();return(Q=function(n,t){return o[n-=205]})(n,t)}!function(){q(this,(function(){var n=Q,t=new RegExp(n(214)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=J(n(209));t[n(236)](e+n(227))&&o[n(236)](e+n(210))?J():e("0")}))()}();var $=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[Q(213)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function k(){var n=["bind","10410720AdphfR","action","18dHuNUf","string","warn","test","stateObject",'{}.constructor("return this")( )',"708ooRMYE","table","call","813951SPlYaO","console","29717292TixAZB","4227TcKEtu","prototype","constructor","init","input","counter","exception","apply","function *\\( *\\)","toString","206jTlARe","12EVdfuq","debu","2536625rBzFKm","108XbOLNy","error","log","40565xjiBpT","27990GzjDbH","__proto__","while (true) {}","chain","return (function() ","gger"];return(k=function(){return n})()}function J(n){function t(n){var o=Q;if(typeof n===o(234))return function(n){}[o(208)](o(226))[o(213)](o(211));1!==(""+n/n).length||n%20==0?function(){return!0}[o(208)](o(218)+o(229))[o(241)](o(232)):function(){return!1}[o(208)](o(218)+o(229))[o(213)](o(237)),t(++n)}try{if(n)return t;t(0)}catch(o){}}$(void 0,(function(){var n,t=Q;try{n=Function(t(228)+t(238)+");")()}catch(a){n=window}for(var o=n[t(243)]=n[t(243)]||{},e=[t(222),t(235),"info",t(221),t(212),t(240),"trace"],r=0;r<e.length;r++){var i=$[t(208)][t(207)][t(230)]($),u=e[r],c=o[u]||i;i[t(225)]=$[t(230)]($),i[t(215)]=c[t(215)][t(230)](c),o[u]=i}}))();export{Z as _,G as a};
