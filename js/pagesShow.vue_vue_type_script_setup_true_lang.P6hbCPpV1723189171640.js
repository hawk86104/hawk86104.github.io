import{a6 as t,cb as n,cc as o,cd as e,ce as r,C as i,k as u,bS as s,ab as c,ad as a}from"./three.5MXJ6W7w1723189171640.js";import{f as l,$ as f,d as p}from"./@tresjs.LTwFwASm1723189171640.js";import{C as d}from"./three-custom-shader-material.XueWmqLp1723189171640.js";import"./object-hash.jMAsrj6h1723189171640.js";import"./@amap.Lu-L8G0q1723189171640.js";import"./glsl-tokenizer.lazMVlew1723189171640.js";import{d as h,b as m,a1 as y,w as g,o as w,D as v,u as b,r as _,a4 as C,e as I,f as x,g as M,J as T,j,aj as O,ak as R,F as S,I as A,G as k,m as B}from"./@vue.Q1VpS3901723189171640.js";function L(t,n){const o=z();return(L=function(t,n){return o[t-=168]})(t,n)}!function(t,n){const o=L,e=z();for(;;)try{if(984652===parseInt(o(177))/1*(-parseInt(o(195))/2)+parseInt(o(205))/3*(parseInt(o(206))/4)+parseInt(o(168))/5+-parseInt(o(172))/6*(parseInt(o(179))/7)+-parseInt(o(196))/8+-parseInt(o(202))/9+parseInt(o(170))/10*(parseInt(o(186))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function z(){const t=["function *\\( *\\)","action","LANDMASS","name","558Nrfhsb","3190152ENvwTb","apply","console","test","trace","return (function() ","17139060gHHMgU","ROADS","traverse","9gHjTFu","377296kmPRZk","warn","toString","exception","9057615VpTKok","init","1029110SmPGUT","bind","1890102ZLhozI","stateObject","counter","debu","input","7045sqKjpm","length","35CKYLbK",'{}.constructor("return this")( )',"string","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__proto__","info","call","506EEvyGl","constructor","chain","CITY_UNTRIANGULATED","prototype"];return(z=function(){return t})()}!function(){E(this,(function(){const t=L,n=new RegExp(t(191)),o=new RegExp(t(182),"i"),e=D(t(169));n[t(199)](e+t(188))&&o[t(199)](e+t(176))?D():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();F(void 0,(function(){const t=L;let n;try{n=Function(t(201)+t(180)+");")()}catch(r){n=window}const o=n[t(198)]=n.console||{},e=["log",t(207),t(184),"error",t(209),"table",t(200)];for(let i=0;i<e[t(178)];i++){const n=F[t(187)][t(190)][t(171)](F),r=e[i],u=o[r]||n;n[t(183)]=F[t(171)](F),n[t(208)]=u[t(208)][t(171)](u),o[r]=n}}))();const H=async()=>{const t=L,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(204)]((n=>{const i=t;n[i(194)]===i(189)&&(o=n),n[i(194)]===i(193)&&(e=n),n[i(194)]===i(203)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function D(t){function n(t){const o=L;if(typeof t===o(181))return function(t){}[o(187)]("while (true) {}")[o(197)](o(174));1!==(""+t/t)[o(178)]||t%20==0?function(){return!0}[o(187)](o(175)+"gger")[o(185)](o(192)):function(){return!1}[o(187)](o(175)+"gger").apply(o(173)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=K;!function(t,n){const o=K,e=Z();for(;;)try{if(678335===parseInt(o(429))/1+-parseInt(o(424))/2+-parseInt(o(427))/3+parseInt(o(420))/4*(-parseInt(o(448))/5)+-parseInt(o(452))/6*(parseInt(o(456))/7)+-parseInt(o(428))/8*(parseInt(o(413))/9)+-parseInt(o(415))/10*(-parseInt(o(416))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(414)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){P(this,(function(){const t=K,n=new RegExp(t(445)),o=new RegExp(t(450),"i"),e=N(t(407));n.test(e+t(435))&&o[t(419)](e+t(438))?N():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["bulidingsColor","chain","uColor","toString","input","forEach","city","model","length","computeBoundingBox","value","function *\\( *\\)","uOpacity","stateObject","2065UmMlvn","landColor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","prototype","7208742aMmXWf","dispose","__proto__","console","7jrghwU","counter","setStyle","color","opacity","clone","uGradient","boundingBox","table","action","warn","object","gradient","side","DoubleSide",'{}.constructor("return this")( )',"init","info","trace","gger","constructor","while (true) {}","189603fjRsVt","apply","1922890iFgLks","286BRnFbc","log","return (function() ","test","12244hlYkcE","buildingsModelCustomShader","uniforms","bind","1164984FoCKya","Color","material","3933594romIro","392dKMRVG","1070444cvKIRx","topColor","debu","renderOrder","computeBoundingSphere"];return(Z=function(){return t})()}W(void 0,(function(){const t=K;let n;try{n=Function(t(418)+t(406)+");")()}catch(r){n=window}const o=n[t(455)]=n[t(455)]||{},e=[t(417),t(401),t(408),"error","exception",t(399),t(409)];for(let i=0;i<e.length;i++){const n=W[t(411)][t(451)][t(423)](W),r=e[i],u=o[r]||n;n[t(454)]=W[t(423)](W),n[t(437)]=u[t(437)].bind(u),o[r]=n}}))();const $=[G(402)];function K(t,n){const o=Z();return(K=function(t,n){return o[t-=394]})(t,n)}const V=h({__name:G(421),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:"#112233"},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=G,e=n,r=m(0),i=e[o(441)][o(440)];i[o(432)]=1001;const u=e[o(441)].land;(()=>{const n=o,{geometry:u}=i;u[n(443)](),u[n(433)]();const{max:s,min:c}=u[n(398)];if(i[n(426)].__csm)return;const a=new d({baseMaterial:i[n(426)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:c},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(425)])(e[n(434)])},uOpacity:{value:e.opacity},uLightColor:{value:new(t[n(425)])("#ffffff")},uTopColor:{value:new(t[n(425)])(e[n(430)])},uTime:r,uGradient:{value:e.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(405)]});i[n(426)][n(453)](),i[n(426)]=a})();const{onLoop:s}=f();s((({delta:t})=>{r[o(444)]+=t})),y((()=>{const n=o;e.bulidingsColor&&i[n(426)].uniforms[n(436)].value[n(458)](e[n(434)]),e[n(449)]&&((n,r)=>{const i=o;let s;"cu"===n||"land"===n&&(s=Array.isArray(u[i(426)])?u[i(426)]:[u[i(426)]],s[i(439)]((n=>{const o=i;n[r][o(458)](e[o(449)]),n[o(404)]=t[o(405)]})))})("land",n(394)),e[n(395)]&&(i[n(426)][n(422)][n(446)][n(444)]=e[n(395)])})),g(e,((t,n)=>{const e=o;i[e(426)][e(422)][e(397)][e(444)]=t[e(403)]}));const c=e[o(441)][o(441)][o(396)]();return(t,n)=>(w(),v("primitive",{object:b(c)},null,8,$))}});function N(t){function n(t){const o=K;if("string"==typeof t)return function(t){}.constructor(o(412))[o(414)](o(457));1!==(""+t/t)[o(442)]||t%20==0?function(){return!0}.constructor(o(431)+o(410)).call(o(400)):function(){return!1}[o(411)](o(431)+o(410))[o(414)](o(447)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const U=J;!function(t,n){const o=J,e=Q();for(;;)try{if(114625===-parseInt(o(157))/1+parseInt(o(155))/2+parseInt(o(133))/3*(-parseInt(o(171))/4)+parseInt(o(132))/5+parseInt(o(131))/6+-parseInt(o(152))/7+-parseInt(o(151))/8*(-parseInt(o(159))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(180)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){q(this,(function(){const t=J,n=new RegExp(t(172)),o=new RegExp(t(127),"i"),e=nt("init");n[t(146)](e+t(167))&&o[t(146)](e+"input")?nt():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(180)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Q(){const t=["opacity","uOpacity","uniforms","innerHeight","return (function() ","__proto__","prototype",'{}.constructor("return this")( )',"geometry","test","info","console","color","string","32VxZeVL","1473829ooCOzy","renderOrder","length","122810vlpDAV","applyMatrix4","116672cffqfs","builds","373383ECwLid"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","stateObject","primitive","width","matrix","warn","Wireframe","chain","value","material","resolution","212yYyFRb","function *\\( *\\)","log","error","constructor","#FFF","toString","clone","bind","apply","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","gger","style","action","buildingsLines","table","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","Shader","linewidth","1028382CUbzvN","784690DYsykN","6444CanHzH","debu","uColor","fromEdgesGeometry"];return(Q=function(){return t})()}Y(void 0,(function(){const t=J;let n;try{n=Function(t(141)+t(144)+");")()}catch(r){n=window}const o=n.console=n[t(148)]||{},e=[t(173),t(165),t(147),t(174),"exception",t(126),"trace"];for(let i=0;i<e.length;i++){const n=Y[t(175)][t(143)][t(179)](Y),r=e[i],u=o[r]||n;n[t(142)]=Y[t(179)](Y),n[t(177)]=u[t(177)][t(179)](u),o[r]=n}}))();const X=["object"];function J(t,n){const o=Q();return(J=function(t,n){return o[t-=125]})(t,n)}const tt=h({__name:U(125),props:{builds:{},width:{default:1},color:{default:U(176)},opacity:{default:1},style:{default:"Wireframe"}},setup(t){const s=U,c=t;let a=null,l=null;if(c[s(183)]===s(166)){const t=new n(c[s(158)][s(145)]);let i=(new o)[s(136)](t),u=new e({color:c.color,linewidth:c[s(163)],opacity:c[s(137)],transparent:!0,depthWrite:!0,depthTest:!0});u[s(170)].set(window.innerWidth,window[s(140)]),a=new r(i,u),a[s(156)](c.builds[s(164)][s(178)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(c[s(149)])},uOpacity:{value:c[s(137)]}},vertexShader:s(181),fragmentShader:s(160)};const t=new n(c[s(158)][s(145)]),o=new u(l);a=new LineSegments(t,o),a[s(156)](c.builds[s(164)][s(178)]()),a[s(169)][s(130)]=c[s(163)],a[s(153)]=1e3}return y((()=>{const t=s;c[t(183)]===t(129)&&(c[t(149)]&&(l[t(139)][t(135)].value=new i(c[t(149)])),c[t(137)]&&(l[t(139)][t(138)][t(168)]=c[t(137)])),c.style===t(166)&&(c[t(149)]&&(a[t(169)][t(149)]=new i(c[t(149)])),c[t(137)]&&(a[t(169)].opacity=c.opacity)),c[t(163)]&&(a.material[t(130)]=c.width)})),(t,n)=>{const o=s;return w(),v(o(162),{object:b(a)},null,8,X)}}});function nt(t){function n(t){const o=J;if(typeof t===o(150))return function(t){}[o(175)]("while (true) {}")[o(180)](o(128));1!==(""+t/t)[o(154)]||t%20==0?function(){return!0}[o(175)](o(134)+o(182)).call(o(184)):function(){return!1}[o(175)](o(134)+"gger")[o(180)](o(161)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=et;function et(t,n){const o=lt();return(et=function(t,n){return o[t-=335]})(t,n)}!function(t,n){const o=et,e=lt();for(;;)try{if(154745===-parseInt(o(351))/1+parseInt(o(347))/2*(-parseInt(o(356))/3)+parseInt(o(365))/4+-parseInt(o(336))/5+parseInt(o(377))/6*(-parseInt(o(368))/7)+-parseInt(o(370))/8+parseInt(o(339))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[et(335)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=et,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(381),"i"),e=pt(t(362));n.test(e+"chain")&&o[t(352)](e+t(376))?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[et(335)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=et,n=function(){const t=et;let n;try{n=Function(t(364)+t(341)+");")()}catch(o){n=window}return n}(),o=n[t(353)]=n[t(353)]||{},e=[t(373),t(358),t(367),t(372),t(337),"table",t(345)];for(let r=0;r<e[t(375)];r++){const n=it.constructor[t(366)].bind(it),i=e[r],u=o[i]||n;n[t(354)]=it.bind(it),n[t(363)]=u[t(363)][t(343)](u),o[i]=n}}))();const ut=T("TresAmbientLight",{color:ot(346)},null,-1),st=T(ot(371),{position:[100,100,0],intensity:.5,color:ot(346)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(){const t=["ability","#000000","TresAxesHelper","init","toString","return (function() ","19140OHzDVN","prototype","info","1029fIEIdi","showGridHelper","1481808kAqaaL","TresDirectionalLight","error","log","string","length","input","8604VqWgQh","autoRotate","constructor","city","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","pagesShow","apply","1242795XMSABQ","exception","showAxesHelper","9118017OKJKSF","gger",'{}.constructor("return this")( )',"tcRef","bind","builds","trace","#ffffff","4IoQtes","perspectiveCameraRef","stateObject","showBuildings","37252qWgHGl","test","console","__proto__","TresPerspectiveCamera","271977yfOsUc","action","warn"];return(lt=function(){return t})()}const ft=h({__name:ot(383),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(360),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:c,toneMapping:a,disableRender:r.disableRender}),u=_({autoRotate:r[n(378)],enableDamping:!0});let l=null;r.showBuildings&&([o,e]=C((()=>H())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,s=I("TresCanvas");return w(),x(s,B({ref_key:e(342),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(355),{ref_key:e(348),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),O(R(u)),null,16),ut,st,r[e(350)]&&b(l)?(w(),v(S,{key:0},[j(V,{model:b(l)},null,8,["model"]),j(tt,{builds:b(l)[e(380)],color:"#000"},null,8,[e(344)])],64)):A("",!0),k(t.$slots,e(359)),r[e(338)]?(w(),v(e(361),ct)):A("",!0),r[e(369)]?(w(),v("TresGridHelper",at)):A("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=et;if(typeof t===o(374))return function(t){}.constructor("while (true) {}")[o(335)]("counter");1!==(""+t/t)[o(375)]||t%20==0?function(){return!0}[o(379)](o(382)+o(340)).call(o(357)):function(){return!1}[o(379)]("debu"+o(340)).apply(o(349)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as _,tt as a,ft as b,H as l};
