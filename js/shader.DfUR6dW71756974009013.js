import{e,m as a,a as s,S as i,b as n}from"./@tresjs.C2b5OFct1756974009013.js";import{P as r}from"./tweakpane.C0HtAJSg1756974009013.js";import{L as o}from"./three-subdivide.B0MjUSTB1756974009013.js";import{d as l,b as t,a2 as d,w as u,G as c,o as m,I as p,a7 as f,a8 as v,aa as g,r as h,h as y,e as M,f as b,j as w,H as T,u as B,m as x}from"./@vue.pEDXJ_3Z1756974009013.js";import{bL as _,aa as j,C as S,V as C,a3 as k,a9 as V,bd as G}from"./three.QlBabAUP1756974009013.js";import"./postprocessing.DuMTjsTx1756974009013.js";import"./@vueuse.BbWOQEYU1756974009013.js";const N=["scale"],z=l({__name:"shineShader",props:{srcMesh:{},scale:{default:1.2},color:{default:"#ffff00"},subdivision:{type:Boolean,default:!0},c:{default:1.1},p:{default:1.4},side:{default:j},blending:{default:_}},setup(s){const i=s,n=t(),r={uniforms:{c:{type:"f",value:i.c},p:{type:"f",value:i.p},glowColor:{type:"c",value:new S(i.color)},viewVector:{type:"v3",value:{x:0,y:0,z:0}}},vertexShader:"\n          uniform vec3 viewVector;\n          uniform float c;\n          uniform float p;\n          varying float intensity;\n          void main() {\n            vec3 vNormal = normalize( normalMatrix * normal);\n            vec3 vNormel = normalize( normalMatrix * viewVector);\n            intensity = pow( c - dot(vNormal, vNormel), p );\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0);\n          }\n            ",fragmentShader:"\n          uniform vec3 glowColor;\n          varying float intensity;\n          void main() \n          {\n          \tvec3 glow = glowColor * intensity;\n\t\t\t\t\t\tif(intensity < 1.0){\n            \tgl_FragColor = vec4( glow, 1.0 );\n\t\t\t\t\t\t}\n          }\n        ",side:i.side,transparent:!0,depthWrite:!1,depthTest:!0,blending:i.blending};d((()=>{if(i.srcMesh&&n.value&&!n.value.geometry.attributes.position){let e=i.srcMesh.geometry.clone();i.subdivision&&(e=o.modify(e,2)),n.value.geometry=e,n.value.position.copy(i.srcMesh.position)}i.color&&(r.uniforms.glowColor.value=new S(i.color)),i.c&&(r.uniforms.c.value=i.c),i.p&&(r.uniforms.p.value=i.p)})),u((()=>i.subdivision),(e=>{let a=i.srcMesh.geometry.clone();e&&(a=o.modify(a,2)),n.value.geometry=a})),u((()=>i.side),(e=>{n.value.material.side=e})),u((()=>i.blending),(e=>{n.value.material.blending=e}));const{onLoop:l}=e(),{camera:g}=a();return l((()=>{g.value&&n.value&&(r.uniforms.viewVector.value=(new C).subVectors(g.value.position,n.value.position))})),(e,a)=>(m(),c("TresMesh",{ref_key:"TSGref",ref:n,scale:i.scale},[p("TresShaderMaterial",f(v(r)),null,16)],8,N))}}),A=["map"],L=["map"],P=l({__name:"shader",async setup(e){let a,o;const l={clearColor:"#222"},d=t(),u=t(),c=t(),f=([a,o]=g((()=>n(["./plugins/earthSample/image/earthA/earth.jpg","logo.png"]))),a=await a,o(),a),v=h({scale:1.6,color:"#00dfff",subdivision:!0,c:1.1,p:1.4,side:j,blending:_}),S=new r({title:"参数",expanded:!0});return S.addBinding(v,"color",{label:"颜色"}),S.addBinding(v,"scale",{label:"大小",min:1,max:3,step:.2}),S.addBinding(v,"subdivision",{label:"边缘处理"}),S.addBinding(v,"c",{label:"c",min:0,max:2,step:.1}),S.addBinding(v,"p",{label:"p",min:0,max:8,step:.2}),S.addBinding(v,"side",{options:{FrontSide:j,BackSide:V,DoubleSide:k}}),S.addBinding(v,"blending",{options:{AdditiveBlending:_,NormalBlending:G}}),(e,a)=>{const n=y("TresCanvas");return m(),M(n,x(l,{"window-size":""}),{default:b((()=>[a[2]||(a[2]=p("TresPerspectiveCamera",{position:[5,5,5]},null,-1)),a[3]||(a[3]=p("TresAmbientLight",{intensity:1},null,-1)),w(B(s)),a[4]||(a[4]=p("TresGridHelper",{args:[10,10]},null,-1)),p("TresMesh",{ref_key:"TresMeshRefA",ref:d,position:[-2,1,0]},[a[0]||(a[0]=p("TresSphereGeometry",{args:[1,32,16]},null,-1)),p("TresMeshBasicMaterial",{map:B(f)[0]},null,8,A)],512),w(z,x({srcMesh:d.value},v),null,16,["srcMesh"]),w(B(i),{ref_key:"TreBoxRef",ref:c,args:[1,1,1],position:[2,1,0]},{default:b((()=>[p("TresMeshBasicMaterial",{map:B(f)[1]},null,8,L)])),_:1},512),c.value&&c.value.instance?(m(),M(z,x({key:0,srcMesh:c.value.instance},v),null,16,["srcMesh"])):T("",!0),p("TresMesh",{ref_key:"TresMeshRefB",ref:u,position:[0,1,-2]},a[1]||(a[1]=[p("TresBoxGeometry",{args:[1,1,1,1,1]},null,-1),p("TresMeshBasicMaterial",{color:"#0ff"},null,-1)]),512),w(z,x({srcMesh:u.value},v),null,16,["srcMesh"])])),_:1},16)}}});export{P as default};
