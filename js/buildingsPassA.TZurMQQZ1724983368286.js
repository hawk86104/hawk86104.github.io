import{b as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.L60cQEOG1724983368286.js";import{bZ as t,a6 as e,bX as o,c7 as r,k as i,j as s,ci as u}from"./three.p-9BQwc31724983368286.js";import{p as a,$ as c}from"./@tresjs.OrqGCbtj1724983368286.js";import{d as l,a1 as p,r as f,o as d,f as m,g as v,j as h,aj as w,ak as x}from"./@vue.Q1VpS3901724983368286.js";import{P}from"./tweakpane.yHWGBmom1724983368286.js";import"./three-custom-shader-material.y6er40ya1724983368286.js";import"./object-hash.X2exW7z_1724983368286.js";import"./@amap.-Bisu7YL1724983368286.js";import"./jszip.VoLYwi951724983368286.js";import"./glsl-tokenizer.EVM27uTn1724983368286.js";import"./glsl-token-string.rzq7L3HM1724983368286.js";import"./glsl-token-functions.DersDqx01724983368286.js";import"./@vueuse.n6I5WvfU1724983368286.js";const g=S;function S(n,t){const e=j();return(S=function(n,t){return e[n-=217]})(n,t)}!function(n,t){const e=S,o=j();for(;;)try{if(149076===parseInt(e(234))/1+-parseInt(e(264))/2*(parseInt(e(242))/3)+parseInt(e(229))/4+parseInt(e(248))/5+-parseInt(e(231))/6+parseInt(e(270))/7+-parseInt(e(253))/8*(parseInt(e(259))/9))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const b=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){b(this,(function(){const n=S,t=new RegExp(n(255)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=_(n(222));t[n(261)](o+n(247))&&e.test(o+"input")?_():o("0")}))()}();const I=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[S(268)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function j(){const n=["function *\\( *\\)","DepthTexture","string","width","448614JNQdIq","uWidth","test","action","material","2DppUUV","depthBuffer","uScaleone","return (function() ","apply","toString","542521KQjmuZ","trace","projectionMatrixInverse","render","bind","set","error","init","info","uScalenum","uniforms","Color","gger","prototype","8116WuGARq","console","372990MrJeWI","length","readBuffer","79060VleJsX","call","table","debu","exception","uPosition","height","depthTexture","441573rIJDmL","constructor","#FFF","color","addPass","chain","1248430RYqmZo","time","log","while (true) {}","counter","8sCLRGM","value"];return(j=function(){return n})()}I(void 0,(function(){const n=S;let t;try{t=Function(n(267)+'{}.constructor("return this")( ));')()}catch(r){t=window}const e=t[n(230)]=t[n(230)]||{},o=[n(250),"warn",n(223),n(221),n(238),n(236),n(271)];for(let i=0;i<o.length;i++){const t=I[n(243)][n(228)][n(219)](I),r=o[i],s=e[r]||t;t.__proto__=I[n(219)](I),t.toString=s[n(269)][n(219)](s),e[r]=t}}))();const y=l({__name:"buildingsPassA",props:{color:{default:g(244)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(n){const l=n,{renderer:f,scene:d,camera:m,sizes:v}=a();let h,w=0,x=null,P=null;p((()=>{const n=S;v[n(258)].value&&(h=v[n(258)][n(254)],w=v[n(240)].value,(()=>{const n=S;x=new t(f[n(254)]);const a=new(e[n(256)])(h,w);x.readBuffer[n(265)]=!0,x[n(233)][n(241)]=a;const c=new o(d[n(254)],m[n(254)]);x.addPass(c),P=new r(new i({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:a},uProjectionInverse:{value:m[n(254)][n(217)]},uMatrixWorld:{value:m.value.matrixWorld},uColor:{value:new(e[n(226)])(l[n(245)])},uScalenum:{value:l[n(224)]},uScaleone:{value:l[n(266)]},uWidth:{value:l[n(260)]},uPosition:{value:new s(l[n(239)].x,l[n(239)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),x[n(246)](P);const p=new r(u);x[n(246)](p)})())}));const{onLoop:g}=c();return g((({elapsed:n})=>{const t=S;x&&(x[t(218)](),P[t(225)][t(249)][t(254)]+=l.speed/60)})),p((()=>{const n=S;P&&(l[n(245)]&&(P.material[n(225)].uColor.value=new(e[n(226)])(l[n(245)])),l[n(224)]&&(P.material.uniforms[n(224)].value=l.uScalenum),l[n(266)]&&(P[n(263)][n(225)][n(266)][n(254)]=l[n(266)]),l[n(260)]&&(P[n(263)].uniforms[n(260)].value=l[n(260)]),l.uPosition&&P[n(263)].uniforms[n(239)][n(254)][n(220)](l[n(239)].x,l.uPosition.y))})),(n,t)=>null}});function _(n){function t(n){const e=S;if(typeof n===e(257))return function(n){}[e(243)](e(251))[e(268)](e(252));1!==(""+n/n)[e(232)]||n%20==0?function(){return!0}[e(243)](e(237)+"gger")[e(235)](e(262)):function(){return!1}.constructor(e(237)+e(227))[e(268)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(e){}}function W(n,t){const e=k();return(W=function(n,t){return e[n-=404]})(n,t)}const z=W;!function(n,t){const e=W,o=k();for(;;)try{if(808755===parseInt(e(455))/1+parseInt(e(439))/2*(-parseInt(e(411))/3)+parseInt(e(419))/4+-parseInt(e(431))/5*(-parseInt(e(446))/6)+parseInt(e(413))/7+-parseInt(e(436))/8*(-parseInt(e(415))/9)+parseInt(e(406))/10*(-parseInt(e(408))/11))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const D=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[W(453)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){D(this,(function(){const n=W,t=new RegExp(n(449)),e=new RegExp(n(435),"i"),o=U("init");t[n(420)](o+n(429))&&e[n(420)](o+n(454))?U():o("0")}))()}();const M=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[W(453)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function k(){const n=["debu","uScaleone","uScalenum","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","5116344XzaJzr","prototype","stateObject","722474aMxKiU","inline","console","单条圈宽度","exception","addBinding","uWidth","6wIIujM","length","call","function *\\( *\\)","color","gger","action","apply","input","643791tJQkLn","table","counter","3577810rwMmsM","__proto__","110PYwTid","圈颜色","info","3wxIwuQ",'{}.constructor("return this")( )',"7387933HpNeSn","trace","9scSlYu","toString","uPosition","buildingsPassA","4293224XGJSxU","test","后期效果","最大范围","while (true) {}","error","bind","return (function() ","speed","constructor","chain","string","6678715sSABba"];return(k=function(){return n})()}M(void 0,(function(){const n=W;let t;try{t=Function(n(426)+n(412)+");")()}catch(r){t=window}const e=t[n(441)]=t[n(441)]||{},o=["log","warn",n(410),n(424),n(443),n(404),n(414)];for(let i=0;i<o[n(447)];i++){const t=M[n(428)][n(437)][n(425)](M),r=o[i],s=e[r]||t;t[n(407)]=M[n(425)](M),t[n(416)]=s[n(416)].bind(s),e[r]=t}}))();const F=l({__name:z(418),setup(t){const e=z,o=f({color:"#00b4fb",uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new P({title:e(421),expanded:!0});return r[e(444)](o,e(450),{label:e(409)}),r[e(444)](o,e(434),{label:e(422),min:1,max:500,step:10}),r.addBinding(o,e(433),{label:"单条圈间距",min:1,max:100,step:1}),r.addBinding(o,e(445),{label:e(442),min:0,max:1,step:.01}),r.addBinding(o,e(427),{label:"速度",min:1,max:20,step:1}),r.addBinding(o,e(417),{picker:e(440),label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(t,e)=>(d(),m(n,{disableRender:!0,showAxesHelper:!1},{ability:v((()=>[h(y,w(x(o)),null,16)])),_:1}))}});function U(n){function t(n){const e=W;if(typeof n===e(430))return function(n){}.constructor(e(423))[e(453)](e(405));1!==(""+n/n)[e(447)]||n%20==0?function(){return!0}.constructor(e(432)+e(451))[e(448)](e(452)):function(){return!1}.constructor("debu"+e(451))[e(453)](e(438)),t(++n)}try{if(n)return t;t(0)}catch(e){}}export{F as default};
