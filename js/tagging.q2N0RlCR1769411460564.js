import{importShared as e}from"./3d-tiles-renderer.HXNTGnH81769411460564.js";import{useTresContext as t,OrbitControls_default as n}from"./index.KfH1904l1769411460564.js";import{FontLoader as o}from"./FontLoader.CRKHtP1l1769411460564.js";const{ExtrudeGeometry:r}=await e("three");class a extends r{constructor(e,t={}){const n=t.font;if(void 0===n)super();else{const o=n.generateShapes(e,t.size);void 0===t.depth&&(t.depth=50),void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(o,t)}this.type="TextGeometry"}}const{withAsyncContext:s,defineComponent:i}=await e("vue"),{createElementVNode:l,Fragment:c,openBlock:u,createElementBlock:d}=await e("vue"),{ref:w}=await e("vue"),m=await e("three"),p=i({__name:"tagging",async setup(e){let n,r;const{scene:i}=t(),p=w(),h=w();let v=null;const y=([n,r]=s(()=>{return e="https://opensource.cdn.icegl.cn/fonts/FZLanTingHeiS-UL-GB_Regular.json",new Promise((t,n)=>{(new o).load(e,e=>t(e),void 0,e=>n(e))});var e}),n=await n,r(),n),f=function(e,t,n){const o=(new m.Vector3).addVectors(e,t).multiplyScalar(.5),r=(new m.Vector3).subVectors(t,e).normalize(),s=((e,t,n)=>{const o=new m.Group,r=(new m.BufferGeometry).setFromPoints([e,t]),a=new m.Line(r,new m.LineBasicMaterial({color:"green"})),s=new m.ConeGeometry(1,3,8),i=new m.MeshBasicMaterial({color:"green"}),l=new m.Mesh(s,i);l.type="Raycone",l.position.copy(e);const c=new m.Mesh(s,i);c.type="Raycone",c.position.copy(t);const u=new m.Vector3(1,0,0),d=new m.Vector3(0,1,0),w=new m.Vector3(0,0,1);return n.equals(u)?(l.rotation.set(0,0,Math.PI/2),c.rotation.set(0,0,-Math.PI/2)):n.equals(d)?l.rotation.set(0,0,Math.PI):n.equals(w)&&(l.rotation.set(-Math.PI/2,0,0),c.rotation.set(Math.PI/2,0,0)),o.add(a),o.add(l),o.add(c),o})(e,t,r);i.value.add(s);const l=((e,t,n)=>{const o=new a(e,{font:y,size:3,depth:1,height:.2,curveSegments:12,bevelEnabled:!1}),r=new m.MeshBasicMaterial({color:65280}),s=new m.Mesh(o,r);s.position.copy(t);const i=new m.Vector3(1,0,0),l=new m.Vector3(-1,0,0),c=new m.Vector3(0,1,0),u=new m.Vector3(0,-1,0),d=new m.Vector3(0,0,1),w=new m.Vector3(0,0,-1);return n.equals(i)||n.equals(l)||(n.equals(c)||n.equals(u)?s.rotation.set(0,0,Math.PI/2):(n.equals(d)||n.equals(w))&&s.rotation.set(0,Math.PI/2,0)),s})(n,o,r);i.value.add(l)},x=function(e){const{size:t,boxCenter:n}=function(e){v=(new m.Box3).setFromObject(e);const t=new m.Vector3;v.getSize(t);const n=new m.Vector3;return v.getCenter(n),{size:t,boxCenter:n}}(e);!function(e,t){const n=new m.BoxGeometry(e.x,e.y,e.z),o=new m.EdgesGeometry(n),r=new m.LineBasicMaterial({color:"red"}),a=new m.LineSegments(o,r);a.position.copy(t),i.value.add(a)}(t,n);const o=v.min,r=v.max,a=Number(t.z.toFixed(2))+10,s=Number(t.z.toFixed(2))+16;f(new m.Vector3(o.x,o.y,o.z+a),new m.Vector3(r.x,o.y,o.z+a),`长: ${t.x.toFixed(2)}`),f(new m.Vector3(o.x,o.y,o.z+s),new m.Vector3(o.x,r.y,o.z+s),`高: ${t.y.toFixed(2)}`),f(new m.Vector3(o.x-10,o.y,o.z),new m.Vector3(o.x-10,o.y,r.z),`宽: ${t.z.toFixed(2)}`)};return(e,t)=>(u(),d(c,null,[l("TresMesh",{ref_key:"torusref",ref:p,position:[-100,0,0],onClick:t[0]||(t[0]=e=>x(p.value))},[...t[2]||(t[2]=[l("TresTorusGeometry",{args:[50,5,128,128]},null,-1),l("TresMeshBasicMaterial",{color:"orange"},null,-1)])],512),l("TresMesh",{ref_key:"boxref",ref:h,position:[100,0,0],onClick:t[1]||(t[1]=e=>x(h.value))},[...t[3]||(t[3]=[l("TresBoxGeometry",{args:[80,100,20]},null,-1),l("TresMeshNormalMaterial",null,null,-1)])],512)],64))}}),{defineComponent:h}=await e("vue"),{createElementVNode:v,unref:y,normalizeProps:f,guardReactiveProps:x,createVNode:g,Suspense:V,withCtx:b,openBlock:M,createBlock:z,resolveComponent:B,mergeProps:C}=await e("vue"),{reactive:P}=await e("vue"),T=h({__name:"tagging",setup(e){const t=P({windowSize:!0,alpha:!0,antialias:!0}),o=P({enableDamping:!0,enableZoom:!0,enablePan:!0,enableRotate:!0,makeDefault:!0});return(e,r)=>{const a=B("TresCanvas");return M(),z(a,C({clearColor:"#201919"},t),{default:b(()=>[r[0]||(r[0]=v("TresPerspectiveCamera",{fov:60,near:.1,far:2e3,position:[0,0,200],"look-at":[0,0,0]},null,-1)),r[1]||(r[1]=v("TresAmbientLight",{intensity:2},null,-1)),g(y(n),f(x(o)),null,16),(M(),z(V,null,{default:b(()=>[g(p)]),_:1}))]),_:1},16)}}});export{T as default};
