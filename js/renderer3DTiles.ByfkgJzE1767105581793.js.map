{"version":3,"file":"renderer3DTiles.ByfkgJzE1767105581793.js","sources":["../../src/plugins/simpleGIS/components/tilesMesh.vue","../../src/plugins/simpleGIS/pages/renderer3DTiles.vue"],"sourcesContent":["<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-27 10:02:33\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-29 12:32:32\n-->\n<template>\n    <TresGroup>\n        <primitive :object=\"tiles.group\" />\n    </TresGroup>\n</template>\n\n<script lang=\"ts\" setup>\nimport { useTres, useLoop } from '@tresjs/core'\nimport { watchEffect } from 'vue'\nimport { TilesRenderer } from '3d-tiles-renderer'\nimport * as THREE from 'three'\n\nconst tiles = new TilesRenderer(\n    `${\n        process.env.NODE_ENV === 'development' ? 'resource.cos' : 'https://opensource.cdn.icegl.cn'\n    }/3Dtiles/simpleGIS/data/tileset.json`,\n)\ntiles.errorTarget = 0\nconst onLoadModel = ({ scene }) => {\n    scene.traverse((c) => {\n        if (c.isMesh) {\n            c.material.side = 2\n            c.receiveShadow = false\n            c.castShadow = false\n        }\n    })\n    // 对齐 tiles center\n    const box = new THREE.Box3()\n    const sphere = new THREE.Sphere()\n    if (tiles.getBoundingBox(box)) {\n        box.getCenter(tiles.group.position)\n        tiles.group.position.multiplyScalar(-1)\n    } else if (tiles.getBoundingSphere(sphere)) {\n        tiles.group.position.copy(sphere.center)\n        tiles.group.position.multiplyScalar(-1)\n    }\n}\n\ntiles.addEventListener('load-model', onLoadModel)\n// tiles.onLoadModel = onLoadModel\n\nconst { camera, renderer, sizes } = useTres()\nwatchEffect(() => {\n    if (sizes.width.value) {\n        tiles.setCamera(camera.value)\n        tiles.setResolutionFromRenderer(camera.value, renderer)\n    }\n})\n\nconst { onBeforeRender } = useLoop()\nonBeforeRender(() => {\n    if (camera.value && sizes.width.value) {\n        camera.value.updateMatrixWorld()\n        tiles.update()\n    }\n})\n</script>\n","<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-27 11:36:30\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-29 12:31:57\n-->\n\n<template>\n\t<TresCanvas v-bind=\"state\" window-size>\n\t\t<TresPerspectiveCamera :position=\"[400, 400, 400]\" :fov=\"60\" :near=\"0.1\" :far=\"4000\" />\n\t\t<OrbitControls v-bind=\"controlsState\" />\n\n\t\t<TresAmbientLight :intensity=\"0.5\" />\n\t\t<TresDirectionalLight ref=\"TDirectionalLight\" :position=\"[1, 2, 3]\" :intensity=\"1.25\" />\n\t\t<tilesMesh />\n\t\t<TresAxesHelper :args=\"[100]\" />\n\t</TresCanvas>\n</template>\n\n\n<script setup lang=\"ts\">\nimport { reactive, watchEffect, shallowRef } from 'vue'\nimport { OrbitControls } from '@tresjs/cientos'\nimport tilesMesh from '../components/tilesMesh.vue'\n\nconst state = reactive({\n\tclearColor: '#201919',\n\t// alpha: false,\n})\n\nconst controlsState = reactive({\n\tenableDamping: true,\n\tdampingFactor: 0.05,\n})\n\nconst TDirectionalLight = shallowRef()\nwatchEffect(() => {\n\tif (TDirectionalLight.value) {\n\t\tTDirectionalLight.value.position.set(1, 2, 3).multiplyScalar(40)\n\n\t\t// TDirectionalLight.value.shadow.bias = - 0.01\n\t\t// TDirectionalLight.value.shadow.mapSize.setScalar(2048)\n\n\t\t// TDirectionalLight.value.shadow.camera.top = 200\n\t\t// TDirectionalLight.value.shadow.camera.right = 200\n\t\t// TDirectionalLight.value.shadow.camera.left = -200\n\t\t// TDirectionalLight.value.shadow.camera.bottom = -200\n\n\t\t// TDirectionalLight.value.shadow.camera.updateProjectionMatrix()\n\t}\n})\n\n</script>"],"names":["watchEffect","TilesRenderer","useTres","useLoop","_createElementVNode","_unref","tilesMesh"],"mappings":"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"}