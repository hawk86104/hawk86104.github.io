import{_ as e,F as t}from"./@tresjs.BCHtwiaC1763540743861.js";import{l as i}from"./iconify-icon.1JyQPtAK1763540743861.js";import{i as o,a as s,r as a}from"./@iconify.DDuAktjw1763540743861.js";import{C as r}from"./canvg.6M0Q0v7H1763540743861.js";import{d as n,a as l,a9 as c,H as u,o as f,J as p,u as v}from"./@vue.Co_gxueH1763540743861.js";import{cU as d,h as m,V as h,ae as b}from"./three.rXKzP9fQ1763540743861.js";const w=["map","side"],x=n({__name:"iconText",props:{showName:{default:"店铺名称"},icon:{default:""},iconColor:{default:"#ffffff"}},setup(n){const x=n,j=document.createElement("canvas");j.width=400,j.height=100;const y=j.getContext("2d");y.fillStyle="#00000000",y.fillRect(0,0,j.width,j.height);const T=new d(j);y.font="bold 48px Arial",y.fillStyle="#fff",y.textAlign="left",y.textBaseline="middle",y.fillText(x.showName,20+(x.icon?100:0),50),y.strokeStyle=x.iconColor,y.lineWidth=2,y.strokeText(x.showName,20+(x.icon?100:0),50),y.restore();const g=l(),{onBeforeRender:S}=e(),{camera:C}=t();let _=!1;const k=l(new m);return S(()=>{if(g.value&&C.value&&g.value.parent?.visible){_||(_=!0,x.icon&&i(x.icon).then(async e=>{const t=o(e,{width:"100px",height:"100px"}),i={...t.attributes,color:x.iconColor},n=s(a(t.body),i);await r.fromString(y,n).render(),T.needsUpdate=!0}));const e=new h;e.setFromMatrixPosition(g.value.matrixWorld);const t=e.distanceTo(C.value.position);g.value.scale.set(4*t/30,t/30,1),g.value.visible=!0;const n=new h;g.value.getWorldPosition(n);const l=(new h).subVectors(n,C.value.position).normalize();k.value.camera=C.value,k.value.set(C.value.position,l);const u=k.value.intersectObject(c(g.value)?.parent?.parent);for(let i=0;i<u.length;i++)if("itSprite"===u[i].object.iconType&&u[i].object.visible&&u[i].object.uuid!==g.value.uuid){g.value.visible=!1;break}t<=15&&g.value.visible?g.value.visible=!0:g.value.visible=!1}}),(e,t)=>(f(),u("TresGroup",null,[p("TresSprite",{position:[0,0,0],renderOrder:999,center:[.1,.1],ref_key:"spriteRef",ref:g,iconType:"itSprite"},[p("TresSpriteMaterial",{map:v(T),transparent:"",side:b,depthTest:!1},null,8,w)],512)]))}});export{x as _};
