import{a6 as t,C as n,ca as o,cb as e,cc as r,cd as i,k as u,bS as c,ab as s,ad as a}from"./three.0bBjBDi41721298764655.js";import{f as l,$ as f,d as p}from"./@tresjs.iXEJQd7J1721298764655.js";import{C as d}from"./three-custom-shader-material.wt6if9qU1721298764655.js";import"./object-hash.eR6rYsIK1721298764655.js";import"./@amap.x_Go35DX1721298764655.js";import"./glsl-tokenizer.ZFLos1PC1721298764655.js";import{d as h,b as y,a1 as m,w as g,o as w,D as b,u as v,r as _,a4 as C,e as I,f as x,g as M,J as T,j as S,aj as j,ak as O,F as R,I as A,G as D,m as B}from"./@vue.Q1VpS3901721298764655.js";!function(t,n){const o=L,e=H();for(;;)try{if(314005===parseInt(o(512))/1*(parseInt(o(511))/2)+-parseInt(o(507))/3*(parseInt(o(481))/4)+-parseInt(o(491))/5+-parseInt(o(478))/6*(-parseInt(o(499))/7)+-parseInt(o(501))/8*(-parseInt(o(504))/9)+-parseInt(o(485))/10+parseInt(o(472))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(509)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=L,n=new RegExp(t(475)),o=new RegExp(t(473),"i"),e=F(t(470));n[t(497)](e+"chain")&&o[t(497)](e+t(483))?F():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(509)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(486)+t(492)+");")()}catch(o){n=window}return n}(),o=n[t(477)]=n[t(477)]||{},e=[t(489),"warn",t(482),"error",t(493),t(510),t(494)];for(let r=0;r<e.length;r++){const n=z[t(471)][t(502)][t(479)](z),i=e[r],u=o[i]||n;n[t(506)]=z[t(479)](z),n[t(503)]=u.toString.bind(u),o[i]=n}}))();const E=async()=>{const t=L,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(495)]((n=>{const i=t;n.name===i(488)&&(o=n),n[i(474)]===i(500)&&(e=n),n[i(474)]===i(476)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function L(t,n){const o=H();return(L=function(t,n){return o[t-=470]})(t,n)}function H(){const t=["10024EdbVNV","prototype","toString","2628DOcMvw","counter","__proto__","1855101dnOjll","length","apply","table","260444RgkDBS","1cHnCke","init","constructor","10098165HbMHrv","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","name","function *\\( *\\)","ROADS","console","24cUHjwY","bind","string","4zmkavF","info","input","stateObject","5343380ELFPtP","return (function() ","call","CITY_UNTRIANGULATED","log","debu","1198375CDyUzL",'{}.constructor("return this")( )',"exception","trace","traverse","while (true) {}","test","gger","511476QpUbyu","LANDMASS"];return(H=function(){return t})()}function F(t){function n(t){const o=L;if(typeof t===o(480))return function(t){}[o(471)](o(496))[o(509)](o(505));1!==(""+t/t)[o(508)]||t%20==0?function(){return!0}[o(471)](o(490)+o(498))[o(487)]("action"):function(){return!1}[o(471)](o(490)+o(498))[o(509)](o(484)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=$;!function(t,n){const o=$,e=Z();for(;;)try{if(618319===parseInt(o(388))/1*(parseInt(o(417))/2)+parseInt(o(420))/3*(parseInt(o(404))/4)+-parseInt(o(414))/5+parseInt(o(362))/6+-parseInt(o(407))/7*(parseInt(o(363))/8)+parseInt(o(369))/9*(-parseInt(o(387))/10)+parseInt(o(421))/11*(parseInt(o(419))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(394)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["862952xnDTkZ","init","while (true) {}","stateObject","material","forEach","9EahUwK","DoubleSide","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","__proto__","primitive","side","action","console","bulidingsColor","exception","input","gger",'{}.constructor("return this")( )',"bind","prototype","function *\\( *\\)","uColor","4304320ealgJG","1613MAyxnl","string","#112233","model","__csm","info","apply","topColor","test","constructor","opacity","setStyle","chain","landColor","log","buildingsModelCustomShader","8xobYLf","warn","toString","49VcUGDz","land","boundingBox","color","Color","renderOrder","clone","4135635JgdlYa","length","uniforms","820JttRJd","isArray","3038016IebBNB","1806276ypbbvC","22ZXsEah","counter","#ffff00","value","1554666EBbLFD"];return(Z=function(){return t})()}!function(){P(this,(function(){const t=$,n=new RegExp(t(385)),o=new RegExp(t(371),"i"),e=J(t(364));n[t(396)](e+t(400))&&o[t(396)](e+t(380))?J():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(394)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(t,n){const o=Z();return($=function(t,n){return o[t-=361]})(t,n)}W(void 0,(function(){const t=$,n=function(){const t=$;let n;try{n=Function("return (function() "+t(382)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(377)]||{},e=[t(402),t(405),t(393),"error",t(379),"table","trace"];for(let r=0;r<e[t(415)];r++){const n=W[t(397)][t(384)][t(383)](W),i=e[r],u=o[i]||n;n[t(373)]=W[t(383)](W),n.toString=u[t(406)][t(383)](u),o[i]=n}}))();const U=["object"],V=h({__name:G(403),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:G(390)},topColor:{default:G(423)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=G,r=o,i=y(0),u=r[e(391)].city;u[e(412)]=1001;const c=r.model[e(408)];(()=>{const o=e,{geometry:c}=u;c.computeBoundingBox(),c.computeBoundingSphere();const{max:s,min:a}=c[o(409)];if(u.material[o(392)])return;const l=new d({baseMaterial:u[o(367)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(411)])(r[o(378)])},uOpacity:{value:r[o(398)]},uLightColor:{value:new n("#ffffff")},uTopColor:{value:new n(r[o(395)])},uTime:i,uGradient:{value:r.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(370)]});u[o(367)].dispose(),u[o(367)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(361)]+=t})),m((()=>{const n=e;r[n(378)]&&u[n(367)][n(416)][n(386)][n(361)][n(399)](r.bulidingsColor),r.landColor&&((n,o)=>{const i=e;let u;"cu"===n||n===i(408)&&(u=Array[i(418)](c[i(367)])?c[i(367)]:[c[i(367)]],u[i(368)]((n=>{const e=i;n[o][e(399)](r[e(401)]),n[e(375)]=t[e(370)]})))})("land",n(410)),r[n(398)]&&(u[n(367)][n(416)].uOpacity[n(361)]=r.opacity)})),g(r,((t,n)=>{const o=e;u[o(367)][o(416)].uGradient[o(361)]=t.gradient}));const a=r[e(391)][e(391)][e(413)]();return(t,n)=>{const o=e;return w(),b(o(374),{object:v(a)},null,8,U)}}});function J(t){function n(t){const o=$;if(typeof t===o(389))return function(t){}.constructor(o(365))[o(394)](o(422));1!==(""+t/t)[o(415)]||t%20==0?function(){return!0}[o(397)](o(372)+o(381)).call(o(376)):function(){return!1}.constructor("debu"+o(381)).apply(o(366)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Y=Q;function q(){const t=['{}.constructor("return this")( )',"1774059gWfiCl","stateObject","geometry","2OpGZXU","debu","function *\\( *\\)","counter","Shader","249616qKqqSu","buildingsLines","material","set","linewidth","trace","renderOrder","string","663751qRkTnY","255JVTdia","exception","Wireframe","return (function() ","clone","toString","innerHeight","chain","3601854RbuozA","width","uColor"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","while (true) {}","#FFF","130LzTxpy","fromEdgesGeometry","length","action","object","opacity","uniforms","16ExedfT","prototype","info","bind","resolution","uOpacity","init","style","primitive","constructor","test","warn","builds","gger","input","matrix","value","innerWidth","applyMatrix4","log","apply","30124Kbhkyx","6881802CwqqhK","color","table","738gldCHr"];return(q=function(){return t})()}!function(t,n){const o=Q,e=q();for(;;)try{if(635671===parseInt(o(468))/1*(-parseInt(o(463))/2)+-parseInt(o(523))/3+parseInt(o(519))/4*(-parseInt(o(477))/5)+parseInt(o(520))/6+-parseInt(o(525))/7*(-parseInt(o(498))/8)+parseInt(o(485))/9+-parseInt(o(491))/10*(parseInt(o(476))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const N=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){N(this,(function(){const t=Q,n=new RegExp(t(465)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=nt(t(504));n[t(508)](e+t(484))&&o[t(508)](e+t(512))?nt():e("0")}))()}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(518)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Q(t,n){const o=q();return(Q=function(t,n){return o[t-=463]})(t,n)}K(void 0,(function(){const t=Q;let n;try{n=Function(t(480)+t(524)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(517),t(509),t(500),"error",t(478),t(522),t(473)];for(let i=0;i<e[t(493)];i++){const n=K[t(507)][t(499)][t(501)](K),r=e[i],u=o[r]||n;n.__proto__=K[t(501)](K),n[t(482)]=u[t(482)].bind(u),o[r]=n}}))();const X=[Y(495)],tt=h({__name:Y(469),props:{builds:{},width:{default:1},color:{default:Y(490)},opacity:{default:1},style:{default:Y(479)}},setup(t){const c=Y,s=t;let a=null,l=null;if(s.style===c(479)){const t=new o(s.builds[c(527)]);let n=(new e)[c(492)](t),u=new r({color:s[c(521)],linewidth:s[c(486)],opacity:s[c(496)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(502)][c(471)](window[c(515)],window[c(483)]),a=new i(n,u),a[c(516)](s[c(510)][c(513)][c(481)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(521)])},uOpacity:{value:s[c(496)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(488)};const t=new o(s[c(510)][c(527)]),e=new u(l);a=new LineSegments(t,e),a.applyMatrix4(s[c(510)].matrix[c(481)]()),a[c(470)][c(472)]=s[c(486)],a[c(474)]=1e3}return m((()=>{const t=c;s[t(505)]===t(467)&&(s[t(521)]&&(l[t(497)][t(487)][t(514)]=new n(s[t(521)])),s[t(496)]&&(l[t(497)][t(503)][t(514)]=s[t(496)])),s[t(505)]===t(479)&&(s.color&&(a.material.color=new n(s[t(521)])),s.opacity&&(a[t(470)][t(496)]=s.opacity)),s.width&&(a[t(470)][t(472)]=s[t(486)])})),(t,n)=>{const o=c;return w(),b(o(506),{object:v(a)},null,8,X)}}});function nt(t){function n(t){const o=Q;if(typeof t===o(475))return function(t){}[o(507)](o(489)).apply(o(466));1!==(""+t/t)[o(493)]||t%20==0?function(){return!0}[o(507)](o(464)+o(511)).call(o(494)):function(){return!1}[o(507)](o(464)+"gger").apply(o(526)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=it;!function(t,n){const o=it,e=pt();for(;;)try{if(812100===-parseInt(o(317))/1+parseInt(o(295))/2+parseInt(o(296))/3*(parseInt(o(273))/4)+-parseInt(o(303))/5*(-parseInt(o(310))/6)+parseInt(o(316))/7*(parseInt(o(274))/8)+-parseInt(o(272))/9*(-parseInt(o(312))/10)+-parseInt(o(290))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(323)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=it,n=new RegExp(t(307)),o=new RegExp(t(278),"i"),e=ft("init");n[t(304)](e+t(302))&&o.test(e+t(326))?ft():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(323)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(t,n){const o=pt();return(it=function(t,n){return o[t-=270]})(t,n)}rt(void 0,(function(){const t=it,n=function(){const t=it;let n;try{n=Function(t(289)+t(276)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(293)]||{},e=[t(308),t(311),t(314),t(277),t(319),t(270),"trace"];for(let r=0;r<e.length;r++){const n=rt.constructor[t(294)][t(313)](rt),i=e[r],u=o[i]||n;n[t(285)]=rt.bind(rt),n[t(301)]=u[t(301)].bind(u),o[i]=n}}))();const ut=T(ot(287),{color:ot(291)},null,-1),ct=T(ot(325),{position:[100,100,0],intensity:.5,color:ot(291)},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]},lt=h({__name:ot(300),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(306),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(297)]}),u=_({autoRotate:r[n(292)],enableDamping:!0});let l=null;r[n(279)]&&([o,e]=C((()=>E())),o=await o,e(),l=o);const f=y(),d=y();return(t,o)=>{const e=n,c=I(e(305));return w(),x(c,B({ref_key:"tcRef",ref:d},i,{"window-size":""}),{default:M((()=>[T(e(275),{ref_key:e(322),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(v(p),j(O(u)),null,16),ut,ct,r[e(279)]&&v(l)?(w(),b(R,{key:0},[S(V,{model:v(l)},null,8,["model"]),S(tt,{builds:v(l)[e(280)],color:e(298)},null,8,["builds"])],64)):A("",!0),D(t[e(324)],e(284)),r[e(271)]?(w(),b("TresAxesHelper",st)):A("",!0),r[e(282)]?(w(),b(e(286),at)):A("",!0)])),_:3},16)}}});function ft(t){function n(t){const o=it;if(typeof t===o(320))return function(t){}[o(318)]("while (true) {}")[o(323)](o(281));1!==(""+t/t)[o(315)]||t%20==0?function(){return!0}[o(318)]("debu"+o(288))[o(321)](o(309)):function(){return!1}[o(318)](o(299)+"gger")[o(323)](o(283)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function pt(){const t=["console","prototype","1553368dSsYRA","84vMQfrw","disableRender","#000","debu","pagesShow","toString","chain","15RctiDn","test","TresCanvas","#000000","function *\\( *\\)","log","action","2842158huWJuh","warn","242490DCwlvS","bind","info","length","50407pWspVV","1606484ElQFoY","constructor","exception","string","call","perspectiveCameraRef","apply","$slots","TresDirectionalLight","input","table","showAxesHelper","171DzrGMh","87844jDOkzL","1240IVobrU","TresPerspectiveCamera",'{}.constructor("return this")( )',"error","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","showBuildings","city","counter","showGridHelper","stateObject","ability","__proto__","TresGridHelper","TresAmbientLight","gger","return (function() ","21680703cSHclw","#ffffff","autoRotate"];return(pt=function(){return t})()}export{V as _,tt as a,lt as b,E as l};
