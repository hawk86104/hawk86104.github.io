import"./index.T-vY6kZg1743660816268.js";import{D as e,e as a,m as t,r as o}from"./@tresjs.zc7faK4J1743660816268.js";import{J as r,aW as n,Y as s,B as i,c as l,l as u,n as c,d as m,C as p,a$ as v,u as d,aY as f,ar as x,c5 as g,_ as h,O as w,c6 as y,c7 as P,c8 as j,V as b,r as M,c9 as _}from"./three.2wx8FU0g1743660816268.js";import{P as z}from"./tweakpane.ivGeiIdz1743660816268.js";import{l as S}from"./util.9Mf3e0Eu1743660816268.js";import{d as T,o as A,H as B,u as C,b as F,a4 as D,f as U,a2 as L,r as R,e as k,j as V,g as Y,aj as I,ak as O,N as W,F as q,al as J}from"./@vue.B5PFBfKs1743660816268.js";import{l as N}from"./bubbleLoading.rC3bW8Z-1743660816268.js";import{_ as X}from"./@fesjs.9AUNBPBQ1743660816268.js";import"./utils.J8F9Jo-01743660816268.js";import"./three-mesh-ui.module._G62nyeC1743660816268.js";import"./postprocessing.ApTwx-211743660816268.js";import"./@vueuse.jtbb8I7w1743660816268.js";import"./vue-router.K4ys0Z-O1743660816268.js";import"./lodash-es.IJc9G_SW1743660816268.js";import"./@qlin.o0hjOMCg1743660816268.js";import"./pinia.0dYyFDku1743660816268.js";import"./@floating-ui.HzHndBae1743660816268.js";import"./@juggle.4EyLec-41743660816268.js";const G=e=>{let a=e.attributes.position.count,t=Math.ceil(Math.sqrt(a)),o=Math.ceil(a/t),i=new Float32Array(t*o*4);!function(e){for(let a=Math.floor(e.length/3)-1;a>0;a--){const t=Math.floor(Math.random()*(a+1));for(let o=0;o<3;o++){let r=e[3*a+o];e[3*a+o]=e[3*t+o],e[3*t+o]=r}}}(e.attributes.position.array);for(let r=0;r<a;r++){const a=e.attributes.position.array[3*r+0],t=e.attributes.position.array[3*r+1],o=e.attributes.position.array[3*r+2],n=0;i[4*r+0]=a,i[4*r+1]=t,i[4*r+2]=o,i[4*r+3]=n}let l=new r(i,t,o,n,s);return l.needsUpdate=!0,l},H=()=>{const e=new c({uniforms:{uTextureA:{value:null},uTextureB:{value:null},uTime:{value:0},uScroll:{value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUv = uv;\n}",fragmentShader:"uniform sampler2D uTextureA;\nuniform sampler2D uTextureB;\nprecision mediump float; \nuniform float uTime;\nuniform float uScroll;\nvarying vec2 vUv;\n\nmat3 rotationMatrix3(vec3 axis, float angle) {\n  axis = normalize(axis);\n  float s = sin(angle);\n  float c = cos(angle);\n  float oc = 1. - c;\n\n  return mat3(oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s,\n              oc * axis.z * axis.x + axis.y * s,\n              oc * axis.x * axis.y + axis.z * s, oc * axis.y * axis.y + c,\n              oc * axis.y * axis.z - axis.x * s,\n              oc * axis.z * axis.x - axis.y * s,\n              oc * axis.y * axis.z + axis.x * s, oc * axis.z * axis.z + c);\n}\n\nvoid main() {\n  vec3 textureA = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureA, vUv).xyz;\n  \n\n  vec3 textureB = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureB, vUv).xyz;\n  \n\n  float t = uScroll;\n  vec3 pos = mix(textureA, textureB, t);\n\n  gl_FragColor = vec4(pos, 1.);\n}"}),a=new i;return a.setAttribute("position",new l(new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]),3)),a.setAttribute("uv",new l(new Float32Array([0,1,1,1,1,0,0,1,1,0,0,0]),2)),new u(a,e)};const Q=["object"],$=T({__name:"particalMesh",props:{progress:{default:0},width:{default:256},height:{default:256}},setup(e,{expose:a}){const t=e;let o=((e,a)=>{const t=e*a;let o=new Float32Array(3*t);for(let n=0;n<t;n++){let t=3*n;o[t+0]=n%e/e,o[t+1]=n/e/a}const r=new i;return r.setAttribute("position",new l(o,3)),new m(r,new c({uniforms:{uPositions:{value:null},uSize:{value:12},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uColor:{value:new p("#ffaa00")}},vertexShader:"uniform sampler2D\n    uPositions; \nuniform float uSize;\nuniform float uPixelRatio;\nvarying vec3 vPos;\nvarying vec2 vUv;\nvoid main() {\n  vec3 pos = texture2D(uPositions, position.xy).xyz;\n\n  float customSize = uSize;\n\n  vec4 modelPosition = modelMatrix * vec4(pos, 1.0);\n  vec4 viewPosition = viewMatrix * modelPosition;\n  vec4 projectionPosition = projectionMatrix * viewPosition;\n\n  gl_Position = projectionPosition;\n  gl_PointSize = customSize * uPixelRatio;\n  gl_PointSize *= (1.0 / -viewPosition.z);\n\n  vPos = pos;\n}",fragmentShader:"precision mediump float;\nvarying vec3 vPos;\nuniform vec3 uColor; \nvoid main() {\n\n  float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n  float strength = 0.05 / distanceToCenter - 0.1;\n\n  \n\n  gl_FragColor = vec4(uColor, strength * length(vPos));\n}",transparent:!0,depthWrite:!1,blending:v}))})(t.width,t.height);return a({particles:o}),(e,a)=>(A(),B("primitive",{object:C(o)},null,8,Q))}}),E=T({__name:"particalFBO",props:{progress:{default:0},width:{default:256},height:{default:256},color:{default:"#ffaa00"}},async setup(o){let r,i;const l=o,c=F(),m=new d(l.width,l.height,{minFilter:f,magFilter:f,generateMipmaps:!1,colorSpace:x,depthBuffer:!1,stencilBuffer:!1,format:n,type:s}),p=e=>{const a=[];return e.traverse((e=>{e instanceof u&&(e.geometry.deleteAttribute("uv"),e.geometry.deleteAttribute("normal"),e.geometry.deleteAttribute("tangent"),a.push(e.geometry))})),y(a)},v=new g,P=p(([r,i]=D((()=>S("./plugins/medical/model/brainparts.OBJ",v))),r=await r,i(),r));P.scale(.01,.01,.01);const j=G(P),b=p(([r,i]=D((()=>e("https://opensource.cdn.icegl.cn/model/eCommerce/guanYu.glb",{draco:!0,decoderPath:"./draco/"}))),r=await r,i(),r).scene.children[0]);b.rotateX(Math.PI/2),b.translate(0,-.9,0);const M=G(b),_=p(([r,i]=D((()=>e("./plugins/industry4/model/modelDraco.glb",{draco:!0,decoderPath:"./draco/"}))),r=await r,i(),r).scene.children[0]);_.rotateX(-Math.PI/2),_.rotateY(Math.PI/3),_.translate(0,0,0);const z=G(_),T=H(),B=new h,C=new w(-1,1,1,-1,1/Math.pow(2,53),1);B.add(T);const{onBeforeLoop:L}=a(),{camera:R,renderer:k}=t();return L((({elapsed:e})=>{k.value&&R.value&&c.value&&(k.value.setRenderTarget(m),k.value.clear(),k.value.render(B,C),k.value.setRenderTarget(null),l.progress<.5?(T.material.uniforms.uTextureA.value=M,T.material.uniforms.uTextureB.value=j,T.material.uniforms.uScroll.value=2*l.progress):(T.material.uniforms.uTextureA.value=j,T.material.uniforms.uTextureB.value=z,T.material.uniforms.uScroll.value=2*(l.progress-.5)),T.material.uniforms.uTime.value=e,c.value.particles.material.uniforms.uPositions.value=m.texture,c.value.particles.material.uniforms.uColor.value.setStyle(l.color))})),(e,a)=>(A(),U($,{ref_key:"pMesh",ref:c,progress:e.progress},null,8,["progress"]))}}),K=T({__name:"particalPass",props:{use:{type:Boolean,default:!0}},setup(e){const o=e,{camera:r,renderer:s,scene:i,sizes:l}=t(),u=0,c=.472,m=1.61;let p=null;L((()=>{l.width.value&&((e,a,t,o,r)=>{const s=new P(e,a),i=new j(new b(o,r),c,m,u),l=new d(o,r,{generateMipmaps:!1,minFilter:M,magFilter:M,format:n,colorSpace:x,samples:0});p=new _(t,l),p.addPass(s),p.addPass(i)})(i.value,r.value,s.value,l.width.value,l.height.value)}));const{onLoop:v}=a();return v((()=>{o.use?p&&p.render():s.value&&r.value&&s.value.render(i.value,r.value)})),(e,a)=>null}}),Z=X(T({__name:"scrollPartical",setup(e){const a=F(0);L((()=>{console.log("jaime ~ progress:",a.value)}));const t={clearColor:"#000",outputColorSpace:x,windowSize:!0,renderMode:"manual",powerPreference:"high-performance",antialias:!1,alpha:!1,useLegacyLights:!1,physicallyCorrectLights:!0},r=R({pass:!1,color:"#ffaa00"}),n=new z({title:"参数",expanded:!0});return n.addBinding(r,"pass",{label:"后处理"}),n.addBinding(r,"color",{label:"颜色"}),(e,n)=>{const s=k("TresCanvas");return A(),B(q,null,[V(C(N),{styleNum:4}),V(s,I(O(t)),{default:Y((()=>[n[1]||(n[1]=W("TresPerspectiveCamera",{position:[0,0,-4],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),V(K,{use:r.pass},null,8,["use"]),V(C(o),{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e),distance:10,"smooth-scroll":.1,"html-scroll":""},{default:Y((()=>[(A(),U(J,null,{default:Y((()=>[V(E,{progress:a.value,color:r.color},null,8,["progress","color"])])),_:1}))])),_:1},8,["modelValue"])])),_:1},16),n[2]||(n[2]=W("main",null,[W("section",null,[W("h1",null,"关羽 - GuanYu")]),W("section",null,[W("h1",{style:{"margin-left":"-11em","margin-bottom":"-10em"}},"大脑 - Brain")]),W("section",null,[W("h1",{style:{"margin-left":"11em","margin-bottom":"-10em"}},"设备 - Device")])],-1))],64)}}}),[["__scopeId","data-v-ca41f31d"]]);export{Z as default};
