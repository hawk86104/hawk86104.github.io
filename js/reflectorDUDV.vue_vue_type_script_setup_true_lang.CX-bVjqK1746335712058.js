import{cg as e,ae as s,l as i,m as t}from"./three.Bj3hPI0l1746335712058.js";import{b as r}from"./@tresjs.CIKSfeCC1746335712058.js";import{R as a,b as l}from"./all.three.CQRY1fcG1746335712058.js";import{q as o}from"./vite-plugin-qiankun.B06WoCqG1746335712058.js";import{d as n,a5 as u,a3 as _,w as c,H as f,o as p,J as v,u as m}from"./@vue.DK6ok9LJ1746335712058.js";const d=["scale"],b=["object"],j=["object"],w=n({__name:"reflectorDUDV",props:{reflectivity:{default:.8},showGridHelper:{type:Boolean,default:!0},scale:{default:1},ignoreObjects:{default:[]},size:{default:[10,10]},mapUrl:{default:"./plugins/floor/image/waterdudv.jpg"}},async setup(n,{expose:w}){let U,g;const h=n,B=new a,E=new e(h.size[0]-.5,h.size[1]);E.visible=h.showGridHelper;let I=h.mapUrl;o.__POWERED_BY_QIANKUN__&&(I=o.__INJECTED_PUBLIC_PATH_BY_QIANKUN__+I,console.log("qiankunWindow.__INJECTED_PUBLIC_PATH_BY_QIANKUN__",o.__INJECTED_PUBLIC_PATH_BY_QIANKUN__),console.log("process.env.BASE_URL","./"));const{map:N}=([U,g]=u((()=>r({map:I}))),U=await U,g(),U);N.wrapS=s,N.wrapT=s,N.repeat.set(6,3);const T=new l({map:N,reflectivity:h.reflectivity});T.uniforms.tReflect={value:B.renderTarget.texture},T.uniforms.tReflectBlur=B.renderTargetUniform,T.uniforms.uMatrix=B.textureMatrixUniform;const y=new i(new t(h.size[0],h.size[1]),T);return y.rotation.x=-Math.PI/2,y.add(B),y.onBeforeRender=(e,s,i)=>{y.visible=!1,h.ignoreObjects.forEach((e=>{e.isMesh&&(e.visible=!1),e.value&&e.value.isMesh&&(e.value.visible=!1)})),B.update(e,s,i),h.ignoreObjects.forEach((e=>{e.isMesh&&(e.visible=!0),e.value&&e.value.isMesh&&(e.value.visible=!0)})),y.visible=!0},_((()=>{h.reflectivity&&(T.uniforms.uReflectivity.value=h.reflectivity)})),c((()=>h.showGridHelper),(e=>{E.visible=e})),w({reflector:B}),(e,s)=>(p(),f("TresGroup",{scale:h.scale},[v("primitive",{object:m(y),"position-y":-.01},null,8,b),v("primitive",{object:m(E)},null,8,j)],8,d))}});export{w as _};
