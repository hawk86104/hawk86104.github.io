import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.IwwYCecN1744863032604.js";import{e as i,I as s,K as e}from"./@tresjs.DDZ0vesk1744863032604.js";import{B as n,V as r,cF as o,an as a,a8 as h,b as c,at as u,A as l,l as d,C as m}from"./three.B0XaFSnH1744863032604.js";import{a as p}from"./simplex-noise.DjNkejFf1744863032604.js";import{d as g,a3 as f,H as y,o as b,u as S,r as x,j as v,f as P,m as w,F as I}from"./@vue.DK6ok9LJ1744863032604.js";import"./index.DubKqcPD1744863032604.js";import{_ as M}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.BBCavvZI1744863032604.js";import"./three-custom-shader-material.Cs7iC7LJ1744863032604.js";import"./buildingsCustomShaderMaterial.DyBo--wu1744863032604.js";import"./postprocessing.DMK_Mhe01744863032604.js";import"./@vueuse.aRlY5CPe1744863032604.js";import"./all.three.BWK6-XYU1744863032604.js";import"./oimophysics.BBtHVm4j1744863032604.js";import"./reflectorDiffuse.C720h9Ah1744863032604.js";import"./vite-plugin-qiankun.B06WoCqG1744863032604.js";import"./index.TmMel0Tm1744863032604.js";import"./object-hash.BnegGKfT1744863032604.js";import"./@amap.CGUF9xH41744863032604.js";import"./jszip.H-wAjEeh1744863032604.js";import"./three-stdlib.zHR4YQlW1744863032604.js";import"./whiteFloor.B7ErRpnd1744863032604.js";import"./@pmndrs.BOTG9HN71744863032604.js";const T=F;function V(){const t=["updateMesh","index","onDecideSubrayCreation","initSubray","vertices","createPrism","action","createDefaultSubrayCreationCallbacks","positionVariationFactor","49NtfQOy","fraction0","set","timeScale","currentSegmentCallback","needsUpdate","pow","apply","currentCoordinate","sin","radius0","currentSubray","340PkZMaM","middlePos","indices","ceil","isStatic","fractalRayRecursive","error","side","5XMzvNT","rayParameters","time","42507MynOXn","deathTime","birthTime","subrayCylinderPosition","radius1Factor","sub","5928758vAeeoW","clone","getNewSegment","2029266qTQLFY","constructor","ramification","currentIndex","subVectors","function *\\( *\\)","RAY_UNBORN","simplexZ","middleLinPos","down","straightness","pos1","31365gSJCDl","destOffset","lerp","197822XloEen","min","randomGenerator","SIN30DEG","recursionProbability","vPos","148064BElEDT","minRadius","isEternal","call","setSeed","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","maxRaySegments","seedGenerator","RAY_STEADY","RAY_INITIALIZED","floor","test","linPos0","state","subrayPeriod","vanishingTimeFactor","RAY_PROPAGATING","currentUVCoordinate","propagationTimeFactor","createTriangleVerticesWithUVs","subrayProbability","return (function() ","up0","48ebPzcq","crossVectors","raySegments","up1","linPos1","sourceOffset","generateUVs","recursion","subrayDutyCycle","RAY_EXTINGUISHED","gger","addNewSubray","setAttribute","currentSegmentIndex","console","subrays","noiseSeed","string","usage","COS30DEG","table","chain","fillMesh","isInitialSegment","init","createMesh","normalize","beginVanishingTime","toString","createSegment","newPos","push","radius1","subrayConePosition","visible","timeFraction","drawRange","debu","onSubrayCreation","currentVertex","copyParameters","createRandomGenerator","LightningStrike","info","length","uvs","add","__proto__","positionAttribute","maxIterations","cos","numSubrays","uvsAttribute","forwardsFill","getSeed","createTriangleVerticesWithoutUVs","multiplyScalar","max","forwards","currentSeed","counter","162931rhuPTx","position","cross1","createSubray","array","random","currentCreateTriangleVertices","iteration","bind","fraction1","maxSubrayRecursion","maxSubrays","input","copy","pos0","while (true) {}","seed","log","warn","simplexY","fractalRay","roughness","endPropagationTime","radius0Factor"];return(V=function(){return t})()}!function(){const t=F,i=V();for(;;)try{if(186769===parseInt(t(464))/1+-parseInt(t(544))/2+-parseInt(t(520))/3*(-parseInt(t(403))/4)+-parseInt(t(517))/5*(parseInt(t(529))/6)+parseInt(t(497))/7*(-parseInt(t(550))/8)+parseInt(t(541))/9*(-parseInt(t(509))/10)+parseInt(t(526))/11)break;i.push(i.shift())}catch(s){i.push(i.shift())}}();const _=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s[F(504)](i,arguments);return s=null,t}}:function(){};return t=!1,e}}();!function(){_(this,(function(){const t=F,i=new RegExp(t(534)),s=new RegExp(t(385),"i"),e=C(t(427));i.test(e+t(424))&&s[t(391)](e+t(476))?C():e("0")}))()}();const A=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s[F(504)](i,arguments);return s=null,t}}:function(){};return t=!1,e}}();function F(t,i){const s=V();return F=function(t,i){return s[t-=384]},F(t,i)}A(void 0,(function(){const t=F;let i;try{i=Function(t(401)+'{}.constructor("return this")( ));')()}catch(n){i=window}const s=i.console=i[t(417)]||{},e=[t(481),t(482),t(446),t(515),"exception",t(423),"trace"];for(let r=0;r<e[t(447)];r++){const i=A.constructor.prototype[t(472)](A),n=e[r],o=s[n]||i;i[t(450)]=A[t(472)](A),i.toString=o[t(431)][t(472)](o),s[n]=i}}))();class R extends n{constructor(t={}){const i=F;super(),this.isLightningStrike=!0,this.type=i(445),this[i(427)](R[i(443)](t,t)),this.createMesh()}static createRandomGenerator(){const t=F,i=2053,s=[];for(let n=0;n<i;n++)s[t(434)](Math[t(469)]());const e={currentSeed:0,random:function(){const n=t,r=s[e.currentSeed];return e.currentSeed=(e[n(462)]+1)%i,r},getSeed:function(){return e[t(462)]/i},setSeed:function(s){e[t(462)]=Math.floor(s*i)%i}};return e}static copyParameters(t={},i={}){const s=F,e=function(s){return i===t?s:s[F(527)]()};return t[s(408)]=void 0!==i[s(408)]?e(i[s(408)]):new r(0,100,0),t[s(542)]=void 0!==i[s(542)]?e(i[s(542)]):new r(0,0,0),t.timeScale=void 0!==i[s(500)]?i[s(500)]:1,t.roughness=void 0!==i[s(485)]?i[s(485)]:.9,t[s(539)]=void 0!==i[s(539)]?i[s(539)]:.7,t[s(402)]=void 0!==i[s(402)]?e(i[s(402)]):new r(0,0,1),t[s(406)]=void 0!==i[s(406)]?e(i[s(406)]):new r(0,0,1),t[s(507)]=void 0!==i.radius0?i[s(507)]:1,t[s(435)]=void 0!==i[s(435)]?i.radius1:1,t[s(487)]=void 0!==i.radius0Factor?i[s(487)]:.5,t[s(524)]=void 0!==i[s(524)]?i[s(524)]:.2,t.minRadius=void 0!==i[s(551)]?i[s(551)]:.2,t[s(552)]=void 0!==i[s(552)]?i[s(552)]:void 0===i[s(522)]||void 0===i[s(521)],t[s(522)]=i[s(522)],t.deathTime=i[s(521)],t[s(398)]=void 0!==i[s(398)]?i.propagationTimeFactor:.1,t[s(395)]=void 0!==i[s(395)]?i[s(395)]:.9,t[s(394)]=void 0!==i[s(394)]?i[s(394)]:4,t[s(411)]=void 0!==i.subrayDutyCycle?i[s(411)]:.6,t[s(452)]=void 0!==i[s(452)]?i[s(452)]:9,t[s(513)]=void 0!==i[s(513)]&&i.isStatic,t[s(531)]=void 0!==i[s(531)]?i[s(531)]:5,t.maxSubrayRecursion=void 0!==i[s(474)]?i[s(474)]:3,t.recursionProbability=void 0!==i[s(548)]?i[s(548)]:.6,t.generateUVs=void 0!==i[s(409)]&&i.generateUVs,t[s(546)]=i[s(546)],t[s(419)]=i.noiseSeed,t[s(490)]=i[s(490)],t[s(441)]=i[s(441)],t}update(t){const i=F;this[i(513)]||(this[i(518)][i(552)]||this[i(518)].birthTime<=t&&t<=this[i(518)][i(521)]?(this[i(488)](t),t<this[i(418)][0].endPropagationTime?this[i(393)]=R[i(396)]:t>this[i(418)][0][i(430)]?this[i(393)]=R.RAY_VANISHING:this[i(393)]=R[i(388)],this[i(437)]=!0):(this.visible=!1,t<this[i(518)][i(522)]?this[i(393)]=R.RAY_UNBORN:this.state=R[i(412)]))}[T(427)](t){const i=T;this[i(518)]=t,this[i(452)]=void 0!==t[i(452)]?Math[i(390)](t[i(452)]):9,t[i(452)]=this.maxIterations,this[i(513)]=void 0!==t.isStatic&&t[i(513)],t.isStatic=this[i(513)],this[i(531)]=void 0!==t[i(531)]?Math[i(390)](t.ramification):5,t[i(531)]=this[i(531)],this[i(474)]=void 0!==t.maxSubrayRecursion?Math.floor(t[i(474)]):3,t[i(474)]=this[i(474)],this[i(548)]=void 0!==t[i(548)]?t[i(548)]:.6,t[i(548)]=this.recursionProbability,this.generateUVs=void 0!==t[i(409)]&&t.generateUVs,t[i(409)]=this.generateUVs,void 0!==t[i(546)]?(this[i(546)]=t[i(546)],this[i(387)]=t.randomGenerator,void 0!==t[i(419)]&&this[i(387)][i(384)](t.noiseSeed)):(this.randomGenerator=R[i(444)](),this[i(387)]=Math),void 0!==t.onDecideSubrayCreation?this[i(490)]=t[i(490)]:(this[i(495)](),void 0!==t[i(441)]&&(this[i(441)]=t[i(441)])),this.state=R[i(389)],this[i(475)]=Math[i(512)](1+Math[i(503)](this.ramification,Math.max(0,this[i(474)]-1))),t.maxSubrays=this[i(475)],this[i(386)]=2*(1<<this.maxIterations),this[i(418)]=[];for(let s=0;s<this[i(475)];s++)this[i(418)][i(434)](this[i(467)]());this[i(405)]=[];for(let s=0;s<this[i(386)];s++)this[i(405)].push(this.createSegment());this[i(519)]=0,this.timeFraction=0,this[i(501)]=null,this[i(470)]=this.generateUVs?this[i(399)]:this[i(458)],this[i(454)]=0,this.currentSubray=null,this[i(416)]=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this[i(505)]=0,this[i(397)]=0,this.vertices=null,this[i(448)]=null,this.indices=null,this[i(451)]=null,this.uvsAttribute=null,this.simplexX=p(this[i(387)][i(469)]),this[i(483)]=p(this[i(387)][i(469)]),this[i(536)]=p(this[i(387)].random),this[i(461)]=new r,this.forwardsFill=new r,this.side=new r,this[i(538)]=new r,this.middlePos=new r,this[i(537)]=new r,this.newPos=new r,this[i(549)]=new r,this[i(466)]=new r}[T(428)](){const t=T,i=1<<this[t(452)],s=3*(i+1)*this[t(475)],e=18*i*this.maxSubrays;this[t(492)]=new Float32Array(3*s),this[t(511)]=new Uint32Array(e),this[t(409)]&&(this[t(448)]=new Float32Array(2*s)),this[t(425)](0),this.setIndex(new o(this[t(511)],1)),this[t(451)]=new a(this[t(492)],3),this[t(415)](t(465),this[t(451)]),this.generateUVs&&(this[t(455)]=new a(new Float32Array(this[t(448)]),2),this.setAttribute("uv",this[t(455)])),!this[t(513)]&&(this[t(489)][t(421)]=h,this[t(451)][t(421)]=h,this[t(409)]&&(this[t(455)][t(421)]=h)),this[t(492)]=this[t(451)][t(468)],this[t(511)]=this[t(489)][t(468)],this.generateUVs&&(this[t(448)]=this.uvsAttribute[t(468)])}[T(488)](t){const i=T;this.fillMesh(t),this[i(439)].count=this[i(532)],this.index[i(502)]=!0,this[i(451)].needsUpdate=!0,this[i(409)]&&(this.uvsAttribute[i(502)]=!0)}fillMesh(t){const i=T,s=this;this.currentVertex=0,this[i(532)]=0,this.currentCoordinate=0,this[i(397)]=0,this[i(484)](t,(function(e){const n=i,r=s[n(508)];t<r.birthTime||(this[n(518)][n(552)]&&0==s[n(508)][n(410)]?(s[n(493)](e),s.onDecideSubrayCreation(e,s)):t<r.endPropagationTime?s[n(438)]>=e[n(498)]*r[n(398)]&&(s.createPrism(e),s[n(490)](e,s)):t<r.beginVanishingTime?(s.createPrism(e),s[n(490)](e,s)):(s[n(438)]<=r[n(395)]+e.fraction1*(1-r.vanishingTimeFactor)&&s.createPrism(e),s[n(490)](e,s)))}))}[T(414)](){const t=T;return this[t(418)][this[t(454)]++]}[T(491)](t,i){const s=T;t[s(478)][s(477)](i[s(408)]),t[s(540)][s(477)](i[s(542)]),t.up0[s(477)](i[s(402)]),t[s(406)][s(477)](i[s(406)]),t[s(507)]=i[s(507)],t.radius1=i.radius1,t[s(522)]=i[s(522)],t[s(521)]=i.deathTime,t.timeScale=i.timeScale,t.roughness=i[s(485)],t.straightness=i[s(539)],t[s(398)]=i[s(398)],t[s(395)]=i[s(395)],t.maxIterations=this[s(452)],t[s(480)]=void 0!==i.noiseSeed?i[s(419)]:0,t[s(410)]=0}[T(484)](t,i){const s=T;this[s(519)]=t,this[s(501)]=i,this[s(454)]=0,this[s(491)](this[s(414)](),this[s(518)]);for(let e=0;e<this.numSubrays;e++){const i=this[s(418)][e];this.currentSubray=i,this[s(546)].setSeed(i[s(480)]),i[s(486)]=c[s(543)](i.birthTime,i[s(521)],i[s(398)]),i[s(430)]=c[s(543)](i[s(521)],i[s(522)],1-i[s(395)]);const n=this.randomGenerator.random;i.linPos0[s(499)](n(),n(),n()).multiplyScalar(1e3),i[s(407)][s(499)](n(),n(),n()).multiplyScalar(1e3),this[s(438)]=(t-i[s(522)])/(i[s(521)]-i[s(522)]),this[s(416)]=0,this[s(426)]=!0;const r=this[s(528)]();r[s(471)]=0,r[s(478)][s(477)](i[s(478)]),r.pos1[s(477)](i[s(540)]),r.linPos0.copy(i[s(392)]),r[s(407)].copy(i.linPos1),r[s(402)][s(477)](i[s(402)]),r[s(406)][s(477)](i[s(406)]),r[s(507)]=i[s(507)],r[s(435)]=i[s(435)],r[s(498)]=0,r[s(473)]=1,r.positionVariationFactor=1-i.straightness,this[s(400)]=this[s(531)]*Math[s(503)](this.recursionProbability,i[s(410)])/(1<<i.maxIterations),this[s(514)](r)}this.currentSegmentCallback=null,this[s(508)]=null}[T(514)](t){const i=T;if(t[i(471)]>=this.currentSubray.maxIterations)return void this[i(501)](t);this[i(461)].subVectors(t[i(540)],t[i(478)]);let s=this[i(461)][i(447)]();s<1e-6&&(this[i(461)][i(499)](0,0,.01),s=this[i(461)][i(447)]());const e=.5*(t[i(507)]+t[i(435)]),n=.5*(t[i(498)]+t[i(473)]),r=this[i(519)]*this[i(508)][i(500)]*Math[i(503)](2,t[i(471)]);this[i(510)].lerpVectors(t[i(478)],t[i(540)],.5),this[i(537)].lerpVectors(t[i(392)],t[i(407)],.5);const o=this[i(537)];this.newPos[i(499)](this.simplexX(o.x,o.y,o.z,r),this[i(483)](o.x,o.y,o.z,r),this[i(536)](o.x,o.y,o.z,r)),this[i(433)][i(459)](t[i(496)]*s),this[i(433)][i(449)](this[i(510)]);const a=this.getNewSegment();a[i(478)][i(477)](t[i(478)]),a.pos1.copy(this[i(433)]),a.linPos0[i(477)](t.linPos0),a[i(407)][i(477)](this.middleLinPos),a[i(402)][i(477)](t[i(402)]),a.up1.copy(t[i(406)]),a[i(507)]=t[i(507)],a[i(435)]=e,a[i(498)]=t[i(498)],a[i(473)]=n,a.positionVariationFactor=t[i(496)]*this.currentSubray[i(485)],a[i(471)]=t.iteration+1;const h=this[i(528)]();h[i(478)][i(477)](this[i(433)]),h[i(540)][i(477)](t.pos1),h[i(392)][i(477)](this[i(537)]),h.linPos1.copy(t[i(407)]),this[i(466)].crossVectors(t[i(402)],this[i(461)][i(429)]()),h[i(402)][i(404)](this[i(461)],this.cross1)[i(429)](),h[i(406)].copy(t[i(406)]),h.radius0=e,h[i(435)]=t.radius1,h[i(498)]=n,h.fraction1=t[i(473)],h.positionVariationFactor=t[i(496)]*this[i(508)][i(485)],h[i(471)]=t[i(471)]+1,this[i(514)](a),this[i(514)](h)}[T(493)](t){const i=T;this[i(456)][i(533)](t[i(540)],t.pos0)[i(429)](),this[i(426)]&&(this[i(470)](t.pos0,t.up0,this[i(456)],t.radius0,0),this[i(426)]=!1),this.currentCreateTriangleVertices(t[i(540)],t[i(402)],this.forwardsFill,t.radius1,t[i(473)]),this.createPrismFaces()}[T(458)](t,i,s,e){const n=T;this.side[n(404)](i,s)[n(459)](e*R.COS30DEG),this[n(538)][n(477)](i)[n(459)](-e*R.SIN30DEG);const r=this.vPos,o=this[n(492)];r[n(477)](t).sub(this[n(516)])[n(449)](this[n(538)]),o[this[n(505)]++]=r.x,o[this.currentCoordinate++]=r.y,o[this[n(505)]++]=r.z,r[n(477)](t)[n(449)](this.side)[n(449)](this[n(538)]),o[this[n(505)]++]=r.x,o[this[n(505)]++]=r.y,o[this[n(505)]++]=r.z,r[n(477)](i).multiplyScalar(e).add(t),o[this[n(505)]++]=r.x,o[this.currentCoordinate++]=r.y,o[this.currentCoordinate++]=r.z,this.currentVertex+=3}createTriangleVerticesWithUVs(t,i,s,e,n){const r=T;this.side.crossVectors(i,s)[r(459)](e*R[r(422)]),this.down[r(477)](i)[r(459)](-e*R[r(547)]);const o=this.vPos,a=this[r(492)],h=this[r(448)];o[r(477)](t)[r(525)](this[r(516)])[r(449)](this.down),a[this[r(505)]++]=o.x,a[this[r(505)]++]=o.y,a[this[r(505)]++]=o.z,h[this[r(397)]++]=n,h[this[r(397)]++]=0,o[r(477)](t)[r(449)](this[r(516)])[r(449)](this.down),a[this[r(505)]++]=o.x,a[this[r(505)]++]=o.y,a[this[r(505)]++]=o.z,h[this.currentUVCoordinate++]=n,h[this[r(397)]++]=.5,o[r(477)](i)[r(459)](e).add(t),a[this[r(505)]++]=o.x,a[this[r(505)]++]=o.y,a[this[r(505)]++]=o.z,h[this[r(397)]++]=n,h[this[r(397)]++]=1,this.currentVertex+=3}createPrismFaces(t){const i=T,s=this[i(511)];t=this[i(442)]-6,s[this[i(532)]++]=t+1,s[this[i(532)]++]=t+2,s[this[i(532)]++]=t+5,s[this[i(532)]++]=t+1,s[this.currentIndex++]=t+5,s[this[i(532)]++]=t+4,s[this[i(532)]++]=t+0,s[this[i(532)]++]=t+1,s[this[i(532)]++]=t+4,s[this[i(532)]++]=t+0,s[this[i(532)]++]=t+4,s[this[i(532)]++]=t+3,s[this[i(532)]++]=t+2,s[this[i(532)]++]=t+0,s[this.currentIndex++]=t+3,s[this.currentIndex++]=t+2,s[this.currentIndex++]=t+3,s[this[i(532)]++]=t+5}[T(495)](){const t=T,i=this.randomGenerator[t(469)];this[t(490)]=function(s,e){const n=t,r=e[n(508)],o=e[n(518)][n(394)],a=e.rayParameters[n(411)],h=e.rayParameters[n(552)]&&0==r[n(410)]?-i()*o:c[n(543)](r[n(522)],r.endPropagationTime,s[n(498)])-i()*o,u=e[n(519)]-h,l=Math.floor(u/o),d=i()*(l+1);let m=0;if(u%o<=a*o&&(m=e[n(400)]),r[n(410)]<e[n(474)]&&e.numSubrays<e.maxSubrays&&i()<m){const t=e[n(414)](),c=e.randomGenerator[n(457)]();t[n(480)]=d,e[n(546)].setSeed(d),t.recursion=r[n(410)]+1,t[n(452)]=Math[n(460)](1,r[n(452)]-1),t[n(392)][n(499)](i(),i(),i())[n(459)](1e3),t.linPos1.set(i(),i(),i())[n(459)](1e3),t[n(402)][n(477)](r[n(402)]),t[n(406)][n(477)](r.up1),t[n(507)]=s[n(507)]*e[n(518)].radius0Factor,t[n(435)]=Math[n(545)](e[n(518)][n(551)],s[n(435)]*e[n(518)].radius1Factor),t[n(522)]=h+l*o,t[n(521)]=t[n(522)]+o*a,!e.rayParameters[n(552)]&&0==r[n(410)]&&(t[n(522)]=Math[n(460)](t.birthTime,r.birthTime),t.deathTime=Math[n(545)](t[n(521)],r[n(521)])),t[n(500)]=2*r[n(500)],t[n(485)]=r[n(485)],t[n(539)]=r[n(539)],t[n(398)]=r.propagationTimeFactor,t[n(395)]=r[n(395)],e[n(441)](s,r,t,e),e[n(546)].setSeed(c)}};const s=new r,e=new r,n=new r,o=new r;this.onSubrayCreation=function(i,s,e,n){n[t(523)](i,s,e,.5,.6,.2)},this[t(436)]=function(r,a,h,c,u,l){const d=t;h.pos0[d(477)](r[d(478)]),s[d(533)](a.pos1,a.pos0),e[d(477)](s)[d(429)](),s[d(459)](r[d(498)]+(1-r.fraction0)*(i()*c));const m=s[d(447)]();n[d(404)](a.up0,e);const p=2*Math.PI*i();n[d(459)](Math.cos(p)),o.copy(a.up0).multiplyScalar(Math[d(506)](p)),h[d(540)][d(477)](n).add(o)[d(459)](m*u*(l+i()*(1-l)))[d(449)](s).add(a[d(478)])},this[t(523)]=function(r,a,h,c,u,l){const d=t;h.pos0.copy(r[d(478)]),s.subVectors(a[d(540)],a[d(478)]),e[d(477)](s)[d(429)](),s[d(459)](r[d(498)]+(1-r.fraction0)*((2*i()-1)*c));const m=s[d(447)]();n[d(404)](a[d(402)],e);const p=2*Math.PI*i();n[d(459)](Math.cos(p)),o.copy(a[d(402)])[d(459)](Math.sin(p)),h[d(540)][d(477)](n)[d(449)](o)[d(459)](m*u*(l+i()*(1-l)))[d(449)](s)[d(449)](a[d(478)])}}[T(467)](){return{seed:0,maxIterations:0,recursion:0,pos0:new r,pos1:new r,linPos0:new r,linPos1:new r,up0:new r,up1:new r,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}}[T(432)](){return{iteration:0,pos0:new r,pos1:new r,linPos0:new r,linPos1:new r,up0:new r,up1:new r,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}}[T(528)](){const t=T;return this[t(405)][this[t(416)]++]}[T(477)](t){const i=T;return super.copy(t),this[i(427)](R[i(443)]({},t[i(518)])),this}[T(527)](){const t=T;return new(this[t(530)])(R[t(443)]({},this[t(518)]))}}function C(t){function i(t){const s=F;if(typeof t===s(420))return function(t){}.constructor(s(479))[s(504)](s(463));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(s(440)+s(413))[s(553)](s(494)):function(){return!1}[s(530)]("debu"+s(413)).apply("stateObject"),i(++t)}try{if(t)return i;i(0)}catch(s){}}R.RAY_INITIALIZED=0,R[T(535)]=1,R[T(396)]=2,R.RAY_STEADY=3,R.RAY_VANISHING=4,R[T(412)]=5,R[T(422)]=Math[T(453)](30*Math.PI/180),R[T(547)]=Math[T(506)](30*Math.PI/180);const D=G;function j(){const t=["birthTime","maxHeight","push","constructor","243joRqip","nextLightningTime","debu","lightningsMeshes","log","bind","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","return (function() ","indexOf","update","function *\\( *\\)","counter","lightningMaxDuration","deadLightningsMeshes","getNextLightningTime","lightningMaterial","copyParameters","maxSlope","lightningMinDuration","lightningMaxPeriod","add","size","42fkOshk","103784webFvD","remove","input","action","639700heyVQp","init","lightningParameters","warn","chain","while (true) {}","sourceOffset","console","RAY_EXTINGUISHED","string","multiplyScalar","pop","apply","inited","info","rayParameters","random","test","lerp","clone","onLightningDown","5YeHsFY","length","lightningMinPeriod","21QebrTl","stateObject",'{}.constructor("return this")( )',"copy","minHeight","onRayPosition","stormParams","403521dlhYpI","toString","maxLightnings","73074cYwsFR","state","exception","gger","noiseSeed","isEternal","set","139363kpFmAD","4771770REXdky","3329062izbFyn"];return(j=function(){return t})()}!function(){const t=G,i=j();for(;;)try{if(278022===parseInt(t(337))/1+-parseInt(t(340))/2*(parseInt(t(330))/3)+parseInt(t(306))/4*(-parseInt(t(327))/5)+parseInt(t(301))/6*(-parseInt(t(347))/7)+parseInt(t(302))/8*(-parseInt(t(354))/9)+parseInt(t(348))/10+parseInt(t(349))/11)break;i.push(i.shift())}catch(s){i.push(i.shift())}}();const H=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s[G(318)](i,arguments);return s=null,t}}:function(){};return t=!1,e}}();!function(){H(this,(function(){const t=G,i=new RegExp(t(364)),s=new RegExp(t(360),"i"),e=E(t(307));i[t(323)](e+t(310))&&s[t(323)](e+t(304))?E():e("0")}))()}();const z=function(){let t=!0;return function(i,s){const e=t?function(){if(s){const t=s.apply(i,arguments);return s=null,t}}:function(){};return t=!1,e}}();function G(t,i){const s=j();return G=function(t,i){return s[t-=300]},G(t,i)}z(void 0,(function(){const t=G;let i;try{i=Function(t(361)+t(332)+");")()}catch(n){i=window}const s=i[t(313)]=i.console||{},e=[t(358),t(309),t(320),"error",t(342),"table","trace"];for(let r=0;r<e[t(328)];r++){const i=z[t(353)].prototype.bind(z),n=e[r],o=s[n]||i;i.__proto__=z[t(359)](z),i[t(338)]=o[t(338)][t(359)](o),s[n]=i}}))();class N extends u{constructor(t={}){const i=G;super(),this.isLightningStorm=!0,this.stormParams=t,t[i(300)]=void 0!==t[i(300)]?t[i(300)]:1e3,t[i(334)]=void 0!==t.minHeight?t[i(334)]:80,t[i(351)]=void 0!==t[i(351)]?t.maxHeight:100,t[i(371)]=void 0!==t[i(371)]?t[i(371)]:1.1,t.maxLightnings=void 0!==t[i(339)]?t[i(339)]:3,t[i(329)]=void 0!==t[i(329)]?t[i(329)]:3,t.lightningMaxPeriod=void 0!==t[i(373)]?t[i(373)]:7,t[i(372)]=void 0!==t[i(372)]?t.lightningMinDuration:1,t.lightningMaxDuration=void 0!==t[i(366)]?t[i(366)]:2.5,this[i(308)]=R[i(370)](t[i(308)],t[i(308)]),this[i(308)][i(345)]=!1,this[i(369)]=void 0!==t.lightningMaterial?t.lightningMaterial:new l({color:11599871}),void 0!==t[i(335)]?this[i(335)]=t[i(335)]:this[i(335)]=function(s,e){const n=i;e.set((Math[n(322)]()-.5)*t.size,0,(Math.random()-.5)*t.size);const r=c[n(324)](t[n(334)],t[n(351)],Math.random());s[n(346)](t[n(371)]*(2*Math[n(322)]()-1),1,t.maxSlope*(2*Math[n(322)]()-1))[n(316)](r)[n(374)](e)},this.onLightningDown=t[i(326)],this[i(319)]=!1,this.nextLightningTime=0,this[i(357)]=[],this[i(367)]=[];for(let s=0;s<this[i(336)][i(339)];s++){const t=new R(R[i(370)]({},this.lightningParameters)),s=new d(t,this[i(369)]);this[i(367)][i(352)](s)}}[D(363)](t){const i=D;if(!this.inited&&(this[i(355)]=this.getNextLightningTime(t)*Math[i(322)](),this[i(319)]=!0),t>=this[i(355)]){const s=this[i(367)][i(317)]();if(s){const e=R[i(370)](s.geometry[i(321)],this[i(308)]);e[i(350)]=t,e.deathTime=t+c.lerp(this[i(336)][i(372)],this[i(336)][i(366)],Math[i(322)]()),this[i(335)](e[i(312)],e.destOffset),e[i(344)]=Math[i(322)](),this[i(374)](s),this[i(357)][i(352)](s)}this[i(355)]=this[i(368)](t)}let s=0,e=this[i(357)].length;for(;s<e;){const n=this[i(357)][s],r=n.geometry,o=r[i(341)];r[i(363)](t),o===R.RAY_PROPAGATING&&r.state>o&&this[i(326)]&&this[i(326)](r),r[i(341)]===R[i(314)]?(this[i(357)].splice(this[i(357)][i(362)](n),1),this[i(367)][i(352)](n),this[i(303)](n),e--):s++}}[D(368)](t){const i=D;return t+c[i(324)](this.stormParams.lightningMinPeriod,this.stormParams[i(373)],Math[i(322)]())/(this[i(336)][i(339)]+1)}[D(333)](t,i){const s=D;return super[s(333)](t,i),this[s(336)].size=t[s(336)][s(300)],this.stormParams[s(334)]=t.stormParams[s(334)],this[s(336)][s(351)]=t.stormParams[s(351)],this.stormParams[s(371)]=t[s(336)][s(371)],this[s(336)][s(339)]=t[s(336)][s(339)],this[s(336)][s(329)]=t[s(336)][s(329)],this[s(336)][s(373)]=t[s(336)][s(373)],this[s(336)][s(372)]=t[s(336)][s(372)],this.stormParams[s(366)]=t[s(336)].lightningMaxDuration,this[s(308)]=R[s(370)]({},t[s(308)]),this.lightningMaterial=t[s(336)][s(369)],this[s(326)]=t.onLightningDown,this}[D(325)](){const t=D;return new(this[t(353)])(this.stormParams)[t(333)](this)}}function E(t){function i(t){const s=G;if(typeof t===s(315))return function(t){}[s(353)](s(311))[s(318)](s(365));1!==(""+t/t)[s(328)]||t%20==0?function(){return!0}.constructor(s(356)+s(343)).call(s(305)):function(){return!1}[s(353)](s(356)+"gger")[s(318)](s(331)),i(++t)}try{if(t)return i;i(0)}catch(s){}}const L=["object"],U=g({__name:"lightStorm",props:{color:{default:"#b0ffff"},size:{default:2e3},minHeight:{default:100},maxHeight:{default:500},maxLightnings:{default:18},roughness:{default:.85},straightness:{default:.65},radius0:{default:1},radius1:{default:.5},timeScale:{default:.15},subrayPeriod:{default:4},subrayDutyCycle:{default:.6}},setup(t){const s=t,e=new m(s.color),n=new l({color:e}),o=new r(0,-1,0);let a=0;const h=new r,c=new r,u={roughness:s.roughness,straightness:s.straightness,radius0:s.radius0,radius1:s.radius1,timeScale:s.timeScale,subrayPeriod:s.subrayPeriod,subrayDutyCycle:s.subrayDutyCycle,minRadius:.3,maxIterations:7,propagationTimeFactor:.2,vanishingTimeFactor:.9,maxSubrayRecursion:3,ramification:3,recursionProbability:.4,onSubrayCreation:function(t,i,s,e){e.subrayConePosition(t,i,s,.6,.6,.5),a=e.rayParameters.sourceOffset.y,h.subVectors(s.pos1,e.rayParameters.sourceOffset);const n=o.dot(h);c.copy(o).multiplyScalar(n),h.sub(c);const r=n/a>.5?a/n:1;c.multiplyScalar(r),h.add(c),s.pos1.addVectors(h,e.rayParameters.sourceOffset)}},d=new N({size:s.size,minHeight:s.minHeight,maxHeight:s.maxHeight,maxSlope:.6,maxLightnings:s.maxLightnings,lightningParameters:u,lightningMaterial:n});f((()=>{const t=d.stormParams;t.size=s.size,t.minHeight=s.minHeight,t.maxHeight=s.maxHeight,n.color.set(s.color),u.roughness=s.roughness,u.straightness=s.straightness,u.radius0=s.radius0,u.radius1=s.radius1,u.timeScale=s.timeScale}));const{onLoop:p}=i();return p((({elapsed:t})=>{d.update(t)})),(t,i)=>(b(),y("primitive",{object:S(d),renderOrder:9999},null,8,L))}}),O=g({__name:"lightningStorm",setup(i){const n=x({cellSize:60,cellThickness:1,cellColor:"#6f6f6f",sectionColor:"#92399e",sectionSize:330,sectionThickness:1.5,fadeDistance:3600,fadeStrength:1,followCamera:!1,infiniteGrid:!0}),{minHeight:r,maxHeight:o,color:a,roughness:h,straightness:c,radius0:u,radius1:l,timeScale:d}=s({minHeight:{label:"最低",value:100,min:10,max:500,step:10},maxHeight:{label:"最高",value:1e3,min:50,max:2e3,step:10},color:"#ffbde7",roughness:{label:"粗糙度",value:.85,min:0,max:1,step:.01},straightness:{label:"直度度",value:.65,min:0,max:1,step:.01},radius0:{label:"端部半径",value:1,min:.1,max:10,step:.01},radius1:{label:"未部半径",value:.5,min:.1,max:10,step:.01},timeScale:{label:"时间缩放",value:.15,min:.01,max:1,step:.01}});return(i,s)=>(b(),y(I,null,[v(t,{showAxesHelper:!1,showGridHelper:!1},{ability:P((()=>[v(U,{minHeight:S(r).value,maxHeight:S(o).value,color:S(a).value,roughness:S(h).value,straightness:S(c).value,radius0:S(u).value,radius1:S(l).value,timeScale:S(d).value},null,8,["minHeight","maxHeight","color","roughness","straightness","radius0","radius1","timeScale"]),v(S(M),w({args:[100,100]},n,{position:[0,-50,0]}),null,16)])),_:1}),v(S(e))],64))}});export{O as default};
