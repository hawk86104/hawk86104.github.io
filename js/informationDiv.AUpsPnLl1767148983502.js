import{importShared as j0}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{_export_sfc as Pt}from"./index.DTe2qqjO1767148983502.js";var Kt=Object.defineProperty,St=(e,t,r)=>t in e?Kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,C=(e,t,r)=>St(e,typeof t!="symbol"?t+"":t,r);const{Matrix3:It,Frustum:zt,Vector3:L0,WebGLCoordinateSystem:Ft,Matrix4:kt,Object3D:ct,Box3:q0,Box3Helper:Ut,MeshStandardMaterial:Ht,FrontSide:Rt,BufferGeometry:jt,BufferAttribute:k0,LoadingManager:Dt,Vector2:$0,Box2:Et,MeshBasicMaterial:Jt,Mesh:Ct,Texture:ht,CanvasTexture:se,ImageLoader:ut,SRGBColorSpace:Nt,FileLoader:Bt,MathUtils:Qt,Raycaster:At,Clock:Ot}=await j0("three"),I0="0.11.9",_t=new It;function qt(e,t,r,s){const o=_t.set(e.normal.x,e.normal.y,e.normal.z,t.normal.x,t.normal.y,t.normal.z,r.normal.x,r.normal.y,r.normal.z);return s.set(-e.constant,-t.constant,-r.constant),s.applyMatrix3(o.invert()),s}let $t=class extends zt{constructor(){super(),C(this,"points"),this.points=Array(8).fill(0).map(()=>new L0)}setFromProjectionMatrix(t,r=Ft){return super.setFromProjectionMatrix(t,r),this.calculateFrustumPoints(),this}calculateFrustumPoints(){const{planes:t,points:r}=this;[[t[0],t[3],t[4]],[t[1],t[3],t[4]],[t[0],t[2],t[4]],[t[1],t[2],t[4]],[t[0],t[3],t[5]],[t[1],t[3],t[5]],[t[0],t[2],t[5]],[t[1],t[2],t[5]]].forEach((s,o)=>{qt(s[0],s[1],s[2],r[o])})}};var N0=(e=>(e[e.none=0]="none",e[e.create=1]="create",e[e.remove=2]="remove",e))(N0||{});function t1(e,t,r,s){if(!e.isLeaf&&e.z>r)return 2;const o=e.distRatio;return e.isLeaf&&e.inFrustum&&e.z<r&&o<s&&(e.showing||e.z<=t)?1:!e.isLeaf&&e.z>=t&&o>s?2:0}function T0(e,t,r,s,o,n,i,a){const Z=new X0(e,t,r);return Z.position.set(s,o,0),Z.scale.set(n,i,a),Z}function e1(e,t){const{x:r,y:s,z:o}=e,n=[],i=r*2,a=o+1,Z=.25,m=.5,G=1;if(o===0&&t.projectionID==="4326"){const u=s,b=1,g=T0(i,u,a,-.25,0,m,b,G),z=T0(i+1,u,a,Z,0,m,b,G);n.push(g,z)}else{const u=s*2,b=.5,g=T0(i,u,a,-.25,Z,m,b,G),z=T0(i+1,u,a,Z,Z,m,b,G),f=T0(i,u+1,a,-.25,-.25,m,b,G),d=T0(i+1,u+1,a,Z,-.25,m,b,G);n.push(g,z,f,d)}return n}const tt=new L0,et=new $t,r1=new kt,s1=new L0;class X0 extends ct{constructor(t=0,r=0,s=0){super(),C(this,"x"),C(this,"y"),C(this,"z"),C(this,"isTile",!0),C(this,"_isLoading",!1),C(this,"_root",this),C(this,"_sizeInWorld",-1),C(this,"_model"),C(this,"_subTiles"),C(this,"_isDirty",!1),this.x=t,this.y=r,this.z=s,this.name=`Tile ${s}-${t}-${r}`,this.up.set(0,0,1)}get model(){return this._model}get subTiles(){return this._subTiles}get distRatio(){const t=new L0().applyMatrix4(this.matrixWorld);t.setY(this.model?.geometry.boundingBox?.max.z||0);const r=tt.distanceTo(t)/this._sizeInWorld;return this.inFrustum?r*.8:r*2}get inFrustum(){const t=this.getBBox();return et.intersectsBox(t)}get isLeaf(){return!this.subTiles}get showing(){return!!this.model&&this.model.visible}set showing(t){this.model?(t&&this._updateShadow(),t!=this.showing&&(this.model.traverse(r=>r.layers.set(t?0:31)),this.model.visible=t,this._root.dispatchEvent({type:"tile-visible-changed",tile:this,visible:t}))):console.assert(!t)}_needsLoad(t){return t.downloadingThreads>=t.maxThreads?!1:this.model?!this._isDirty||!this.inFrustum?!1:!this.subTiles?.some(r=>!r._isDirty):!0}raycast(t){return this.inFrustum}getBBox(){const t=new q0(new L0(-.5,-.5,0),new L0(.5,.5,0)).applyMatrix4(this.matrixWorld);return this.model?t.max.setY(this.model.geometry.boundingBox?.max.z||0):(t.min.setY(-300),t.max.setY(9e3)),t}getTileSize(){if(this._sizeInWorld<0){const t=new q0(new L0(-.5,-.5,0),new L0(.5,.5,0)).applyMatrix4(this.matrixWorld);this._sizeInWorld=t.getSize(s1).length(),console.assert(this._sizeInWorld>10)}return this._sizeInWorld}_addBBox(){const t=this.getBBox().clone().applyMatrix4(this.matrixWorld.clone().invert()),r=new Ut(t,1044480);r.name="tilebox",this.add(r)}update(t){if(!this.parent||this._isLoading)return;this.parent instanceof X0&&(this._root=this.parent._root),console.assert(this._root.z===0);const{loader:r,minLevel:s,camera:o}=t;if(this.z===0&&(o.getWorldPosition(tt),et.setFromProjectionMatrix(r1.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse))),this.z>=s&&this._needsLoad(r)){this._startLoad(r);return}this.model&&r.update(this,this.model),this._updateShadow(),this.LOD(t),this.subTiles?.forEach(n=>n.update(t))}_updateShadow(){this.model&&(this.model.castShadow=this._root.castShadow,this.model.receiveShadow=this._root.receiveShadow)}LOD(t){const{loader:r,minLevel:s,maxLevel:o,LODThreshold:n}=t,i=t1(this,s,o,n);if(i===N0.create){const a=e1(this,r);this.add(...a),this._subTiles=a,this._subTiles.forEach(Z=>{Z.updateMatrixWorld(),Z.updateMatrix(),Z.getTileSize(),this._root.dispatchEvent({type:"tile-created",tile:Z})})}else i===N0.remove&&this.model&&(this.showing=!0,this.unLoad(r,!1));return i}_checkVisible(){const t=this.parent;if(t instanceof X0)if(t.model){const r=t.subTiles;if(r){const s=!r.some(o=>!o.model);r.forEach(o=>o.showing=s),t.showing=!s}}else this.showing=!0;return this}async _startLoad(t){const r=this._isDirty;this._isLoading=!0;const s=await t.load(this,this.model);this.model&&this.model.removeFromParent(),this._model=s,s.geometry.computeBoundingBox(),this.add(s),this._root.dispatchEvent({type:"tile-visible-changed",tile:this,visible:!0}),r?this._isDirty=!1:this.isLeaf&&this._checkVisible(),t.debug>1&&this._addBBox(),this._isLoading=!1,this._root.dispatchEvent({type:"tile-loaded",tile:this})}reload(t,r=!0){return r?this.unLoad(t,!0):(this.traverse(s=>{s instanceof X0&&(s.model||s._isLoading)&&(s._isDirty=!0)}),this)}unLoad(t,r=!0){return this.subTiles&&(this.subTiles.forEach(s=>{s.unLoad(t,!0)}),this.remove(...this.subTiles),this._subTiles=void 0),r&&this.model&&(this.model.removeFromParent(),t.unload(this.model),this._model=void 0,this._isDirty=!1,this._root.dispatchEvent({type:"tile-unload",tile:this})),t.debug>1&&this.getObjectByName("tilebox")?.geometry.dispose(),this}}class o1 extends Ht{constructor(t={}){super({transparent:!1,side:Rt,...t})}}function U0(...e){const t=e,r=t&&t.length>1&&t[0].constructor||null;if(!r)throw new Error("concatenateTypedArrays - incorrect quantity of arguments or arguments have incompatible data types");const s=t.reduce((i,a)=>i+a.length,0),o=new r(s);let n=0;for(const i of t)o.set(i,n),n+=i.length;return o}function i1(e,t,r,s){const o=a1(t),n=o.length,i=new Float32Array(n*6),a=new Float32Array(n*4),Z=new t.constructor(n*6),m=new Float32Array(n*6);for(let u=0;u<n;u++)n1({edge:o[u],edgeIndex:u,attributes:e,skirtHeight:r,newPosition:i,newTexcoord0:a,newTriangles:Z,newNormals:m});e.position.value=U0(e.position.value,i),e.texcoord.value=U0(e.texcoord.value,a),e.normal.value=U0(e.normal.value,m);const G=U0(t,Z);return{attributes:e,indices:G}}function a1(e){const t=[],r=Array.isArray(e)?e:Array.from(e);for(let o=0;o<r.length;o+=3){const n=r[o],i=r[o+1],a=r[o+2];t.push([n,i],[i,a],[a,n])}t.sort(([o,n],[i,a])=>{const Z=Math.min(o,n),m=Math.min(i,a);return Z!==m?Z-m:Math.max(o,n)-Math.max(i,a)});const s=[];for(let o=0;o<t.length;o++)o+1<t.length&&t[o][0]===t[o+1][1]&&t[o][1]===t[o+1][0]?o++:s.push(t[o]);return s}function n1({edge:e,edgeIndex:t,attributes:r,skirtHeight:s,newPosition:o,newTexcoord0:n,newTriangles:i,newNormals:a}){const Z=r.position.value.length,m=t*2,G=m+1;o.set(r.position.value.subarray(e[0]*3,e[0]*3+3),m*3),o[m*3+2]=o[m*3+2]-s,o.set(r.position.value.subarray(e[1]*3,e[1]*3+3),G*3),o[G*3+2]=o[G*3+2]-s,n.set(r.texcoord.value.subarray(e[0]*2,e[0]*2+2),m*2),n.set(r.texcoord.value.subarray(e[1]*2,e[1]*2+2),G*2);const u=t*2*3;i[u]=e[0],i[u+1]=Z/3+G,i[u+2]=e[1],i[u+3]=Z/3+G,i[u+4]=e[0],i[u+5]=Z/3+m,a[u]=0,a[u+1]=0,a[u+2]=1,a[u+3]=0,a[u+4]=0,a[u+5]=1}function l1(e){if(e.length<4)throw new Error(`DEM array must > 4, got ${e.length}!`);const t=Math.floor(Math.sqrt(e.length)),r=t,s=t,o=mt(s,r);return{attributes:d1(e,s,r),indices:o}}function d1(e,t,r){const s=r*t,o=new Float32Array(s*3),n=new Float32Array(s*2);let i=0;for(let a=0;a<t;a++)for(let Z=0;Z<r;Z++){const m=Z/(r-1),G=a/(t-1);n[i*2]=m,n[i*2+1]=G,o[i*3]=m-.5,o[i*3+1]=G-.5,o[i*3+2]=e[(t-a-1)*r+Z],i++}return{position:{value:o,size:3},texcoord:{value:n,size:2},normal:{value:c1(o,mt(t,r)),size:3}}}function mt(e,t){const r=6*(t-1)*(e-1),s=new Uint16Array(r);let o=0;for(let n=0;n<e-1;n++)for(let i=0;i<t-1;i++){const a=n*t+i,Z=a+1,m=a+t,G=m+1,u=o*6;s[u]=a,s[u+1]=Z,s[u+2]=m,s[u+3]=m,s[u+4]=Z,s[u+5]=G,o++}return s}function c1(e,t){const r=new Float32Array(e.length);for(let s=0;s<t.length;s+=3){const o=t[s]*3,n=t[s+1]*3,i=t[s+2]*3,a=e[o],Z=e[o+1],m=e[o+2],G=e[n],u=e[n+1],b=e[n+2],g=e[i],z=e[i+1],f=e[i+2],d=G-a,c=u-Z,y=b-m,h=g-a,W=z-Z,p=f-m,l=c*p-y*W,L=y*h-d*p,v=d*W-c*h,x=Math.sqrt(l*l+L*L+v*v),S=[0,0,1];if(x>0){const I=1/x;S[0]=l*I,S[1]=L*I,S[2]=v*I}for(let I=0;I<3;I++)r[o+I]=r[n+I]=r[i+I]=S[I]}return r}let S0=class extends jt{constructor(){super(),C(this,"type","TileGeometry");const t=new Float32Array([0,0,0,0,1,0,1,1,0,1,0,0]);this.setData(t)}setData(t,r=1e3){let s=t instanceof Float32Array?l1(t):t;s=i1(s.attributes,s.indices,r);const{attributes:o,indices:n}=s;return this.setIndex(new k0(n,1)),this.setAttribute("position",new k0(o.position.value,o.position.size)),this.setAttribute("uv",new k0(o.texcoord.value,o.texcoord.size)),this.setAttribute("normal",new k0(o.normal.value,o.normal.size)),this.computeBoundingBox(),this.computeBoundingSphere(),this}};class h1 extends Dt{constructor(){super(...arguments),C(this,"onParseEnd")}parseEnd(t){this.onParseEnd&&this.onParseEnd(t)}}const rt={name:"GuoJF"},y0={manager:new h1,demLoaderMap:new Map,imgLoaderMap:new Map,registerMaterialLoader(e){y0.imgLoaderMap.set(e.dataType,e),e.info.author=e.info.author??rt.name},registerGeometryLoader(e){y0.demLoaderMap.set(e.dataType,e),e.info.author=e.info.author??rt.name},getMaterialLoader(e){const t=typeof e=="string"?e:e.dataType,r=y0.imgLoaderMap.get(t);if(r)return r;throw`Image source dataType("${t}") is not support!`},getGeometryLoader(e){const t=typeof e=="string"?e:e.dataType,r=y0.demLoaderMap.get(t);if(r)return r;throw`Terrain source dataType("${t}") is not support!`},getLoaders(){return{imgLoaders:Array.from(y0.imgLoaderMap.values()),demLoaders:Array.from(y0.demLoaderMap.values())}}};function bt(e,t){const r=Math.floor(e[0]*t),s=Math.floor(e[1]*t),o=Math.floor((e[2]-e[0])*t),n=Math.floor((e[3]-e[1])*t);return{sx:r,sy:s,sw:o,sh:n}}function Zt(e,t,r,s){if(s<e.minLevel)return{url:void 0,clipBounds:[0,0,1,1]};if(s<=e.maxLevel)return{url:e.getUrl(t,r,s),clipBounds:[0,0,1,1]};const o=m1(t,r,s,e.maxLevel),n=o.parentCoord;return{url:e.getUrl(n.x,n.y,n.z),clipBounds:o.bounds}}function u1(e,t){const r=e.width,s=new OffscreenCanvas(r,r),o=s.getContext("2d"),{sx:n,sy:i,sw:a,sh:Z}=bt(t,e.width);return o.drawImage(e,n,i,a,Z,0,0,r,r),s}function m1(e,t,r,s){const o=r-s,n={x:e>>o,y:t>>o,z:r-o},i=Math.pow(2,o),a=Math.pow(.5,o),Z=e%i/i-.5+a/2,m=t%i/i-.5+a/2,G=new $0(Z,m),u=new Et().setFromCenterAndSize(G,new $0(a,a)),b=[u.min.x+.5,u.min.y+.5,u.max.x+.5,u.max.y+.5];return{parentCoord:n,bounds:b}}function b1(e,t,r){if(t[0]<=r[0]&&t[1]<=r[1]&&t[2]>=r[2]&&t[3]>=r[3])return e;const[s,o,n,i]=t,[a,Z,m,G]=r,u=Math.max(s,a),b=Math.max(o,Z),g=Math.min(n,m),z=Math.min(i,G);if(u>=g||b>=z)return e;const f=new OffscreenCanvas(e.width,e.height),d=f.getContext("2d");d.drawImage(e,0,0);const c=Math.max(a,s),y=Math.min(m,n),h=Math.max(Z,o),W=Math.min(G,i);d.globalCompositeOperation="destination-in";const p=m-a,l=G-Z,L=(c-a)/p*f.width,v=(y-a)/p*f.width,x=f.height-(W-Z)/l*f.height,S=f.height-(h-Z)/l*f.height;return d.beginPath(),d.rect(L,x,v-L,S-x),d.fill(),f}class Z1{constructor(){C(this,"_downloadingThreads",0),C(this,"_bounds",[-180,-85,180,85]),C(this,"_maxThreads",10),C(this,"_imgSource",[]),C(this,"_demSource"),C(this,"debug",0),C(this,"_errorMaterial",new Jt({color:16711680,transparent:!0,opacity:0,name:"error-material"}))}get bounds(){return this._bounds}set bounds(t){this._bounds=t}get maxThreads(){return this._maxThreads}set maxThreads(t){this._maxThreads=t}get downloadingThreads(){return this._downloadingThreads}get imgSource(){return this._imgSource}set imgSource(t){this._imgSource=t}get demSource(){return this._demSource}set demSource(t){this._demSource=t}get projectionID(){return this.imgSource[0].projectionID}get manager(){return y0.manager}async load(t,r){const s=this.demSource?1:0+this.imgSource.length;this._downloadingThreads+=s;let o;try{const n=await this.loadGeometry(t,r?.geometry),i=await this.loadMaterial(t,r?.material);if(r){const a=r.geometry,Z=r.material;o=r,o.geometry=n,o.material=i,a.userData.toDispose&&(a.dispose(),delete a.userData.source,delete a.userData.toDispose),Z.forEach(m=>{m.userData.toDispose&&(m.dispose(),delete m.userData.source,delete m.userData.toDispose)})}else o=new Ct(n,i);o.geometry.clearGroups();for(let a=0;a<o.material.length;a++)o.geometry.addGroup(0,1/0,a)}finally{this._downloadingThreads-=s}return o}unload(t){const r=t.material;for(let s=0;s<r.length;s++)r[s].dispose(),t.geometry.groups.pop();t.geometry.dispose()}update(t,r){const s=this.imgSource.filter(o=>this._checkBounds(o,t));for(let o=0;o<s.length;o++)s[o].dynamic}async loadGeometry(t,r){if(this.demSource&&this._checkBounds(this.demSource,t)){if(r){if(this.demSource===r.userData.source)return r.userData.toDispose=!1,r;r.userData.toDispose=!0}const s=y0.getGeometryLoader(this.demSource),o=this.demSource;return await s.load({source:o,...t}).then(n=>(n.userData.source=o,n)).catch(n=>(this.debug>0&&console.error("Load Geometry Error:",n),new S0))}else return new S0}async loadMaterial(t,r){r&&r.forEach(n=>n.userData.toDispose=!0);const s=[],o=this.imgSource.filter(n=>this._checkBounds(n,t));for(let n=0;n<o.length;n++){const i=o[n];if(r){const Z=r[n];if(Z&&i===Z.userData.source){Z.userData.toDispose=!1,s.push(Z);continue}}const a=await y0.getMaterialLoader(i).load({source:i,...t}).then(Z=>(Z.userData.source=i,Z)).catch(Z=>(this.debug>0&&console.error("Load Material Error:",Z.target.src),this._errorMaterial.clone()));this._materialClip(a,i,t),s.push(a)}return s}_materialClip(t,r,s){if("map"in t&&t.map instanceof ht){const o=t.map;o.image&&(o.image=b1(o.image,r._projectionBounds,s.bounds)),o.needsUpdate=!0}return this}_checkBounds(t,r){const s=(o,n)=>{const i=o._projectionBounds;return n[2]>=i[0]&&n[3]>=i[1]&&n[0]<=i[2]&&n[1]<=i[3]};return r.z>=t.minLevel&&s(t,r.bounds)}}class yt{constructor(){C(this,"info",{version:I0,description:"Terrain loader base class"}),C(this,"dataType","")}async load(t){const{source:r,x:s,y:o,z:n}=t,{url:i,clipBounds:a}=Zt(r,s,o,n);if(!i)return new S0;const Z=await this.doLoad(i,{...t,clipBounds:a});return y0.manager.parseEnd(Z),Z}}class y1{constructor(){C(this,"info",{version:I0,description:"Image loader base class"}),C(this,"dataType",""),C(this,"_material",new o1)}get material(){return this._material}set material(t){this.material.dispose(),this._material=t}async load(t){const{source:r,x:s,y:o,z:n}=t,i=this.createMaterial(t);i.transparent=t.source.transparent,i.opacity=t.source.opacity;const{url:a,clipBounds:Z}=Zt(r,s,o,n);return a&&(i.map=await this.doLoad(a,{...t,clipBounds:Z}),i.addEventListener("dispose",pt)),i}createMaterial(t){return this.material.clone()}async doLoad(t,r){return Promise.resolve(void 0)}}const pt=e=>{const t=e.target.map;t&&(t.image instanceof ImageBitmap&&t.image.close(),t.dispose()),e.target.removeEventListener("dispose",pt)};let ft=class extends y1{constructor(){super(...arguments),C(this,"info",{version:I0,description:"Tile image loader. It can load xyz tile image."}),C(this,"dataType","image"),C(this,"loader",new ut(y0.manager))}async doLoad(t,r){let s=await this.loader.loadAsync(t);const o=r.clipBounds;o[2]-o[0]<1&&(s=u1(s,o));const n=new ht(s);return n.colorSpace=Nt,n}};wt(new ft);class Wt{constructor(t=4){this.pool=t,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(t){if(!this.workers[t]){const r=this.workerCreator();r.addEventListener("message",this._onMessage.bind(this,t)),this.workers[t]=r}}_getIdleWorker(){for(let t=0;t<this.pool;t++)if(!(this.workerStatus&1<<t))return t;return-1}_onMessage(t,r){const s=this.workersResolve[t];if(s&&s(r),this.queue.length){const{resolve:o,msg:n,transfer:i}=this.queue.shift();this.workersResolve[t]=o,this.workers[t].postMessage(n,i)}else this.workerStatus^=1<<t}setWorkerCreator(t){this.workerCreator=t}setWorkerLimit(t){this.pool=t}postMessage(t,r){return new Promise(s=>{const o=this._getIdleWorker();o!==-1?(this._initWorker(o),this.workerStatus|=1<<o,this.workersResolve[o]=s,this.workers[o].postMessage(t,r)):this.queue.push({resolve:s,msg:t,transfer:r})})}dispose(){this.workers.forEach(t=>t.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const Lt="dmFyIGNlPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgbWU9KGosWixxKT0+WiBpbiBqP2NlKGosWix7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6cX0pOmpbWl09cTt2YXIgTj0oaixaLHEpPT5tZShqLHR5cGVvZiBaIT0ic3ltYm9sIj9aKyIiOloscSk7KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGooQSxwKXtjb25zdCBrPW5ldyBGbG9hdDMyQXJyYXkoQS5sZW5ndGgpO2ZvcihsZXQgVT0wO1U8cC5sZW5ndGg7VSs9Myl7Y29uc3QgYT1wW1VdKjMsZT1wW1UrMV0qMyxyPXBbVSsyXSozLHM9QVthXSx0PUFbYSsxXSxuPUFbYSsyXSxoPUFbZV0saT1BW2UrMV0sbz1BW2UrMl0sYz1BW3JdLHU9QVtyKzFdLG09QVtyKzJdLHc9aC1zLGw9aS10LGY9by1uLGc9Yy1zLE09dS10LFY9bS1uLGQ9bCpWLWYqTSx5PWYqZy13KlYsST13Kk0tbCpnLHo9TWF0aC5zcXJ0KGQqZCt5KnkrSSpJKSx4PVswLDAsMV07aWYoej4wKXtjb25zdCB2PTEvejt4WzBdPWQqdix4WzFdPXkqdix4WzJdPUkqdn1mb3IobGV0IHY9MDt2PDM7disrKWtbYSt2XT1rW2Urdl09a1tyK3ZdPXhbdl19cmV0dXJuIGt9Y2xhc3MgWntjb25zdHJ1Y3RvcihwPTI1Nyl7Tih0aGlzLCJncmlkU2l6ZSIpO04odGhpcywibnVtVHJpYW5nbGVzIik7Tih0aGlzLCJudW1QYXJlbnRUcmlhbmdsZXMiKTtOKHRoaXMsImluZGljZXMiKTtOKHRoaXMsImNvb3JkcyIpO3RoaXMuZ3JpZFNpemU9cDtjb25zdCBrPXAtMTtpZihrJmstMSl0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGdyaWQgc2l6ZSB0byBiZSAyXm4rMSwgZ290ICR7cH0uYCk7dGhpcy5udW1UcmlhbmdsZXM9ayprKjItMix0aGlzLm51bVBhcmVudFRyaWFuZ2xlcz10aGlzLm51bVRyaWFuZ2xlcy1rKmssdGhpcy5pbmRpY2VzPW5ldyBVaW50MzJBcnJheSh0aGlzLmdyaWRTaXplKnRoaXMuZ3JpZFNpemUpLHRoaXMuY29vcmRzPW5ldyBVaW50MTZBcnJheSh0aGlzLm51bVRyaWFuZ2xlcyo0KTtmb3IobGV0IFU9MDtVPHRoaXMubnVtVHJpYW5nbGVzO1UrKyl7bGV0IGE9VSsyLGU9MCxyPTAscz0wLHQ9MCxuPTAsaD0wO2ZvcihhJjE/cz10PW49azplPXI9aD1rOyhhPj49MSk+MTspe2NvbnN0IG89ZStzPj4xLGM9cit0Pj4xO2EmMT8ocz1lLHQ9cixlPW4scj1oKTooZT1zLHI9dCxzPW4sdD1oKSxuPW8saD1jfWNvbnN0IGk9VSo0O3RoaXMuY29vcmRzW2krMF09ZSx0aGlzLmNvb3Jkc1tpKzFdPXIsdGhpcy5jb29yZHNbaSsyXT1zLHRoaXMuY29vcmRzW2krM109dH19Y3JlYXRlVGlsZShwKXtyZXR1cm4gbmV3IHEocCx0aGlzKX19Y2xhc3MgcXtjb25zdHJ1Y3RvcihwLGspe04odGhpcywibWFydGluaSIpO04odGhpcywidGVycmFpbiIpO04odGhpcywiZXJyb3JzIik7Y29uc3QgVT1rLmdyaWRTaXplO2lmKHAubGVuZ3RoIT09VSpVKXRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgdGVycmFpbiBkYXRhIG9mIGxlbmd0aCAke1UqVX0gKCR7VX0geCAke1V9KSwgZ290ICR7cC5sZW5ndGh9LmApO3RoaXMudGVycmFpbj1wLHRoaXMubWFydGluaT1rLHRoaXMuZXJyb3JzPW5ldyBGbG9hdDMyQXJyYXkocC5sZW5ndGgpLHRoaXMudXBkYXRlKCl9dXBkYXRlKCl7Y29uc3R7bnVtVHJpYW5nbGVzOnAsbnVtUGFyZW50VHJpYW5nbGVzOmssY29vcmRzOlUsZ3JpZFNpemU6YX09dGhpcy5tYXJ0aW5pLHt0ZXJyYWluOmUsZXJyb3JzOnJ9PXRoaXM7Zm9yKGxldCBzPXAtMTtzPj0wO3MtLSl7Y29uc3QgdD1zKjQsbj1VW3QrMF0saD1VW3QrMV0saT1VW3QrMl0sbz1VW3QrM10sYz1uK2k+PjEsdT1oK28+PjEsbT1jK3UtaCx3PXUrbi1jLGw9KGVbaCphK25dK2VbbyphK2ldKS8yLGY9dSphK2MsZz1NYXRoLmFicyhsLWVbZl0pO2lmKHJbZl09TWF0aC5tYXgocltmXSxnKSxzPGspe2NvbnN0IE09KGgrdz4+MSkqYSsobittPj4xKSxWPShvK3c+PjEpKmErKGkrbT4+MSk7cltmXT1NYXRoLm1heChyW2ZdLHJbTV0scltWXSl9fX1nZXRHZW9tZXRyeURhdGEocD0wKXtjb25zdHtncmlkU2l6ZTprLGluZGljZXM6VX09dGhpcy5tYXJ0aW5pLHtlcnJvcnM6YX09dGhpcztsZXQgZT0wLHI9MDtjb25zdCBzPWstMTtsZXQgdCxuLGg9MDtVLmZpbGwoMCk7ZnVuY3Rpb24gaShmLGcsTSxWLGQseSl7Y29uc3QgST1mK00+PjEsej1nK1Y+PjE7TWF0aC5hYnMoZi1kKStNYXRoLmFicyhnLXkpPjEmJmFbeiprK0ldPnA/KGkoZCx5LGYsZyxJLHopLGkoTSxWLGQseSxJLHopKToodD1nKmsrZixuPVYqaytNLGg9eSprK2QsVVt0XT09PTAmJihVW3RdPSsrZSksVVtuXT09PTAmJihVW25dPSsrZSksVVtoXT09PTAmJihVW2hdPSsrZSkscisrKX1pKDAsMCxzLHMscywwKSxpKHMscywwLDAsMCxzKTtjb25zdCBvPWUqMixjPXIqMyx1PW5ldyBVaW50MTZBcnJheShvKSxtPW5ldyBVaW50MzJBcnJheShjKTtsZXQgdz0wO2Z1bmN0aW9uIGwoZixnLE0sVixkLHkpe2NvbnN0IEk9ZitNPj4xLHo9ZytWPj4xO2lmKE1hdGguYWJzKGYtZCkrTWF0aC5hYnMoZy15KT4xJiZhW3oqaytJXT5wKWwoZCx5LGYsZyxJLHopLGwoTSxWLGQseSxJLHopO2Vsc2V7Y29uc3QgeD1VW2cqaytmXS0xLHY9VVtWKmsrTV0tMSxEPVVbeSprK2RdLTE7dVsyKnhdPWYsdVsyKngrMV09Zyx1WzIqdl09TSx1WzIqdisxXT1WLHVbMipEXT1kLHVbMipEKzFdPXksbVt3KytdPXgsbVt3KytdPXYsbVt3KytdPUR9fXJldHVybiBsKDAsMCxzLHMscywwKSxsKHMscywwLDAsMCxzKSx7YXR0cmlidXRlczp0aGlzLl9nZXRNZXNoQXR0cmlidXRlcyh0aGlzLnRlcnJhaW4sdSxtKSxpbmRpY2VzOm19fV9nZXRNZXNoQXR0cmlidXRlcyhwLGssVSl7Y29uc3QgYT1NYXRoLmZsb29yKE1hdGguc3FydChwLmxlbmd0aCkpLGU9YS0xLHI9ay5sZW5ndGgvMixzPW5ldyBGbG9hdDMyQXJyYXkociozKSx0PW5ldyBGbG9hdDMyQXJyYXkocioyKTtmb3IobGV0IGg9MDtoPHI7aCsrKXtjb25zdCBpPWtbaCoyXSxvPWtbaCoyKzFdLGM9byphK2k7c1szKmgrMF09aS9lLS41LHNbMypoKzFdPS41LW8vZSxzWzMqaCsyXT1wW2NdLHRbMipoKzBdPWkvZSx0WzIqaCsxXT0xLW8vZX1jb25zdCBuPWoocyxVKTtyZXR1cm57cG9zaXRpb246e3ZhbHVlOnMsc2l6ZTozfSx0ZXhjb29yZDp7dmFsdWU6dCxzaXplOjJ9LG5vcm1hbDp7dmFsdWU6bixzaXplOjN9fX19LyogQ29weXJpZ2h0IDIwMTUtMjAyMSBFc3JpLiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wIEBwcmVzZXJ2ZSAqL2NvbnN0IGVlPWZ1bmN0aW9uKCl7dmFyIEE9e307QS5kZWZhdWx0Tm9EYXRhVmFsdWU9LTM0MDI3OTk5Mzg3OTAxNDg0ZTIyLEEuZGVjb2RlPWZ1bmN0aW9uKHIscyl7cz1zfHx7fTt2YXIgdD1zLmVuY29kZWRNYXNrRGF0YXx8cy5lbmNvZGVkTWFza0RhdGE9PT1udWxsLG49YShyLHMuaW5wdXRPZmZzZXR8fDAsdCksaD1zLm5vRGF0YVZhbHVlIT09bnVsbD9zLm5vRGF0YVZhbHVlOkEuZGVmYXVsdE5vRGF0YVZhbHVlLGk9cChuLHMucGl4ZWxUeXBlfHxGbG9hdDMyQXJyYXkscy5lbmNvZGVkTWFza0RhdGEsaCxzLnJldHVybk1hc2spLG89e3dpZHRoOm4ud2lkdGgsaGVpZ2h0Om4uaGVpZ2h0LHBpeGVsRGF0YTppLnJlc3VsdFBpeGVscyxtaW5WYWx1ZTppLm1pblZhbHVlLG1heFZhbHVlOm4ucGl4ZWxzLm1heFZhbHVlLG5vRGF0YVZhbHVlOmh9O3JldHVybiBpLnJlc3VsdE1hc2smJihvLm1hc2tEYXRhPWkucmVzdWx0TWFzaykscy5yZXR1cm5FbmNvZGVkTWFzayYmbi5tYXNrJiYoby5lbmNvZGVkTWFza0RhdGE9bi5tYXNrLmJpdHNldD9uLm1hc2suYml0c2V0Om51bGwpLHMucmV0dXJuRmlsZUluZm8mJihvLmZpbGVJbmZvPWsobikscy5jb21wdXRlVXNlZEJpdERlcHRocyYmKG8uZmlsZUluZm8uYml0RGVwdGhzPVUobikpKSxvfTt2YXIgcD1mdW5jdGlvbihyLHMsdCxuLGgpe3ZhciBpPTAsbz1yLnBpeGVscy5udW1CbG9ja3NYLGM9ci5waXhlbHMubnVtQmxvY2tzWSx1PU1hdGguZmxvb3Ioci53aWR0aC9vKSxtPU1hdGguZmxvb3Ioci5oZWlnaHQvYyksdz0yKnIubWF4WkVycm9yLGw9TnVtYmVyLk1BWF9WQUxVRSxmO3Q9dHx8KHIubWFzaz9yLm1hc2suYml0c2V0Om51bGwpO3ZhciBnLE07Zz1uZXcgcyhyLndpZHRoKnIuaGVpZ2h0KSxoJiZ0JiYoTT1uZXcgVWludDhBcnJheShyLndpZHRoKnIuaGVpZ2h0KSk7Zm9yKHZhciBWPW5ldyBGbG9hdDMyQXJyYXkodSptKSxkLHksST0wO0k8PWM7SSsrKXt2YXIgej1JIT09Yz9tOnIuaGVpZ2h0JWM7aWYoeiE9PTApZm9yKHZhciB4PTA7eDw9bzt4Kyspe3ZhciB2PXghPT1vP3U6ci53aWR0aCVvO2lmKHYhPT0wKXt2YXIgRD1JKnIud2lkdGgqbSt4KnUsVD1yLndpZHRoLXYsUz1yLnBpeGVscy5ibG9ja3NbaV0sQixMLEY7Uy5lbmNvZGluZzwyPyhTLmVuY29kaW5nPT09MD9CPVMucmF3RGF0YTooZShTLnN0dWZmZWREYXRhLFMuYml0c1BlclBpeGVsLFMubnVtVmFsaWRQaXhlbHMsUy5vZmZzZXQsdyxWLHIucGl4ZWxzLm1heFZhbHVlKSxCPVYpLEw9MCk6Uy5lbmNvZGluZz09PTI/Rj0wOkY9Uy5vZmZzZXQ7dmFyIGI7aWYodClmb3IoeT0wO3k8ejt5Kyspe2ZvcihEJjcmJihiPXRbRD4+M10sYjw8PUQmNyksZD0wO2Q8djtkKyspRCY3fHwoYj10W0Q+PjNdKSxiJjEyOD8oTSYmKE1bRF09MSksZj1TLmVuY29kaW5nPDI/QltMKytdOkYsbD1sPmY/ZjpsLGdbRCsrXT1mKTooTSYmKE1bRF09MCksZ1tEKytdPW4pLGI8PD0xO0QrPVR9ZWxzZSBpZihTLmVuY29kaW5nPDIpZm9yKHk9MDt5PHo7eSsrKXtmb3IoZD0wO2Q8djtkKyspZj1CW0wrK10sbD1sPmY/ZjpsLGdbRCsrXT1mO0QrPVR9ZWxzZSBmb3IobD1sPkY/RjpsLHk9MDt5PHo7eSsrKXtmb3IoZD0wO2Q8djtkKyspZ1tEKytdPUY7RCs9VH1pZihTLmVuY29kaW5nPT09MSYmTCE9PVMubnVtVmFsaWRQaXhlbHMpdGhyb3ciQmxvY2sgYW5kIE1hc2sgZG8gbm90IG1hdGNoIjtpKyt9fX1yZXR1cm57cmVzdWx0UGl4ZWxzOmcscmVzdWx0TWFzazpNLG1pblZhbHVlOmx9fSxrPWZ1bmN0aW9uKHIpe3JldHVybntmaWxlSWRlbnRpZmllclN0cmluZzpyLmZpbGVJZGVudGlmaWVyU3RyaW5nLGZpbGVWZXJzaW9uOnIuZmlsZVZlcnNpb24saW1hZ2VUeXBlOnIuaW1hZ2VUeXBlLGhlaWdodDpyLmhlaWdodCx3aWR0aDpyLndpZHRoLG1heFpFcnJvcjpyLm1heFpFcnJvcixlb2ZPZmZzZXQ6ci5lb2ZPZmZzZXQsbWFzazpyLm1hc2s/e251bUJsb2Nrc1g6ci5tYXNrLm51bUJsb2Nrc1gsbnVtQmxvY2tzWTpyLm1hc2subnVtQmxvY2tzWSxudW1CeXRlczpyLm1hc2subnVtQnl0ZXMsbWF4VmFsdWU6ci5tYXNrLm1heFZhbHVlfTpudWxsLHBpeGVsczp7bnVtQmxvY2tzWDpyLnBpeGVscy5udW1CbG9ja3NYLG51bUJsb2Nrc1k6ci5waXhlbHMubnVtQmxvY2tzWSxudW1CeXRlczpyLnBpeGVscy5udW1CeXRlcyxtYXhWYWx1ZTpyLnBpeGVscy5tYXhWYWx1ZSxub0RhdGFWYWx1ZTpyLm5vRGF0YVZhbHVlfX19LFU9ZnVuY3Rpb24ocil7Zm9yKHZhciBzPXIucGl4ZWxzLm51bUJsb2Nrc1gqci5waXhlbHMubnVtQmxvY2tzWSx0PXt9LG49MDtuPHM7bisrKXt2YXIgaD1yLnBpeGVscy5ibG9ja3Nbbl07aC5lbmNvZGluZz09PTA/dC5mbG9hdDMyPSEwOmguZW5jb2Rpbmc9PT0xP3RbaC5iaXRzUGVyUGl4ZWxdPSEwOnRbMF09ITB9cmV0dXJuIE9iamVjdC5rZXlzKHQpfSxhPWZ1bmN0aW9uKHIscyx0KXt2YXIgbj17fSxoPW5ldyBVaW50OEFycmF5KHIscywxMCk7aWYobi5maWxlSWRlbnRpZmllclN0cmluZz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsaCksbi5maWxlSWRlbnRpZmllclN0cmluZy50cmltKCkhPT0iQ250WkltYWdlIil0aHJvdyJVbmV4cGVjdGVkIGZpbGUgaWRlbnRpZmllciBzdHJpbmc6ICIrbi5maWxlSWRlbnRpZmllclN0cmluZztzKz0xMDt2YXIgaT1uZXcgRGF0YVZpZXcocixzLDI0KTtpZihuLmZpbGVWZXJzaW9uPWkuZ2V0SW50MzIoMCwhMCksbi5pbWFnZVR5cGU9aS5nZXRJbnQzMig0LCEwKSxuLmhlaWdodD1pLmdldFVpbnQzMig4LCEwKSxuLndpZHRoPWkuZ2V0VWludDMyKDEyLCEwKSxuLm1heFpFcnJvcj1pLmdldEZsb2F0NjQoMTYsITApLHMrPTI0LCF0KWlmKGk9bmV3IERhdGFWaWV3KHIscywxNiksbi5tYXNrPXt9LG4ubWFzay5udW1CbG9ja3NZPWkuZ2V0VWludDMyKDAsITApLG4ubWFzay5udW1CbG9ja3NYPWkuZ2V0VWludDMyKDQsITApLG4ubWFzay5udW1CeXRlcz1pLmdldFVpbnQzMig4LCEwKSxuLm1hc2subWF4VmFsdWU9aS5nZXRGbG9hdDMyKDEyLCEwKSxzKz0xNixuLm1hc2subnVtQnl0ZXM+MCl7dmFyIG89bmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKG4ud2lkdGgqbi5oZWlnaHQvOCkpO2k9bmV3IERhdGFWaWV3KHIscyxuLm1hc2subnVtQnl0ZXMpO3ZhciBjPWkuZ2V0SW50MTYoMCwhMCksdT0yLG09MDtkb3tpZihjPjApZm9yKDtjLS07KW9bbSsrXT1pLmdldFVpbnQ4KHUrKyk7ZWxzZXt2YXIgdz1pLmdldFVpbnQ4KHUrKyk7Zm9yKGM9LWM7Yy0tOylvW20rK109d31jPWkuZ2V0SW50MTYodSwhMCksdSs9Mn13aGlsZSh1PG4ubWFzay5udW1CeXRlcyk7aWYoYyE9PS0zMjc2OHx8bTxvLmxlbmd0aCl0aHJvdyJVbmV4cGVjdGVkIGVuZCBvZiBtYXNrIFJMRSBlbmNvZGluZyI7bi5tYXNrLmJpdHNldD1vLHMrPW4ubWFzay5udW1CeXRlc31lbHNlIG4ubWFzay5udW1CeXRlc3xuLm1hc2subnVtQmxvY2tzWXxuLm1hc2subWF4VmFsdWV8fChuLm1hc2suYml0c2V0PW5ldyBVaW50OEFycmF5KE1hdGguY2VpbChuLndpZHRoKm4uaGVpZ2h0LzgpKSk7aT1uZXcgRGF0YVZpZXcocixzLDE2KSxuLnBpeGVscz17fSxuLnBpeGVscy5udW1CbG9ja3NZPWkuZ2V0VWludDMyKDAsITApLG4ucGl4ZWxzLm51bUJsb2Nrc1g9aS5nZXRVaW50MzIoNCwhMCksbi5waXhlbHMubnVtQnl0ZXM9aS5nZXRVaW50MzIoOCwhMCksbi5waXhlbHMubWF4VmFsdWU9aS5nZXRGbG9hdDMyKDEyLCEwKSxzKz0xNjt2YXIgbD1uLnBpeGVscy5udW1CbG9ja3NYLGY9bi5waXhlbHMubnVtQmxvY2tzWSxnPWwrKG4ud2lkdGglbD4wPzE6MCksTT1mKyhuLmhlaWdodCVmPjA/MTowKTtuLnBpeGVscy5ibG9ja3M9bmV3IEFycmF5KGcqTSk7Zm9yKHZhciBWPTAsZD0wO2Q8TTtkKyspZm9yKHZhciB5PTA7eTxnO3krKyl7dmFyIEk9MCx6PXIuYnl0ZUxlbmd0aC1zO2k9bmV3IERhdGFWaWV3KHIscyxNYXRoLm1pbigxMCx6KSk7dmFyIHg9e307bi5waXhlbHMuYmxvY2tzW1YrK109eDt2YXIgdj1pLmdldFVpbnQ4KDApO2lmKEkrKyx4LmVuY29kaW5nPXYmNjMseC5lbmNvZGluZz4zKXRocm93IkludmFsaWQgYmxvY2sgZW5jb2RpbmcgKCIreC5lbmNvZGluZysiKSI7aWYoeC5lbmNvZGluZz09PTIpe3MrKztjb250aW51ZX1pZih2IT09MCYmdiE9PTIpe2lmKHY+Pj02LHgub2Zmc2V0VHlwZT12LHY9PT0yKXgub2Zmc2V0PWkuZ2V0SW50OCgxKSxJKys7ZWxzZSBpZih2PT09MSl4Lm9mZnNldD1pLmdldEludDE2KDEsITApLEkrPTI7ZWxzZSBpZih2PT09MCl4Lm9mZnNldD1pLmdldEZsb2F0MzIoMSwhMCksSSs9NDtlbHNlIHRocm93IkludmFsaWQgYmxvY2sgb2Zmc2V0IHR5cGUiO2lmKHguZW5jb2Rpbmc9PT0xKWlmKHY9aS5nZXRVaW50OChJKSxJKysseC5iaXRzUGVyUGl4ZWw9diY2Myx2Pj49Nix4Lm51bVZhbGlkUGl4ZWxzVHlwZT12LHY9PT0yKXgubnVtVmFsaWRQaXhlbHM9aS5nZXRVaW50OChJKSxJKys7ZWxzZSBpZih2PT09MSl4Lm51bVZhbGlkUGl4ZWxzPWkuZ2V0VWludDE2KEksITApLEkrPTI7ZWxzZSBpZih2PT09MCl4Lm51bVZhbGlkUGl4ZWxzPWkuZ2V0VWludDMyKEksITApLEkrPTQ7ZWxzZSB0aHJvdyJJbnZhbGlkIHZhbGlkIHBpeGVsIGNvdW50IHR5cGUifWlmKHMrPUkseC5lbmNvZGluZyE9PTMpe3ZhciBELFQ7aWYoeC5lbmNvZGluZz09PTApe3ZhciBTPShuLnBpeGVscy5udW1CeXRlcy0xKS80O2lmKFMhPT1NYXRoLmZsb29yKFMpKXRocm93InVuY29tcHJlc3NlZCBibG9jayBoYXMgaW52YWxpZCBsZW5ndGgiO0Q9bmV3IEFycmF5QnVmZmVyKFMqNCksVD1uZXcgVWludDhBcnJheShEKSxULnNldChuZXcgVWludDhBcnJheShyLHMsUyo0KSk7dmFyIEI9bmV3IEZsb2F0MzJBcnJheShEKTt4LnJhd0RhdGE9QixzKz1TKjR9ZWxzZSBpZih4LmVuY29kaW5nPT09MSl7dmFyIEw9TWF0aC5jZWlsKHgubnVtVmFsaWRQaXhlbHMqeC5iaXRzUGVyUGl4ZWwvOCksRj1NYXRoLmNlaWwoTC80KTtEPW5ldyBBcnJheUJ1ZmZlcihGKjQpLFQ9bmV3IFVpbnQ4QXJyYXkoRCksVC5zZXQobmV3IFVpbnQ4QXJyYXkocixzLEwpKSx4LnN0dWZmZWREYXRhPW5ldyBVaW50MzJBcnJheShEKSxzKz1MfX19cmV0dXJuIG4uZW9mT2Zmc2V0PXMsbn0sZT1mdW5jdGlvbihyLHMsdCxuLGgsaSxvKXt2YXIgYz0oMTw8cyktMSx1PTAsbSx3PTAsbCxmLGc9TWF0aC5jZWlsKChvLW4pL2gpLE09ci5sZW5ndGgqNC1NYXRoLmNlaWwocyp0LzgpO2ZvcihyW3IubGVuZ3RoLTFdPDw9OCpNLG09MDttPHQ7bSsrKXtpZih3PT09MCYmKGY9clt1KytdLHc9MzIpLHc+PXMpbD1mPj4+dy1zJmMsdy09cztlbHNle3ZhciBWPXMtdztsPShmJmMpPDxWJmMsZj1yW3UrK10sdz0zMi1WLGwrPWY+Pj53fWlbbV09bDxnP24rbCpoOm99cmV0dXJuIGl9O3JldHVybiBBfSgpLHJlPWZ1bmN0aW9uKCl7dmFyIEE9e3Vuc3R1ZmY6ZnVuY3Rpb24oYSxlLHIscyx0LG4saCxpKXt2YXIgbz0oMTw8ciktMSxjPTAsdSxtPTAsdyxsLGYsZyxNPWEubGVuZ3RoKjQtTWF0aC5jZWlsKHIqcy84KTtpZihhW2EubGVuZ3RoLTFdPDw9OCpNLHQpZm9yKHU9MDt1PHM7dSsrKW09PT0wJiYobD1hW2MrK10sbT0zMiksbT49cj8odz1sPj4+bS1yJm8sbS09cik6KGY9ci1tLHc9KGwmbyk8PGYmbyxsPWFbYysrXSxtPTMyLWYsdys9bD4+Pm0pLGVbdV09dFt3XTtlbHNlIGZvcihnPU1hdGguY2VpbCgoaS1uKS9oKSx1PTA7dTxzO3UrKyltPT09MCYmKGw9YVtjKytdLG09MzIpLG0+PXI/KHc9bD4+Pm0tciZvLG0tPXIpOihmPXItbSx3PShsJm8pPDxmJm8sbD1hW2MrK10sbT0zMi1mLHcrPWw+Pj5tKSxlW3VdPXc8Zz9uK3cqaDppfSx1bnN0dWZmTFVUOmZ1bmN0aW9uKGEsZSxyLHMsdCxuKXt2YXIgaD0oMTw8ZSktMSxpPTAsbz0wLGM9MCx1PTAsbT0wLHcsbD1bXSxmPWEubGVuZ3RoKjQtTWF0aC5jZWlsKGUqci84KTthW2EubGVuZ3RoLTFdPDw9OCpmO3ZhciBnPU1hdGguY2VpbCgobi1zKS90KTtmb3Iobz0wO288cjtvKyspdT09PTAmJih3PWFbaSsrXSx1PTMyKSx1Pj1lPyhtPXc+Pj51LWUmaCx1LT1lKTooYz1lLXUsbT0odyZoKTw8YyZoLHc9YVtpKytdLHU9MzItYyxtKz13Pj4+dSksbFtvXT1tPGc/cyttKnQ6bjtyZXR1cm4gbC51bnNoaWZ0KHMpLGx9LHVuc3R1ZmYyOmZ1bmN0aW9uKGEsZSxyLHMsdCxuLGgsaSl7dmFyIG89KDE8PHIpLTEsYz0wLHUsbT0wLHc9MCxsLGYsZztpZih0KWZvcih1PTA7dTxzO3UrKyltPT09MCYmKGY9YVtjKytdLG09MzIsdz0wKSxtPj1yPyhsPWY+Pj53Jm8sbS09cix3Kz1yKTooZz1yLW0sbD1mPj4+dyZvLGY9YVtjKytdLG09MzItZyxsfD0oZiYoMTw8ZyktMSk8PHItZyx3PWcpLGVbdV09dFtsXTtlbHNle3ZhciBNPU1hdGguY2VpbCgoaS1uKS9oKTtmb3IodT0wO3U8czt1KyspbT09PTAmJihmPWFbYysrXSxtPTMyLHc9MCksbT49cj8obD1mPj4+dyZvLG0tPXIsdys9cik6KGc9ci1tLGw9Zj4+PncmbyxmPWFbYysrXSxtPTMyLWcsbHw9KGYmKDE8PGcpLTEpPDxyLWcsdz1nKSxlW3VdPWw8TT9uK2wqaDppfXJldHVybiBlfSx1bnN0dWZmTFVUMjpmdW5jdGlvbihhLGUscixzLHQsbil7dmFyIGg9KDE8PGUpLTEsaT0wLG89MCxjPTAsdT0wLG09MCx3PTAsbCxmPVtdLGc9TWF0aC5jZWlsKChuLXMpL3QpO2ZvcihvPTA7bzxyO28rKyl1PT09MCYmKGw9YVtpKytdLHU9MzIsdz0wKSx1Pj1lPyhtPWw+Pj53JmgsdS09ZSx3Kz1lKTooYz1lLXUsbT1sPj4+dyZoLGw9YVtpKytdLHU9MzItYyxtfD0obCYoMTw8YyktMSk8PGUtYyx3PWMpLGZbb109bTxnP3MrbSp0Om47cmV0dXJuIGYudW5zaGlmdChzKSxmfSxvcmlnaW5hbFVuc3R1ZmY6ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ9KDE8PHIpLTEsbj0wLGgsaT0wLG8sYyx1LG09YS5sZW5ndGgqNC1NYXRoLmNlaWwocipzLzgpO2ZvcihhW2EubGVuZ3RoLTFdPDw9OCptLGg9MDtoPHM7aCsrKWk9PT0wJiYoYz1hW24rK10saT0zMiksaT49cj8obz1jPj4+aS1yJnQsaS09cik6KHU9ci1pLG89KGMmdCk8PHUmdCxjPWFbbisrXSxpPTMyLXUsbys9Yz4+PmkpLGVbaF09bztyZXR1cm4gZX0sb3JpZ2luYWxVbnN0dWZmMjpmdW5jdGlvbihhLGUscixzKXt2YXIgdD0oMTw8ciktMSxuPTAsaCxpPTAsbz0wLGMsdSxtO2ZvcihoPTA7aDxzO2grKylpPT09MCYmKHU9YVtuKytdLGk9MzIsbz0wKSxpPj1yPyhjPXU+Pj5vJnQsaS09cixvKz1yKToobT1yLWksYz11Pj4+byZ0LHU9YVtuKytdLGk9MzItbSxjfD0odSYoMTw8bSktMSk8PHItbSxvPW0pLGVbaF09YztyZXR1cm4gZX19LHA9e0hVRkZNQU5fTFVUX0JJVFNfTUFYOjEyLGNvbXB1dGVDaGVja3N1bUZsZXRjaGVyMzI6ZnVuY3Rpb24oYSl7Zm9yKHZhciBlPTY1NTM1LHI9NjU1MzUscz1hLmxlbmd0aCx0PU1hdGguZmxvb3Iocy8yKSxuPTA7dDspe3ZhciBoPXQ+PTM1OT8zNTk6dDt0LT1oO2RvIGUrPWFbbisrXTw8OCxyKz1lKz1hW24rK107d2hpbGUoLS1oKTtlPShlJjY1NTM1KSsoZT4+PjE2KSxyPShyJjY1NTM1KSsocj4+PjE2KX1yZXR1cm4gcyYxJiYocis9ZSs9YVtuXTw8OCksZT0oZSY2NTUzNSkrKGU+Pj4xNikscj0ociY2NTUzNSkrKHI+Pj4xNiksKHI8PDE2fGUpPj4+MH0scmVhZEhlYWRlckluZm86ZnVuY3Rpb24oYSxlKXt2YXIgcj1lLnB0cixzPW5ldyBVaW50OEFycmF5KGEsciw2KSx0PXt9O2lmKHQuZmlsZUlkZW50aWZpZXJTdHJpbmc9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLHMpLHQuZmlsZUlkZW50aWZpZXJTdHJpbmcubGFzdEluZGV4T2YoIkxlcmMyIiwwKSE9PTApdGhyb3ciVW5leHBlY3RlZCBmaWxlIGlkZW50aWZpZXIgc3RyaW5nIChleHBlY3QgTGVyYzIgKTogIit0LmZpbGVJZGVudGlmaWVyU3RyaW5nO3IrPTY7dmFyIG49bmV3IERhdGFWaWV3KGEsciw4KSxoPW4uZ2V0SW50MzIoMCwhMCk7dC5maWxlVmVyc2lvbj1oLHIrPTQsaD49MyYmKHQuY2hlY2tzdW09bi5nZXRVaW50MzIoNCwhMCkscis9NCksbj1uZXcgRGF0YVZpZXcoYSxyLDEyKSx0LmhlaWdodD1uLmdldFVpbnQzMigwLCEwKSx0LndpZHRoPW4uZ2V0VWludDMyKDQsITApLHIrPTgsaD49ND8odC5udW1EaW1zPW4uZ2V0VWludDMyKDgsITApLHIrPTQpOnQubnVtRGltcz0xLG49bmV3IERhdGFWaWV3KGEsciw0MCksdC5udW1WYWxpZFBpeGVsPW4uZ2V0VWludDMyKDAsITApLHQubWljcm9CbG9ja1NpemU9bi5nZXRJbnQzMig0LCEwKSx0LmJsb2JTaXplPW4uZ2V0SW50MzIoOCwhMCksdC5pbWFnZVR5cGU9bi5nZXRJbnQzMigxMiwhMCksdC5tYXhaRXJyb3I9bi5nZXRGbG9hdDY0KDE2LCEwKSx0LnpNaW49bi5nZXRGbG9hdDY0KDI0LCEwKSx0LnpNYXg9bi5nZXRGbG9hdDY0KDMyLCEwKSxyKz00MCxlLmhlYWRlckluZm89dCxlLnB0cj1yO3ZhciBpLG87aWYoaD49MyYmKG89aD49ND81Mjo0OCxpPXRoaXMuY29tcHV0ZUNoZWNrc3VtRmxldGNoZXIzMihuZXcgVWludDhBcnJheShhLHItbyx0LmJsb2JTaXplLTE0KSksaSE9PXQuY2hlY2tzdW0pKXRocm93IkNoZWNrc3VtIGZhaWxlZC4iO3JldHVybiEwfSxjaGVja01pbk1heFJhbmdlczpmdW5jdGlvbihhLGUpe3ZhciByPWUuaGVhZGVySW5mbyxzPXRoaXMuZ2V0RGF0YVR5cGVBcnJheShyLmltYWdlVHlwZSksdD1yLm51bURpbXMqdGhpcy5nZXREYXRhVHlwZVNpemUoci5pbWFnZVR5cGUpLG49dGhpcy5yZWFkU3ViQXJyYXkoYSxlLnB0cixzLHQpLGg9dGhpcy5yZWFkU3ViQXJyYXkoYSxlLnB0cit0LHMsdCk7ZS5wdHIrPTIqdDt2YXIgaSxvPSEwO2ZvcihpPTA7aTxyLm51bURpbXM7aSsrKWlmKG5baV0hPT1oW2ldKXtvPSExO2JyZWFrfXJldHVybiByLm1pblZhbHVlcz1uLHIubWF4VmFsdWVzPWgsb30scmVhZFN1YkFycmF5OmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0O2lmKHI9PT1VaW50OEFycmF5KXQ9bmV3IFVpbnQ4QXJyYXkoYSxlLHMpO2Vsc2V7dmFyIG49bmV3IEFycmF5QnVmZmVyKHMpLGg9bmV3IFVpbnQ4QXJyYXkobik7aC5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLHMpKSx0PW5ldyByKG4pfXJldHVybiB0fSxyZWFkTWFzazpmdW5jdGlvbihhLGUpe3ZhciByPWUucHRyLHM9ZS5oZWFkZXJJbmZvLHQ9cy53aWR0aCpzLmhlaWdodCxuPXMubnVtVmFsaWRQaXhlbCxoPW5ldyBEYXRhVmlldyhhLHIsNCksaT17fTtpZihpLm51bUJ5dGVzPWguZ2V0VWludDMyKDAsITApLHIrPTQsKG49PT0wfHx0PT09bikmJmkubnVtQnl0ZXMhPT0wKXRocm93ImludmFsaWQgbWFzayI7dmFyIG8sYztpZihuPT09MClvPW5ldyBVaW50OEFycmF5KE1hdGguY2VpbCh0LzgpKSxpLmJpdHNldD1vLGM9bmV3IFVpbnQ4QXJyYXkodCksZS5waXhlbHMucmVzdWx0TWFzaz1jLHIrPWkubnVtQnl0ZXM7ZWxzZSBpZihpLm51bUJ5dGVzPjApe289bmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKHQvOCkpLGg9bmV3IERhdGFWaWV3KGEscixpLm51bUJ5dGVzKTt2YXIgdT1oLmdldEludDE2KDAsITApLG09Mix3PTAsbD0wO2Rve2lmKHU+MClmb3IoO3UtLTspb1t3KytdPWguZ2V0VWludDgobSsrKTtlbHNlIGZvcihsPWguZ2V0VWludDgobSsrKSx1PS11O3UtLTspb1t3KytdPWw7dT1oLmdldEludDE2KG0sITApLG0rPTJ9d2hpbGUobTxpLm51bUJ5dGVzKTtpZih1IT09LTMyNzY4fHx3PG8ubGVuZ3RoKXRocm93IlVuZXhwZWN0ZWQgZW5kIG9mIG1hc2sgUkxFIGVuY29kaW5nIjtjPW5ldyBVaW50OEFycmF5KHQpO3ZhciBmPTAsZz0wO2ZvcihnPTA7Zzx0O2crKylnJjc/KGY9b1tnPj4zXSxmPDw9ZyY3KTpmPW9bZz4+M10sZiYxMjgmJihjW2ddPTEpO2UucGl4ZWxzLnJlc3VsdE1hc2s9YyxpLmJpdHNldD1vLHIrPWkubnVtQnl0ZXN9cmV0dXJuIGUucHRyPXIsZS5tYXNrPWksITB9LHJlYWREYXRhT25lU3dlZXA6ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ9ZS5wdHIsbj1lLmhlYWRlckluZm8saD1uLm51bURpbXMsaT1uLndpZHRoKm4uaGVpZ2h0LG89bi5pbWFnZVR5cGUsYz1uLm51bVZhbGlkUGl4ZWwqcC5nZXREYXRhVHlwZVNpemUobykqaCx1LG09ZS5waXhlbHMucmVzdWx0TWFzaztpZihyPT09VWludDhBcnJheSl1PW5ldyBVaW50OEFycmF5KGEsdCxjKTtlbHNle3ZhciB3PW5ldyBBcnJheUJ1ZmZlcihjKSxsPW5ldyBVaW50OEFycmF5KHcpO2wuc2V0KG5ldyBVaW50OEFycmF5KGEsdCxjKSksdT1uZXcgcih3KX1pZih1Lmxlbmd0aD09PWkqaClzP2UucGl4ZWxzLnJlc3VsdFBpeGVscz1wLnN3YXBEaW1lbnNpb25PcmRlcih1LGksaCxyLCEwKTplLnBpeGVscy5yZXN1bHRQaXhlbHM9dTtlbHNle2UucGl4ZWxzLnJlc3VsdFBpeGVscz1uZXcgcihpKmgpO3ZhciBmPTAsZz0wLE09MCxWPTA7aWYoaD4xKXtpZihzKXtmb3IoZz0wO2c8aTtnKyspaWYobVtnXSlmb3IoVj1nLE09MDtNPGg7TSsrLFYrPWkpZS5waXhlbHMucmVzdWx0UGl4ZWxzW1ZdPXVbZisrXX1lbHNlIGZvcihnPTA7ZzxpO2crKylpZihtW2ddKWZvcihWPWcqaCxNPTA7TTxoO00rKyllLnBpeGVscy5yZXN1bHRQaXhlbHNbVitNXT11W2YrK119ZWxzZSBmb3IoZz0wO2c8aTtnKyspbVtnXSYmKGUucGl4ZWxzLnJlc3VsdFBpeGVsc1tnXT11W2YrK10pfXJldHVybiB0Kz1jLGUucHRyPXQsITB9LHJlYWRIdWZmbWFuVHJlZTpmdW5jdGlvbihhLGUpe3ZhciByPXRoaXMuSFVGRk1BTl9MVVRfQklUU19NQVgscz1uZXcgRGF0YVZpZXcoYSxlLnB0ciwxNik7ZS5wdHIrPTE2O3ZhciB0PXMuZ2V0SW50MzIoMCwhMCk7aWYodDwyKXRocm93InVuc3VwcG9ydGVkIEh1ZmZtYW4gdmVyc2lvbiI7dmFyIG49cy5nZXRJbnQzMig0LCEwKSxoPXMuZ2V0SW50MzIoOCwhMCksaT1zLmdldEludDMyKDEyLCEwKTtpZihoPj1pKXJldHVybiExO3ZhciBvPW5ldyBVaW50MzJBcnJheShpLWgpO3AuZGVjb2RlQml0cyhhLGUsbyk7dmFyIGM9W10sdSxtLHcsbDtmb3IodT1oO3U8aTt1KyspbT11LSh1PG4/MDpuKSxjW21dPXtmaXJzdDpvW3UtaF0sc2Vjb25kOm51bGx9O3ZhciBmPWEuYnl0ZUxlbmd0aC1lLnB0cixnPU1hdGguY2VpbChmLzQpLE09bmV3IEFycmF5QnVmZmVyKGcqNCksVj1uZXcgVWludDhBcnJheShNKTtWLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLGYpKTt2YXIgZD1uZXcgVWludDMyQXJyYXkoTSkseT0wLEksej0wO2ZvcihJPWRbMF0sdT1oO3U8aTt1KyspbT11LSh1PG4/MDpuKSxsPWNbbV0uZmlyc3QsbD4wJiYoY1ttXS5zZWNvbmQ9STw8eT4+PjMyLWwsMzIteT49bD8oeSs9bCx5PT09MzImJih5PTAseisrLEk9ZFt6XSkpOih5Kz1sLTMyLHorKyxJPWRbel0sY1ttXS5zZWNvbmR8PUk+Pj4zMi15KSk7dmFyIHg9MCx2PTAsRD1uZXcgaztmb3IodT0wO3U8Yy5sZW5ndGg7dSsrKWNbdV0hPT12b2lkIDAmJih4PU1hdGgubWF4KHgsY1t1XS5maXJzdCkpO3g+PXI/dj1yOnY9eDt2YXIgVD1bXSxTLEIsTCxGLGIsQztmb3IodT1oO3U8aTt1KyspaWYobT11LSh1PG4/MDpuKSxsPWNbbV0uZmlyc3QsbD4wKWlmKFM9W2wsbV0sbDw9dilmb3IoQj1jW21dLnNlY29uZDw8di1sLEw9MTw8di1sLHc9MDt3PEw7dysrKVRbQnx3XT1TO2Vsc2UgZm9yKEI9Y1ttXS5zZWNvbmQsQz1ELEY9bC0xO0Y+PTA7Ri0tKWI9Qj4+PkYmMSxiPyhDLnJpZ2h0fHwoQy5yaWdodD1uZXcgayksQz1DLnJpZ2h0KTooQy5sZWZ0fHwoQy5sZWZ0PW5ldyBrKSxDPUMubGVmdCksRj09PTAmJiFDLnZhbCYmKEMudmFsPVNbMV0pO3JldHVybntkZWNvZGVMdXQ6VCxudW1CaXRzTFVUUWljazp2LG51bUJpdHNMVVQ6eCx0cmVlOkQsc3R1ZmZlZERhdGE6ZCxzcmNQdHI6eixiaXRQb3M6eX19LHJlYWRIdWZmbWFuOmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0PWUuaGVhZGVySW5mbyxuPXQubnVtRGltcyxoPWUuaGVhZGVySW5mby5oZWlnaHQsaT1lLmhlYWRlckluZm8ud2lkdGgsbz1pKmgsYz10aGlzLnJlYWRIdWZmbWFuVHJlZShhLGUpLHU9Yy5kZWNvZGVMdXQsbT1jLnRyZWUsdz1jLnN0dWZmZWREYXRhLGw9Yy5zcmNQdHIsZj1jLmJpdFBvcyxnPWMubnVtQml0c0xVVFFpY2ssTT1jLm51bUJpdHNMVVQsVj1lLmhlYWRlckluZm8uaW1hZ2VUeXBlPT09MD8xMjg6MCxkLHksSSx6PWUucGl4ZWxzLnJlc3VsdE1hc2sseCx2LEQsVCxTLEIsTCxGPTA7Zj4wJiYobCsrLGY9MCk7dmFyIGI9d1tsXSxDPWUuZW5jb2RlTW9kZT09PTEsUj1uZXcgcihvKm4pLE89UixYO2lmKG48Mnx8Qyl7Zm9yKFg9MDtYPG47WCsrKWlmKG4+MSYmKE89bmV3IHIoUi5idWZmZXIsbypYLG8pLEY9MCksZS5oZWFkZXJJbmZvLm51bVZhbGlkUGl4ZWw9PT1pKmgpZm9yKEI9MCxUPTA7VDxoO1QrKylmb3IoUz0wO1M8aTtTKyssQisrKXtpZih5PTAseD1iPDxmPj4+MzItZyx2PXgsMzItZjxnJiYoeHw9d1tsKzFdPj4+NjQtZi1nLHY9eCksdVt2XSl5PXVbdl1bMV0sZis9dVt2XVswXTtlbHNlIGZvcih4PWI8PGY+Pj4zMi1NLHY9eCwzMi1mPE0mJih4fD13W2wrMV0+Pj42NC1mLU0sdj14KSxkPW0sTD0wO0w8TTtMKyspaWYoRD14Pj4+TS1MLTEmMSxkPUQ/ZC5yaWdodDpkLmxlZnQsIShkLmxlZnR8fGQucmlnaHQpKXt5PWQudmFsLGY9ZitMKzE7YnJlYWt9Zj49MzImJihmLT0zMixsKyssYj13W2xdKSxJPXktVixDPyhTPjA/SSs9RjpUPjA/SSs9T1tCLWldOkkrPUYsSSY9MjU1LE9bQl09SSxGPUkpOk9bQl09SX1lbHNlIGZvcihCPTAsVD0wO1Q8aDtUKyspZm9yKFM9MDtTPGk7UysrLEIrKylpZih6W0JdKXtpZih5PTAseD1iPDxmPj4+MzItZyx2PXgsMzItZjxnJiYoeHw9d1tsKzFdPj4+NjQtZi1nLHY9eCksdVt2XSl5PXVbdl1bMV0sZis9dVt2XVswXTtlbHNlIGZvcih4PWI8PGY+Pj4zMi1NLHY9eCwzMi1mPE0mJih4fD13W2wrMV0+Pj42NC1mLU0sdj14KSxkPW0sTD0wO0w8TTtMKyspaWYoRD14Pj4+TS1MLTEmMSxkPUQ/ZC5yaWdodDpkLmxlZnQsIShkLmxlZnR8fGQucmlnaHQpKXt5PWQudmFsLGY9ZitMKzE7YnJlYWt9Zj49MzImJihmLT0zMixsKyssYj13W2xdKSxJPXktVixDPyhTPjAmJnpbQi0xXT9JKz1GOlQ+MCYmeltCLWldP0krPU9bQi1pXTpJKz1GLEkmPTI1NSxPW0JdPUksRj1JKTpPW0JdPUl9fWVsc2UgZm9yKEI9MCxUPTA7VDxoO1QrKylmb3IoUz0wO1M8aTtTKyspaWYoQj1UKmkrUywhenx8eltCXSlmb3IoWD0wO1g8bjtYKyssQis9byl7aWYoeT0wLHg9Yjw8Zj4+PjMyLWcsdj14LDMyLWY8ZyYmKHh8PXdbbCsxXT4+PjY0LWYtZyx2PXgpLHVbdl0peT11W3ZdWzFdLGYrPXVbdl1bMF07ZWxzZSBmb3IoeD1iPDxmPj4+MzItTSx2PXgsMzItZjxNJiYoeHw9d1tsKzFdPj4+NjQtZi1NLHY9eCksZD1tLEw9MDtMPE07TCsrKWlmKEQ9eD4+Pk0tTC0xJjEsZD1EP2QucmlnaHQ6ZC5sZWZ0LCEoZC5sZWZ0fHxkLnJpZ2h0KSl7eT1kLnZhbCxmPWYrTCsxO2JyZWFrfWY+PTMyJiYoZi09MzIsbCsrLGI9d1tsXSksST15LVYsT1tCXT1JfWUucHRyPWUucHRyKyhsKzEpKjQrKGY+MD80OjApLGUucGl4ZWxzLnJlc3VsdFBpeGVscz1SLG4+MSYmIXMmJihlLnBpeGVscy5yZXN1bHRQaXhlbHM9cC5zd2FwRGltZW5zaW9uT3JkZXIoUixvLG4scikpfSxkZWNvZGVCaXRzOmZ1bmN0aW9uKGEsZSxyLHMsdCl7e3ZhciBuPWUuaGVhZGVySW5mbyxoPW4uZmlsZVZlcnNpb24saT0wLG89YS5ieXRlTGVuZ3RoLWUucHRyPj01PzU6YS5ieXRlTGVuZ3RoLWUucHRyLGM9bmV3IERhdGFWaWV3KGEsZS5wdHIsbyksdT1jLmdldFVpbnQ4KDApO2krKzt2YXIgbT11Pj42LHc9bT09PTA/NDozLW0sbD0odSYzMik+MCxmPXUmMzEsZz0wO2lmKHc9PT0xKWc9Yy5nZXRVaW50OChpKSxpKys7ZWxzZSBpZih3PT09MilnPWMuZ2V0VWludDE2KGksITApLGkrPTI7ZWxzZSBpZih3PT09NClnPWMuZ2V0VWludDMyKGksITApLGkrPTQ7ZWxzZSB0aHJvdyJJbnZhbGlkIHZhbGlkIHBpeGVsIGNvdW50IHR5cGUiO3ZhciBNPTIqbi5tYXhaRXJyb3IsVixkLHksSSx6LHgsdixELFQsUz1uLm51bURpbXM+MT9uLm1heFZhbHVlc1t0XTpuLnpNYXg7aWYobCl7Zm9yKGUuY291bnRlci5sdXQrKyxEPWMuZ2V0VWludDgoaSksaSsrLEk9TWF0aC5jZWlsKChELTEpKmYvOCksej1NYXRoLmNlaWwoSS80KSxkPW5ldyBBcnJheUJ1ZmZlcih6KjQpLHk9bmV3IFVpbnQ4QXJyYXkoZCksZS5wdHIrPWkseS5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLnB0cixJKSksdj1uZXcgVWludDMyQXJyYXkoZCksZS5wdHIrPUksVD0wO0QtMT4+PlQ7KVQrKztJPU1hdGguY2VpbChnKlQvOCksej1NYXRoLmNlaWwoSS80KSxkPW5ldyBBcnJheUJ1ZmZlcih6KjQpLHk9bmV3IFVpbnQ4QXJyYXkoZCkseS5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLnB0cixJKSksVj1uZXcgVWludDMyQXJyYXkoZCksZS5wdHIrPUksaD49Mz94PUEudW5zdHVmZkxVVDIodixmLEQtMSxzLE0sUyk6eD1BLnVuc3R1ZmZMVVQodixmLEQtMSxzLE0sUyksaD49Mz9BLnVuc3R1ZmYyKFYscixULGcseCk6QS51bnN0dWZmKFYscixULGcseCl9ZWxzZSBlLmNvdW50ZXIuYml0c3R1ZmZlcisrLFQ9ZixlLnB0cis9aSxUPjAmJihJPU1hdGguY2VpbChnKlQvOCksej1NYXRoLmNlaWwoSS80KSxkPW5ldyBBcnJheUJ1ZmZlcih6KjQpLHk9bmV3IFVpbnQ4QXJyYXkoZCkseS5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLnB0cixJKSksVj1uZXcgVWludDMyQXJyYXkoZCksZS5wdHIrPUksaD49Mz9zPT1udWxsP0Eub3JpZ2luYWxVbnN0dWZmMihWLHIsVCxnKTpBLnVuc3R1ZmYyKFYscixULGcsITEscyxNLFMpOnM9PW51bGw/QS5vcmlnaW5hbFVuc3R1ZmYoVixyLFQsZyk6QS51bnN0dWZmKFYscixULGcsITEscyxNLFMpKX19LHJlYWRUaWxlczpmdW5jdGlvbihhLGUscixzKXt2YXIgdD1lLmhlYWRlckluZm8sbj10LndpZHRoLGg9dC5oZWlnaHQsaT1uKmgsbz10Lm1pY3JvQmxvY2tTaXplLGM9dC5pbWFnZVR5cGUsdT1wLmdldERhdGFUeXBlU2l6ZShjKSxtPU1hdGguY2VpbChuL28pLHc9TWF0aC5jZWlsKGgvbyk7ZS5waXhlbHMubnVtQmxvY2tzWT13LGUucGl4ZWxzLm51bUJsb2Nrc1g9bSxlLnBpeGVscy5wdHI9MDt2YXIgbD0wLGY9MCxnPTAsTT0wLFY9MCxkPTAseT0wLEk9MCx6PTAseD0wLHY9MCxEPTAsVD0wLFM9MCxCPTAsTD0wLEYsYixDLFIsTyxYLEc9bmV3IHIobypvKSxsZT1oJW98fG8sdWU9biVvfHxvLEssUSxKPXQubnVtRGltcywkLEU9ZS5waXhlbHMucmVzdWx0TWFzayxZPWUucGl4ZWxzLnJlc3VsdFBpeGVscyxoZT10LmZpbGVWZXJzaW9uLFA9aGU+PTU/MTQ6MTUsXyxXPXQuek1heCxIO2ZvcihnPTA7Zzx3O2crKylmb3IoVj1nIT09dy0xP286bGUsTT0wO008bTtNKyspZm9yKGQ9TSE9PW0tMT9vOnVlLHY9ZypuKm8rTSpvLEQ9bi1kLCQ9MDskPEo7JCsrKXtpZihKPjE/KEg9WSx2PWcqbipvK00qbyxZPW5ldyByKGUucGl4ZWxzLnJlc3VsdFBpeGVscy5idWZmZXIsaSokKnUsaSksVz10Lm1heFZhbHVlc1skXSk6SD1udWxsLHk9YS5ieXRlTGVuZ3RoLWUucHRyLEY9bmV3IERhdGFWaWV3KGEsZS5wdHIsTWF0aC5taW4oMTAseSkpLGI9e30sTD0wLEk9Ri5nZXRVaW50OCgwKSxMKyssXz10LmZpbGVWZXJzaW9uPj01P0kmNDowLHo9ST4+NiYyNTUseD1JPj4yJlAseCE9PShNKm8+PjMmUCl8fF8mJiQ9PT0wKXRocm93ImludGVncml0eSBpc3N1ZSI7aWYoWD1JJjMsWD4zKXRocm93IGUucHRyKz1MLCJJbnZhbGlkIGJsb2NrIGVuY29kaW5nICgiK1grIikiO2lmKFg9PT0yKXtpZihfKWlmKEUpZm9yKGw9MDtsPFY7bCsrKWZvcihmPTA7ZjxkO2YrKylFW3ZdJiYoWVt2XT1IW3ZdKSx2Kys7ZWxzZSBmb3IobD0wO2w8VjtsKyspZm9yKGY9MDtmPGQ7ZisrKVlbdl09SFt2XSx2Kys7ZS5jb3VudGVyLmNvbnN0YW50KyssZS5wdHIrPUw7Y29udGludWV9ZWxzZSBpZihYPT09MCl7aWYoXyl0aHJvdyJpbnRlZ3JpdHkgaXNzdWUiO2lmKGUuY291bnRlci51bmNvbXByZXNzZWQrKyxlLnB0cis9TCxUPVYqZCp1LFM9YS5ieXRlTGVuZ3RoLWUucHRyLFQ9VDxTP1Q6UyxDPW5ldyBBcnJheUJ1ZmZlcihUJXU9PT0wP1Q6VCt1LVQldSksUj1uZXcgVWludDhBcnJheShDKSxSLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLFQpKSxPPW5ldyByKEMpLEI9MCxFKWZvcihsPTA7bDxWO2wrKyl7Zm9yKGY9MDtmPGQ7ZisrKUVbdl0mJihZW3ZdPU9bQisrXSksdisrO3YrPUR9ZWxzZSBmb3IobD0wO2w8VjtsKyspe2ZvcihmPTA7ZjxkO2YrKylZW3YrK109T1tCKytdO3YrPUR9ZS5wdHIrPUIqdX1lbHNlIGlmKEs9cC5nZXREYXRhVHlwZVVzZWQoXyYmYzw2PzQ6Yyx6KSxRPXAuZ2V0T25lUGl4ZWwoYixMLEssRiksTCs9cC5nZXREYXRhVHlwZVNpemUoSyksWD09PTMpaWYoZS5wdHIrPUwsZS5jb3VudGVyLmNvbnN0YW50b2Zmc2V0KyssRSlmb3IobD0wO2w8VjtsKyspe2ZvcihmPTA7ZjxkO2YrKylFW3ZdJiYoWVt2XT1fP01hdGgubWluKFcsSFt2XStRKTpRKSx2Kys7dis9RH1lbHNlIGZvcihsPTA7bDxWO2wrKyl7Zm9yKGY9MDtmPGQ7ZisrKVlbdl09Xz9NYXRoLm1pbihXLEhbdl0rUSk6USx2Kys7dis9RH1lbHNlIGlmKGUucHRyKz1MLHAuZGVjb2RlQml0cyhhLGUsRyxRLCQpLEw9MCxfKWlmKEUpZm9yKGw9MDtsPFY7bCsrKXtmb3IoZj0wO2Y8ZDtmKyspRVt2XSYmKFlbdl09R1tMKytdK0hbdl0pLHYrKzt2Kz1EfWVsc2UgZm9yKGw9MDtsPFY7bCsrKXtmb3IoZj0wO2Y8ZDtmKyspWVt2XT1HW0wrK10rSFt2XSx2Kys7dis9RH1lbHNlIGlmKEUpZm9yKGw9MDtsPFY7bCsrKXtmb3IoZj0wO2Y8ZDtmKyspRVt2XSYmKFlbdl09R1tMKytdKSx2Kys7dis9RH1lbHNlIGZvcihsPTA7bDxWO2wrKyl7Zm9yKGY9MDtmPGQ7ZisrKVlbdisrXT1HW0wrK107dis9RH19Sj4xJiYhcyYmKGUucGl4ZWxzLnJlc3VsdFBpeGVscz1wLnN3YXBEaW1lbnNpb25PcmRlcihlLnBpeGVscy5yZXN1bHRQaXhlbHMsaSxKLHIpKX0sZm9ybWF0RmlsZUluZm86ZnVuY3Rpb24oYSl7cmV0dXJue2ZpbGVJZGVudGlmaWVyU3RyaW5nOmEuaGVhZGVySW5mby5maWxlSWRlbnRpZmllclN0cmluZyxmaWxlVmVyc2lvbjphLmhlYWRlckluZm8uZmlsZVZlcnNpb24saW1hZ2VUeXBlOmEuaGVhZGVySW5mby5pbWFnZVR5cGUsaGVpZ2h0OmEuaGVhZGVySW5mby5oZWlnaHQsd2lkdGg6YS5oZWFkZXJJbmZvLndpZHRoLG51bVZhbGlkUGl4ZWw6YS5oZWFkZXJJbmZvLm51bVZhbGlkUGl4ZWwsbWljcm9CbG9ja1NpemU6YS5oZWFkZXJJbmZvLm1pY3JvQmxvY2tTaXplLGJsb2JTaXplOmEuaGVhZGVySW5mby5ibG9iU2l6ZSxtYXhaRXJyb3I6YS5oZWFkZXJJbmZvLm1heFpFcnJvcixwaXhlbFR5cGU6cC5nZXRQaXhlbFR5cGUoYS5oZWFkZXJJbmZvLmltYWdlVHlwZSksZW9mT2Zmc2V0OmEuZW9mT2Zmc2V0LG1hc2s6YS5tYXNrP3tudW1CeXRlczphLm1hc2subnVtQnl0ZXN9Om51bGwscGl4ZWxzOntudW1CbG9ja3NYOmEucGl4ZWxzLm51bUJsb2Nrc1gsbnVtQmxvY2tzWTphLnBpeGVscy5udW1CbG9ja3NZLG1heFZhbHVlOmEuaGVhZGVySW5mby56TWF4LG1pblZhbHVlOmEuaGVhZGVySW5mby56TWluLG5vRGF0YVZhbHVlOmEubm9EYXRhVmFsdWV9fX0sY29uc3RydWN0Q29uc3RhbnRTdXJmYWNlOmZ1bmN0aW9uKGEsZSl7dmFyIHI9YS5oZWFkZXJJbmZvLnpNYXgscz1hLmhlYWRlckluZm8uek1pbix0PWEuaGVhZGVySW5mby5tYXhWYWx1ZXMsbj1hLmhlYWRlckluZm8ubnVtRGltcyxoPWEuaGVhZGVySW5mby5oZWlnaHQqYS5oZWFkZXJJbmZvLndpZHRoLGk9MCxvPTAsYz0wLHU9YS5waXhlbHMucmVzdWx0TWFzayxtPWEucGl4ZWxzLnJlc3VsdFBpeGVscztpZih1KWlmKG4+MSl7aWYoZSlmb3IoaT0wO2k8bjtpKyspZm9yKGM9aSpoLHI9dFtpXSxvPTA7bzxoO28rKyl1W29dJiYobVtjK29dPXIpO2Vsc2UgZm9yKG89MDtvPGg7bysrKWlmKHVbb10pZm9yKGM9bypuLGk9MDtpPG47aSsrKW1bYytuXT10W2ldfWVsc2UgZm9yKG89MDtvPGg7bysrKXVbb10mJihtW29dPXIpO2Vsc2UgaWYobj4xJiZzIT09cilpZihlKWZvcihpPTA7aTxuO2krKylmb3IoYz1pKmgscj10W2ldLG89MDtvPGg7bysrKW1bYytvXT1yO2Vsc2UgZm9yKG89MDtvPGg7bysrKWZvcihjPW8qbixpPTA7aTxuO2krKyltW2MraV09dFtpXTtlbHNlIGZvcihvPTA7bzxoKm47bysrKW1bb109cn0sZ2V0RGF0YVR5cGVBcnJheTpmdW5jdGlvbihhKXt2YXIgZTtzd2l0Y2goYSl7Y2FzZSAwOmU9SW50OEFycmF5O2JyZWFrO2Nhc2UgMTplPVVpbnQ4QXJyYXk7YnJlYWs7Y2FzZSAyOmU9SW50MTZBcnJheTticmVhaztjYXNlIDM6ZT1VaW50MTZBcnJheTticmVhaztjYXNlIDQ6ZT1JbnQzMkFycmF5O2JyZWFrO2Nhc2UgNTplPVVpbnQzMkFycmF5O2JyZWFrO2Nhc2UgNjplPUZsb2F0MzJBcnJheTticmVhaztjYXNlIDc6ZT1GbG9hdDY0QXJyYXk7YnJlYWs7ZGVmYXVsdDplPUZsb2F0MzJBcnJheX1yZXR1cm4gZX0sZ2V0UGl4ZWxUeXBlOmZ1bmN0aW9uKGEpe3ZhciBlO3N3aXRjaChhKXtjYXNlIDA6ZT0iUzgiO2JyZWFrO2Nhc2UgMTplPSJVOCI7YnJlYWs7Y2FzZSAyOmU9IlMxNiI7YnJlYWs7Y2FzZSAzOmU9IlUxNiI7YnJlYWs7Y2FzZSA0OmU9IlMzMiI7YnJlYWs7Y2FzZSA1OmU9IlUzMiI7YnJlYWs7Y2FzZSA2OmU9IkYzMiI7YnJlYWs7Y2FzZSA3OmU9IkY2NCI7YnJlYWs7ZGVmYXVsdDplPSJGMzIifXJldHVybiBlfSxpc1ZhbGlkUGl4ZWxWYWx1ZTpmdW5jdGlvbihhLGUpe2lmKGU9PW51bGwpcmV0dXJuITE7dmFyIHI7c3dpdGNoKGEpe2Nhc2UgMDpyPWU+PS0xMjgmJmU8PTEyNzticmVhaztjYXNlIDE6cj1lPj0wJiZlPD0yNTU7YnJlYWs7Y2FzZSAyOnI9ZT49LTMyNzY4JiZlPD0zMjc2NzticmVhaztjYXNlIDM6cj1lPj0wJiZlPD02NTUzNjticmVhaztjYXNlIDQ6cj1lPj0tMjE0NzQ4MzY0OCYmZTw9MjE0NzQ4MzY0NzticmVhaztjYXNlIDU6cj1lPj0wJiZlPD00Mjk0OTY3Mjk2O2JyZWFrO2Nhc2UgNjpyPWU+PS0zNDAyNzk5OTM4NzkwMTQ4NGUyMiYmZTw9MzQwMjc5OTkzODc5MDE0ODRlMjI7YnJlYWs7Y2FzZSA3OnI9ZT49LTE3OTc2OTMxMzQ4NjIzMTU3ZTI5MiYmZTw9MTc5NzY5MzEzNDg2MjMxNTdlMjkyO2JyZWFrO2RlZmF1bHQ6cj0hMX1yZXR1cm4gcn0sZ2V0RGF0YVR5cGVTaXplOmZ1bmN0aW9uKGEpe3ZhciBlPTA7c3dpdGNoKGEpe2Nhc2UgMDpjYXNlIDE6ZT0xO2JyZWFrO2Nhc2UgMjpjYXNlIDM6ZT0yO2JyZWFrO2Nhc2UgNDpjYXNlIDU6Y2FzZSA2OmU9NDticmVhaztjYXNlIDc6ZT04O2JyZWFrO2RlZmF1bHQ6ZT1hfXJldHVybiBlfSxnZXREYXRhVHlwZVVzZWQ6ZnVuY3Rpb24oYSxlKXt2YXIgcj1hO3N3aXRjaChhKXtjYXNlIDI6Y2FzZSA0OnI9YS1lO2JyZWFrO2Nhc2UgMzpjYXNlIDU6cj1hLTIqZTticmVhaztjYXNlIDY6ZT09PTA/cj1hOmU9PT0xP3I9MjpyPTE7YnJlYWs7Y2FzZSA3OmU9PT0wP3I9YTpyPWEtMiplKzE7YnJlYWs7ZGVmYXVsdDpyPWE7YnJlYWt9cmV0dXJuIHJ9LGdldE9uZVBpeGVsOmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0PTA7c3dpdGNoKHIpe2Nhc2UgMDp0PXMuZ2V0SW50OChlKTticmVhaztjYXNlIDE6dD1zLmdldFVpbnQ4KGUpO2JyZWFrO2Nhc2UgMjp0PXMuZ2V0SW50MTYoZSwhMCk7YnJlYWs7Y2FzZSAzOnQ9cy5nZXRVaW50MTYoZSwhMCk7YnJlYWs7Y2FzZSA0OnQ9cy5nZXRJbnQzMihlLCEwKTticmVhaztjYXNlIDU6dD1zLmdldFVJbnQzMihlLCEwKTticmVhaztjYXNlIDY6dD1zLmdldEZsb2F0MzIoZSwhMCk7YnJlYWs7Y2FzZSA3OnQ9cy5nZXRGbG9hdDY0KGUsITApO2JyZWFrO2RlZmF1bHQ6dGhyb3cidGhlIGRlY29kZXIgZG9lcyBub3QgdW5kZXJzdGFuZCB0aGlzIHBpeGVsIHR5cGUifXJldHVybiB0fSxzd2FwRGltZW5zaW9uT3JkZXI6ZnVuY3Rpb24oYSxlLHIscyx0KXt2YXIgbj0wLGg9MCxpPTAsbz0wLGM9YTtpZihyPjEpaWYoYz1uZXcgcyhlKnIpLHQpZm9yKG49MDtuPGU7bisrKWZvcihvPW4saT0wO2k8cjtpKyssbys9ZSljW29dPWFbaCsrXTtlbHNlIGZvcihuPTA7bjxlO24rKylmb3Iobz1uLGk9MDtpPHI7aSsrLG8rPWUpY1toKytdPWFbb107cmV0dXJuIGN9fSxrPWZ1bmN0aW9uKGEsZSxyKXt0aGlzLnZhbD1hLHRoaXMubGVmdD1lLHRoaXMucmlnaHQ9cn0sVT17ZGVjb2RlOmZ1bmN0aW9uKGEsZSl7ZT1lfHx7fTt2YXIgcj1lLm5vRGF0YVZhbHVlLHM9MCx0PXt9O2lmKHQucHRyPWUuaW5wdXRPZmZzZXR8fDAsdC5waXhlbHM9e30sISFwLnJlYWRIZWFkZXJJbmZvKGEsdCkpe3ZhciBuPXQuaGVhZGVySW5mbyxoPW4uZmlsZVZlcnNpb24saT1wLmdldERhdGFUeXBlQXJyYXkobi5pbWFnZVR5cGUpO2lmKGg+NSl0aHJvdyJ1bnN1cHBvcnRlZCBsZXJjIHZlcnNpb24gMi4iK2g7cC5yZWFkTWFzayhhLHQpLG4ubnVtVmFsaWRQaXhlbCE9PW4ud2lkdGgqbi5oZWlnaHQmJiF0LnBpeGVscy5yZXN1bHRNYXNrJiYodC5waXhlbHMucmVzdWx0TWFzaz1lLm1hc2tEYXRhKTt2YXIgbz1uLndpZHRoKm4uaGVpZ2h0O3QucGl4ZWxzLnJlc3VsdFBpeGVscz1uZXcgaShvKm4ubnVtRGltcyksdC5jb3VudGVyPXtvbmVzd2VlcDowLHVuY29tcHJlc3NlZDowLGx1dDowLGJpdHN0dWZmZXI6MCxjb25zdGFudDowLGNvbnN0YW50b2Zmc2V0OjB9O3ZhciBjPSFlLnJldHVyblBpeGVsSW50ZXJsZWF2ZWREaW1zO2lmKG4ubnVtVmFsaWRQaXhlbCE9PTApaWYobi56TWF4PT09bi56TWluKXAuY29uc3RydWN0Q29uc3RhbnRTdXJmYWNlKHQsYyk7ZWxzZSBpZihoPj00JiZwLmNoZWNrTWluTWF4UmFuZ2VzKGEsdCkpcC5jb25zdHJ1Y3RDb25zdGFudFN1cmZhY2UodCxjKTtlbHNle3ZhciB1PW5ldyBEYXRhVmlldyhhLHQucHRyLDIpLG09dS5nZXRVaW50OCgwKTtpZih0LnB0cisrLG0pcC5yZWFkRGF0YU9uZVN3ZWVwKGEsdCxpLGMpO2Vsc2UgaWYoaD4xJiZuLmltYWdlVHlwZTw9MSYmTWF0aC5hYnMobi5tYXhaRXJyb3ItLjUpPDFlLTUpe3ZhciB3PXUuZ2V0VWludDgoMSk7aWYodC5wdHIrKyx0LmVuY29kZU1vZGU9dyx3PjJ8fGg8NCYmdz4xKXRocm93IkludmFsaWQgSHVmZm1hbiBmbGFnICIrdzt3P3AucmVhZEh1ZmZtYW4oYSx0LGksYyk6cC5yZWFkVGlsZXMoYSx0LGksYyl9ZWxzZSBwLnJlYWRUaWxlcyhhLHQsaSxjKX10LmVvZk9mZnNldD10LnB0cjt2YXIgbDtlLmlucHV0T2Zmc2V0PyhsPXQuaGVhZGVySW5mby5ibG9iU2l6ZStlLmlucHV0T2Zmc2V0LXQucHRyLE1hdGguYWJzKGwpPj0xJiYodC5lb2ZPZmZzZXQ9ZS5pbnB1dE9mZnNldCt0LmhlYWRlckluZm8uYmxvYlNpemUpKToobD10LmhlYWRlckluZm8uYmxvYlNpemUtdC5wdHIsTWF0aC5hYnMobCk+PTEmJih0LmVvZk9mZnNldD10LmhlYWRlckluZm8uYmxvYlNpemUpKTt2YXIgZj17d2lkdGg6bi53aWR0aCxoZWlnaHQ6bi5oZWlnaHQscGl4ZWxEYXRhOnQucGl4ZWxzLnJlc3VsdFBpeGVscyxtaW5WYWx1ZTpuLnpNaW4sbWF4VmFsdWU6bi56TWF4LHZhbGlkUGl4ZWxDb3VudDpuLm51bVZhbGlkUGl4ZWwsZGltQ291bnQ6bi5udW1EaW1zLGRpbVN0YXRzOnttaW5WYWx1ZXM6bi5taW5WYWx1ZXMsbWF4VmFsdWVzOm4ubWF4VmFsdWVzfSxtYXNrRGF0YTp0LnBpeGVscy5yZXN1bHRNYXNrfTtpZih0LnBpeGVscy5yZXN1bHRNYXNrJiZwLmlzVmFsaWRQaXhlbFZhbHVlKG4uaW1hZ2VUeXBlLHIpKXt2YXIgZz10LnBpeGVscy5yZXN1bHRNYXNrO2ZvcihzPTA7czxvO3MrKylnW3NdfHwoZi5waXhlbERhdGFbc109cik7Zi5ub0RhdGFWYWx1ZT1yfXJldHVybiB0Lm5vRGF0YVZhbHVlPXIsZS5yZXR1cm5GaWxlSW5mbyYmKGYuZmlsZUluZm89cC5mb3JtYXRGaWxlSW5mbyh0KSksZn19LGdldEJhbmRDb3VudDpmdW5jdGlvbihhKXt2YXIgZT0wLHI9MCxzPXt9O2ZvcihzLnB0cj0wLHMucGl4ZWxzPXt9O3I8YS5ieXRlTGVuZ3RoLTU4OylwLnJlYWRIZWFkZXJJbmZvKGEscykscis9cy5oZWFkZXJJbmZvLmJsb2JTaXplLGUrKyxzLnB0cj1yO3JldHVybiBlfX07cmV0dXJuIFV9KCk7dmFyIG5lPWZ1bmN0aW9uKCl7dmFyIEE9bmV3IEFycmF5QnVmZmVyKDQpLHA9bmV3IFVpbnQ4QXJyYXkoQSksaz1uZXcgVWludDMyQXJyYXkoQSk7cmV0dXJuIGtbMF09MSxwWzBdPT09MX0oKSxpZT17ZGVjb2RlOmZ1bmN0aW9uKEEscCl7aWYoIW5lKXRocm93IkJpZyBlbmRpYW4gc3lzdGVtIGlzIG5vdCBzdXBwb3J0ZWQuIjtwPXB8fHt9O3ZhciBrPXAuaW5wdXRPZmZzZXR8fDAsVT1uZXcgVWludDhBcnJheShBLGssMTApLGE9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLFUpLGUscjtpZihhLnRyaW0oKT09PSJDbnRaSW1hZ2UiKWU9ZWUscj0xO2Vsc2UgaWYoYS5zdWJzdHJpbmcoMCw1KT09PSJMZXJjMiIpZT1yZSxyPTI7ZWxzZSB0aHJvdyJVbmV4cGVjdGVkIGZpbGUgaWRlbnRpZmllciBzdHJpbmc6ICIrYTtmb3IodmFyIHM9MCx0PUEuYnl0ZUxlbmd0aC0xMCxuLGg9W10saSxvLGM9e3dpZHRoOjAsaGVpZ2h0OjAscGl4ZWxzOltdLHBpeGVsVHlwZTpwLnBpeGVsVHlwZSxtYXNrOm51bGwsc3RhdGlzdGljczpbXX0sdT0wO2s8dDspe3ZhciBtPWUuZGVjb2RlKEEse2lucHV0T2Zmc2V0OmssZW5jb2RlZE1hc2tEYXRhOm4sbWFza0RhdGE6byxyZXR1cm5NYXNrOnM9PT0wLHJldHVybkVuY29kZWRNYXNrOnM9PT0wLHJldHVybkZpbGVJbmZvOiEwLHJldHVyblBpeGVsSW50ZXJsZWF2ZWREaW1zOnAucmV0dXJuUGl4ZWxJbnRlcmxlYXZlZERpbXMscGl4ZWxUeXBlOnAucGl4ZWxUeXBlfHxudWxsLG5vRGF0YVZhbHVlOnAubm9EYXRhVmFsdWV8fG51bGx9KTtrPW0uZmlsZUluZm8uZW9mT2Zmc2V0LG89bS5tYXNrRGF0YSxzPT09MCYmKG49bS5lbmNvZGVkTWFza0RhdGEsYy53aWR0aD1tLndpZHRoLGMuaGVpZ2h0PW0uaGVpZ2h0LGMuZGltQ291bnQ9bS5kaW1Db3VudHx8MSxjLnBpeGVsVHlwZT1tLnBpeGVsVHlwZXx8bS5maWxlSW5mby5waXhlbFR5cGUsYy5tYXNrPW8pLHI+MSYmKG8mJmgucHVzaChvKSxtLmZpbGVJbmZvLm1hc2smJm0uZmlsZUluZm8ubWFzay5udW1CeXRlcz4wJiZ1KyspLHMrKyxjLnBpeGVscy5wdXNoKG0ucGl4ZWxEYXRhKSxjLnN0YXRpc3RpY3MucHVzaCh7bWluVmFsdWU6bS5taW5WYWx1ZSxtYXhWYWx1ZTptLm1heFZhbHVlLG5vRGF0YVZhbHVlOm0ubm9EYXRhVmFsdWUsZGltU3RhdHM6bS5kaW1TdGF0c30pfXZhciB3LGwsZjtpZihyPjEmJnU+MSl7Zm9yKGY9Yy53aWR0aCpjLmhlaWdodCxjLmJhbmRNYXNrcz1oLG89bmV3IFVpbnQ4QXJyYXkoZiksby5zZXQoaFswXSksdz0xO3c8aC5sZW5ndGg7dysrKWZvcihpPWhbd10sbD0wO2w8ZjtsKyspb1tsXT1vW2xdJmlbbF07Yy5tYXNrRGF0YT1vfXJldHVybiBjfX07Y29uc3QgdGU9ezA6N2UzLDE6NmUzLDI6NWUzLDM6NGUzLDQ6M2UzLDU6MjUwMCw2OjJlMyw3OjE1MDAsODo4MDAsOTo1MDAsMTA6MjAwLDExOjEwMCwxMjo0MCwxMzoxMiwxNDo1LDE1OjIsMTY6MSwxNzouNSwxODouMiwxOTouMSwyMDouMDF9O2Z1bmN0aW9uIGFlKEEpe2NvbnN0e2hlaWdodDpwLHdpZHRoOmsscGl4ZWxzOlV9PWllLmRlY29kZShBKSxhPW5ldyBGbG9hdDMyQXJyYXkocCprKTtmb3IobGV0IGU9MDtlPGEubGVuZ3RoO2UrKylhW2VdPVVbMF1bZV07cmV0dXJue2FycmF5OmEsd2lkdGg6ayxoZWlnaHQ6cH19ZnVuY3Rpb24gc2UoQSxwLGspe2xldCBVPWFlKEEpO2tbMl0ta1swXTwxJiYoVT1mZShVLGspKTtjb25zdHthcnJheTphLHdpZHRoOmV9PVUscz1uZXcgWihlKS5jcmVhdGVUaWxlKGEpLHQ9dGVbcF18fDA7cmV0dXJuIHMuZ2V0R2VvbWV0cnlEYXRhKHQpfWZ1bmN0aW9uIGZlKEEscCl7ZnVuY3Rpb24gayhzLHQsbixoLGksbyxjLHUpe2NvbnN0IG09bmV3IEZsb2F0MzJBcnJheShpKm8pO2ZvcihsZXQgbD0wO2w8bztsKyspZm9yKGxldCBmPTA7ZjxpO2YrKyl7Y29uc3QgZz0obCtoKSp0KyhmK24pLE09bCppK2Y7bVtNXT1zW2ddfWNvbnN0IHc9bmV3IEZsb2F0MzJBcnJheSh1KmMpO2ZvcihsZXQgbD0wO2w8dTtsKyspZm9yKGxldCBmPTA7ZjxjO2YrKyl7Y29uc3QgZz1sKnUrZixNPU1hdGgucm91bmQoZipvL3UpLGQ9TWF0aC5yb3VuZChsKmkvYykqaStNO3dbZ109bVtkXX1yZXR1cm4gd31jb25zdCBVPW9lKHAsQS53aWR0aCksYT1VLnN3KzEsZT1VLnNoKzE7cmV0dXJue2FycmF5OmsoQS5hcnJheSxBLndpZHRoLFUuc3gsVS5zeSxVLnN3LFUuc2gsYSxlKSx3aWR0aDphLGhlaWdodDplfX1mdW5jdGlvbiBvZShBLHApe2NvbnN0IGs9TWF0aC5mbG9vcihBWzBdKnApLFU9TWF0aC5mbG9vcihBWzFdKnApLGE9TWF0aC5mbG9vcigoQVsyXS1BWzBdKSpwKSxlPU1hdGguZmxvb3IoKEFbM10tQVsxXSkqcCk7cmV0dXJue3N4Omssc3k6VSxzdzphLHNoOmV9fXNlbGYub25tZXNzYWdlPUE9Pntjb25zdCBwPUEuZGF0YSxrPXNlKHAuZGVtRGF0YSxwLnoscC5jbGlwQm91bmRzKTtzZWxmLnBvc3RNZXNzYWdlKGspfX0pKCk7Cg==",p1=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),st=typeof self<"u"&&self.Blob&&new Blob([p1(Lt)],{type:"text/javascript;charset=utf-8"});function f1(e){let t;try{if(t=st&&(self.URL||self.webkitURL).createObjectURL(st),!t)throw"";const r=new Worker(t,{name:e?.name});return r.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),r}catch{return new Worker("data:text/javascript;base64,"+Lt,{name:e?.name})}finally{t&&(self.URL||self.webkitURL).revokeObjectURL(t)}}const W1=5;class L1 extends yt{constructor(){super(),C(this,"info",{version:I0,description:"Tile LERC terrain loader. It can load ArcGis-lerc format terrain data."}),C(this,"dataType","lerc"),C(this,"fileLoader",new Bt(y0.manager)),C(this,"_workerPool",new Wt(0)),this.fileLoader.setResponseType("arraybuffer"),this._workerPool.setWorkerCreator(()=>new f1)}async doLoad(t,r){this._workerPool.pool===0&&this._workerPool.setWorkerLimit(W1);const{z:s,clipBounds:o}=r,n={demData:await this.fileLoader.loadAsync(t),z:s,clipBounds:o},i=(await this._workerPool.postMessage(n)).data;return new S0().setData(i)}}const Vt="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGModCl7cmV0dXJuIGEodC5kYXRhKX1mdW5jdGlvbiBhKHQpe2Z1bmN0aW9uIG4oZSx1KXtjb25zdCByPXUqNCxbaSxmLGcsbF09ZS5zbGljZShyLHIrNCk7cmV0dXJuIGw9PT0wPzA6LTFlNCsoaTw8MTZ8Zjw8OHxnKSouMX1jb25zdCBvPXQubGVuZ3RoPj4+MixzPW5ldyBGbG9hdDMyQXJyYXkobyk7Zm9yKGxldCBlPTA7ZTxvO2UrKylzW2VdPW4odCxlKTtyZXR1cm4gc31zZWxmLm9ubWVzc2FnZT10PT57Y29uc3Qgbj1jKHQuZGF0YS5pbWdEYXRhKTtzZWxmLnBvc3RNZXNzYWdlKG4pfX0pKCk7Cg==",V1=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),ot=typeof self<"u"&&self.Blob&&new Blob([V1(Vt)],{type:"text/javascript;charset=utf-8"});function G1(e){let t;try{if(t=ot&&(self.URL||self.webkitURL).createObjectURL(ot),!t)throw"";const r=new Worker(t,{name:e?.name});return r.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),r}catch{return new Worker("data:text/javascript;base64,"+Vt,{name:e?.name})}finally{t&&(self.URL||self.webkitURL).revokeObjectURL(t)}}const x1=10;class v1 extends yt{constructor(){super(),C(this,"info",{version:I0,description:"Mapbox-RGB terrain loader, It can load Mapbox-RGB terrain data."}),C(this,"dataType","terrain-rgb"),C(this,"imageLoader",new ut(y0.manager)),C(this,"_workerPool",new Wt(0)),this._workerPool.setWorkerCreator(()=>new G1)}async doLoad(t,r){const s=await this.imageLoader.loadAsync(t),{clipBounds:o,z:n}=r,i=Qt.clamp((n+2)*3,2,64),a=g1(s,o,i);let Z;this._workerPool.pool===0&&this._workerPool.setWorkerLimit(x1),Z=(await this._workerPool.postMessage({imgData:a},[a.data.buffer])).data;const m=new S0;return m.setData(Z),m}}function g1(e,t,r){const s=bt(t,e.width);r=Math.min(r,s.sw);const o=new OffscreenCanvas(r,r).getContext("2d");return o.imageSmoothingEnabled=!1,o.drawImage(e,s.sx,s.sy,s.sw,s.sh,0,0,r,r),o.getImageData(0,0,r,r)}class D0{constructor(t){C(this,"dataType","image"),C(this,"attribution","ThreeTile"),C(this,"minLevel",0),C(this,"maxLevel",18),C(this,"projectionID","3857"),C(this,"url",""),C(this,"subdomains",[]),C(this,"opacity",1),C(this,"transparent",!0),C(this,"isTMS",!1),C(this,"bounds"),C(this,"_projectionBounds",[-1/0,-1/0,1/0,1/0]),Object.assign(this,t)}_getBBox(t,r,s){const o=Math.PI*6378137,n=2*o/Math.pow(2,s),i=-o+t*n,a=o-(r+1)*n,Z=-o+(t+1)*n,m=o-r*n;return`${i},${a},${Z},${m}`}getUrl(t,r,s,o){const n=this.subdomains.length;let i;if(n>0){const m=Math.floor(Math.random()*n);i=this.subdomains[m]}const a=this._getBBox(t,r,s);r=this.isTMS?Math.pow(2,s)-1-r:r;const Z={...this,x:t,y:r,z:s,s:i,bbox:a,...o};return w1(this.url,Z)}static create(t){return new D0(t)}}function w1(e,t){const r=/\{ *([\w_-]+) *\}/g;return e.replace(r,(s,o)=>{const n=t[o]??(()=>{throw new Error(`source url template error, No value provided for variable: ${s}`)})();return typeof n=="function"?n(t):n})}let Gt=class{constructor(t=0){C(this,"_lon0",0),this._lon0=t}get lon0(){return this._lon0}getTileXWithCenterLon(t,r){const s=Math.pow(2,r);let o=t+Math.round(s/360*this._lon0);return o>=s?o-=s:o<0&&(o+=s),o}getProjBoundsFromLonLat(t){const r=t[2]-t[0]>180,s=this.project(t[0]+(r?this._lon0:0),t[1]),o=this.project(t[2]+(r?this._lon0:0),t[3]);return[Math.min(s.x,o.x),Math.min(s.y,o.y),Math.max(s.x,o.x),Math.max(s.y,o.y)]}getProjBoundsFromXYZ(t,r,s){const o=Math.PI*6378137,n=2*o/Math.pow(2,s),i=-o+t*n,a=o-(r+1)*n,Z=-o+(t+1)*n,m=o-r*n;return[i,a,Z,m]}getLonLatBoundsFromXYZ(t,r,s){const o=this.getProjBoundsFromXYZ(t,r,s),n=this.unProject(o[0],o[1]),i=this.unProject(o[2],o[3]);return[n.lon,n.lat,i.lon,i.lat]}};const P0=6378137;class xt extends Gt{constructor(){super(...arguments),C(this,"ID","3857"),C(this,"mapWidth",2*Math.PI*P0),C(this,"mapHeight",this.mapWidth),C(this,"mapDepth",1)}project(t,r){const s=(t-this.lon0)*(Math.PI/180),o=r*(Math.PI/180),n=P0*s,i=P0*Math.log(Math.tan(Math.PI/4+o/2));return{x:n,y:i}}unProject(t,r){let s=t/P0*(180/Math.PI)+this.lon0;return s>180&&(s-=360),{lat:(2*Math.atan(Math.exp(r/P0))-Math.PI/2)*(180/Math.PI),lon:s}}}class X1 extends Gt{constructor(){super(...arguments),C(this,"ID","4326"),C(this,"mapWidth",36e3*1e3),C(this,"mapHeight",18e3*1e3),C(this,"mapDepth",1)}project(t,r){return{x:(t-this.lon0)*100*1e3,y:r*100*1e3}}unProject(t,r){return{lon:t/(100*1e3)+this.lon0,lat:r/(100*1e3)}}}const it={createFromID:(e="3857",t)=>{let r;switch(e){case"3857":r=new xt(t);break;case"4326":r=new X1(t);break;default:throw new Error(`Projection ID: ${e} is not supported.`)}return r}};class Y1 extends Z1{constructor(){super(...arguments),C(this,"_projection",new xt(0))}get imgSource(){return super.imgSource}set imgSource(t){super.imgSource=t,this._updateImgProjBounds()}get demSource(){return super.demSource}set demSource(t){super.demSource=t,this._updateDemPrjBounds()}_updateImgProjBounds(){const t=this._projection;this.imgSource.forEach(r=>{r._projectionBounds=t.getProjBoundsFromLonLat(r.bounds||this.bounds)})}_updateDemPrjBounds(){const t=this._projection;this.demSource&&(this.demSource._projectionBounds=t.getProjBoundsFromLonLat(this.demSource.bounds||this.bounds))}get projection(){return this._projection}set projection(t){this._projection=t,this._updateImgProjBounds(),this._updateDemPrjBounds()}async load(t,r){const{x:s,y:o,z:n,bounds:i,lonLatBounds:a}=this.getTileCoords(t);return super.load({x:s,y:o,z:n,bounds:i,lonLatBounds:a},r)}update(t,r){const{x:s,y:o,z:n,bounds:i,lonLatBounds:a}=this.getTileCoords(t);super.update({x:s,y:o,z:n,bounds:i,lonLatBounds:a},r)}getTileCoords(t){if(!this._projection)throw new Error("projection is undefined");const{x:r,y:s,z:o}=t,n=this._projection.getTileXWithCenterLon(r,o),i=this._projection.getProjBoundsFromXYZ(r,s,o),a=this._projection.getLonLatBoundsFromXYZ(r,s,o);return{x:n,y:s,z:o,bounds:i,lonLatBounds:a}}}const H0=new At,T1=new L0(0,-1,0),at=new L0;function vt(e,t){const r=t.intersectObject(e.rootTile,!0);if(r.length>0){const s=r[0];console.assert(s.object.visible);const o=e.worldToLocal(s.point.clone()),n=e.map2geo(o);return Object.assign(s,{location:n})}}function nt(e,t){return at.set(t.x,1e4,t.z),H0.set(at,T1),vt(e,H0)}function M1(e,t,r){return H0.setFromCamera(r,e),vt(t,H0)}function P1(e){const t=e.loader.manager,r=(s,o)=>{e.dispatchEvent({type:s,...o})};t.onStart=(s,o,n)=>{r("loading-start",{url:s,itemsLoaded:o,itemsTotal:n})},t.onError=s=>{r("loading-error",{url:s})},t.onLoad=()=>{r("loading-complete")},t.onProgress=(s,o,n)=>{r("loading-progress",{url:s,itemsLoaded:o,itemsTotal:n})},t.onParseEnd=s=>{r("parsing-end",{geometry:s})},e.rootTile.addEventListener("tile-created",s=>{r("tile-created",{tile:s.tile})}),e.rootTile.addEventListener("tile-loaded",s=>{r("tile-loaded",{tile:s.tile})}),e.rootTile.addEventListener("tile-unload",s=>{r("tile-unload",{tile:s.tile})}),e.rootTile.addEventListener("tile-visible-changed",s=>{r("tile-visible-changed",{tile:s.tile})})}class gt extends ct{constructor(t){super(),C(this,"name","map"),C(this,"debug",0),C(this,"_mapClock",new Ot),C(this,"isLOD",!0),C(this,"autoUpdate",!0),C(this,"updateInterval",100),C(this,"rootTile"),C(this,"loader"),C(this,"_minLevel",2),C(this,"_maxLevel",20),C(this,"_LODThreshold",1),this.up.set(0,0,1);const{loader:r=new Y1,rootTile:s=new X0,minLevel:o=2,imgSource:n,demSource:i,bounds:a,lon0:Z=0,debug:m=0}=t;this.minLevel=o,this.loader=r,this.rootTile=s,a&&(this.loader.bounds=a),this.debug=this.loader.debug=m,this.lon0=Z,this.imgSource=n,this.demSource=i,this.add(s),this._resize(),P1(this);const G=()=>{this.dispatchEvent({type:"ready"}),this.removeEventListener("loading-complete",G)};this.addEventListener("loading-complete",G)}get minLevel(){return this._minLevel}set minLevel(t){this._minLevel=t}get maxLevel(){return this._maxLevel}set maxLevel(t){this._maxLevel=t}get lon0(){return this.projection.lon0}set lon0(t){this.projection.lon0!==t&&(t!=0&&this.minLevel<1&&console.warn(`Map centralMeridian is ${this.lon0}, minLevel must > 0`),this.projection=it.createFromID(this.projection.ID,t),this._updateSource())}get projection(){return this.loader.projection}set projection(t){(t.ID!=this.projection.ID||t.lon0!=this.lon0)&&(this.loader.projection=t,this._resize(),this.reload(),this.debug>0&&console.log("Map Projection Changed:",t.ID,t.lon0),this.dispatchEvent({type:"projection-changed",projection:t}))}get imgSource(){return this.loader.imgSource}set imgSource(t){const r=Array.isArray(t)?t:[t];if(r.length===0)throw new Error("imgSource can not be empty");this.loader.imgSource=r,this.projection=it.createFromID(r[0].projectionID,this.projection.lon0),this.debug>0&&console.log("Img Source Changed:",r),this._updateSource(),this.dispatchEvent({type:"source-changed",source:t})}get demSource(){return this.loader.demSource}set demSource(t){this.loader.demSource!==t&&(this.loader.demSource=t,this.debug>0&&console.log("DEM Source Changed:",this.demSource),this._updateSource(),this.dispatchEvent({type:"source-changed",source:t}))}get LODThreshold(){return this._LODThreshold}set LODThreshold(t){this._LODThreshold=t}get bounds(){return this.loader.bounds}set bounds(t){this.loader.bounds=t}get maxThreads(){return this.loader.maxThreads}set maxThreads(t){this.loader.maxThreads=t}get backgroundColor(){return 0}set backgroundColor(t){}static create(t){return new gt(t)}_resize(){return this.rootTile.scale.set(this.projection.mapWidth,this.projection.mapHeight,this.projection.mapDepth),this.rootTile.updateMatrix(),this.rootTile.updateMatrixWorld(),this}_getMaxLevel(){let t=0;return this.imgSource.forEach(r=>t=Math.max(t,r.maxLevel)),this.demSource&&(t=Math.max(t,this.demSource.maxLevel)),this.debug&&console.log("Max Level:",t),t}update(t){const r=this._mapClock.getElapsedTime();r>this.updateInterval/1e3&&(this.rootTile.update({camera:t,loader:this.loader,minLevel:this.minLevel,maxLevel:this.maxLevel,LODThreshold:this.LODThreshold}),this.rootTile.castShadow=this.castShadow,this.rootTile.receiveShadow=this.receiveShadow,this.dispatchEvent({type:"update",delta:r}),this._mapClock.start())}_updateSource(){this._maxLevel=this._getMaxLevel(),this.rootTile.reload(this.loader,!1)}reload(t=!0){this.rootTile.reload(this.loader,t)}dispose(){this.removeFromParent(),this.reload()}geo2pos(t){return this.geo2map(t)}geo2map(t){const r=this.projection.project(t.x,t.y);return new L0(r.x,r.y,t.z)}geo2world(t){return this.localToWorld(this.geo2map(t))}pos2geo(t){return this.map2geo(t)}map2geo(t){const r=this.projection.unProject(t.x,t.y);return new L0(r.lon,r.lat,t.z)}world2geo(t){return this.pos2geo(this.worldToLocal(t.clone()))}getLocalInfoFromGeo(t){const r=this.geo2world(t);return nt(this,r)}getLocalInfoFromWorld(t){return nt(this,t)}getLocalInfoFromScreen(t,r){return M1(t,this,r)}get downloading(){return this.loader.downloadingThreads}getTileCount(){let t=0,r=0,s=0,o=0,n=0,i=0;return this.rootTile.traverse(a=>{a instanceof X0&&(t++,a.isLeaf&&(n++,a.showing&&r++,a.inFrustum&&s++),o=Math.max(o,a.z),i=this.loader.downloadingThreads)}),{total:t,leaf:n,visible:r,inFrustum:s,maxLevel:o,downloading:i}}}function wt(e){return y0.registerMaterialLoader(e),e}function lt(e){return y0.registerGeometryLoader(e),e}function K1(){wt(new ft),lt(new v1),lt(new L1)}K1();var S1=Object.defineProperty,I1=(e,t,r)=>t in e?S1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,W0=(e,t,r)=>I1(e,typeof t!="symbol"?t+"":t,r);const{EventDispatcher:le,Clock:de,Scene:ce,Color:he,FogExp2:ue,WebGLRenderer:me,PerspectiveCamera:be,AmbientLight:Ze,DirectionalLight:ye,Controls:pe,Vector3:M0,Quaternion:z1,MOUSE:fe,TOUCH:We,Spherical:Le,Vector2:Ve,Ray:F1,Plane:k1,MathUtils:U1,Euler:H1,Mesh:Ge,OrthographicCamera:R1,BufferGeometry:j1,Float32BufferAttribute:dt,ShaderMaterial:xe,UniformsUtils:ve,WebGLRenderTarget:ge,HalfFloatType:we,NoBlending:Xe,Box3:D1,Sphere:Ye,PlaneGeometry:Te,Raycaster:E1,SphereGeometry:Me,MeshLambertMaterial:Pe,MeshNormalMaterial:Ke,MeshBasicMaterial:Se,ImageLoader:Ie,Texture:ze,SRGBColorSpace:Fe,FileLoader:ke,TextureLoader:J1,CanvasTexture:Ue,UniformsLib:He,Cache:R0,Group:Re}=await j0("three");var C1=function(){return performance.now()},N1=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(r){return t._tweens[r]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},e.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},e.prototype.update=function(t,r){t===void 0&&(t=C1()),r===void 0&&(r=!1);var s=Object.keys(this._tweens);if(s.length===0)return!1;for(;s.length>0;){this._tweensAddedDuringUpdate={};for(var o=0;o<s.length;o++){var n=this._tweens[s[o]],i=!r;n&&n.update(t,i)===!1&&!r&&delete this._tweens[s[o]]}s=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),B1=new N1,G0=B1;G0.getAll.bind(G0);G0.removeAll.bind(G0);G0.add.bind(G0);G0.remove.bind(G0);G0.update.bind(G0);new z1;new F1;new k1;Math.cos(70*U1.DEG2RAD);new M0;new H1(0,0,0,"YXZ");new M0;new R1(-1,1,1,-1,0,1);class Q1 extends j1{constructor(){super(),this.setAttribute("position",new dt([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new dt([0,2,0,0,2,0],2))}}new Q1;var P={};(function(){var e=function(){function s(o){this.message="JPEG error: "+o}return s.prototype=new Error,s.prototype.name="JpegError",s.constructor=s,s}(),t=function(){var s=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,n=799,i=3406,a=2276,Z=1567,m=3784,G=5793,u=2896;function b(h){h==null&&(h={}),h.w==null&&(h.w=-1),this.V=h.n,this.N=h.w}function g(h,W){for(var p=0,l=[],L,v,x=16,S;x>0&&!h[x-1];)x--;l.push({children:[],index:0});var I=l[0];for(L=0;L<x;L++){for(v=0;v<h[L];v++){for(I=l.pop(),I.children[I.index]=W[p];I.index>0;)I=l.pop();for(I.index++,l.push(I);l.length<=L;)l.push(S={children:[],index:0}),I.children[I.index]=S.children,I=S;p++}L+1<x&&(l.push(S={children:[],index:0}),I.children[I.index]=S.children,I=S)}return l[0].children}function z(h,W,p){return 64*((h.P+1)*W+p)}function f(h,W,p,l,L,v,x,S,I,M){M==null&&(M=!1);var Y=p.m,K=p.Z,D=W,J=0,U=0,V=0,X=0,w,T=0,F,j,H,R,k,E,N=0,r0,B,s0,e0;function _(){if(U>0)return U--,J>>U&1;if(J=h[W++],J===255){var A=h[W++];if(A){if(A===220&&M){W+=2;var o0=r(h,W);if(W+=2,o0>0&&o0!==p.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",o0)}else if(A===217){if(M){var n0=T*8;if(n0>0&&n0<p.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",n0)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new e("unexpected marker")}}return U=7,J>>>7}function t0(A){for(var o0=A;;){switch(o0=o0[_()],typeof o0){case"number":return o0;case"object":continue}throw new e("invalid huffman sequence")}}function q(A){for(var o0=0;A>0;)o0=o0<<1|_(),A--;return o0}function Q(A){if(A===1)return _()===1?1:-1;var o0=q(A);return o0>=1<<A-1?o0:o0+(-1<<A)+1}function O(A,o0){var n0=t0(A.J),Z0=n0===0?0:Q(n0),l0=1;for(A.D[o0]=A.Q+=Z0;l0<64;){var m0=t0(A.i),d0=m0&15,$=m0>>4;if(d0===0){if($<15)break;l0+=16;continue}l0+=$;var b0=s[l0];A.D[o0+b0]=Q(d0),l0++}}function a0(A,o0){var n0=t0(A.J),Z0=n0===0?0:Q(n0)<<I;A.D[o0]=A.Q+=Z0}function h0(A,o0){A.D[o0]|=_()<<I}function u0(A,o0){if(V>0){V--;return}for(var n0=v,Z0=x;n0<=Z0;){var l0=t0(A.i),m0=l0&15,d0=l0>>4;if(m0===0){if(d0<15){V=q(d0)+(1<<d0)-1;break}n0+=16;continue}n0+=d0;var $=s[n0];A.D[o0+$]=Q(m0)*(1<<I),n0++}}function i0(A,o0){for(var n0=v,Z0=x,l0=0,m0,d0;n0<=Z0;){var $=o0+s[n0],b0=A.D[$]<0?-1:1;switch(X){case 0:if(d0=t0(A.i),m0=d0&15,l0=d0>>4,m0===0)l0<15?(V=q(l0)+(1<<l0),X=4):(l0=16,X=1);else{if(m0!==1)throw new e("invalid ACn encoding");w=Q(m0),X=l0?2:3}continue;case 1:case 2:A.D[$]?A.D[$]+=b0*(_()<<I):(l0--,l0===0&&(X=X===2?3:0));break;case 3:A.D[$]?A.D[$]+=b0*(_()<<I):(A.D[$]=w<<I,X=0);break;case 4:A.D[$]&&(A.D[$]+=b0*(_()<<I));break}n0++}X===4&&(V--,V===0&&(X=0))}function V0(A,o0,n0,Z0,l0){var m0=n0/Y|0,d0=n0%Y;T=m0*A.A+Z0;var $=d0*A.h+l0,b0=z(A,T,$);o0(A,b0)}function c0(A,o0,n0){T=n0/A.P|0;var Z0=n0%A.P,l0=z(A,T,Z0);o0(A,l0)}var p0=l.length;for(K?v===0?E=S===0?a0:h0:E=S===0?u0:i0:E=O,p0===1?B=l[0].P*l[0].c:B=Y*p.R;N<=B;){var f0=L?Math.min(B-N,L):B;if(f0>0){for(j=0;j<p0;j++)l[j].Q=0;if(V=0,p0===1)for(F=l[0],k=0;k<f0;k++)c0(F,E,N),N++;else for(k=0;k<f0;k++){for(j=0;j<p0;j++)for(F=l[j],s0=F.h,e0=F.A,H=0;H<e0;H++)for(R=0;R<s0;R++)V0(F,E,N,H,R);N++}}if(U=0,r0=y(h,W),!r0)break;if(r0.u&&(W=r0.offset),r0.M>=65488&&r0.M<=65495)W+=2;else break}return W-D}function d(h,W,p){var l=h.$,L=h.D,v,x,S,I,M,Y,K,D,J,U,V,X,w,T,F,j,H;if(!l)throw new e("missing required Quantization Table.");for(var R=0;R<64;R+=8){if(J=L[W+R],U=L[W+R+1],V=L[W+R+2],X=L[W+R+3],w=L[W+R+4],T=L[W+R+5],F=L[W+R+6],j=L[W+R+7],J*=l[R],!(U|V|X|w|T|F|j)){H=G*J+512>>10,p[R]=H,p[R+1]=H,p[R+2]=H,p[R+3]=H,p[R+4]=H,p[R+5]=H,p[R+6]=H,p[R+7]=H;continue}U*=l[R+1],V*=l[R+2],X*=l[R+3],w*=l[R+4],T*=l[R+5],F*=l[R+6],j*=l[R+7],v=G*J+128>>8,x=G*w+128>>8,S=V,I=F,M=u*(U-j)+128>>8,D=u*(U+j)+128>>8,Y=X<<4,K=T<<4,v=v+x+1>>1,x=v-x,H=S*m+I*Z+128>>8,S=S*Z-I*m+128>>8,I=H,M=M+K+1>>1,K=M-K,D=D+Y+1>>1,Y=D-Y,v=v+I+1>>1,I=v-I,x=x+S+1>>1,S=x-S,H=M*a+D*i+2048>>12,M=M*i-D*a+2048>>12,D=H,H=Y*n+K*o+2048>>12,Y=Y*o-K*n+2048>>12,K=H,p[R]=v+D,p[R+7]=v-D,p[R+1]=x+K,p[R+6]=x-K,p[R+2]=S+Y,p[R+5]=S-Y,p[R+3]=I+M,p[R+4]=I-M}for(var k=0;k<8;++k){if(J=p[k],U=p[k+8],V=p[k+16],X=p[k+24],w=p[k+32],T=p[k+40],F=p[k+48],j=p[k+56],!(U|V|X|w|T|F|j)){H=G*J+8192>>14,H<-2040?H=0:H>=2024?H=255:H=H+2056>>4,L[W+k]=H,L[W+k+8]=H,L[W+k+16]=H,L[W+k+24]=H,L[W+k+32]=H,L[W+k+40]=H,L[W+k+48]=H,L[W+k+56]=H;continue}v=G*J+2048>>12,x=G*w+2048>>12,S=V,I=F,M=u*(U-j)+2048>>12,D=u*(U+j)+2048>>12,Y=X,K=T,v=(v+x+1>>1)+4112,x=v-x,H=S*m+I*Z+2048>>12,S=S*Z-I*m+2048>>12,I=H,M=M+K+1>>1,K=M-K,D=D+Y+1>>1,Y=D-Y,v=v+I+1>>1,I=v-I,x=x+S+1>>1,S=x-S,H=M*a+D*i+2048>>12,M=M*i-D*a+2048>>12,D=H,H=Y*n+K*o+2048>>12,Y=Y*o-K*n+2048>>12,K=H,J=v+D,j=v-D,U=x+K,F=x-K,V=S+Y,T=S-Y,X=I+M,w=I-M,J<16?J=0:J>=4080?J=255:J>>=4,U<16?U=0:U>=4080?U=255:U>>=4,V<16?V=0:V>=4080?V=255:V>>=4,X<16?X=0:X>=4080?X=255:X>>=4,w<16?w=0:w>=4080?w=255:w>>=4,T<16?T=0:T>=4080?T=255:T>>=4,F<16?F=0:F>=4080?F=255:F>>=4,j<16?j=0:j>=4080?j=255:j>>=4,L[W+k]=J,L[W+k+8]=U,L[W+k+16]=V,L[W+k+24]=X,L[W+k+32]=w,L[W+k+40]=T,L[W+k+48]=F,L[W+k+56]=j}}function c(h,W){for(var p=W.P,l=W.c,L=new Int16Array(64),v=0;v<l;v++)for(var x=0;x<p;x++){var S=z(W,v,x);d(W,S,L)}return W.D}function y(h,W,p){p==null&&(p=W);var l=h.length-1,L=p<W?p:W;if(W>=l)return null;var v=r(h,W);if(v>=65472&&v<=65534)return{u:null,M:v,offset:W};for(var x=r(h,L);!(x>=65472&&x<=65534);){if(++L>=l)return null;x=r(h,L)}return{u:v.toString(16),M:x,offset:L}}return b.prototype={parse(h,W){W==null&&(W={});var p=W.F,l=0,L=null,v=null,x,S,I=0;function M(){var $=r(h,l);l+=2;var b0=l+$-2,x0=y(h,b0,l);x0&&x0.u&&(b0=x0.offset);var v0=h.subarray(l,b0);return l+=v0.length,v0}function Y($){for(var b0=Math.ceil($.o/8/$.X),x0=Math.ceil($.s/8/$.B),v0=0;v0<$.W.length;v0++){i0=$.W[v0];var Y0=Math.ceil(Math.ceil($.o/8)*i0.h/$.X),z0=Math.ceil(Math.ceil($.s/8)*i0.A/$.B),E0=b0*i0.h,J0=x0*i0.A,C0=64*J0*(E0+1);i0.D=new Int16Array(C0),i0.P=Y0,i0.c=z0}$.m=b0,$.R=x0}var K=[],D=[],J=[],U=r(h,l);if(l+=2,U!==65496)throw new e("SOI not found");U=r(h,l),l+=2;t:for(;U!==65497;){var V,X,w;switch(U){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var T=M();U===65504&&T[0]===74&&T[1]===70&&T[2]===73&&T[3]===70&&T[4]===0&&(L={version:{d:T[5],T:T[6]},K:T[7],j:T[8]<<8|T[9],H:T[10]<<8|T[11],S:T[12],I:T[13],C:T.subarray(14,14+3*T[12]*T[13])}),U===65518&&T[0]===65&&T[1]===100&&T[2]===111&&T[3]===98&&T[4]===101&&(v={version:T[5]<<8|T[6],k:T[7]<<8|T[8],q:T[9]<<8|T[10],a:T[11]});break;case 65499:var F=r(h,l),j;l+=2;for(var H=F+l-2;l<H;){var R=h[l++],k=new Uint16Array(64);if(R>>4)if(R>>4===1)for(X=0;X<64;X++)j=s[X],k[j]=r(h,l),l+=2;else throw new e("DQT - invalid table spec");else for(X=0;X<64;X++)j=s[X],k[j]=h[l++];K[R&15]=k}break;case 65472:case 65473:case 65474:if(x)throw new e("Only single frame JPEGs supported");l+=2,x={},x.G=U===65473,x.Z=U===65474,x.precision=h[l++];var E=r(h,l),N,r0=0,B=0;l+=2,x.s=p||E,x.o=r(h,l),l+=2,x.W=[],x._={};var s0=h[l++];for(V=0;V<s0;V++){N=h[l];var e0=h[l+1]>>4,_=h[l+1]&15;r0<e0&&(r0=e0),B<_&&(B=_);var t0=h[l+2];w=x.W.push({h:e0,A:_,L:t0,$:null}),x._[N]=w-1,l+=3}x.X=r0,x.B=B,Y(x);break;case 65476:var q=r(h,l);for(l+=2,V=2;V<q;){var Q=h[l++],O=new Uint8Array(16),a0=0;for(X=0;X<16;X++,l++)a0+=O[X]=h[l];var h0=new Uint8Array(a0);for(X=0;X<a0;X++,l++)h0[X]=h[l];V+=17+a0,(Q>>4?D:J)[Q&15]=g(O,h0)}break;case 65501:l+=2,S=r(h,l),l+=2;break;case 65498:var u0=++I===1&&!p,i0;l+=2;var V0=h[l++],c0=[];for(V=0;V<V0;V++){var p0=h[l++],f0=x._[p0];i0=x.W[f0],i0.index=p0;var A=h[l++];i0.J=J[A>>4],i0.i=D[A&15],c0.push(i0)}var o0=h[l++],n0=h[l++],Z0=h[l++];try{var l0=f(h,l,x,c0,S,o0,n0,Z0>>4,Z0&15,u0);l+=l0}catch($){if($ instanceof DNLMarkerError)return this.parse(h,{F:$.s});if($ instanceof EOIMarkerError)break t;throw $}break;case 65500:l+=4;break;case 65535:h[l]!==255&&l--;break;default:var m0=y(h,l-2,l-3);if(m0&&m0.u){l=m0.offset;break}if(l>=h.length-1)break t;throw new e("JpegImage.parse - unknown marker: "+U.toString(16))}U=r(h,l),l+=2}for(this.width=x.o,this.height=x.s,this.g=L,this.b=v,this.W=[],V=0;V<x.W.length;V++){i0=x.W[V];var d0=K[i0.L];d0&&(i0.$=d0),this.W.push({index:i0.index,e:c(x,i0),l:i0.h/x.X,t:i0.A/x.B,P:i0.P,c:i0.c})}this.p=this.W.length},Y(h,W,p){p==null&&(p=!1);var l=this.width/h,L=this.height/W,v,x,S,I,M,Y,K,D,J,U,V=0,X,w=this.W.length,T=h*W*w,F=new Uint8ClampedArray(T),j=new Uint32Array(h),H=4294967288,R;for(K=0;K<w;K++){if(v=this.W[K],x=v.l*l,S=v.t*L,V=K,X=v.e,I=v.P+1<<3,x!==R){for(M=0;M<h;M++)D=0|M*x,j[M]=(D&H)<<3|D&7;R=x}for(Y=0;Y<W;Y++)for(D=0|Y*S,U=I*(D&H)|(D&7)<<3,M=0;M<h;M++)F[V]=X[U+j[M]],V+=w}var k=this.V;if(!p&&w===4&&!k&&(k=new Int32Array([-256,255,-256,255,-256,255,-256,255])),k)for(K=0;K<T;)for(D=0,J=0;D<w;D++,K++,J+=2)F[K]=(F[K]*k[J]>>8)+k[J+1];return F},get f(){return this.b?!!this.b.a:this.p===3?this.N===0?!1:!(this.W[0].index===82&&this.W[1].index===71&&this.W[2].index===66):this.N===1},z:function(h){for(var W,p,l,L=0,v=h.length;L<v;L+=3)W=h[L],p=h[L+1],l=h[L+2],h[L]=W-179.456+1.402*l,h[L+1]=W+135.459-.344*p-.714*l,h[L+2]=W-226.816+1.772*p;return h},O:function(h){for(var W,p,l,L,v=0,x=0,S=h.length;x<S;x+=4)W=h[x],p=h[x+1],l=h[x+2],L=h[x+3],h[v++]=-122.67195406894+p*(-660635669420364e-19*p+.000437130475926232*l-54080610064599e-18*W+.00048449797120281*L-.154362151871126)+l*(-.000957964378445773*l+.000817076911346625*W-.00477271405408747*L+1.53380253221734)+W*(.000961250184130688*W-.00266257332283933*L+.48357088451265)+L*(-.000336197177618394*L+.484791561490776),h[v++]=107.268039397724+p*(219927104525741e-19*p-.000640992018297945*l+.000659397001245577*W+.000426105652938837*L-.176491792462875)+l*(-.000778269941513683*l+.00130872261408275*W+.000770482631801132*L-.151051492775562)+W*(.00126935368114843*W-.00265090189010898*L+.25802910206845)+L*(-.000318913117588328*L-.213742400323665),h[v++]=-20.810012546947+p*(-.000570115196973677*p-263409051004589e-19*l+.0020741088115012*W-.00288260236853442*L+.814272968359295)+l*(-153496057440975e-19*l-.000132689043961446*W+.000560833691242812*L-.195152027534049)+W*(.00174418132927582*W-.00255243321439347*L+.116935020465145)+L*(-.000343531996510555*L+.24165260232407);return h.subarray(0,v)},r:function(h){for(var W,p,l,L=0,v=h.length;L<v;L+=4)W=h[L],p=h[L+1],l=h[L+2],h[L]=434.456-W-1.402*l,h[L+1]=119.541-W+.344*p+.714*l,h[L+2]=481.816-W-1.772*p;return h},U:function(h){for(var W,p,l,L,v=0,x=0,S=h.length;x<S;x+=4)W=h[x],p=h[x+1],l=h[x+2],L=h[x+3],h[v++]=255+W*(-6747147073602441e-20*W+.0008379262121013727*p+.0002894718188643294*l+.003264231057537806*L-1.1185611867203937)+p*(26374107616089405e-21*p-8626949158638572e-20*l-.0002748769067499491*L-.02155688794978967)+l*(-3878099212869363e-20*l-.0003267808279485286*L+.0686742238595345)-L*(.0003361971776183937*L+.7430659151342254),h[v++]=255+W*(.00013596372813588848*W+.000924537132573585*p+.00010567359618683593*l+.0004791864687436512*L-.3109689587515875)+p*(-.00023545346108370344*p+.0002702845253534714*l+.0020200308977307156*L-.7488052167015494)+l*(6834815998235662e-20*l+.00015168452363460973*L-.09751927774728933)-L*(.0003189131175883281*L+.7364883807733168),h[v++]=255+W*(13598650411385307e-21*W+.00012423956175490851*p+.0004751985097583589*l-36729317476630422e-22*L-.05562186980264034)+p*(.00016141380598724676*p+.0009692239130725186*l+.0007782692450036253*L-.44015232367526463)+l*(5068882914068769e-22*l+.0017778369011375071*L-.7591454649749609)-L*(.0003435319965105553*L+.7063770186160144);return h.subarray(0,v)},getData:function(h){var W=h.width,p=h.height,l=h.forceRGB,L=h.isSourcePDF;if(this.p>4)throw new e("Unsupported color mode");var v=this.Y(W,p,L);if(this.p===1&&l){for(var x=v.length,S=new Uint8ClampedArray(x*3),I=0,M=0;M<x;M++){var Y=v[M];S[I++]=Y,S[I++]=Y,S[I++]=Y}return S}else{if(this.p===3&&this.f)return this.z(v);if(this.p===4){if(this.f)return l?this.O(v):this.r(v);if(l)return this.U(v)}}return v}},b}();function r(s,o){return s[o]<<8|s[o+1]}P.JpegDecoder=t})();P.encodeImage=function(e,t,r,s){var o={t256:[t],t257:[r],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[r],t279:[t*r*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(s)for(var n in s)o[n]=s[n];for(var i=new Uint8Array(P.encode([o])),a=new Uint8Array(e),Z=new Uint8Array(1e3+t*r*4),n=0;n<i.length;n++)Z[n]=i[n];for(var n=0;n<a.length;n++)Z[1e3+n]=a[n];return Z.buffer};P.encode=function(e){var t=new Uint8Array(2e4),r=4,s=P._binBE;t[0]=t[1]=77,s.writeUshort(t,2,42);var o=8;s.writeUint(t,r,o),r+=4;for(var n=0;n<e.length;n++){var i=P._writeIFD(s,P._types.basic,t,o,e[n]);o=i[1],n<e.length-1&&(o&3&&(o+=4-(o&3)),s.writeUint(t,i[0],o))}return t.slice(0,o).buffer};P.decode=function(e,t){t==null&&(t={parseMN:!0,debug:!1});var r=new Uint8Array(e),s=0,o=P._binBE.readASCII(r,s,2);s+=2;var n=o=="II"?P._binLE:P._binBE;n.readUshort(r,s),s+=2;var i=n.readUint(r,s);s+=4;for(var a=[];;){var Z=n.readUshort(r,i),m=n.readUshort(r,i+4);if(Z!=0&&(m<1||13<m)){log("error in TIFF");break}if(P._readIFD(n,r,i,a,0,t),i=n.readUint(r,i+2+Z*12),i==0)break}return a};P.decodeImage=function(e,t,r){if(!t.data){var s=new Uint8Array(e),o=P._binBE.readASCII(s,0,2);if(t.t256!=null){t.isLE=o=="II",t.width=t.t256[0],t.height=t.t257[0];var n=t.t259?t.t259[0]:1,i=t.t266?t.t266[0]:1;t.t284&&t.t284[0]==2&&log("PlanarConfiguration 2 should not be used!"),n==7&&t.t258&&t.t258.length>3&&(t.t258=t.t258.slice(0,3));var a=t.t277?t.t277[0]:1,Z=t.t258?t.t258[0]:1,m=Z*a;n==1&&t.t279!=null&&t.t278&&t.t262[0]==32803&&(m=Math.round(t.t279[0]*8/(t.width*t.t278[0]))),t.t50885&&t.t50885[0]==4&&(m=t.t258[0]*3);var G=Math.ceil(t.width*m/8)*8,u=t.t273;(u==null||t.t322)&&(u=t.t324);var b=t.t279;n==1&&u.length==1&&(b=[t.height*(G>>>3)]),(b==null||t.t322)&&(b=t.t325);var g=new Uint8Array(t.height*(G>>>3)),z=0;if(t.t322!=null){var f=t.t322[0],d=t.t323[0],c=Math.floor((t.width+f-1)/f),y=Math.floor((t.height+d-1)/d),h=new Uint8Array(Math.ceil(f*d*m/8)|0);console.log("====",c,y);for(var W=0;W<y;W++)for(var p=0;p<c;p++){var l=W*c+p;h.fill(0),P.decode._decompress(t,r,s,u[l],b[l],n,h,0,i,f,d),n==6?g=h:P._copyTile(h,Math.ceil(f*m/8)|0,d,g,Math.ceil(t.width*m/8)|0,t.height,Math.ceil(p*f*m/8)|0,W*d)}z=g.length*8}else{if(u==null)return;var L=t.t278?t.t278[0]:t.height;L=Math.min(L,t.height);for(var l=0;l<u.length;l++)P.decode._decompress(t,r,s,u[l],b[l],n,g,Math.ceil(z/8)|0,i,t.width,L),z+=G*L;z=Math.min(z,g.length*8)}t.data=new Uint8Array(g.buffer,0,Math.ceil(z/8)|0)}}};P.decode._decompress=function(e,t,r,s,o,n,i,a,Z,m,G){if(e.t271&&e.t271[0]=="Panasonic"&&e.t45&&e.t45[0]==6&&(n=34316),n==1)for(var u=0;u<o;u++)i[a+u]=r[s+u];else if(n==2)P.decode._decodeG2(r,s,o,i,a,m,Z);else if(n==3)P.decode._decodeG3(r,s,o,i,a,m,Z,e.t292?(e.t292[0]&1)==1:!1);else if(n==4)P.decode._decodeG4(r,s,o,i,a,m,Z);else if(n==5)P.decode._decodeLZW(r,s,o,i,a,8);else if(n==6)P.decode._decodeOldJPEG(e,r,s,o,i,a);else if(n==7||n==34892)P.decode._decodeNewJPEG(e,r,s,o,i,a);else if(n==8||n==32946){var b=new Uint8Array(r.buffer,s+2,o-6),g=P._inflateRaw(b);a+g.length<=i.length&&i.set(g,a)}else n==9?P.decode._decodeVC5(r,s,o,i,a,e.t33422):n==32767?P.decode._decodeARW(e,r,s,o,i,a):n==32773?P.decode._decodePackBits(r,s,o,i,a):n==32809?P.decode._decodeThunder(r,s,o,i,a):n==34316?P.decode._decodePanasonic(e,r,s,o,i,a):n==34713?P.decode._decodeNikon(e,t,r,s,o,i,a):n==34676?P.decode._decodeLogLuv32(e,r,s,o,i,a):log("Unknown compression",n);var z=e.t258?Math.min(32,e.t258[0]):1,f=e.t277?e.t277[0]:1,d=z*f>>>3,c=Math.ceil(z*f*m/8);if(z==16&&!e.isLE&&e.t33422==null)for(var y=0;y<G;y++)for(var h=a+y*c,W=1;W<c;W+=2){var p=i[h+W];i[h+W]=i[h+W-1],i[h+W-1]=p}if(e.t317&&e.t317[0]==2)for(var y=0;y<G;y++){var l=a+y*c;if(z==16)for(var u=d;u<c;u+=2){var L=(i[l+u+1]<<8|i[l+u])+(i[l+u-d+1]<<8|i[l+u-d]);i[l+u]=L&255,i[l+u+1]=L>>>8&255}else if(f==3)for(var u=3;u<c;u+=3)i[l+u]=i[l+u]+i[l+u-3]&255,i[l+u+1]=i[l+u+1]+i[l+u-2]&255,i[l+u+2]=i[l+u+2]+i[l+u-1]&255;else for(var u=d;u<c;u++)i[l+u]=i[l+u]+i[l+u-d]&255}};P.decode._decodePanasonic=function(e,t,r,s,o,n){var i=t.buffer,a=e.t2[0],Z=e.t3[0],m=e.t10[0],G=e.t45[0],u=0,b=0,g=0,z=0,f=G==6?new Uint32Array(18):new Uint8Array(16),d,c,y,h=[0,0],W=[0,0],p,l=0,L,v,x,S,I=new Uint8Array(16384),M=new Uint16Array(o.buffer);function Y(t0){if(g==0){var q=new Uint8Array(i,r+b+8184,8200),Q=new Uint8Array(i,r+b,8184);I.set(q),I.set(Q,q.length),b+=16384}if(G==5)for(d=0;d<16;d++)f[d]=I[g++],g&=16383;else return g=g-t0&131071,z=g>>3^16368,(I[z]|I[z+1]<<8)>>(g&7)&~(-1<<t0)}function K(t0){return I[g+15-t0]}function D(){f[0]=K(0)<<6|K(1)>>2,f[1]=((K(1)&3)<<12|K(2)<<4|K(3)>>4)&16383,f[2]=K(3)>>2&3,f[3]=(K(3)&3)<<8|K(4),f[4]=K(5)<<2|K(6)>>6,f[5]=(K(6)&63)<<4|K(7)>>4,f[6]=K(7)>>2&3,f[7]=(K(7)&3)<<8|K(8),f[8]=K(9)<<2&1020|K(10)>>6,f[9]=(K(10)<<4|K(11)>>4)&1023,f[10]=K(11)>>2&3,f[11]=(K(11)&3)<<8|K(12),f[12]=(K(13)<<2&1020|K(14)>>6)&1023,f[13]=(K(14)<<4|K(15)>>4)&1023,g+=16,z=0}function J(){f[0]=K(0)<<4|K(1)>>4,f[1]=((K(1)&15)<<8|K(2))&4095,f[2]=K(3)>>6&3,f[3]=(K(3)&63)<<2|K(4)>>6,f[4]=(K(4)&63)<<2|K(5)>>6,f[5]=(K(5)&63)<<2|K(6)>>6,f[6]=K(6)>>4&3,f[7]=(K(6)&15)<<4|K(7)>>4,f[8]=(K(7)&15)<<4|K(8)>>4,f[9]=(K(8)&15)<<4|K(9)>>4,f[10]=K(9)>>2&3,f[11]=(K(9)&3)<<6|K(10)>>2,f[12]=(K(10)&3)<<6|K(11)>>2,f[13]=(K(11)&3)<<6|K(12)>>2,f[14]=K(12)&3,f[15]=K(13),f[16]=K(14),f[17]=K(15),g+=16,z=0}function U(){h[0]=0,h[1]=0,W[0]=0,W[1]=0}if(G==7)throw G;if(G==6){var V=m==12,X=V?J:D,w=V?14:11,T=V?128:512,F=V?2048:8192,j=V?16383:65535,H=V?4095:16383,R=a/w,k=R*16,E=V?18:14;for(v=0;v<Z-15;v+=16){var N=Math.min(16,Z-v),r0=k*N;for(I=new Uint8Array(i,r+u,r0),g=0,u+=r0,S=0,x=0;S<N;S++,x=0){l=(v+S)*a;for(var B=0;B<R;B++)for(X(),U(),y=0,L=0,d=0;d<w;d++){if(p=d&1,d%3==2){var s0=z<E?f[z++]:0;s0==3&&(s0=4),L=T<<s0,y=1<<s0}var e0=z<E?f[z++]:0;h[p]?(e0*=y,L<F&&W[p]>L&&(e0+=W[p]-L),W[p]=e0):(h[p]=e0,e0?W[p]=e0:e0=W[p]),M[l+x++]=e0-15<=j?e0-15&j:e0+2147483633>>31&H}}}}else if(G==5){var _=m==12?10:9;for(v=0;v<Z;v++)for(x=0;x<a;x+=_)Y(0),m==12?(M[l++]=((f[1]&15)<<8)+f[0],M[l++]=16*f[2]+(f[1]>>4),M[l++]=((f[4]&15)<<8)+f[3],M[l++]=16*f[5]+(f[4]>>4),M[l++]=((f[7]&15)<<8)+f[6],M[l++]=16*f[8]+(f[7]>>4),M[l++]=((f[10]&15)<<8)+f[9],M[l++]=16*f[11]+(f[10]>>4),M[l++]=((f[13]&15)<<8)+f[12],M[l++]=16*f[14]+(f[13]>>4)):m==14&&(M[l++]=f[0]+((f[1]&63)<<8),M[l++]=(f[1]>>6)+4*f[2]+((f[3]&15)<<10),M[l++]=(f[3]>>4)+16*f[4]+((f[5]&3)<<12),M[l++]=((f[5]&252)>>2)+(f[6]<<6),M[l++]=f[7]+((f[8]&63)<<8),M[l++]=(f[8]>>6)+4*f[9]+((f[10]&15)<<10),M[l++]=(f[10]>>4)+16*f[11]+((f[12]&3)<<12),M[l++]=((f[12]&252)>>2)+(f[13]<<6),M[l++]=f[14]+((f[15]&63)<<8))}else if(G==4)for(v=0;v<Z;v++)for(x=0;x<a;x++)d=x%14,p=d&1,d==0&&U(),d%3==2&&(y=4>>3-Y(2)),W[p]?(c=Y(8),c!=0&&(h[p]-=128<<y,(h[p]<0||y==4)&&(h[p]&=~(-1<<y)),h[p]+=c<<y)):(W[p]=Y(8),(W[p]||d>11)&&(h[p]=W[p]<<4|Y(4))),M[l++]=h[x&1];else throw G};P.decode._decodeVC5=function(){var e=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],t,r,s,o=[3,3,3,3,2,2,2,1,1,1],n=24576,i=16384,a=8192,Z=i|a;function m(y){var h=y[1],W=y[0][h>>>3]>>>7-(h&7)&1;return y[1]++,W}function G(y,h){if(t==null){t={};for(var W=0;W<e.length;W+=4)t[e[W+1]]=e.slice(W,W+4)}for(var p=m(y),l=t[p];l==null;)p=p<<1|m(y),l=t[p];var L=l[3];L!=0&&(L=m(y)==0?L:-L),h[0]=l[2],h[1]=L}function u(y,h){for(var W=0;W<h;W++)(y&1)==1&&y++,y=y>>>1;return y}function b(y,h){return y>>h}function g(y,h,W,p,l,L){h[W]=b(b(11*y[l]-4*y[l+L]+y[l+L+L]+4,3)+y[p],1),h[W+L]=b(b(5*y[l]+4*y[l+L]-y[l+L+L]+4,3)-y[p],1)}function z(y,h,W,p,l,L){var v=y[l-L]-y[l+L],x=y[l],S=y[p];h[W]=b(b(v+4,3)+x+S,1),h[W+L]=b(b(-v+4,3)+x-S,1)}function f(y,h,W,p,l,L){h[W]=b(b(5*y[l]+4*y[l-L]-y[l-L-L]+4,3)+y[p],1),h[W+L]=b(b(11*y[l]-4*y[l-L]+y[l-L-L]+4,3)-y[p],1)}function d(y){return y=y<0?0:y>4095?4095:y,y=s[y]>>>2,y}function c(y,h,W,p,l,L){p=new Uint16Array(p.buffer);var v=Date.now(),x=P._binBE,S=h+W,I,M,Y,K,D,J,U,V,X,w;h+=4;for(var T=L[0]==1;h<S;){var F=x.readShort(y,h),j=x.readUshort(y,h+2);if(h+=4,F==12)I=j;else if(F==20)M=j;else if(F==21)Y=j;else if(F==48)K=j;else if(F==53)D=j;else if(F!=35){if(F==62)J=j;else if(F!=101){if(F==109)U=j;else if(F!=84&&F!=106&&F!=107&&F!=108&&F!=102){if(F==104)V=j;else if(F!=105){var H=F<0?-F:F,R=H&65280,k=0;if(H&Z&&(H&a?(k=j&65535,k+=(H&255)<<16):k=j&65535),(H&n)==n){if(X==null){X=[];for(var E=0;E<4;E++)X[E]=new Int16Array((M>>>1)*(Y>>>1));w=new Int16Array((M>>>1)*(Y>>>1)),r=new Int16Array(1024);for(var E=0;E<1024;E++){var N=E-512,r0=Math.abs(N),I=Math.floor(768*r0*r0*r0/(255*255*255))+r0;r[E]=Math.sign(N)*I}s=new Uint16Array(4096);for(var B=65535,E=0;E<4096;E++){var s0=E,e0=B*(Math.pow(113,s0/4095)-1)/112;s[E]=Math.min(e0,B)}}var _=X[J],t0=u(M,1+o[K]),q=u(Y,1+o[K]);if(K==0)for(var Q=0;Q<q;Q++)for(var O=0;O<t0;O++){var a0=h+(Q*t0+O)*2;_[Q*(M>>>1)+O]=y[a0]<<8|y[a0+1]}else{for(var h0=[y,h*8],u0=[],i0=0,V0=t0*q,c0=[0,0],p0=0,j=0;i0<V0;)for(G(h0,c0),p0=c0[0],j=c0[1];p0>0;)u0[i0++]=j,p0--;for(var f0=(K-1)%3,A=f0!=1?t0:0,o0=f0!=0?q:0,Q=0;Q<q;Q++)for(var n0=(Q+o0)*(M>>>1)+A,Z0=Q*t0,O=0;O<t0;O++)_[n0+O]=r[u0[Z0+O]+512]*D;if(f0==2){for(var V=M>>>1,l0=t0*2,m0=q*2,Q=0;Q<q;Q++)for(var O=0;O<l0;O++){var E=Q*2*V+O,d0=Q*V+O,$=q*V+d0;Q==0?g(_,w,E,$,d0,V):Q==q-1?f(_,w,E,$,d0,V):z(_,w,E,$,d0,V)}var b0=_;_=w,w=b0;for(var Q=0;Q<m0;Q++)for(var O=0;O<t0;O++){var E=Q*V+2*O,d0=Q*V+O,$=t0+d0;O==0?g(_,w,E,$,d0,1):O==t0-1?f(_,w,E,$,d0,1):z(_,w,E,$,d0,1)}var b0=_;_=w,w=b0;for(var x0=[],v0=2-~~((K-1)/3),Y0=0;Y0<3;Y0++)x0[Y0]=U>>14-Y0*2&3;var z0=x0[v0];if(z0!=0)for(var Q=0;Q<m0;Q++)for(var O=0;O<l0;O++){var E=Q*V+O;_[E]=_[E]<<z0}}}if(K==9&&J==3)for(var E0=X[0],J0=X[1],C0=X[2],Yt=X[3],Q=0;Q<Y;Q+=2)for(var O=0;O<M;O+=2){var g0=Q*M+O,a0=(Q>>>1)*(M>>>1)+(O>>>1),F0=E0[a0],Tt=J0[a0]-2048,Mt=C0[a0]-2048,B0=Yt[a0]-2048,Q0=(Tt<<1)+F0,A0=(Mt<<1)+F0,O0=F0+B0,_0=F0-B0;T?(p[g0]=d(O0),p[g0+1]=d(A0),p[g0+M]=d(Q0),p[g0+M+1]=d(_0)):(p[g0]=d(Q0),p[g0+1]=d(O0),p[g0+M]=d(_0),p[g0+M+1]=d(A0))}h+=k*4}else if(H==16388)h+=k*4;else if(!(R==8192||R==8448||R==9216))throw H.toString(16)}}}}}console.log(Date.now()-v)}return c}();P.decode._decodeLogLuv32=function(e,t,r,s,o,n){for(var i=e.width,a=i*4,Z=0,m=new Uint8Array(a);Z<s;){for(var G=0;G<a;){var u=t[r+Z];if(Z++,u<128){for(var b=0;b<u;b++)m[G+b]=t[r+Z+b];G+=u,Z+=u}else{u=u-126;for(var b=0;b<u;b++)m[G+b]=t[r+Z];G+=u,Z++}}for(var g=0;g<i;g++)o[n+0]=m[g],o[n+1]=m[g+i],o[n+2]=m[g+i*2],o[n+4]=m[g+i*3],n+=6}};P.decode._ljpeg_diff=function(e,t,r){var s=P.decode._getbithuff,o,n;return o=s(e,t,r[0],r),n=s(e,t,o,0),n&1<<o-1||(n-=(1<<o)-1),n};P.decode._decodeARW=function(e,t,r,s,o,n){var i=e.t256[0],a=e.t257[0],Z=e.t258[0],m=e.isLE?P._binLE:P._binBE,G=i*a==s||i*a*1.5==s;if(!G){a+=8;var u=[r,0,0,0],b=new Uint16Array(32770),g=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],U,z,f,x,v,d=0,c=P.decode._ljpeg_diff;for(b[0]=15,f=U=0;U<18;U++)for(var y=32768>>>(g[U]>>>8),z=0;z<y;z++)b[++f]=g[U];for(x=i;x--;)for(v=0;v<a+1;v+=2)if(v==a&&(v=1),d+=c(t,u,b),v<a){var h=d&4095;P.decode._putsF(o,(v*i+x)*Z,h<<16-Z)}return}if(i*a*1.5==s){for(var U=0;U<s;U+=3){var W=t[r+U+0],p=t[r+U+1],l=t[r+U+2];o[n+U]=p<<4|W>>>4,o[n+U+1]=W<<4|l>>>4,o[n+U+2]=l<<4|p>>>4}return}var L=new Uint16Array(16),v,x,S,I,M,Y,K,D,J,U,V,X=new Uint8Array(i+1);for(v=0;v<a;v++){for(var w=0;w<i;w++)X[w]=t[r++];for(V=0,x=0;x<i-30;V+=16){for(I=2047&(S=m.readUint(X,V)),M=2047&S>>>11,Y=15&S>>>22,K=15&S>>>26,D=0;D<4&&128<<D<=I-M;D++);for(J=30,U=0;U<16;U++)U==Y?L[U]=I:U==K?L[U]=M:(L[U]=((m.readUshort(X,V+(J>>3))>>>(J&7)&127)<<D)+M,L[U]>2047&&(L[U]=2047),J+=7);for(U=0;U<16;U++,x+=2){var h=L[U]<<1;P.decode._putsF(o,(v*i+x)*Z,h<<16-Z)}x-=x&1?1:31}}};P.decode._decodeNikon=function(e,t,r,s,o,n,i){var a=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],Z=e.t256[0],m=e.t257[0],G=e.t258[0],u=0,b=0,g=P.decode._make_decoder,z=P.decode._getbithuff,f=t[0].exifIFD.makerNote,d=f.t150?f.t150:f.t140,c=0,y=d[c++],h=d[c++];(y==73||h==88)&&(c+=2110),y==70&&(u=2),G==14&&(u+=3);for(var W=[[0,0],[0,0]],p=e.isLE?P._binLE:P._binBE,S=0;S<2;S++)for(var l=0;l<2;l++)W[S][l]=p.readShort(d,c),c+=2;var L=1<<G&32767,v=0,x=p.readShort(d,c);c+=2,x>1&&(v=Math.floor(L/(x-1))),y==68&&h==32&&v>0&&(b=p.readShort(d,562));var S,I,M,Y,K,D,J=[0,0],U=g(a[u]),V=[s,0,0,0];for(I=0;I<m;I++)for(b&&I==b&&(U=g(a[u+1])),M=0;M<Z;M++){S=z(r,V,U[0],U),Y=S&15,K=S>>>4,D=(z(r,V,Y-K,0)<<1)+1<<K>>>1,D&1<<Y-1||(D-=(1<<Y)-(K==0?1:0)),M<2?J[M]=W[I&1][M]+=D:J[M&1]+=D;var X=Math.min(Math.max(J[M&1],0),(1<<G)-1),w=(I*Z+M)*G;P.decode._putsF(n,w,X<<16-G)}};P.decode._putsF=function(e,t,r){r=r<<8-(t&7);var s=t>>>3;e[s]|=r>>>16,e[s+1]|=r>>>8,e[s+2]|=r};P.decode._getbithuff=function(e,t,r,s){var o=0;P.decode._get_byte;var n,i=t[0],a=t[1],Z=t[2],m=t[3];if(r==0||Z<0)return 0;for(;!m&&Z<r&&(n=e[i++])!=-1&&!(m=o);)a=(a<<8)+n,Z+=8;if(n=a<<32-Z>>>32-r,s?(Z-=s[n+1]>>>8,n=s[n+1]&255):Z-=r,Z<0)throw"e";return t[0]=i,t[1]=a,t[2]=Z,t[3]=m,n};P.decode._make_decoder=function(e){var t,r,s,o,n,i=[];for(t=16;t!=0&&!e[t];t--);var a=17;for(i[0]=t,s=r=1;r<=t;r++)for(o=0;o<e[r];o++,++a)for(n=0;n<1<<t-r;n++)s<=1<<t&&(i[s++]=r<<8|e[a]);return i};P.decode._decodeNewJPEG=function(e,t,r,s,o,n){s=Math.min(s,t.length-r);var i=e.t347,a=i?i.length:0,Z=new Uint8Array(a+s);if(i){for(var m=216,G=217,u=0,b=0;b<a-1&&!(i[b]==255&&i[b+1]==G);b++)Z[u++]=i[b];var g=t[r],z=t[r+1];(g!=255||z!=m)&&(Z[u++]=g,Z[u++]=z);for(var b=2;b<s;b++)Z[u++]=t[r+b]}else for(var b=0;b<s;b++)Z[b]=t[r+b];if(e.t262[0]==32803||e.t259[0]==7&&e.t262[0]==34892){var f=e.t258[0],d=P.LosslessJpegDecode(Z),c=d.length;if(f==16)if(e.isLE)for(var b=0;b<c;b++)o[n+(b<<1)]=d[b]&255,o[n+(b<<1)+1]=d[b]>>>8;else for(var b=0;b<c;b++)o[n+(b<<1)]=d[b]>>>8,o[n+(b<<1)+1]=d[b]&255;else if(f==14||f==12||f==10)for(var y=16-f,b=0;b<c;b++)P.decode._putsF(o,b*f,d[b]<<y);else if(f==8)for(var b=0;b<c;b++)o[n+b]=d[b];else throw new Error("unsupported bit depth "+f)}else{var h=new P.JpegDecoder;h.parse(Z);for(var W=h.getData({width:h.width,height:h.height,forceRGB:!0,isSourcePDF:!1}),b=0;b<W.length;b++)o[n+b]=W[b]}e.t262[0]==6&&(e.t262[0]=2)};P.decode._decodeOldJPEGInit=function(e,t,r,s){var o=216,n=219,i=196,a=221,Z=192,m=218,G=0,u=0,b,g,z=!1,f,d,c,y=e.t513,h=y?y[0]:0,W=e.t514,p=W?W[0]:0,l=e.t324||e.t273||y,L=e.t530,v=0,x=0,S=e.t277?e.t277[0]:1,I=e.t515;if(l&&(u=l[0],z=l.length>1),!z){if(t[r]==255&&t[r+1]==o)return{jpegOffset:r};if(y!=null&&(t[r+h]==255&&t[r+h+1]==o?G=r+h:log("JPEGInterchangeFormat does not point to SOI"),W==null?log("JPEGInterchangeFormatLength field is missing"):(h>=u||h+p<=u)&&log("JPEGInterchangeFormatLength field value is invalid"),G!=null))return{jpegOffset:G}}if(L!=null&&(v=L[0],x=L[1]),y!=null&&W!=null)if(p>=2&&h+p<=u){for(t[r+h+p-2]==255&&t[r+h+p-1]==o?b=new Uint8Array(p-2):b=new Uint8Array(p),f=0;f<b.length;f++)b[f]=t[r+h+f];log("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else log("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(b==null){var M=0,Y=[];Y[M++]=255,Y[M++]=o;var K=e.t519;if(K==null)throw new Error("JPEGQTables tag is missing");for(f=0;f<K.length;f++)for(Y[M++]=255,Y[M++]=n,Y[M++]=0,Y[M++]=67,Y[M++]=f,d=0;d<64;d++)Y[M++]=t[r+K[f]+d];for(c=0;c<2;c++){var D=e[c==0?"t520":"t521"];if(D==null)throw new Error((c==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(f=0;f<D.length;f++){Y[M++]=255,Y[M++]=i;var J=19;for(d=0;d<16;d++)J+=t[r+D[f]+d];for(Y[M++]=J>>>8,Y[M++]=J&255,Y[M++]=f|c<<4,d=0;d<16;d++)Y[M++]=t[r+D[f]+d];for(d=0;d<J;d++)Y[M++]=t[r+D[f]+16+d]}}if(Y[M++]=255,Y[M++]=Z,Y[M++]=0,Y[M++]=8+3*S,Y[M++]=8,Y[M++]=e.height>>>8&255,Y[M++]=e.height&255,Y[M++]=e.width>>>8&255,Y[M++]=e.width&255,Y[M++]=S,S==1)Y[M++]=1,Y[M++]=17,Y[M++]=0;else for(f=0;f<3;f++)Y[M++]=f+1,Y[M++]=f!=0?17:(v&15)<<4|x&15,Y[M++]=f;I!=null&&I[0]!=0&&(Y[M++]=255,Y[M++]=a,Y[M++]=0,Y[M++]=4,Y[M++]=I[0]>>>8&255,Y[M++]=I[0]&255),b=new Uint8Array(Y)}var U=-1;for(f=0;f<b.length-1;){if(b[f]==255&&b[f+1]==Z){U=f;break}f++}if(U==-1){var V=new Uint8Array(b.length+10+3*S);V.set(b);var X=b.length;if(U=b.length,b=V,b[X++]=255,b[X++]=Z,b[X++]=0,b[X++]=8+3*S,b[X++]=8,b[X++]=e.height>>>8&255,b[X++]=e.height&255,b[X++]=e.width>>>8&255,b[X++]=e.width&255,b[X++]=S,S==1)b[X++]=1,b[X++]=17,b[X++]=0;else for(f=0;f<3;f++)b[X++]=f+1,b[X++]=f!=0?17:(v&15)<<4|x&15,b[X++]=f}if(t[u]==255&&t[u+1]==m){var w=t[u+2]<<8|t[u+3];for(g=new Uint8Array(w+2),g[0]=t[u],g[1]=t[u+1],g[2]=t[u+2],g[3]=t[u+3],f=0;f<w-2;f++)g[f+4]=t[u+f+4]}else{g=new Uint8Array(8+2*S);var T=0;if(g[T++]=255,g[T++]=m,g[T++]=0,g[T++]=6+2*S,g[T++]=S,S==1)g[T++]=1,g[T++]=0;else for(f=0;f<3;f++)g[T++]=f+1,g[T++]=f<<4|f;g[T++]=0,g[T++]=63,g[T++]=0}return{jpegOffset:r,tables:b,sosMarker:g,sofPosition:U}};P.decode._decodeOldJPEG=function(e,t,r,s,o,n){var i,a,Z,m,G,u=P.decode._decodeOldJPEGInit(e,t,r,s);if(u.jpegOffset!=null)for(a=r+s-u.jpegOffset,m=new Uint8Array(a),i=0;i<a;i++)m[i]=t[u.jpegOffset+i];else{for(Z=u.tables.length,m=new Uint8Array(Z+u.sosMarker.length+s+2),m.set(u.tables),G=Z,m[u.sofPosition+5]=e.height>>>8&255,m[u.sofPosition+6]=e.height&255,m[u.sofPosition+7]=e.width>>>8&255,m[u.sofPosition+8]=e.width&255,(t[r]!=255||t[r+1]!=SOS)&&(m.set(u.sosMarker,G),G+=sosMarker.length),i=0;i<s;i++)m[G++]=t[r+i];m[G++]=255,m[G++]=EOI}var b=new P.JpegDecoder;b.parse(m);for(var g=b.getData({width:b.width,height:b.height,forceRGB:!0,isSourcePDF:!1}),i=0;i<g.length;i++)o[n+i]=g[i];e.t262&&e.t262[0]==6&&(e.t262[0]=2)};P.decode._decodePackBits=function(e,t,r,s,o){for(var n=new Int8Array(e.buffer),i=new Int8Array(s.buffer),a=t+r;t<a;){var Z=n[t];if(t++,Z>=0&&Z<128)for(var m=0;m<Z+1;m++)i[o]=n[t],o++,t++;if(Z>=-127&&Z<0){for(var m=0;m<-Z+1;m++)i[o]=n[t],o++;t++}}return o};P.decode._decodeThunder=function(e,t,r,s,o){for(var n=[0,1,0,-1],i=[0,1,2,3,0,-3,-2,-1],a=t+r,Z=o*2,m=0;t<a;){var G=e[t],u=G>>>6,b=G&63;if(t++,u==3&&(m=b&15,s[Z>>>1]|=m<<4*(1-Z&1),Z++),u==0)for(var g=0;g<b;g++)s[Z>>>1]|=m<<4*(1-Z&1),Z++;if(u==2)for(var g=0;g<2;g++){var z=b>>>3*(1-g)&7;z!=4&&(m+=i[z],s[Z>>>1]|=m<<4*(1-Z&1),Z++)}if(u==1)for(var g=0;g<3;g++){var z=b>>>2*(2-g)&3;z!=2&&(m+=n[z],s[Z>>>1]|=m<<4*(1-Z&1),Z++)}}};P.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3};P.decode._lens=function(){var e=function(Z,m,G,u){for(var b=0;b<m.length;b++)Z[m[b]]=G+b*u},t="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",r="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",s="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",o="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",n="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";t=t.split(","),r=r.split(","),s=s.split(","),o=o.split(","),n=n.split(",");var i={},a={};return e(i,t,0,1),e(i,s,64,64),e(i,n,1792,64),e(a,r,0,1),e(a,o,64,64),e(a,n,1792,64),[i,a]}();P.decode._decodeG4=function(e,t,r,s,o,n,i){for(var a=P.decode,Z=t<<3,m=0,G="",u=[],b=[],g=0;g<n;g++)b.push(0);b=a._makeDiff(b);for(var z=0,f=0,d=0,c=0,y=0,h=0,W="",p=0,l=Math.ceil(n/8)*8;Z>>>3<t+r;){d=a._findDiff(b,z+(z==0?0:1),1-y),c=a._findDiff(b,d,y);var L=0;if(i==1&&(L=e[Z>>>3]>>>7-(Z&7)&1),i==2&&(L=e[Z>>>3]>>>(Z&7)&1),Z++,G+=L,W=="H"){if(a._lens[y][G]!=null){var v=a._lens[y][G];G="",m+=v,v<64&&(a._addNtimes(u,m,y),z+=m,y=1-y,m=0,p--,p==0&&(W=""))}}else G=="0001"&&(G="",a._addNtimes(u,c-z,y),z=c),G=="001"&&(G="",W="H",p=2),a._dmap[G]!=null&&(f=d+a._dmap[G],a._addNtimes(u,f-z,y),z=f,G="",y=1-y);u.length==n&&W==""&&(a._writeBits(u,s,o*8+h*l),y=0,h++,z=0,b=a._makeDiff(u),u=[])}};P.decode._findDiff=function(e,t,r){for(var s=0;s<e.length;s+=2)if(e[s]>=t&&e[s+1]==r)return e[s]};P.decode._makeDiff=function(e){var t=[];e[0]==1&&t.push(0,1);for(var r=1;r<e.length;r++)e[r-1]!=e[r]&&t.push(r,e[r]);return t.push(e.length,0,e.length,1),t};P.decode._decodeG2=function(e,t,r,s,o,n,i){for(var a=P.decode,Z=t<<3,m=0,G="",u=[],b=0,g=0,z=Math.ceil(n/8)*8;Z>>>3<t+r;){var f=0;i==1&&(f=e[Z>>>3]>>>7-(Z&7)&1),i==2&&(f=e[Z>>>3]>>>(Z&7)&1),Z++,G+=f,m=a._lens[b][G],m!=null&&(a._addNtimes(u,m,b),G="",m<64&&(b=1-b),u.length==n&&(a._writeBits(u,s,o*8+g*z),u=[],g++,b=0,Z&7&&(Z+=8-(Z&7)),m>=64&&(Z+=8)))}};P.decode._decodeG3=function(e,t,r,s,o,n,i,a){for(var Z=P.decode,m=t<<3,G=0,u="",b=[],g=[],z=0;z<n;z++)b.push(0);for(var f=0,d=0,c=0,y=0,h=0,W=-1,p="",l=0,L=!0,v=Math.ceil(n/8)*8;m>>>3<t+r;){c=Z._findDiff(g,f+(f==0?0:1),1-h),y=Z._findDiff(g,c,h);var x=0;if(i==1&&(x=e[m>>>3]>>>7-(m&7)&1),i==2&&(x=e[m>>>3]>>>(m&7)&1),m++,u+=x,L){if(Z._lens[h][u]!=null){var S=Z._lens[h][u];u="",G+=S,S<64&&(Z._addNtimes(b,G,h),h=1-h,G=0)}}else if(p=="H"){if(Z._lens[h][u]!=null){var S=Z._lens[h][u];u="",G+=S,S<64&&(Z._addNtimes(b,G,h),f+=G,h=1-h,G=0,l--,l==0&&(p=""))}}else u=="0001"&&(u="",Z._addNtimes(b,y-f,h),f=y),u=="001"&&(u="",p="H",l=2),Z._dmap[u]!=null&&(d=c+Z._dmap[u],Z._addNtimes(b,d-f,h),f=d,u="",h=1-h);u.endsWith("000000000001")&&(W>=0&&Z._writeBits(b,s,o*8+W*v),a&&(i==1&&(L=(e[m>>>3]>>>7-(m&7)&1)==1),i==2&&(L=(e[m>>>3]>>>(m&7)&1)==1),m++),u="",h=0,W++,f=0,g=Z._makeDiff(b),b=[])}b.length==n&&Z._writeBits(b,s,o*8+W*v)};P.decode._addNtimes=function(e,t,r){for(var s=0;s<t;s++)e.push(r)};P.decode._writeBits=function(e,t,r){for(var s=0;s<e.length;s++)t[r+s>>>3]|=e[s]<<7-(r+s&7)};P.decode._decodeLZW=P.decode._decodeLZW=function(){var e,t,r,s,o=0,n=0,i=0,a=0,Z=function(){var d=e>>>3,c=t[d]<<16|t[d+1]<<8|t[d+2],y=c>>>24-(e&7)-n&(1<<n)-1;return e+=n,y},m=new Uint32Array(4096*4),G=0,u=function(d){if(d!=G){G=d,i=1<<d,a=i+1;for(var c=0;c<a+1;c++)m[4*c]=m[4*c+3]=c,m[4*c+1]=65535,m[4*c+2]=1}},b=function(d){n=d+1,o=a+1},g=function(d){for(var c=d<<2,y=m[c+2],h=s+y-1;c!=65535;)r[h--]=m[c],c=m[c+1];s+=y},z=function(d,c){var y=o<<2,h=d<<2;m[y]=m[(c<<2)+3],m[y+1]=h,m[y+2]=m[h+2]+1,m[y+3]=m[h+3],o++,o+1==1<<n&&n!=12&&n++},f=function(d,c,y,h,W,p){e=c<<3,t=d,r=h,s=W;var l=c+y<<3,L=0,v=0;for(u(p),b(p);e<l&&(L=Z())!=a;){if(L==i){if(b(p),L=Z(),L==a)break;g(L)}else L<o?(g(L),z(v,L)):(z(v,v),g(o-1));v=L}return s};return f}();P.tags={};P._types=function(){var e=new Array(250);e.fill(0),e=e.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var t={33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7};return{basic:{main:e,rest:t},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}();P._readIFD=function(e,t,r,s,o,n){var i=e.readUshort(t,r);r+=2;var a={};n.debug&&log("   ".repeat(o),s.length-1,">>>----------------");for(var Z=0;Z<i;Z++){var m=e.readUshort(t,r);r+=2;var G=e.readUshort(t,r);r+=2;var u=e.readUint(t,r);r+=4;var b=e.readUint(t,r);r+=4;var g=[];if(G==1||G==7){var z=u<5?r-4:b;z+u>t.buffer.byteLength&&(u=t.buffer.byteLength-z),g=new Uint8Array(t.buffer,z,u)}if(G==2){var f=u<5?r-4:b,d=t[f],c=Math.max(0,Math.min(u-1,t.length-f));d<128||c==0?g.push(e.readASCII(t,f,c)):g=new Uint8Array(t.buffer,f,c)}if(G==3)for(var y=0;y<u;y++)g.push(e.readUshort(t,(u<3?r-4:b)+2*y));if(G==4||G==13)for(var y=0;y<u;y++)g.push(e.readUint(t,(u<2?r-4:b)+4*y));if(G==5||G==10)for(var h=G==5?e.readUint:e.readInt,y=0;y<u;y++)g.push([h(t,b+y*8),h(t,b+y*8+4)]);if(G==8)for(var y=0;y<u;y++)g.push(e.readShort(t,(u<3?r-4:b)+2*y));if(G==9)for(var y=0;y<u;y++)g.push(e.readInt(t,(u<2?r-4:b)+4*y));if(G==11)for(var y=0;y<u;y++)g.push(e.readFloat(t,b+y*4));if(G==12)for(var y=0;y<u;y++)g.push(e.readDouble(t,b+y*8));if(u!=0&&g.length==0){if(log(m,"unknown TIFF tag type: ",G,"num:",u),Z==0)return;continue}if(n.debug&&log("   ".repeat(o),m,G,P.tags[m],g),a["t"+m]=g,!(m==330&&a.t272&&a.t272[0]=="DSLR-A100")&&(m==330||m==34665||m==34853||m==50740&&e.readUshort(t,e.readUint(g,0))<300||m==61440)){for(var W=m==50740?[e.readUint(g,0)]:g,p=[],y=0;y<W.length;y++)P._readIFD(e,t,W[y],p,o+1,n);m==330&&(a.subIFD=p),m==34665&&(a.exifIFD=p[0]),m==34853&&(a.gpsiIFD=p[0]),m==50740&&(a.dngPrvt=p[0]),m==61440&&(a.fujiIFD=p[0])}if(m==37500&&n.parseMN){var l=g;if(e.readASCII(l,0,5)=="Nikon")a.makerNote=P.decode(l.slice(10).buffer)[0];else if(e.readASCII(l,0,5)=="OLYMP"||e.readASCII(l,0,9)=="OM SYSTEM"){var L=[8208,8224,8240,8256,8272],v=[];P._readIFD(e,l,l[1]==77?16:l[5]==85?12:8,v,o+1,n);for(var x=a.makerNote=v.pop(),y=0;y<L.length;y++){var S="t"+L[y];x[S]!=null&&(P._readIFD(e,l,x[S][0],v,o+1,n),x[S]=v.pop())}x.t12288&&(P._readIFD(e,x.t12288,0,v,o+1,n),x.t12288=v.pop())}else if(e.readUshort(t,b)<300&&e.readUshort(t,b+4)<=12){var v=[];P._readIFD(e,t,b,v,o+1,n),a.makerNote=v[0]}}}return s.push(a),n.debug&&log("   ".repeat(o),"<<<---------------"),r};P._writeIFD=function(e,t,r,s,o){var n=Object.keys(o),i=n.length;o.exifIFD&&i--,o.gpsiIFD&&i--,e.writeUshort(r,s,i),s+=2;for(var a=s+i*12+4,Z=0;Z<n.length;Z++){var m=n[Z];if(!(m=="t34665"||m=="t34853")){m=="exifIFD"&&(m="t34665"),m=="gpsiIFD"&&(m="t34853");var G=parseInt(m.slice(1)),u=t.main[G];if(u==null&&(u=t.rest[G]),u==null||u==0)throw new Error("unknown type of tag: "+G);var b=o[m];if(G==34665){var g=P._writeIFD(e,t,r,a,o.exifIFD);b=[a],a=g[1]}if(G==34853){var g=P._writeIFD(e,P._types.gps,r,a,o.gpsiIFD);b=[a],a=g[1]}u==2&&(b=b[0]+"\0");var z=b.length;e.writeUshort(r,s,G),s+=2,e.writeUshort(r,s,u),s+=2,e.writeUint(r,s,z),s+=4;var f=[-1,1,1,2,4,8,0,1,0,4,8,0,8][u]*z,d=s;if(f>4&&(e.writeUint(r,s,a),d=a),u==1||u==7)for(var c=0;c<z;c++)r[d+c]=b[c];else if(u==2)e.writeASCII(r,d,b);else if(u==3)for(var c=0;c<z;c++)e.writeUshort(r,d+2*c,b[c]);else if(u==4)for(var c=0;c<z;c++)e.writeUint(r,d+4*c,b[c]);else if(u==5||u==10)for(var y=u==5?e.writeUint:e.writeInt,c=0;c<z;c++){var h=b[c],W=h[0],p=h[1];if(W==null)throw"e";y(r,d+8*c,W),y(r,d+8*c+4,p)}else if(u==9)for(var c=0;c<z;c++)e.writeInt(r,d+4*c,b[c]);else if(u==12)for(var c=0;c<z;c++)e.writeDouble(r,d+8*c,b[c]);else throw u;f>4&&(f+=f&1,a+=f),s+=4}}return[s,a]};P.toRGBA8=function(e,t){function r(u0){return u0<.0031308?12.92*u0:1.055*Math.pow(u0,1/2.4)-.055}var s=e.width,o=e.height,n=s*o,i=e.data,a=new Uint8Array(n*4),Z=e.t262?e.t262[0]:2,m=e.t258?Math.min(32,e.t258[0]):1;e.t262==null&&m==1&&(Z=0);var G=e.t277?e.t277[0]:e.t258?e.t258.length:[1,1,3,1,1,4,3][Z],u=e.t339?e.t339[0]:null;if(Z==1&&m==32&&u!=3)throw"e";var b=Math.ceil(G*m*s/8);if(Z==0){t=1/256;for(var g=0;g<o;g++){var z=g*b,f=g*s;if(m==1)for(var d=0;d<s;d++){var c=f+d<<2,y=i[z+(d>>3)]>>7-(d&7)&1;a[c]=a[c+1]=a[c+2]=(1-y)*255,a[c+3]=255}if(m==4)for(var d=0;d<s;d++){var c=f+d<<2,y=i[z+(d>>1)]>>4-4*(d&1)&15;a[c]=a[c+1]=a[c+2]=(15-y)*17,a[c+3]=255}if(m==8)for(var d=0;d<s;d++){var c=f+d<<2,y=i[z+d];a[c]=a[c+1]=a[c+2]=255-y,a[c+3]=255}if(m==16)for(var d=0;d<s;d++){var c=f+d<<2,h=z+2*d,y=i[h+1]<<8|i[h];a[c]=a[c+1]=a[c+2]=Math.min(255,255-~~(y*t)),a[c+3]=255}}}else if(Z==1){t==null&&(t=1/256);for(var W=i.length&3?null:new Float32Array(i.buffer),g=0;g<o;g++){var z=g*b,f=g*s;if(m==1)for(var d=0;d<s;d++){var c=f+d<<2,y=i[z+(d>>3)]>>7-(d&7)&1;a[c]=a[c+1]=a[c+2]=y*255,a[c+3]=255}if(m==2)for(var d=0;d<s;d++){var c=f+d<<2,y=i[z+(d>>2)]>>6-2*(d&3)&3;a[c]=a[c+1]=a[c+2]=y*85,a[c+3]=255}if(m==8)for(var d=0;d<s;d++){var c=f+d<<2,y=i[z+d*G];a[c]=a[c+1]=a[c+2]=y,a[c+3]=255}if(m==16)for(var d=0;d<s;d++){var c=f+d<<2,h=z+2*d,y=i[h+1]<<8|i[h];a[c]=a[c+1]=a[c+2]=Math.min(255,~~(y*t)),a[c+3]=255}if(m==32)for(var d=0;d<s;d++){var c=f+d<<2,h=(z>>>2)+d,y=W[h];a[c]=a[c+1]=a[c+2]=~~(.5+255*y),a[c+3]=255}}}else if(Z==2)if(m==8){if(G==1)for(var d=0;d<n;d++)a[4*d]=a[4*d+1]=a[4*d+2]=i[d],a[4*d+3]=255;if(G==3)for(var d=0;d<n;d++){var c=d<<2,p=d*3;a[c]=i[p],a[c+1]=i[p+1],a[c+2]=i[p+2],a[c+3]=255}if(G>=4)for(var d=0;d<n;d++){var c=d<<2,p=d*G;a[c]=i[p],a[c+1]=i[p+1],a[c+2]=i[p+2],a[c+3]=i[p+3]}}else if(m==16){if(G==4)for(var d=0;d<n;d++){var c=d<<2,p=d*8+1;a[c]=i[p],a[c+1]=i[p+2],a[c+2]=i[p+4],a[c+3]=i[p+6]}if(G==3)for(var d=0;d<n;d++){var c=d<<2,p=d*6+1;a[c]=i[p],a[c+1]=i[p+2],a[c+2]=i[p+4],a[c+3]=255}}else if(m==32){for(var l=new Float32Array(i.buffer),L=0,d=0;d<l.length;d++)L=Math.min(L,l[d]);if(L<0)for(var d=0;d<i.length;d+=4){var v=i[d];i[d]=i[d+3],i[d+3]=v,v=i[d+1],i[d+1]=i[d+2],i[d+2]=v}for(var x=[],d=0;d<65536;d++)x.push(r(d/65535));for(var d=0;d<l.length;d++){var S=Math.max(0,Math.min(1,l[d]));l[d]=x[~~(.5+S*65535)]}if(G==3)for(var d=0;d<n;d++){var c=d<<2,p=d*3;a[c]=~~(.5+l[p]*255),a[c+1]=~~(.5+l[p+1]*255),a[c+2]=~~(.5+l[p+2]*255),a[c+3]=255}else if(G==4)for(var d=0;d<n;d++){var c=d<<2,p=d*4;a[c]=~~(.5+l[p]*255),a[c+1]=~~(.5+l[p+1]*255),a[c+2]=~~(.5+l[p+2]*255),a[c+3]=~~(.5+l[p+3]*255)}else throw G}else throw m;else if(Z==3)for(var I=e.t320,M=1<<m,Y=m==8&&G>1&&e.t338&&e.t338[0]!=0,g=0;g<o;g++)for(var K=0;K<s;K++){var d=g*s+K,c=d<<2,D=0,J=g*b;if(m==1)D=i[J+(K>>>3)]>>>7-(K&7)&1;else if(m==2)D=i[J+(K>>>2)]>>>6-2*(K&3)&3;else if(m==4)D=i[J+(K>>>1)]>>>4-4*(K&1)&15;else if(m==8)D=i[J+K*G];else throw m;a[c]=I[D]>>8,a[c+1]=I[M+D]>>8,a[c+2]=I[M+M+D]>>8,a[c+3]=Y?i[J+K*G+1]:255}else if(Z==5)for(var U=G>4?1:0,d=0;d<n;d++){var c=d<<2,V=d*G;if(window.UDOC){var X=i[V],w=i[V+1],T=i[V+2],F=i[V+3],j=UDOC.C.cmykToRgb([X*(1/255),w*(1/255),T*(1/255),F*(1/255)]);a[c]=~~(.5+255*j[0]),a[c+1]=~~(.5+255*j[1]),a[c+2]=~~(.5+255*j[2])}else{var X=255-i[V],w=255-i[V+1],T=255-i[V+2],F=(255-i[V+3])*(1/255);a[c]=~~(X*F+.5),a[c+1]=~~(w*F+.5),a[c+2]=~~(T*F+.5)}a[c+3]=255*(1-U)+i[V+4]*U}else if(Z==6&&e.t278)for(var H=e.t278[0],g=0;g<o;g+=H)for(var d=g*s,R=H*s,k=0;k<R;k++){var c=4*(d+k),V=3*d+4*(k>>>1),T=i[V+(k&1)],E=i[V+2]-128,N=i[V+3]-128,r0=T+((N>>2)+(N>>3)+(N>>5)),B=T-((E>>2)+(E>>4)+(E>>5))-((N>>1)+(N>>3)+(N>>4)+(N>>5)),s0=T+(E+(E>>1)+(E>>2)+(E>>6));a[c]=Math.max(0,Math.min(255,r0)),a[c+1]=Math.max(0,Math.min(255,B)),a[c+2]=Math.max(0,Math.min(255,s0)),a[c+3]=255}else if(Z==32845)for(var g=0;g<o;g++)for(var K=0;K<s;K++){var V=(g*s+K)*6,c=(g*s+K)*4,e0=i[V+1]<<8|i[V],e0=Math.pow(2,(e0+.5)/256-64),_=(i[V+3]+.5)/410,t0=(i[V+5]+.5)/410,q=9*_/(6*_-16*t0+12),Q=4*t0/(6*_-16*t0+12),O=e0,a0=q*O/Q,T=O,h0=(1-q-Q)*O/Q,r0=2.69*a0-1.276*T-.414*h0,B=-1.022*a0+1.978*T+.044*h0,s0=.061*a0-.224*T+1.163*h0;a[c]=r(Math.min(r0,1))*255,a[c+1]=r(Math.min(B,1))*255,a[c+2]=r(Math.min(s0,1))*255,a[c+3]=255}else log("Unknown Photometric interpretation: "+Z);return a};P.replaceIMG=function(e){e==null&&(e=document.getElementsByTagName("img"));for(var t=["tif","tiff","dng","cr2","nef"],r=0;r<e.length;r++){var s=e[r],o=s.getAttribute("src");if(o!=null){var n=o.split(".").pop().toLowerCase();if(t.indexOf(n)!=-1){var i=new XMLHttpRequest;P._xhrs.push(i),P._imgs.push(s),i.open("GET",o),i.responseType="arraybuffer",i.onload=P._imgLoaded,i.send()}}}};P._xhrs=[];P._imgs=[];P._imgLoaded=function(e){var t=P._xhrs.indexOf(e.target),r=P._imgs[t];P._xhrs.splice(t,1),P._imgs.splice(t,1),r.setAttribute("src",P.bufferToURI(e.target.response))};P.bufferToURI=function(e){var t=P.decode(e),r=t,s=0,o=r[0];t[0].subIFD&&(r=r.concat(t[0].subIFD));for(var n=0;n<r.length;n++){var i=r[n];if(!(i.t258==null||i.t258.length<3)){var a=i.t256*i.t257;a>s&&(s=a,o=i)}}P.decodeImage(e,o,t);var Z=P.toRGBA8(o),m=o.width,G=o.height,u=document.createElement("canvas");u.width=m,u.height=G;var b=u.getContext("2d"),g=new ImageData(new Uint8ClampedArray(Z.buffer),m,G);return b.putImageData(g,0,0),u.toDataURL()};P._binBE={nextZero:function(e,t){for(;e[t]!=0;)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},readShort:function(e,t){var r=P._binBE.ui8;return r[0]=e[t+1],r[1]=e[t+0],P._binBE.i16[0]},readInt:function(e,t){var r=P._binBE.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],P._binBE.i32[0]},readUint:function(e,t){var r=P._binBE.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],P._binBE.ui32[0]},readASCII:function(e,t,r){for(var s="",o=0;o<r;o++)s+=String.fromCharCode(e[t+o]);return s},readFloat:function(e,t){for(var r=P._binBE.ui8,s=0;s<4;s++)r[s]=e[t+3-s];return P._binBE.fl32[0]},readDouble:function(e,t){for(var r=P._binBE.ui8,s=0;s<8;s++)r[s]=e[t+7-s];return P._binBE.fl64[0]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=r&255},writeInt:function(e,t,r){var s=P._binBE.ui8;P._binBE.i32[0]=r,e[t+3]=s[0],e[t+2]=s[1],e[t+1]=s[2],e[t+0]=s[3]},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:function(e,t,r){for(var s=0;s<r.length;s++)e[t+s]=r.charCodeAt(s)},writeDouble:function(e,t,r){P._binBE.fl64[0]=r;for(var s=0;s<8;s++)e[t+s]=P._binBE.ui8[7-s]}};P._binBE.ui8=new Uint8Array(8);P._binBE.i16=new Int16Array(P._binBE.ui8.buffer);P._binBE.i32=new Int32Array(P._binBE.ui8.buffer);P._binBE.ui32=new Uint32Array(P._binBE.ui8.buffer);P._binBE.fl32=new Float32Array(P._binBE.ui8.buffer);P._binBE.fl64=new Float64Array(P._binBE.ui8.buffer);P._binLE={nextZero:P._binBE.nextZero,readUshort:function(e,t){return e[t+1]<<8|e[t]},readShort:function(e,t){var r=P._binBE.ui8;return r[0]=e[t+0],r[1]=e[t+1],P._binBE.i16[0]},readInt:function(e,t){var r=P._binBE.ui8;return r[0]=e[t+0],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],P._binBE.i32[0]},readUint:function(e,t){var r=P._binBE.ui8;return r[0]=e[t+0],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],P._binBE.ui32[0]},readASCII:P._binBE.readASCII,readFloat:function(e,t){for(var r=P._binBE.ui8,s=0;s<4;s++)r[s]=e[t+s];return P._binBE.fl32[0]},readDouble:function(e,t){for(var r=P._binBE.ui8,s=0;s<8;s++)r[s]=e[t+s];return P._binBE.fl64[0]},writeUshort:function(e,t,r){e[t]=r&255,e[t+1]=r>>8&255},writeInt:function(e,t,r){var s=P._binBE.ui8;P._binBE.i32[0]=r,e[t+0]=s[0],e[t+1]=s[1],e[t+2]=s[2],e[t+3]=s[3]},writeUint:function(e,t,r){e[t]=r>>>0&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},writeASCII:P._binBE.writeASCII};P._copyTile=function(e,t,r,s,o,n,i,a){for(var Z=Math.min(t,o-i),m=Math.min(r,n-a),G=0;G<m;G++)for(var u=(a+G)*o+i,b=G*t,g=0;g<Z;g++)s[u+g]=e[b+g]};P._inflateRaw=function(){var e={};return e.H={},e.H.N=function(t,r){var s=Uint8Array,o=0,n=0,i=0,a=0,Z=0,m=0,G=0,u=0,b=0,g,z;if(t[0]==3&&t[1]==0)return r||new s(0);var f=e.H,d=f.b,c=f.e,y=f.R,h=f.n,W=f.A,p=f.Z,l=f.m,L=r==null;for(L&&(r=new s(t.length>>>2<<5));o==0;){if(o=d(t,b,1),n=d(t,b+1,2),b+=3,n==0){b&7&&(b+=8-(b&7));var v=(b>>>3)+4,x=t[v-4]|t[v-3]<<8;L&&(r=e.H.W(r,u+x)),r.set(new s(t.buffer,t.byteOffset+v,x),u),b=v+x<<3,u+=x;continue}if(L&&(r=e.H.W(r,u+(1<<17))),n==1&&(g=l.J,z=l.h,m=511,G=31),n==2){i=c(t,b,5)+257,a=c(t,b+5,5)+1,Z=c(t,b+10,4)+4,b+=14;for(var S=1,I=0;I<38;I+=2)l.Q[I]=0,l.Q[I+1]=0;for(var I=0;I<Z;I++){var M=c(t,b+I*3,3);l.Q[(l.X[I]<<1)+1]=M,M>S&&(S=M)}b+=3*Z,h(l.Q,S),W(l.Q,S,l.u),g=l.w,z=l.d,b=y(l.u,(1<<S)-1,i+a,t,b,l.v);var Y=f.V(l.v,0,i,l.C);m=(1<<Y)-1;var K=f.V(l.v,i,a,l.D);G=(1<<K)-1,h(l.C,Y),W(l.C,Y,g),h(l.D,K),W(l.D,K,z)}for(;;){var D=g[p(t,b)&m];b+=D&15;var J=D>>>4;if(!(J>>>8))r[u++]=J;else{if(J==256)break;var U=u+J-254;if(J>264){var V=l.q[J-257];U=u+(V>>>3)+c(t,b,V&7),b+=V&7}var X=z[p(t,b)&G];b+=X&15;var w=X>>>4,T=l.c[w],F=(T>>>4)+d(t,b,T&15);for(b+=T&15;u<U;)r[u]=r[u++-F],r[u]=r[u++-F],r[u]=r[u++-F],r[u]=r[u++-F];u=U}}}return r.length==u?r:r.slice(0,u)},e.H.W=function(t,r){var s=t.length;if(r<=s)return t;var o=new Uint8Array(s<<1);return o.set(t,0),o},e.H.R=function(t,r,s,o,n,i){for(var a=e.H.e,Z=e.H.Z,m=0;m<s;){var G=t[Z(o,n)&r];n+=G&15;var u=G>>>4;if(u<=15)i[m]=u,m++;else{var b=0,g=0;u==16?(g=3+a(o,n,2),n+=2,b=i[m-1]):u==17?(g=3+a(o,n,3),n+=3):u==18&&(g=11+a(o,n,7),n+=7);for(var z=m+g;m<z;)i[m]=b,m++}}return n},e.H.V=function(t,r,s,o){for(var n=0,i=0,a=o.length>>>1;i<s;){var Z=t[i+r];o[i<<1]=0,o[(i<<1)+1]=Z,Z>n&&(n=Z),i++}for(;i<a;)o[i<<1]=0,o[(i<<1)+1]=0,i++;return n},e.H.n=function(t,r){for(var s=e.H.m,o=t.length,n,i,a,G,Z,m=s.j,G=0;G<=r;G++)m[G]=0;for(G=1;G<o;G+=2)m[t[G]]++;var u=s.K;for(n=0,m[0]=0,i=1;i<=r;i++)n=n+m[i-1]<<1,u[i]=n;for(a=0;a<o;a+=2)Z=t[a+1],Z!=0&&(t[a]=u[Z],u[Z]++)},e.H.A=function(t,r,s){for(var o=t.length,n=e.H.m,i=n.r,a=0;a<o;a+=2)if(t[a+1]!=0)for(var Z=a>>1,m=t[a+1],G=Z<<4|m,u=r-m,b=t[a]<<u,g=b+(1<<u);b!=g;){var z=i[b]>>>15-r;s[z]=G,b++}},e.H.l=function(t,r){for(var s=e.H.m.r,o=15-r,n=0;n<t.length;n+=2){var i=t[n]<<r-t[n+1];t[n]=s[i]>>>o}},e.H.M=function(t,r,s){s=s<<(r&7);var o=r>>>3;t[o]|=s,t[o+1]|=s>>>8},e.H.I=function(t,r,s){s=s<<(r&7);var o=r>>>3;t[o]|=s,t[o+1]|=s>>>8,t[o+2]|=s>>>16},e.H.e=function(t,r,s){return(t[r>>>3]|t[(r>>>3)+1]<<8)>>>(r&7)&(1<<s)-1},e.H.b=function(t,r,s){return(t[r>>>3]|t[(r>>>3)+1]<<8|t[(r>>>3)+2]<<16)>>>(r&7)&(1<<s)-1},e.H.Z=function(t,r){return(t[r>>>3]|t[(r>>>3)+1]<<8|t[(r>>>3)+2]<<16)>>>(r&7)},e.H.i=function(t,r){return(t[r>>>3]|t[(r>>>3)+1]<<8|t[(r>>>3)+2]<<16|t[(r>>>3)+3]<<24)>>>(r&7)},e.H.m=function(){var t=Uint16Array,r=Uint32Array;return{K:new t(16),j:new t(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new t(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new t(512),_:[],h:new t(32),$:[],w:new t(32768),C:[],v:[],d:new t(32768),D:[],u:new t(512),Q:[],r:new t(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new t(65536),g:new t(32768)}}(),function(){for(var t=e.H.m,r=32768,s=0;s<r;s++){var o=s;o=(o&2863311530)>>>1|(o&1431655765)<<1,o=(o&3435973836)>>>2|(o&858993459)<<2,o=(o&4042322160)>>>4|(o&252645135)<<4,o=(o&4278255360)>>>8|(o&16711935)<<8,t.r[s]=(o>>>16|o<<16)>>>17}function n(i,a,Z){for(;a--!=0;)i.push(0,Z)}for(var s=0;s<32;s++)t.q[s]=t.S[s]<<3|t.T[s],t.c[s]=t.p[s]<<4|t.z[s];n(t._,144,8),n(t._,112,9),n(t._,24,7),n(t._,8,8),e.H.n(t._,9),e.H.A(t._,9,t.J),e.H.l(t._,9),n(t.$,32,5),e.H.n(t.$,5),e.H.A(t.$,5,t.h),e.H.l(t.$,5),n(t.Q,19,0),n(t.C,286,0),n(t.D,30,0),n(t.v,320,0)}(),e.H.N}();P.LosslessJpegDecode=function(){var e,t;function r(){return e[t++]}function s(){return e[t++]<<8|e[t++]}function o(d){for(var c=r(),y=[0,0,0,255],h=[],W=8,p=0;p<16;p++)h[p]=r();for(var p=0;p<16;p++)for(var l=0;l<h[p];l++){var L=n(y,0,p+1,1);y[L+3]=r()}var v=new Uint8Array(1<<W);d[c]=[new Uint8Array(y),v];for(var p=0;p<1<<W;p++){for(var x=W,S=p,I=0,M=0;y[I+3]==255&&x!=0;)M=S>>--x&1,I=y[I+M];v[p]=I}}function n(d,c,y,h){if(d[c+3]!=255)return 0;if(y==0)return c;for(var W=0;W<2;W++){d[c+W]==0&&(d[c+W]=d.length,d.push(0,0,h,255));var p=n(d,d[c+W],y-1,h+1);if(p!=0)return p}return 0}function i(d){for(var c=d.b,y=d.f;c<25&&d.a<d.d;){var h=d.data[d.a++];h==255&&!d.c&&d.a++,y=y<<8|h,c+=8}if(c<0)throw"e";d.b=c,d.f=y}function a(d,c){return c.b<d&&i(c),c.f>>(c.b-=d)&65535>>16-d}function Z(d,c){var y=d[0],h=0,W=255,p=0;c.b<16&&i(c);var l=c.f>>c.b-8&255;for(h=d[1][l],W=y[h+3],c.b-=y[h+2];W==255;)p=c.f>>--c.b&1,h=y[h+p],W=y[h+3];return W}function m(d,c){return d<32768>>16-c&&(d+=-(1<<c)+1),d}function G(d,c){var y=Z(d,c);if(y==0)return 0;if(y==16)return-32768;var h=a(y,c);return m(h,y)}function u(d,c,y,h,W,p){for(var l=0,L=0;L<p;L++){for(var v=L*c,x=0;x<c;x+=W){l++;for(var S=0;S<W;S++)d[v+x+S]=G(h[S],y)}if(y.e!=0&&l%y.e==0&&L!=0){for(var I=y.a,M=y.data;M[I]!=255||!(208<=M[I+1]&&M[I+1]<=215);)I--;y.a=I+2,y.f=0,y.b=0}}}function b(d,c){return m(a(d,c),d)}function g(d,c,y,h,W){for(var p=e.length-t,l=0;l<p;l+=4){var L=e[t+l];e[t+l]=e[t+l+3],e[t+l+3]=L;var L=e[t+l+1];e[t+l+1]=e[t+l+2],e[t+l+2]=L}for(var v=0;v<W;v++)for(var x=32768,S=32768,I=0;I<c;I+=2){var M=Z(h,y),Y=Z(h,y);M!=0&&(x+=b(M,y)),Y!=0&&(S+=b(Y,y)),d[v*c+I]=x&65535,d[v*c+I+1]=S&65535}}function z(d){if(e=d,t=0,s()!=65496)throw"e";for(var c=[],y=0,h=0,W=0,p=[],l=[],L=[],v=0,x=0,S=0;;){var I=s();if(I==65535){t--;continue}var M=s();if(I==65475){h=r(),x=s(),S=s(),v=r();for(var Y=0;Y<v;Y++){var K=r(),D=r(),J=r();if(J!=0)throw"e";c[K]=[Y,D>>4,D&15]}}else if(I==65476)for(var U=t+M-2;t<U;)o(l);else if(I==65498){t++;for(var Y=0;Y<v;Y++){var V=r(),X=c[V];L[X[0]]=l[r()>>>4],p[X[0]]=X.slice(1)}y=r(),t+=2;break}else I==65501?W=s():t+=M-2}var w=h>8?Uint16Array:Uint8Array,T=new w(x*S*v),F={b:0,f:0,c:y==8,a:t,data:e,d:e.length,e:W};if(F.c)g(T,S*v,F,L[0],x);else{for(var j=[],H=0,R=0,Y=0;Y<v;Y++){var k=p[Y],E=k[0],N=k[1];E>H&&(H=E),N>R&&(R=N),j.push(E*N)}if(H!=1||R!=1){if(v!=3||j[1]!=1||j[2]!=1||H!=2||R!=1&&R!=2)throw"e";for(var r0=[],B=0,Y=0;Y<v;Y++){for(var s0=0;s0<j[Y];s0++)r0.push(L[Y]);B+=j[Y]}var e0=S/H,_=x/R,t0=e0*_;u(T,e0*B,F,r0,B,_),f(T,y,e0,_,B-2,B,B,h);var q=new Uint16Array(t0*j[0]);if(H==2&&R==2){for(var Y=0;Y<t0;Y++)q[4*Y]=T[6*Y],q[4*Y+1]=T[6*Y+1],q[4*Y+2]=T[6*Y+2],q[4*Y+3]=T[6*Y+3];f(q,y,e0*4,_,0,1,1,h);for(var Y=0;Y<t0;Y++)T[6*Y]=q[4*Y],T[6*Y+1]=q[4*Y+1],T[6*Y+2]=q[4*Y+2],T[6*Y+3]=q[4*Y+3]}if(H==2&&R==1){for(var Y=0;Y<t0;Y++)q[2*Y]=T[4*Y],q[2*Y+1]=T[4*Y+1];f(q,y,e0*2,_,0,1,1,h);for(var Y=0;Y<t0;Y++)T[4*Y]=q[2*Y],T[4*Y+1]=q[2*Y+1]}for(var Q=T.slice(0),N=0;N<x;N++)if(R==2)for(var E=0;E<S;E++){var O=(N*S+E)*v,a0=((N>>>1)*e0+(E>>>1))*B,h0=(N&1)*2+(E&1);T[O]=Q[a0+h0],T[O+1]=Q[a0+4],T[O+2]=Q[a0+5]}else for(var E=0;E<S;E++){var O=(N*S+E)*v,a0=(N*e0+(E>>>1))*B,h0=E&1;T[O]=Q[a0+h0],T[O+1]=Q[a0+2],T[O+2]=Q[a0+3]}}else if(u(T,S*v,F,L,v,x),W==0)f(T,y,S,x,0,v,v,h);else for(var u0=Math.floor(W/S),N=0;N<x;N+=u0){var i0=T.slice(N*S*v,(N+u0)*S*v);f(i0,y,S,u0,0,v,v,h),T.set(i0,N*S*v)}}return T}function f(d,c,y,h,W,p,l,L){for(var v=y*l,x=W;x<p;x++)d[x]+=1<<L-1;for(var S=l;S<v;S+=l)for(var x=W;x<p;x++)d[S+x]+=d[S+x-l];for(var I=1;I<h;I++){for(var M=I*v,x=W;x<p;x++)d[M+x]+=d[M+x-v];for(var S=l;S<v;S+=l)for(var x=W;x<p;x++){var Y=M+S+x,K=Y-v,D=d[Y-l],J=0;if(c==0)J=0;else if(c==1)J=D;else if(c==2)J=d[K];else if(c==3)J=d[K-l];else if(c==4)J=D+(d[K]-d[K-l]);else if(c==5)J=D+(d[K]-d[K-l]>>>1);else if(c==6)J=d[K]+(D-d[K-l]>>>1);else if(c==7)J=D+d[K]>>>1;else throw c;d[Y]+=J}}}return z}();(function(){var e=0,t=1,r=2,s=3,o=4,n=5,i=6,a=7,Z=8,m=9,G=10,u=11,b=12,g=13,z=14,f=15,d=16,c=17,y=18;function h(V){var X=P._binBE.readUshort,w={b:X(V,0),i:V[2],C:V[3],u:V[4],q:X(V,5),k:X(V,7),e:X(V,9),l:X(V,11),s:V[13],d:X(V,14)};if(w.b!=18771||w.i>1||w.q<6||w.q%6||w.e<768||w.e%24||w.l!=768||w.k<w.l||w.k%w.l||w.k-w.e>=w.l||w.s>16||w.s!=w.k/w.l||w.s!=Math.ceil(w.e/w.l)||w.d!=w.q/6||w.u!=12&&w.u!=14&&w.u!=16||w.C!=16&&w.C!=0)throw"Invalid data";if(w.i==0)throw"Not implemented. We need this file!";return w.h=w.C==16,w.m=(w.h?w.l*2/3:w.l>>>1)|0,w.A=w.m+2,w.f=64,w.g=(1<<w.u)-1,w.n=4*w.u,w}function W(V,X){var w=new Array(X.s),T=4*X.s,F=16+T;T&12&&(F+=16-(T&12));for(var j=0,H=16;j<X.s;H+=4){var R=P._binBE.readUint(V,H);w[j]=V.slice(F,F+R),w[j].j=0,w[j].a=0,F+=R,j++}if(F!=V.length)throw"Invalid data";return w}function p(V,X){for(var w=-X[4],T=0;w<=X[4];T++,w++)V[T]=w<=-276?-4:w<=-67?-3:w<=-18?-2:w<-0?-1:w<=X[0]?0:w<X[1]?1:w<X[2]?2:w<X[3]?3:4}function l(V,X,w){var T=[X,3*X+18,5*X+67,7*X+276,w];V.o=X,V.w=(T[4]+2*X)/(2*X+1)+1|0,V.v=Math.ceil(Math.log2(V.w)),V.t=9,p(V.c,T)}function L(V){var X={c:new Int8Array(2<<V.u)};return l(X,0,V.g),X}function v(V){for(var X=[[],[],[]],w=Math.max(2,V.w+32>>>6),T=0;T<3;T++)for(var F=0;F<41;F++)X[T][F]=[w,1];return X}function x(V){for(var X=-1,w=0;!w;X++)w=V[V.j]>>>7-V.a&1,V.a++,V.a&=7,V.a||V.j++;return X}function S(V,X){var w=0,T=8-V.a;if(V.j,V.a,X){if(X>=T)do w<<=T,X-=T,w|=V[V.j]&(1<<T)-1,V.j++,T=8;while(X>=8);X&&(w<<=X,T-=X,w|=V[V.j]>>>T&(1<<X)-1),V.a=8-T}return w}function I(V,X){var w=0;if(X<V)for(;w<=14&&X<<++w<V;);return w}function M(V,X,w,T,F,j,H,R){R==null&&(R=0);var k=j+1,E=k%2,N=0,r0,B,s0=T[F],e0=T[F-1],_=T[F-2][k],t0=e0[k-1],q=e0[k],Q=e0[k+1],O=s0[k-1],a0=s0[k+1],h0=Math.abs,u0,i0,V0,c0;if(E&&(u0=h0(Q-q),i0=h0(_-q),V0=h0(t0-q)),E){if(c0=u0>V0&&i0<u0?_+t0:u0<V0&&i0<V0?_+Q:Q+t0,c0=c0+2*q>>>2,R){s0[k]=c0;return}r0=X.t*X.c[V.g+q-_]+X.c[V.g+t0-q]}else c0=q>t0&&q>Q||q<t0&&q<Q?a0+O+2*q>>>2:O+a0>>>1,r0=X.t*X.c[V.g+q-t0]+X.c[V.g+t0-O];B=h0(r0);var p0=x(w);if(p0<V.n-X.v-1){var f0=I(H[B][0],H[B][1]);N=S(w,f0)+(p0<<f0)}else N=S(w,X.v)+1;N=N&1?-1-(N>>>1):N>>>1,H[B][0]+=h0(N),H[B][1]==V.f&&(H[B][0]>>>=1,H[B][1]>>>=1),H[B][1]++,c0=r0<0?c0-N:c0+N,V.i&&(c0<0?c0+=X.w:c0>V.g&&(c0-=X.w)),s0[k]=c0>=0?Math.min(c0,V.g):0}function Y(V,X,w){for(var T=V[0].length,F=X;F<=w;F++)V[F][0]=V[F-1][1],V[F][T-1]=V[F-1][T-2]}function K(V){Y(V,a,b),Y(V,r,o),Y(V,f,c)}function D(V,X,w,T,F,j,H,R,k,E,N,r0,B){for(var s0=0,e0=1,_=F<g&&F>o;e0<V.m;)s0<V.m&&(M(V,X,w,T,F,s0,H[k],V.h&&(_&&E||!_&&(N||(s0&r0)==B))),M(V,X,w,T,j,s0,H[k],V.h&&(!_&&E||_&&(N||(s0&r0)==B))),s0+=2),s0>8&&(M(V,X,w,T,F,e0,R[k]),M(V,X,w,T,j,e0,R[k]),e0+=2);K(T)}function J(V,X,w,T,F,j){D(V,X,w,T,r,a,F,j,0,0,1,0,8),D(V,X,w,T,Z,f,F,j,1,0,1,0,8),D(V,X,w,T,s,m,F,j,2,1,0,3,0),D(V,X,w,T,G,d,F,j,0,0,0,3,2),D(V,X,w,T,o,u,F,j,1,0,0,3,2),D(V,X,w,T,b,c,F,j,2,1,0,3,0)}function U(V,X,w,T,F,j){var H=j.length,R=V.l;F+1==V.s&&(R=V.e-F*V.l);for(var k=6*V.e*T+F*V.l,E=0;E<6;E++){for(var N=0;N<R;N++){var r0=j[E%H][N%H],B;r0==0?B=r+(E>>>1):r0==2?B=f+(E>>>1):B=a+E;var s0=V.h?(N*2/3&2147483646|N%3&1)+(N%3>>>1):N>>>1;X[k+N]=w[B][s0+1]}k+=V.e}}P._decompressRAF=function(V,X){var w=h(V),T=W(V,w),F=L(w),j=new Int16Array(w.e*w.q);X==null&&(X=w.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var H=[[e,s],[t,o],[n,u],[i,b],[g,d],[z,c]],R=[],k=0;k<y;k++)R[k]=new Uint16Array(w.A);for(var E=0;E<w.s;E++){for(var N=v(F),r0=v(F),k=0;k<y;k++)for(var B=0;B<w.A;B++)R[k][B]=0;for(var s0=0;s0<w.d;s0++){J(w,F,T[E],R,N,r0);for(var k=0;k<6;k++)for(var B=0;B<w.A;B++)R[H[k][0]][B]=R[H[k][1]][B];U(w,j,R,s0,E,X);for(var k=r;k<y;k++)if([n,i,g,z].indexOf(k)==-1)for(var B=0;B<w.A;B++)R[k][B]=0;K(R)}}return j}})();performance.now();new M0;new M0;class je extends D0{constructor(t){super(t),W0(this,"token",""),W0(this,"format","webp"),W0(this,"style","mapbox.satellite"),W0(this,"attribution","MapBox"),W0(this,"maxLevel",19),W0(this,"url","https://api.mapbox.com/v4/{style}/{z}/{x}/{y}.{format}?access_token={token}"),Object.assign(this,t)}}class De extends D0{constructor(t){super(t),W0(this,"dataType","image"),W0(this,"attribution","[GS(2021)6375]"),W0(this,"style","8"),W0(this,"subdomains","1234"),W0(this,"maxLevel",18),W0(this,"url","https://webst0{s}.is.autonavi.com/appmaptile?style={style}&x={x}&y={y}&z={z}"),Object.assign(this,t)}}new M0;new E1;new J1().load("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");function w0(e,t){this.x=e,this.y=t}w0.prototype={clone(){return new w0(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),r=Math.sin(e),s=t*this.x-r*this.y,o=r*this.x+t*this.y;return this.x=s,this.y=o,this},_rotateAround(e,t){const r=Math.cos(e),s=Math.sin(e),o=t.x+r*(this.x-t.x)-s*(this.y-t.y),n=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=o,this.y=n,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:w0};w0.convert=function(e){if(e instanceof w0)return e;if(Array.isArray(e))return new w0(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new w0(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};typeof TextDecoder>"u"||new TextDecoder("utf-8");let Xt=null;R0.add=async function(e,t){R0.enabled};R0.get=function(e){R0.enabled};new M0;new D1;const K0=await j0("three"),Ee=(e,t,r,s="#informationDiv")=>{const o=document.querySelector(s);if(o){const n=new K0.Vector2;t.addEventListener("pointermove",i=>{n.x=i.clientX/t.clientWidth*2-1,n.y=-(i.clientY/t.clientHeight)*2+1;const a=r.getLocalInfoFromScreen(e,n);a?o.innerHTML=`:${a.location.x.toFixed(3)}  
                            :${a.location.y.toFixed(3)}  
                            :${(a.location.z*1e3).toFixed(1)}m
                            :${a.distance.toFixed(3)}km `:o.innerHTML=""})}},A1=1,Je=(e,t,r)=>{e.addEventListener("change",()=>{const s=Math.max(e.getPolarAngle(),.1),o=Math.max(e.getDistance(),.1);r.fog instanceof K0.FogExp2&&(r.fog.density=s/(o+5)*A1*.25)})},Ce=(e,t,r,s)=>{const o=e.geo2map(new K0.Vector3(t.x,t.y)),n=e.geo2map(new K0.Vector3(r.x,r.y));return new K0.Vector3(n.x-o.x,n.y-o.y,s)},O1={},{openBlock:_1,createElementBlock:q1}=await j0("vue"),$1={id:"informationDiv"};function te(e,t){return _1(),q1("div",$1)}const Ne=Pt(O1,[["render",te],["__scopeId","data-v-d511bb21"]]);export{je as $s,Je as controlsEvents,De as en,Ne as informationDiv,gt as pt,Ce as scaleImg,Ee as showLocation};
