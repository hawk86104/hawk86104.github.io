import{importShared as e}from"./3d-tiles-renderer.HXNTGnH81769411460564.js";import{initShaders as t,resizeCanvasToDisplaySize as r,create as a,perspective as n,rotate as i,lookAt as E,multiply as o,degToRad as T}from"./ice-utils.bUSDtp9-1769411460564.js";const{defineComponent:_}=await e("vue"),{openBlock:R,createElementBlock:u}=await e("vue"),A={id:"canvaswebgl",style:{height:"500px",width:"500px"}},{onMounted:c}=await e("vue"),F=_({__name:"webglFrameBuffer",setup(e){const _=function(){const e=document.querySelector("#canvaswebgl"),_=e?.getContext("webgl");if(!_)return;var R=t(_,"\nattribute vec4 a_position;\nattribute vec2 a_texcoord;\nuniform mat4 u_matrix;\nvarying vec2 v_texcoord;\nvoid main() {\n  gl_Position = u_matrix * a_position;\n  v_texcoord = a_texcoord;\n}","\nprecision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nvoid main(){\n\tgl_FragColor=texture2D(u_texture, v_texcoord.xy);\n}\n"),u=_.getAttribLocation(R,"a_position"),A=_.getAttribLocation(R,"a_texcoord"),c=_.getUniformLocation(R,"u_matrix"),F=_.getUniformLocation(R,"u_texture"),f=_.createBuffer();_.bindBuffer(_.ARRAY_BUFFER,f),function(e){var t=new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5]);e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)}(_);var m=_.createBuffer();_.bindBuffer(_.ARRAY_BUFFER,m),function(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW)}(_);var U=_.createTexture();_.bindTexture(_.TEXTURE_2D,U);{const e=0,t=_.RGBA,r=1,a=1,n=0,i=_.RGBA,E=_.UNSIGNED_BYTE,o=new Uint8Array([255,255,0,255]),T=1;_.pixelStorei(_.UNPACK_ALIGNMENT,T),_.texImage2D(_.TEXTURE_2D,e,t,r,a,n,i,E,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.NEAREST),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE)}const x=_.createTexture();_.bindTexture(_.TEXTURE_2D,x);{const e=0,t=_.RGBA,r=0,a=_.RGBA,n=_.UNSIGNED_BYTE,i=null;_.texImage2D(_.TEXTURE_2D,e,t,256,256,r,a,n,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE)}const l=_.createFramebuffer();_.bindFramebuffer(_.FRAMEBUFFER,l);const v=_.COLOR_ATTACHMENT0;_.framebufferTexture2D(_.FRAMEBUFFER,v,_.TEXTURE_2D,x,0);var b=T(0),s=0;function B(e){_.useProgram(R),_.enableVertexAttribArray(u),_.bindBuffer(_.ARRAY_BUFFER,f);var t=3,r=_.FLOAT,T=!1,U=0,x=0;_.vertexAttribPointer(u,t,r,T,U,x),_.enableVertexAttribArray(A),_.bindBuffer(_.ARRAY_BUFFER,m);t=2,r=_.FLOAT,T=!1,U=0,x=0;_.vertexAttribPointer(A,t,r,T,U,x);var l=a();n(l,-30,e,.1,1e4);let v=a();v=i(v,v,b,[0,1,0]);var s=a();E(s,[0,0,2],[0,0,0],[0,1,0]);let B=a();o(B,s,v);var d=a();o(d,l,B),_.uniformMatrix4fv(c,!1,d),_.uniform1i(F,0),_.drawArrays(_.TRIANGLES,0,36)}requestAnimationFrame(function e(t){var a=(t*=.001)-s;s=t,b+=-.4*a,r(_.canvas),_.enable(_.CULL_FACE),_.enable(_.DEPTH_TEST);_.bindFramebuffer(_.FRAMEBUFFER,l),_.bindTexture(_.TEXTURE_2D,U),_.viewport(0,0,256,256),_.clearColor(0,1,0,1),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);B(1);_.bindFramebuffer(_.FRAMEBUFFER,null),_.bindTexture(_.TEXTURE_2D,x),_.viewport(0,0,_.canvas.width,_.canvas.height),_.clearColor(1,1,1,1),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT);B(_.canvas.clientWidth/_.canvas.clientHeight);requestAnimationFrame(e)})};return c(()=>{_()}),(e,t)=>(R(),u("canvas",A))}});export{F as default};
