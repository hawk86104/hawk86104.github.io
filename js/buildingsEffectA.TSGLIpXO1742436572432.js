import{P as t}from"./tweakpane.yDiyAAkA1742436572432.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.5K_nrXAQ1742436572432.js";import{e}from"./@tresjs.Uh9iM8du1742436572432.js";import{z as r}from"./three-custom-shader-material.BcjKDN_X1742436572432.js";import{$ as i,a0 as u,_ as c,C as a,cq as s,l,b9 as f}from"./three.RUAk_tvU1742436572432.js";import{d as p,a2 as d,w as m,o as v,H as g,u as h,a3 as y,r as C,f as w,g as _,j as b,m as x}from"./@vue.deO5D3Lf1742436572432.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1742436572432.js";import"./postprocessing.5QD_59xS1742436572432.js";import"./@vueuse.F4UpVCIS1742436572432.js";const I=M;function M(t,n){const o=F();return(M=function(t,n){return o[t-=432]})(t,n)}!function(t,n){const o=M,e=F();for(;;)try{if(616978===-parseInt(o(448))/1+parseInt(o(467))/2*(parseInt(o(460))/3)+-parseInt(o(462))/4*(-parseInt(o(466))/5)+-parseInt(o(445))/6*(-parseInt(o(450))/7)+-parseInt(o(483))/8*(-parseInt(o(486))/9)+parseInt(o(472))/10*(parseInt(o(489))/11)+-parseInt(o(470))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){S(this,(function(){const t=M,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(480),"i"),e=O(t(488));n[t(436)](e+"chain")&&o[t(436)](e+t(454))?O():e("0")}))()}();const T=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(449)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();T(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(469)+t(432)+");")()}catch(o){n=window}return n}(),o=n[t(443)]=n[t(443)]||{},e=[t(465),t(439),"info",t(441),t(438),"table","trace"];for(let r=0;r<e[t(464)];r++){const n=T[t(461)][t(463)][t(437)](T),i=e[r],u=o[i]||n;n[t(479)]=T[t(437)](T),n[t(444)]=u[t(444)][t(437)](u),o[i]=n}}))();const j=["object"],P=p({__name:"bModel",props:{model:{},bulidingsColor:{default:I(457)},landColor:{default:"#112233"},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=I,o=t,a=o[n(473)][n(481)];o.model[n(473)][n(490)][0].material=new i({color:n(442)}),a[n(456)]=1001;const s=o[n(473)][n(468)];(()=>{const t=n,{geometry:e}=a;e.computeBoundingBox(),e[t(471)]();const{max:i,min:s}=e[t(475)];if(a[t(476)][t(477)])return;const l=new r({baseMaterial:a.material,vertexShader:t(491),fragmentShader:t(455),silent:!0,uniforms:{uMax:{value:i},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(c[t(452)])(o.bulidingsColor)},uOpacity:{value:o[t(459)]},uLightColor:{value:new(c[t(452)])(t(451))},uTopColor:{value:new(c[t(452)])(o[t(484)])},uTime:{value:0},uGradient:{value:o.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:u});a.material[t(453)](),a.material=l})();const{onLoop:l}=e();l((({delta:t})=>{a.material.uniforms.uTime.value+=t})),d((()=>{const t=n;o[t(487)]&&a[t(476)][t(478)][t(434)][t(482)].setStyle(o[t(487)]),o.landColor&&((t,e)=>{const r=n;let i;"cu"===t||t===r(468)&&(i=Array.isArray(s[r(476)])?s.material:[s.material],i[r(447)]((t=>{const n=r;t[e][n(433)](o.landColor),t.side=u})))})("land","color"),o[t(459)]&&(a[t(476)][t(478)].uOpacity[t(482)]=o.opacity)})),m(o,((t,o)=>{const e=n;a[e(476)][e(478)].uGradient[e(482)]=t.gradient}));const f=o[n(473)][n(473)][n(435)]();return(t,o)=>{const e=n;return v(),g(e(440),{object:h(f)},null,8,j)}}});function O(t){function n(t){const o=M;if("string"==typeof t)return function(t){}[o(461)]("while (true) {}").apply("counter");1!==(""+t/t)[o(464)]||t%20==0?function(){return!0}[o(461)](o(474)+"gger").call(o(458)):function(){return!1}[o(461)](o(474)+o(446))[o(449)](o(485)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function F(){const t=["Color","dispose","input","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","renderOrder","#e523ff","action","opacity","417468DpkjJT","constructor","8dVmyvB","prototype","length","log","1068505cupvUY","16DVSftK","land","return (function() ","21801888MHJEeP","computeBoundingSphere","4330obahGZ","model","debu","boundingBox","material","__csm","uniforms","__proto__","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","city","value","8NwunvC","topColor","stateObject","1129671vhSMkP","bulidingsColor","init","3751OkvPiC","children","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",'{}.constructor("return this")( )',"setStyle","uColor","clone","test","bind","exception","warn","primitive","error","#ffff00","console","toString","6UMlmcK","gger","forEach","10139FQUWNN","apply","4410833GyNlfv","#ffffff"];return(F=function(){return t})()}const B=Z;!function(t,n){const o=Z,e=E();for(;;)try{if(115385===parseInt(o(361))/1+-parseInt(o(352))/2+parseInt(o(325))/3+-parseInt(o(370))/4+parseInt(o(353))/5+parseInt(o(360))/6*(-parseInt(o(359))/7)+parseInt(o(331))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(321)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){R(this,(function(){const t=Z,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=k("init");n[t(336)](e+t(327))&&o[t(336)](e+t(349))?k():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(321)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=Z,n=function(){const t=Z;let n;try{n=Function(t(356)+t(372)+");")()}catch(o){n=window}return n}(),o=n[t(367)]=n.console||{},e=[t(369),t(337),t(323),"error","exception","table",t(362)];for(let r=0;r<e[t(339)];r++){const n=z[t(357)][t(324)][t(347)](z),i=e[r],u=o[i]||n;n[t(338)]=z[t(347)](z),n[t(334)]=u[t(334)][t(347)](u),o[i]=n}}))();const A=["object"];function E(){const t=["builds","toString","value","test","warn","__proto__","length","scale","stateObject","#000","uColor","#FFF","geometry","uSrcColor","bind","uniforms","input","linewidth","width","365634viTPTm","350255PWDIFZ","srcColor","renderOrder","return (function() ","constructor","debu","161pqDFTN","29658HuBpCI","108662MRQSVH","trace","uTime","material","matrix","action","console","color","log","555184TCIwNO","clone",'{}.constructor("return this")( )',"bLine","counter","apply","uGradual","info","prototype","318234mPtKuM","gradual","chain","speed","string","gger","2127168IhEwuu","while (true) {}"];return(E=function(){return t})()}const G=p({__name:B(319),props:{builds:{},color:{default:B(344)},srcColor:{default:B(342)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new a(o[n(368)])},uSrcColor:{value:new a(o[n(354)])},uScale:{value:o[n(340)]},uTime:{value:0},uGradual:{value:o[n(326)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new s(o.builds[n(345)])[n(371)]();u=u.applyMatrix4(o[n(333)][n(365)]);const c=new l(i);r=new f(u,c),r[n(364)][n(350)]=o[n(351)],r[n(355)]=1e3,d((()=>{const t=n;o[t(368)]&&(i[t(348)][t(343)].value=new a(o.color)),o.srcColor&&(i[t(348)][t(346)][t(335)]=new a(o[t(354)])),o[t(340)]&&(i[t(348)].uScale[t(335)]=o[t(340)]),o[t(326)]&&(i[t(348)][t(322)][t(335)]=o.gradual)}));const{onLoop:p}=e();return p((({delta:t})=>{const e=n;i.uniforms[e(363)][e(335)]+=t*o[e(328)],i[e(348)].uTime[e(335)]%=1})),(t,n)=>(v(),g("primitive",{object:h(r)},null,8,A))}});function Z(t,n){const o=E();return(Z=function(t,n){return o[t-=319]})(t,n)}function k(t){function n(t){const o=Z;if(typeof t===o(329))return function(t){}[o(357)](o(332)).apply(o(320));1!==(""+t/t)[o(339)]||t%20==0?function(){return!0}.constructor(o(358)+o(330)).call(o(366)):function(){return!1}.constructor("debugger")[o(321)](o(341)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=N;function L(){const t=["3743964SETkwJ",'{}.constructor("return this")( )',"log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","toString","stateObject","1051011qzUMPU","model","#112233","action","buildingsEffectA","#000","srcColor","function *\\( *\\)","init","#999","apply","debu","table","线原颜色","最大扩散","17757pLKDfz","7153040TYJRcS","#FFF","4roPMiA","100573ZgRjbs","trace","test","length","gradual","gger","color","console","28CveRno","exception","addBinding","call","扩散系数","3132465IobeRS","constructor","659418fLcxUa","8660zRfawV","bind","input","__proto__","counter","warn","return (function() ","线扫颜色"];return(L=function(){return t})()}!function(t,n){const o=N,e=L();for(;;)try{if(826127===-parseInt(o(370))/1*(parseInt(o(378))/2)+-parseInt(o(400))/3+parseInt(o(369))/4*(parseInt(o(383))/5)+-parseInt(o(385))/6+-parseInt(o(394))/7+parseInt(o(367))/8+-parseInt(o(366))/9*(-parseInt(o(386))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){H(this,(function(){const t=N,n=new RegExp(t(407)),o=new RegExp(t(397),"i"),e=W(t(408));n[t(372)](e+"chain")&&o[t(372)](e+t(388))?W():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(410)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function N(t,n){const o=L();return(N=function(t,n){return o[t-=362]})(t,n)}$(void 0,(function(){const t=N,n=function(){const t=N;let n;try{n=Function(t(392)+t(395)+");")()}catch(o){n=window}return n}(),o=n[t(377)]=n[t(377)]||{},e=[t(396),t(391),"info","error",t(379),t(363),t(371)];for(let r=0;r<e[t(373)];r++){const n=$.constructor.prototype[t(387)]($),i=e[r],u=o[i]||n;n[t(389)]=$[t(387)]($),n[t(398)]=u[t(398)][t(387)](u),o[i]=n}}))();const U=p({__name:D(404),async setup(e){const r=D;let i,u;const c=([i,u]=y((()=>o())),i=await i,u(),i),a=C({color:r(368),srcColor:r(405),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:"效果参数",expanded:!0});return s[r(380)](a,r(406),{label:r(364)}),s[r(380)](a,r(376),{label:r(393)}),s[r(380)](a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(380)](a,"scale",{label:r(365),min:10,max:2e3,step:10}),s.addBinding(a,r(374),{label:r(382),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return v(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:_((()=>[b(P,{model:h(c),bulidingsColor:"#000000",landColor:e(402),topColor:e(409)},null,8,[e(401)]),b(G,x({builds:h(c).city},a),null,16,["builds"])])),_:1})}}});function W(t){function n(t){const o=N;if("string"==typeof t)return function(t){}[o(384)]("while (true) {}")[o(410)](o(390));1!==(""+t/t).length||t%20==0?function(){return!0}[o(384)]("debu"+o(375))[o(381)](o(403)):function(){return!1}[o(384)](o(362)+o(375))[o(410)](o(399)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as default};
