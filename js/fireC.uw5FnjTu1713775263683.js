import{_ as Ae}from"./pagesShow.vue_vue_type_script_setup_true_lang.3TcQnIkz1713775263683.js";import{bP as ge,c8 as _e,bL as xe,ap as ze,c9 as be,aw as ve,bt as Ce,bB as Fe,b3 as Me,bi as U,bk as De,a1 as te,aD as Pe,a4 as ke,o as O,c as Ve,L as Be,a9 as Le,x as N,E as ee,ag as Oe,a as He}from"./vendor.KaB9nKOc1713775263683.js";import"./vanilla.8mIZIIXT1713775263683.js";import"./_commonjsHelpers.5-cIlDoe1713775263683.js";import"./LineSegments2.nWOgtEWk1713775263683.js";const Re=({startFrame:p,endFrame:d,fps:h,frameName:n,textureDataURL:S,textureImageURL:w,loop:A,numberOfFrames:b,autoPlay:se,animationNames:re,onStart:H,onEnd:R,onLoopEnd:W,onFrame:Y,play:X,pause:v,flipX:ae,alphaTest:m,asSprite:C})=>{let l={frames:[],meta:{version:"1.0",size:{w:1,h:1},scale:"1"}},j=!1,F=new ge;const M=new _e({toneMapped:!1,transparent:!0,map:F,alphaTest:m!=null?m:0}),G=new xe({toneMapped:!1,side:ze,map:F,transparent:!0,alphaTest:m!=null?m:0}),g=new be(M),D=new ve(new Ce(1,1),G);let i=M,y=g;const u=new Fe;u.add(y);let I=window.performance.now(),f=p||0,P=n||"";const E=1e3/(h||30),ne=e=>{F=e,i&&(i.map=e)},ie=new Me(1,1,1),oe=e=>{ie.copy(e)},$=ae?-1:1;let k=C!=null?C:!0;(e=>{k=e,k?(i=M,y=g,u.add(g),u.remove(D)):(i=G,y=D,u.remove(g),u.add(D))})(k);async function ce(e,t,r){const s=new U,o=fetch(e).then(a=>a.json()),c=new Promise(a=>{s.load(t,a)});await Promise.all([o,c]).then(a=>{r(a[0],a[1])})}const J=(e,t)=>{const r=t/e;return y.scale.set(1,r,1),y.scale},le=async()=>{if(S&&w)await ce(S,w,K);else if(w){const t=await new U().loadAsync(w);K(null,t)}},fe=e=>{n=e,P!==n&&n&&(f=0,P=n)},pe=()=>{v=!0},me=()=>{X=!0,v=!1},K=(e,t)=>{if(e===null){if(t&&b){const r=t.image.width,s=t.image.height,o=r/b,c=s;if(l={frames:[],meta:{version:"1.0",size:{w:r,h:s},scale:"1"}},parseInt(o.toString(),10)===o)for(let a=0;a<b;a++)l.frames.push({frame:{x:a*o,y:0,w:o,h:c},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:o,h:c},sourceSize:{w:o,h:s}})}}else if(t){l=e,l.frames=Array.isArray(e.frames)?e.frames:ue();const{w:r,h:s}=q(e.frames).sourceSize,o=J(r,s);oe(o),i&&(i.map=t)}t.premultiplyAlpha=!1,ne(t),de()},ue=()=>{const e={},t=l,r=re;if(r)for(let s=0;s<r.length;s++){e[r[s]]=[];for(const o in t.frames){const c=t.frames[o],a=c.frame,_=a.x,x=a.y,V=a.w,B=a.h,L=c.sourceSize.w,z=c.sourceSize.h;typeof o=="string"&&o.toLowerCase().indexOf(r[s].toLowerCase())!==-1&&e[r[s]].push({x:_,y:x,w:V,h:B,frame:a,sourceSize:{w:L,h:z}})}}return e},de=()=>{if(!(l&&i.map))return;const{meta:{size:e},frames:t}=l,{w:r,h:s}=Array.isArray(t)?t[0].sourceSize:n?t[n]?t[n][0].sourceSize:{w:0,h:0}:{w:0,h:0};i.map.wrapS=i.map.wrapT=De,i.map.center.set(0,0),i.map.repeat.set(1*$/(e.w/r),1/(e.h/s));const c=1/((e.h-1)/s);i.map.offset.x=0,i.map.offset.y=1-c,H&&H({currentFrameName:n,currentFrame:f})},he=()=>{if(!(l&&i.map))return;const e=window.performance.now(),t=e-I,{meta:{size:r},frames:s}=l,{w:o,h:c}=q(s).sourceSize,a=Array.isArray(s)?s:n?s[n]:[];let _=0,x=0;const V=d||a.length-1;if(f>V&&(f=A&&p!=null?p:0,A?W==null||W({currentFrameName:n,currentFrame:f}):(R==null||R({currentFrameName:n,currentFrame:f}),j=!0),!A)||t<=E)return;I=e-t%E,J(o,c);const B=(r.w-1)/o,L=(r.h-1)/c,{frame:{x:z,y:ye},sourceSize:{w:Q,h:Se}}=a[f],Z=1/B,T=1/L;_=$>0?Z*(z/Q):Z*(z/Q)-i.map.repeat.x,x=Math.abs(1-T)-T*(ye/Se),i.map.offset.x=_,i.map.offset.y=x,f+=1},we=()=>{var e,t;!((e=l)!=null&&e.frames)||!((t=i)!=null&&t.map)||v||!j&&(se||X)&&(he(),Y&&Y({currentFrameName:P,currentFrame:f}))},q=e=>{if(Array.isArray(e))return e[0];if(typeof e=="object"&&e!==null){const t=Object.keys(e);return e[t[0]][0]}else return{w:0,h:0}};return{group:u,init:le,update:we,playAnimation:me,pauseAnimation:pe,setFrameName:fe}},We=["object"],Ye=te({__name:"fireC",async setup(p){let d,h;const n=Re({startFrame:0,fps:40,autoPlay:!0,loop:!0,textureImageURL:"./plugins/digitalCity/image/spriteAnimator/flame.png",textureDataURL:"./plugins/digitalCity/image/spriteAnimator/flame.json",alphaTest:.101,asSprite:!0});[d,h]=Pe(()=>n.init()),await d,h(),n.group.children[0].material.map.colorSpace=ke;const{onLoop:S}=Le();return S(()=>{n.update()}),(w,A)=>(O(),Ve("primitive",{object:Be(n).group,renderOrder:9999},null,8,We))}}),Je=te({__name:"fireC",setup(p){return(d,h)=>(O(),N(Ae,null,{ability:ee(()=>[(O(),N(Oe,null,{default:ee(()=>[He(Ye,{position:[0,70,0],scale:100})]),_:1}))]),_:1}))}});export{Je as default};
