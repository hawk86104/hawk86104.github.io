import{importShared as d}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{degToRad as c}from"./MathUtils.CinN5xAo1767148983502.js";import{gsapWithCSS as w}from"./index.Cpf5Yeb11767148983502.js";import"./customShaderMaterial.vue_vue_type_script_setup_true_lang.B7dQ_CiZ1767148983502.js";import"./index.vue_vue_type_script_setup_true_lang.CjsHShHS1767148983502.js";import{useSeek as L}from"./useSeek.BLQ2gt3M1767148983502.js";import{Pz as G,Sz as N,_export_sfc as V}from"./index.DTe2qqjO1767148983502.js";const{defineComponent:b}=await d("vue"),{createElementVNode:l,unref:z,withCtx:P,createVNode:F,renderList:C,Fragment:_,openBlock:a,createElementBlock:u,createBlock:A}=await d("vue"),I=["position"],q=["position"],{shallowRef:h,computed:D,watch:O,reactive:W}=await d("vue"),j=b({__name:"repulsionEffectSence",setup(R){const p=h(null),f=h(null),o=W({rows:6,cols:14,gutter:2.2}),m=D(()=>{const e=(o.cols-1)*o.gutter/2,t=(o.rows-1)*o.gutter/2;return{x:e,z:t}}),{seekAll:E}=L();O(f,()=>{p.value=E(f.value,"type","Mesh"),p.value.forEach(e=>{e.initialRotation={x:e.name==="torus"?c(90):e.rotation.x,y:e.rotation.y,z:e.name==="cone"||e.name==="cylinder"?c(-180):e.rotation.z},e.rotation.x=e.initialRotation.x,e.rotation.y=e.initialRotation.y,e.rotation.z=e.initialRotation.z})});const S=({point:e})=>{if(!p.value)return;const{x:t,y:r,z:s}=e;p.value.forEach(n=>{const B=$(t,s,n.position.x,n.position.z),T=y(B,7,0,0,6);w.to(n.position,{y:T<1?1:T,duration:.3});const k=n.position.y/1.2,v=k<1?1:k;w.to(n.scale,{ease:"expo.out",x:v,y:v,z:v,duration:.3}),w.to(n.rotation,{duration:.7,ease:"expo.out",x:y(n.position.y,-1,1,c(270),n.initialRotation.x),z:y(n.position.y,-1,1,c(-90),n.initialRotation.z),y:y(n.position.y,-1,1,c(45),n.initialRotation.y)})})},$=(e,t,r,s)=>Math.sqrt((e-r)**2+(t-s)**2),y=(e,t,r,s,n)=>(e-t)/(r-t)*(n-s)+s,x=(e,t)=>{const r=Math.floor(Math.random()*3);return r===0?"torus":r===1?"cone":"cylinder"},g=(e,t)=>[(e-1)*o.gutter-m.value.x,0,(t-1)*o.gutter-m.value.z];return(e,t)=>(a(),u(_,null,[F(z(G),{"receive-shadow":"",args:[100,100],"rotation-x":-Math.PI/2,position:[0,0,0],onPointermove:S},{default:P(()=>[...t[0]||(t[0]=[l("TresShadowMaterial",{transparent:"",opacity:.3},null,-1)])]),_:1},8,["rotation-x"]),l("TresGroup",{ref_key:"shapesGroupRef",ref:f,name:"shapes"},[(a(!0),u(_,null,C(o.rows,r=>(a(),u("TresGroup",{key:`row-${r}`},[(a(!0),u(_,null,C(o.cols,s=>(a(),u("TresGroup",{key:`col-${s}-${r}`},[x()==="torus"?(a(),u("TresMesh",{key:0,name:"torus","cast-shadow":"","receive-shadow":"",position:g(s,r)},[...t[1]||(t[1]=[l("TresTorusGeometry",{args:[.25,.08,30,200]},null,-1),l("TresMeshPhysicalMaterial",{color:"#3e2917",metalness:.58,emissive:"#000000",roughness:.05},null,-1)])],8,I)):x()==="cone"?(a(),A(z(N),{key:1,name:"cone",args:[.3,.5,32],"cast-shadow":"","receive-shadow":"",position:g(s,r)},{default:P(()=>[...t[2]||(t[2]=[l("TresMeshPhysicalMaterial",{color:"#3e2917",metalness:.58,emissive:"#000000",roughness:.05},null,-1)])]),_:1},8,["position"])):(a(),u("TresMesh",{key:2,name:"cylinder","cast-shadow":"","receive-shadow":"",position:g(s,r)},[...t[3]||(t[3]=[l("TresCylinderGeometry",{args:[.3,.3,.2,64]},null,-1),l("TresMeshPhysicalMaterial",{color:"#3e2917",metalness:.58,emissive:"#000000",roughness:.05},null,-1)])],8,q))]))),128))]))),128))],512)],64))}}),{defineComponent:H}=await d("vue"),{createElementVNode:i,createVNode:M,resolveComponent:J,normalizeProps:K,guardReactiveProps:Q,withCtx:U,Fragment:X,openBlock:Y,createElementBlock:Z}=await d("vue"),oo=H({__name:"repulsionEffect",setup(R){const p={alpha:!0,shadows:!0,powerPreference:"high-performance",windowSize:!0,clearAlpha:0};return(f,o)=>{const m=J("TresCanvas");return Y(),Z(X,null,[o[8]||(o[8]=i("div",{class:"repulsion-effect__content"},[i("h2",null,"ICE.GL"),i("h3",null,"图形学社区")],-1)),o[9]||(o[9]=i("div",{class:"repulsion-effect__bg"},null,-1)),M(m,K(Q(p)),{default:U(()=>[o[0]||(o[0]=i("TresPerspectiveCamera",{position:[0,65,0],"rotation-x":-1.57,fov:20},null,-1)),o[1]||(o[1]=i("TresAmbientLight",{color:"#ffffff"},null,-1)),o[2]||(o[2]=i("TresPointLight",{color:"#fff000",intensity:5,decay:0,position:[0,5,-20]},null,-1)),o[3]||(o[3]=i("TresPointLight",{color:"#79573e",intensity:5,decay:0,position:[35,5,0]},null,-1)),o[4]||(o[4]=i("TresPointLight",{color:"#c27439",intensity:5,decay:0,position:[-35,5,0]},null,-1)),o[5]||(o[5]=i("TresPointLight",{color:"#fff000",intensity:5,decay:0,position:[0,5,20]},null,-1)),o[6]||(o[6]=i("TresSpotLight",{color:"#7bccd7",decay:0,"cast-shadow":"","shadow-mapSize-width":2048,"shadow-mapSize-height":2048,position:[0,25,0]},null,-1)),o[7]||(o[7]=i("TresRectAreaLight",{color:"#341212",decay:0,width:1e3,height:1e3,position:[5,20,50],"look-at":[0,0,0]},null,-1)),M(j)]),_:1},16)],64)}}}),lo=V(oo,[["__scopeId","data-v-b3b1ae04"]]);export{lo as default};
