import{Z as t,a6 as n,ca as o,cb as e,cc as r,cd as i,C as u,k as s,bS as c,ab as a,ad as l}from"./three.QUrV0R7c1724070319978.js";import{f,$ as p,d}from"./@tresjs.2JnKj_Yj1724070319978.js";import{C as h}from"./three-custom-shader-material.JQ_xA23o1724070319978.js";import"./object-hash.-UynEDWH1724070319978.js";import"./@amap.PfcO2up21724070319978.js";import"./glsl-tokenizer.P_7ZdKiw1724070319978.js";import{d as m,b as g,a1 as y,w,o as v,D as I,u as b,r as _,a4 as C,e as x,f as M,g as R,J as S,j as T,aj as j,ak as A,F as O,I as B,G as L,m as E}from"./@vue.Q1VpS3901724070319978.js";function P(t,n){const o=G();return(P=function(t,n){return o[t-=150]})(t,n)}!function(t,n){const o=P,e=G();for(;;)try{if(213068===-parseInt(o(171))/1*(parseInt(o(159))/2)+parseInt(o(169))/3*(parseInt(o(177))/4)+parseInt(o(175))/5*(parseInt(o(168))/6)+parseInt(o(157))/7+-parseInt(o(153))/8*(parseInt(o(155))/9)+-parseInt(o(156))/10*(-parseInt(o(170))/11)+-parseInt(o(184))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[P(166)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=P,n=new RegExp(t(176)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=D(t(165));n[t(151)](e+t(167))&&o[t(151)](e+t(160))?D():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(){const t=["toString","traverse","name","constructor","trace","exception","test","__proto__","80520ycmFeR","string","99VuVZwP","30fXduDG","2452646AAvwLu","error","624862maJHRb","input","length","return (function() ","ROADS","bind","init","apply","chain","18IHSQgm","373473Uiqvno","1045253PaXbWq","1pOqecK","gger","CITY_UNTRIANGULATED","info","423830WypiMv","function *\\( *\\)","12VahRcv","console","action","while (true) {}","log","debu","warn","7524048BPoNXG","prototype"];return(G=function(){return t})()}F(void 0,(function(){const t=P,n=function(){const t=P;let n;try{n=Function(t(162)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(178)]=n[t(178)]||{},e=[t(181),t(183),t(174),t(158),t(150),"table",t(190)];for(let r=0;r<e[t(161)];r++){const n=F[t(189)][t(185)][t(164)](F),i=e[r],u=o[i]||n;n[t(152)]=F[t(164)](F),n[t(186)]=u.toString[t(164)](u),o[i]=n}}))();const z=async()=>{const t=P,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(187)]((n=>{const i=t;n[i(188)]===i(173)&&(o=n),"LANDMASS"===n[i(188)]&&(e=n),n.name===i(163)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function D(t){function n(t){const o=P;if(typeof t===o(154))return function(t){}[o(189)](o(180))[o(166)]("counter");1!==(""+t/t)[o(161)]||t%20==0?function(){return!0}[o(189)](o(182)+"gger").call(o(179)):function(){return!1}.constructor(o(182)+o(172))[o(166)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const H=q;!function(t,n){const o=q,e=$();for(;;)try{if(324135===-parseInt(o(550))/1*(parseInt(o(551))/2)+-parseInt(o(504))/3+-parseInt(o(531))/4+parseInt(o(508))/5+parseInt(o(515))/6+parseInt(o(544))/7*(parseInt(o(535))/8)+parseInt(o(530))/9*(parseInt(o(542))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[q(529)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){W(this,(function(){const t=q,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(522),"i"),e=U(t(556));n[t(547)](e+t(545))&&o[t(547)](e+t(528))?U():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=q;let n;try{n=Function("return (function() "+t(512)+");")()}catch(r){n=window}const o=n[t(499)]=n[t(499)]||{},e=[t(498),"warn",t(546),t(560),"exception",t(507),t(533)];for(let i=0;i<e[t(554)];i++){const n=Z[t(523)][t(502)][t(553)](Z),r=e[i],u=o[r]||n;n.__proto__=Z[t(553)](Z),n[t(511)]=u[t(511)][t(553)](u),o[r]=n}}))();const V=[H(537)];function $(){const t=["init","action","boundingBox","uGradient","error","value","opacity","landColor","log","console","__csm","#e523ff","prototype","gger","401319IGolIp","setStyle","uColor","table","253010YLnatB","forEach","uniforms","toString",'{}.constructor("return this")( )',"#ffff00","land","2480406FLvlbp","buildingsModelCustomShader","city","topColor","#112233","material","isArray","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","#ffffff","debu","computeBoundingBox","string","input","apply","225LsVcQb","1720040IztyrR","clone","trace","side","131704rgEwnr","bulidingsColor","object","while (true) {}","gradient","model","Color","252660MDeMnM","color","63LmgNYg","chain","info","test","renderOrder","computeBoundingSphere","7737aamdVn","92jEKzaS","counter","bind","length","call"];return($=function(){return t})()}const N=m({__name:H(516),props:{model:{},bulidingsColor:{default:H(501)},landColor:{default:H(519)},topColor:{default:H(513)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=H,r=o,i=g(0),u=r[e(540)][e(517)];u[e(548)]=1001;const s=r[e(540)][e(514)];(()=>{const o=e,{geometry:s}=u;s[o(526)](),s[o(549)]();const{max:c,min:a}=s[o(558)];if(u[o(520)][o(500)])return;const l=new h({baseMaterial:u[o(520)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(n[o(541)])(r.bulidingsColor)},uOpacity:{value:r[o(562)]},uLightColor:{value:new(n[o(541)])(o(524))},uTopColor:{value:new(n[o(541)])(r[o(518)])},uTime:i,uGradient:{value:r[o(539)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t});u[o(520)].dispose(),u[o(520)]=l})();const{onLoop:c}=p();c((({delta:t})=>{i[e(561)]+=t})),y((()=>{const n=e;r[n(536)]&&u[n(520)][n(510)][n(506)].value.setStyle(r.bulidingsColor),r[n(563)]&&((n,o)=>{const i=e;let u;"cu"===n||n===i(514)&&(u=Array[i(521)](s[i(520)])?s[i(520)]:[s[i(520)]],u[i(509)]((n=>{const e=i;n[o][e(505)](r[e(563)]),n[e(534)]=t})))})(n(514),n(543)),r[n(562)]&&(u[n(520)].uniforms.uOpacity[n(561)]=r[n(562)])})),w(r,((t,n)=>{const o=e;u[o(520)].uniforms[o(559)][o(561)]=t.gradient}));const a=r[e(540)][e(540)][e(532)]();return(t,n)=>(v(),I("primitive",{object:b(a)},null,8,V))}});function q(t,n){const o=$();return(q=function(t,n){return o[t-=498]})(t,n)}function U(t){function n(t){const o=q;if(typeof t===o(527))return function(t){}.constructor(o(538))[o(529)](o(552));1!==(""+t/t)[o(554)]||t%20==0?function(){return!0}[o(523)](o(525)+o(503))[o(555)](o(557)):function(){return!1}[o(523)](o(525)+"gger")[o(529)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Q=K;!function(t,n){const o=K,e=J();for(;;)try{if(600723===parseInt(o(417))/1+-parseInt(o(394))/2*(parseInt(o(382))/3)+-parseInt(o(365))/4*(-parseInt(o(385))/5)+parseInt(o(384))/6*(parseInt(o(389))/7)+parseInt(o(376))/8+-parseInt(o(374))/9*(parseInt(o(406))/10)+-parseInt(o(401))/11*(parseInt(o(363))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(412)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){X(this,(function(){const t=K,n=new RegExp(t(367)),o=new RegExp(t(366),"i"),e=ot(t(410));n[t(399)](e+t(420))&&o[t(399)](e+t(381))?ot():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[K(412)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function K(t,n){const o=J();return(K=function(t,n){return o[t-=360]})(t,n)}function J(){const t=["innerHeight","color","material","#FFF","input","715911EdBPjf","length","30UhUBQS","930MXuxQd","builds","gger","innerWidth","1464589RYkUqH","error"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","trace","bind","8jKkdtP","uOpacity","clone","object","uColor","test","linewidth","11sNaNCa","primitive","uniforms","opacity","style","10pORwmh","renderOrder","stateObject","info","init","action","apply","log","constructor","geometry","value","339941kXRRbc",'{}.constructor("return this")( )',"Wireframe","chain","width","Shader","toString","695076IqRDIq","fromEdgesGeometry","8380YBaDge","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","function *\\( *\\)","buildingsLines","debu","return (function() ","matrix","exception","set","7305741ctTzcw","resolution","5193576CUpFlV"];return(J=function(){return t})()}Y(void 0,(function(){const t=K;let n;try{n=Function(t(370)+t(418)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(413),"warn",t(409),t(390),t(372),"table",t(392)];for(let i=0;i<e[t(383)];i++){const n=Y[t(414)].prototype[t(393)](Y),r=e[i],u=o[r]||n;n.__proto__=Y[t(393)](Y),n[t(362)]=u.toString[t(393)](u),o[r]=n}}))();const tt=[Q(397)],nt=m({__name:Q(368),props:{builds:{},width:{default:1},color:{default:Q(380)},opacity:{default:1},style:{default:Q(419)}},setup(t){const n=Q,c=t;let a=null,l=null;if(c[n(405)]===n(419)){const t=new o(c[n(386)][n(415)]);let u=(new e)[n(364)](t),s=new r({color:c.color,linewidth:c[n(360)],opacity:c[n(404)],transparent:!0,depthWrite:!0,depthTest:!0});s[n(375)][n(373)](window[n(388)],window[n(377)]),a=new i(u,s),a.applyMatrix4(c.builds[n(371)][n(396)]())}else{l={transparent:!0,uniforms:{uColor:{value:new u(c.color)},uOpacity:{value:c[n(404)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:n(391)};const t=new o(c[n(386)][n(415)]),e=new s(l);a=new LineSegments(t,e),a.applyMatrix4(c[n(386)].matrix[n(396)]()),a[n(379)].linewidth=c.width,a[n(407)]=1e3}return y((()=>{const t=n;c[t(405)]===t(361)&&(c[t(378)]&&(l[t(403)][t(398)][t(416)]=new u(c.color)),c.opacity&&(l[t(403)][t(395)][t(416)]=c[t(404)])),c[t(405)]===t(419)&&(c[t(378)]&&(a[t(379)][t(378)]=new u(c[t(378)])),c[t(404)]&&(a[t(379)][t(404)]=c[t(404)])),c[t(360)]&&(a.material[t(400)]=c[t(360)])})),(t,o)=>{const e=n;return v(),I(e(402),{object:b(a)},null,8,tt)}}});function ot(t){function n(t){const o=K;if("string"==typeof t)return function(t){}[o(414)]("while (true) {}").apply("counter");1!==(""+t/t)[o(383)]||t%20==0?function(){return!0}[o(414)](o(369)+o(387)).call(o(411)):function(){return!1}.constructor(o(369)+"gger")[o(412)](o(408)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=ut;!function(t,n){const o=ut,e=ft();for(;;)try{if(909517===-parseInt(o(229))/1*(parseInt(o(223))/2)+-parseInt(o(214))/3+-parseInt(o(202))/4*(-parseInt(o(221))/5)+parseInt(o(203))/6*(parseInt(o(232))/7)+-parseInt(o(210))/8+-parseInt(o(201))/9*(-parseInt(o(233))/10)+-parseInt(o(225))/11*(-parseInt(o(218))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=ut,n=new RegExp(t(227)),o=new RegExp(t(207),"i"),e=dt(t(242));n[t(216)](e+t(231))&&o.test(e+"input")?dt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ut(220)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function ut(t,n){const o=ft();return(ut=function(t,n){return o[t-=192]})(t,n)}it(void 0,(function(){const t=ut,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(213)]=n[t(213)]||{},e=[t(197),t(239),t(241),"error",t(194),t(222),t(199)];for(let r=0;r<e.length;r++){const n=it[t(224)][t(230)][t(243)](it),i=e[r],u=o[i]||n;n[t(212)]=it[t(243)](it),n[t(198)]=u[t(198)][t(243)](u),o[i]=n}}))();const st=S("TresAmbientLight",{color:et(193)},null,-1),ct=S(et(206),{position:[100,100,0],intensity:.5,color:et(193)},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]};function ft(){const t=["trace","autoRotate","9337716OEAkNI","4mnfdpa","312dPCPSV","string","showAxesHelper","TresDirectionalLight","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#000","ability","4296664xhaImL","showBuildings","__proto__","console","653736GIifGo","$slots","test","while (true) {}","24deeQhV","call","apply","4137870mxZcjE","table","7258JQnWPt","constructor","1313598KAIKbW","stateObject","function *\\( *\\)","tcRef","362FqYxbf","prototype","chain","117691gViJEl","10npFaMr","debu","TresPerspectiveCamera","city","pagesShow","perspectiveCameraRef","warn","builds","info","init","bind","length","#ffffff","exception","gger","#000000","log","toString"];return(ft=function(){return t})()}const pt=m({__name:et(237),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=_({clearColor:n(196),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:a,toneMapping:l,disableRender:r.disableRender}),u=_({autoRotate:r[n(200)],enableDamping:!0});let s=null;r.showBuildings&&([o,e]=C((()=>z())),o=await o,e(),s=o);const f=g(),p=g();return(t,o)=>{const e=n,c=x("TresCanvas");return v(),M(c,E({ref_key:e(228),ref:p},i,{"window-size":""}),{default:R((()=>[S(e(235),{ref_key:e(238),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),T(b(d),j(A(u)),null,16),st,ct,r[e(211)]&&b(s)?(v(),I(O,{key:0},[T(N,{model:b(s)},null,8,["model"]),T(nt,{builds:b(s)[e(236)],color:e(208)},null,8,[e(240)])],64)):B("",!0),L(t[e(215)],e(209)),r[e(205)]?(v(),I("TresAxesHelper",at)):B("",!0),r.showGridHelper?(v(),I("TresGridHelper",lt)):B("",!0)])),_:3},16)}}});function dt(t){function n(t){const o=ut;if(typeof t===o(204))return function(t){}[o(224)](o(217))[o(220)]("counter");1!==(""+t/t)[o(192)]||t%20==0?function(){return!0}[o(224)](o(234)+o(195))[o(219)]("action"):function(){return!1}[o(224)](o(234)+"gger")[o(220)](o(226)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{N as _,nt as a,pt as b,z as l};
