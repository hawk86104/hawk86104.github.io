import{m as n,e as t}from"./@tresjs.WiFlZbqU1734492426993.js";import{_ as o,V as e,Q as r,ck as i,cl as u,cm as c,cn as a,a0 as s,cM as l}from"./three.-W-Avfc61734492426993.js";import{z as f}from"./three-custom-shader-material.5sc6Ku_Y1734492426993.js";import{T as p}from"./3d-tiles-renderer.wj_P34Ug1734492426993.js";import{d,b as m,a3 as h,o as g,D as v,J as w,u as y}from"./@vue.-THQH3GC1734492426993.js";import{P as x,U as _,M as b,T as I,a as M}from"./index.0WBnzwIe1734492426993.js";import"./mapBoxShow.vue_vue_type_script_setup_true_lang.B5rLmOv01734492426993.js";import"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.D_G10Gv21734492426993.js";import"./utils.1t2rDdLI1734492426993.js";!function(n,t){const o=j,e=B();for(;;)try{if(651021===-parseInt(o(223))/1*(-parseInt(o(256))/2)+-parseInt(o(225))/3*(-parseInt(o(230))/4)+parseInt(o(232))/5*(-parseInt(o(249))/6)+-parseInt(o(262))/7+-parseInt(o(261))/8+parseInt(o(245))/9*(parseInt(o(218))/10)+parseInt(o(235))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const C=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();!function(){C(this,(function(){const n=j,t=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=P(n(222));t.test(e+n(239))&&o[n(219)](e+n(254))?P():e("0")}))()}();const z=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function B(){const n=["length","7054857lEKKox","position","Matrix4","return (function() ","4740324pGyoPf","constructor","quaternion","action","onLoadTileSet","input","call","74vzvKSf","toString","prototype","warn","gger","6146080wNzsDm","6618647fpLIrP","string","10mBDLll","test","error","debu","init","20821SQvuMW","crossVectors","3709869FYvMcV","normalize","group","exception","getOrientedBounds","4CzFOBO","trace","5zXXbnq",'{}.constructor("return this")( )',"apply","4003813SqpWti","center","Box3","bind","chain","Vector3","Sphere","info","stateObject"];return(B=function(){return n})()}function j(n,t){const o=B();return(j=function(n,t){return o[n-=217]})(n,t)}z(void 0,(function(){const n=j,t=function(){const n=j;let t;try{t=Function(n(248)+n(233)+");")()}catch(o){t=window}return t}(),o=t.console=t.console||{},e=["log",n(259),n(242),n(220),n(228),"table",n(231)];for(let r=0;r<e[n(244)];r++){const t=z[n(250)][n(258)][n(238)](z),i=e[r],u=o[i]||t;t.__proto__=z[n(238)](z),t[n(257)]=u[n(257)].bind(u),o[i]=t}}))();const T=n=>{const t=j;n[t(253)]=i=>{const u=t,c=new(o[u(237)]),a=new(o[u(241)]),s=new(o[u(247)]);let l=null,f=0;n[u(229)](c,s)?(l=(new e).setFromMatrixPosition(s),f=l[u(244)]()):n.getBoundingSphere(a)&&(l=a[u(236)].clone(),f=l[u(244)]());const p=((n,t)=>{const e=j,i=new r,u=(new(o[e(240)]))[e(224)](n,t);return i.x=u.x,i.y=u.y,i.z=u.z,i.w=1+n.clone().dot(t),i[e(226)](),i})(null==l?void 0:l[u(226)](),new(o[u(240)])(0,1,0));n[u(227)][u(251)].x=p.x,n[u(227)][u(251)].y=p.y,n[u(227)][u(251)].z=p.z,n.group[u(251)].w=p.w,n[u(227)][u(246)].z=-f}};function P(n){function t(n){const o=j;if(typeof n===o(217))return function(n){}[o(250)]("while (true) {}")[o(234)]("counter");1!==(""+n/n).length||n%20==0?function(){return!0}[o(250)]("debu"+o(260))[o(255)](o(252)):function(){return!1}.constructor(o(221)+o(260))[o(234)](o(243)),t(++n)}try{if(n)return t;t(0)}catch(o){}}const S=E;!function(n,t){const o=E,e=R();for(;;)try{if(947595===parseInt(o(234))/1*(parseInt(o(261))/2)+-parseInt(o(276))/3*(-parseInt(o(243))/4)+parseInt(o(248))/5*(parseInt(o(291))/6)+-parseInt(o(273))/7*(parseInt(o(270))/8)+parseInt(o(235))/9+parseInt(o(280))/10*(-parseInt(o(256))/11)+-parseInt(o(307))/12*(parseInt(o(288))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const O=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[E(239)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function R(){const n=["warn","parent","TresGroup","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","setCamera","bulidingsColor","prototype","__proto__","24FnRzDH","clone","function *\\( *\\)","innerHeight","while (true) {}","debu","22ssxLAe","6700140iREQvU","return (function() ","chain","receiveShadow","apply","test","primitive","updateMatrixWorld","116088lGaoLZ","object","group","castShadow","traverse","8405FBWcuB","value","action","https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json","string","width","bind","applyMatrix4","1430DhRudd","call","length","setResolutionFromRenderer","toString","129104HeFEqZ","fromEdgesGeometry","table","exception","material","#ffffff","constructor","#e523ff","computeBoundingSphere","344WKgqMP","console","errorTarget","131362gAaYYP","log","MeshPhongMaterial","51GWbIzh","gger","input","Color","101010ZpTGYl","info","init","stateObject",'{}.constructor("return this")( )',"set","isMesh","tilesBuildings","9432683FmVydx","geometry","#ffff00","6642IDzgVX","camera","onLoadModel","topColor","matrix","error","resolution","counter"];return(R=function(){return n})()}!function(){O(this,(function(){const n=E,t=new RegExp(n(230)),o=new RegExp(n(302),"i"),e=L(n(282));t[n(240)](e+n(237))&&o[n(240)](e+n(278))?L():e("0")}))()}();const Z=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();Z(void 0,(function(){const n=E;let t;try{t=Function(n(236)+n(284)+");")()}catch(r){t=window}const o=t[n(271)]=t.console||{},e=[n(274),n(299),n(281),n(296),n(264),n(263),"trace"];for(let i=0;i<e[n(258)];i++){const t=Z[n(267)][n(305)][n(254)](Z),r=e[i],u=o[r]||t;t[n(306)]=Z.bind(Z),t[n(260)]=u[n(260)].bind(u),o[r]=t}}))();const D=[S(244)];function E(n,t){const o=R();return(E=function(n,t){return o[n-=230]})(n,t)}const F=d({__name:S(287),props:{bulidingsColor:{default:S(268)},topColor:{default:S(290)},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(e){const r=S,l=e,d=m(0),x=new p(r(251));x[r(272)]=2,x[r(293)]=n=>{const t=r;n.scene[t(247)]((n=>{const e=t;if(n[e(286)]){(n=>{const t=E,{geometry:e}=n;e.computeBoundingBox(),e[t(269)]();const{max:r,min:i}=e.boundingBox,u=new f({baseMaterial:new(o[t(275)]),vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor; // 顶部颜色\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main() {\n  // 转世界坐标\n  uMax_world = modelMatrix * vec4(uMax, 1.);\n  uMin_world = modelMatrix * vec4(uMin, 1.);\n  vec3 distColor = uColor;\n  float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n  float rate = residue / uCircleTime;\n  float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n  if (uMin_world.y + lightOffset < vPosition.y &&\n      uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n    csm_DiffuseColor = vec4(uLightColor, uOpacity);\n  } else {\n    csm_DiffuseColor = vec4(distColor, uOpacity);\n  }\n\n  // 根据高度计算颜色\n  if (uGradient) {\n    float rateHight =\n        (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y);\n    // vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight * 0.6);\n    float mixNumber = clamp(rateHight * 2.3 - 1.5, 0., 1.);\n    vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, mixNumber);\n\n    csm_DiffuseColor = vec4(outColor, uOpacity);\n  }\n}",silent:!0,uniforms:{uMax:{value:r},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(o[t(279)])(l[t(304)])},uOpacity:{value:l.opacity},uLightColor:{value:new(o[t(279)])(t(266))},uTopColor:{value:new(o[t(279)])(l[t(294)])},uTime:d,uGradient:{value:l.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:s});n[t(265)].dispose(),n.material=u})(n),n[e(238)]=!1,n[e(246)]=!1;const t=new i(n[e(289)][e(308)]());let r=(new u)[e(262)](t),p=new c({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});p[e(297)][e(285)](window.innerWidth,window[e(231)]);const m=new a(r,p);m[e(255)](n[e(295)][e(308)]()),n[e(300)].add(m)}}))},T(x);const{renderer:_,sizes:b}=n();h((()=>{const n=r;b[n(253)][n(249)]&&(x[n(303)](l[n(292)]),x[n(259)](l[n(292)],_[n(249)]))}));const{onBeforeLoop:I}=t();return I((({delta:n})=>{const t=r;d[t(249)]+=2*n,l[t(292)]&&b[t(253)][t(249)]&&(l[t(292)][t(242)](),x.update())})),(n,t)=>{const o=r;return g(),v(o(301),null,[w(o(241),{object:y(x)[o(245)]},null,8,D)])}}});function L(n){function t(n){const o=E;if(typeof n===o(252))return function(n){}.constructor(o(232)).apply(o(298));1!==(""+n/n)[o(258)]||n%20==0?function(){return!0}[o(267)](o(233)+o(277))[o(257)](o(250)):function(){return!1}[o(267)](o(233)+"gger")[o(239)](o(283)),t(++n)}try{if(n)return t;t(0)}catch(o){}}const W=$;function A(){const n=["toString","https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}","object","stateObject","provider","action","warn","wireframe","126858LPzlNk","call","update","chain","value","test","init","primitive","far","camera","839034RYRNZS","monochrome","trace","position0","error","maxZoom","enableDamping","667216JhgrrR","8aVMNxN","mapCenter",'{}.constructor("return this")( )',"apply","info","string","function *\\( *\\)","filter","position","input","set","table","1387968uBMzaO","showTileNo","length","Vector3","return (function() ","bind","Color","7886361ihAhem","minDistance","1647105fDpCDC","rotation","gger","target","log","flatShading","constructor","debu","counter","28144uaxCfg","#4688b5","while (true) {}","lookAt","console","4689YnPziQ","abs","prototype","showBoundingBox"];return(A=function(){return n})()}!function(n,t){const o=$,e=A();for(;;)try{if(666679===parseInt(o(456))/1+-parseInt(o(457))/2*(-parseInt(o(439))/3)+parseInt(o(469))/4+parseInt(o(478))/5+-parseInt(o(449))/6+parseInt(o(476))/7+parseInt(o(487))/8*(-parseInt(o(492))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();!function(){G(this,(function(){const n=$,t=new RegExp(n(463)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=q(n(445));t[n(444)](e+n(442))&&o[n(444)](e+n(466))?q():e("0")}))()}();const N=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[$(460)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();N(void 0,(function(){const n=$;let t;try{t=Function(n(473)+n(459)+");")()}catch(r){t=window}const o=t[n(491)]=t[n(491)]||{},e=[n(482),n(437),n(461),n(453),"exception",n(468),n(451)];for(let i=0;i<e[n(471)];i++){const t=N[n(484)][n(494)][n(474)](N),r=e[i],u=o[r]||t;t.__proto__=N.bind(N),t[n(431)]=u[n(431)][n(474)](u),o[r]=t}}))();const V=[W(433),W(479)],k=d({__name:"tileMapBuildingsMesh",props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(e,{expose:r}){const i=W,u=e,{renderer:c,scene:a}=n(),s=new x;s.coordType=_;const f=new b;f.source=i(432),f[i(470)]=!1,f.useWorker=!0;const p=new I(s,f);p[i(495)]=!1,p[i(438)]=!1,p[i(483)]=!1,p[i(464)]={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let d=new(o[i(475)])(i(488));p[i(464)][i(450)]={r:d.r,g:d.g,b:d.b};const m=new M;m[i(435)]=p,m.bbox=u.bbox,m.maxZoom=u[i(454)],u[i(448)].up=new(o[i(472)])(0,1,0),u.camera[i(465)][i(467)](u[i(458)][0],u[i(458)][2],2e3-u[i(458)][1]),u[i(448)][i(490)](new(o[i(472)])(u[i(448)].position.x,0,u.camera[i(465)].z-3e3)),m.camera=u.camera;let w=null;h((()=>{const n=i;c.value&&(w=new l(u[n(448)],c[n(443)].domElement),w[n(455)]=!0,w.dampingFactor=.05,w[n(477)]=600,w[n(452)][n(467)](u.camera[n(465)].x,u[n(448)][n(465)].y,u[n(448)].position.z),w[n(481)].set(u[n(448)][n(465)].x,0,u.camera.position.z-2e3))}));const{onLoop:C}=t();return C((()=>{const n=i;if(c[n(443)]){const t=50*Math[n(493)](u.camera[n(465)].y);u[n(448)][n(447)]=t+5e3,u.camera.updateProjectionMatrix(),w&&(w[n(441)](),w[n(481)].y=0),m[n(441)](),c[n(443)].render(a[n(443)],u[n(448)])}})),r({camera:u.camera,map:m}),(n,t)=>{const o=i;return g(),v(o(446),{object:y(m),rotation:[-Math.PI/2,0,0]},null,8,V)}}});function $(n,t){const o=A();return($=function(n,t){return o[n-=431]})(n,t)}function q(n){function t(n){const o=$;if(typeof n===o(462))return function(n){}[o(484)](o(489)).apply(o(486));1!==(""+n/n)[o(471)]||n%20==0?function(){return!0}[o(484)](o(485)+o(480))[o(440)](o(436)):function(){return!1}[o(484)](o(485)+"gger")[o(460)](o(434)),t(++n)}try{if(n)return t;t(0)}catch(o){}}function H(n,t){var o=Y();return(H=function(n,t){return o[n-=159]})(n,t)}!function(n,t){for(var o=H,e=Y();;)try{if(711890===-parseInt(o(172))/1+-parseInt(o(163))/2*(-parseInt(o(167))/3)+-parseInt(o(168))/4*(parseInt(o(181))/5)+parseInt(o(190))/6+-parseInt(o(193))/7+-parseInt(o(185))/8+-parseInt(o(179))/9*(-parseInt(o(166))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();var Q=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[H(189)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function Y(){var n=["102669ZbFZhb","96vopxFI","table","test","stateObject","205672BsoJvM","function *\\( *\\)","info","__proto__","log","return (function() ","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","9SXPzcn","prototype","68165jtixpE","bind","call","chain","10377720lVNjSP","gger","constructor","input","apply","4391130eaREPw","action","warn","229250ByQqJP","length","exception","console","toString","counter","50SQUcXj","trace","debu","9872890hzzBjC"];return(Y=function(){return n})()}!function(){Q(this,(function(){var n=H,t=new RegExp(n(173)),o=new RegExp(n(178),"i"),e=X("init");t[n(170)](e+n(184))&&o[n(170)](e+n(188))?X():e("0")}))()}();var J=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[H(189)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function X(n){function t(n){var o=H;if("string"==typeof n)return function(n){}[o(187)]("while (true) {}")[o(189)](o(162));1!==(""+n/n)[o(194)]||n%20==0?function(){return!0}[o(187)](o(165)+o(186))[o(183)](o(191)):function(){return!1}[o(187)](o(165)+o(186))[o(189)](o(171)),t(++n)}try{if(n)return t;t(0)}catch(o){}}J(void 0,(function(){var n,t=H;try{n=Function(t(177)+'{}.constructor("return this")( ));')()}catch(a){n=window}for(var o=n[t(160)]=n[t(160)]||{},e=[t(176),t(192),t(174),"error",t(159),t(169),t(164)],r=0;r<e.length;r++){var i=J.constructor[t(180)].bind(J),u=e[r],c=o[u]||i;i[t(175)]=J.bind(J),i[t(161)]=c[t(161)][t(182)](c),o[u]=i}}))();export{F as _,k as a};
