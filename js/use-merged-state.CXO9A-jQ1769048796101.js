import{importShared as e}from"./3d-tiles-renderer.DoRCwQO21769048796101.js";function t(e){return e.composedPath()[0]}const n={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function o(e,o,i){const r=n[e];let u=r.get(o);void 0===u&&r.set(o,u=new WeakMap);let c=u.get(i);return void 0===c&&u.set(i,c=function(e,n,o){if("mousemoveoutside"===e){const e=e=>{n.contains(t(e))||o(e)};return{mousemove:e,touchstart:e}}if("clickoutside"===e){let e=!1;const i=o=>{e=!n.contains(t(o))},r=i=>{e&&(n.contains(t(i))||o(i))};return{mousedown:i,mouseup:r,touchstart:i,touchend:r}}return console.error(`[evtd/create-trap-handler]: name \`${e}\` is invalid. This could be a bug of evtd.`),{}}(e,o,i)),c}function i(e,t,n,i){if("mousemoveoutside"===e||"clickoutside"===e){const r=o(e,t,n);return Object.keys(r).forEach(e=>{u(e,document,r[e],i)}),!0}return!1}function r(e,t,n,i){if("mousemoveoutside"===e||"clickoutside"===e){const r=o(e,t,n);return Object.keys(r).forEach(e=>{c(e,document,r[e],i)}),!0}return!1}const{on:u,off:c}=function(){if("undefined"==typeof window)return{on:()=>{},off:()=>{}};const e=new WeakMap,n=new WeakMap;function o(){e.set(this,!0)}function u(){e.set(this,!0),n.set(this,!0)}function c(e,t,n){const o=e[t];return e[t]=function(){return n.apply(e,arguments),o.apply(e,arguments)},e}function s(e,t){e[t]=Event.prototype[t]}const a=new WeakMap,f=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function d(){var e;return null!==(e=a.get(this))&&void 0!==e?e:null}function l(e,t){void 0!==f&&Object.defineProperty(e,"currentTarget",{configurable:!0,enumerable:!0,get:null!=t?t:f.get})}const p={bubble:{},capture:{}},v={},b=function(){const i=function(i){const{type:r,eventPhase:f,bubbles:v}=i,b=t(i);if(2===f)return;const w=1===f?"capture":"bubble";let h=b;const m=[];for(;null===h&&(h=window),m.push(h),h!==window;)h=h.parentNode||null;const g=p.capture[r],y=p.bubble[r];if(c(i,"stopPropagation",o),c(i,"stopImmediatePropagation",u),l(i,d),"capture"===w){if(void 0===g)return;for(let t=m.length-1;t>=0&&!e.has(i);--t){const e=m[t],o=g.get(e);if(void 0!==o){a.set(i,e);for(const e of o){if(n.has(i))break;e(i)}}if(0===t&&!v&&void 0!==y){const t=y.get(e);if(void 0!==t)for(const e of t){if(n.has(i))break;e(i)}}}}else if("bubble"===w){if(void 0===y)return;for(let t=0;t<m.length&&!e.has(i);++t){const e=m[t],o=y.get(e);if(void 0!==o){a.set(i,e);for(const e of o){if(n.has(i))break;e(i)}}}}s(i,"stopPropagation"),s(i,"stopImmediatePropagation"),l(i)};return i.displayName="evtdUnifiedHandler",i}(),w=function(){const e=function(e){const{type:t,eventPhase:n}=e;if(2!==n)return;const o=v[t];void 0!==o&&o.forEach(t=>t(e))};return e.displayName="evtdUnifiedWindowEventHandler",e}();function h(e,t){const n=p[e];return void 0===n[t]&&(n[t]=new Map,window.addEventListener(t,b,"capture"===e)),n[t]}function m(e,t){let n=e.get(t);return void 0===n&&e.set(t,n=new Set),n}function g(e,t,n,o){if(r(e,t,n,o))return;const i=!0===o||"object"==typeof o&&!0===o.capture,u=i?"capture":"bubble",c=h(u,e),s=m(c,t);if(t===window){if(!function(e,t,n,o){const i=p[t][n];if(void 0!==i){const t=i.get(e);if(void 0!==t&&t.has(o))return!0}return!1}(t,i?"bubble":"capture",e,n)&&function(e,t){const n=v[e];return!(void 0===n||!n.has(t))}(e,n)){const t=v[e];t.delete(n),0===t.size&&(window.removeEventListener(e,w),v[e]=void 0)}}s.has(n)&&s.delete(n),0===s.size&&c.delete(t),0===c.size&&(window.removeEventListener(e,b,"capture"===u),p[u][e]=void 0)}return{on:function(e,t,n,o){let r;if(r="object"==typeof o&&!0===o.once?i=>{g(e,t,r,o),n(i)}:n,i(e,t,r,o))return;const u=m(h(!0===o||"object"==typeof o&&!0===o.capture?"capture":"bubble",e),t);if(u.has(r)||u.add(r),t===window){const t=function(e){return void 0===v[e]&&(v[e]=new Set,window.addEventListener(e,w)),v[e]}(e);t.has(r)||t.add(r)}},off:g}}(),{watch:s,computed:a}=await e("vue");function f(e,t){return s(e,e=>{void 0!==e&&(t.value=e)}),a(()=>void 0===e.value?t.value:e.value)}export{c as off,u as on,f as useMergedState};
