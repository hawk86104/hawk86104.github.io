import{F as e,_ as a}from"./@tresjs.BCHtwiaC1763540743861.js";import{C as r,E as t,b as s,X as i,a as o,F as n,U as c,h as p,N as l,O as m}from"./@takram.DcJcNz4v1763540743861.js";import{d,H as u,o as w,u as h,J as y}from"./@vue.Co_gxueH1763540743861.js";import{V as x,M as g}from"./three.rXKzP9fQ1763540743861.js";const v=["material"],P=d({__name:"atmo",props:{aerialPerspective:{},tiles:{}},setup(d){const{renderer:P}=e();P.depth=!1;const f=new Date("2025-06-01T01:30:00Z"),T=new r(t(139.7671),t(35.6812),100).toECEF(),j=new x,D=new x,M=(new x).copy(T).multiplyScalar(-1),S=s.WGS84.getSurfaceNormal(T);s.WGS84.getEastNorthUpVectors(T,j,D,S);const F=(new g).makeBasis(D,S,j).invert(),E=new i,G=new o,W=new n({distance:300});W.target.position.copy(T),W.castShadow=!0,W.shadow.camera.top=300,W.shadow.camera.bottom=-300,W.shadow.camera.left=-300,W.shadow.camera.right=300,W.shadow.camera.near=0,W.shadow.camera.far=600,W.shadow.mapSize.width=2048,W.shadow.mapSize.height=2048,W.shadow.normalBias=1,(new c).setTypeFromRenderer(P).load("./plugins/useThreeGeospatial/exr/",function(e){Object.assign(E,e),W.transmittanceTexture=e.transmittanceTexture,G.irradianceTexture=e.irradianceTexture,Object.assign(d.aerialPerspective,e),d.aerialPerspective.skyIrradiance=!0,d.aerialPerspective.sunIrradiance=!0});const{onRender:_}=a(),b=new x,k=new x,C=new g,N=new g;return _(()=>{const e=f;p(e,N),l(e,b).applyMatrix4(N),m(e,k).applyMatrix4(N),E.sunDirection.copy(b),E.moonDirection.copy(k),W.sunDirection.copy(b),G.sunDirection.copy(b),C.copy(d.tiles.group.matrixWorld).setPosition(0,0,0),F.copy(C),M.setFromMatrixPosition(d.tiles.group.matrixWorld).applyMatrix4(C.invert()),d.aerialPerspective.ellipsoidCenter.copy(M),d.aerialPerspective.ellipsoidMatrix.copy(F),d.aerialPerspective.sunDirection.copy(b),d.aerialPerspective.moonDirection.copy(k),W.update(),G.update()}),(e,a)=>(w(),u("TresMesh",{frustumCulled:!1,material:h(E)},[...a[0]||(a[0]=[y("TresPlaneGeometry",{args:[2,2]},null,-1)])],8,v))}});export{P as _};
