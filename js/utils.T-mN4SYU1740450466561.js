import"./@fesjs.25ZLMwYe1740450466561.js";import{_ as t}from"./jszip.NDo38iES1740450466561.js";import{F as n}from"./file-saver.NkETwfvg1740450466561.js";import{_ as e,aH as s}from"./three.HaMTRCf61740450466561.js";const o=l;!function(t,n){const e=l,s=i();for(;;)try{if(240183===parseInt(e(444))/1*(parseInt(e(435))/2)+parseInt(e(428))/3+-parseInt(e(398))/4*(-parseInt(e(414))/5)+-parseInt(e(419))/6*(-parseInt(e(422))/7)+parseInt(e(464))/8*(parseInt(e(396))/9)+parseInt(e(427))/10+-parseInt(e(440))/11)break;s.push(s.shift())}catch(o){s.push(s.shift())}}();const r=function(){let t=!0;return function(n,e){const s=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,s}}();!function(){r(this,(function(){const t=l,n=new RegExp(t(443)),e=new RegExp(t(485),"i"),s=h(t(477));n[t(467)](s+t(412))&&e[t(467)](s+t(407))?h():s("0")}))()}();const a=function(){let t=!0;return function(n,e){const s=t?function(){if(e){const t=e[l(471)](n,arguments);return e=null,t}}:function(){};return t=!1,s}}();function i(){const t=["image/jpeg","then",'{}.constructor("return this")( )',"apply","Cache","readAsDataURL","image/gif","debu","data:image/png;base64,","init","config.zip","images","url:","PNG","pop","split","while (true) {}","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","return (function() ","enabled","constructor","call","startsWith","push","endsWith","9mUdtVz","base64","683280xwutHP",".json","name","uuid",";base64,","result","exception","app.json","stringify","input","url:images/","BufferGeometry","length","loadAsync","chain","GIF","10PmvElA","data:image/JPEG;base64,","data:image/PNG;base64,","action","load","430434kfLFen","setResponseType","toUpperCase","7kkOFqy","JPEG","log","data:image/webp;base64,","data","3188170ttCsTI","418620Bpddes","application/octet-stream","file","stateObject","scene","console","substring","197594LPXIto","image/png","Unknown","onerror","geometries","9294054nCgTyF","parse","forEach","function *\\( *\\)","1jZrLlq","toString","data:image/GIF;base64,","data:image/WEBP;base64,","type","bind","trace","image/bmp","table","url","error","prototype","catch","string","get","FileLoader","counter","data:image/","files","async","916512DEcddD","blob","warn","test"];return(i=function(){return t})()}async function c(t){const n=new s;return new Promise(((e,s)=>{const o=l;n.load(t,(t=>e(JSON[o(441)](t))),void 0,(t=>s(t)))}))}async function u(t){const n=o,s=new(e[n(459)]);return new Promise(((e,r)=>{const a=n;s[a(420)](a(465)),s[a(418)](t,(n=>{const s=a,i=new FileReader;i.onloadend=()=>{const n=l,s=function(t){const n=o,e=t.split(".")[n(482)]().toLowerCase();return{jpg:n(468),jpeg:n(468),png:n(436),gif:n(474),bmp:n(451),webp:"image/webp"}[e]||n(429)}(t),r=i[n(403)][n(483)](",")[1];e("data:"+s+n(402)+r)},i[s(438)]=t=>{r(t)},i[s(473)](n)}),void 0,(t=>r(t)))}))}function l(t,n){const e=i();return(l=function(t,n){return e[t-=393]})(t,n)}a(void 0,(function(){const t=l;let n;try{n=Function(t(486)+t(470)+");")()}catch(o){n=window}const e=n.console=n[t(433)]||{},s=[t(424),t(466),"info",t(454),t(404),t(452),t(450)];for(let r=0;r<s[t(410)];r++){const n=a[t(488)][t(455)][t(449)](a),o=s[r],i=e[o]||n;n.__proto__=a.bind(a),n[t(445)]=i.toString[t(449)](i),e[o]=n}}))(),e[o(472)][o(487)]=!0;const p=n=>{const e=o,r=new s;return r.setResponseType(e(465)),new Promise(((s,o)=>{const a=e;r[a(418)](n,(async n=>{const e=a;s(await t[e(411)](n))}),void 0,(t=>o(t)))}))},f=t=>{const n=o,e=t[n(434)](0,15),s=n(415),r=n(476),a=n(416),i=n(446),c=n(425),u=n(447);return"data:image/jpeg;base64,"[n(393)](e)||s[n(393)](e)?n(423):r[n(393)](e)||a.startsWith(e)?n(481):"data:image/gif;base64,"[n(393)](e)||i.startsWith(e)?n(413):c.startsWith(e||u.startsWith(e))?"WEBP":n(437)},g=e=>{const s=o,r=[];e[s(432)][s(439)]&&e[s(432)][s(439)][s(442)]((t=>{const n=s;t[n(448)]===n(409)&&(r[n(394)]({uuid:t[n(401)],data:t[n(426)]}),t.data="url:geometries/"+t[n(401)]+n(399))}));const a=[];e.scene.images&&e.scene.images[s(442)]((t=>{const n=s;t[n(453)]&&(a.push({uuid:t[n(401)],url:t.url}),t[n(453)][n(448)]?t[n(453)]=n(408)+t[n(401)]+"."+t[n(453)][n(448)]+n(399):t[n(453)]=n(408)+t[n(401)]+"."+f(t.url))}));const i=new t;if(r[s(410)]){const t=i.folder(s(439));r.forEach((n=>{const e=s;t[e(430)](n.uuid+e(399),JSON[e(406)](n[e(426)]))}))}if(a[s(410)]){const t=i.folder(s(479));a[s(442)]((n=>{const e=s;n[e(453)][e(448)]?t[e(430)](n[e(401)]+"."+n[e(453)][e(448)]+e(399),JSON.stringify(n[e(453)])):t[e(430)](n[e(401)]+"."+f(n[e(453)]),n[e(453)][e(483)](e(402))[e(482)](),{base64:!0})}))}const c=JSON[s(406)](e);return i.file(s(405),c),i.generateAsync({type:s(465)})[s(469)]((t=>{const e=s;n.saveAs(t,e(478))}))},d=(t,n,e)=>{const s=o;t[s(439)]<=0&&t[s(479)]<=0&&e(n)},m=(n,e)=>{let s=null;return t.loadAsync(n).then((t=>{const n=l;t.files[n(405)]?t[n(462)]["app.json"][n(463)](n(457))[n(469)]((r=>{var a,i;const c=n;s=JSON[c(441)](r);const u=(t=>{var n,e;const s=o,r={geometries:0,images:0};return null==(n=t[s(432)][s(439)])||n[s(442)]((t=>{const n=s;t[n(426)][n(393)](n(480))&&r[n(439)]++})),null==(e=t.scene.images)||e[s(442)]((t=>{const n=s;t[n(453)].startsWith("url:")&&r[n(479)]++})),r})(s);d(u,s,e),null==(a=s[c(432)][c(439)])||a.forEach((n=>{const o=c;n[o(426)][o(393)](o(480))&&t.files[n[o(426)].slice(4)].async("string")[o(469)]((t=>{const r=o;n[r(426)]=JSON[r(441)](t),u[r(439)]--,d(u,s,e)}))})),null==(i=s.scene[c(479)])||i[c(442)]((n=>{const o=c;if(n.url[o(393)](o(480))){const r=n[o(453)].slice(4);r[o(395)](o(399))?t.files[r].async(o(457))[o(469)]((t=>{const r=o;n.url=JSON[r(441)](t),u.images--,d(u,s,e)})):t[o(462)][r][o(463)](o(397))[o(469)]((t=>{const a=o,i=r[a(483)]("."),c=i[i[a(410)]-1][a(421)]();n.url=a(461)+c+a(402)+t,u[a(479)]--,d(u,s,e)}))}}))})):console[n(454)]("非标准文件：不存在 app.json")}),(t=>{const e=l;console.error(n[e(400)]+": "+t.message)})),s};function h(t){function n(t){const e=l;if(typeof t===e(457))return function(t){}[e(488)](e(484))[e(471)](e(460));1!==(""+t/t)[e(410)]||t%20==0?function(){return!0}[e(488)](e(475)+"gger")[e(489)](e(417)):function(){return!1}[e(488)](e(475)+"gger")[e(471)](e(431)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{p as a,u as b,g as e,f as g,m as i,c as l};
