import"./axios.BTiLLHcy1763540743861.js";import"./global.BBGVMLjY1763540743861.js";import"./lodash.CybtBilg1763540743861.js";import{u as e}from"./useChartDataFetch.hook.DFkwif_P1763540743861.js";import"./echarts.1o70n-tX1763540743861.js";import{u as t}from"./chartEditStore.CHAh6jvI1763540743861.js";import{d as a,x as o,r,w as n,W as i,H as s,o as l,F as c,X as d,O as m,J as u,u as g,N as f}from"./@vue.Co_gxueH1763540743861.js";import{_ as h}from"./@fesjs.BEMFm_yJ1763540743861.js";const p={class:"ranking-info"},v=["innerHTML"],w=h(a({__name:"index",props:{chartConfig:{type:Object,required:!0}},setup(a){const h=a,{w:w,h:y}=o(h.chartConfig.attr),{rowNum:C,unit:x,color:b,textColor:j,borderColor:k,indexFontSize:H,leftFontSize:$,rightFontSize:_}=o(h.chartConfig.option),T=r({mergedConfig:h.chartConfig.option,rowsData:[],rows:[{scroll:0,ranking:1,name:"",value:"",percent:0}],heights:[0],animationIndex:0,animationHandler:0,updater:0,avgHeight:0}),z=async(e=!1)=>{let{avgHeight:t,animationIndex:a,mergedConfig:o,rowsData:r,updater:n}=T;const{waitTime:i,carousel:s,rowNum:l}=o,c=r.length;if(l>=c)return;if(e&&(await new Promise(e=>setTimeout(e,i)),n!==T.updater))return;const d="single"===s?1:l;let m=r.slice(a);if(m.push(...r.slice(0,a)),T.rows=m.slice(0,l+1),T.heights=new Array(c).fill(t),await new Promise(e=>setTimeout(e,300)),n!==T.updater)return;T.heights.splice(0,d,...new Array(d).fill(0)),a+=d;const u=a-c;u>=0&&(a=u),T.animationIndex=a,T.animationHandler=setTimeout(z,1e3*i-300)},F=()=>{T.updater=(T.updater+1)%999999,T.animationHandler&&clearTimeout(T.animationHandler)},N=async()=>{try{if(!T.mergedConfig)return;let{dataset:e,rowNum:t,sort:a}=T.mergedConfig;F(),(()=>{let{dataset:e,rowNum:t,sort:a}=T.mergedConfig;a&&e.sort(({value:e},{value:t})=>e>t?-1:e<t?1:e===t?0:void 0);const o=e.map(({value:e})=>e),r=Math.min(...o)||0,n=Math.abs(r),i=(Math.max(...o)||0)+n;e=e.map((e,t)=>({...e,ranking:t+1,percent:(e.value+n)/i*100}));const s=e.length;s>t&&s<2*t&&(e=[...e,...e]),e=e.map((e,t)=>({...e,scroll:t})),T.rowsData=e,T.rows=e})();let o=!0;e.length<=t&&(o=!1),((e=!1)=>{const{rowNum:t,dataset:a}=T.mergedConfig,o=y.value/t;T.avgHeight=o,e||(T.heights=new Array(a.length).fill(o))})(o),z(o)}catch(e){console.error(e)}};return N(),n(()=>w.value,()=>{N()}),n(()=>y.value,()=>{N()}),n(()=>C.value,()=>{N()}),n(()=>h.chartConfig.option.dataset,()=>{N()},{deep:!1}),e(h.chartConfig,t,e=>{h.chartConfig.option.dataset=e,N()}),i(()=>{F()}),(e,t)=>(l(),s("div",{class:"go-tables-rank",style:m(`color: ${g(j)}`)},[(l(!0),s(c,null,d(T.rows,(e,a)=>(l(),s("div",{class:"row-item",key:e.toString()+e.scroll,style:m(`height: ${T.heights[a]}px;`)},[u("div",p,[u("div",{class:"rank",style:m(`color: ${g(b)};font-size: ${g(H)}px`)},"No."+f(e.ranking),5),u("div",{class:"info-name",style:m(`font-size: ${g($)}px`),innerHTML:e.name},null,12,v),u("div",{class:"ranking-value",style:m(`color: ${g(j)};font-size: ${g(_)}px`)},f("function"==typeof T.mergedConfig.valueFormatter?T.mergedConfig.valueFormatter(e):e.value)+" "+f(g(x)),5)]),u("div",{class:"ranking-column",style:m(`border-color: ${g(k)}`)},[u("div",{class:"inside-column",style:m(`width: ${e.percent}%;background-color: ${g(b)}`)},[...t[0]||(t[0]=[u("div",{class:"shine"},null,-1)])],4)],4)],4))),128))],4))}}),[["__scopeId","data-v-7b2e0f37"]]),y=Object.freeze(Object.defineProperty({__proto__:null,default:w},Symbol.toStringTag,{value:"Module"}));export{y as _};
