import{P as t}from"./tweakpane.yDiyAAkA1741007821308.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.aJLp8puk1741007821308.js";import{e}from"./@tresjs.u6hJLBm41741007821308.js";import{z as r}from"./three-custom-shader-material.3n-EBY0H1741007821308.js";import{_ as i,C as u,cm as c,l as a,b9 as s}from"./three.sBrYSCgq1741007821308.js";import{d as l,a2 as f,w as p,o as d,H as m,u as v,a3 as g,r as y,f as h,g as w,j as _,m as C}from"./@vue.NRI7TcgI1741007821308.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741007821308.js";import"./postprocessing.rsQjznIU1741007821308.js";import"./@vueuse.jd1Cg91M1741007821308.js";const b=S;function x(){const t=["value","children","debu","5888tqgpMX","isArray","boundingBox","clone","12645070tLVqmy","function *\\( *\\)","error","renderOrder","40jwZQca","setStyle","length","landColor","info","action","337158aSyfTW","2083044dtUizI","table","prototype","16246tidBOE","city","trace","apply","bulidingsColor","#ffff00","bind","object","side","uTime","Color","color","uniforms","11ZtIvur","counter","98waGBAl","35OVaQGZ","gger","test","uOpacity","return (function() ","48RjjXRm","MeshBasicMaterial","computeBoundingSphere","call","gradient",'{}.constructor("return this")( )',"4370067lXQCWZ","model","uGradient","exception","DoubleSide","while (true) {}","#ffffff","material","#112233","21258zYHyim","constructor","stateObject","forEach","primitive","__csm","3156660przvnD","console","string","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t"];return(x=function(){return t})()}!function(t,n){const o=S,e=x();for(;;)try{if(881571===-parseInt(o(234))/1*(parseInt(o(219))/2)+parseInt(o(215))/3*(parseInt(o(276))/4)+parseInt(o(261))/5+-parseInt(o(216))/6*(parseInt(o(235))/7)+parseInt(o(268))/8*(parseInt(o(255))/9)+parseInt(o(272))/10*(parseInt(o(232))/11)+parseInt(o(240))/12*(-parseInt(o(246))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(222)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=S,n=new RegExp(t(273)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=O("init");n[t(237)](e+"chain")&&o[t(237)](e+"input")?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=S;let n;try{n=Function(t(239)+t(245)+");")()}catch(r){n=window}const o=n[t(262)]=n[t(262)]||{},e=["log","warn",t(213),t(274),t(249),t(217),t(221)];for(let i=0;i<e[t(278)];i++){const n=M[t(256)][t(218)].bind(M),r=e[i],u=o[r]||n;n.__proto__=M[t(225)](M),n.toString=u.toString[t(225)](u),o[r]=n}}))();const T=[b(226)];function S(t,n){const o=x();return(S=function(t,n){return o[t-=213]})(t,n)}const j=l({__name:"bModel",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:b(254)},topColor:{default:b(224)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,c=o[n(247)][n(220)];o[n(247)][n(247)][n(266)][0].material=new(i[n(241)])({color:"#ffff00"}),c[n(275)]=1001;const a=o[n(247)].land;(()=>{const t=n,{geometry:e}=c;e.computeBoundingBox(),e[t(242)]();const{max:a,min:s}=e[t(270)];if(c[t(253)][t(260)])return;const l=new r({baseMaterial:c.material,vertexShader:t(264),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(o[t(223)])},uOpacity:{value:o.opacity},uLightColor:{value:new(i[t(229)])(t(252))},uTopColor:{value:new(i[t(229)])(o.topColor)},uTime:{value:0},uGradient:{value:o[t(244)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(250)]});c[t(253)].dispose(),c[t(253)]=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(253)][o(231)][o(228)][o(265)]+=t})),f((()=>{const t=n;o[t(223)]&&c[t(253)][t(231)].uColor[t(265)][t(277)](o[t(223)]),o[t(279)]&&((t,e)=>{const r=n;let u;"cu"===t||"land"===t&&(u=Array[r(269)](a[r(253)])?a.material:[a[r(253)]],u[r(258)]((t=>{const n=r;t[e][n(277)](o[n(279)]),t[n(227)]=i[n(250)]})))})("land",t(230)),o.opacity&&(c[t(253)][t(231)][t(238)][t(265)]=o.opacity)})),p(o,((t,o)=>{const e=n;c.material[e(231)][e(248)][e(265)]=t[e(244)]}));const l=o[n(247)].model[n(271)]();return(t,o)=>{const e=n;return d(),m(e(259),{object:v(l)},null,8,T)}}});function O(t){function n(t){const o=S;if(typeof t===o(263))return function(t){}.constructor(o(251))[o(222)](o(233));1!==(""+t/t)[o(278)]||t%20==0?function(){return!0}.constructor(o(267)+o(236))[o(243)](o(214)):function(){return!1}.constructor(o(267)+"gger")[o(222)](o(257)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=G;!function(t,n){const o=G,e=L();for(;;)try{if(642096===-parseInt(o(177))/1*(parseInt(o(170))/2)+-parseInt(o(209))/3+-parseInt(o(193))/4+-parseInt(o(179))/5*(parseInt(o(218))/6)+-parseInt(o(182))/7*(-parseInt(o(199))/8)+parseInt(o(183))/9*(-parseInt(o(221))/10)+parseInt(o(220))/11*(parseInt(o(191))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(167)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=G,n=new RegExp(t(203)),o=new RegExp(t(164),"i"),e=F(t(197));n[t(207)](e+"chain")&&o[t(207)](e+t(194))?F():e("0")}))()}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(t,n){const o=L();return(G=function(t,n){return o[t-=164]})(t,n)}B(void 0,(function(){const t=G;let n;try{n=Function(t(190)+t(208)+");")()}catch(r){n=window}const o=n[t(172)]=n[t(172)]||{},e=[t(217),t(173),"info","error",t(211),t(205),t(204)];for(let i=0;i<e[t(185)];i++){const n=B[t(171)][t(165)].bind(B),r=e[i],u=o[r]||n;n[t(175)]=B[t(213)](B),n[t(195)]=u[t(195)][t(213)](u),o[r]=n}}))();const Z=["object"],z=l({__name:P(202),props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(168)])},uSrcColor:{value:new u(o[n(181)])},uScale:{value:o[n(176)]},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(214)][n(192)])[n(186)]();l=l[n(206)](o[n(214)][n(212)]);const p=new a(i);r=new s(l,p),r[n(196)][n(215)]=o.width,r[n(169)]=1e3,f((()=>{const t=n;o[t(168)]&&(i[t(216)][t(210)].value=new u(o[t(168)])),o[t(181)]&&(i[t(216)][t(219)][t(187)]=new u(o[t(181)])),o[t(176)]&&(i.uniforms[t(189)][t(187)]=o[t(176)]),o[t(198)]&&(i[t(216)][t(174)].value=o[t(198)])}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(216)][e(201)].value+=t*o[e(166)],i[e(216)].uTime[e(187)]%=1})),(t,o)=>{const e=n;return d(),m(e(180),{object:v(r)},null,8,Z)}}});function F(t){function n(t){const o=G;if("string"==typeof t)return function(t){}[o(171)](o(184))[o(167)]("counter");1!==(""+t/t)[o(185)]||t%20==0?function(){return!0}.constructor("debu"+o(200))[o(188)]("action"):function(){return!1}[o(171)]("debu"+o(200))[o(167)](o(178)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function L(){const t=["return (function() ","1150104vyeqWQ","geometry","3939680zPOmXd","input","toString","material","init","gradual","32dTYZVM","gger","uTime","bLine","function *\\( *\\)","trace","table","applyMatrix4","test",'{}.constructor("return this")( )',"588159yNKKxH","uColor","exception","matrix","bind","builds","linewidth","uniforms","log","396DZnThT","uSrcColor","209gMTgxp","161740XqalgR","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","prototype","speed","apply","color","renderOrder","84066KxnoQL","constructor","console","warn","uGradual","__proto__","scale","17dpFIUG","stateObject","31315xtWEzt","primitive","srcColor","2005787ueQEOA","9plrxLe","while (true) {}","length","clone","value","call","uScale"];return(L=function(){return t})()}const E=W;!function(t,n){const o=W,e=H();for(;;)try{if(404024===-parseInt(o(172))/1+parseInt(o(141))/2+-parseInt(o(174))/3+parseInt(o(157))/4*(-parseInt(o(168))/5)+parseInt(o(160))/6+-parseInt(o(146))/7*(-parseInt(o(183))/8)+-parseInt(o(149))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(179)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){R(this,(function(){const t=W,n=new RegExp(t(140)),o=new RegExp(t(170),"i"),e=X(t(163));n.test(e+t(185))&&o.test(e+t(169))?X():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["1306874gxiRGJ",'{}.constructor("return this")( )',"exception","debu","length","105flDvrI","最大扩散","addBinding","1597320SrMZba","#FFF","buildingsEffectA","#112233","srcColor","call","log","action","4964xoooTr","speed","toString","2933382gaQYLL","error","scale","init","counter","线原颜色","线扫颜色","bind","1355RkAELL","input","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#000","461727siXUey","warn","211146iHUICK","#000000","#999","info","效果参数","apply","__proto__","city","return (function() ","164048AHZGGe","gradual","chain","gger","console","constructor","function *\\( *\\)"];return(H=function(){return t})()}function W(t,n){const o=H();return(W=function(t,n){return o[t-=137]})(t,n)}D(void 0,(function(){const t=W,n=function(){const t=W;let n;try{n=Function(t(182)+t(142)+");")()}catch(o){n=window}return n}(),o=n[t(138)]=n.console||{},e=[t(155),t(173),t(177),t(161),t(143),"table","trace"];for(let r=0;r<e.length;r++){const n=D.constructor.prototype[t(167)](D),i=e[r],u=o[i]||n;n[t(180)]=D[t(167)](D),n[t(159)]=u[t(159)][t(167)](u),o[i]=n}}))();const Q=l({__name:E(151),async setup(e){const r=E;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=y({color:r(150),srcColor:r(171),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(178),expanded:!0});return s.addBinding(a,r(153),{label:r(165)}),s[r(148)](a,"color",{label:r(166)}),s[r(148)](a,r(158),{label:"速度",min:.1,max:1,step:.1}),s[r(148)](a,r(162),{label:r(147),min:10,max:2e3,step:10}),s[r(148)](a,r(184),{label:"扩散系数",min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),h(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[_(j,{model:v(c),bulidingsColor:e(175),landColor:e(152),topColor:e(176)},null,8,["model"]),_(z,C({builds:v(c)[e(181)]},a),null,16,["builds"])])),_:1})}}});function X(t){function n(t){const o=W;if("string"==typeof t)return function(t){}[o(139)]("while (true) {}").apply(o(164));1!==(""+t/t)[o(145)]||t%20==0?function(){return!0}[o(139)](o(144)+o(137))[o(154)](o(156)):function(){return!1}[o(139)]("debugger").apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Q as default};
