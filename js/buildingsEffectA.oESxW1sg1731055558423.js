import{P as t}from"./tweakpane.yHWGBmom1731055558423.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.CPptAKz41731055558423.js";import{e}from"./@tresjs.KsuCtVXf1731055558423.js";import{z as r}from"./three-custom-shader-material.JEUeb9V91731055558423.js";import{_ as i,C as u,cf as c,m as a,b3 as s}from"./three.3b9CEYeV1731055558423.js";import{d as l,a3 as f,w as p,o as d,D as m,u as v,a6 as g,r as h,f as y,g as w,j as _,m as C}from"./@vue.u2cBPEWn1731055558423.js";import"./@vueuse.GLWi_e1b1731055558423.js";const b=x;function x(t,n){const o=M();return(x=function(t,n){return o[t-=364]})(t,n)}!function(t,n){const o=x,e=M();for(;;)try{if(242325===-parseInt(o(405))/1*(-parseInt(o(426))/2)+parseInt(o(395))/3+parseInt(o(385))/4*(-parseInt(o(373))/5)+parseInt(o(429))/6*(-parseInt(o(409))/7)+parseInt(o(403))/8*(parseInt(o(396))/9)+-parseInt(o(418))/10*(parseInt(o(408))/11)+-parseInt(o(394))/12*(-parseInt(o(389))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[x(386)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(){const t=["forEach","return (function() ","error","material","#112233","Color","topColor","table","85ZKExje","#e523ff","init","computeBoundingBox","length","boundingBox","uColor","bind","log","children","while (true) {}","console","57748EJGPJz","apply","isArray","bModel","48841JowQZf","side","gger","call","value","3372OBLchA","104646TYHxXd","403911GuToLi","dispose","uOpacity","debu","constructor","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","#ffff00","8WeJdln","setStyle","4PnnjFE","bulidingsColor","MeshBasicMaterial","847TAolli","490812ktCJkz","landColor","renderOrder","opacity","object","chain","clone","test","model","51760fQcBmn","uGradient","uniforms","primitive","color","DoubleSide","info","__csm","50704TNHAXs","land","#ffffff","30nqjjVA","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","toString","gradient","string","exception"];return(M=function(){return t})()}!function(){I(this,(function(){const t=x,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=B(t(375));n[t(416)](e+t(414))&&o[t(416)](e+"input")?B():e("0")}))()}();const T=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[x(386)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();T(void 0,(function(){const t=x;let n;try{n=Function(t(366)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(384)]=n[t(384)]||{},e=[t(381),"warn",t(424),t(367),t(364),t(372),"trace"];for(let i=0;i<e[t(377)];i++){const n=T[t(400)].prototype[t(380)](T),r=e[i],u=o[r]||n;n.__proto__=T[t(380)](T),n[t(431)]=u.toString[t(380)](u),o[r]=n}}))();const S=[b(413)],j=l({__name:b(388),props:{model:{},bulidingsColor:{default:b(374)},landColor:{default:b(369)},topColor:{default:b(402)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,c=o[n(417)].city;o[n(417)][n(417)][n(382)][0][n(368)]=new(i[n(407)])({color:n(402)}),c[n(411)]=1001;const a=o[n(417)][n(427)];(()=>{const t=n,{geometry:e}=c;e[t(376)](),e.computeBoundingSphere();const{max:a,min:s}=e[t(378)];if(c[t(368)][t(425)])return;const l=new r({baseMaterial:c.material,vertexShader:t(401),fragmentShader:t(430),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(370)])(o[t(406)])},uOpacity:{value:o.opacity},uLightColor:{value:new u(t(428))},uTopColor:{value:new(i[t(370)])(o[t(371)])},uTime:{value:0},uGradient:{value:o[t(432)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(423)]});c.material[t(397)](),c.material=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(368)].uniforms.uTime[o(393)]+=t})),f((()=>{const t=n;o[t(406)]&&c[t(368)][t(420)][t(379)][t(393)][t(404)](o[t(406)]),o[t(410)]&&((t,e)=>{const r=n;let u;"cu"===t||t===r(427)&&(u=Array[r(387)](a.material)?a[r(368)]:[a.material],u[r(365)]((t=>{const n=r;t[e][n(404)](o[n(410)]),t[n(390)]=i[n(423)]})))})("land",t(422)),o[t(412)]&&(c[t(368)][t(420)][t(398)][t(393)]=o[t(412)])})),p(o,((t,o)=>{const e=n;c[e(368)][e(420)][e(419)].value=t[e(432)]}));const l=o[n(417)][n(417)][n(415)]();return(t,o)=>{const e=n;return d(),m(e(421),{object:v(l)},null,8,S)}}});function B(t){function n(t){const o=x;if(typeof t===o(433))return function(t){}[o(400)](o(383))[o(386)]("counter");1!==(""+t/t)[o(377)]||t%20==0?function(){return!0}[o(400)](o(399)+o(391))[o(392)]("action"):function(){return!1}[o(400)](o(399)+o(391))[o(386)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=A;function A(t,n){const o=O();return(A=function(t,n){return o[t-=309]})(t,n)}function O(){const t=["counter","uColor","uScale","gradual","object","builds","26535NyDUvP","log","init","uGradual","info","60sUtpBs","#000","bind","stateObject","constructor","apply","trace","color","toString","debu","string","material","primitive","123740vNTqtZ","5604636DDjLeD","18GYWmFq","length","4DwTYyg","31840aZfiRE","441575NdMstU","10GZrRxx","linewidth","test","uTime","69811JNhied","width","srcColor","prototype","geometry","chain","renderOrder","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","input","value","720wwHIUr","uniforms","3364185TucWtT","clone","warn","action","scale","#FFF","call"];return(O=function(){return t})()}!function(t,n){const o=A,e=O();for(;;)try{if(173512===parseInt(o(335))/1+-parseInt(o(322))/2*(-parseInt(o(317))/3)+-parseInt(o(339))/4*(parseInt(o(341))/5)+parseInt(o(337))/6*(parseInt(o(346))/7)+parseInt(o(340))/8*(-parseInt(o(356))/9)+-parseInt(o(342))/10*(parseInt(o(358))/11)+parseInt(o(336))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(327)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){F(this,(function(){const t=A,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(353),"i"),e=z(t(319));n[t(344)](e+t(351))&&o[t(344)](e+t(354))?z():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(327)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();E(void 0,(function(){const t=A;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n.console||{},e=[t(318),t(360),t(321),"error","exception","table",t(328)];for(let i=0;i<e[t(338)];i++){const n=E.constructor[t(349)].bind(E),r=e[i],u=o[r]||n;n.__proto__=E[t(324)](E),n[t(330)]=u[t(330)].bind(u),o[r]=n}}))();const G=[P(315)],Z=l({__name:"bLine",props:{builds:{},color:{default:P(309)},srcColor:{default:P(323)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(329)])},uSrcColor:{value:new u(o[n(348)])},uScale:{value:o[n(362)]},uTime:{value:0},uGradual:{value:o[n(314)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(316)][n(350)])[n(359)]();l=l.applyMatrix4(o[n(316)].matrix);const p=new a(i);r=new s(l,p),r[n(333)][n(343)]=o[n(347)],r[n(352)]=1e3,f((()=>{const t=n;o[t(329)]&&(i.uniforms[t(312)][t(355)]=new u(o[t(329)])),o[t(348)]&&(i[t(357)].uSrcColor[t(355)]=new u(o[t(348)])),o.scale&&(i[t(357)][t(313)][t(355)]=o[t(362)]),o[t(314)]&&(i[t(357)][t(320)][t(355)]=o[t(314)])}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(357)][e(345)][e(355)]+=t*o.speed,i.uniforms[e(345)].value%=1})),(t,o)=>{const e=n;return d(),m(e(334),{object:v(r)},null,8,G)}}});function z(t){function n(t){const o=A;if(typeof t===o(332))return function(t){}[o(326)]("while (true) {}").apply(o(311));1!==(""+t/t)[o(338)]||t%20==0?function(){return!0}[o(326)](o(331)+"gger")[o(310)](o(361)):function(){return!1}[o(326)](o(331)+"gger")[o(327)](o(325)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=J;!function(t,n){const o=J,e=L();for(;;)try{if(342809===parseInt(o(303))/1+-parseInt(o(284))/2+-parseInt(o(282))/3*(-parseInt(o(294))/4)+-parseInt(o(283))/5+parseInt(o(286))/6*(parseInt(o(316))/7)+-parseInt(o(314))/8+parseInt(o(298))/9*(parseInt(o(277))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(289)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function L(){const t=["constructor","21nYFwXx","length","gger","addBinding","console","call","#FFF","builds","最大扩散","action","srcColor","60zZSnAw","stateObject","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)",'{}.constructor("return this")( )',"#000","90183UeEgHk","2969350OptcdQ","34748MRcoYO","string","902970BjAJrA","info","prototype","apply","trace","model","buildingsEffectA","效果参数","4aTMBdc","warn","test","扩散系数","614763JcEgIE","exception","while (true) {}","function *\\( *\\)","input","595807pCYspW","线原颜色","bind","线扫颜色","__proto__","#000000","#999","color","table","debu","#112233","4265136oBUuFH"];return(L=function(){return t})()}!function(){R(this,(function(){const t=J,n=new RegExp(t(301)),o=new RegExp(t(279),"i"),e=k("init");n[t(296)](e+"chain")&&o[t(296)](e+t(302))?k():e("0")}))()}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(289)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function J(t,n){const o=L();return(J=function(t,n){return o[t-=271]})(t,n)}H(void 0,(function(){const t=J,n=function(){const t=J;let n;try{n=Function("return (function() "+t(280)+");")()}catch(o){n=window}return n}(),o=n[t(320)]=n[t(320)]||{},e=["log",t(295),t(287),"error",t(299),t(311),t(290)];for(let r=0;r<e.length;r++){const n=H.constructor[t(288)][t(305)](H),i=e[r],u=o[i]||n;n[t(307)]=H[t(305)](H),n.toString=u.toString.bind(u),o[i]=n}}))();const W=l({__name:D(292),async setup(e){const r=D;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:r(272),srcColor:r(281),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(293),expanded:!0});return s.addBinding(a,r(276),{label:r(304)}),s.addBinding(a,r(310),{label:r(306)}),s.addBinding(a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(319)](a,"scale",{label:r(274),min:10,max:2e3,step:10}),s.addBinding(a,"gradual",{label:r(297),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[_(j,{model:v(c),bulidingsColor:e(308),landColor:e(313),topColor:e(309)},null,8,[e(291)]),_(Z,C({builds:v(c).city},a),null,16,[e(273)])])),_:1})}}});function k(t){function n(t){const o=J;if(typeof t===o(285))return function(t){}.constructor(o(300))[o(289)]("counter");1!==(""+t/t)[o(317)]||t%20==0?function(){return!0}[o(315)](o(312)+"gger")[o(271)](o(275)):function(){return!1}[o(315)](o(312)+o(318)).apply(o(278)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{W as default};
