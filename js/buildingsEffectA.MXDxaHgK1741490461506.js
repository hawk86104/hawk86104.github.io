import{P as t}from"./tweakpane.yDiyAAkA1741490461506.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.yU0_MUZ61741490461506.js";import{e}from"./@tresjs.rE98Wm941741490461506.js";import{z as r}from"./three-custom-shader-material.ZFxoA-pL1741490461506.js";import{_ as i,C as u,co as c,l as a,b9 as s}from"./three.Vxh8Czkt1741490461506.js";import{d as l,a2 as f,w as p,o as d,H as m,u as g,a3 as v,r as h,f as y,g as C,j as w,m as _}from"./@vue.NRI7TcgI1741490461506.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741490461506.js";import"./postprocessing.wUw4_rsV1741490461506.js";import"./@vueuse.9Z-Ayxy41741490461506.js";const b=S;!function(t,n){const o=S,e=M();for(;;)try{if(665473===parseInt(o(450))/1*(parseInt(o(470))/2)+parseInt(o(438))/3*(parseInt(o(436))/4)+-parseInt(o(467))/5*(-parseInt(o(453))/6)+parseInt(o(419))/7+-parseInt(o(483))/8+-parseInt(o(466))/9*(parseInt(o(420))/10)+parseInt(o(435))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=S,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(479),"i"),e=O(t(463));n[t(468)](e+t(432))&&o[t(468)](e+t(443))?O():e("0")}))()}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(){const t=["gger","info","boundingBox","toString","action",'{}.constructor("return this")( )',"children","computeBoundingBox","prototype","#ffff00","chain","material","MeshBasicMaterial","5928945eBepdB","140GLSDax","log","666yhFxVh","renderOrder","city","model","debu","input","land","bModel","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","constructor","uOpacity","bind","511186YuBgub","opacity","isArray","470826QpTaUY","gradient","#ffffff","__csm","computeBoundingSphere","DoubleSide","bulidingsColor","uTime","trace","length","init","uColor","__proto__","537255altsOg","25naqHIv","test","uniforms","2qMLqmo","call","table","forEach","apply","setStyle","warn","object","value","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","side","console","3939768wZmAVP","topColor","stateObject","counter","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","error","#e523ff","460656ZXXhcr","60UgRmPC","Color"];return(M=function(){return t})()}function S(t,n){const o=M();return(S=function(t,n){return o[t-=413]})(t,n)}I(void 0,(function(){const t=S,n=function(){const t=S;let n;try{n=Function("return (function() "+t(427)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(482)]||{},e=[t(437),t(476),t(423),t(417),"exception",t(472),t(461)];for(let r=0;r<e[t(462)];r++){const n=I[t(447)][t(430)][t(449)](I),i=e[r],u=o[i]||n;n[t(465)]=I[t(449)](I),n.toString=u[t(425)][t(449)](u),o[i]=n}}))();const j=[b(477)],T=l({__name:b(445),props:{model:{},bulidingsColor:{default:b(418)},landColor:{default:"#112233"},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,c=o.model[n(440)];o.model[n(441)][n(428)][0][n(433)]=new(i[n(434)])({color:n(431)}),c[n(439)]=1001;const a=o[n(441)][n(444)];(()=>{const t=n,{geometry:e}=c;e[t(429)](),e[t(457)]();const{max:a,min:s}=e[t(424)];if(c[t(433)][t(456)])return;const l=new r({baseMaterial:c[t(433)],vertexShader:t(446),fragmentShader:t(416),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(421)])(o[t(459)])},uOpacity:{value:o.opacity},uLightColor:{value:new(i[t(421)])(t(455))},uTopColor:{value:new u(o[t(413)])},uTime:{value:0},uGradient:{value:o[t(454)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(458)]});c[t(433)].dispose(),c.material=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(433)][o(469)][o(460)][o(478)]+=t})),f((()=>{const t=n;o.bulidingsColor&&c.material[t(469)][t(464)][t(478)][t(475)](o.bulidingsColor),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(444)&&(u=Array[r(452)](a[r(433)])?a[r(433)]:[a[r(433)]],u[r(473)]((t=>{const n=r;t[e].setStyle(o.landColor),t[n(481)]=i[n(458)]})))})(t(444),"color"),o[t(451)]&&(c[t(433)][t(469)][t(448)][t(478)]=o[t(451)])})),p(o,((t,o)=>{const e=n;c[e(433)][e(469)].uGradient.value=t.gradient}));const l=o[n(441)][n(441)].clone();return(t,n)=>(d(),m("primitive",{object:g(l)},null,8,j))}});function O(t){function n(t){const o=S;if("string"==typeof t)return function(t){}[o(447)](o(480))[o(474)](o(415));1!==(""+t/t).length||t%20==0?function(){return!0}[o(447)](o(442)+o(422))[o(471)](o(426)):function(){return!1}[o(447)]("debu"+o(422))[o(474)](o(414)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=G;!function(t,n){const o=G,e=Z();for(;;)try{if(925837===-parseInt(o(503))/1+-parseInt(o(518))/2*(parseInt(o(507))/3)+parseInt(o(516))/4*(parseInt(o(514))/5)+parseInt(o(532))/6+parseInt(o(535))/7*(-parseInt(o(520))/8)+parseInt(o(512))/9*(-parseInt(o(490))/10)+parseInt(o(491))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(487)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=G,n=new RegExp(t(525)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=L("init");n.test(e+"chain")&&o[t(515)](e+t(502))?L():e("0")}))()}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(487)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();B(void 0,(function(){const t=G,n=function(){const t=G;let n;try{n=Function(t(523)+t(499)+");")()}catch(o){n=window}return n}(),o=n[t(496)]=n.console||{},e=[t(529),"warn",t(533),"error",t(519),t(489),t(538)];for(let r=0;r<e[t(526)];r++){const n=B[t(522)][t(521)][t(501)](B),i=e[r],u=o[i]||n;n.__proto__=B.bind(B),n[t(534)]=u[t(534)][t(501)](u),o[i]=n}}))();const F=[P(531)];function Z(){const t=["length","scale","matrix","log","builds","object","276636abgRXM","info","toString","98rDYCag","uTime","renderOrder","trace","action","bLine","apply","debu","table","10nfnklX","49967533CUOKZx","clone","uniforms","color","speed","console","gradual","gger",'{}.constructor("return this")( )',"uGradual","bind","input","1115834JClajP","while (true) {}","width","call","2912955lyVZwI","value","srcColor","uColor","counter","7351686IvLFOG","#FFF","7985AzuMKm","test","1940hhIaft","uSrcColor","2MOafAN","exception","876368iyvhXA","prototype","constructor","return (function() ","primitive","function *\\( *\\)"];return(Z=function(){return t})()}function G(t,n){const o=Z();return(G=function(t,n){return o[t-=485]})(t,n)}const z=l({__name:P(486),props:{builds:{},color:{default:P(513)},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(494)])},uSrcColor:{value:new u(o[n(509)])},uScale:{value:o[n(527)]},uTime:{value:0},uGradual:{value:o[n(497)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(530)].geometry)[n(492)]();l=l.applyMatrix4(o[n(530)][n(528)]);const p=new a(i);r=new s(l,p),r.material.linewidth=o[n(505)],r[n(537)]=1e3,f((()=>{const t=n;o[t(494)]&&(i[t(493)][t(510)][t(508)]=new u(o.color)),o.srcColor&&(i[t(493)][t(517)].value=new u(o[t(509)])),o[t(527)]&&(i[t(493)].uScale[t(508)]=o[t(527)]),o[t(497)]&&(i[t(493)][t(500)][t(508)]=o.gradual)}));const{onLoop:v}=e();return v((({delta:t})=>{const e=n;i.uniforms[e(536)][e(508)]+=t*o[e(495)],i[e(493)][e(536)].value%=1})),(t,o)=>{const e=n;return d(),m(e(524),{object:g(r)},null,8,F)}}});function L(t){function n(t){const o=G;if("string"==typeof t)return function(t){}[o(522)](o(504))[o(487)](o(511));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(488)+"gger")[o(506)](o(485)):function(){return!1}[o(522)](o(488)+o(498)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const R=W;!function(t,n){const o=W,e=H();for(;;)try{if(512015===parseInt(o(425))/1*(parseInt(o(420))/2)+-parseInt(o(454))/3+parseInt(o(456))/4+-parseInt(o(464))/5*(parseInt(o(438))/6)+parseInt(o(448))/7*(-parseInt(o(442))/8)+-parseInt(o(430))/9+parseInt(o(429))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(443)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=W,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(459),"i"),e=K(t(439));n[t(445)](e+"chain")&&o[t(445)](e+"input")?K():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(443)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function W(t,n){const o=H();return(W=function(t,n){return o[t-=418]})(t,n)}D(void 0,(function(){const t=W;let n;try{n=Function(t(431)+t(450)+");")()}catch(r){n=window}const o=n[t(418)]=n[t(418)]||{},e=[t(419),t(444),t(447),"error","exception",t(422),t(457)];for(let i=0;i<e[t(423)];i++){const n=D.constructor[t(427)][t(463)](D),r=e[i],u=o[r]||n;n[t(452)]=D[t(463)](D),n.toString=u[t(453)][t(463)](u),o[r]=n}}))();const k=l({__name:R(451),async setup(e){const r=R;let i,u;const c=([i,u]=v((()=>o())),i=await i,u(),i),a=h({color:r(455),srcColor:r(461),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(434),expanded:!0});return s[r(428)](a,r(449),{label:r(424)}),s[r(428)](a,r(441),{label:"线扫颜色"}),s[r(428)](a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(428)](a,r(436),{label:"最大扩散",min:10,max:2e3,step:10}),s.addBinding(a,r(421),{label:r(466),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[w(T,{model:g(c),bulidingsColor:"#000000",landColor:e(446),topColor:"#999"},null,8,[e(458)]),w(z,_({builds:g(c)[e(462)]},a),null,16,[e(432)])])),_:1})}}});function H(){const t=["buildingsEffectA","__proto__","toString","1143270ujEKne","#FFF","2540896uZVnKm","trace","model","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","#000","city","bind","46385OJgmoP","while (true) {}","扩散系数","console","log","10986QllyqG","gradual","table","length","线原颜色","63HnKQQi","gger","prototype","addBinding","17839080aWUlOK","6931008lPLDuO","return (function() ","builds","string","效果参数","debu","scale","call","168jWAjsN","init","constructor","color","3368872PRWmNT","apply","warn","test","#112233","info","14NYfzWS","srcColor",'{}.constructor("return this")( )'];return(H=function(){return t})()}function K(t){function n(t){const o=W;if(typeof t===o(433))return function(t){}.constructor(o(465))[o(443)](o(460));1!==(""+t/t)[o(423)]||t%20==0?function(){return!0}.constructor(o(435)+o(426))[o(437)]("action"):function(){return!1}[o(440)]("debu"+o(426)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{k as default};
