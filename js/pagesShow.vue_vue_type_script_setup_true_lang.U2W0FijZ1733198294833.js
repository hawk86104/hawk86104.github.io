import{_ as t,C as n,a0 as o,cd as e,ce as r,cf as i,cg as u,m as c,bU as s,ak as a,am as l}from"./three.8iJMi2lU1733198294833.js";import{d as f,e as p,U as d}from"./@tresjs.sklxXn0u1733198294833.js";import{z as h}from"./three-custom-shader-material.GYlVajj-1733198294833.js";import{d as m,b as y,a3 as g,w,o as v,D as _,u as I,r as b,a6 as C,e as x,f as M,g as T,J as A,j as O,aj as S,ak as R,F as B,I as j,G as D,m as E}from"./@vue.-THQH3GC1733198294833.js";function L(){const t=["952ATqlVv","name","2Sncajv","warn","prototype","4704DMqEtU","log","ROADS","call","LANDMASS","debu","test","171hBRTai","function *\\( *\\)","console","stateObject","2299944VpEgqJ",'{}.constructor("return this")( )',"35276HBdSCc","195eteNNU","25850tbpFFM","toString","input","36ikrdMQ","772059PmMFXw","init","action","while (true) {}","return (function() ","exception","gger","string","error","counter","traverse","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","CITY_UNTRIANGULATED","chain","70660sslKLl","apply","bind","2837791DwITIP"];return(L=function(){return t})()}!function(t,n){const o=H,e=L();for(;;)try{if(199923===-parseInt(o(388))/1+parseInt(o(394))/2*(parseInt(o(416))/3)+parseInt(o(410))/4*(parseInt(o(411))/5)+-parseInt(o(397))/6*(-parseInt(o(392))/7)+parseInt(o(408))/8+parseInt(o(404))/9*(parseInt(o(412))/10)+parseInt(o(391))/11*(-parseInt(o(415))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(389)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(t,n){const o=L();return(H=function(t,n){return o[t-=378]})(t,n)}!function(){k(this,(function(){const t=H,n=new RegExp(t(405)),o=new RegExp(t(385),"i"),e=P(t(417));n[t(403)](e+t(387))&&o[t(403)](e+t(414))?P():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(389)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=H,n=function(){const t=H;let n;try{n=Function(t(378)+t(409)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(406)]||{},e=[t(398),t(395),"info",t(382),t(379),"table","trace"];for(let r=0;r<e.length;r++){const n=z.constructor[t(396)][t(390)](z),i=e[r],u=o[i]||n;n.__proto__=z[t(390)](z),n[t(413)]=u[t(413)][t(390)](u),o[i]=n}}))();const F=async()=>{const t=H,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(384)]((n=>{const i=t;n[i(393)]===i(386)&&(o=n),n[i(393)]===i(401)&&(e=n),n[i(393)]===i(399)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function P(t){function n(t){const o=H;if(typeof t===o(381))return function(t){}.constructor(o(419))[o(389)](o(383));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(402)+o(380))[o(400)](o(418)):function(){return!1}.constructor(o(402)+o(380))[o(389)](o(407)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=Z;!function(t,n){const o=Z,e=q();for(;;)try{if(670185===-parseInt(o(452))/1+parseInt(o(497))/2+-parseInt(o(478))/3*(parseInt(o(483))/4)+-parseInt(o(460))/5+parseInt(o(508))/6*(parseInt(o(488))/7)+parseInt(o(448))/8+parseInt(o(494))/9*(-parseInt(o(453))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(457)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){W(this,(function(){const t=Z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(484),"i"),e=X(t(465));n[t(450)](e+t(462))&&o[t(450)](e+t(477))?X():e("0")}))()}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(457)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();J(void 0,(function(){const t=Z;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n[t(473)]||{},e=[t(489),t(500),"info",t(485),t(501),t(471),t(505)];for(let i=0;i<e[t(461)];i++){const n=J.constructor[t(482)][t(466)](J),r=e[i],u=o[r]||n;n.__proto__=J[t(466)](J),n[t(459)]=u[t(459)].bind(u),o[r]=n}}))();const V=[G(455)];function Z(t,n){const o=q();return(Z=function(t,n){return o[t-=448]})(t,n)}const $=m({__name:G(503),props:{model:{},bulidingsColor:{default:G(480)},landColor:{default:G(486)},topColor:{default:G(510)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=G,i=e,u=y(0),c=i[r(495)][r(475)];c[r(451)]=1001;const s=i.model.land;(()=>{const e=r,{geometry:s}=c;s[e(454)](),s[e(499)]();const{max:a,min:l}=s[e(458)];if(c.material[e(490)])return;const f=new h({baseMaterial:c[e(468)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:a},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[e(470)])(i[e(463)])},uOpacity:{value:i[e(464)]},uLightColor:{value:new(t[e(470)])("#ffffff")},uTopColor:{value:new n(i[e(469)])},uTime:u,uGradient:{value:i[e(487)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:o});c.material.dispose(),c.material=f})();const{onLoop:a}=p();a((({delta:t})=>{u[r(496)]+=t})),g((()=>{const n=r;i[n(463)]&&c[n(468)].uniforms[n(456)].value.setStyle(i[n(463)]),i[n(467)]&&((n,o)=>{const e=r;let u;"cu"===n||n===e(513)&&(u=Array.isArray(s.material)?s[e(468)]:[s.material],u[e(449)]((n=>{const r=e;n[o][r(474)](i[r(467)]),n[r(476)]=t[r(491)]})))})(n(513),n(502)),i.opacity&&(c[n(468)][n(492)][n(512)][n(496)]=i.opacity)})),w(i,((t,n)=>{const o=r;c[o(468)][o(492)][o(504)][o(496)]=t[o(487)]}));const l=i.model[r(495)][r(481)]();return(t,n)=>{const o=r;return v(),_(o(472),{object:I(l)},null,8,V)}}});function X(t){function n(t){const o=Z;if("string"==typeof t)return function(t){}[o(511)](o(509)).apply("counter");1!==(""+t/t)[o(461)]||t%20==0?function(){return!0}[o(511)](o(493)+o(507))[o(506)](o(479)):function(){return!1}[o(511)](o(493)+o(507))[o(457)](o(498)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function q(){const t=["topColor","Color","table","primitive","console","setStyle","city","side","input","108yAQyCw","action","#e523ff","clone","prototype","103932fjHIkA","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","error","#112233","gradient","3437RoAXJT","log","__csm","DoubleSide","uniforms","debu","3934431xHrjic","model","value","678186DdaJJX","stateObject","computeBoundingSphere","warn","exception","color","buildingsModelCustomShader","uGradient","trace","call","gger","13722SlqVLQ","while (true) {}","#ffff00","constructor","uOpacity","land","10557248AIItBA","forEach","test","renderOrder","620898gOmxHt","10vVJpvS","computeBoundingBox","object","uColor","apply","boundingBox","toString","590180tRxlkv","length","chain","bulidingsColor","opacity","init","bind","landColor","material"];return(q=function(){return t})()}const U=N;function N(t,n){const o=tt();return(N=function(t,n){return o[t-=345]})(t,n)}!function(t,n){const o=N,e=tt();for(;;)try{if(743744===-parseInt(o(356))/1+-parseInt(o(371))/2*(-parseInt(o(349))/3)+parseInt(o(370))/4+-parseInt(o(399))/5*(-parseInt(o(354))/6)+-parseInt(o(357))/7+parseInt(o(361))/8*(parseInt(o(400))/9)+parseInt(o(375))/10*(-parseInt(o(388))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){K(this,(function(){const t=N,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(394),"i"),e=ot("init");n.test(e+t(401))&&o[t(397)](e+t(386))?ot():e("0")}))()}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(374)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Q(void 0,(function(){const t=N;let n;try{n=Function("return (function() "+t(364)+");")()}catch(r){n=window}const o=n[t(365)]=n[t(365)]||{},e=["log",t(384),"info",t(348),t(383),t(368),t(369)];for(let i=0;i<e[t(351)];i++){const n=Q.constructor[t(387)].bind(Q),r=e[i],u=o[r]||n;n.__proto__=Q[t(398)](Q),n[t(395)]=u[t(395)].bind(u),o[r]=n}}))();const Y=[U(391)];function tt(){const t=["action","material","applyMatrix4","exception","warn","style","input","prototype","28622KWBTQc","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      "," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","object","Wireframe","primitive","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","toString","uOpacity","test","bind","1255rcacBq","522uVNKsO","chain","resolution","innerHeight","renderOrder","value","stateObject","width","error","1282257RkWTOO","constructor","length","opacity","debu","25512wUqMJI","geometry","1076687eylsOo","5933312nvWDbj","builds","string","clone","18736dSzHJe","counter","uniforms",'{}.constructor("return this")( )',"console","color","Shader","table","trace","5143800pGPuKV","6Eeuscw","gger","uColor","apply","4240lBxyeW","matrix","call","linewidth","buildingsLines"];return(tt=function(){return t})()}const nt=m({__name:U(379),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:U(392)}},setup(t){const o=U,s=t;let a=null,l=null;if(s[o(385)]===o(392)){const t=new e(s[o(358)][o(355)]);let n=(new r).fromEdgesGeometry(t),c=new i({color:s[o(366)],linewidth:s[o(347)],opacity:s[o(352)],transparent:!0,depthWrite:!0,depthTest:!0});c[o(402)].set(window.innerWidth,window[o(403)]),a=new u(n,c),a[o(382)](s[o(358)][o(376)][o(360)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[o(366)])},uOpacity:{value:s.opacity}},vertexShader:o(389),fragmentShader:o(390)};const t=new e(s[o(358)][o(355)]),r=new c(l);a=new LineSegments(t,r),a[o(382)](s[o(358)][o(376)].clone()),a.material.linewidth=s[o(347)],a[o(404)]=1e3}return g((()=>{const t=o;s[t(385)]===t(367)&&(s[t(366)]&&(l.uniforms[t(373)][t(345)]=new n(s[t(366)])),s[t(352)]&&(l[t(363)][t(396)][t(345)]=s[t(352)])),s[t(385)]===t(392)&&(s[t(366)]&&(a.material[t(366)]=new n(s.color)),s[t(352)]&&(a.material[t(352)]=s[t(352)])),s[t(347)]&&(a[t(381)][t(378)]=s.width)})),(t,n)=>{const e=o;return v(),_(e(393),{object:I(a)},null,8,Y)}}});function ot(t){function n(t){const o=N;if(typeof t===o(359))return function(t){}.constructor("while (true) {}")[o(374)](o(362));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(353)+o(372))[o(377)](o(380)):function(){return!1}[o(350)](o(353)+o(372))[o(374)](o(346)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=at;!function(t,n){const o=at,e=st();for(;;)try{if(327408===-parseInt(o(465))/1*(-parseInt(o(434))/2)+-parseInt(o(469))/3+-parseInt(o(436))/4+parseInt(o(476))/5+-parseInt(o(464))/6+-parseInt(o(474))/7*(parseInt(o(426))/8)+-parseInt(o(475))/9*(-parseInt(o(452))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(467)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=at,n=new RegExp(t(455)),o=new RegExp(t(444),"i"),e=ft(t(432));n.test(e+t(446))&&o[t(477)](e+t(470))?ft():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=at;let n;try{n=Function(t(457)+t(473)+");")()}catch(r){n=window}const o=n[t(447)]=n[t(447)]||{},e=["log",t(437),t(468),t(453),t(459),t(450),t(440)];for(let i=0;i<e.length;i++){const n=it[t(443)][t(462)][t(428)](it),r=e[i],u=o[r]||n;n[t(463)]=it[t(428)](it),n[t(456)]=u[t(456)][t(428)](u),o[r]=n}}))();const ut={key:1,args:[1e3],position:[0,19,0]},ct={key:2,args:[6e3,100],position:[0,19,0]};function st(){const t=["showGridHelper","256OzoDcA","showAxesHelper","1697424JVsuiZ","warn","action","TresCanvas","trace","$slots","showBuildings","constructor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","chain","console","string","call","table","model","30sXMVro","error","TresPerspectiveCamera","function *\\( *\\)","toString","return (function() ","#000000","exception","gger","while (true) {}","prototype","__proto__","3186888zrOgDA","4904XJTELM","builds","apply","info","577404iYdPGb","input","TresGridHelper","ability",'{}.constructor("return this")( )',"2114YEteTt","1247508uLzgdj","2609140yXRYoS","test","pagesShow","TresAxesHelper","stateObject","2384qXnHVK","TresAmbientLight","bind","length","#000","#ffffff","init"];return(st=function(){return t})()}function at(t,n){const o=st();return(at=function(t,n){return o[t-=424]})(t,n)}const lt=m({__name:et(478),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=b({clearColor:n(458),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:l,disableRender:r.disableRender}),u=b({autoRotate:r.autoRotate,enableDamping:!0});let c=null;r[n(442)]&&([o,e]=C((()=>F())),o=await o,e(),c=o);const f=y(),p=y();return(t,o)=>{const e=n,s=x(e(439));return v(),M(s,E({ref_key:"tcRef",ref:p},i,{"window-size":""}),{default:T((()=>[A(e(454),{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),O(I(d),S(R(u)),null,16),o[0]||(o[0]=A(e(427),{color:e(431)},null,-1)),o[1]||(o[1]=A("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1)),r[e(442)]&&I(c)?(v(),_(B,{key:0},[O($,{model:I(c)},null,8,[e(451)]),O(nt,{builds:I(c).city,color:e(430)},null,8,[e(466)])],64)):j("",!0),D(t[e(441)],e(472)),r[e(435)]?(v(),_(e(424),ut)):j("",!0),r[e(433)]?(v(),_(e(471),ct)):j("",!0)])),_:3},16)}}});function ft(t){function n(t){const o=at;if(typeof t===o(448))return function(t){}[o(443)](o(461))[o(467)]("counter");1!==(""+t/t)[o(429)]||t%20==0?function(){return!0}.constructor(o(445)+o(460))[o(449)](o(438)):function(){return!1}[o(443)](o(445)+"gger").apply(o(425)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as _,nt as a,lt as b,F as l};
