import{importShared as y}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{createInjectionKey as d,warn as E}from"./light.Bp388JKA1767148983502.js";import{off as h,on as g}from"./use-merged-state.qnrvbG9d1767148983502.js";import{createId as q,getPreciseEventTarget as O,flatten as C}from"./Scrollbar.BsFc6odp1767148983502.js";const{ref:P,readonly:z,watch:H}=await y("vue");function U(e){const t=P(!!e.value);if(t.value)return z(t);const n=H(e,r=>{r&&(t.value=!0,n())});return z(t)}const{getCurrentInstance:_}=await y("vue");function he(){return _()!==null}const ye=typeof window<"u",pe=d("n-drawer-body"),me=d("n-drawer"),xe=d("n-modal-body"),ge=d("n-modal-provider"),be=d("n-modal"),Ie=d("n-popover-body"),{Fragment:W,createTextVNode:X,Comment:G}=await y("vue");function Z(e,t,n="default"){const r=t[n];if(r===void 0)throw new Error(`[vueuc/${e}]: slot[${n}] is empty.`);return r()}function F(e,t=!0,n=[]){return e.forEach(r=>{if(r!==null){if(typeof r!="object"){(typeof r=="string"||typeof r=="number")&&n.push(X(String(r)));return}if(Array.isArray(r)){F(r,t,n);return}if(r.type===W){if(r.children===null)return;Array.isArray(r.children)&&F(r.children,t,n)}else r.type!==G&&n.push(r)}}),n}function ve(e,t,n="default"){const r=t[n];if(r===void 0)throw new Error(`[vueuc/${e}]: slot[${n}] is empty.`);const u=F(r());if(u.length===1)return u[0];throw new Error(`[vueuc/${e}]: slot[${n}] should have exactly one child.`)}const a="@@coContext",we={mounted(e,{value:t,modifiers:n}){e[a]={handler:void 0},typeof t=="function"&&(e[a].handler=t,g("clickoutside",e,t,{capture:n.capture}))},updated(e,{value:t,modifiers:n}){const r=e[a];typeof t=="function"?r.handler?r.handler!==t&&(h("clickoutside",e,r.handler,{capture:n.capture}),r.handler=t,g("clickoutside",e,t,{capture:n.capture})):(e[a].handler=t,g("clickoutside",e,t,{capture:n.capture})):r.handler&&(h("clickoutside",e,r.handler,{capture:n.capture}),r.handler=void 0)},unmounted(e,{modifiers:t}){const{handler:n}=e[a];n&&h("clickoutside",e,n,{capture:t.capture}),e[a].handler=void 0}};function J(e,t){console.error(`[vdirs/${e}]: ${t}`)}class Q{constructor(){this.elementZIndex=new Map,this.nextZIndex=2e3}get elementCount(){return this.elementZIndex.size}ensureZIndex(t,n){const{elementZIndex:r}=this;if(n!==void 0){t.style.zIndex=`${n}`,r.delete(t);return}const{nextZIndex:u}=this;r.has(t)&&r.get(t)+1===this.nextZIndex||(t.style.zIndex=`${u}`,r.set(t,u),this.nextZIndex=u+1,this.squashState())}unregister(t,n){const{elementZIndex:r}=this;r.has(t)?r.delete(t):n===void 0&&J("z-index-manager/unregister-element","Element not found when unregistering."),this.squashState()}squashState(){const{elementCount:t}=this;t||(this.nextZIndex=2e3),this.nextZIndex-t>2500&&this.rearrange()}rearrange(){const t=Array.from(this.elementZIndex.entries());t.sort((n,r)=>n[1]-r[1]),this.nextZIndex=2e3,t.forEach(n=>{const r=n[0],u=this.nextZIndex++;`${u}`!==r.style.zIndex&&(r.style.zIndex=`${u}`)})}}const v=new Q,l="@@ziContext",Ee={mounted(e,t){const{value:n={}}=t,{zIndex:r,enabled:u}=n;e[l]={enabled:!!u,initialized:!1},u&&(v.ensureZIndex(e,r),e[l].initialized=!0)},updated(e,t){const{value:n={}}=t,{zIndex:r,enabled:u}=n,s=e[l].enabled;u&&!s&&(v.ensureZIndex(e,r),e[l].initialized=!0),e[l].enabled=!!u},unmounted(e,t){if(!e[l].initialized)return;const{value:n={}}=t,{zIndex:r}=n;v.unregister(e,r)}};function k(e){return typeof e=="string"?document.querySelector(e):e()||null}const{Teleport:Y,h:N,toRef:ee,computed:te,defineComponent:ne}=await y("vue"),Fe=ne({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(e){return{showTeleport:U(ee(e,"show")),mergedTo:te(()=>{const{to:t}=e;return t??"body"})}},render(){return this.showTeleport?this.disabled?Z("lazy-teleport",this.$slots):N(Y,{disabled:this.disabled,to:this.mergedTo},Z("lazy-teleport",this.$slots)):null}});function j(e){return e instanceof HTMLElement}function B(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if(j(n)&&(L(n)||B(n)))return!0}return!1}function K(e){for(let t=e.childNodes.length-1;t>=0;t--){const n=e.childNodes[t];if(j(n)&&(L(n)||K(n)))return!0}return!1}function L(e){if(!re(e))return!1;try{e.focus({preventScroll:!0})}catch{}return document.activeElement===e}function re(e){if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return e.type!=="hidden"&&e.type!=="file";case"SELECT":case"TEXTAREA":return!0;default:return!1}}const{h:w,defineComponent:oe,ref:A,Fragment:ie,onMounted:ue,onBeforeUnmount:se,watch:ce}=await y("vue");let f=[];const Se=oe({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:[String,Function],finalFocusTo:[String,Function],returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const t=q(),n=A(null),r=A(null);let u=!1,s=!1;const S=typeof document>"u"?null:document.activeElement;function p(){return f[f.length-1]===t}function b(o){var i;o.code==="Escape"&&p()&&((i=e.onEsc)===null||i===void 0||i.call(e,o))}ue(()=>{ce(()=>e.active,o=>{o?(M(),g("keydown",document,b)):(h("keydown",document,b),u&&$())},{immediate:!0})}),se(()=>{h("keydown",document,b),u&&$()});function T(o){if(!s&&p()){const i=I();if(i===null||i.contains(O(o)))return;c("first")}}function I(){const o=n.value;if(o===null)return null;let i=o;for(;i=i.nextSibling,!(i===null||i instanceof Element&&i.tagName==="DIV"););return i}function M(){var o;if(!e.disabled){if(f.push(t),e.autoFocus){const{initialFocusTo:i}=e;i===void 0?c("first"):(o=k(i))===null||o===void 0||o.focus({preventScroll:!0})}u=!0,document.addEventListener("focus",T,!0)}}function $(){var o;if(e.disabled||(document.removeEventListener("focus",T,!0),f=f.filter(m=>m!==t),p()))return;const{finalFocusTo:i}=e;i!==void 0?(o=k(i))===null||o===void 0||o.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&S instanceof HTMLElement&&(s=!0,S.focus({preventScroll:!0}),s=!1)}function c(o){if(p()&&e.active){const i=n.value,m=r.value;if(i!==null&&m!==null){const x=I();if(x==null||x===m){s=!0,i.focus({preventScroll:!0}),s=!1;return}s=!0;const R=o==="first"?B(x):K(x);s=!1,R||(s=!0,i.focus({preventScroll:!0}),s=!1)}}}function V(o){if(s)return;const i=I();i!==null&&(o.relatedTarget!==null&&i.contains(o.relatedTarget)?c("last"):c("first"))}function D(o){s||(o.relatedTarget!==null&&o.relatedTarget===n.value?c("last"):c("first"))}return{focusableStartRef:n,focusableEndRef:r,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:V,handleEndFocus:D}},render(){const{default:e}=this.$slots;if(e===void 0)return null;if(this.disabled)return e();const{active:t,focusableStyle:n}=this;return w(ie,null,[w("div",{"aria-hidden":"true",tabindex:t?"0":"-1",ref:"focusableStartRef",style:n,onFocus:this.handleStartFocus}),e(),w("div",{"aria-hidden":"true",style:n,ref:"focusableEndRef",tabindex:t?"0":"-1",onFocus:this.handleEndFocus})])}});function Te(e,t="default",n=void 0){const r=e[t];if(!r)return E("getFirstSlotVNode",`slot[${t}] is empty`),null;const u=C(r(n));return u.length===1?u[0]:(E("getFirstSlotVNode",`slot[${t}] should have exactly one child`),null)}function $e(e,t,n){if(!t)return null;const r=C(t(n));return r.length===1?r[0]:(E("getFirstSlotVNode",`slot[${e}] should have exactly one child`),null)}function ze(e,t=[],n){const r={};return t.forEach(u=>{r[u]=e[u]}),Object.assign(r,n)}export{Se as FocusTrap,Fe as LazyTeleport,we as clickoutside,pe as drawerBodyInjectionKey,me as drawerInjectionKey,Te as getFirstSlotVNode,$e as getFirstSlotVNodeWithTypedProps,ve as getFirstVNode,Z as getSlot,he as hasInstance,ye as isBrowser,ze as keep,xe as modalBodyInjectionKey,be as modalInjectionKey,ge as modalProviderInjectionKey,Ie as popoverBodyInjectionKey,U as useFalseUntilTruthy,Ee as zindexable};
