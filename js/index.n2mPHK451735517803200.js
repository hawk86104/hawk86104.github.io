import{m as n,e as t}from"./@tresjs.0qL_P2CE1735517803200.js";import{_ as o,V as e,cm as r,cn as i,co as u,C as c,cJ as a}from"./three.-uH5I3Xp1735517803200.js";import{z as s}from"./three-custom-shader-material.T7xd34Ba1735517803200.js";import{T as f}from"./3d-tiles-renderer.GHuPIZFM1735517803200.js";import{d as l,b as p,a3 as d,o as m,D as h,J as g,u as v}from"./@vue.-THQH3GC1735517803200.js";import{P as w,U as y,M as x,T as _,a as b}from"./index.gnFY5PJl1735517803200.js";import"./mapBoxShow.vue_vue_type_script_setup_true_lang.S7AagKMx1735517803200.js";import"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.7fq3J4jw1735517803200.js";import"./utils.repkt6mZ1735517803200.js";!function(n,t){const o=T,e=M();for(;;)try{if(129698===parseInt(o(495))/1*(-parseInt(o(496))/2)+parseInt(o(534))/3+-parseInt(o(533))/4+-parseInt(o(519))/5*(parseInt(o(489))/6)+-parseInt(o(512))/7+-parseInt(o(527))/8*(-parseInt(o(524))/9)+parseInt(o(493))/10*(parseInt(o(486))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[T(492)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function M(){const n=["debu","center","gger","Matrix4","error","getBoundingSphere","action","function *\\( *\\)","trace","Vector3","__proto__","init","constructor","crossVectors","1475915mzyEcC","input","length","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","chain","Sphere","1880FEGWZo","counter","normalize","console","clone","396UXAPGZ","position","Quaternion","47000GifZiI","Box3","return (function() ","dot","test","prototype","185676CLuOsh","523473TDUdcY","814hlMPHj","table","bind","1176oYXDmT","toString","exception","apply","12890XjbJwD","quaternion","1zCfDIo","135438qYLKTS","group"];return(M=function(){return n})()}!function(){I(this,(function(){const n=T,t=new RegExp(n(505)),o=new RegExp(n(515),"i"),e=j(n(509));t[n(531)](e+n(517))&&o[n(531)](e+n(513))?j():e("0")}))()}();const C=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[T(492)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();C(void 0,(function(){const n=T,t=function(){const n=T;let t;try{t=Function(n(529)+'{}.constructor("return this")( ));')()}catch(o){t=window}return t}(),o=t.console=t[n(522)]||{},e=["log","warn","info",n(502),n(491),n(487),n(506)];for(let r=0;r<e[n(514)];r++){const t=C[n(510)][n(532)][n(488)](C),i=e[r],u=o[i]||t;t[n(508)]=C[n(488)](C),t.toString=u[n(490)][n(488)](u),o[i]=t}}))();const z=n=>{n.onLoadTileSet=t=>{const r=T,i=new(o[r(528)]),u=new(o[r(518)]),c=new(o[r(501)]);let a=null,s=0;n.getOrientedBounds(i,c)?(a=(new(o[r(507)])).setFromMatrixPosition(c),s=a[r(514)]()):n[r(503)](u)&&(a=u[r(499)][r(523)](),s=a.length());const f=((n,t)=>{const e=T,r=new(o[e(526)]),i=(new(o[e(507)]))[e(511)](n,t);return r.x=i.x,r.y=i.y,r.z=i.z,r.w=1+n[e(523)]()[e(530)](t),r[e(521)](),r})(null==a?void 0:a[r(521)](),new e(0,1,0));n[r(497)][r(494)].x=f.x,n.group[r(494)].y=f.y,n[r(497)][r(494)].z=f.z,n[r(497)][r(494)].w=f.w,n[r(497)][r(525)].z=-s}};function T(n,t){const o=M();return(T=function(n,t){return o[n-=486]})(n,t)}function j(n){function t(n){const o=T;if("string"==typeof n)return function(n){}[o(510)](o(516))[o(492)](o(520));1!==(""+n/n)[o(514)]||n%20==0?function(){return!0}.constructor(o(498)+o(500)).call(o(504)):function(){return!1}[o(510)](o(498)+o(500))[o(492)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(o){}}function B(n,t){const o=D();return(B=function(n,t){return o[n-=435]})(n,t)}const S=B;!function(n,t){const o=B,e=D();for(;;)try{if(102913===parseInt(o(474))/1*(-parseInt(o(488))/2)+parseInt(o(468))/3*(-parseInt(o(484))/4)+-parseInt(o(461))/5*(-parseInt(o(491))/6)+-parseInt(o(464))/7+-parseInt(o(465))/8+parseInt(o(478))/9+parseInt(o(487))/10*(parseInt(o(489))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();!function(){P(this,(function(){const n=B,t=new RegExp("function *\\( *\\)"),o=new RegExp(n(502),"i"),e=R(n(442));t[n(506)](e+n(452))&&o[n(506)](e+n(459))?R():e("0")}))()}();const O=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[B(436)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();O(void 0,(function(){const n=B;let t;try{t=Function("return (function() "+n(493)+");")()}catch(r){t=window}const o=t.console=t[n(437)]||{},e=[n(495),"warn",n(490),"error","exception",n(469),n(438)];for(let i=0;i<e[n(485)];i++){const t=O[n(477)][n(470)][n(443)](O),r=e[i],u=o[r]||t;t[n(445)]=O.bind(O),t[n(496)]=u[n(496)].bind(u),o[r]=t}}))();const Z=[S(440)];function D(){const n=["topColor","isMesh","DoubleSide","input","call","15nfszvD","TresGroup","opacity","409640blxQoj","1425808rfckRa","setCamera","MeshPhongMaterial","654evidKr","table","prototype","onLoadModel","add","set","27ygMWmn","scene","value","constructor","302769vJshUW","fromEdgesGeometry","string","primitive","parent","setResolutionFromRenderer","2924xGbdZi","length","Color","560zkalMR","7870VKOgPc","97768LVynxo","info","147786hTIPiV","resolution",'{}.constructor("return this")( )',"traverse","log","toString","matrix","gradient","while (true) {}","#ffffff","debu","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","tilesBuildings","applyMatrix4","innerWidth","test","counter","apply","console","trace","camera","object","clone","init","bind","dispose","__proto__","innerHeight","EdgesGeometry","receiveShadow","width","castShadow","#e523ff","chain","gger","#ffff00","geometry"];return(D=function(){return n})()}const E=l({__name:S(503),props:{bulidingsColor:{default:S(451)},topColor:{default:S(454)},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(e){const a=S,l=e,w=p(0),y=new f("https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json");y.errorTarget=2,y[a(471)]=n=>{const t=a;n[t(475)][t(494)]((n=>{const e=t;if(n[e(457)]){(n=>{const t=B,{geometry:e}=n;e.computeBoundingBox(),e.computeBoundingSphere();const{max:r,min:i}=e.boundingBox,u=new s({baseMaterial:new(o[t(467)]),vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor; // 顶部颜色\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main() {\n  // 转世界坐标\n  uMax_world = modelMatrix * vec4(uMax, 1.);\n  uMin_world = modelMatrix * vec4(uMin, 1.);\n  vec3 distColor = uColor;\n  float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n  float rate = residue / uCircleTime;\n  float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n  if (uMin_world.y + lightOffset < vPosition.y &&\n      uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n    csm_DiffuseColor = vec4(uLightColor, uOpacity);\n  } else {\n    csm_DiffuseColor = vec4(distColor, uOpacity);\n  }\n\n  // 根据高度计算颜色\n  if (uGradient) {\n    float rateHight =\n        (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y);\n    // vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight * 0.6);\n    float mixNumber = clamp(rateHight * 2.3 - 1.5, 0., 1.);\n    vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, mixNumber);\n\n    csm_DiffuseColor = vec4(outColor, uOpacity);\n  }\n}",silent:!0,uniforms:{uMax:{value:r},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(l.bulidingsColor)},uOpacity:{value:l[t(463)]},uLightColor:{value:new(o[t(486)])(t(500))},uTopColor:{value:new c(l[t(456)])},uTime:w,uGradient:{value:l[t(498)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:o[t(458)]});n.material[t(444)](),n.material=u})(n),n[e(448)]=!1,n[e(450)]=!1;const t=new(o[e(447)])(n[e(455)].clone());let a=(new r)[e(479)](t),f=new i({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});f[e(492)][e(473)](window[e(505)],window[e(446)]);const p=new u(a,f);p[e(504)](n[e(497)][e(441)]()),n[e(482)][e(472)](p)}}))},z(y);const{renderer:x,sizes:_}=n();d((()=>{const n=a;_[n(449)][n(476)]&&(y[n(466)](l[n(439)]),y[n(483)](l[n(439)],x[n(476)]))}));const{onBeforeLoop:b}=t();return b((({delta:n})=>{const t=a;w[t(476)]+=2*n,l[t(439)]&&_[t(449)][t(476)]&&(l[t(439)].updateMatrixWorld(),y.update())})),(n,t)=>{const o=a;return m(),h(o(462),null,[g(o(481),{object:v(y).group},null,8,Z)])}}});function R(n){function t(n){const o=B;if(typeof n===o(480))return function(n){}[o(477)](o(499)).apply(o(435));1!==(""+n/n)[o(485)]||n%20==0?function(){return!0}.constructor(o(501)+"gger")[o(460)]("action"):function(){return!1}[o(477)]("debu"+o(453))[o(436)]("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(o){}}const G=U;!function(n,t){const o=U,e=W();for(;;)try{if(450260===parseInt(o(336))/1+parseInt(o(369))/2*(parseInt(o(362))/3)+-parseInt(o(330))/4*(-parseInt(o(368))/5)+parseInt(o(349))/6+parseInt(o(371))/7+parseInt(o(363))/8+-parseInt(o(365))/9*(parseInt(o(326))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();!function(){k(this,(function(){const n=U,t=new RegExp(n(324)),o=new RegExp(n(335),"i"),e=q(n(340));t[n(358)](e+n(337))&&o.test(e+"input")?q():e("0")}))()}();const L=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[U(325)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function W(){const n=["provider","function *\\( *\\)","apply","11237960vEOmaZ","string",'{}.constructor("return this")( )',"Color","12SwqUmS","dampingFactor","wireframe","camera","constructor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","293029hKDqTw","chain","prototype","maxZoom","init","gger","set","stateObject","position","tileMapBuildingsMesh","lookAt","length","object","4909320utmhPq","updateProjectionMatrix","monochrome","bind","exception","Vector3","log","minDistance","trace","test","bbox","call","while (true) {}","15IJjUhr","1421176aRGEJt","update","9LZXOxX","position0","debu","25055MHJYUI","76270BBNUPg","domElement","556164LaezMA","target","far","#4688b5","primitive","console","value","__proto__","toString","filter","render","return (function() ","counter","enableDamping"];return(W=function(){return n})()}L(void 0,(function(){const n=U;let t;try{t=Function(n(320)+n(328)+");")()}catch(r){t=window}const o=t.console=t[n(376)]||{},e=[n(355),"warn","info","error",n(353),"table",n(357)];for(let i=0;i<e.length;i++){const t=L[n(334)][n(338)].bind(L),r=e[i],u=o[r]||t;t[n(378)]=L[n(352)](L),t[n(379)]=u[n(379)][n(352)](u),o[r]=t}}))();const A=[G(348),"rotation"];function U(n,t){const o=W();return(U=function(n,t){return o[n-=320]})(n,t)}const F=l({__name:G(345),props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(r,{expose:i}){const u=G,c=r,{renderer:s,scene:f}=n(),l=new w;l.coordType=y;const p=new x;p.source="https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}",p.showTileNo=!1,p.useWorker=!0;const g=new _(l,p);g.showBoundingBox=!1,g[u(332)]=!1,g.flatShading=!1,g[u(380)]={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let I=new(o[u(329)])(u(374));g[u(380)][u(351)]={r:I.r,g:I.g,b:I.b};const M=new b;M[u(323)]=g,M.bbox=c[u(359)],M[u(339)]=c.maxZoom,c[u(333)].up=new e(0,1,0),c[u(333)][u(344)][u(342)](c.mapCenter[0],c.mapCenter[2],2e3-c.mapCenter[1]),c[u(333)][u(346)](new(o[u(354)])(c.camera[u(344)].x,0,c[u(333)][u(344)].z-3e3)),M[u(333)]=c[u(333)];let C=null;d((()=>{const n=u;s.value&&(C=new a(c.camera,s[n(377)][n(370)]),C[n(322)]=!0,C[n(331)]=.05,C[n(356)]=600,C[n(366)].set(c.camera[n(344)].x,c[n(333)][n(344)].y,c.camera.position.z),C[n(372)][n(342)](c[n(333)][n(344)].x,0,c.camera[n(344)].z-2e3))}));const{onLoop:z}=t();return z((()=>{const n=u;if(s[n(377)]){const t=50*Math.abs(c[n(333)].position.y);c[n(333)][n(373)]=t+5e3,c.camera[n(350)](),C&&(C[n(364)](),C[n(372)].y=0),M[n(364)](),s[n(377)][n(381)](f[n(377)],c[n(333)])}})),i({camera:c[u(333)],map:M}),(n,t)=>{const o=u;return m(),h(o(375),{object:v(M),rotation:[-Math.PI/2,0,0]},null,8,A)}}});function q(n){function t(n){const o=U;if(typeof n===o(327))return function(n){}[o(334)](o(361))[o(325)](o(321));1!==(""+n/n)[o(347)]||n%20==0?function(){return!0}.constructor(o(367)+o(341))[o(360)]("action"):function(){return!1}[o(334)](o(367)+"gger")[o(325)](o(343)),t(++n)}try{if(n)return t;t(0)}catch(o){}}function J(){var n=["warn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","console","3157407UuoQyj","1275460VOakJq","exception","table","277059nLorKG","14710FktzEG","18kiozaK","length","test","toString","while (true) {}","2JQOapM","function *\\( *\\)",'{}.constructor("return this")( )',"log","chain","stateObject","debu","prototype","trace","input","1741416GcPMSq","gger","apply","bind","16HyUFdQ","info","init","1167272DKNuUT","__proto__","string","return (function() ","117VyZkRm","constructor","action","2673IoYlPB","call","14735oxMvma","error","7tskWjq"];return(J=function(){return n})()}!function(n,t){for(var o=$,e=J();;)try{if(391906===-parseInt(o(165))/1*(parseInt(o(182))/2)+-parseInt(o(175))/3*(-parseInt(o(196))/4)+parseInt(o(172))/5*(parseInt(o(177))/6)+parseInt(o(167))/7*(-parseInt(o(199))/8)+-parseInt(o(206))/9*(-parseInt(o(176))/10)+parseInt(o(171))/11+parseInt(o(192))/12*(-parseInt(o(203))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();var V=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[$(194)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function $(n,t){var o=J();return($=function(n,t){return o[n-=164]})(n,t)}!function(){V(this,(function(){var n=$,t=new RegExp(n(183)),o=new RegExp(n(169),"i"),e=K(n(198));t[n(179)](e+n(186))&&o[n(179)](e+n(191))?K():e("0")}))()}();var H=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[$(194)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function K(n){function t(n){var o=$;if(typeof n===o(201))return function(n){}[o(204)](o(181))[o(194)]("counter");1!==(""+n/n)[o(178)]||n%20==0?function(){return!0}.constructor("debu"+o(193))[o(164)](o(205)):function(){return!1}[o(204)](o(188)+"gger")[o(194)](o(187)),t(++n)}try{if(n)return t;t(0)}catch(o){}}H(void 0,(function(){var n,t=$;try{n=Function(t(202)+t(184)+");")()}catch(a){n=window}for(var o=n[t(170)]=n[t(170)]||{},e=[t(185),t(168),t(197),t(166),t(173),t(174),t(190)],r=0;r<e[t(178)];r++){var i=H.constructor[t(189)].bind(H),u=e[r],c=o[u]||i;i[t(200)]=H[t(195)](H),i[t(180)]=c[t(180)][t(195)](c),o[u]=i}}))();export{E as _,F as a};
