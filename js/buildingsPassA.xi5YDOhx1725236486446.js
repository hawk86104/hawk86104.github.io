import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.Sy4YoNOZ1725236486446.js";import{bX as n,a6 as e,bV as o,c5 as r,cf as i}from"./three.0IuNGJsA1725236486446.js";import{p as s,$ as u}from"./@tresjs.DDzpLB7Q1725236486446.js";import{d as c,a1 as a,r as l,o as p,f,g as d,j as v,aj as m,ak as h}from"./@vue.9bHx4gg21725236486446.js";import{P as w}from"./tweakpane.yHWGBmom1725236486446.js";import"./three-custom-shader-material.52Yxne6X1725236486446.js";import"./object-hash.p3nCq7ez1725236486446.js";import"./@amap.YiJorLHg1725236486446.js";import"./jszip.F8iULAGn1725236486446.js";import"./glsl-tokenizer.5A8V64LF1725236486446.js";import"./glsl-token-string.UAuwSUH71725236486446.js";import"./glsl-token-functions.GpZWHJDq1725236486446.js";import"./@vueuse.XXpXaOwX1725236486446.js";const x=P;function P(t,n){const e=S();return(P=function(t,n){return e[t-=192]})(t,n)}!function(t,n){const e=P,o=S();for(;;)try{if(989831===-parseInt(e(224))/1*(-parseInt(e(201))/2)+-parseInt(e(222))/3*(parseInt(e(231))/4)+-parseInt(e(236))/5*(-parseInt(e(240))/6)+-parseInt(e(225))/7+parseInt(e(192))/8+-parseInt(e(214))/9+parseInt(e(229))/10)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const g=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[P(221)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function S(){const t=["matrixWorld","apply","346473rFCIxS","time","1pFgJfT","9746086ecELPN","chain","bind","return (function() ","5731080EHQxay","console","48JeeMQG","call","DepthTexture","value","ShaderMaterial","340420HdeguV","color","length","function *\\( *\\)","174OaFnnh","uPosition","constructor","uniforms","trace","height","input","uScaleone","6923248BLkUAc","__proto__","debu","counter","Vector2","while (true) {}","addPass","width","render","3836718wBqwwg","material","set","buildingsPassA","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uWidth","action","Color","readBuffer","uScalenum","warn","init","error","14069592bghNQR","uColor","gger","table","test","speed"];return(S=function(){return t})()}!function(){g(this,(function(){const t=P,n=new RegExp(t(239)),e=new RegExp(t(205),"i"),o=I(t(212));n[t(218)](o+t(226))&&e[t(218)](o+t(246))?I():o("0")}))()}();const b=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[P(221)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();b(void 0,(function(){const t=P,n=function(){const t=P;let n;try{n=Function(t(228)+'{}.constructor("return this")( ));')()}catch(e){n=window}return n}(),e=n[t(230)]=n[t(230)]||{},o=["log",t(211),"info",t(213),"exception",t(217),t(244)];for(let r=0;r<o[t(238)];r++){const n=b.constructor.prototype[t(227)](b),i=o[r],s=e[i]||n;n[t(193)]=b[t(227)](b),n.toString=s.toString[t(227)](s),e[i]=n}}))();const y=c({__name:x(204),props:{color:{default:"#FFF"},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const c=t,{renderer:l,scene:p,camera:f,sizes:d}=s();let v,m=0,h=null,w=null;a((()=>{const t=P;d[t(199)][t(234)]&&(v=d[t(199)][t(234)],m=d[t(245)][t(234)],(()=>{const t=P;h=new n(l[t(234)]);const s=new(e[t(233)])(v,m);h[t(209)].depthBuffer=!0,h.readBuffer.depthTexture=s;const u=new o(p.value,f[t(234)]);h[t(198)](u),w=new r(new(e[t(235)])({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:s},uProjectionInverse:{value:f.value.projectionMatrixInverse},uMatrixWorld:{value:f.value[t(220)]},uColor:{value:new(e[t(208)])(c[t(237)])},uScalenum:{value:c[t(210)]},uScaleone:{value:c[t(247)]},uWidth:{value:c[t(206)]},uPosition:{value:new(e[t(196)])(c.uPosition.x,c.uPosition.y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),h[t(198)](w);const a=new r(i);h[t(198)](a)})())}));const{onLoop:x}=u();return x((({elapsed:t})=>{const n=P;h&&(h[n(200)](),w.uniforms[n(223)][n(234)]+=c[n(219)]/60)})),a((()=>{const t=P;w&&(c[t(237)]&&(w[t(202)].uniforms[t(215)][t(234)]=new(e[t(208)])(c[t(237)])),c[t(210)]&&(w.material[t(243)][t(210)][t(234)]=c[t(210)]),c.uScaleone&&(w[t(202)][t(243)][t(247)][t(234)]=c[t(247)]),c[t(206)]&&(w[t(202)].uniforms[t(206)][t(234)]=c.uWidth),c[t(241)]&&w[t(202)].uniforms[t(241)][t(234)][t(203)](c[t(241)].x,c[t(241)].y))})),(t,n)=>null}});function I(t){function n(t){const e=P;if("string"==typeof t)return function(t){}[e(242)](e(197))[e(221)](e(195));1!==(""+t/t)[e(238)]||t%20==0?function(){return!0}[e(242)](e(194)+e(216))[e(232)](e(207)):function(){return!1}.constructor("debu"+e(216))[e(221)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}const j=z;!function(t,n){const e=z,o=D();for(;;)try{if(202655===-parseInt(e(508))/1+parseInt(e(516))/2*(parseInt(e(492))/3)+-parseInt(e(494))/4+-parseInt(e(522))/5*(-parseInt(e(485))/6)+-parseInt(e(510))/7+-parseInt(e(493))/8+parseInt(e(483))/9*(parseInt(e(511))/10))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const _=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[z(488)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){_(this,(function(){const t=z,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(491),"i"),o=M(t(518));n[t(513)](o+"chain")&&e[t(513)](o+t(501))?M():o("0")}))()}();const W=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[z(488)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function z(t,n){const e=D();return(z=function(t,n){return e[t-=479]})(t,n)}function D(){const t=["length","error","input","uPosition","info","uScalenum","单条圈间距","bind","action","199852zYdopK","#00b4fb","2589139CrnIeB","30rDEkvE","debu","test","string","uWidth","72774DdpyHn","addBinding","init","call","trace","prototype","2570HMgstf","toString","console","return (function() ",'{}.constructor("return this")( )',"speed","1207593hdtcXT","单条圈宽度","4308FDNwMI","圈颜色","constructor","apply","__proto__","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","18OXJWhK","1213840rVrHfr","263164pGZSFS","后期效果","gger","buildingsPassA","while (true) {}"];return(D=function(){return t})()}W(void 0,(function(){const t=z;let n;try{n=Function(t(480)+t(481)+");")()}catch(r){n=window}const e=n[t(479)]=n[t(479)]||{},o=["log","warn",t(503),t(500),"exception","table",t(520)];for(let i=0;i<o[t(499)];i++){const n=W.constructor[t(521)].bind(W),r=o[i],s=e[r]||n;n[t(489)]=W[t(506)](W),n.toString=s[t(523)][t(506)](s),e[r]=n}}))();const F=c({__name:j(497),setup(n){const e=j,o=l({color:e(509),uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new w({title:e(495),expanded:!0});return r[e(517)](o,"color",{label:e(486)}),r[e(517)](o,e(504),{label:"最大范围",min:1,max:500,step:10}),r[e(517)](o,"uScaleone",{label:e(505),min:1,max:100,step:1}),r[e(517)](o,e(515),{label:e(484),min:0,max:1,step:.01}),r[e(517)](o,e(482),{label:"速度",min:1,max:20,step:1}),r[e(517)](o,e(502),{picker:"inline",label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(p(),f(t,{disableRender:!0,showAxesHelper:!1},{ability:d((()=>[v(y,m(h(o)),null,16)])),_:1}))}});function M(t){function n(t){const e=z;if(typeof t===e(514))return function(t){}.constructor(e(498))[e(488)](e(490));1!==(""+t/t)[e(499)]||t%20==0?function(){return!0}[e(487)](e(512)+"gger")[e(519)](e(507)):function(){return!1}[e(487)](e(512)+e(496))[e(488)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{F as default};
