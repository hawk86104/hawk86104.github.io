import{V as t,_ as n,h as e}from"./three.GKtOCofD1728446741233.js";import{p as o}from"./@tresjs.2zzrlbpQ1728446741233.js";import{d as a,P as r}from"./@pmndrs.kg3qtW3-1728446741233.js";import{d as s,b as i,w as c,a3 as u,o as l,E as p,L as f,aj as d,ak as h}from"./@vue.JNsx1iN61728446741233.js";const m=x;!function(t,n){const e=x,o=b();for(;;)try{if(860509===-parseInt(e(280))/1+parseInt(e(319))/2+parseInt(e(276))/3+parseInt(e(277))/4+parseInt(e(294))/5+parseInt(e(283))/6+-parseInt(e(327))/7)break;o.push(o.shift())}catch(a){o.push(o.shift())}}();const w=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[x(256)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){w(this,(function(){const t=x,n=new RegExp(t(270)),e=new RegExp(t(281),"i"),o=S(t(322));n[t(257)](o+t(291))&&e[t(257)](o+"input")?S():o("0")}))()}();const g=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e.apply(n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function b(){const t=["5275776EOtrHI","rotate-x","frames","1433914UvRoOs","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","top","9898686viFOlW","blend","finish","radius","Group","add","progressiveLightMap2","random","chain","error","cos","7846335osWyQd","toString","acos","action","warn","info","log","trace","opacity","far","clear","while (true) {}","update","lightPosition","randFloatSpread","shadows render start","DirectionalLight","camera","MathUtils","mapSize","material","texture","call","gPlane","width","293984oWieBw","position","TresSoftShadowMaterial","init","remove","value","children","return (function() ","21848883ARXBWx","length","TresMesh","amount","table","color","console","castShadow","apply","test","__proto__","bottom","blendWindow","debu","shadow","size","right","#000000","near","bind","sin","constructor","function *\\( *\\)","intensity","alphaTest","prototype","set","ambient","2192124HxjeEC"];return(b=function(){return t})()}g(void 0,(function(){const t=x;let n;try{n=Function(t(326)+'{}.constructor("return this")( ));')()}catch(a){n=window}const e=n[t(333)]=n[t(333)]||{},o=[t(300),t(298),t(299),t(292),"exception",t(331),t(301)];for(let r=0;r<o[t(328)];r++){const n=g[t(269)][t(273)][t(267)](g),a=o[r],s=e[a]||n;n[t(258)]=g.bind(g),n[t(295)]=s.toString[t(267)](s),e[a]=n}}))();const y=[m(278)],M=f("TresPlaneGeometry",{args:[1,1]},null,-1);function x(t,n){const e=b();return(x=function(t,n){return e[t-=255]})(t,n)}const z=s({__name:"accumulativeShadowsCom",props:{opacity:{default:.8},alphaTest:{default:.9},color:{default:m(265)},blend:{default:2},lightPosition:{default:{x:3,y:5,z:3}},frames:{default:60},blendWindow:{default:100},ambient:{default:.5}},setup(s){const w=m,g=s;let b=i();const{extend:x,scene:z,renderer:S,camera:v}=o();x({SoftShadowMaterial:a});const I={position:(new t)[w(274)](g[w(307)].x,g.lightPosition.y,g[w(307)].z),radius:1,amount:8,intensity:Math.PI,bias:.001,mapSize:1024,size:8,near:.5,far:200},_=new r(S.value,z.value,I[w(313)]),P={map:_[w(289)][w(315)],transparent:!0,depthWrite:!1,toneMapped:!0,blend:g[w(284)],alphaTest:g[w(272)],opacity:g.opacity,color:g[w(332)]},j=new(n[w(287)]);for(let t=0;t<I.amount;t++){const t=new(n[w(310)])(16777215,I[w(271)]/I[w(330)]);t[w(255)]=!0,t[w(262)].bias=I.bias,t[w(262)].camera[w(266)]=I.near,t[w(262)][w(311)][w(303)]=I.far,t[w(262)].camera[w(264)]=I.size/2,t[w(262)][w(311)].left=-I[w(263)]/2,t.shadow[w(311)][w(282)]=I.size/2,t[w(262)][w(311)][w(259)]=-I[w(263)]/2,t.shadow.mapSize[w(318)]=I[w(313)],t[w(262)][w(313)].height=I[w(313)],j[w(288)](t)}const T=()=>{const t=w,o=I[t(320)][t(328)]();for(let a=0;a<j.children[t(328)];a++){const r=j[t(325)][a];if(Math.random()>g.ambient)r[t(320)][t(274)](I[t(320)].x+n[t(312)].randFloatSpread(I[t(286)]),I[t(320)].y+n[t(312)][t(308)](I[t(286)]),I[t(320)].z+e[t(308)](I.radius));else{let n=Math[t(296)](2*Math[t(290)]()-1)-Math.PI/2,e=2*Math.PI*Math[t(290)]();r[t(320)][t(274)](Math[t(293)](n)*Math[t(293)](e)*o,Math.abs(Math.cos(n)*Math[t(268)](e)*o),Math[t(268)](n)*o)}}},W=(t=1)=>{const n=w;z[n(324)][n(288)](j),_.prepare();for(let e=0;e<t;e++)T(),_[n(306)](v[n(324)],g[n(260)]),console.log("shadows plm update",e);z[n(324)][n(323)](j),_[n(285)]()};c((()=>b.value),(t=>{const n=w;t&&(_.configure(t),_[n(304)](),console.log(n(309)),W(g[n(279)]),console.log("shadows render end"))}));const E=()=>{const t=w;_[t(304)](),W(g[t(279)])};return u((()=>{const t=w;b[t(324)]&&(g[t(302)]&&(b[t(324)][t(314)][t(302)]=g[t(302)]),g.alphaTest&&(b[t(324)][t(314)].alphaTest=g.alphaTest),g[t(332)]&&b[t(324)][t(314)].color[t(274)](g[t(332)]),g[t(284)]&&(b[t(324)][t(314)][t(284)]=g.blend))})),c((()=>g[w(307)]),(t=>{const n=w;t&&(console[n(300)](g[n(307)]),I.position.set(t.x,t.y,t.z),E())}),{deep:!0}),c((()=>[g[w(279)],g[w(260)],g[w(275)]]),(()=>{E()})),(t,n)=>{const e=w;return l(),p(e(329),{"receive-shadow":"",ref_key:e(317),ref:b,scale:10,"rotate-x":-Math.PI/2},[M,f(e(321),d(h(P)),null,16)],8,y)}}});function S(t){function n(t){const e=x;if("string"==typeof t)return function(t){}.constructor(e(305))[e(256)]("counter");1!==(""+t/t)[e(328)]||t%20==0?function(){return!0}[e(269)](e(261)+"gger")[e(316)](e(297)):function(){return!1}.constructor(e(261)+"gger")[e(256)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{z as _};
