{"version":3,"file":"cesiumIon.CKVldnAp1767105581793.js","sources":["../../src/plugins/simpleGIS/components/cesiumIon3DTile.vue","../../src/plugins/simpleGIS/pages/cesiumIon.vue"],"sourcesContent":["<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2025-03-25 08:59:26\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-29 12:36:01\n-->\n<template>\n    <TresGroup>\n        <primitive :object=\"tiles.group\" />\n    </TresGroup>\n</template>\n\n<script lang=\"ts\" setup>\nimport { watchEffect } from 'vue'\nimport { useTres, useLoop } from '@tresjs/core'\nimport { TilesRenderer } from '3d-tiles-renderer'\nimport { CesiumIonAuthPlugin, GLTFExtensionsPlugin } from '3d-tiles-renderer/plugins'\nimport * as THREE from 'three'\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js'\n\nconst { camera, renderer, sizes } = useTres()\n\nconst assetId = '354759'\nconst accessToken =\n    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJhM2RlZDE0YS03NWNlLTQ2ZmItODFmZi0zMDQyZGMxZjdjNzQiLCJpZCI6NDYzMzQsImlhdCI6MTYxNjA1MjY2Nn0.3BRsxy7UmJgW0LemXo6cMsD7xwe7YvUDITeQ3RLxOHI'\n\nfunction rotationBetweenDirections(dir1, dir2) {\n    const rotation = new THREE.Quaternion()\n    const a = new THREE.Vector3().crossVectors(dir1, dir2)\n    rotation.x = a.x\n    rotation.y = a.y\n    rotation.z = a.z\n    rotation.w = 1 + dir1.clone().dot(dir2)\n    rotation.normalize()\n    return rotation\n}\nconst tiles = new TilesRenderer()\nfunction setupTiles() {\n    tiles.fetchOptions.mode = 'cors'\n    tiles.registerPlugin(\n        new GLTFExtensionsPlugin({\n            dracoLoader: new DRACOLoader().setDecoderPath('./draco/'),\n        }),\n    )\n}\ntiles.registerPlugin(new CesiumIonAuthPlugin({ apiToken: accessToken, assetId }))\ntiles.addEventListener('load-tile-set', () => {\n    const sphere = new THREE.Sphere()\n    tiles.getBoundingSphere(sphere)\n\n    const position = sphere.center.clone()\n    const distanceToEllipsoidCenter = position.length()\n\n    const surfaceDirection = position.normalize()\n    const up = new THREE.Vector3(0, 1, 0)\n    const rotationToNorthPole = rotationBetweenDirections(surfaceDirection, up)\n\n    tiles.group.quaternion.x = rotationToNorthPole.x\n    tiles.group.quaternion.y = rotationToNorthPole.y\n    tiles.group.quaternion.z = rotationToNorthPole.z\n    tiles.group.quaternion.w = rotationToNorthPole.w\n\n    tiles.group.position.y = -distanceToEllipsoidCenter\n})\nsetupTiles()\n\nwatchEffect(() => {\n    if (sizes.width.value) {\n        tiles.setCamera(camera.value)\n        tiles.setResolutionFromRenderer(camera.value, renderer)\n    }\n})\n\nconst { onBeforeRender } = useLoop()\nonBeforeRender(() => {\n    if (camera.value && sizes.width.value && tiles) {\n        camera.value.updateMatrixWorld()\n        tiles.update()\n    }\n})\n</script>\n","<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-27 11:36:30\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-29 12:35:47\n-->\n\n<template>\n    <TresCanvas clearColor=\"#201919\" window-size antialias>\n        <TresPerspectiveCamera :position=\"[1000, 1000, -100]\" :fov=\"60\" :near=\"1\" :far=\"10000\" />\n        <OrbitControls enableDamping />\n\n        <cesiumIon3DTile />\n        <TresAxesHelper :args=\"[100]\" />\n    </TresCanvas>\n    <h1 class=\"text-center text-white w-full absolute\">若没加载成功，请更换自己的Cesium-Key</h1>\n</template>\n\n<script setup lang=\"ts\">\nimport { OrbitControls } from '@tresjs/cientos'\nimport cesiumIon3DTile from '../components/cesiumIon3DTile.vue'\n</script>\n"],"names":["useTres","TilesRenderer","GLTFExtensionsPlugin","CesiumIonAuthPlugin","useLoop","_createElementBlock","_createElementVNode","_unref","OrbitControls","cesiumIon3DTile"],"mappings":"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"}