import{importShared as e}from"./3d-tiles-renderer.CvhCoabY1768360010900.js";import{useTres as t,OrbitControls_default as a}from"./index.CsTVQ09Z1768360010900.js";import{scaleImg as r,$s as n,pt as o,en as i,controlsEvents as l,showLocation as p,informationDiv as s}from"./informationDiv.BkdfuqW_1768360010900.js";import{useTexture$1 as c}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.DRa1gKCP1768360010900.js";import"./index.vue_vue_type_script_setup_true_lang.Bmv2kfnV1768360010900.js";import{Pane as m}from"./tweakpane.BbuIEN141768360010900.js";const{withAsyncContext:u,defineComponent:d}=await e("vue"),{unref:h,createElementVNode:g,openBlock:v,createElementBlock:w}=await e("vue"),f=["position"],y=["scale","material","rotateX","position-y"],x=await e("three"),{watch:_}=await e("vue"),S=d({__name:"radraImgShow",props:{map:{},height:{default:100},opacity:{default:.6}},async setup(e){let t,a;const n=e,o=new x.MeshPhongMaterial({displacementMap:new x.Texture,transparent:!0,side:x.DoubleSide,opacity:n.opacity,displacementScale:.5,displacementBias:0});o.onBeforeCompile=e=>{e.vertexShader="uniform sampler2D map;\n\t"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","transformed += normalize( objectNormal ) * ( texture2D(map, vMapUv ).a * displacementScale + displacementBias );")};const i=n.map.geo2pos(new x.Vector3(105,34,0));i.applyMatrix4(n.map.matrix);const l=r(n.map,{x:67,y:11},{x:140,y:57},1e3*n.height),p=[];for(let r=0;r<9;r++)p.push(`https://opensource.cdn.icegl.cn/images/simpleGIS/QPFRef_202405311${r}40.png`);let s=0;const m=([t,a]=u(()=>c(p)),t=await t,a(),t);o.map=m[s],_(()=>[n.color,n.opacity],([e,t])=>{o.opacity=t});let d=null,S=!1;return S?(clearInterval(d),d=null,S=!1):(d=setInterval(()=>{s=s<p.length-1?s+1:0,o.map=m[s],o.needsUpdate=!0,console.log(s)},1e3),S=!0),(e,t)=>(v(),w("TresGroup",{position:[...h(i)]},[g("TresMesh",{scale:[h(l).x,h(l).y,1e3*e.height],material:h(o),rotateX:-Math.PI/2,renderOrder:9999,"position-y":1e3*e.height/5},[...t[0]||(t[0]=[g("TresPlaneGeometry",{args:[1,1,529,420]},null,-1)])],8,y)],8,f))}}),{defineComponent:b}=await e("vue"),{createElementVNode:T,unref:B,mergeProps:k,createVNode:j,Suspense:I,withCtx:P,openBlock:C,createBlock:M,Fragment:D,createElementBlock:E}=await e("vue"),N=["object"],{watch:V,ref:z,reactive:L}=await e("vue"),F=await e("three"),W="pk.eyJ1IjoiaGF3azg2MTA0IiwiYSI6ImNrbTQ3cWtyeTAxejEzMHBtcW42bmc0N28ifQ.bvS9U_yWdHDh41jzaDS1dw",A=b({__name:"mapBoxShow3",setup(e){const a=L({height:200,opacity:1}),r=new m({title:"参数"});r.addBinding(a,"height",{label:"高度",min:10,max:300,step:1}),r.addBinding(a,"opacity",{label:"透明度",min:0,max:1,step:.1}),new n({token:W,dataType:"image",style:"mapbox.satellite"}),new n({token:W,dataType:"terrain-rgb",style:"mapbox.terrain-rgb",maxLevel:15});const s=new o({imgSource:[new i({style:"6"}),new i({style:"8"})],lon0:90,minLevel:2,maxLevel:20});s.rotateX(-Math.PI/2);const c=new F.Vector3(105,34,0),u=new F.Vector3(110,0,1e7),d=s.localToWorld(s.geo2map(c)),h=s.localToWorld(s.geo2map(u)),g=z(),{camera:v,controls:w,scene:f,renderer:y}=t();return v.value&&v.value.position.copy(h),V(()=>w.value,e=>{e&&(e.target.copy(d),l(e,v.value,f.value))}),V(()=>g.value,e=>{e&&e.target.position.copy(d)}),p(v.value,y.domElement,s),(e,t)=>(C(),E(D,null,[T("TresDirectionalLight",{ref_key:"tdLight",ref:g,position:[0,2e3,1e3],intensity:1},null,512),T("primitive",{object:B(s)},null,8,N),(C(),M(I,null,{default:P(()=>[j(S,k({map:B(s)},a),null,16,["map"])]),_:1}))],64))}}),{defineComponent:G}=await e("vue"),{createElementVNode:Q,unref:U,normalizeProps:X,guardReactiveProps:H,createVNode:R,resolveComponent:$,mergeProps:J,withCtx:O,Fragment:Y,openBlock:q,createElementBlock:K}=await e("vue"),{reactive:Z}=await e("vue"),ee=G({__name:"radraImg",setup(e){const t=Z({clearColor:"#dbf0ff",alpha:!0,antialias:!1,logarithmicDepthBuffer:!0,precision:"highp"}),r=Z({enableDamping:!0,makeDefault:!0,screenSpacePanning:!1,dampingFactor:.035,keyPanSpeed:5});return(e,n)=>{const o=$("TresCanvas");return q(),K(Y,null,[R(o,J(t,{"window-size":""}),{default:O(()=>[n[0]||(n[0]=Q("TresPerspectiveCamera",{position:[0,12,0],fov:70,near:.1,far:4e10},null,-1)),R(U(a),X(H(r)),null,16),n[1]||(n[1]=Q("TresAmbientLight",{intensity:1},null,-1)),R(A)]),_:1},16),R(s)],64)}}});export{ee as default};
