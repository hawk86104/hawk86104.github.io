import{importShared as i}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{Fs as z,Kk as D}from"./index.DTe2qqjO1767148983502.js";import{Pane as I}from"./tweakpane.BQRZXf8M1767148983502.js";const{defineComponent:N}=await i("vue"),{onMounted:F,watchEffect:H,ref:y}=await i("vue"),e=await i("three"),$=N({__name:"drawArrows",setup(R){const{camera:m,scene:s}=z(),w=y(new e.Raycaster),r=new e.Vector2,a=[];y(null);const B=new e.PlaneGeometry(200,200),G=new e.MeshBasicMaterial({color:65280,side:e.DoubleSide}),d=new e.Mesh(B,G);d.rotation.set(0,0,Math.PI/2),s.value.add(d);let _="";const L=function(){window.addEventListener("click",f,!1)};let b=function(n){n.preventDefault(),window.removeEventListener("click",f,!1),window.removeEventListener("contextmenu",b,!1)},f=function(n){r.x=n.clientX/window.innerWidth*2-1,r.y=-(n.clientY/window.innerHeight)*2+1,w.value.setFromCamera(r,m.value);const t=w.value.intersectObject(d);if(t.length>0){const o=t[0].point;switch(a.push(new e.Vector3(o.x,o.y,0)),_){case"line":S(t[0].normal);break}}},S=function(n){if(a.length==2){const t=new e.CatmullRomCurve3(a),o=new e.TubeGeometry(t,20,2,8,!1),c=new e.MeshBasicMaterial({color:16711680}),h=new e.Mesh(o,c);s.value.add(h);const l=n,v=M(t,l,Math.PI/5);s.value.add(v);const C=M(t,l,-Math.PI/5);s.value.add(C);const u=V(a[1]);s.value.add(u),a.length=0}},V=function(n){const t=new e.SphereGeometry(1.8,32,32),o=new e.MeshBasicMaterial({color:16711680}),c=new e.Mesh(t,o);return c.position.copy(n),c},M=function(n,t,o){const h=new e.CatmullRomCurve3([n.getPointAt(.8),n.getPointAt(1)]),l=new e.TubeGeometry(h,30,2,8,!1),v=new e.MeshBasicMaterial({color:16711680}),u=new e.Mesh(l,v).clone(),p=new e.Group;return p.add(u),p.position.copy(a[1]),u.position.sub(a[1]),p.rotation.set(Math.abs(t.x)*o,Math.abs(t.y)*o,Math.abs(t.z)*o),p};const A=function(){new I({title:"箭头",expanded:!0}).addFolder({title:"参数(鼠标间断点两个点，分别作为箭头的起点)，点击鼠标右键移除绘制"}).addButton({title:"绘制箭头",label:"激活"}).on("click",()=>{window.removeEventListener("click",f,!1),window.addEventListener("contextmenu",b,!1),_="line",L()})};return F(()=>{A()}),H(()=>{}),(n,t)=>null}}),{defineComponent:j}=await i("vue"),{createElementVNode:P,unref:K,normalizeProps:O,guardReactiveProps:U,createVNode:g,Suspense:W,withCtx:k,openBlock:x,createBlock:T,resolveComponent:X,mergeProps:Y}=await i("vue"),{reactive:E}=await i("vue"),Q=j({__name:"drawArrows",setup(R){const m=E({windowSize:!0,alpha:!0,antialias:!0}),s=E({enableDamping:!0,enableZoom:!0,enablePan:!0,enableRotate:!0,makeDefault:!0});return(w,r)=>{const a=X("TresCanvas");return x(),T(a,Y({clearColor:"#201919"},m),{default:k(()=>[r[0]||(r[0]=P("TresPerspectiveCamera",{fov:60,near:.1,far:2e3,position:[0,0,200],"look-at":[0,0,0]},null,-1)),r[1]||(r[1]=P("TresAmbientLight",{intensity:2},null,-1)),g(K(D),O(U(s)),null,16),(x(),T(W,null,{default:k(()=>[g($)]),_:1}))]),_:1},16)}}});export{Q as default};
