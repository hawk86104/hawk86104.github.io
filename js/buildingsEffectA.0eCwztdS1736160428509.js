import{P as t}from"./tweakpane.yHWGBmom1736160428509.js";import{_ as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.zh3Kqdjn1736160428509.js";import{e}from"./@tresjs.8MtVPQyb1736160428509.js";import{z as r}from"./three-custom-shader-material._2dHD2wr1736160428509.js";import{_ as i,C as u,cm as c,m as a,a$ as s}from"./three.rmsIv-u_1736160428509.js";import{d as l,a1 as f,w as p,o as d,D as m,u as g,a6 as v,r as h,f as y,g as w,j as C,m as _}from"./@vue.4u_eOGex1736160428509.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1736160428509.js";import"./@vueuse.GObPVvIB1736160428509.js";function b(){const t=["boundingBox","init","landColor","info","opacity","city","Color","land","uniforms","dispose","15NyOFgY","setStyle","length","11DxRqUb","toString","prototype","color","while (true) {}","computeBoundingBox","#ffffff","1544qwssHe","602329JpFbEe","DoubleSide","MeshBasicMaterial","exception","return (function() ","warn","computeBoundingSphere","action","value","call","isArray","console","object","964086kpwIGQ","gradient","bulidingsColor","10akRIYB","primitive","56qWResg","uTime","593957umSfuz","uColor","uOpacity","model","error","1205739wAlqfM","renderOrder","14764djtMHJ","children","trace","apply","material","forEach","gger","126pHWwAO","#ffff00","constructor","#e523ff","counter","input","table","uGradient","stateObject","319TaVqEd","#112233","topColor","debu","453YxOiGJ","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","function *\\( *\\)","side","6475092lcDWZm","bind","test"];return(b=function(){return t})()}const I=S;!function(t,n){const o=S,e=b();for(;;)try{if(325632===-parseInt(o(388))/1*(parseInt(o(344))/2)+-parseInt(o(392))/3*(-parseInt(o(372))/4)+parseInt(o(334))/5*(-parseInt(o(358))/6)+-parseInt(o(365))/7*(parseInt(o(363))/8)+parseInt(o(370))/9*(parseInt(o(361))/10)+parseInt(o(337))/11*(parseInt(o(396))/12)+-parseInt(o(345))/13*(-parseInt(o(379))/14))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(375)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=S,n=new RegExp(t(394)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=F(t(400));n[t(398)](e+"chain")&&o[t(398)](e+t(384))?F():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(375)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function S(t,n){const o=b();return(S=function(t,n){return o[t-=328]})(t,n)}M(void 0,(function(){const t=S,n=function(){const t=S;let n;try{n=Function(t(349)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(356)]=n.console||{},e=["log",t(350),t(402),t(369),t(348),t(385),t(374)];for(let r=0;r<e[t(336)];r++){const n=M[t(381)][t(339)][t(397)](M),i=e[r],u=o[i]||n;n.__proto__=M[t(397)](M),n[t(338)]=u[t(338)][t(397)](u),o[i]=n}}))();const j=[I(357)],T=l({__name:"bModel",props:{model:{},bulidingsColor:{default:I(382)},landColor:{default:I(389)},topColor:{default:I(380)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=I,o=t,c=o.model[n(329)];o.model.model[n(373)][0].material=new(i[n(347)])({color:"#ffff00"}),c[n(371)]=1001;const a=o[n(368)].land;(()=>{const t=n,{geometry:e}=c;e[t(342)](),e[t(351)]();const{max:a,min:s}=e[t(399)];if(c[t(376)].__csm)return;const l=new r({baseMaterial:c[t(376)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:t(393),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(330)])(o[t(360)])},uOpacity:{value:o[t(328)]},uLightColor:{value:new u(t(343))},uTopColor:{value:new(i[t(330)])(o[t(390)])},uTime:{value:0},uGradient:{value:o[t(359)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(346)]});c[t(376)][t(333)](),c.material=l})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(376)][o(332)][o(364)][o(353)]+=t})),f((()=>{const t=n;o[t(360)]&&c.material.uniforms[t(366)][t(353)][t(335)](o[t(360)]),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(331)&&(u=Array[r(355)](a[r(376)])?a[r(376)]:[a[r(376)]],u[r(377)]((t=>{const n=r;t[e].setStyle(o[n(401)]),t[n(395)]=i[n(346)]})))})("land",t(340)),o[t(328)]&&(c.material[t(332)][t(367)][t(353)]=o[t(328)])})),p(o,((t,o)=>{const e=n;c[e(376)][e(332)][e(386)][e(353)]=t[e(359)]}));const l=o.model.model.clone();return(t,o)=>{const e=n;return d(),m(e(362),{object:g(l)},null,8,j)}}});function F(t){function n(t){const o=S;if("string"==typeof t)return function(t){}[o(381)](o(341)).apply(o(383));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor("debu"+o(378))[o(354)](o(352)):function(){return!1}[o(381)](o(391)+o(378)).apply(o(387)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=P;function P(t,n){const o=B();return(P=function(t,n){return o[t-=334]})(t,n)}function B(){const t=["speed","uniforms","bLine","error","1290340FmdwwM","28skxJUp","console","constructor","value","geometry","9014445wHqsSJ","scale","width","uSrcColor","string","renderOrder","#000","input","function *\\( *\\)","info","gger","length","toString","uScale","matrix","warn","linewidth","prototype","2317qMhINC","object","color","11010TqzFEf","primitive","debu","stateObject","table","165202wdQRMS","640726lqYlZd","uTime","22599yMcVFV","10WnZQZP","trace","exception","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","test","builds","gradual","apply","1752yJXxZz","uColor","#FFF","clone","bind","applyMatrix4","chain","2493arBzVj","srcColor","uGradual"];return(B=function(){return t})()}!function(t,n){const o=P,e=B();for(;;)try{if(322949===parseInt(o(354))/1+-parseInt(o(355))/2+-parseInt(o(357))/3*(parseInt(o(381))/4)+parseInt(o(380))/5+parseInt(o(349))/6*(-parseInt(o(346))/7)+-parseInt(o(366))/8*(-parseInt(o(373))/9)+-parseInt(o(358))/10*(-parseInt(o(386))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[P(365)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){q(this,(function(){const t=P,n=new RegExp(t(336)),o=new RegExp(t(361),"i"),e=E("init");n[t(362)](e+t(372))&&o[t(362)](e+t(335))?E():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[P(365)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=P,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n.console=n[t(382)]||{},e=["log",t(343),t(337),t(379),t(360),t(353),t(359)];for(let r=0;r<e[t(339)];r++){const n=z.constructor[t(345)][t(370)](z),i=e[r],u=o[i]||n;n.__proto__=z[t(370)](z),n[t(340)]=u.toString[t(370)](u),o[i]=n}}))();const A=[O(347)],W=l({__name:O(378),props:{builds:{},color:{default:O(368)},srcColor:{default:O(334)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(348)])},uSrcColor:{value:new u(o[n(374)])},uScale:{value:o[n(387)]},uTime:{value:0},uGradual:{value:o[n(364)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(363)][n(385)])[n(369)]();l=l[n(371)](o[n(363)][n(342)]);const p=new a(i);r=new s(l,p),r.material[n(344)]=o[n(388)],r[n(391)]=1e3,f((()=>{const t=n;o[t(348)]&&(i[t(377)][t(367)][t(384)]=new u(o.color)),o[t(374)]&&(i.uniforms[t(389)].value=new u(o[t(374)])),o[t(387)]&&(i[t(377)][t(341)][t(384)]=o[t(387)]),o[t(364)]&&(i[t(377)][t(375)][t(384)]=o[t(364)])}));const{onLoop:v}=e();return v((({delta:t})=>{const e=n;i.uniforms[e(356)][e(384)]+=t*o[e(376)],i.uniforms.uTime.value%=1})),(t,o)=>{const e=n;return d(),m(e(350),{object:g(r)},null,8,A)}}});function E(t){function n(t){const o=P;if(typeof t===o(390))return function(t){}.constructor("while (true) {}")[o(365)]("counter");1!==(""+t/t)[o(339)]||t%20==0?function(){return!0}[o(383)](o(351)+o(338)).call("action"):function(){return!1}[o(383)](o(351)+o(338))[o(365)](o(352)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=k;!function(t,n){const o=k,e=G();for(;;)try{if(958814===parseInt(o(231))/1*(-parseInt(o(235))/2)+parseInt(o(214))/3*(parseInt(o(206))/4)+-parseInt(o(241))/5+parseInt(o(224))/6*(parseInt(o(227))/7)+-parseInt(o(248))/8+parseInt(o(215))/9*(parseInt(o(252))/10)+-parseInt(o(219))/11*(-parseInt(o(236))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(242)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){R(this,(function(){const t=k,n=new RegExp(t(246)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=J(t(220));n[t(211)](e+t(240))&&o[t(211)](e+t(255))?J():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(242)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(){const t=["线扫颜色","5775560hKFIFj","counter","bind","input","color","return (function() ","__proto__","4rKaUnT","#999","srcColor","model","constructor","test","exception","table","422139ltwPEu","9aXnWuN","buildingsEffectA","最大扩散","call","1199ByPdzO","init","action","addBinding","debu","6UKNeCD","效果参数","gger","5821487DWsMOW","stateObject","线原颜色","builds","626003YApCDi","console","toString","error","4Lgqtql","139632JIcclq","#000","#FFF","trace","chain","1224515wegIjU","apply","length","warn","#112233","function *\\( *\\)","while (true) {}","2900088qjvWVW","city","string"];return(G=function(){return t})()}function k(t,n){const o=G();return(k=function(t,n){return o[t-=203]})(t,n)}Z(void 0,(function(){const t=k;let n;try{n=Function(t(204)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(232)]=n[t(232)]||{},e=["log",t(244),"info",t(234),t(212),t(213),t(239)];for(let i=0;i<e[t(243)];i++){const n=Z[t(210)].prototype.bind(Z),r=e[i],u=o[r]||n;n[t(205)]=Z[t(254)](Z),n.toString=u[t(233)][t(254)](u),o[r]=n}}))();const H=l({__name:D(216),async setup(e){const r=D;let i,u;const c=([i,u]=v((()=>o())),i=await i,u(),i),a=h({color:r(238),srcColor:r(237),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(225),expanded:!0});return s.addBinding(a,r(208),{label:r(229)}),s[r(222)](a,r(203),{label:r(251)}),s.addBinding(a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(222)](a,"scale",{label:r(217),min:10,max:2e3,step:10}),s.addBinding(a,"gradual",{label:"扩散系数",min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(T,{model:g(c),bulidingsColor:"#000000",landColor:e(245),topColor:e(207)},null,8,[e(209)]),C(W,_({builds:g(c)[e(249)]},a),null,16,[e(230)])])),_:1})}}});function J(t){function n(t){const o=k;if(typeof t===o(250))return function(t){}[o(210)](o(247)).apply(o(253));1!==(""+t/t)[o(243)]||t%20==0?function(){return!0}.constructor(o(223)+o(226))[o(218)](o(221)):function(){return!1}[o(210)](o(223)+"gger")[o(242)](o(228)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{H as default};
