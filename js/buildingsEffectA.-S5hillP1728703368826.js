import{P as t}from"./tweakpane.yHWGBmom1728703368826.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.1S7QjIhd1728703368826.js";import{U as e}from"./@tresjs.JhHPALEY1728703368826.js";import{C as r}from"./three-custom-shader-material.3rBk2L9x1728703368826.js";import"./object-hash.gPx1SZYa1728703368826.js";import{_ as i,C as u,cc as c,m as a,a$ as s}from"./three.VoknrmS61728703368826.js";import"./@amap.LlG4vVLC1728703368826.js";import"./glsl-tokenizer.N1Ao8h3g1728703368826.js";import{d as l,a3 as f,w as p,o as d,E as m,u as v,a4 as g,r as h,f as y,g as w,j as C,m as _}from"./@vue.JNsx1iN61728703368826.js";import"./@vueuse.yeA714RM1728703368826.js";import"./glsl-token-string.bxQbWgRM1728703368826.js";import"./glsl-token-functions.5GJf-mGG1728703368826.js";import"./jszip.VrfDZcNx1728703368826.js";const b=I;!function(t,n){const o=I,e=j();for(;;)try{if(418282===parseInt(o(401))/1+parseInt(o(440))/2*(parseInt(o(446))/3)+parseInt(o(421))/4+-parseInt(o(447))/5+parseInt(o(409))/6*(parseInt(o(418))/7)+parseInt(o(455))/8+-parseInt(o(438))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(444)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function I(t,n){const o=j();return(I=function(t,n){return o[t-=397]})(t,n)}function j(){const t=["model","uniforms","737156UPMySG",'{}.constructor("return this")( )',"debu","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","chain","toString","console","496878wGijru","object","side","function *\\( *\\)","DoubleSide","topColor","MeshBasicMaterial","setStyle","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","21FQrFsV","string","call","1383868SlaDhJ","value","test","uTime","forEach","input","color","opacity","clone","#ffff00","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","gradient","material","uGradient","trace","computeBoundingBox","Color","11298510qyDcpe","land","22xIujDc","boundingBox","constructor","bModel","apply","info","111156FheQjl","370850ywpaUc","landColor","prototype","#e523ff","warn","length","stateObject","gger","69664RSqnae","bind","init","uOpacity","uColor","action","children","dispose","table","primitive","bulidingsColor","counter","#ffffff","__proto__"];return(j=function(){return t})()}!function(){x(this,(function(){const t=I,n=new RegExp(t(412)),o=new RegExp(t(404),"i"),e=P(t(457));n[t(423)](e+t(406))&&o.test(e+t(426))?P():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[I(444)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=I;let n;try{n=Function("return (function() "+t(402)+");")()}catch(r){n=window}const o=n[t(408)]=n.console||{},e=["log",t(451),t(445),"error","exception",t(463),t(435)];for(let i=0;i<e[t(452)];i++){const n=M[t(442)][t(449)][t(456)](M),r=e[i],u=o[r]||n;n[t(398)]=M.bind(M),n[t(407)]=u[t(407)][t(456)](u),o[r]=n}}))();const S=[b(410)],T=l({__name:b(443),props:{model:{},bulidingsColor:{default:b(450)},landColor:{default:"#112233"},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,u=o.model.city;o[n(399)][n(399)][n(461)][0][n(433)]=new(i[n(415)])({color:n(430)}),u.renderOrder=1001;const c=o[n(399)].land;(()=>{const t=n,{geometry:e}=u;e[t(436)](),e.computeBoundingSphere();const{max:c,min:a}=e[t(441)];if(u[t(433)].__csm)return;const s=new r({baseMaterial:u[t(433)],vertexShader:t(417),fragmentShader:t(431),silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(437)])(o[t(465)])},uOpacity:{value:o.opacity},uLightColor:{value:new(i[t(437)])(t(397))},uTopColor:{value:new(i[t(437)])(o[t(414)])},uTime:{value:0},uGradient:{value:o[t(432)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(413)]});u.material[t(462)](),u[t(433)]=s})();const{onLoop:a}=e();a((({delta:t})=>{const o=n;u[o(433)][o(400)][o(424)][o(422)]+=t})),f((()=>{const t=n;o[t(465)]&&u[t(433)][t(400)][t(459)].value[t(416)](o.bulidingsColor),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(439)&&(u=Array.isArray(c[r(433)])?c.material:[c[r(433)]],u[r(425)]((t=>{const n=r;t[e][n(416)](o[n(448)]),t[n(411)]=i[n(413)]})))})("land",t(427)),o[t(428)]&&(u[t(433)][t(400)][t(458)][t(422)]=o[t(428)])})),p(o,((t,o)=>{const e=n;u[e(433)].uniforms[e(434)].value=t[e(432)]}));const s=o[n(399)].model[n(429)]();return(t,o)=>{const e=n;return d(),m(e(464),{object:v(s)},null,8,S)}}});function P(t){function n(t){const o=I;if(typeof t===o(419))return function(t){}[o(442)](o(405)).apply(o(466));1!==(""+t/t)[o(452)]||t%20==0?function(){return!0}[o(442)](o(403)+"gger")[o(420)](o(460)):function(){return!1}.constructor("debu"+o(454))[o(444)](o(453)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const B=z;!function(t,n){const o=z,e=F();for(;;)try{if(118368===parseInt(o(296))/1+-parseInt(o(312))/2+parseInt(o(255))/3+-parseInt(o(263))/4*(-parseInt(o(300))/5)+parseInt(o(288))/6*(-parseInt(o(279))/7)+parseInt(o(270))/8+parseInt(o(309))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const O=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function F(){const t=["string","constructor","#FFF","error","gradual","renderOrder","init","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","287550wroBzy","console","warn","337562JabYNb","color","matrix","325983iRwVzy","width","log","value","__proto__","uScale","function *\\( *\\)","chain","1588asCtNs","while (true) {}","length","counter","applyMatrix4","gger","#000","124600fmxGfH","stateObject","speed","bLine","exception","uniforms","debu","return (function() ","apply","49qoWsXx","object",'{}.constructor("return this")( )',"srcColor","test","builds","uSrcColor","toString","uTime","177978WzyBOU","bind","material","action","uColor","clone","linewidth","table","170673eooXyV","call","primitive","scale","2115yaDtus"];return(F=function(){return t})()}function z(t,n){const o=F();return(z=function(t,n){return o[t-=255]})(t,n)}!function(){O(this,(function(){const t=z,n=new RegExp(t(261)),o=new RegExp(t(308),"i"),e=G(t(307));n.test(e+t(262))&&o[t(283)](e+"input")?G():e("0")}))()}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(278)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=z,n=function(){const t=z;let n;try{n=Function(t(277)+t(281)+");")()}catch(o){n=window}return n}(),o=n[t(310)]=n.console||{},e=[t(257),t(311),"info",t(304),t(274),t(295),"trace"];for(let r=0;r<e[t(265)];r++){const n=A[t(302)].prototype.bind(A),i=e[r],u=o[i]||n;n[t(259)]=A[t(289)](A),n[t(286)]=u[t(286)][t(289)](u),o[i]=n}}))();const R=[B(280)],D=l({__name:B(273),props:{builds:{},color:{default:B(303)},srcColor:{default:B(269)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o.color)},uSrcColor:{value:new u(o[n(282)])},uScale:{value:o[n(299)]},uTime:{value:0},uGradual:{value:o[n(305)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(284)].geometry)[n(293)]();l=l[n(267)](o.builds[n(314)]);const p=new a(i);r=new s(l,p),r[n(290)][n(294)]=o[n(256)],r[n(306)]=1e3,f((()=>{const t=n;o.color&&(i[t(275)][t(292)][t(258)]=new u(o[t(313)])),o[t(282)]&&(i.uniforms[t(285)][t(258)]=new u(o.srcColor)),o[t(299)]&&(i[t(275)][t(260)].value=o.scale),o[t(305)]&&(i.uniforms.uGradual[t(258)]=o.gradual)}));const{onLoop:g}=e();return g((({delta:t})=>{const e=n;i[e(275)][e(287)].value+=t*o[e(272)],i[e(275)][e(287)][e(258)]%=1})),(t,o)=>{const e=n;return d(),m(e(298),{object:v(r)},null,8,R)}}});function G(t){function n(t){const o=z;if(typeof t===o(301))return function(t){}[o(302)](o(264))[o(278)](o(266));1!==(""+t/t)[o(265)]||t%20==0?function(){return!0}[o(302)](o(276)+o(268))[o(297)](o(291)):function(){return!1}[o(302)](o(276)+"gger")[o(278)](o(271)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const E=Z;!function(t,n){const o=Z,e=L();for(;;)try{if(107620===parseInt(o(459))/1+parseInt(o(449))/2*(parseInt(o(452))/3)+-parseInt(o(478))/4*(parseInt(o(483))/5)+parseInt(o(450))/6*(-parseInt(o(451))/7)+-parseInt(o(468))/8+parseInt(o(476))/9*(-parseInt(o(481))/10)+parseInt(o(463))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(448)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){k(this,(function(){const t=Z,n=new RegExp(t(446)),o=new RegExp(t(473),"i"),e=V("init");n.test(e+t(490))&&o[t(464)](e+t(454))?V():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(448)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function L(){const t=["while (true) {}","color","效果参数","2707804jDkAKy","test","debu","trace","console","107704QJTNWk","speed",'{}.constructor("return this")( )',"stateObject","length","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","prototype","63hwwbua","city","44mzrIac","#FFF","counter","159450UvLvrq","return (function() ","43255EPMrRR","最大扩散","model","__proto__","table","addBinding","gradual","chain","log","buildingsEffectA","线扫颜色","function *\\( *\\)","bind","apply","80642KyvbWI","450vwwLfV","18949WCVtlh","6wTnAjD","gger","input","toString","action","error","#999","204078jnvcyO"];return(L=function(){return t})()}W(void 0,(function(){const t=Z;let n;try{n=Function(t(482)+t(470)+");")()}catch(r){n=window}const o=n[t(467)]=n[t(467)]||{},e=[t(491),"warn","info",t(457),"exception",t(487),t(466)];for(let i=0;i<e[t(472)];i++){const n=W[t(474)][t(475)][t(447)](W),r=e[i],u=o[r]||n;n[t(486)]=W[t(447)](W),n[t(455)]=u[t(455)][t(447)](u),o[r]=n}}))();const $=l({__name:E(444),async setup(e){const r=E;let i,u;const c=([i,u]=g((()=>o())),i=await i,u(),i),a=h({color:r(479),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(462),expanded:!0});return s[r(488)](a,"srcColor",{label:"线原颜色"}),s.addBinding(a,r(461),{label:r(445)}),s.addBinding(a,r(469),{label:"速度",min:.1,max:1,step:.1}),s.addBinding(a,"scale",{label:r(484),min:10,max:2e3,step:10}),s[r(488)](a,r(489),{label:"扩散系数",min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(T,{model:v(c),bulidingsColor:"#000000",landColor:"#112233",topColor:e(458)},null,8,[e(485)]),C(D,_({builds:v(c)[e(477)]},a),null,16,["builds"])])),_:1})}}});function Z(t,n){const o=L();return(Z=function(t,n){return o[t-=444]})(t,n)}function V(t){function n(t){const o=Z;if("string"==typeof t)return function(t){}[o(474)](o(460))[o(448)](o(480));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(465)+o(453)).call(o(456)):function(){return!1}.constructor("debu"+o(453))[o(448)](o(471)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
