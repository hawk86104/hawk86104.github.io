import{_ as t,cd as n,ce as o,cf as e,cg as r,C as i,m as u,bU as c,ak as s,am as a}from"./three.HQIWXjA-1732680436779.js";import{d as l,e as f,U as p}from"./@tresjs.ozxSQdlw1732680436779.js";import{z as d}from"./three-custom-shader-material.9-Fy8s-01732680436779.js";import{d as h,b as m,a3 as y,w as g,o as w,D as v,u as b,r as _,a6 as I,e as C,f as x,g as M,J as S,j,aj as O,ak as T,F as R,I as A,G as B,m as H}from"./@vue.u2cBPEWn1732680436779.js";function P(t,n){const o=k();return(P=function(t,n){return o[t-=454]})(t,n)}function k(){const t=["info","traverse","toString","test","15ZYSYoE","call","log","13006jFhiBx","console","table","warn","constructor","__proto__","323260VQXtkc","return (function() ","while (true) {}","173694ePVxOp","name","input","2248iCGPrp","1307238NtsnOk","LANDMASS","gger","39639ucVqQj","18926510PlWJpH","208Hoyjtz","apply","stateObject","action","prototype","CITY_UNTRIANGULATED","error","debu","chain","init","bind","9614043wxTKgd"];return(k=function(){return t})()}!function(t,n){const o=P,e=k();for(;;)try{if(572196===parseInt(o(477))/1+-parseInt(o(484))/2+-parseInt(o(487))/3*(-parseInt(o(489))/4)+parseInt(o(468))/5*(-parseInt(o(480))/6)+parseInt(o(471))/7*(-parseInt(o(483))/8)+-parseInt(o(463))/9+parseInt(o(488))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[P(490)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=P,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=L(t(461));n[t(467)](e+t(460))&&o.test(e+t(482))?L():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();D(void 0,(function(){const t=P,n=function(){const t=P;let n;try{n=Function(t(478)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(472)]||{},e=[t(470),t(474),t(464),t(458),"exception",t(473),"trace"];for(let r=0;r<e.length;r++){const n=D[t(475)][t(456)][t(462)](D),i=e[r],u=o[i]||n;n[t(476)]=D[t(462)](D),n.toString=u[t(466)][t(462)](u),o[i]=n}}))();const E=async()=>{const t=P,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(465)]((n=>{const i=t;n[i(481)]===i(457)&&(o=n),n.name===i(485)&&(e=n),"ROADS"===n[i(481)]&&(r=n)})),{model:n,city:o,land:e,roads:r}};function L(t){function n(t){const o=P;if("string"==typeof t)return function(t){}[o(475)](o(479))[o(490)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(475)](o(459)+o(486))[o(469)](o(455)):function(){return!1}.constructor("debu"+o(486))[o(490)](o(454)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=Z;function F(){const t=['{}.constructor("return this")( )',"table","error","420GERIma","side","function *\\( *\\)","__csm","103380oWwPyb","771177hjDEIu","landColor","162rZgGpq","uniforms","value","warn","gradient","520280zhqWrH","material","toString","counter","init","prototype","#ffff00","topColor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","boundingBox","isArray","object","#112233","setStyle","city","uGradient","console","length","exception","182721XPSfPi","chain","5LhcLVy","renderOrder","__proto__","trace","model","bind","apply","6423431jaoYiP","646248DOcegF","return (function() ","primitive","uOpacity","Color","action","opacity","constructor","693400YrcBJz","2030HWDdEj","DoubleSide","while (true) {}","debu","gger","test","computeBoundingBox","bulidingsColor","computeBoundingSphere","color"];return(F=function(){return t})()}!function(t,n){const o=Z,e=F();for(;;)try{if(847909===-parseInt(o(245))/1*(parseInt(o(287))/2)+-parseInt(o(280))/3+-parseInt(o(253))/4+-parseInt(o(279))/5*(parseInt(o(275))/6)+-parseInt(o(252))/7+-parseInt(o(261))/8*(-parseInt(o(282))/9)+parseInt(o(262))/10*(parseInt(o(243))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(t,n){const o=F();return(Z=function(t,n){return o[t-=231]})(t,n)}!function(){W(this,(function(){const t=Z,n=new RegExp(t(277)),o=new RegExp(t(232),"i"),e=q(t(291));n[t(267)](e+t(244))&&o[t(267)](e+"input")?q():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();$(void 0,(function(){const t=Z,n=function(){const t=Z;let n;try{n=Function(t(254)+t(272)+");")()}catch(o){n=window}return n}(),o=n[t(240)]=n.console||{},e=["log",t(285),"info",t(274),t(242),t(273),t(248)];for(let r=0;r<e[t(241)];r++){const n=$[t(260)][t(292)][t(250)]($),i=e[r],u=o[i]||n;n[t(247)]=$[t(250)]($),n[t(289)]=u[t(289)].bind(u),o[i]=n}}))();const N=[G(235)],U=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:G(236)},topColor:{default:G(293)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=G,e=n,r=m(0),i=e[o(249)][o(238)];i[o(246)]=1001;const u=e[o(249)].land;(()=>{const n=o,{geometry:u}=i;u[n(268)](),u[n(270)]();const{max:c,min:s}=u[n(233)];if(i[n(288)][n(278)])return;const a=new d({baseMaterial:i[n(288)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(257)])(e[n(269)])},uOpacity:{value:e.opacity},uLightColor:{value:new(t[n(257)])("#ffffff")},uTopColor:{value:new(t[n(257)])(e[n(231)])},uTime:r,uGradient:{value:e[n(286)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(263)]});i[n(288)].dispose(),i[n(288)]=a})();const{onLoop:c}=f();c((({delta:t})=>{r[o(284)]+=t})),y((()=>{const n=o;e[n(269)]&&i.material[n(283)].uColor.value.setStyle(e[n(269)]),e.landColor&&((n,r)=>{const i=o;let c;"cu"===n||"land"===n&&(c=Array[i(234)](u[i(288)])?u[i(288)]:[u[i(288)]],c.forEach((n=>{const o=i;n[r][o(237)](e[o(281)]),n[o(276)]=t[o(263)]})))})("land",n(271)),e[n(259)]&&(i[n(288)][n(283)][n(256)][n(284)]=e[n(259)])})),g(e,((t,n)=>{const e=o;i[e(288)][e(283)][e(239)][e(284)]=t.gradient}));const s=e.model[o(249)].clone();return(t,n)=>{const e=o;return w(),v(e(255),{object:b(s)},null,8,N)}}});function q(t){function n(t){const o=Z;if("string"==typeof t)return function(t){}[o(260)](o(264))[o(251)](o(290));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(265)+o(266)).call(o(258)):function(){return!1}.constructor(o(265)+o(266)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const V=X;!function(t,n){const o=X,e=K();for(;;)try{if(473164===parseInt(o(412))/1*(parseInt(o(414))/2)+-parseInt(o(381))/3+-parseInt(o(398))/4+parseInt(o(404))/5+parseInt(o(409))/6*(parseInt(o(386))/7)+-parseInt(o(413))/8+-parseInt(o(364))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(417)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=X,n=new RegExp(t(385)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=nt(t(370));n[t(405)](e+"chain")&&o[t(405)](e+"input")?nt():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(417)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function K(){const t=["width","counter","5804118oSJoUz","table","innerHeight","resolution","warn","value","init","Wireframe","toString","color","info","clone","constructor","opacity","console","buildingsLines","__proto__","1343595MgCHjv",'{}.constructor("return this")( )',"geometry","fromEdgesGeometry","function *\\( *\\)","3600723iaJDfw","primitive","#FFF","stateObject","innerWidth","bind","call","matrix","applyMatrix4","uColor","Shader","linewidth","45856fiPiwd","uOpacity","renderOrder","log","builds","debu","4396460KQdQit","test","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","gger","uniforms","6HaqqHR","length","style","866DeWNRy","3372960reiiwG","1398wNLFIa","set"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","apply","while (true) {}","material","return (function() "];return(K=function(){return t})()}Y(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function(t(420)+t(382)+");")()}catch(o){n=window}return n}(),o=n[t(378)]=n[t(378)]||{},e=[t(401),t(368),t(374),"error","exception",t(365),"trace"];for(let r=0;r<e[t(410)];r++){const n=Y[t(376)].prototype.bind(Y),i=e[r],u=o[i]||n;n[t(380)]=Y.bind(Y),n[t(372)]=u.toString[t(391)](u),o[i]=n}}))();const Q=["object"];function X(t,n){const o=K();return(X=function(t,n){return o[t-=364]})(t,n)}const tt=h({__name:V(379),props:{builds:{},width:{default:1},color:{default:V(388)},opacity:{default:1},style:{default:V(371)}},setup(t){const c=V,s=t;let a=null,l=null;if(s[c(411)]===c(371)){const t=new n(s.builds[c(383)]);let i=(new o)[c(384)](t),u=new e({color:s[c(373)],linewidth:s[c(421)],opacity:s[c(377)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(367)][c(415)](window[c(390)],window[c(366)]),a=new r(i,u),a.applyMatrix4(s.builds.matrix[c(375)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(s[c(373)])},uOpacity:{value:s[c(377)]}},vertexShader:c(406),fragmentShader:c(416)};const t=new n(s.builds[c(383)]),o=new u(l);a=new LineSegments(t,o),a[c(394)](s[c(402)][c(393)].clone()),a[c(419)][c(397)]=s[c(421)],a[c(400)]=1e3}return y((()=>{const t=c;s.style===t(396)&&(s[t(373)]&&(l[t(408)][t(395)][t(369)]=new i(s[t(373)])),s[t(377)]&&(l.uniforms[t(399)][t(369)]=s[t(377)])),s[t(411)]===t(371)&&(s.color&&(a[t(419)][t(373)]=new i(s.color)),s.opacity&&(a[t(419)][t(377)]=s[t(377)])),s[t(421)]&&(a.material[t(397)]=s[t(421)])})),(t,n)=>{const o=c;return w(),v(o(387),{object:b(a)},null,8,Q)}}});function nt(t){function n(t){const o=X;if("string"==typeof t)return function(t){}[o(376)](o(418))[o(417)](o(422));1!==(""+t/t).length||t%20==0?function(){return!0}[o(376)](o(403)+o(407))[o(392)]("action"):function(){return!1}[o(376)](o(403)+o(407)).apply(o(389)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=ct;!function(t,n){const o=ct,e=st();for(;;)try{if(925295===-parseInt(o(218))/1+parseInt(o(217))/2*(-parseInt(o(203))/3)+-parseInt(o(220))/4+parseInt(o(193))/5*(-parseInt(o(211))/6)+parseInt(o(199))/7*(parseInt(o(200))/8)+parseInt(o(187))/9*(parseInt(o(188))/10)+parseInt(o(201))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ct(191)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=ct,n=new RegExp(t(212)),o=new RegExp(t(215),"i"),e=lt("init");n[t(232)](e+t(222))&&o[t(232)](e+t(196))?lt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=ct,n=function(){const t=ct;let n;try{n=Function(t(210)+t(198)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(185)]||{},e=[t(194),"warn","info",t(183),t(225),t(180),t(216)];for(let r=0;r<e[t(181)];r++){const n=rt[t(197)][t(231)][t(195)](rt),i=e[r],u=o[i]||n;n[t(227)]=rt[t(195)](rt),n.toString=u[t(189)][t(195)](u),o[i]=n}}))();const it={key:1,args:[1e3],position:[0,19,0]},ut={key:2,args:[6e3,100],position:[0,19,0]};function ct(t,n){const o=st();return(ct=function(t,n){return o[t-=180]})(t,n)}function st(){const t=["return (function() ","3606iOazYA","function *\\( *\\)","TresDirectionalLight","showGridHelper","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","trace","88872wvZnlU","222288mRKkBs","action","3919632iasMoq","city","chain","$slots","showAxesHelper","exception","TresAxesHelper","__proto__","stateObject","TresPerspectiveCamera","tcRef","prototype","test","gger","table","length","#ffffff","error","ability","console","while (true) {}","2151243xKkkXj","10dSjOMl","toString","counter","apply","#000","13795JqVUZL","log","bind","input","constructor",'{}.constructor("return this")( )',"7zWeHRn","7282552VpaUtZ","30954528bbmpQI","pagesShow","12NEsXKN","perspectiveCameraRef","model","disableRender","debu","showBuildings","#000000"];return(st=function(){return t})()}const at=h({__name:ot(202),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(209),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(206)]}),u=_({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r[n(208)]&&([o,e]=I((()=>E())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,H({ref_key:e(230),ref:d},i,{"window-size":""}),{default:M((()=>[S(e(229),{ref_key:e(204),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),O(T(u)),null,16),o[0]||(o[0]=S("TresAmbientLight",{color:e(182)},null,-1)),o[1]||(o[1]=S(e(213),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1)),r[e(208)]&&b(l)?(w(),v(R,{key:0},[j(U,{model:b(l)},null,8,[e(205)]),j(tt,{builds:b(l)[e(221)],color:e(192)},null,8,["builds"])],64)):A("",!0),B(t[e(223)],e(184)),r[e(224)]?(w(),v(e(226),it)):A("",!0),r[e(214)]?(w(),v("TresGridHelper",ut)):A("",!0)])),_:3},16)}}});function lt(t){function n(t){const o=ct;if("string"==typeof t)return function(t){}[o(197)](o(186))[o(191)](o(190));1!==(""+t/t)[o(181)]||t%20==0?function(){return!0}[o(197)](o(207)+"gger").call(o(219)):function(){return!1}.constructor("debu"+o(233))[o(191)](o(228)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as _,tt as a,at as b,E as l};
