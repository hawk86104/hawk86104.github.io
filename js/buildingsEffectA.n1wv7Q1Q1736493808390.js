import{P as t}from"./tweakpane.yHWGBmom1736493808390.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.HJ8gP1ch1736493808390.js";import{e}from"./@tresjs.g7tJPOCI1736493808390.js";import{z as r}from"./three-custom-shader-material.eKT8KwaV1736493808390.js";import{_ as i,a0 as u,C as c,cj as a,m as s,b3 as l}from"./three.lAfZYOpc1736493808390.js";import{d as f,a1 as p,w as d,o as m,D as g,u as v,a4 as h,r as y,f as w,g as b,j as _,m as C}from"./@vue.-Mz_IXfk1736493808390.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1736493808390.js";import"./@vueuse.kU-N6GoC1736493808390.js";const x=S;!function(t,n){const o=S,e=T();for(;;)try{if(266505===-parseInt(o(290))/1*(-parseInt(o(310))/2)+parseInt(o(289))/3*(-parseInt(o(298))/4)+parseInt(o(301))/5+parseInt(o(300))/6+-parseInt(o(282))/7+-parseInt(o(340))/8*(-parseInt(o(287))/9)+-parseInt(o(303))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(339)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=S,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(276),"i"),e=P("init");n.test(e+t(336))&&o[t(291)](e+t(281))?P():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(339)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function S(t,n){const o=T();return(S=function(t,n){return o[t-=276]})(t,n)}M(void 0,(function(){const t=S,n=function(){const t=S;let n;try{n=Function(t(299)+t(332)+");")()}catch(o){n=window}return n}(),o=n[t(317)]=n[t(317)]||{},e=["log",t(333),t(322),t(297),t(338),t(283),"trace"];for(let r=0;r<e.length;r++){const n=M[t(330)][t(292)][t(304)](M),i=e[r],u=o[i]||n;n[t(285)]=M.bind(M),n[t(327)]=u.toString.bind(u),o[i]=n}}))();const j=[x(342)];function T(){const t=["return (function() ","1861680hXjOhT","2412625RcagNp","model","1194860EyARDZ","bind","opacity","debu","#ffff00","DoubleSide","landColor","2soHnAm","color","call","children","bulidingsColor","stateObject","string","console","material","gger","primitive","uColor","info","#112233","setStyle","isArray","__csm","toString","#e523ff","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","constructor","counter",'{}.constructor("return this")( )',"warn","computeBoundingSphere","gradient","chain","uniforms","exception","apply","79336EqWtqU","side","object","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","MeshBasicMaterial","forEach","dispose","uGradient","input","3555930bAWaWT","table","value","__proto__","land","171uQiTXa","#ffffff","357297HlGwIt","31852TZszjm","test","prototype","while (true) {}","bModel","uTime","Color","error","4UtlhbY"];return(T=function(){return t})()}const B=f({__name:x(294),props:{model:{},bulidingsColor:{default:x(328)},landColor:{default:x(323)},topColor:{default:x(307)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,a=o[n(302)].city;o[n(302)][n(302)][n(313)][0][n(318)]=new(i[n(277)])({color:n(307)}),a.renderOrder=1001;const s=o[n(302)][n(286)];(()=>{const t=n,{geometry:e}=a;e.computeBoundingBox(),e[t(334)]();const{max:u,min:s}=e.boundingBox;if(a[t(318)][t(326)])return;const l=new r({baseMaterial:a[t(318)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:t(329),silent:!0,uniforms:{uMax:{value:u},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new c(o[t(314)])},uOpacity:{value:o[t(305)]},uLightColor:{value:new c(t(288))},uTopColor:{value:new(i[t(296)])(o.topColor)},uTime:{value:0},uGradient:{value:o.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(308)]});a[t(318)][t(279)](),a[t(318)]=l})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a[o(318)].uniforms[o(295)][o(284)]+=t})),p((()=>{const t=n;o.bulidingsColor&&a[t(318)][t(337)][t(321)][t(284)][t(324)](o[t(314)]),o[t(309)]&&((t,e)=>{const r=n;let i;"cu"===t||"land"===t&&(i=Array[r(325)](s[r(318)])?s.material:[s.material],i[r(278)]((t=>{const n=r;t[e].setStyle(o[n(309)]),t[n(341)]=u})))})("land",t(311)),o[t(305)]&&(a[t(318)][t(337)].uOpacity[t(284)]=o.opacity)})),d(o,((t,o)=>{const e=n;a.material[e(337)][e(280)][e(284)]=t[e(335)]}));const f=o.model.model.clone();return(t,o)=>{const e=n;return m(),g(e(320),{object:v(f)},null,8,j)}}});function P(t){function n(t){const o=S;if(typeof t===o(316))return function(t){}.constructor(o(293))[o(339)](o(331));1!==(""+t/t).length||t%20==0?function(){return!0}[o(330)]("debu"+o(319))[o(312)]("action"):function(){return!1}[o(330)](o(306)+o(319))[o(339)](o(315)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const A=F;!function(t,n){const o=F,e=Z();for(;;)try{if(642935===parseInt(o(243))/1*(-parseInt(o(263))/2)+parseInt(o(268))/3+-parseInt(o(272))/4+parseInt(o(258))/5*(parseInt(o(274))/6)+-parseInt(o(271))/7*(parseInt(o(256))/8)+parseInt(o(270))/9*(-parseInt(o(229))/10)+parseInt(o(255))/11*(parseInt(o(236))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const O=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function F(t,n){const o=Z();return(F=function(t,n){return o[t-=222]})(t,n)}!function(){O(this,(function(){const t=F,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(259),"i"),e=z("init");n[t(244)](e+t(226))&&o[t(244)](e+"input")?z():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(261)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["exception","renderOrder","trace","warn","call","314qnZdwZ","test","linewidth","action","srcColor","toString","debu","__proto__","uTime","object","uScale","log","23518TDkQBY","1358120MbwMbA","clone","5BNgEqr","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","constructor","apply","color","6002dxXXGw","stateObject","uSrcColor","builds","applyMatrix4","2732568sXUBfJ","console","1449IHjZZr","7MDNtUg","4807356WgJcnM","speed","5219178GqRtVG","table","value","gger","gradual","return (function() ","bLine","material","scale","chain",'{}.constructor("return this")( )',"length","60540cIuxrm","width","string","geometry","bind","uColor","uGradual","12072rQbmAR","uniforms"];return(Z=function(){return t})()}G(void 0,(function(){const t=F;let n;try{n=Function(t(222)+t(227)+");")()}catch(r){n=window}const o=n.console=n[t(269)]||{},e=[t(254),t(241),"info","error",t(238),t(275),t(240)];for(let i=0;i<e[t(228)];i++){const n=G[t(260)].prototype[t(233)](G),r=e[i],u=o[r]||n;n[t(250)]=G.bind(G),n[t(248)]=u.toString[t(233)](u),o[r]=n}}))();const R=[A(252)],E=f({__name:A(223),props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=A,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o.color)},uSrcColor:{value:new c(o[n(247)])},uScale:{value:o[n(225)]},uTime:{value:0},uGradual:{value:o[n(278)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o[n(266)][n(232)])[n(257)]();u=u[n(267)](o[n(266)].matrix);const f=new s(i);r=new l(u,f),r[n(224)][n(245)]=o[n(230)],r[n(239)]=1e3,p((()=>{const t=n;o.color&&(i.uniforms[t(234)][t(276)]=new c(o[t(262)])),o[t(247)]&&(i[t(237)][t(265)][t(276)]=new c(o.srcColor)),o[t(225)]&&(i.uniforms[t(253)].value=o[t(225)]),o[t(278)]&&(i[t(237)][t(235)][t(276)]=o.gradual)}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i[e(237)].uTime.value+=t*o[e(273)],i.uniforms[e(251)][e(276)]%=1})),(t,n)=>(m(),g("primitive",{object:v(r)},null,8,R))}});function z(t){function n(t){const o=F;if(typeof t===o(231))return function(t){}[o(260)]("while (true) {}")[o(261)]("counter");1!==(""+t/t)[o(228)]||t%20==0?function(){return!0}[o(260)]("debu"+o(277))[o(242)](o(246)):function(){return!1}[o(260)](o(249)+o(277))[o(261)](o(264)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=k;!function(t,n){const o=k,e=L();for(;;)try{if(929188===parseInt(o(512))/1+-parseInt(o(490))/2+parseInt(o(496))/3*(parseInt(o(504))/4)+-parseInt(o(489))/5+-parseInt(o(519))/6+parseInt(o(499))/7+-parseInt(o(495))/8*(-parseInt(o(502))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(500)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){q(this,(function(){const t=k,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=X(t(531));n.test(e+t(520))&&o.test(e+t(516))?X():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function L(){const t=["stateObject","buildingsEffectA","6432930DSavEi","chain","model","#000","addBinding","speed","console","color","constructor","length","city","线扫颜色","init","toString","srcColor","扩散系数",'{}.constructor("return this")( )',"error","6888995UGvSzO","1790362PpoPjr","最大扩散","debu","prototype","__proto__","152xghjXp","3270696FdGKSq","#999","call","3184363cbFAqh","apply","#FFF","862857jiKloR","gradual","4gzLqkh","bind","builds","线原颜色","info","return (function() ","action","counter","907595lQZpRI","exception","scale","gger","input"];return(L=function(){return t})()}function k(t,n){const o=L();return(k=function(t,n){return o[t-=485]})(t,n)}W(void 0,(function(){const t=k,n=function(){const t=k;let n;try{n=Function(t(509)+t(487)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(525)]||{},e=["log","warn",t(508),t(488),t(513),"table","trace"];for(let r=0;r<e.length;r++){const n=W[t(527)][t(493)][t(505)](W),i=e[r],u=o[i]||n;n[t(494)]=W[t(505)](W),n.toString=u[t(532)][t(505)](u),o[i]=n}}))();const H=f({__name:D(518),async setup(e){const r=D;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(501),srcColor:r(522),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:"效果参数",expanded:!0});return s[r(523)](a,r(485),{label:r(507)}),s.addBinding(a,r(526),{label:r(530)}),s[r(523)](a,r(524),{label:"速度",min:.1,max:1,step:.1}),s.addBinding(a,r(514),{label:r(491),min:10,max:2e3,step:10}),s.addBinding(a,r(503),{label:r(486),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:b((()=>[_(B,{model:v(c),bulidingsColor:"#000000",landColor:"#112233",topColor:e(497)},null,8,[e(521)]),_(E,C({builds:v(c)[e(529)]},a),null,16,[e(506)])])),_:1})}}});function X(t){function n(t){const o=k;if("string"==typeof t)return function(t){}[o(527)]("while (true) {}").apply(o(511));1!==(""+t/t)[o(528)]||t%20==0?function(){return!0}[o(527)](o(492)+"gger")[o(498)](o(510)):function(){return!1}[o(527)](o(492)+o(515)).apply(o(517)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{H as default};
