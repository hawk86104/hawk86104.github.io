import{importShared as e}from"./3d-tiles-renderer.DoRCwQO21769048796101.js";import{OrbitControls_default as o,component_default$4 as n}from"./index.DY1Qq3wV1769048796101.js";import{Pane as l}from"./tweakpane.BbuIEN141769048796101.js";const{ShaderMaterial:i,Uniform:a,Color:t,AdditiveBlending:r,FrontSide:s,BackSide:d,DoubleSide:f}=await e("three");class p extends i{constructor(e={}){super(),this.vertexShader="\n      varying vec3 vPosition;\n      varying vec3 vNormal;\n\n      void main() {\n        vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n        gl_Position = projectionMatrix * viewMatrix * modelPosition;\n        vec4 modelNormal = modelMatrix * vec4(normal, 0.0);\n        vPosition = modelPosition.xyz;\n        vNormal = modelNormal.xyz;\n\n      }\n    ",this.fragmentShader="\n      uniform vec3 glowColor;\n      uniform float falloff;\n      uniform float glowSharpness;\n      uniform float glowInternalRadius;\n      uniform float opacity;\n\n      varying vec3 vPosition;\n      varying vec3 vNormal;\n\n      void main()\n      {\n        // Normal\n        vec3 normal = normalize(vNormal);\n        if(!gl_FrontFacing)\n            normal *= - 1.0;\n        vec3 viewDirection = normalize(cameraPosition - vPosition);\n        float fresnel = dot(viewDirection, normal);\n        fresnel = pow(fresnel, glowInternalRadius + 0.1);\n        float falloff = smoothstep(0., falloff, fresnel);\n        float fakeGlow = fresnel;\n        fakeGlow += fresnel * glowSharpness;\n        fakeGlow *= falloff;\n        gl_FragColor = vec4(clamp(glowColor * fresnel, 0., 1.0), clamp(fakeGlow, 0., opacity));\n\n        #include <tonemapping_fragment>\n        #include <colorspace_fragment>\n      } \n      ",this.uniforms={opacity:new a(void 0!==e.opacity?e.opacity:1),glowInternalRadius:new a(void 0!==e.glowInternalRadius?e.glowInternalRadius:6),glowSharpness:new a(void 0!==e.glowSharpness?e.glowSharpness:.5),falloff:new a(void 0!==e.falloff?e.falloff:.1),glowColor:new a(void 0!==e.glowColor?new t(e.glowColor):new t("#00d5ff"))},this.setValues(e),this.depthTest=void 0!==e.depthTest&&e.depthTest,this.blending=void 0!==e.blendMode?e.blendMode:r,this.transparent=!0,this.side=void 0!==e.side?e.side:f}}const{defineComponent:m}=await e("vue"),{createElementVNode:g,unref:c,createVNode:u,Suspense:w,withCtx:v,openBlock:h,createBlock:y,resolveComponent:S}=await e("vue"),x={position:[0,6,0]},C=["object"],{reactive:b,watchEffect:T}=await e("vue"),j=await e("three"),B=m({__name:"fakeGlow",setup(e){const i=new l({title:"辉光参数",expanded:!0}),a=b({glowColor:"#a058c1",falloff:1.4,glowInternalRadius:3.7,glowSharpness:0,opacity:1,side:j.FrontSide,depthTest:!1}),t=new p,r=new j.Mesh(new j.TorusKnotGeometry(4,3.8,128,128),t);return i.addBinding(a,"glowColor",{label:"颜色"}),i.addBinding(a,"falloff",{label:"衰减",min:0,max:10,step:.1}),i.addBinding(a,"glowInternalRadius",{label:"内半径",min:-5,max:5,step:.1}),i.addBinding(a,"glowSharpness",{label:"清晰度",min:0,max:10,step:.1}),i.addBinding(a,"opacity",{label:"透明",min:0,max:1,step:.1}),i.addBinding(a,"side",{label:"材质面",options:{FrontSide:j.FrontSide,BackSide:j.BackSide,DoubleSide:j.DoubleSide}}),T(()=>{t.uniforms.falloff.value=a.falloff,t.uniforms.glowColor.value=new j.Color(a.glowColor),t.uniforms.glowInternalRadius.value=a.glowInternalRadius,t.uniforms.glowSharpness.value=a.glowSharpness,t.uniforms.opacity.value=a.opacity,t.side=a.side}),(e,l)=>{const i=S("TresCanvas");return h(),y(i,{"window-size":"",clearColor:1},{default:v(()=>[l[1]||(l[1]=g("TresPerspectiveCamera",{position:[0,25,25],near:.1,fov:65},null,-1)),l[2]||(l[2]=g("TresAmbientLight",{intensity:1.5},null,-1)),l[3]||(l[3]=g("TresDirectionalLight",{position:[100,100,60],intensity:20},null,-1)),u(c(o),{autoRotate:""}),l[4]||(l[4]=g("TresGridHelper",{args:[20,10]},null,-1)),g("TresGroup",x,[l[0]||(l[0]=g("TresMesh",null,[g("TresTorusKnotGeometry",{args:[4,.5,128,128]}),g("TresMeshPhysicalMaterial",{color:"blue",roughness:.2,clearcoat:1})],-1)),g("primitive",{object:c(r)},null,8,C)]),(h(),y(w,null,{default:v(()=>[u(c(n),{files:["pos-x.jpg","neg-x.jpg","pos-y.jpg","neg-y.jpg","pos-z.jpg","neg-z.jpg"],path:"https://opensource.cdn.icegl.cn/images/skyBox/6jpg/"},null,8,["path"])]),_:1}))]),_:1})}}});export{B as default};
