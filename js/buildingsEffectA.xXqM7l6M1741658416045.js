import{P as t}from"./tweakpane.yDiyAAkA1741658416045.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.6Bo5lrOF1741658416045.js";import{e}from"./@tresjs.W3PFJhMo1741658416045.js";import{z as r}from"./three-custom-shader-material.irEwOpzM1741658416045.js";import{$ as i,a0 as u,_ as c,C as a,cm as s,l,b9 as f}from"./three.FyUEtfsR1741658416045.js";import{d as p,a2 as d,w as m,o as v,H as g,u as y,a3 as h,r as C,f as _,g as w,j as b,m as x}from"./@vue.NRI7TcgI1741658416045.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1741658416045.js";import"./postprocessing.llR5x4wQ1741658416045.js";import"./@vueuse.5uFvLf9q1741658416045.js";const I=M;function M(t,n){const o=F();return(M=function(t,n){return o[t-=191]})(t,n)}!function(t,n){const o=M,e=F();for(;;)try{if(969980===-parseInt(o(242))/1+parseInt(o(244))/2+parseInt(o(251))/3*(parseInt(o(203))/4)+-parseInt(o(252))/5+parseInt(o(222))/6*(-parseInt(o(246))/7)+-parseInt(o(233))/8+parseInt(o(224))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(216)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){S(this,(function(){const t=M,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(199),"i"),e=B(t(259));n.test(e+t(207))&&o.test(e+"input")?B():e("0")}))()}();const j=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();j(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(202)+t(254)+");")()}catch(o){n=window}return n}(),o=n[t(231)]=n[t(231)]||{},e=[t(258),t(221),t(209),t(255),t(217),t(230),t(256)];for(let r=0;r<e[t(236)];r++){const n=j[t(210)].prototype[t(204)](j),i=e[r],u=o[i]||n;n[t(212)]=j[t(204)](j),n[t(201)]=u[t(201)][t(204)](u),o[i]=n}}))();const T=[I(219)];function F(){const t=["while (true) {}","53367RBgBGp","7654980vNzeet","call",'{}.constructor("return this")( )',"error","trace","opacity","log","init","uTime","computeBoundingBox","action","dispose","material","landColor","setStyle","bulidingsColor","uOpacity","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__csm","toString","return (function() ","424NqRimO","bind","color","clone","chain","DoubleSide","info","constructor","#e523ff","__proto__","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","primitive","gradient","apply","exception","value","object","land","warn","6SdYiqD","boundingBox","3623382XAPzLJ","renderOrder","counter","children","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","stateObject","table","console","string","5554776iIjpUY","Color","forEach","length","debu","gger","#ffff00","isArray","uniforms","389177WCjyZV","model","3422218GQisJx","uGradient","2903887YhnPAn","topColor","#112233","bModel"];return(F=function(){return t})()}const P=p({__name:I(249),props:{model:{},bulidingsColor:{default:I(211)},landColor:{default:I(248)},topColor:{default:I(239)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=I,o=t,a=o[n(243)].city;o[n(243)][n(243)][n(227)][0][n(194)]=new i({color:n(239)}),a[n(225)]=1001;const s=o.model[n(220)];(()=>{const t=n,{geometry:e}=a;e[t(191)](),e.computeBoundingSphere();const{max:i,min:u}=e[t(223)];if(a[t(194)][t(200)])return;const s=new r({baseMaterial:a[t(194)],vertexShader:t(228),fragmentShader:t(213),silent:!0,uniforms:{uMax:{value:i},uMin:{value:u},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(c[t(234)])(o[t(197)])},uOpacity:{value:o[t(257)]},uLightColor:{value:new(c[t(234)])("#ffffff")},uTopColor:{value:new(c[t(234)])(o[t(247)])},uTime:{value:0},uGradient:{value:o.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:c[t(208)]});a[t(194)][t(193)](),a.material=s})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a[o(194)][o(241)][o(260)][o(218)]+=t})),d((()=>{const t=n;o[t(197)]&&a[t(194)][t(241)].uColor[t(218)].setStyle(o[t(197)]),o.landColor&&((t,e)=>{const r=n;let i;"cu"===t||"land"===t&&(i=Array[r(240)](s.material)?s.material:[s[r(194)]],i[r(235)]((t=>{const n=r;t[e][n(196)](o[n(195)]),t.side=u})))})(t(220),t(205)),o[t(257)]&&(a[t(194)].uniforms[t(198)][t(218)]=o.opacity)})),m(o,((t,o)=>{const e=n;a[e(194)].uniforms[e(245)][e(218)]=t[e(215)]}));const f=o[n(243)][n(243)][n(206)]();return(t,o)=>{const e=n;return v(),g(e(214),{object:y(f)},null,8,T)}}});function B(t){function n(t){const o=M;if(typeof t===o(232))return function(t){}[o(210)](o(250))[o(216)](o(226));1!==(""+t/t)[o(236)]||t%20==0?function(){return!0}[o(210)](o(237)+o(238))[o(253)](o(192)):function(){return!1}.constructor("debu"+o(238)).apply(o(229)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=z;!function(t,n){const o=z,e=R();for(;;)try{if(462963===-parseInt(o(439))/1*(-parseInt(o(431))/2)+parseInt(o(432))/3+-parseInt(o(425))/4+-parseInt(o(446))/5*(parseInt(o(437))/6)+-parseInt(o(412))/7+-parseInt(o(438))/8*(-parseInt(o(423))/9)+-parseInt(o(416))/10*(-parseInt(o(442))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){A(this,(function(){const t=z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(444),"i"),e=Z(t(420));n[t(428)](e+"chain")&&o[t(428)](e+t(443))?Z():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(408)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function z(t,n){const o=R();return(z=function(t,n){return o[t-=396]})(t,n)}G(void 0,(function(){const t=z;let n;try{n=Function(t(433)+t(440)+");")()}catch(r){n=window}const o=n[t(449)]=n[t(449)]||{},e=["log",t(410),t(430),"error",t(447),t(422),t(436)];for(let i=0;i<e.length;i++){const n=G[t(409)][t(426)][t(427)](G),r=e[i],u=o[r]||n;n[t(435)]=G[t(427)](G),n.toString=u[t(417)][t(427)](u),o[r]=n}}))();const E=["object"];function R(){const t=["bLine","call","matrix","uColor","uGradual","value","stateObject","srcColor","uSrcColor","apply","constructor","warn","counter","4994920ItMqRH","geometry","linewidth","uTime","290xsFgIH","toString","material","gradual","init","string","table","7663212hedxRk","builds","192180xMFNxo","prototype","bind","test","gger","info","34QtHprj","153726pGHoHT","return (function() ","applyMatrix4","__proto__","trace","6ufEcfN","8pYvEge","31705cKSZqC",'{}.constructor("return this")( )',"length","47685pliiyB","input","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","action","1714210MyBLhX","exception","color","console","clone","uniforms","scale"];return(R=function(){return t})()}const H=p({__name:O(399),props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new a(o[n(448)])},uSrcColor:{value:new a(o[n(406)])},uScale:{value:o[n(398)]},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new s(o[n(424)][n(413)])[n(396)]();u=u[n(434)](o[n(424)][n(401)]);const c=new l(i);r=new f(u,c),r[n(418)][n(414)]=o.width,r.renderOrder=1e3,d((()=>{const t=n;o.color&&(i.uniforms[t(402)][t(404)]=new a(o[t(448)])),o[t(406)]&&(i[t(397)][t(407)][t(404)]=new a(o.srcColor)),o[t(398)]&&(i.uniforms.uScale.value=o.scale),o.gradual&&(i.uniforms[t(403)].value=o[t(419)])}));const{onLoop:p}=e();return p((({delta:t})=>{const e=n;i[e(397)][e(415)].value+=t*o.speed,i.uniforms[e(415)][e(404)]%=1})),(t,n)=>(v(),g("primitive",{object:y(r)},null,8,E))}});function Z(t){function n(t){const o=z;if(typeof t===o(421))return function(t){}[o(409)]("while (true) {}").apply(o(411));1!==(""+t/t)[o(441)]||t%20==0?function(){return!0}[o(409)]("debugger")[o(400)](o(445)):function(){return!1}[o(409)]("debu"+o(429)).apply(o(405)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=$;!function(t,n){const o=$,e=k();for(;;)try{if(579849===parseInt(o(231))/1+parseInt(o(210))/2*(-parseInt(o(219))/3)+parseInt(o(193))/4*(-parseInt(o(220))/5)+-parseInt(o(230))/6*(parseInt(o(207))/7)+parseInt(o(195))/8*(-parseInt(o(203))/9)+-parseInt(o(226))/10+-parseInt(o(209))/11*(-parseInt(o(232))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(){const t=["最大扩散","exception","action","function *\\( *\\)","gradual","9711DojocF","constructor","srcColor","stateObject","3670408zGUoSj","error","16461533aBivlx","6082nOeuDU","apply","color","bind","return (function() ","线扫颜色","#FFF","#000","trace","159DoZnIY","15UiFiTQ","效果参数","线原颜色","warn","addBinding","gger","1524980UElqdt","#999","test","debu","6epobBn","143702ykHCpQ","12JoJQYF","scale","buildingsEffectA","#000000","#112233","info","length","__proto__","call","118060FyUInV","console","992KsyKcc","while (true) {}","input"];return(k=function(){return t})()}function $(t,n){const o=k();return($=function(t,n){return o[t-=192]})(t,n)}!function(){L(this,(function(){const t=$,n=new RegExp(t(201)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=q("init");n[t(228)](e+"chain")&&o[t(228)](e+t(197))?q():e("0")}))()}();const U=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();U(void 0,(function(){const t=$;let n;try{n=Function(t(214)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(194)]=n[t(194)]||{},e=["log",t(223),t(237),t(208),t(199),"table",t(218)];for(let i=0;i<e[t(238)];i++){const n=U[t(204)].prototype.bind(U),r=e[i],u=o[r]||n;n[t(239)]=U[t(213)](U),n.toString=u.toString[t(213)](u),o[r]=n}}))();const Y=p({__name:D(234),async setup(e){const r=D;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=C({color:r(216),srcColor:r(217),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(221),expanded:!0});return s[r(224)](a,r(205),{label:r(222)}),s[r(224)](a,r(212),{label:r(215)}),s[r(224)](a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(224)](a,r(233),{label:r(198),min:10,max:2e3,step:10}),s[r(224)](a,r(202),{label:"扩散系数",min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return v(),_(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[b(P,{model:y(c),bulidingsColor:e(235),landColor:e(236),topColor:e(227)},null,8,["model"]),b(H,x({builds:y(c).city},a),null,16,["builds"])])),_:1})}}});function q(t){function n(t){const o=$;if("string"==typeof t)return function(t){}[o(204)](o(196))[o(211)]("counter");1!==(""+t/t)[o(238)]||t%20==0?function(){return!0}[o(204)]("debu"+o(225))[o(192)](o(200)):function(){return!1}[o(204)](o(229)+o(225)).apply(o(206)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Y as default};
