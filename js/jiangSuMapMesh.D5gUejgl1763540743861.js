import{l as e}from"./utils.DhJ-cORL1763540743861.js";import{F as s,_ as o,g as t}from"./@tresjs.BCHtwiaC1763540743861.js";import{o as r}from"./index.Crdf3MNx1763540743861.js";import{f as i}from"./utils.3DEpDbfU1763540743861.js";import{a8 as n,a as p,a6 as a,H as m,o as l,F as c,X as d,b as j,I as u,e as h,J as y,N as f,m as g,u as v}from"./@vue.Co_gxueH1763540743861.js";import{m as T}from"./d3-geo.dcKspw7k1763540743861.js";import{am as b,ae as w,j as M,n as S,l as k,B as x,V as O,bS as z}from"./three.rXKzP9fQ1763540743861.js";import{c as B,d as E,a as C}from"./three-mesh-bvh.BY-MaG5X1763540743861.js";import"./@fesjs.BEMFm_yJ1763540743861.js";import"./vue-router.BxG8XxK11763540743861.js";import"./lodash-es.B7GkVYRo1763540743861.js";import"./@vueuse.CfFJ-iFV1763540743861.js";import"./pinia.CEQ6XgE61763540743861.js";import"./@qlin.y-0Z8WnK1763540743861.js";import"./@babel.BPq7uOAK1763540743861.js";import"./@floating-ui.Bhq4ibgf1763540743861.js";import"./@juggle.Vc7cP4_P1763540743861.js";import"./postprocessing.51l5tmA-1763540743861.js";import"./chalk.BHLFMujs1763540743861.js";/* empty css                                 */import"./iconify-icon.1JyQPtAK1763540743861.js";import"./@iconify.DDuAktjw1763540743861.js";import"./vite-plugin-qiankun.B06WoCqG1763540743861.js";import"./dompurify.C4MEnGDh1763540743861.js";import"./oimophysics.CfVKSiAm1763540743861.js";import"./three-stdlib.DJsODJ8R1763540743861.js";import"./@pmndrs.C5SFDEDA1763540743861.js";import"./object-hash.DlZNhpf61763540743861.js";import"./@amap.D8CfaEsq1763540743861.js";import"./crypto-js.CLP5yTup1763540743861.js";import"./naive-ui.qjPOP62h1763540743861.js";import"./date-fns.eh-WGDI81763540743861.js";import"./@css-render.DtSd-BuN1763540743861.js";import"./css-render.Dlx27V_T1763540743861.js";import"./@emotion.DFFAhID71763540743861.js";import"./seemly.D2hUckm91763540743861.js";import"./vooks.CVMU_ROE1763540743861.js";import"./evtd.C4K_ichY1763540743861.js";import"./vueuc.CEvnhvIm1763540743861.js";import"./vdirs.DlTVi7SG1763540743861.js";import"./treemate.Qc8YxXqZ1763540743861.js";import"./date-fns-tz.CIz1xaH61763540743861.js";import"./async-validator.DJtlKCAR1763540743861.js";import"./tweakpane.CqZAnw7f1763540743861.js";import"./@tweenjs.CStbC9mZ1763540743861.js";const _=["position"],G=["blending","map"],L=["name","renderOrder","pCenter"],F=["args"],H=["color","side"],I=["renderOrder","position-z"],P=["position"],$=["renderOrder"],q=["position"],J={__name:"jiangSuMapMesh",async setup(J){let N,R;M.prototype.computeBoundsTree=B,M.prototype.disposeBoundsTree=E,S.prototype.raycast=C;const V=([N,R]=n(()=>e("./plugins/simpleGIS/json/320000_full.json","features")),N=await N,R(),N),Z=([N,R]=n(()=>r("./plugins/simpleGIS/image/icon.png")),N=await N,R(),N),A=V[0].properties.centroid,D=T();D.center(A).translate([0,0]);const K=[];V.forEach(e=>{const s=new k(`hsl( 16, ${30*Math.random()+55}%, ${30*Math.random()+55}%)`).getHex(),o=.3*Math.random()+.3,{centroid:t,oneCenter:r,center:i,name:n}=e.properties,{coordinates:p,type:a}=e.geometry,m=t||r||i||[0,0],l=D(m);l[1]=-l[1],l[2]=o,K.push({type:"Html",position:l,name:n});const c=D(m);c[1]=.2-c[1],c[2]=o+.22,K.push({type:"Sprite",position:c}),p.forEach(e=>{function t(e){const t=new z;e.forEach((e,s)=>{const[o,r]=D(e);0===s?t.moveTo(o,-r):t.lineTo(o,-r)}),K.push({type:"Shape",shape:t,name:n,color:s,depth:o,pCenter:c});const r=[];e.forEach(e=>{const[s,o]=D(e);r.push(s,-o,0)}),K.push({type:"Line",points:new Float32Array(r),depth:o})}"MultiPolygon"===a&&e.forEach(e=>t(e)),"Polygon"===a&&t(e)})});const W=p();a(()=>{W.value&&((e=>{e.rotation.x=-Math.PI/2;const s=(new x).setFromObject(e).getCenter(new O),o=[0,0];e.position.x=e.position.x-s.x-o[0],e.position.z=e.position.z-s.z-o[1]})(W.value),W.value.children.forEach(e=>{"Mesh"===e.type&&e.geometry.computeBoundsTree()}))});const X=e=>{e.object.material.opacity=.4},Y=e=>{e.eventObject.material.opacity=1},{camera:Q,controls:U}=s();let ee=null;const se=e=>{const s=new O;s.x=e.point.x,s.y=e.point.y+10,s.z=e.point.z,ee=i(Q,s,U)},{onBeforeRender:oe}=o();oe(()=>{ee?.update()});const te={wrapperClass:"wrapper",as:"div",center:!0,sprite:!0,prepend:!0,transform:!0};return(e,s)=>(l(),m("TresGroup",{ref_key:"tgRef",ref:W},[(l(),m(c,null,d(K,(e,o)=>(l(),m(c,{key:`${o}`},["Html"===e.type?(l(),j(v(t),g({key:0,ref_for:!0},te,{position:e.position}),{default:h(()=>[y("span",null,f(e.name),1)]),_:2},1040,["position"])):u("",!0),"Sprite"===e.type?(l(),m("TresSprite",{key:1,position:e.position,scale:.3,renderOrder:1e3},[y("TresSpriteMaterial",{color:16711680,blending:b,map:v(Z)},null,8,G)],8,_)):u("",!0),"Shape"===e.type?(l(),m("TresMesh",{key:2,name:e.name,renderOrder:o,pCenter:e.pCenter,onPointerenter:X,onPointerleave:Y,onClick:se},[y("TresExtrudeGeometry",{args:[e.shape,{depth:e.depth,bevelEnabled:!1}]},null,8,F),y("TresMeshStandardMaterial",{color:e.color,emissive:0,roughness:.45,metalness:.8,transparent:!0,side:w},null,8,H)],40,L)):u("",!0),"Line"===e.type?(l(),m(c,{key:3},[y("TresLine",{renderOrder:o,"position-z":e.depth+1e-4},[y("TresBufferGeometry",{position:[e.points,3]},null,8,P),s[0]||(s[0]=y("TresLineBasicMaterial",{color:16777215,linewidth:.5},null,-1))],8,I),y("TresLine",{renderOrder:o,"position-z":-1e-4},[y("TresBufferGeometry",{position:[e.points,3]},null,8,q),s[1]||(s[1]=y("TresLineBasicMaterial",{color:0,linewidth:.5},null,-1))],8,$)],64)):u("",!0)],64))),64))],512))}};export{J as default};
