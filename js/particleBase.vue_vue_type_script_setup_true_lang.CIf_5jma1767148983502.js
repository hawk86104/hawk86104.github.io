import{importShared as i}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{no as k,_l as U,sz as W}from"./index.DTe2qqjO1767148983502.js";const{defineComponent:Z}=await i("vue"),{unref:n,createElementVNode:g,openBlock:x,createElementBlock:F}=await i("vue"),G=["size","color","alpha-map","map","opacity","alpha-test","depth-write","transparent","size-attenuation"],S=["position","velocity"],{shallowRef:v,toRefs:O,watch:T,watchEffect:A}=await i("vue"),j=Z({__name:"index",props:{size:{default:.1},area:{default:()=>[10,10,20]},color:{default:16777215},map:{},alphaMap:{},alphaTest:{default:.01},opacity:{default:.8},count:{default:5e3},speed:{default:.1},randomness:{default:.5},depthWrite:{type:Boolean,default:!1},transparent:{type:Boolean,default:!0},sizeAttenuation:{type:Boolean,default:!0}},setup(m,{expose:r}){const u=m,{size:t,area:o,color:p,alphaMap:h,map:y,opacity:E,alphaTest:R,depthWrite:$,transparent:b,sizeAttenuation:Y,count:f,speed:d,randomness:N}=O(u),l=v();let c=[],s=[];const _=()=>{c=new Float32Array(f.value*3);for(let e=0;e<f.value;e++){const a=e*3;c[a]=(Math.random()-.5)*o.value[0],c[a+1]=(Math.random()-.5)*o.value[1],c[a+2]=(Math.random()-.5)*o.value[2]}},z=()=>{s=new Float32Array(f.value*2);for(let e=0;e<f.value*2;e+=2)s[e]=(Math.random()-.5)/5*d.value*N.value,s[e+1]=Math.random()/5*d.value};z(),_(),T(d,()=>{z()}),A(()=>{d.value||_()}),T(()=>u.area,()=>{_()});const w=v(null),B=v(null);A(async()=>{if(typeof h.value=="string"){const{state:e}=k(h.value);w.value=e.value}else w.value=h.value??null;if(typeof y.value=="string"){const{state:e}=k(y.value);B.value=e.value}else B.value=y.value??null});const{onBeforeRender:V}=U();V(()=>{if(l.value?.attributes.position.array&&l.value?.attributes.position.count){const e=l.value.attributes.position.array;for(let a=0;a<l.value.attributes.position.count;a++){const X=s[a*2],P=s[a*2+1];e[a*3]+=X,e[a*3+1]-=P,(e[a*3]<=-o.value[0]/2||e[a*3]>=o.value[0]/2)&&(e[a*3]=e[a*3]*-1),(e[a*3+1]<=-o.value[1]/2||e[a*3+1]>=o.value[1]/2)&&(e[a*3+1]=e[a*3+1]*-1)}l.value.attributes.position.needsUpdate=!0}});const M=v();return r({instance:M}),(e,a)=>(x(),F("TresPoints",{ref_key:"pointsRef",ref:M},[g("TresPointsMaterial",{size:n(t),color:n(p),"alpha-map":w.value,map:B.value,opacity:n(E),"alpha-test":n(R),"depth-write":n($),transparent:n(b),"size-attenuation":n(Y)},null,8,G),g("TresBufferGeometry",{ref_key:"geometryRef",ref:l,position:[n(c),3],velocity:[n(s)]},null,8,S)],512))}}),{defineComponent:q}=await i("vue"),{createVNode:C,unref:D,withCtx:H,openBlock:I,createElementBlock:J}=await i("vue"),{ref:K,watch:L}=await i("vue"),ae=q({__name:"particleBase",props:{speed:{default:.1},randomness:{default:1},count:{default:100},size:{default:.1},areaX:{default:5},areaY:{default:2},areaZ:{default:5},color:{default:"#fff"},opacity:{default:1}},setup(m){const r=m,u=K([r.areaX,r.areaY,r.areaZ]);return L(()=>[r.areaX,r.areaY,r.areaZ],([t,o,p])=>{u.value=[t,o,p]}),(t,o)=>(I(),J("TresGroup",null,[C(D(W),{path:"./plugins/digitalCity/image/cilcle.png"},{default:H(({state:p})=>[C(j,{renderOrder:2001,position:[0,t.areaY/2,0],speed:t.speed,color:t.color,area:u.value,count:t.count,depthWrite:!1,randomness:t.randomness,size:t.size,transparent:"",opacity:t.opacity,map:p},null,8,["position","speed","color","area","count","randomness","size","opacity","map"])]),_:1})]))}});export{ae as _sfc_main};
