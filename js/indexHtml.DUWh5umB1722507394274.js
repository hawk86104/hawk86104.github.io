import{$ as e,N as o,t as r}from"./@tresjs.bNNpPzYW1722507394274.js";import{cj as a}from"./three.Brogx0uK1722507394274.js";import{l as t}from"./utils.CuCN1ddQ1722507394274.js";import{i as s,m as n,a as l,b as i,c as p,u as c,f as m}from"./mapShow.DZNcURPz1722507394274.js";import{g as u}from"./gsap.BMhr3K_w1722507394274.js";import{m as d}from"./d3-geo.B-0wAziC1722507394274.js";import{b as f,a4 as y,q as h,w as g,o as T,D as S,J as b,F as x,V as C,u as w,I as v,j as z,g as N,H as j,m as k}from"./@vue.CFXy4cc91722507394274.js";const M=["properties","pName"],B=["args"],G=["renderOrder","pName"],L=["position"],_=["color"],O={key:0},E=["pName","position"],I=["position-z","scale","renderOrder"],P=["color","blending","map"],A={__name:"indexHtml",props:{lineColor:"#2bc4dc",topColor:"#f5f5f5",sideColor:"#00407c",iconColor:"#2bc4dc",fontColor:"#fff",fontSize:6,iconSize:.3,shadowColor:"#001c69",moveRoom:1.5,roughness:.8,metalness:.5,normalScale:6,geoJsonUrl:"",areaScale:{type:Number,default:10},centerCoordinates:{type:Array,default:[104,37.5]},showTextIcons:{type:Boolean,default:!0}},async setup(A){let D,J;const R=A,q={wrapperClass:"wrapperDigitalMapBlockMapShow",as:"div",center:!0,sprite:!1,prepend:!1,transform:!0};s();const H=d().center(R.centerCoordinates).scale(R.areaScale).translate([0,0]),U=f({depth:.66,bevelEnabled:!0,bevelSegments:1,bevelThickness:.1}),V=U.value.depth+.11,F=([D,J]=y((()=>t(R.geoJsonUrl,"features"))),D=await D,J(),D),{areaList:W,linesList:$,textList:K}=n(F,H),Q=[([D,J]=y((()=>l(R.roughness,R.metalness,R.normalScale))),D=await D,J(),D),([D,J]=y((()=>i(R.sideColor))),D=await D,J(),D)],{onLoop:X}=e();X((()=>{Q[1].map.offset.y+=.002}));const Y=f(null);h((()=>{let{boxSize:e,box3:o}=p(Y.value.children[0]);Y.value.children[0].children.map(((r,a)=>{"Mesh"===r.type&&(r.geometry.computeBoundsTree(),c(r.geometry,e.x,e.y,o.min.x,o.min.y))})),Y.value.rotation.x=-Math.PI/2,setTimeout((()=>{re(R.fontColor,R.shadowColor,R.fontSize)}),600)}));const Z=(e,o)=>{let r=R.moveRoom,a=e.object;o||(a=e.eventObject,r=1);m(Y.value,a.pName).map((e=>{"block"===e.pType&&u.to(e.scale,{duration:.3,z:r}),"line"===e.pType&&u.to(e.position,{duration:.3,z:V*r}),"text"===e.pType&&u.to(e.position,{duration:.3,z:V*r})}))},ee=e=>{Z(e,!0),document.body.style.cursor="pointer",e.stopPropagation()},oe=e=>{Z(e,!1),document.body.style.cursor="default"};g((()=>[R.topColor,R.sideColor,R.roughness,R.metalness,R.normalScale]),(([e,o,r,a,t,s])=>{Q[0].color.set(e),Q[1].color.set(o),Q[0].roughness=r,Q[0].metalness=a,Q[0].normalScale.set(t,t)}),{immediate:!0});const re=(e,o,r)=>{document.querySelectorAll(".wrapperDigitalMapBlockMapShow #inner span").forEach((a=>{a.style.color="".concat(e),a.style.textShadow="1px 1px 2px ".concat(o),a.style.fontSize="".concat(r,"px")}))};g((()=>[R.fontColor,R.shadowColor,R.fontSize]),(([e,o,r])=>{re(e,o,r)}),{immediate:!0});const{map:ae}=([D,J]=y((()=>o({map:"./plugins/digitalMapBlock/images/icon.png"}))),D=await D,J(),D);return(e,o)=>(T(),S("TresGroup",{ref_key:"groupRef",ref:Y},[b("TresGroup",null,[(T(!0),S(x,null,C(w(W),((e,o)=>(T(),S("TresMesh",{key:"".concat(o),properties:e.properties,renderOrder:1,material:Q,pName:e.pName,pType:"block",onPointerEnter:ee,onPointerLeave:oe},[b("TresExtrudeGeometry",{args:[e.shape,U.value]},null,8,B)],40,M)))),128))]),b("TresGroup",null,[(T(!0),S(x,null,C(w($),((e,o)=>(T(),S("TresLine",{key:"".concat(o),renderOrder:o+1e4,pName:e.pName,"position-z":V,pType:"line"},[b("TresBufferGeometry",{position:[e.points,3]},null,8,L),b("TresLineBasicMaterial",{color:A.lineColor},null,8,_)],8,G)))),128))]),A.showTextIcons?(T(),S("TresGroup",O,[(T(!0),S(x,null,C(w(K),((e,o)=>(T(),S("TresGroup",{key:"".concat(o),pName:e.pName,pType:"text",position:[e.position[0],e.position[1],V]},[z(w(r),k({ref_for:!0},q),{default:N((()=>[b("span",null,j(e.pName),1)])),_:2},1040),b("TresSprite",{"position-z":A.iconSize,scale:A.iconSize,renderOrder:o+11e3},[b("TresSpriteMaterial",{color:A.iconColor,blending:a,map:w(ae),transparent:"",depthWrite:!1,depthTest:""},null,8,P)],8,I)],8,E)))),128))])):v("",!0)],512))}};export{A as _};
