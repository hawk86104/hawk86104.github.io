{"version":3,"file":"cloudMesh.vue_vue_type_script_setup_true_lang.t0Z5pxFM1767105581793.js","sources":["../../src/plugins/digitalCity/components/weather/cloudMesh.vue"],"sourcesContent":["<!--\n * @Description:\n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2023-10-27 16:43:05\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-09-26 11:12:54\n-->\n<script setup lang=\"ts\">\nimport { watch, ref, toRaw } from 'vue'\nimport { useTexture } from '@tresjs/cientos'\nimport { useLoop } from '@tresjs/core'\nimport * as THREE from 'three'\nimport { default as SPE } from '../../common/ShaderParticleEngine/build/SPE'\n\nconst { state: pTexture } = useTexture('./plugins/digitalCity/image/cloud.png')\n\nlet particleGroup = null as any\nconst objCloud = ref<THREE.Mesh | null>(null)\nwatch(\n  () => pTexture.value,\n  (mapv) => {\n    if (!mapv) return\n    mapv.magFilter = THREE.LinearMipMapLinearFilter\n    mapv.minFilter = THREE.LinearMipMapLinearFilter\n\n    try {\n      // 创建 particleGroup（先不传 texture，纹理加载后再注入）\n      particleGroup = new SPE.Group({\n        texture: {\n          value: mapv\n        },\n        blending: THREE.NormalBlending,\n        // fog: true,\n        depthTest: false,\n        depthWrite: false,\n      })\n\n      // 创建 emitter（配置与原来一致）\n      const emitter = new SPE.Emitter({\n        type: SPE.distributions.BOX,\n        particleCount: 26,\n        maxAge: {\n          value: 10,\n        },\n        position: {\n          value: new THREE.Vector3(0, 0, 0),\n          spread: new THREE.Vector3(2000, 100, 2000),\n        },\n        velocity: {\n          value: new THREE.Vector3(0, 0, 30),\n        },\n        wiggle: {\n          spread: 10,\n        },\n        size: {\n          value: 520,\n          spread: [100, 220],\n          randomise: true,\n        },\n        drag: {\n          value: 220,\n        },\n        opacity: {\n          value: [0, 1, 0],\n          randomise: true,\n        },\n        color: {\n          value: new THREE.Color(1, 1, 1),\n          spread: new THREE.Color(0.1, 0.1, 0.1),\n        },\n        angle: {\n          value: [0, Math.PI * 1 / 8],\n        },\n      })\n      particleGroup.addEmitter(emitter)\n      objCloud.value = particleGroup.mesh\n    } catch (err) {\n      console.warn('Failed to set particleGroup texture:', err)\n    }\n  }\n)\n\nconst { onBeforeRender } = useLoop()\n\nonBeforeRender(({ delta }) => {\n  if (particleGroup) {\n    particleGroup.tick(delta)\n  }\n})\n</script>\n\n<template>\n  <primitive v-if=\"objCloud\" :object=\"toRaw(objCloud)\" :position=\"[0, 200, 0]\" :renderOrder=\"3000\" />\n</template>\n"],"names":["useTexture","useLoop"],"mappings":"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"}