import{importShared as p}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{zr as O,Kk as j}from"./index.DTe2qqjO1767148983502.js";import{FontLoader as A}from"./FontLoader.GSSPCxxt1767148983502.js";const{ExtrudeGeometry:H}=await p("three");class N extends H{constructor(l,r={}){const f=r.font;if(f===void 0)super();else{const a=f.generateShapes(l,r.size);r.depth===void 0&&(r.depth=50),r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),super(a,r)}this.type="TextGeometry"}}const{withAsyncContext:Z,defineComponent:K}=await p("vue"),{createElementVNode:m,Fragment:U,openBlock:W,createElementBlock:J}=await p("vue"),{ref:z}=await p("vue"),e=await p("three"),Q=K({__name:"tagging",async setup(V){let l,r;const{scene:f}=O(),a=z(),_=z();let x=null;function S(s){return new Promise((t,o)=>{new A().load(s,i=>t(i),void 0,i=>o(i))})}const E=([l,r]=Z(()=>S("https://opensource.cdn.icegl.cn/fonts/FZLanTingHeiS-UL-GB_Regular.json")),l=await l,r(),l),F=function(s){x=new e.Box3().setFromObject(s);const t=new e.Vector3;x.getSize(t);const o=new e.Vector3;return x.getCenter(o),{size:t,boxCenter:o}},L=function(s,t){const o=new e.BoxGeometry(s.x,s.y,s.z),n=new e.EdgesGeometry(o),i=new e.LineBasicMaterial({color:"red"}),c=new e.LineSegments(n,i);c.position.copy(t),f.value.add(c)},q=(s,t,o)=>{const n=new N(s,{font:E,size:3,depth:1,height:.2,curveSegments:12,bevelEnabled:!1}),i=new e.MeshBasicMaterial({color:65280}),c=new e.Mesh(n,i);c.position.copy(t);const u=new e.Vector3(1,0,0),w=new e.Vector3(-1,0,0),b=new e.Vector3(0,1,0),h=new e.Vector3(0,-1,0),g=new e.Vector3(0,0,1),d=new e.Vector3(0,0,-1);return o.equals(u)||o.equals(w)||(o.equals(b)||o.equals(h)?c.rotation.set(0,0,Math.PI/2):(o.equals(g)||o.equals(d))&&c.rotation.set(0,Math.PI/2,0)),c},$=(s,t,o)=>{const n=new e.Group,i=new e.BufferGeometry().setFromPoints([s,t]),c=new e.Line(i,new e.LineBasicMaterial({color:"green"})),u=1,w=3,b=8,h=new e.ConeGeometry(u,w,b),g=new e.MeshBasicMaterial({color:"green"}),d=new e.Mesh(h,g);d.type="Raycone",d.position.copy(s);const y=new e.Mesh(h,g);y.type="Raycone",y.position.copy(t);const I=new e.Vector3(1,0,0),R=new e.Vector3(0,1,0),D=new e.Vector3(0,0,1);return o.equals(I)?(d.rotation.set(0,0,Math.PI/2),y.rotation.set(0,0,-Math.PI/2)):o.equals(R)?d.rotation.set(0,0,Math.PI):o.equals(D)&&(d.rotation.set(-Math.PI/2,0,0),y.rotation.set(Math.PI/2,0,0)),n.add(c),n.add(d),n.add(y),n},v=function(s,t,o){const n=new e.Vector3().addVectors(s,t).multiplyScalar(.5),i=new e.Vector3().subVectors(t,s).normalize(),c=$(s,t,i);f.value.add(c);const u=q(o,n,i);f.value.add(u)},M=function(s){const{size:t,boxCenter:o}=F(s);L(t,o);const n=x.min,i=x.max,c=Number(t.z.toFixed(2))+10,u=10,w=Number(t.z.toFixed(2))+16;v(new e.Vector3(n.x,n.y,n.z+c),new e.Vector3(i.x,n.y,n.z+c),`长: ${t.x.toFixed(2)}`),v(new e.Vector3(n.x,n.y,n.z+w),new e.Vector3(n.x,i.y,n.z+w),`高: ${t.y.toFixed(2)}`),v(new e.Vector3(n.x-u,n.y,n.z),new e.Vector3(n.x-u,n.y,i.z),`宽: ${t.z.toFixed(2)}`)};return(s,t)=>(W(),J(U,null,[m("TresMesh",{ref_key:"torusref",ref:a,position:[-100,0,0],onClick:t[0]||(t[0]=o=>M(a.value))},[...t[2]||(t[2]=[m("TresTorusGeometry",{args:[50,5,128,128]},null,-1),m("TresMeshBasicMaterial",{color:"orange"},null,-1)])],512),m("TresMesh",{ref_key:"boxref",ref:_,position:[100,0,0],onClick:t[1]||(t[1]=o=>M(_.value))},[...t[3]||(t[3]=[m("TresBoxGeometry",{args:[80,100,20]},null,-1),m("TresMeshNormalMaterial",null,null,-1)])],512)],64))}}),{defineComponent:X}=await p("vue"),{createElementVNode:B,unref:Y,normalizeProps:ee,guardReactiveProps:te,createVNode:C,Suspense:ne,withCtx:P,openBlock:k,createBlock:T,resolveComponent:oe,mergeProps:se}=await p("vue"),{reactive:G}=await p("vue"),ae=X({__name:"tagging",setup(V){const l=G({windowSize:!0,alpha:!0,antialias:!0}),r=G({enableDamping:!0,enableZoom:!0,enablePan:!0,enableRotate:!0,makeDefault:!0});return(f,a)=>{const _=oe("TresCanvas");return k(),T(_,se({clearColor:"#201919"},l),{default:P(()=>[a[0]||(a[0]=B("TresPerspectiveCamera",{fov:60,near:.1,far:2e3,position:[0,0,200],"look-at":[0,0,0]},null,-1)),a[1]||(a[1]=B("TresAmbientLight",{intensity:2},null,-1)),C(Y(j),ee(te(r)),null,16),(k(),T(ne,null,{default:P(()=>[C(Q)]),_:1}))]),_:1},16)}}});export{ae as default};
