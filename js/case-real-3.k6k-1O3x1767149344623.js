import{importShared as e}from"./3d-tiles-renderer.de6b_qgz1767149344623.js";import{T_ as t,Gy as a,Hy as l,_sfc_main as n,_a as o,ly as i,By as u,cy as s,$d as r,ol as c,J_ as p}from"./DevTDTTiles.vue_vue_type_script_setup_true_lang.B9UAAk3h1767149344623.js";import{sz as d,_export_sfc as g}from"./index.Btae5S5d1767149344623.js";const{defineComponent:h}=await e("vue"),{createElementVNode:v,unref:f,createVNode:m,withCtx:w,openBlock:_,createBlock:k,createCommentVNode:M,Suspense:b,resolveComponent:C,mergeProps:x,Fragment:y,createElementBlock:P}=await e("vue"),T={scale:[5,5,5]},{SRGBColorSpace:S,BasicShadowMap:z,NoToneMapping:B,CurvePath:V,LineCurve:L,Vector2:N,RepeatWrapping:j,Vector3:D}=await e("three"),{reactive:I,ref:R}=await e("vue"),{watch:q}=await e("vue"),A=8e5,E=g(h({__name:"case-real-3",setup(e){const g=I({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:z,outputColorSpace:S,toneMapping:B}),h=R({lon:117.84796240906425,lat:38.95216229684954,height:20}),E=R({lon:117.8533521756129,lat:38.95128,height:20});function G(e,t,a,l,n=!0){const o=t-e;return t=>{let i=(t-e)/o;return n&&(i=Math.max(0,Math.min(1,i))),a+i*(l-a)}}const O=R();const U=R(0),W=R(2e3),F=R(100),H=R(1),J=R(1),K=G(5e3,1e7,1,1e3),Q=G(5e3,1e7,.001,1);q(U,e=>{W.value=2e3/K(e),F.value=100*K(e),H.value=Q(e),J.value=(e-1e5)/9e5*.5});const X=R(1),Y=R({lon:90.85,lat:40,height:A});const Z=()=>{!function(){const e=performance.now()/1e3*X.value%500/500*2*Math.PI;Y.value.lon=(90.85+180*e/Math.PI)%360,Y.value.lat=40+5*Math.cos(e),Y.value.height=A}(),O.value&&(U.value=function(e){const t=e.x,a=e.y,l=e.z,n=6378137,o=6356752.314245,i=n*n,u=o*o,s=(i-u)/i,r=(i-u)/u,c=Math.hypot(t,a);if(0===c&&0===l)return Math.sqrt(t*t+a*a+l*l)-n;const p=Math.atan2(l*n,c*o),d=Math.sin(p),g=Math.cos(p),h=Math.atan2(l+r*o*d*d*d,c-s*n*g*g*g),v=Math.sin(h),f=Math.cos(h),m=n/Math.sqrt(1-s*v*v);return Math.abs(f)>1e-12?c/f-m:l/Math.sign(v)-m*(1-s)}(O.value?.getWorldPosition(new D)))},$=R({effectProps:{enabled:!1,focusArea:.7,feather:.1},ambientLight:{color:"#fff",intensity:1},directionalLight:{color:"#fff",intensity:2,position:[-1500,500,500]},background:"/plugins/earthSample/image/menuA/bg-img.png"}),ee=R({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132}),te=R({heading:90,pitch:45,distance:200}),ae=[{lon:117.85481967875631,lat:38.95025551631983},{lon:117.85566616248491,lat:38.95427209924625},{lon:117.85712202478027,lat:38.95970065499051},{lon:118.10293300958989,lat:38.92203696242356},{lon:118.21571040844162,lat:38.8584869570214},{lon:118.56457646308445,lat:38.792815766352845},{lon:119.52790645782477,lat:38.717044062084426},{lon:120.65902562748857,lat:38.60702467836941},{lon:120.79461456776448,lat:38.58622713855249},{lon:120.92076119840306,lat:38.52106665879057},{lon:121.9906916889725,lat:38.18314251246517},{lon:124.14446035378819,lat:37.44557549519065},{lon:125.9802772978905,lat:37.39012819157668},{lon:126.42446686403741,lat:37.35004753338622},{lon:126.48154639818023,lat:37.36107410768207},{lon:126.56124848326965,lat:37.40711309766567},{lon:126.57255884697423,lat:37.421008747816884},{lon:126.581932075672,lat:37.42778825439147},{lon:126.59275992012022,lat:37.42831387228446},{lon:126.60078120441494,lat:37.42464694776248}],le=new V;for(let t=0;t<ae.length-1;t++){const e=ae[t],a=ae[t+1];le.add(new L(new N(e.lon,e.lat),new N(a.lon,a.lat)))}const ne=le.getSpacedPoints(1e3).map(e=>({lon:e.x,lat:e.y,height:20})),oe=R(!1),ie=R({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132});function ue(){ee.value={heading:0,pitch:-45,distance:1e5,longitude:Y.value.lon,latitude:Y.value.lat},oe.value=!0}function se(){ee.value={heading:0,pitch:-45,distance:500,longitude:h.value.lon,latitude:h.value.lat},oe.value=!1}function re(){ee.value={heading:0,pitch:-45,distance:500,longitude:E.value.lon,latitude:E.value.lat},oe.value=!1}function ce(){ee.value={...ie.value},oe.value=!1}return(e,S)=>{const z=C("TresCanvas");return _(),P(y,null,[m(z,x(g,{"window-size":"",onLoop:Z}),{default:w(()=>[v("TresPerspectiveCamera",{fov:45,near:.1,far:1e3,"look-at":[0,0,0],ref_key:"cameraRef",ref:O},null,512),m(f(t)),m(f(a),{position:ee.value,"onUpdate:position":S[0]||(S[0]=e=>ee.value=e),targetPosition:te.value,"onUpdate:targetPosition":S[1]||(S[1]=e=>te.value=e),target:oe.value?Y.value:null,"min-distance":1},null,8,["position","targetPosition","target"]),m(f(l),{sceneConfig:$.value},null,8,["sceneConfig"]),m(n,{layer:"img"}),m(f(o),{point:h.value},{default:w(()=>[m(f(i),{rotate:-12,"scale-x":.9},{default:w(()=>[m(f(u),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})]),_:1})]),_:1},8,["point"]),m(f(o),{point:E.value},{default:w(()=>[m(f(i),{rotate:-12,"scale-x":.9},{default:w(()=>[m(f(u),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})]),_:1})]),_:1},8,["point"]),(_(),k(b,null,{default:w(()=>[m(f(d),{path:"/plugins/geokit/case-real-3/image/road-texture.png"},{default:w(({state:e})=>[m(f(s),{texture:e,wrapT:f(j),wrapS:f(j)},null,8,["texture","wrapT","wrapS"]),f(ne).length?(_(),k(f(r),{key:0,speed:H.value},{default:w(()=>[m(f(c),{repeat:[W.value,1],map:e,duration:4,points:f(ne),width:F.value,color:"#fff",renderOrder:500},null,8,["repeat","map","points","width"])]),_:2},1032,["speed"])):M("",!0)]),_:1})]),_:1})),f(ne).length?(_(),k(f(c),{key:0,points:f(ne),width:F.value,color:"#fff",opacity:J.value,renderOrder:200},null,8,["points","width","opacity"])):M("",!0),m(f(o),{point:Y.value},{default:w(()=>[m(f(i),{rotate:-12,"scale-x":.9},{default:w(()=>[v("TresGroup",T,[m(f(u),{url:"/plugins/geokit/case-real-3/model/weixing.glb",draco:""})])]),_:1})]),_:1},8,["point"]),m(f(p),{icon:"/plugins/geokit/case-real-3/icons/satellite.svg",size:16,point:Y.value,onClick:S[2]||(S[2]=e=>oe.value=!oe.value)},null,8,["point"]),m(f(p),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:h.value},null,8,["point"]),m(f(p),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:E.value},null,8,["point"])]),_:1},16),v("div",{class:"control-panel"},[v("button",{onClick:ue,class:"focus-btn satellite-btn"}," 聚焦卫星 "),v("button",{onClick:se,class:"focus-btn ship-btn"}," 聚焦船只1 "),v("button",{onClick:re,class:"focus-btn ship-btn"}," 聚焦船只2 "),v("button",{onClick:ce,class:"reset-btn"}," 还原镜头 ")])],64)}}}),[["__scopeId","data-v-4ac10c4d"]]);export{E as default};
