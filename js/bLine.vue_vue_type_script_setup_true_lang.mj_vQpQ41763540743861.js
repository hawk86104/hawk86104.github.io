import{l as o,be as e,q as a,bL as r}from"./three.rXKzP9fQ1763540743861.js";import{_ as t}from"./@tresjs.BCHtwiaC1763540743861.js";import{d as i,a6 as l,H as n,o as u,u as s}from"./@vue.Co_gxueH1763540743861.js";const c=["object"],d=i({__name:"bLine",props:{builds:{},color:{default:"#FFF"},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(i){const d=i;let m=null;const v={transparent:!0,uniforms:{uColor:{value:new o(d.color)},uSrcColor:{value:new o(d.srcColor)},uScale:{value:d.scale},uTime:{value:0},uGradual:{value:d.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;\nuniform float uGradual;\nuniform float uTime;\nuniform vec3 uColor;\nuniform vec3 uSrcColor;\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t\n}"};let f=new e(d.builds.geometry).clone();f=f.applyMatrix4(d.builds.matrix);const p=new a(v);m=new r(f,p),m.material.linewidth=d.width,m.renderOrder=1e3,l(()=>{d.color&&(v.uniforms.uColor.value=new o(d.color)),d.srcColor&&(v.uniforms.uSrcColor.value=new o(d.srcColor)),d.scale&&(v.uniforms.uScale.value=d.scale),d.gradual&&(v.uniforms.uGradual.value=d.gradual)});const{onBeforeRender:C}=t();return C(({delta:o})=>{v.uniforms.uTime.value+=o*d.speed,v.uniforms.uTime.value%=1}),(o,e)=>(u(),n("primitive",{object:s(m)},null,8,c))}});export{d as _};
