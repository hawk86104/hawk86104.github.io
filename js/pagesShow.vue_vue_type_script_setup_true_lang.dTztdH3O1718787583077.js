import{Z as t,C as n,a5 as o,ca as e,cb as r,cc as i,cd as u,k as c,bR as s,aa as a,bS as l}from"./three.OZpCYxlY1718787583077.js";import{f,r as p,d}from"./@tresjs.yMGhEK7G1718787583077.js";import{C as h}from"./three-custom-shader-material.JsHLV5bd1718787583077.js";import"./object-hash.qNEzwKzz1718787583077.js";import"./@amap.SdFHYHOw1718787583077.js";import"./glsl-tokenizer.gaAYmyHH1718787583077.js";import{d as m,b as y,a2 as g,w,o as v,D as b,u as _,r as C,a3 as I,e as x,f as M,g as T,J as j,j as S,aj as A,ak as O,F as B,I as R,G as F,m as L}from"./@vue.CpOXM7bB1718787583077.js";!function(t,n){const o=D,e=Z();for(;;)try{if(908896===parseInt(o(175))/1*(-parseInt(o(176))/2)+parseInt(o(187))/3*(parseInt(o(197))/4)+parseInt(o(181))/5*(-parseInt(o(178))/6)+-parseInt(o(189))/7*(-parseInt(o(205))/8)+-parseInt(o(191))/9*(parseInt(o(202))/10)+-parseInt(o(193))/11+parseInt(o(173))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(192)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=D,n=new RegExp(t(204)),o=new RegExp(t(190),"i"),e=P("init");n.test(e+"chain")&&o[t(207)](e+"input")?P():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(192)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["while (true) {}","gger","return (function() ","462668ZWKapC","length","string","traverse","table","249160inKFzA","CITY_UNTRIANGULATED","function *\\( *\\)","1640432JDEZqf","trace","test","constructor","34951332jixdYf","ROADS","1723124CTZCjA","2YFdJQa","info","97872nTwPau","stateObject","name","85BAncKV","console","log","toString",'{}.constructor("return this")( )',"debu","15FsqDNh","bind","21UVVHMM","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","198wePVts","apply","7134952ciedvM"];return(Z=function(){return t})()}k(void 0,(function(){const t=D,n=function(){const t=D;let n;try{n=Function(t(196)+t(185)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(182)]||{},e=[t(183),"warn",t(177),"error","exception",t(201),t(206)];for(let r=0;r<e[t(198)];r++){const n=k.constructor.prototype.bind(k),i=e[r],u=o[i]||n;n.__proto__=k.bind(k),n[t(184)]=u[t(184)][t(188)](u),o[i]=n}}))();const z=async()=>{const t=D,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(200)]((n=>{const i=t;n.name===i(203)&&(o=n),"LANDMASS"===n[i(180)]&&(e=n),n.name===i(174)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function D(t,n){const o=Z();return(D=function(t,n){return o[t-=172]})(t,n)}function P(t){function n(t){const o=D;if(typeof t===o(199))return function(t){}[o(172)](o(194)).apply("counter");1!==(""+t/t)[o(198)]||t%20==0?function(){return!0}[o(172)](o(186)+o(195)).call("action"):function(){return!1}[o(172)]("debugger").apply(o(179)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const H=$;!function(t,n){const o=$,e=K();for(;;)try{if(597644===-parseInt(o(244))/1*(-parseInt(o(212))/2)+parseInt(o(250))/3*(parseInt(o(239))/4)+-parseInt(o(257))/5+parseInt(o(223))/6+parseInt(o(210))/7+-parseInt(o(199))/8+-parseInt(o(254))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(237)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){W(this,(function(){const t=$,n=new RegExp(t(192)),o=new RegExp(t(230),"i"),e=V(t(213));n[t(242)](e+t(208))&&o[t(242)](e+t(209))?V():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(237)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(t,n){const o=K();return($=function(t,n){return o[t-=192]})(t,n)}G(void 0,(function(){const t=$;let n;try{n=Function(t(233)+t(256)+");")()}catch(r){n=window}const o=n[t(215)]=n.console||{},e=[t(193),t(225),"info",t(235),t(222),"table",t(243)];for(let i=0;i<e[t(245)];i++){const n=G.constructor.prototype.bind(G),r=e[i],u=o[r]||n;n.__proto__=G[t(258)](G),n[t(251)]=u.toString.bind(u),o[r]=n}}))();const J=[H(234)];function K(){const t=["clone","#112233","while (true) {}","city","buildingsModelCustomShader","material","computeBoundingBox","model","chain","input","8304863mkJBfs","bulidingsColor","95996ZvPpfu","init","dispose","console","call","topColor","land","string","setStyle","gradient","exception","7065636hqXljh","isArray","warn","DoubleSide","renderOrder","Color","action","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","debu","computeBoundingSphere","return (function() ","object","error","uOpacity","apply","stateObject","1996kOjZAK","forEach","boundingBox","test","trace","11EmjsMO","length","value","#ffffff","#ffff00","landColor","4251TXcovr","toString","opacity","uColor","18737685zEgVBL","#e523ff",'{}.constructor("return this")( )',"2433435dOXwgo","bind","color","primitive","function *\\( *\\)","log","constructor","gger","uniforms","uGradient","counter","3462240WwEKxz"];return(K=function(){return t})()}const U=m({__name:H(204),props:{model:{},bulidingsColor:{default:H(255)},landColor:{default:H(201)},topColor:{default:H(248)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=H,i=e,u=y(0),c=i[r(207)][r(203)];c[r(227)]=1001;const s=i[r(207)][r(218)];(()=>{const t=r,{geometry:e}=c;e[t(206)](),e[t(232)]();const{max:s,min:a}=e[t(241)];if(c.material.__csm)return;const l=new h({baseMaterial:c.material,vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(i[t(211)])},uOpacity:{value:i[t(252)]},uLightColor:{value:new n(t(247))},uTopColor:{value:new(o[t(228)])(i[t(217)])},uTime:u,uGradient:{value:i[t(221)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:o[t(226)]});c.material[t(214)](),c[t(205)]=l})();const{onLoop:a}=p();a((({delta:t})=>{u[r(246)]+=t})),g((()=>{const n=r;i.bulidingsColor&&c[n(205)][n(196)][n(253)].value[n(220)](i[n(211)]),i[n(249)]&&((n,o)=>{const e=r;let u;"cu"===n||n===e(218)&&(u=Array[e(224)](s[e(205)])?s[e(205)]:[s[e(205)]],u[e(240)]((n=>{const r=e;n[o].setStyle(i[r(249)]),n.side=t})))})(n(218),n(259)),i[n(252)]&&(c[n(205)][n(196)][n(236)].value=i[n(252)])})),w(i,((t,n)=>{const o=r;c[o(205)][o(196)][o(197)][o(246)]=t.gradient}));const l=i[r(207)][r(207)][r(200)]();return(t,n)=>{const o=r;return v(),b(o(260),{object:_(l)},null,8,J)}}});function V(t){function n(t){const o=$;if(typeof t===o(219))return function(t){}[o(194)](o(202))[o(237)](o(198));1!==(""+t/t)[o(245)]||t%20==0?function(){return!0}.constructor(o(231)+o(195))[o(216)](o(229)):function(){return!1}.constructor(o(231)+o(195))[o(237)](o(238)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const N=X;!function(t,n){const o=X,e=tt();for(;;)try{if(115130===-parseInt(o(471))/1*(-parseInt(o(459))/2)+-parseInt(o(446))/3+parseInt(o(421))/4*(parseInt(o(478))/5)+parseInt(o(429))/6+-parseInt(o(437))/7+parseInt(o(463))/8*(parseInt(o(469))/9)+-parseInt(o(423))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){q(this,(function(){const t=X,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(427),"i"),e=ot("init");n[t(426)](e+t(456))&&o[t(426)](e+t(465))?ot():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function X(t,n){const o=tt();return(X=function(t,n){return o[t-=420]})(t,n)}Y(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function(t(467)+t(455)+");")()}catch(o){n=window}return n}(),o=n[t(420)]=n.console||{},e=[t(474),t(438),t(466),"error",t(428),t(451),t(475)];for(let r=0;r<e[t(460)];r++){const n=Y[t(481)][t(458)].bind(Y),i=e[r],u=o[i]||n;n[t(430)]=Y[t(442)](Y),n.toString=u.toString.bind(u),o[i]=n}}))();const Q=[N(431)];function tt(){const t=["2424770HZkieM"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","opacity","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","exception","310764LToQiO","__proto__","object","resolution","uColor","innerWidth","fromEdgesGeometry","Shader","679581SLjbAY","warn","set","matrix","uOpacity","bind","counter","uniforms","width","109365HbKUIR","innerHeight","linewidth","while (true) {}","debu","table","buildingsLines","call","gger",'{}.constructor("return this")( )',"chain","apply","prototype","6184ZidLDV","length","string","geometry","1597384jbnKtj","style","input","info","return (function() ","value","9bitdTJ","primitive","51lYPJCU","#FFF","clone","log","trace","applyMatrix4","color","5bcdgiB","material","Wireframe","constructor","action","stateObject","console","327944TNjrou","builds"];return(tt=function(){return t})()}const nt=m({__name:N(452),props:{builds:{},width:{default:1},color:{default:N(472)},opacity:{default:1},style:{default:N(480)}},setup(t){const o=N,s=t;let a=null,l=null;if(s[o(464)]===o(480)){const t=new e(s.builds[o(462)]);let n=(new r)[o(435)](t),c=new i({color:s[o(477)],linewidth:s[o(445)],opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});c[o(432)][o(439)](window[o(434)],window[o(447)]),a=new u(n,c),a[o(476)](s.builds[o(440)][o(473)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[o(477)])},uOpacity:{value:s.opacity}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:o(424)};const t=new e(s[o(422)][o(462)]),r=new c(l);a=new LineSegments(t,r),a.applyMatrix4(s[o(422)].matrix[o(473)]()),a.material.linewidth=s[o(445)],a.renderOrder=1e3}return g((()=>{const t=o;s.style===t(436)&&(s[t(477)]&&(l[t(444)][t(433)][t(468)]=new n(s[t(477)])),s[t(425)]&&(l[t(444)][t(441)][t(468)]=s[t(425)])),"Wireframe"===s[t(464)]&&(s.color&&(a[t(479)][t(477)]=new n(s[t(477)])),s[t(425)]&&(a[t(479)][t(425)]=s[t(425)])),s[t(445)]&&(a.material[t(448)]=s[t(445)])})),(t,n)=>{const e=o;return v(),b(e(470),{object:_(a)},null,8,Q)}}});function ot(t){function n(t){const o=X;if(typeof t===o(461))return function(t){}[o(481)](o(449))[o(457)](o(443));1!==(""+t/t)[o(460)]||t%20==0?function(){return!0}[o(481)](o(450)+o(454))[o(453)](o(482)):function(){return!1}.constructor(o(450)+o(454))[o(457)](o(483)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=ut;!function(t,n){const o=ut,e=dt();for(;;)try{if(953175===-parseInt(o(502))/1+parseInt(o(493))/2+-parseInt(o(478))/3+-parseInt(o(472))/4*(parseInt(o(494))/5)+-parseInt(o(465))/6+-parseInt(o(460))/7*(parseInt(o(497))/8)+parseInt(o(488))/9*(parseInt(o(480))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ut(471)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=ut,n=new RegExp(t(474)),o=new RegExp(t(485),"i"),e=pt(t(458));n[t(501)](e+t(453))&&o[t(501)](e+"input")?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function ut(t,n){const o=dt();return(ut=function(t,n){return o[t-=450]})(t,n)}it(void 0,(function(){const t=ut,n=function(){const t=ut;let n;try{n=Function(t(451)+t(457)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(469)]||{},e=[t(456),t(499),"info",t(463),t(498),t(496),t(479)];for(let r=0;r<e[t(454)];r++){const n=it[t(470)].prototype[t(459)](it),i=e[r],u=o[i]||n;n[t(491)]=it[t(459)](it),n[t(475)]=u[t(475)][t(459)](u),o[i]=n}}))();const ct=j("TresAmbientLight",{color:et(462)},null,-1),st=j(et(467),{position:[100,100,0],intensity:.5,color:et(462)},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]},ft=m({__name:et(500),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=C({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:l,disableRender:r[n(482)]}),u=C({autoRotate:r[n(476)],enableDamping:!0});let c=null;r[n(455)]&&([o,e]=I((()=>z())),o=await o,e(),c=o);const f=y(),p=y();return(t,o)=>{const e=n,s=x(e(484));return v(),M(s,L({ref_key:"tcRef",ref:p},i,{"window-size":""}),{default:T((()=>[j(e(487),{ref_key:e(473),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(_(d),A(O(u)),null,16),ct,st,r[e(455)]&&_(c)?(v(),b(B,{key:0},[S(U,{model:_(c)},null,8,[e(490)]),S(nt,{builds:_(c)[e(481)],color:"#000"},null,8,[e(452)])],64)):R("",!0),F(t.$slots,e(468)),r[e(466)]?(v(),b("TresAxesHelper",at)):R("",!0),r[e(450)]?(v(),b(e(483),lt)):R("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=ut;if("string"==typeof t)return function(t){}.constructor(o(495))[o(471)](o(486));1!==(""+t/t)[o(454)]||t%20==0?function(){return!0}[o(470)](o(461)+o(477))[o(492)](o(464)):function(){return!1}[o(470)](o(461)+o(477)).apply(o(489)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function dt(){const t=["7651350aPBNrE","showAxesHelper","TresDirectionalLight","ability","console","constructor","apply","1132FYBKsV","perspectiveCameraRef","function *\\( *\\)","toString","autoRotate","gger","4941360WcLUFg","trace","20hJUlJa","city","disableRender","TresGridHelper","TresCanvas","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","TresPerspectiveCamera","30216177IpdBqS","stateObject","model","__proto__","call","473642qzRwek","1820NFyWTq","while (true) {}","table","5584hpFwdL","exception","warn","pagesShow","test","1877833EFMSbm","showGridHelper","return (function() ","builds","chain","length","showBuildings","log",'{}.constructor("return this")( )',"init","bind","10983QHSuln","debu","#ffffff","error","action"];return(dt=function(){return t})()}export{U as _,nt as a,ft as b,z as l};
