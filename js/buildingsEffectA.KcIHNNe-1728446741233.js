import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.WF5R5NTj1728446741233.js";import{U as o}from"./@tresjs.2zzrlbpQ1728446741233.js";import{C as e}from"./three-custom-shader-material.TfREIiYm1728446741233.js";import"./object-hash.0ofIFoz61728446741233.js";import{_ as r,a0 as i,C as u,cd as c,m as a,a$ as s}from"./three.GKtOCofD1728446741233.js";import"./@amap.Qg_J860p1728446741233.js";import"./glsl-tokenizer.3GIgb7Lk1728446741233.js";import{d as l,a3 as f,w as p,o as d,E as m,u as g,a4 as v,r as h,f as y,g as C,j as w,m as _}from"./@vue.JNsx1iN61728446741233.js";import{P as b}from"./tweakpane.yHWGBmom1728446741233.js";import"./@vueuse.M29bYW2K1728446741233.js";import"./glsl-token-string.OiBTr1Jd1728446741233.js";import"./glsl-token-functions.FTbn13l-1728446741233.js";import"./jszip.tq9nBV5m1728446741233.js";const x=M;function M(t,n){const o=T();return(M=function(t,n){return o[t-=171]})(t,n)}!function(t,n){const o=M,e=T();for(;;)try{if(369650===-parseInt(o(196))/1*(-parseInt(o(178))/2)+parseInt(o(227))/3+parseInt(o(186))/4+parseInt(o(177))/5+parseInt(o(198))/6+-parseInt(o(191))/7+-parseInt(o(219))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(226)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){S(this,(function(){const t=M,n=new RegExp(t(188)),o=new RegExp(t(205),"i"),e=P(t(184));n.test(e+t(229))&&o[t(175)](e+t(176))?P():e("0")}))()}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();I(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(214)+t(197)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(222)]||{},e=[t(182),"warn",t(195),t(237),t(173),"table",t(235)];for(let r=0;r<e[t(225)];r++){const n=I[t(221)].prototype[t(228)](I),i=e[r],u=o[i]||n;n[t(211)]=I.bind(I),n[t(224)]=u[t(224)][t(228)](u),o[i]=n}}))();const j=[x(192)];function T(){const t=["renderOrder","constructor","console","model","toString","length","apply","347853FeQzhE","bind","chain","children","uTime","MeshBasicMaterial","gger","clone","trace","string","error","#ffff00","value","exception","uniforms","test","input","2447845hupMQg","248CaXfrL","bModel","computeBoundingSphere","bulidingsColor","log","topColor","init","while (true) {}","1229116AtbCgI","opacity","function *\\( *\\)","counter","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","4499922wdccJJ","object","uOpacity","computeBoundingBox","info","1252YSJmWM",'{}.constructor("return this")( )',"4324296tZSsaV","#e523ff","debu","material","city","landColor","DoubleSide","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","dispose","color","forEach","gradient","land","__proto__","Color","isArray","return (function() ","setStyle","boundingBox","uGradient","__csm","6210136fdrsaa"];return(T=function(){return t})()}const F=l({__name:x(179),props:{model:{},bulidingsColor:{default:x(199)},landColor:{default:"#112233"},topColor:{default:x(171)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,u=t,c=u[n(223)][n(202)];u[n(223)][n(223)][n(230)][0][n(201)]=new(r[n(232)])({color:n(171)}),c[n(220)]=1001;const a=u[n(223)][n(210)];(()=>{const t=n,{geometry:o}=c;o[t(194)](),o[t(180)]();const{max:i,min:a}=o[t(216)];if(c[t(201)][t(218)])return;const s=new e({baseMaterial:c[t(201)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:t(190),silent:!0,uniforms:{uMax:{value:i},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(212)])(u[t(181)])},uOpacity:{value:u.opacity},uLightColor:{value:new(r[t(212)])("#ffffff")},uTopColor:{value:new(r[t(212)])(u[t(183)])},uTime:{value:0},uGradient:{value:u.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(204)]});c.material[t(206)](),c[t(201)]=s})();const{onLoop:s}=o();s((({delta:t})=>{const o=n;c[o(201)].uniforms[o(231)][o(172)]+=t})),f((()=>{const t=n;u[t(181)]&&c[t(201)].uniforms.uColor[t(172)][t(215)](u[t(181)]),u.landColor&&((t,o)=>{const e=n;let r;"cu"===t||"land"===t&&(r=Array[e(213)](a.material)?a[e(201)]:[a[e(201)]],r[e(208)]((t=>{const n=e;t[o][n(215)](u[n(203)]),t.side=i})))})("land",t(207)),u[t(187)]&&(c[t(201)][t(174)][t(193)][t(172)]=u[t(187)])})),p(u,((t,o)=>{const e=n;c.material[e(174)][e(217)][e(172)]=t[e(209)]}));const l=u[n(223)][n(223)][n(234)]();return(t,n)=>(d(),m("primitive",{object:g(l)},null,8,j))}});function P(t){function n(t){const o=M;if(typeof t===o(236))return function(t){}[o(221)](o(185))[o(226)](o(189));1!==(""+t/t)[o(225)]||t%20==0?function(){return!0}[o(221)](o(200)+"gger").call("action"):function(){return!1}[o(221)](o(200)+o(233))[o(226)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=z;!function(t,n){const o=z,e=A();for(;;)try{if(128477===-parseInt(o(282))/1+-parseInt(o(301))/2+parseInt(o(287))/3+parseInt(o(284))/4+parseInt(o(315))/5+-parseInt(o(327))/6+parseInt(o(326))/7)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(317)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function z(t,n){const o=A();return(z=function(t,n){return o[t-=281]})(t,n)}function A(){const t=["2285122blUSVi","706578cSKaHW","#FFF","bind","object","geometry","236012OzaHfb","action","369684kTamyV","builds","chain","510378GgRaHi","bLine","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","exception","prototype","constructor","scale","test","srcColor","uSrcColor","log","uniforms","string","material","245762KYfeWs","info","gger","debu","uTime","while (true) {}","value",'{}.constructor("return this")( )',"uScale","table","applyMatrix4","gradual","color","#000","80700LHHaMM","length","apply","console","function *\\( *\\)","clone","uColor","width","error","call","matrix"];return(A=function(){return t})()}!function(){B(this,(function(){const t=z,n=new RegExp(t(319)),o=new RegExp(t(289),"i"),e=H("init");n.test(e+t(286))&&o[t(294)](e+"input")?H():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(317)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();E(void 0,(function(){const t=z,n=function(){const t=z;let n;try{n=Function("return (function() "+t(308)+");")()}catch(o){n=window}return n}(),o=n[t(318)]=n.console||{},e=[t(297),"warn",t(302),t(323),t(290),t(310),"trace"];for(let r=0;r<e[t(316)];r++){const n=E[t(292)][t(291)].bind(E),i=e[r],u=o[i]||n;n.__proto__=E.bind(E),n.toString=u.toString[t(329)](u),o[i]=n}}))();const R=[O(330)],W=l({__name:O(288),props:{builds:{},color:{default:O(328)},srcColor:{default:O(314)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e.color)},uSrcColor:{value:new u(e.srcColor)},uScale:{value:e[n(293)]},uTime:{value:0},uGradual:{value:e[n(312)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(e[n(285)][n(281)])[n(320)]();l=l[n(311)](e[n(285)][n(325)]);const p=new a(i);r=new s(l,p),r[n(300)].linewidth=e[n(322)],r.renderOrder=1e3,f((()=>{const t=n;e[t(313)]&&(i[t(298)][t(321)].value=new u(e[t(313)])),e[t(295)]&&(i[t(298)][t(296)].value=new u(e[t(295)])),e.scale&&(i.uniforms[t(309)][t(307)]=e[t(293)]),e[t(312)]&&(i[t(298)].uGradual[t(307)]=e[t(312)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;i.uniforms[o(305)][o(307)]+=t*e.speed,i[o(298)][o(305)][o(307)]%=1})),(t,n)=>(d(),m("primitive",{object:g(r)},null,8,R))}});function H(t){function n(t){const o=z;if(typeof t===o(299))return function(t){}.constructor(o(306))[o(317)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(292)](o(304)+o(303))[o(324)](o(283)):function(){return!1}[o(292)](o(304)+o(303))[o(317)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=L;function L(t,n){const o=$();return(L=function(t,n){return o[t-=473]})(t,n)}!function(t,n){const o=L,e=$();for(;;)try{if(824099===-parseInt(o(495))/1+-parseInt(o(518))/2*(-parseInt(o(527))/3)+-parseInt(o(503))/4*(-parseInt(o(499))/5)+-parseInt(o(497))/6*(-parseInt(o(519))/7)+parseInt(o(506))/8+parseInt(o(523))/9*(-parseInt(o(484))/10)+parseInt(o(481))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=L,n=new RegExp(t(498)),o=new RegExp(t(500),"i"),e=Q(t(516));n[t(502)](e+t(524))&&o[t(502)](e+"input")?Q():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(512)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(){const t=["function *\\( *\\)","5FBApRW","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","test","838184FNqYWS","addBinding",'{}.constructor("return this")( )',"1716448bDjMyQ","builds","gradual","#000000","toString","scale","apply","#112233","exception","log","init","#000","20714cctoPw","656663amxHCD","city","action","#999","747FUQhWS","chain","model","buildingsEffectA","147iNBWqp","__proto__","bind","string","error","console","color","线原颜色","debu","8131926xRaMEi","table","info","16970pYLHci","srcColor","speed","return (function() ","warn","扩散系数","效果参数","call","constructor","gger","stateObject","799720cURbIa","#FFF","6qJnIFZ"];return($=function(){return t})()}k(void 0,(function(){const t=L;let n;try{n=Function(t(487)+t(505)+");")()}catch(r){n=window}const o=n[t(477)]=n[t(477)]||{},e=[t(515),t(488),t(483),t(476),t(514),t(482),"trace"];for(let i=0;i<e.length;i++){const n=k.constructor.prototype[t(474)](k),r=e[i],u=o[r]||n;n[t(473)]=k[t(474)](k),n[t(510)]=u.toString[t(474)](u),o[r]=n}}))();const D=l({__name:G(526),async setup(o){const e=G;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=h({color:e(496),srcColor:e(517),scale:2e3,gradual:6.6,speed:.3}),a=new b({title:e(490),expanded:!0});return a.addBinding(c,e(485),{label:e(479)}),a[e(504)](c,e(478),{label:"线扫颜色"}),a[e(504)](c,e(486),{label:"速度",min:.1,max:1,step:.1}),a[e(504)](c,e(511),{label:"最大扩散",min:10,max:2e3,step:10}),a[e(504)](c,e(508),{label:e(489),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return d(),y(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[w(F,{model:g(u),bulidingsColor:r(509),landColor:r(513),topColor:r(522)},null,8,[r(525)]),w(W,_({builds:g(u)[r(520)]},c),null,16,[r(507)])])),_:1})}}});function Q(t){function n(t){const o=L;if(typeof t===o(475))return function(t){}.constructor(o(501))[o(512)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(492)]("debu"+o(493))[o(491)](o(521)):function(){return!1}[o(492)](o(480)+o(493))[o(512)](o(494)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{D as default};
