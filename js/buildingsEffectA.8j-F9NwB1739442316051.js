import{P as t}from"./tweakpane.yDiyAAkA1739442316051.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.GIguzfce1739442316051.js";import{e}from"./@tresjs.4XV_x0mI1739442316051.js";import{z as r}from"./three-custom-shader-material.d7b09qIZ1739442316051.js";import{_ as i,C as u,cj as c,l as a,b9 as s}from"./three.OosFxi571739442316051.js";import{d as l,a2 as f,w as p,o as d,H as m,u as g,a3 as v,r as h,f as y,g as w,j as C,m as _}from"./@vue.NRI7TcgI1739442316051.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1739442316051.js";import"./@vueuse.u4XqlOuT1739442316051.js";function b(t,n){const o=j();return(b=function(t,n){return o[t-=419]})(t,n)}const x=b;!function(t,n){const o=b,e=j();for(;;)try{if(353222===parseInt(o(431))/1+-parseInt(o(487))/2+-parseInt(o(443))/3*(-parseInt(o(447))/4)+parseInt(o(472))/5*(parseInt(o(421))/6)+parseInt(o(457))/7*(-parseInt(o(441))/8)+parseInt(o(428))/9+parseInt(o(482))/10*(-parseInt(o(458))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[b(470)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=b,n=new RegExp(t(456)),o=new RegExp(t(442),"i"),e=O(t(419));n.test(e+"chain")&&o[t(467)](e+t(485))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[b(470)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=b,n=function(){const t=b;let n;try{n=Function(t(436)+t(449)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(445)]||{},e=["log",t(453),"info",t(423),"exception","table",t(438)];for(let r=0;r<e[t(477)];r++){const n=M[t(471)].prototype[t(463)](M),i=e[r],u=o[i]||n;n[t(455)]=M[t(463)](M),n.toString=u[t(433)][t(463)](u),o[i]=n}}))();const S=[x(454)];function j(){const t=["renderOrder","2942152FMXPMp","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","20343UaMgQW","landColor","console","stateObject","20BLZhhH","call",'{}.constructor("return this")( )',"side","city","MeshBasicMaterial","warn","object","__proto__","function *\\( *\\)","7HRprZi","651926vgApJJ","uniforms","#ffffff","land","bulidingsColor","bind","color","opacity","Color","test","children","bModel","apply","constructor","40zOPWWS","#112233","boundingBox","clone","__csm","length","gradient","computeBoundingBox","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","action","10QvKrmT","dispose","counter","input","material","913240ZeZfYT","init","DoubleSide","182490NQWkOR","isArray","error","debu","primitive","value","setStyle","3560409AZBzUq","#ffff00","model","564051uydKQV","topColor","toString","uGradient","forEach","return (function() ","uTime","trace","uOpacity"];return(j=function(){return t})()}const T=l({__name:x(469),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:x(473)},topColor:{default:x(429)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,u=o[n(430)][n(451)];o[n(430)][n(430)][n(468)][0][n(486)]=new(i[n(452)])({color:n(429)}),u[n(440)]=1001;const c=o.model[n(461)];(()=>{const t=n,{geometry:e}=u;e[t(479)](),e.computeBoundingSphere();const{max:c,min:a}=e[t(474)];if(u[t(486)][t(476)])return;const s=new r({baseMaterial:u[t(486)],vertexShader:t(480),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(466)])(o.bulidingsColor)},uOpacity:{value:o[t(465)]},uLightColor:{value:new(i[t(466)])(t(460))},uTopColor:{value:new(i[t(466)])(o[t(432)])},uTime:{value:0},uGradient:{value:o.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(420)]});u[t(486)][t(483)](),u[t(486)]=s})();const{onLoop:a}=e();a((({delta:t})=>{const o=n;u[o(486)][o(459)][o(437)][o(426)]+=t})),f((()=>{const t=n;o[t(462)]&&u.material[t(459)].uColor[t(426)][t(427)](o[t(462)]),o[t(444)]&&((t,e)=>{const r=n;let u;"cu"===t||"land"===t&&(u=Array[r(422)](c[r(486)])?c[r(486)]:[c[r(486)]],u[r(435)]((t=>{const n=r;t[e].setStyle(o.landColor),t[n(450)]=i[n(420)]})))})(t(461),t(464)),o[t(465)]&&(u[t(486)][t(459)][t(439)][t(426)]=o[t(465)])})),p(o,((t,o)=>{const e=n;u[e(486)][e(459)][e(434)].value=t[e(478)]}));const s=o.model[n(430)][n(475)]();return(t,o)=>{const e=n;return d(),m(e(425),{object:g(s)},null,8,S)}}});function O(t){function n(t){const o=b;if("string"==typeof t)return function(t){}.constructor("while (true) {}")[o(470)](o(484));1!==(""+t/t)[o(477)]||t%20==0?function(){return!0}.constructor(o(424)+"gger")[o(448)](o(481)):function(){return!1}.constructor(o(424)+"gger")[o(470)](o(446)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=B;function z(){const t=["length","test","error","constructor","uGradual","linewidth","375KgpxJX","502416cYOEJp","#000","uniforms","trace","2013561cgdKrr","gradual","exception","console","3770160ybyCui","12cZUgca","debu","bind","srcColor","apply","33045hzWzOf","stateObject","uTime","#FFF","prototype","renderOrder","678120GoAIpe","toString","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","return (function() ","material","log","table","12628YYYnlq","uSrcColor","action","uScale","430276mmHKZi","counter","primitive","function *\\( *\\)","value","chain","2MxjVgw","geometry","object","width","init","input","121BGdNCA","scale","clone","builds","warn","color","matrix","gger","64rzJduW","info","call",'{}.constructor("return this")( )',"string"];return(z=function(){return t})()}!function(t,n){const o=B,e=z();for(;;)try{if(439380===parseInt(o(413))/1*(parseInt(o(387))/2)+-parseInt(o(412))/3*(-parseInt(o(440))/4)+-parseInt(o(427))/5*(-parseInt(o(422))/6)+-parseInt(o(381))/7*(parseInt(o(401))/8)+-parseInt(o(417))/9+-parseInt(o(421))/10+parseInt(o(393))/11*(parseInt(o(433))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function B(t,n){const o=z();return(B=function(t,n){return o[t-=380]})(t,n)}!function(){A(this,(function(){const t=B,n=new RegExp(t(384)),o=new RegExp(t(435),"i"),e=W(t(391));n[t(407)](e+t(386))&&o[t(407)](e+t(392))?W():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[B(426)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=B,n=function(){const t=B;let n;try{n=Function(t(436)+t(404)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(420)]||{},e=[t(438),t(397),t(402),t(408),t(419),t(439),t(416)];for(let r=0;r<e[t(406)];r++){const n=Z[t(409)][t(431)][t(424)](Z),i=e[r],u=o[i]||n;n.__proto__=Z[t(424)](Z),n.toString=u[t(434)].bind(u),o[i]=n}}))();const F=[P(389)],G=l({__name:"bLine",props:{builds:{},color:{default:P(430)},srcColor:{default:P(414)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=P,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(398)])},uSrcColor:{value:new u(o[n(425)])},uScale:{value:o.scale},uTime:{value:0},uGradual:{value:o[n(418)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o.builds[n(388)])[n(395)]();l=l.applyMatrix4(o[n(396)][n(399)]);const p=new a(i);r=new s(l,p),r[n(437)][n(411)]=o[n(390)],r[n(432)]=1e3,f((()=>{const t=n;o[t(398)]&&(i[t(415)].uColor.value=new u(o.color)),o[t(425)]&&(i[t(415)][t(441)][t(385)]=new u(o[t(425)])),o[t(394)]&&(i[t(415)][t(380)][t(385)]=o[t(394)]),o.gradual&&(i.uniforms[t(410)][t(385)]=o[t(418)])}));const{onLoop:v}=e();return v((({delta:t})=>{const e=n;i[e(415)][e(429)][e(385)]+=t*o.speed,i.uniforms[e(429)][e(385)]%=1})),(t,o)=>{const e=n;return d(),m(e(383),{object:g(r)},null,8,F)}}});function W(t){function n(t){const o=B;if(typeof t===o(405))return function(t){}[o(409)]("while (true) {}")[o(426)](o(382));1!==(""+t/t)[o(406)]||t%20==0?function(){return!0}[o(409)](o(423)+o(400))[o(403)](o(442)):function(){return!1}[o(409)]("debu"+o(400))[o(426)](o(428)),n(++t)}try{if(t)return n;n(0)}catch(o){}}!function(t,n){const o=H,e=L();for(;;)try{if(452642===-parseInt(o(467))/1+-parseInt(o(473))/2*(-parseInt(o(447))/3)+-parseInt(o(477))/4*(parseInt(o(454))/5)+-parseInt(o(451))/6*(parseInt(o(453))/7)+-parseInt(o(484))/8+parseInt(o(457))/9*(-parseInt(o(485))/10)+parseInt(o(463))/11*(parseInt(o(483))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(t,n){const o=L();return(H=function(t,n){return o[t-=439]})(t,n)}!function(){E(this,(function(){const t=H,n=new RegExp(t(462)),o=new RegExp(t(444),"i"),e=K(t(489));n.test(e+t(439))&&o[t(468)](e+t(452))?K():e("0")}))()}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(481)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function L(){const t=["addBinding","chain","table","color","log","model","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","constructor","118296ZtzUwI","warn","#FFF","debu","12OMbYiB","input","1425123ymsUAs","53345IceCHg","bind","#999","6651TrTmFu","扩散系数","return (function() ","city","效果参数","function *\\( *\\)","4775177zgjKGw","counter","exception","线扫颜色","487608xvymao","test","#112233","gger","#000000","action","20vtVUil","stateObject","error","call","272PUuhjn","builds","prototype","srcColor","apply","toString","60WZcHTL","3616232ontGfi","540qjEqdf","info","最大扩散","线原颜色","init","speed","console"];return(L=function(){return t})()}R(void 0,(function(){const t=H,n=function(){const t=H;let n;try{n=Function(t(459)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(491)]=n[t(491)]||{},e=[t(442),t(448),t(486),t(475),t(465),t(440),"trace"];for(let r=0;r<e.length;r++){const n=R[t(446)][t(479)][t(455)](R),i=e[r],u=o[i]||n;n.__proto__=R[t(455)](R),n.toString=u[t(482)][t(455)](u),o[i]=n}}))();const U=l({__name:"buildingsEffectA",async setup(e){const r=H;let i,u;const c=([i,u]=v((()=>o())),i=await i,u(),i),a=h({color:r(449),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(461),expanded:!0});return s[r(492)](a,r(480),{label:r(488)}),s[r(492)](a,r(441),{label:r(466)}),s[r(492)](a,r(490),{label:"速度",min:.1,max:1,step:.1}),s[r(492)](a,"scale",{label:r(487),min:10,max:2e3,step:10}),s[r(492)](a,"gradual",{label:r(458),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(T,{model:g(c),bulidingsColor:e(471),landColor:e(469),topColor:e(456)},null,8,[e(443)]),C(G,_({builds:g(c)[e(460)]},a),null,16,[e(478)])])),_:1})}}});function K(t){function n(t){const o=H;if("string"==typeof t)return function(t){}[o(446)](o(445))[o(481)](o(464));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(450)+"gger")[o(476)](o(472)):function(){return!1}[o(446)](o(450)+o(470))[o(481)](o(474)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as default};
