import{a6 as t,C as n,cb as o,cc as e,cd as r,ce as i,k as u,bS as c,ab as s,ad as a}from"./three.ej3u8izI1722217438692.js";import{f as l,$ as f,d as p}from"./@tresjs.vs5lCFs11722217438692.js";import{C as d}from"./three-custom-shader-material.KBQJQbKq1722217438692.js";import"./object-hash.H_vbRcKd1722217438692.js";import"./@amap.FTf_Qzi31722217438692.js";import"./glsl-tokenizer.BRlB_-gZ1722217438692.js";import{d as h,b as m,a1 as y,w as g,o as w,D as v,u as b,r as _,a4 as C,e as I,f as x,g as M,J as T,j,aj as S,ak as A,F as B,I as O,G as R,m as D}from"./@vue.Q1VpS3901722217438692.js";function L(){const t=["info","bind","stateObject","728776ZbOoLR","ROADS","input",'{}.constructor("return this")( )',"function *\\( *\\)","chain","test","476KVXKjC","constructor","debu","1775QyRfRL","12Jbuhfj","728058ARygcb","warn","CITY_UNTRIANGULATED","LANDMASS","2533685hLFJZl","traverse","log","2304TlLSAx","error","while (true) {}","prototype","return (function() ","19930AexbdK","2353956RyozBo","toString","name","call","action","gger","__proto__","console","1100VDxieu","6140AtCVlt","init","string","apply","trace"];return(L=function(){return t})()}!function(t,n){const o=z,e=L();for(;;)try{if(496629===-parseInt(o(418))/1*(-parseInt(o(441))/2)+-parseInt(o(420))/3+-parseInt(o(457))/4*(parseInt(o(442))/5)+parseInt(o(419))/6*(-parseInt(o(424))/7)+-parseInt(o(450))/8+-parseInt(o(427))/9*(-parseInt(o(432))/10)+parseInt(o(433))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(445)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function z(t,n){const o=L();return(z=function(t,n){return o[t-=418]})(t,n)}!function(){Z(this,(function(){const t=z,n=new RegExp(t(454)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=H(t(443));n.test(e+t(455))&&o[t(456)](e+t(452))?H():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(445)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();k(void 0,(function(){const t=z,n=function(){const t=z;let n;try{n=Function(t(431)+t(453)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(440)]||{},e=[t(426),t(421),t(447),t(428),"exception","table",t(446)];for(let r=0;r<e.length;r++){const n=k.constructor[t(430)][t(448)](k),i=e[r],u=o[i]||n;n[t(439)]=k.bind(k),n[t(434)]=u[t(434)][t(448)](u),o[i]=n}}))();const F=async()=>{const t=z,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(425)]((n=>{const i=t;n[i(435)]===i(422)&&(o=n),n.name===i(423)&&(e=n),n[i(435)]===i(451)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function H(t){function n(t){const o=z;if(typeof t===o(444))return function(t){}[o(458)](o(429)).apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(459)+o(438))[o(436)](o(437)):function(){return!1}[o(458)](o(459)+o(438))[o(445)](o(449)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const E=V;!function(t,n){const o=V,e=$();for(;;)try{if(589106===-parseInt(o(285))/1*(-parseInt(o(297))/2)+parseInt(o(293))/3*(parseInt(o(269))/4)+parseInt(o(249))/5*(-parseInt(o(272))/6)+-parseInt(o(261))/7+parseInt(o(273))/8*(parseInt(o(274))/9)+-parseInt(o(290))/10*(parseInt(o(283))/11)+parseInt(o(304))/12*(parseInt(o(268))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(282)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){G(this,(function(){const t=V,n=new RegExp(t(287)),o=new RegExp(t(289),"i"),e=K(t(291));n[t(284)](e+t(257))&&o[t(284)](e+t(265))?K():e("0")}))()}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function V(t,n){const o=$();return(V=function(t,n){return o[t-=238]})(t,n)}P(void 0,(function(){const t=V,n=function(){const t=V;let n;try{n=Function(t(294)+t(302)+");")()}catch(o){n=window}return n}(),o=n[t(263)]=n.console||{},e=["log",t(278),t(270),t(301),"exception",t(238),t(250)];for(let r=0;r<e[t(246)];r++){const n=P.constructor[t(251)].bind(P),i=e[r],u=o[i]||n;n[t(247)]=P[t(243)](P),n[t(271)]=u.toString[t(243)](u),o[i]=n}}))();const W=[E(288)];function $(){const t=["info","toString","1237494ZjzyFD","113992NaHUJY","234DsuTZM","gradient","computeBoundingSphere","topColor","warn","primitive","value","color","apply","308gpAzOV","test","3106cBSCSj","opacity","function *\\( *\\)","object","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","179620bMoPdH","init","string","572997IhcVCV","return (function() ","debu","Color","80HygMvf","city","stateObject","renderOrder","error",'{}.constructor("return this")( )',"landColor","154848CgozZh","isArray","DoubleSide","__csm","table","uColor","model","forEach","#e523ff","bind","boundingBox","material","length","__proto__","land","5PhurOo","trace","prototype","constructor","clone","counter","bulidingsColor","uGradient","chain","gger","#ffff00","uniforms","5323269gFhZHd","setStyle","console","side","input","dispose","#112233","806DTqJRf","16bgZNDo"];return($=function(){return t})()}const J=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:E(242)},landColor:{default:E(267)},topColor:{default:E(259)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=E,r=o,i=m(0),u=r.model[e(298)];u[e(300)]=1001;const c=r[e(240)][e(248)];(()=>{const o=e,{geometry:c}=u;c.computeBoundingBox(),c[o(276)]();const{max:s,min:a}=c[o(244)];if(u[o(245)][o(307)])return;const l=new d({baseMaterial:u[o(245)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(296)])(r[o(255)])},uOpacity:{value:r[o(286)]},uLightColor:{value:new n("#ffffff")},uTopColor:{value:new(t[o(296)])(r[o(277)])},uTime:i,uGradient:{value:r[o(275)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(306)]});u.material[o(266)](),u[o(245)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(280)]+=t})),y((()=>{const n=e;r.bulidingsColor&&u.material[n(260)][n(239)][n(280)][n(262)](r[n(255)]),r[n(303)]&&((n,o)=>{const i=e;let u;"cu"===n||n===i(248)&&(u=Array[i(305)](c[i(245)])?c[i(245)]:[c.material],u[i(241)]((n=>{const e=i;n[o].setStyle(r.landColor),n[e(264)]=t[e(306)]})))})(n(248),n(281)),r.opacity&&(u[n(245)].uniforms.uOpacity.value=r[n(286)])})),g(r,((t,n)=>{const o=e;u[o(245)].uniforms[o(256)][o(280)]=t[o(275)]}));const a=r[e(240)][e(240)][e(253)]();return(t,n)=>{const o=e;return w(),v(o(279),{object:b(a)},null,8,W)}}});function K(t){function n(t){const o=V;if(typeof t===o(292))return function(t){}.constructor("while (true) {}")[o(282)](o(254));1!==(""+t/t)[o(246)]||t%20==0?function(){return!0}[o(252)](o(295)+o(258)).call("action"):function(){return!1}[o(252)](o(295)+o(258))[o(282)](o(299)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const N=q;!function(t,n){const o=q,e=X();for(;;)try{if(662661===parseInt(o(202))/1+parseInt(o(187))/2+parseInt(o(162))/3+-parseInt(o(199))/4*(-parseInt(o(211))/5)+-parseInt(o(210))/6+parseInt(o(213))/7*(parseInt(o(198))/8)+-parseInt(o(169))/9*(parseInt(o(157))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const U=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[q(192)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){U(this,(function(){const t=q,n=new RegExp(t(171)),o=new RegExp(t(205),"i"),e=nt(t(196));n[t(179)](e+t(208))&&o[t(179)](e+t(166))?nt():e("0")}))()}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[q(192)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function X(){const t=["constructor","action","applyMatrix4","47902hZYBzV","value","log","uniforms","string","apply","debu","buildingsLines","console","init"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","376BtyuMM","4sGhjhu","toString","material","461325ktNTUM","info","return (function() ","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","matrix","builds","chain","stateObject","4712682WLKkjn","5696245VbnfxD","gger","109039apofnm","__proto__","width","table","770gIeqBW","bind","primitive","renderOrder","Wireframe","215715QuStzB","clone","linewidth",'{}.constructor("return this")( )',"input","resolution","trace","114597jhMiog","warn","function *\\( *\\)","counter","opacity","exception","style","Shader","object","geometry","test","length","color","prototype","error"];return(X=function(){return t})()}Q(void 0,(function(){const t=q;let n;try{n=Function(t(204)+t(165)+");")()}catch(r){n=window}const o=n[t(195)]=n[t(195)]||{},e=[t(189),t(170),t(203),t(183),t(174),t(216),t(168)];for(let i=0;i<e[t(180)];i++){const n=Q[t(184)][t(182)][t(158)](Q),r=e[i],u=o[r]||n;n[t(214)]=Q.bind(Q),n.toString=u[t(200)][t(158)](u),o[r]=n}}))();const Y=[N(177)];function q(t,n){const o=X();return(q=function(t,n){return o[t-=157]})(t,n)}const tt=h({__name:N(194),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:N(161)}},setup(t){const c=N,s=t;let a=null,l=null;if(s[c(175)]===c(161)){const t=new o(s[c(207)][c(178)]);let n=(new e).fromEdgesGeometry(t),u=new r({color:s[c(181)],linewidth:s[c(215)],opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[c(167)].set(window.innerWidth,window.innerHeight),a=new i(n,u),a[c(186)](s[c(207)][c(206)][c(163)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(181)])},uOpacity:{value:s[c(173)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(197)};const t=new o(s[c(207)][c(178)]),e=new u(l);a=new LineSegments(t,e),a.applyMatrix4(s[c(207)][c(206)][c(163)]()),a[c(201)].linewidth=s[c(215)],a[c(160)]=1e3}return y((()=>{const t=c;s[t(175)]===t(176)&&(s[t(181)]&&(l[t(190)].uColor.value=new n(s[t(181)])),s[t(173)]&&(l[t(190)].uOpacity[t(188)]=s[t(173)])),s[t(175)]===t(161)&&(s[t(181)]&&(a[t(201)][t(181)]=new n(s[t(181)])),s[t(173)]&&(a[t(201)].opacity=s[t(173)])),s[t(215)]&&(a[t(201)][t(164)]=s[t(215)])})),(t,n)=>{const o=c;return w(),v(o(159),{object:b(a)},null,8,Y)}}});function nt(t){function n(t){const o=q;if(typeof t===o(191))return function(t){}.constructor("while (true) {}")[o(192)](o(172));1!==(""+t/t)[o(180)]||t%20==0?function(){return!0}[o(184)](o(193)+"gger").call(o(185)):function(){return!1}.constructor("debu"+o(212)).apply(o(209)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=rt;!function(t,n){const o=rt,e=it();for(;;)try{if(598669===parseInt(o(326))/1*(-parseInt(o(346))/2)+parseInt(o(370))/3+parseInt(o(344))/4*(-parseInt(o(334))/5)+-parseInt(o(353))/6+parseInt(o(356))/7+parseInt(o(345))/8+parseInt(o(343))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function rt(t,n){const o=it();return(rt=function(t,n){return o[t-=319]})(t,n)}function it(){const t=["toString","return (function() ","perspectiveCameraRef","2hypoBQ","debu","apply",'{}.constructor("return this")( )',"TresDirectionalLight","TresAmbientLight","prototype","init","25pZXVln","log","pagesShow","trace","TresAxesHelper","info","constructor","gger","table","18135918vucJsK","657224hgIKMI","822424ZvWxaf","894592BFdwkO","test","__proto__","autoRotate","showBuildings","#ffffff","exception","2482746liLDAt","builds","call","3875424TIdaix","#000000","tcRef","action","showAxesHelper","console","model","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","while (true) {}","warn","ability","disableRender","error","showGridHelper","171135IUFMfg","bind","TresPerspectiveCamera","TresGridHelper","length","counter"];return(it=function(){return t})()}!function(){et(this,(function(){const t=rt,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(363),"i"),e=pt(t(333));n[t(347)](e+"chain")&&o[t(347)](e+"input")?pt():e("0")}))()}();const ut=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[rt(328)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();ut(void 0,(function(){const t=rt,n=function(){const t=rt;let n;try{n=Function(t(324)+t(329)+");")()}catch(o){n=window}return n}(),o=n[t(361)]=n[t(361)]||{},e=[t(335),t(365),t(339),t(368),t(352),t(342),t(337)];for(let r=0;r<e[t(321)];r++){const n=ut[t(340)][t(332)][t(371)](ut),i=e[r],u=o[i]||n;n[t(348)]=ut[t(371)](ut),n[t(323)]=u[t(323)][t(371)](u),o[i]=n}}))();const ct=T(ot(331),{color:ot(351)},null,-1),st=T(ot(330),{position:[100,100,0],intensity:.5,color:ot(351)},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]},ft=h({__name:ot(336),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(357),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(367)]}),u=_({autoRotate:r[n(349)],enableDamping:!0});let l=null;r[n(350)]&&([o,e]=C((()=>F())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I("TresCanvas");return w(),x(c,D({ref_key:e(358),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(319),{ref_key:e(325),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),S(A(u)),null,16),ct,st,r.showBuildings&&b(l)?(w(),v(B,{key:0},[j(J,{model:b(l)},null,8,[e(362)]),j(tt,{builds:b(l).city,color:"#000"},null,8,[e(354)])],64)):O("",!0),R(t.$slots,e(366)),r[e(360)]?(w(),v(e(338),at)):O("",!0),r[e(369)]?(w(),v(e(320),lt)):O("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=rt;if("string"==typeof t)return function(t){}[o(340)](o(364))[o(328)](o(322));1!==(""+t/t)[o(321)]||t%20==0?function(){return!0}.constructor("debu"+o(341))[o(355)](o(359)):function(){return!1}.constructor(o(327)+o(341))[o(328)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{J as _,tt as a,ft as b,F as l};
