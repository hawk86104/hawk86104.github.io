import{_ as t,C as n,cc as o,cd as e,ce as r,cf as i,m as u,bU as c,ak as s,am as a}from"./three.3esZ7Hzr1726652192279.js";import{c as l,U as f,Y as p}from"./@tresjs.UGbbWZf51726652192279.js";import{C as d}from"./three-custom-shader-material.1UWxr2-p1726652192279.js";import"./object-hash.659hUnW-1726652192279.js";import"./@amap.-LPMSFvH1726652192279.js";import"./glsl-tokenizer.lP_hSvTG1726652192279.js";import{d as h,b as m,a3 as y,w as g,o as w,E as v,u as b,r as _,a4 as C,e as I,f as x,g as M,L as T,j,aj as A,ak as S,F as O,J as R,H as z,m as B}from"./@vue.JNsx1iN61726652192279.js";function E(t,n){const o=k();return(E=function(t,n){return o[t-=320]})(t,n)}!function(t,n){const o=E,e=k();for(;;)try{if(851496===-parseInt(o(350))/1*(parseInt(o(331))/2)+parseInt(o(333))/3+-parseInt(o(342))/4+parseInt(o(344))/5+-parseInt(o(348))/6*(-parseInt(o(341))/7)+-parseInt(o(322))/8*(parseInt(o(347))/9)+-parseInt(o(335))/10*(-parseInt(o(346))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(324)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){F(this,(function(){const t=E,n=new RegExp(t(343)),o=new RegExp(t(353),"i"),e=G("init");n.test(e+t(340))&&o.test(e+t(337))?G():e("0")}))()}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(324)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();H(void 0,(function(){const t=E;let n;try{n=Function("return (function() "+t(329)+");")()}catch(r){n=window}const o=n[t(339)]=n[t(339)]||{},e=[t(321),"warn",t(345),t(320),t(358),t(354),t(328)];for(let i=0;i<e[t(332)];i++){const n=H[t(326)][t(349)][t(325)](H),r=e[i],u=o[r]||n;n.__proto__=H[t(325)](H),n.toString=u[t(338)].bind(u),o[r]=n}}))();const L=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=E;t[r(356)]===r(355)&&(n=t),t[r(356)]===r(323)&&(o=t),"ROADS"===t[r(356)]&&(e=t)})),{model:t,city:n,land:o,roads:e}};function k(){const t=["138439TXXZBV","2600676xTpYvc","function *\\( *\\)","1355085QIaGhS","info","222871HJFuhN","117HqPySN","258OAWcoD","prototype","393lqlqCc","call","string","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","table","CITY_UNTRIANGULATED","name","debu","exception","error","log","675928UUhKae","LANDMASS","apply","bind","constructor","while (true) {}","trace",'{}.constructor("return this")( )',"gger","5918MlzBNA","length","326646obbZtR","stateObject","1250OQjaKV","action","input","toString","console","chain"];return(k=function(){return t})()}function G(t){function n(t){const o=E;if(typeof t===o(352))return function(t){}[o(326)](o(327))[o(324)]("counter");1!==(""+t/t)[o(332)]||t%20==0?function(){return!0}.constructor(o(357)+o(330))[o(351)](o(336)):function(){return!1}[o(326)](o(357)+o(330))[o(324)](o(334)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=Z;!function(t,n){const o=Z,e=W();for(;;)try{if(668414===-parseInt(o(365))/1*(parseInt(o(402))/2)+parseInt(o(363))/3*(-parseInt(o(405))/4)+parseInt(o(373))/5+-parseInt(o(372))/6+-parseInt(o(380))/7*(-parseInt(o(398))/8)+-parseInt(o(394))/9+-parseInt(o(352))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Z(375)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){P(this,(function(){const t=Z,n=new RegExp(t(388)),o=new RegExp(t(408),"i"),e=q("init");n[t(353)](e+t(386))&&o[t(353)](e+t(400))?q():e("0")}))()}();const U=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(t,n){const o=W();return(Z=function(t,n){return o[t-=350]})(t,n)}function W(){const t=["uOpacity","apply","counter","#e523ff","opacity","constructor","21yBxoPz","Color","object","land","call","action","chain","forEach","function *\\( *\\)","uniforms","gger","value","return (function() ","setStyle","1010952JUchZr","table","string","prototype","3335320pqzbzR","color","input","renderOrder","152670gFDoHP","#ffffff","city","8ckWCuB","bulidingsColor","material","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","buildingsModelCustomShader","DoubleSide","model","while (true) {}","trace","log","gradient","boundingBox","console","7549230YsYoVE","test","uColor","landColor","bind","uGradient","#112233","topColor","length","__proto__","__csm","134280HpqVAG","info","7UbVfMg","clone","computeBoundingBox","primitive",'{}.constructor("return this")( )',"toString","#ffff00","213564bKCjYi","4721895AlSdlJ"];return(W=function(){return t})()}U(void 0,(function(){const t=Z;let n;try{n=Function(t(392)+t(369)+");")()}catch(r){n=window}const o=n[t(351)]=n[t(351)]||{},e=[t(414),"warn",t(364),"error","exception",t(395),t(413)];for(let i=0;i<e.length;i++){const n=U[t(379)][t(397)].bind(U),r=e[i],u=o[r]||n;n[t(361)]=U[t(356)](U),n[t(370)]=u[t(370)][t(356)](u),o[r]=n}}))();const $=[D(382)],V=h({__name:D(409),props:{model:{},bulidingsColor:{default:D(377)},landColor:{default:D(358)},topColor:{default:D(371)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=D,r=o,i=m(0),u=r[e(411)][e(404)];u[e(401)]=1001;const c=r.model[e(383)];(()=>{const o=e,{geometry:c}=u;c[o(367)](),c.computeBoundingSphere();const{max:s,min:a}=c[o(350)];if(u[o(407)][o(362)])return;const l=new d({baseMaterial:u[o(407)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(381)])(r[o(406)])},uOpacity:{value:r[o(378)]},uLightColor:{value:new n(o(403))},uTopColor:{value:new(t[o(381)])(r[o(359)])},uTime:i,uGradient:{value:r[o(415)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(410)]});u[o(407)].dispose(),u[o(407)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(391)]+=t})),y((()=>{const n=e;r[n(406)]&&u[n(407)][n(389)][n(354)][n(391)][n(393)](r[n(406)]),r.landColor&&((n,o)=>{const i=e;let u;"cu"===n||n===i(383)&&(u=Array.isArray(c[i(407)])?c.material:[c.material],u[i(387)]((n=>{const e=i;n[o][e(393)](r[e(355)]),n.side=t[e(410)]})))})("land",n(399)),r[n(378)]&&(u.material[n(389)][n(374)].value=r[n(378)])})),g(r,((t,n)=>{const o=e;u[o(407)][o(389)][o(357)][o(391)]=t[o(415)]}));const a=r[e(411)][e(411)][e(366)]();return(t,n)=>{const o=e;return w(),v(o(368),{object:b(a)},null,8,$)}}});function q(t){function n(t){const o=Z;if(typeof t===o(396))return function(t){}[o(379)](o(412))[o(375)](o(376));1!==(""+t/t)[o(360)]||t%20==0?function(){return!0}[o(379)]("debugger")[o(384)](o(385)):function(){return!1}[o(379)]("debu"+o(390))[o(375)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Y=X;!function(t,n){const o=X,e=tt();for(;;)try{if(448217===parseInt(o(477))/1+-parseInt(o(505))/2+parseInt(o(478))/3*(parseInt(o(523))/4)+parseInt(o(498))/5+-parseInt(o(522))/6+-parseInt(o(472))/7+-parseInt(o(510))/8*(-parseInt(o(497))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const N=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(519)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){N(this,(function(){const t=X,n=new RegExp(t(521)),o=new RegExp(t(506),"i"),e=nt("init");n[t(485)](e+t(484))&&o[t(485)](e+t(471))?nt():e("0")}))()}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function X(t,n){const o=tt();return(X=function(t,n){return o[t-=467]})(t,n)}J(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function(t(499)+t(470)+");")()}catch(o){n=window}return n}(),o=n[t(489)]=n[t(489)]||{},e=[t(494),t(511),t(513),t(467),t(492),"table",t(512)];for(let r=0;r<e.length;r++){const n=J[t(514)].prototype[t(473)](J),i=e[r],u=o[i]||n;n[t(501)]=J[t(473)](J),n[t(503)]=u[t(503)][t(473)](u),o[i]=n}}))();const K=["object"],Q=h({__name:Y(468),props:{builds:{},width:{default:1},color:{default:Y(520)},opacity:{default:1},style:{default:Y(483)}},setup(t){const c=Y,s=t;let a=null,l=null;if("Wireframe"===s[c(479)]){const t=new o(s[c(515)].geometry);let n=(new e)[c(487)](t),u=new r({color:s[c(524)],linewidth:s[c(517)],opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[c(516)][c(490)](window[c(475)],window.innerHeight),a=new i(n,u),a[c(500)](s[c(515)][c(507)][c(469)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(524)])},uOpacity:{value:s[c(496)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(508)};const t=new o(s[c(515)][c(476)]),e=new u(l);a=new LineSegments(t,e),a[c(500)](s[c(515)].matrix[c(469)]()),a[c(480)][c(491)]=s[c(517)],a.renderOrder=1e3}return y((()=>{const t=c;"Shader"===s[t(479)]&&(s[t(524)]&&(l[t(481)][t(474)][t(509)]=new n(s[t(524)])),s[t(496)]&&(l.uniforms[t(518)][t(509)]=s[t(496)])),s.style===t(483)&&(s[t(524)]&&(a.material[t(524)]=new n(s.color)),s[t(496)]&&(a[t(480)][t(496)]=s[t(496)])),s[t(517)]&&(a[t(480)][t(491)]=s[t(517)])})),(t,n)=>(w(),v("primitive",{object:b(a)},null,8,K))}});function tt(){const t=["while (true) {}","opacity","9pIzUOr","2348490zViVJb","return (function() ","applyMatrix4","__proto__","string","toString","length","455800jAyMlO","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","matrix"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","value","1742920nIgEqD","warn","trace","info","constructor","builds","resolution","width","uOpacity","apply","#FFF","function *\\( *\\)","2527992zYGwrG","132380cCIXEx","color","error","buildingsLines","clone",'{}.constructor("return this")( )',"input","4209898hReovC","bind","uColor","innerWidth","geometry","647255zGqIbb","33LMusTe","style","material","uniforms","action","Wireframe","chain","test","call","fromEdgesGeometry","gger","console","set","linewidth","exception","debu","log"];return(tt=function(){return t})()}function nt(t){function n(t){const o=X;if(typeof t===o(502))return function(t){}.constructor(o(495)).apply("counter");1!==(""+t/t)[o(504)]||t%20==0?function(){return!0}[o(514)]("debu"+o(488))[o(486)](o(482)):function(){return!1}[o(514)](o(493)+"gger")[o(519)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=ut;!function(t,n){const o=ut,e=it();for(;;)try{if(301893===parseInt(o(267))/1+-parseInt(o(252))/2*(-parseInt(o(283))/3)+-parseInt(o(277))/4+-parseInt(o(280))/5+-parseInt(o(256))/6+-parseInt(o(270))/7*(-parseInt(o(282))/8)+-parseInt(o(253))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ut(260)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=ut,n=new RegExp(t(293)),o=new RegExp(t(254),"i"),e=pt("init");n[t(295)](e+t(298))&&o[t(295)](e+t(290))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(){const t=["disableRender","$slots","autoRotate","string","return (function() ","showBuildings","16062FIkrei","3323205EUXzbv","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","TresPerspectiveCamera","1108938gHnyxw","counter","ability","builds","apply","error","perspectiveCameraRef","TresAxesHelper","debu","call","warn","449473hrSvaA","exception","info","38577QiUNRM","TresAmbientLight","action","stateObject","toString","while (true) {}","constructor","1950356qFiuep","gger","bind","278735mwYxBs","prototype","656VeojFI","186LlaEzm","trace","TresCanvas","tcRef","#ffffff","showAxesHelper","showGridHelper","input","pagesShow",'{}.constructor("return this")( )',"function *\\( *\\)","log","test","length","TresGridHelper","chain","console","city","table"];return(it=function(){return t})()}function ut(t,n){const o=it();return(ut=function(t,n){return o[t-=246]})(t,n)}rt(void 0,(function(){const t=ut,n=function(){const t=ut;let n;try{n=Function(t(250)+t(292)+");")()}catch(o){n=window}return n}(),o=n[t(299)]=n[t(299)]||{},e=[t(294),t(266),t(269),t(261),t(268),t(301),t(284)];for(let r=0;r<e[t(296)];r++){const n=rt[t(276)][t(281)][t(279)](rt),i=e[r],u=o[i]||n;n.__proto__=rt.bind(rt),n[t(274)]=u[t(274)][t(279)](u),o[i]=n}}))();const ct=T(ot(271),{color:"#ffffff"},null,-1),st=T("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:ot(287)},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]},ft=h({__name:ot(291),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(246)]}),u=_({autoRotate:r[n(248)],enableDamping:!0});let l=null;r[n(251)]&&([o,e]=C((()=>L())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I(e(285));return w(),x(c,B({ref_key:e(286),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(255),{ref_key:e(262),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),A(S(u)),null,16),ct,st,r[e(251)]&&b(l)?(w(),v(O,{key:0},[j(V,{model:b(l)},null,8,["model"]),j(Q,{builds:b(l)[e(300)],color:"#000"},null,8,[e(259)])],64)):R("",!0),z(t[e(247)],e(258)),r[e(288)]?(w(),v(e(263),at)):R("",!0),r[e(289)]?(w(),v(e(297),lt)):R("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=ut;if(typeof t===o(249))return function(t){}.constructor(o(275))[o(260)](o(257));1!==(""+t/t)[o(296)]||t%20==0?function(){return!0}[o(276)](o(264)+"gger")[o(265)](o(272)):function(){return!1}[o(276)]("debu"+o(278))[o(260)](o(273)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as _,Q as a,ft as b,L as l};
