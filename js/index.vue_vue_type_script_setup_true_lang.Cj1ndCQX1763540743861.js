import{n as e,_ as a}from"./@tresjs.BCHtwiaC1763540743861.js";import{d as t,x as l,t as o,w as s,a6 as n,H as u,o as r,J as i,u as p}from"./@vue.Co_gxueH1763540743861.js";const v=["size","color","alpha-map","map","opacity","alpha-test","depth-write","transparent","size-attenuation"],f=["position","velocity"],d=t({__name:"index",props:{size:{default:.1},area:{default:()=>[10,10,20]},color:{default:16777215},map:{},alphaMap:{},alphaTest:{default:.01},opacity:{default:.8},count:{default:5e3},speed:{default:.1},randomness:{default:.5},depthWrite:{type:Boolean,default:!1},transparent:{type:Boolean,default:!0},sizeAttenuation:{type:Boolean,default:!0}},setup(t,{expose:d}){const c=t,{size:y,area:m,color:h,alphaMap:z,map:M,opacity:_,alphaTest:b,depthWrite:w,transparent:B,sizeAttenuation:T,count:x,speed:A,randomness:g}=l(c),j=o();let R=[],k=[];const F=()=>{R=new Float32Array(3*x.value);for(let e=0;e<x.value;e++){const a=3*e;R[a]=(Math.random()-.5)*m.value[0],R[a+1]=(Math.random()-.5)*m.value[1],R[a+2]=(Math.random()-.5)*m.value[2]}},P=()=>{k=new Float32Array(2*x.value);for(let e=0;e<2*x.value;e+=2)k[e]=(Math.random()-.5)/5*A.value*g.value,k[e+1]=Math.random()/5*A.value};P(),F(),s(A,()=>{P()}),n(()=>{A.value||F()}),s(()=>c.area,()=>{F()});const W=o(null),G=o(null);n(async()=>{if("string"==typeof z.value){const{state:a}=e(z.value);W.value=a.value}else W.value=z.value??null;if("string"==typeof M.value){const{state:a}=e(M.value);G.value=a.value}else G.value=M.value??null});const{onBeforeRender:H}=a();H(()=>{if(j.value?.attributes.position.array&&j.value?.attributes.position.count){const e=j.value.attributes.position.array;for(let a=0;a<j.value.attributes.position.count;a++){const t=k[2*a],l=k[2*a+1];e[3*a]+=t,e[3*a+1]-=l,(e[3*a]<=-m.value[0]/2||e[3*a]>=m.value[0]/2)&&(e[3*a]=-1*e[3*a]),(e[3*a+1]<=-m.value[1]/2||e[3*a+1]>=m.value[1]/2)&&(e[3*a+1]=-1*e[3*a+1])}j.value.attributes.position.needsUpdate=!0}});const J=o();return d({instance:J}),(e,a)=>(r(),u("TresPoints",{ref_key:"pointsRef",ref:J},[i("TresPointsMaterial",{size:p(y),color:p(h),"alpha-map":W.value,map:G.value,opacity:p(_),"alpha-test":p(b),"depth-write":p(w),transparent:p(B),"size-attenuation":p(T)},null,8,v),i("TresBufferGeometry",{ref_key:"geometryRef",ref:j,position:[p(R),3],velocity:[p(k)]},null,8,f)],512))}});export{d as _};
