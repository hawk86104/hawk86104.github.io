import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.JP4MOAqv1720750938663.js";import{r as o}from"./@tresjs.toBU36DO1720750938663.js";import{C as e}from"./three-custom-shader-material.vDIhSa4e1720750938663.js";import"./object-hash.uK40h2Gd1720750938663.js";import{Y as r,a5 as i,C as u,ca as c,k as s,a$ as a}from"./three.c_4mN3mZ1720750938663.js";import"./@amap.aVWyhucH1720750938663.js";import"./glsl-tokenizer.bTdSVbty1720750938663.js";import{d as l,a2 as f,w as p,o as d,D as m,u as g,a3 as v,r as y,f as h,g as w,j as C,m as _}from"./@vue.ApkyOKE71720750938663.js";import{P as b}from"./tweakpane.yHWGBmom1720750938663.js";import"./@vueuse.NiHn2U_k1720750938663.js";import"./glsl-token-string.Geqk9Ccy1720750938663.js";import"./glsl-token-functions.EGRZ6BGB1720750938663.js";import"./jszip.U0Bj1EHt1720750938663.js";const x=M;!function(t,n){const o=M,e=O();for(;;)try{if(789772===-parseInt(o(290))/1*(parseInt(o(284))/2)+parseInt(o(287))/3+parseInt(o(292))/4*(parseInt(o(261))/5)+-parseInt(o(269))/6+parseInt(o(297))/7*(parseInt(o(265))/8)+-parseInt(o(303))/9*(-parseInt(o(244))/10)+parseInt(o(301))/11*(parseInt(o(307))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(245)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(t,n){const o=O();return(M=function(t,n){return o[t-=239]})(t,n)}!function(){I(this,(function(){const t=M,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=P(t(251));n[t(263)](e+t(254))&&o.test(e+t(298))?P():e("0")}))()}();const j=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(245)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();j(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(276)+t(291)+");")()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=[t(266),t(300),t(305),t(257),t(293),t(252),t(299)];for(let r=0;r<e[t(309)];r++){const n=j.constructor[t(247)][t(310)](j),i=e[r],u=o[i]||n;n[t(256)]=j[t(310)](j),n[t(283)]=u[t(283)][t(310)](u),o[i]=n}}))();const S=[x(249)];function O(){const t=["784UwsAcC","input","trace","warn","88ExEeeO","model","486KPnzKo","DoubleSide","info","material","348204AFtrVj","setStyle","length","bind","counter","uColor","#ffffff","gger","action","uOpacity","14580OcHWzH","apply","opacity","prototype","#112233","object","string","init","table","land","chain","computeBoundingBox","__proto__","error","Color","gradient","stateObject","1862565SAUYUJ","__csm","test","landColor","11464QIqtVI","log","primitive","children","2759166IOUXJu","renderOrder","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","side","forEach","color","bModel","return (function() ","city","value","constructor","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","bulidingsColor","uTime","toString","88cHKoRY","isArray","call","3100986ESXyTW","#ffff00","boundingBox","31203ynyMUY",'{}.constructor("return this")( )',"12sxUmYl","exception","#e523ff","debu","uniforms"];return(O=function(){return t})()}const T=l({__name:x(275),props:{model:{},bulidingsColor:{default:x(294)},landColor:{default:x(248)},topColor:{default:x(288)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,u=t,c=u[n(302)][n(277)];u.model[n(302)][n(268)][0][n(306)]=new r({color:n(288)}),c[n(270)]=1001;const s=u.model[n(253)];(()=>{const t=n,{geometry:o}=c;o[t(255)](),o.computeBoundingSphere();const{max:r,min:s}=o[t(289)];if(c[t(306)][t(262)])return;const a=new e({baseMaterial:c.material,vertexShader:t(280),fragmentShader:t(271),silent:!0,uniforms:{uMax:{value:r},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(258)])(u.bulidingsColor)},uOpacity:{value:u[t(246)]},uLightColor:{value:new(i[t(258)])(t(240))},uTopColor:{value:new(i[t(258)])(u.topColor)},uTime:{value:0},uGradient:{value:u[t(259)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(304)]});c[t(306)].dispose(),c[t(306)]=a})();const{onLoop:a}=o();a((({delta:t})=>{const o=n;c[o(306)][o(296)][o(282)].value+=t})),f((()=>{const t=n;u[t(281)]&&c[t(306)][t(296)][t(239)][t(278)].setStyle(u[t(281)]),u[t(264)]&&((t,o)=>{const e=n;let r;"cu"===t||t===e(253)&&(r=Array[e(285)](s[e(306)])?s[e(306)]:[s[e(306)]],r[e(273)]((t=>{const n=e;t[o][n(308)](u[n(264)]),t[n(272)]=i[n(304)]})))})("land",t(274)),u[t(246)]&&(c.material[t(296)][t(243)][t(278)]=u[t(246)])})),p(u,((t,o)=>{const e=n;c[e(306)][e(296)].uGradient[e(278)]=t.gradient}));const l=u[n(302)][n(302)].clone();return(t,o)=>{const e=n;return d(),m(e(267),{object:g(l)},null,8,S)}}});function P(t){function n(t){const o=M;if(typeof t===o(250))return function(t){}.constructor("while (true) {}")[o(245)](o(311));1!==(""+t/t)[o(309)]||t%20==0?function(){return!0}[o(279)](o(295)+o(241))[o(286)](o(242)):function(){return!1}[o(279)]("debu"+o(241)).apply(o(260)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const E=A;!function(t,n){const o=A,e=R();for(;;)try{if(924384===parseInt(o(403))/1+parseInt(o(405))/2+-parseInt(o(398))/3*(parseInt(o(420))/4)+-parseInt(o(423))/5*(-parseInt(o(394))/6)+parseInt(o(425))/7*(parseInt(o(415))/8)+parseInt(o(419))/9*(parseInt(o(421))/10)+-parseInt(o(386))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(407)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=A,n=new RegExp(t(404)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=G(t(396));n[t(433)](e+t(411))&&o[t(433)](e+t(397))?G():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[A(407)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function A(t,n){const o=R();return(A=function(t,n){return o[t-=380]})(t,n)}z(void 0,(function(){const t=A,n=function(){const t=A;let n;try{n=Function(t(383)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(399)]=n[t(399)]||{},e=[t(408),t(416),t(417),t(382),t(387),t(385),"trace"];for(let r=0;r<e[t(400)];r++){const n=z[t(390)][t(438)][t(412)](z),i=e[r],u=o[i]||n;n[t(402)]=z[t(412)](z),n[t(388)]=u[t(388)][t(412)](u),o[i]=n}}))();const F=[E(391)];function R(){const t=["96HMhzoE","warn","info","gger","66618yXbXtq","68OrNcxm","2130IPyMEn","srcColor","649045OpNUQB","gradual","461881XWcbEd","linewidth","geometry","#000","#FFF","primitive","width","value","test","bLine","debu","uniforms","matrix","prototype","while (true) {}","uScale","error","return (function() ","string","table","32102873ppxnHm","exception","toString","uSrcColor","constructor","object","stateObject","scale","12iMffBx","uGradual","init","input","222036juYKIB","console","length","color","__proto__","1336981lSaXEP","function *\\( *\\)","2272020jypeYG","clone","apply","log","action","uTime","chain","bind","builds","counter"];return(R=function(){return t})()}const k=l({__name:E(434),props:{builds:{},color:{default:E(429)},srcColor:{default:E(428)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=E,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e[n(401)])},uSrcColor:{value:new u(e[n(422)])},uScale:{value:e[n(393)]},uTime:{value:0},uGradual:{value:e[n(424)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(e.builds[n(427)])[n(406)]();l=l.applyMatrix4(e[n(413)][n(437)]);const p=new s(i);r=new a(l,p),r.material[n(426)]=e[n(431)],r.renderOrder=1e3,f((()=>{const t=n;e[t(401)]&&(i.uniforms.uColor[t(432)]=new u(e.color)),e[t(422)]&&(i[t(436)][t(389)][t(432)]=new u(e[t(422)])),e[t(393)]&&(i[t(436)][t(381)][t(432)]=e[t(393)]),e[t(424)]&&(i[t(436)][t(395)][t(432)]=e[t(424)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;i[o(436)][o(410)][o(432)]+=t*e.speed,i[o(436)][o(410)][o(432)]%=1})),(t,o)=>{const e=n;return d(),m(e(430),{object:g(r)},null,8,F)}}});function G(t){function n(t){const o=A;if(typeof t===o(384))return function(t){}.constructor(o(380)).apply(o(414));1!==(""+t/t)[o(400)]||t%20==0?function(){return!0}[o(390)](o(435)+"gger").call(o(409)):function(){return!1}[o(390)](o(435)+o(418)).apply(o(392)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const U=X;function W(){const t=["toString","action","6BaORRJ","扩散系数","1083634nMREuW","while (true) {}","table","bind","speed","4025584SOlegQ","线原颜色","chain","#112233","function *\\( *\\)",'{}.constructor("return this")( )',"buildingsEffectA","apply","error","addBinding","739771sctsal","662886yqeTPn","#000000","#FFF","scale","prototype","length","counter","1192980sgeGQA","gger","info","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","stateObject","debu","trace","42voVYUy","#000","gradual","model","1749175MXWOOJ","log","效果参数","最大扩散","13049352LzEeXk","#999","__proto__","srcColor","init","city","input","constructor","return (function() "];return(W=function(){return t})()}!function(t,n){const o=X,e=W();for(;;)try{if(617673===parseInt(o(352))/1+-parseInt(o(388))/2*(parseInt(o(386))/3)+-parseInt(o(360))/4+-parseInt(o(371))/5+parseInt(o(353))/6*(parseInt(o(367))/7)+-parseInt(o(342))/8+parseInt(o(375))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(349)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function X(t,n){const o=W();return(X=function(t,n){return o[t-=339]})(t,n)}!function(){H(this,(function(){const t=X,n=new RegExp(t(346)),o=new RegExp(t(363),"i"),e=L(t(379));n.test(e+t(344))&&o.test(e+t(381))?L():e("0")}))()}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(349)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Y(void 0,(function(){const t=X;let n;try{n=Function(t(383)+t(347)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(372),"warn",t(362),t(350),"exception",t(339),t(366)];for(let i=0;i<e.length;i++){const n=Y[t(382)][t(357)].bind(Y),r=e[i],u=o[r]||n;n[t(377)]=Y.bind(Y),n[t(384)]=u[t(384)][t(340)](u),o[r]=n}}))();const $=l({__name:U(348),async setup(o){const e=U;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=y({color:e(355),srcColor:e(368),scale:2e3,gradual:6.6,speed:.3}),s=new b({title:e(373),expanded:!0});return s[e(351)](c,e(378),{label:e(343)}),s[e(351)](c,"color",{label:"线扫颜色"}),s.addBinding(c,e(341),{label:"速度",min:.1,max:1,step:.1}),s.addBinding(c,e(356),{label:e(374),min:10,max:2e3,step:10}),s[e(351)](c,e(369),{label:e(387),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return d(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(T,{model:g(u),bulidingsColor:r(354),landColor:r(345),topColor:r(376)},null,8,[r(370)]),C(k,_({builds:g(u)[r(380)]},c),null,16,["builds"])])),_:1})}}});function L(t){function n(t){const o=X;if("string"==typeof t)return function(t){}.constructor(o(389)).apply(o(359));1!==(""+t/t)[o(358)]||t%20==0?function(){return!0}[o(382)](o(365)+"gger").call(o(385)):function(){return!1}[o(382)](o(365)+o(361))[o(349)](o(364)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
