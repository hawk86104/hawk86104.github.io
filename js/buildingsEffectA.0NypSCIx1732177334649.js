import{P as t}from"./tweakpane.yHWGBmom1732177334649.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.chZ9ZCT41732177334649.js";import{e}from"./@tresjs.ty5XF8T_1732177334649.js";import{z as r}from"./three-custom-shader-material.O0AJb93d1732177334649.js";import{_ as i,C as u,a0 as c,cd as a,m as s,a$ as l}from"./three.rV-MfnQb1732177334649.js";import{d as f,a3 as p,w as d,o as m,D as v,u as g,a6 as h,r as y,f as w,g as C,j as _,m as b}from"./@vue.-THQH3GC1732177334649.js";import"./@vueuse.n223N0GC1732177334649.js";const x=M;!function(t,n){const o=M,e=T();for(;;)try{if(985367===-parseInt(o(234))/1*(parseInt(o(271))/2)+-parseInt(o(237))/3*(parseInt(o(208))/4)+-parseInt(o(228))/5+parseInt(o(200))/6*(-parseInt(o(227))/7)+-parseInt(o(203))/8*(parseInt(o(246))/9)+-parseInt(o(248))/10*(parseInt(o(239))/11)+-parseInt(o(257))/12*(-parseInt(o(211))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(238)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(t,n){const o=T();return(M=function(t,n){return o[t-=199]})(t,n)}!function(){I(this,(function(){const t=M,n=new RegExp(t(213)),o=new RegExp(t(272),"i"),e=P("init");n.test(e+t(268))&&o[t(224)](e+t(222))?P():e("0")}))()}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function T(){const t=["#ffff00","function *\\( *\\)","uGradient","land","MeshBasicMaterial","bulidingsColor","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","bind","color","DoubleSide","input","info","test","#e523ff","__csm","28jfXYwt","373365UbzDbo","bModel","value","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","gger","Color","628SrQCEw","side",'{}.constructor("return this")( )',"543NVJTTO","apply","144749qWpJoM","uTime","return (function() ","toString","debu","model","forEach","1452645LwlzvG","constructor","430cHcwuX","setStyle","computeBoundingSphere","topColor","trace","length","warn","log","__proto__","2855220eEQOtG","exception","material","counter","object","#ffffff","string","children","renderOrder","clone","landColor","chain","opacity","prototype","2246luZfct","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","isArray","2052078XTojyT","uOpacity","while (true) {}","8PSjqgT","gradient","#112233","console","stateObject","19848tMuFtS","dispose","uniforms","260ucQpfE"];return(T=function(){return t})()}S(void 0,(function(){const t=M;let n;try{n=Function(t(241)+t(236)+");")()}catch(r){n=window}const o=n[t(206)]=n[t(206)]||{},e=[t(255),t(254),t(223),"error",t(258),"table",t(252)];for(let i=0;i<e.length;i++){const n=S[t(247)][t(270)][t(219)](S),r=e[i],u=o[r]||n;n[t(256)]=S[t(219)](S),n[t(242)]=u.toString.bind(u),o[r]=n}}))();const j=[x(261)],O=f({__name:x(229),props:{model:{},bulidingsColor:{default:x(225)},landColor:{default:x(205)},topColor:{default:x(212)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,a=o[n(244)].city;o[n(244)].model[n(264)][0][n(259)]=new(i[n(216)])({color:n(212)}),a[n(265)]=1001;const s=o.model[n(215)];(()=>{const t=n,{geometry:e}=a;e.computeBoundingBox(),e[t(250)]();const{max:s,min:l}=e.boundingBox;if(a[t(259)][t(226)])return;const f=new r({baseMaterial:a[t(259)],vertexShader:t(231),fragmentShader:t(218),silent:!0,uniforms:{uMax:{value:s},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new u(o.bulidingsColor)},uOpacity:{value:o[t(269)]},uLightColor:{value:new u(t(262))},uTopColor:{value:new(i[t(233)])(o[t(251)])},uTime:{value:0},uGradient:{value:o[t(204)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:c});a.material[t(209)](),a[t(259)]=f})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;a.material[o(210)][o(240)][o(230)]+=t})),p((()=>{const t=n;o[t(217)]&&a[t(259)][t(210)].uColor[t(230)][t(249)](o[t(217)]),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(215)&&(u=Array[r(199)](s[r(259)])?s[r(259)]:[s[r(259)]],u[r(245)]((t=>{const n=r;t[e][n(249)](o[n(267)]),t[n(235)]=i[n(221)]})))})("land",t(220)),o[t(269)]&&(a[t(259)].uniforms[t(201)][t(230)]=o.opacity)})),d(o,((t,o)=>{const e=n;a[e(259)].uniforms[e(214)][e(230)]=t[e(204)]}));const f=o[n(244)][n(244)][n(266)]();return(t,n)=>(m(),v("primitive",{object:g(f)},null,8,j))}});function P(t){function n(t){const o=M;if(typeof t===o(263))return function(t){}[o(247)](o(202)).apply(o(260));1!==(""+t/t)[o(253)]||t%20==0?function(){return!0}.constructor(o(243)+o(232)).call("action"):function(){return!1}[o(247)](o(243)+"gger")[o(238)](o(207)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const B=G;!function(t,n){const o=G,e=A();for(;;)try{if(305200===parseInt(o(457))/1*(parseInt(o(458))/2)+-parseInt(o(499))/3*(-parseInt(o(470))/4)+-parseInt(o(485))/5*(-parseInt(o(475))/6)+parseInt(o(492))/7*(parseInt(o(500))/8)+parseInt(o(479))/9+parseInt(o(478))/10+-parseInt(o(496))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=G,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(489),"i"),e=Z(t(495));n.test(e+t(490))&&o[t(493)](e+t(471))?Z():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(462)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(t,n){const o=A();return(G=function(t,n){return o[t-=449]})(t,n)}function A(){const t=["248EVnyNH","1528saQKiR","applyMatrix4","length","matrix","apply","__proto__","toString","material","builds","bind","constructor","gger","100OIqiOr","input",'{}.constructor("return this")( )',"debu","error","1059972uAswrM","speed","renderOrder","420570yfkbJW","3812184MLLjQC","clone","while (true) {}","action","gradual","color","15mAuiuz","#FFF","console","primitive","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","string","7EWoesI","test","info","init","13723149jcrtci","bLine","uScale","16161nhSGwZ","1863944TLTdrl","uColor","scale","value","warn","uniforms","srcColor","uSrcColor","stateObject"];return(A=function(){return t})()}F(void 0,(function(){const t=G;let n;try{n=Function("return (function() "+t(472)+");")()}catch(r){n=window}const o=n[t(487)]=n[t(487)]||{},e=["log",t(452),t(494),t(474),"exception","table","trace"];for(let i=0;i<e[t(460)];i++){const n=F[t(468)].prototype.bind(F),r=e[i],u=o[r]||n;n[t(463)]=F.bind(F),n[t(464)]=u.toString[t(467)](u),o[r]=n}}))();const L=["object"],z=f({__name:B(497),props:{builds:{},color:{default:B(486)},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o.color)},uSrcColor:{value:new u(o[n(454)])},uScale:{value:o[n(450)]},uTime:{value:0},uGradual:{value:o[n(483)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let c=new a(o.builds.geometry)[n(480)]();c=c[n(459)](o[n(466)][n(461)]);const f=new s(i);r=new l(c,f),r[n(465)].linewidth=o.width,r[n(477)]=1e3,p((()=>{const t=n;o[t(484)]&&(i[t(453)][t(449)][t(451)]=new u(o[t(484)])),o.srcColor&&(i[t(453)][t(455)][t(451)]=new u(o[t(454)])),o.scale&&(i.uniforms[t(498)].value=o[t(450)]),o[t(483)]&&(i[t(453)].uGradual.value=o.gradual)}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i[e(453)].uTime[e(451)]+=t*o[e(476)],i.uniforms.uTime[e(451)]%=1})),(t,o)=>{const e=n;return m(),v(e(488),{object:g(r)},null,8,L)}}});function Z(t){function n(t){const o=G;if(typeof t===o(491))return function(t){}[o(468)](o(481)).apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}.constructor("debu"+o(469)).call(o(482)):function(){return!1}[o(468)](o(473)+o(469))[o(462)](o(456)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function R(t,n){const o=k();return(R=function(t,n){return o[t-=398]})(t,n)}const D=R;!function(t,n){const o=R,e=k();for(;;)try{if(224396===-parseInt(o(437))/1+-parseInt(o(419))/2+-parseInt(o(420))/3*(parseInt(o(399))/4)+parseInt(o(412))/5+-parseInt(o(400))/6+-parseInt(o(411))/7*(-parseInt(o(413))/8)+-parseInt(o(433))/9*(-parseInt(o(401))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(405)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){W(this,(function(){const t=R,n=new RegExp(t(409)),o=new RegExp(t(402),"i"),e=q(t(440));n[t(418)](e+t(403))&&o[t(418)](e+t(436))?q():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(405)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(){const t=["buildingsEffectA","__proto__","线扫颜色","4ZQMIWv","2014938lPaOnM","4381370hpmqMG","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","toString","apply","bind","counter","效果参数","function *\\( *\\)","constructor","154kpoPVc","1944910jLdboD","74728NlCycY","info","最大扩散","console","builds","test","310098tZpqmB","601449RPgGmu","call","gger","#999","#112233","string","log","#000000","debu","length","trace","addBinding","color","9trPIEy","warn","扩散系数","input","116870OLtogJ","error","speed","init","gradual","#FFF","action"];return(k=function(){return t})()}$(void 0,(function(){const t=R,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(416)]=n[t(416)]||{},e=[t(426),t(434),t(414),t(438),"exception","table",t(430)];for(let r=0;r<e[t(429)];r++){const n=$[t(410)].prototype[t(406)]($),i=e[r],u=o[i]||n;n[t(445)]=$[t(406)]($),n[t(404)]=u[t(404)].bind(u),o[i]=n}}))();const Q=f({__name:D(444),async setup(e){const r=D;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(442),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(408),expanded:!0});return s.addBinding(a,"srcColor",{label:"线原颜色"}),s[r(431)](a,r(432),{label:r(398)}),s.addBinding(a,r(439),{label:"速度",min:.1,max:1,step:.1}),s[r(431)](a,"scale",{label:r(415),min:10,max:2e3,step:10}),s[r(431)](a,r(441),{label:r(435),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[_(O,{model:g(c),bulidingsColor:e(427),landColor:e(424),topColor:e(423)},null,8,["model"]),_(z,b({builds:g(c).city},a),null,16,[e(417)])])),_:1})}}});function q(t){function n(t){const o=R;if(typeof t===o(425))return function(t){}[o(410)]("while (true) {}")[o(405)](o(407));1!==(""+t/t).length||t%20==0?function(){return!0}[o(410)](o(428)+o(422))[o(421)](o(443)):function(){return!1}[o(410)](o(428)+o(422)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Q as default};
