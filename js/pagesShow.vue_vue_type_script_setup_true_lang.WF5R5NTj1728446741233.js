import{_ as t,cd as n,ce as o,cf as e,cg as r,C as i,m as u,bU as c,ak as s,am as a}from"./three.GKtOCofD1728446741233.js";import{c as l,U as f,Y as p}from"./@tresjs.2zzrlbpQ1728446741233.js";import{C as d}from"./three-custom-shader-material.TfREIiYm1728446741233.js";import"./object-hash.0ofIFoz61728446741233.js";import"./@amap.Qg_J860p1728446741233.js";import"./glsl-tokenizer.3GIgb7Lk1728446741233.js";import{d as h,b as m,a3 as g,w as y,o as w,E as v,u as b,r as _,a4 as C,e as x,f as I,g as M,L as T,j,aj as S,ak as O,F as z,J as B,H as R,m as E}from"./@vue.JNsx1iN61728446741233.js";function A(){const t=["378238EkZWMx","action","gger","apply","453724OgbhTM","bind","error","debu","60qzVxXR","input","chain","stateObject","prototype","string","3xiBhOn","1744608uLWtTe","108852WfqrQw","counter","trace","toString","constructor","ROADS","length","198694auvzYB","call","1685960rhaEBx","LANDMASS",'{}.constructor("return this")( )',"return (function() ","name","3887500FIFsum","while (true) {}","__proto__","test","27pmBdiV"];return(A=function(){return t})()}!function(t,n){const o=k,e=A();for(;;)try{if(238020===-parseInt(o(267))/1+parseInt(o(251))/2*(-parseInt(o(242))/3)+-parseInt(o(243))/4+parseInt(o(271))/5*(parseInt(o(244))/6)+parseInt(o(263))/7+-parseInt(o(253))/8+-parseInt(o(262))/9*(-parseInt(o(258))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(266)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){L(this,(function(){const t=k,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=H("init");n.test(e+t(273))&&o[t(261)](e+t(272))?H():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(266)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(t,n){const o=A();return(k=function(t,n){return o[t-=241]})(t,n)}F(void 0,(function(){const t=k,n=function(){const t=k;let n;try{n=Function(t(256)+t(255)+");")()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=["log","warn","info",t(269),"exception","table",t(246)];for(let r=0;r<e[t(250)];r++){const n=F[t(248)][t(275)].bind(F),i=e[r],u=o[i]||n;n[t(260)]=F[t(268)](F),n[t(247)]=u.toString[t(268)](u),o[i]=n}}))();const G=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=k;"CITY_UNTRIANGULATED"===t[r(257)]&&(n=t),t.name===r(254)&&(o=t),t.name===r(249)&&(e=t)})),{model:t,city:n,land:o,roads:e}};function H(t){function n(t){const o=k;if(typeof t===o(241))return function(t){}[o(248)](o(259))[o(266)](o(245));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(270)+o(265))[o(252)](o(264)):function(){return!1}.constructor(o(270)+o(265))[o(266)](o(274)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=$;!function(t,n){const o=$,e=J();for(;;)try{if(702534===-parseInt(o(316))/1+parseInt(o(320))/2*(parseInt(o(321))/3)+parseInt(o(350))/4*(parseInt(o(314))/5)+parseInt(o(309))/6+-parseInt(o(324))/7+parseInt(o(356))/8*(-parseInt(o(358))/9)+parseInt(o(362))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(338)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){W(this,(function(){const t=$,n=new RegExp(t(355)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=X(t(341));n[t(357)](e+t(336))&&o.test(e+t(364))?X():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=$,n=function(){const t=$;let n;try{n=Function(t(359)+t(347)+");")()}catch(o){n=window}return n}(),o=n[t(346)]=n[t(346)]||{},e=[t(335),t(343),t(319),t(361),t(310),t(348),t(345)];for(let r=0;r<e[t(340)];r++){const n=Z[t(369)].prototype[t(318)](Z),i=e[r],u=o[i]||n;n.__proto__=Z[t(318)](Z),n[t(315)]=u[t(315)][t(318)](u),o[i]=n}}))();const P=[D(360)];function $(t,n){const o=J();return($=function(t,n){return o[t-=309]})(t,n)}const Y=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:D(311)},landColor:{default:"#112233"},topColor:{default:D(352)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=D,e=n,r=m(0),i=e[o(365)][o(334)];i[o(370)]=1001;const u=e[o(365)][o(366)];(()=>{const n=o,{geometry:u}=i;u[n(353)](),u[n(317)]();const{max:c,min:s}=u.boundingBox;if(i[n(368)].__csm)return;const a=new d({baseMaterial:i[n(368)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:c},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(327)])(e[n(328)])},uOpacity:{value:e[n(323)]},uLightColor:{value:new(t[n(327)])("#ffffff")},uTopColor:{value:new(t[n(327)])(e.topColor)},uTime:r,uGradient:{value:e[n(326)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(363)]});i[n(368)][n(337)](),i[n(368)]=a})();const{onLoop:c}=f();c((({delta:t})=>{r.value+=t})),g((()=>{const n=o;e[n(328)]&&i[n(368)].uniforms.uColor[n(339)][n(313)](e[n(328)]),e[n(312)]&&((n,r)=>{const i=o;let c;"cu"===n||n===i(366)&&(c=Array[i(367)](u.material)?u[i(368)]:[u[i(368)]],c[i(344)]((n=>{const o=i;n[r][o(313)](e[o(312)]),n[o(332)]=t[o(363)]})))})("land",n(349)),e[n(323)]&&(i[n(368)].uniforms.uOpacity[n(339)]=e[n(323)])})),y(e,((t,n)=>{const e=o;i[e(368)][e(351)][e(333)].value=t[e(326)]}));const s=e[o(365)][o(365)][o(342)]();return(t,n)=>(w(),v("primitive",{object:b(s)},null,8,P))}});function J(){const t=["6RmYTrX","1076709Kckbep","call","opacity","5645969zlzuHo","counter","gradient","Color","bulidingsColor","action","gger","debu","side","uGradient","city","log","chain","dispose","apply","value","length","init","clone","warn","forEach","trace","console",'{}.constructor("return this")( )',"table","color","44cEJCYF","uniforms","#ffff00","computeBoundingBox","while (true) {}","function *\\( *\\)","555224zzTXYe","test","171JzEYim","return (function() ","object","error","939860uUSEde","DoubleSide","input","model","land","isArray","material","constructor","renderOrder","6641748Ijpxgs","exception","#e523ff","landColor","setStyle","489090JibCIh","toString","525893COSGXL","computeBoundingSphere","bind","info"];return(J=function(){return t})()}function X(t){function n(t){const o=$;if("string"==typeof t)return function(t){}[o(369)](o(354))[o(338)](o(325));1!==(""+t/t)[o(340)]||t%20==0?function(){return!0}[o(369)]("debu"+o(330))[o(322)](o(329)):function(){return!1}[o(369)](o(331)+"gger")[o(338)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const U=q;function q(t,n){const o=N();return(q=function(t,n){return o[t-=433]})(t,n)}!function(t,n){const o=q,e=N();for(;;)try{if(268363===parseInt(o(484))/1*(parseInt(o(448))/2)+parseInt(o(445))/3*(parseInt(o(456))/4)+parseInt(o(483))/5+parseInt(o(460))/6+-parseInt(o(435))/7*(parseInt(o(476))/8)+parseInt(o(481))/9*(-parseInt(o(461))/10)+-parseInt(o(439))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const V=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){V(this,(function(){const t=q,n=new RegExp(t(433)),o=new RegExp(t(451),"i"),e=nt(t(465));n[t(440)](e+t(464))&&o[t(440)](e+"input")?nt():e("0")}))()}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[q(472)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();K(void 0,(function(){const t=q,n=function(){const t=q;let n;try{n=Function(t(486)+t(437)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(436)]||{},e=[t(459),t(470),t(455),t(475),t(447),t(449),"trace"];for(let r=0;r<e.length;r++){const n=K[t(478)][t(485)][t(489)](K),i=e[r],u=o[i]||n;n[t(442)]=K[t(489)](K),n.toString=u[t(471)].bind(u),o[i]=n}}))();const Q=[U(450)];function N(){const t=["warn","toString","apply","buildingsLines"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","error","24tngDJG","material","constructor","fromEdgesGeometry","matrix","63qzSinj","action","1019505uzSgaa","34905CjQyrO","prototype","return (function() ","set","clone","bind","geometry","counter","gger","function *\\( *\\)","resolution","720223vcVKfh","console",'{}.constructor("return this")( )',"string","1632147TBEcIW","test","while (true) {}","__proto__","length","debu","3lzdgJb","builds","exception","20YPMRLw","table","object","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","style","renderOrder","uOpacity","info","1266284qouZfd","applyMatrix4","width","log","1698738vXTRHh","610340GMjKXx","Wireframe","linewidth","chain","init","uniforms","color","primitive","opacity"];return(N=function(){return t})()}const tt=h({__name:U(473),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:U(462)}},setup(t){const c=U,s=t;let a=null,l=null;if(s[c(452)]===c(462)){const t=new n(s[c(446)][c(490)]);let i=(new o)[c(479)](t),u=new e({color:s[c(467)],linewidth:s[c(458)],opacity:s[c(469)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(434)][c(487)](window.innerWidth,window.innerHeight),a=new r(i,u),a[c(457)](s.builds[c(480)][c(488)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(s[c(467)])},uOpacity:{value:s[c(469)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(474)};const t=new n(s[c(446)].geometry),o=new u(l);a=new LineSegments(t,o),a[c(457)](s[c(446)][c(480)][c(488)]()),a[c(477)][c(463)]=s[c(458)],a[c(453)]=1e3}return g((()=>{const t=c;"Shader"===s[t(452)]&&(s[t(467)]&&(l[t(466)].uColor.value=new i(s.color)),s[t(469)]&&(l.uniforms[t(454)].value=s[t(469)])),s[t(452)]===t(462)&&(s[t(467)]&&(a.material[t(467)]=new i(s[t(467)])),s[t(469)]&&(a.material[t(469)]=s[t(469)])),s.width&&(a[t(477)].linewidth=s[t(458)])})),(t,n)=>{const o=c;return w(),v(o(468),{object:b(a)},null,8,Q)}}});function nt(t){function n(t){const o=q;if(typeof t===o(438))return function(t){}[o(478)](o(441))[o(472)](o(491));1!==(""+t/t)[o(443)]||t%20==0?function(){return!0}[o(478)](o(444)+o(492)).call(o(482)):function(){return!1}[o(478)](o(444)+o(492)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=lt;!function(t,n){const o=lt,e=at();for(;;)try{if(886800===-parseInt(o(144))/1+parseInt(o(152))/2+-parseInt(o(136))/3*(-parseInt(o(156))/4)+-parseInt(o(171))/5+parseInt(o(181))/6*(-parseInt(o(145))/7)+parseInt(o(158))/8*(parseInt(o(151))/9)+parseInt(o(140))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(185)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=lt,n=new RegExp(t(165)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=pt(t(182));n[t(186)](e+"chain")&&o.test(e+"input")?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(185)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=lt;let n;try{n=Function("return (function() "+t(170)+");")()}catch(r){n=window}const o=n.console=n[t(135)]||{},e=[t(176),t(147),t(149),t(150),"exception",t(188),t(169)];for(let i=0;i<e[t(164)];i++){const n=rt[t(172)][t(159)][t(180)](rt),r=e[i],u=o[r]||n;n[t(161)]=rt.bind(rt),n[t(189)]=u[t(189)][t(180)](u),o[r]=n}}))();const it=T(ot(157),{color:"#ffffff"},null,-1),ut=T(ot(174),{position:[100,100,0],intensity:.5,color:ot(187)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(){const t=["city","length","function *\\( *\\)","model","perspectiveCameraRef","showAxesHelper","trace",'{}.constructor("return this")( )',"4661265QnEMgC","constructor","TresPerspectiveCamera","TresDirectionalLight","pagesShow","log","showBuildings","call","builds","bind","618QzKDGC","init","while (true) {}","ability","apply","test","#ffffff","table","toString","tcRef","console","24iLUbFJ","debu","TresGridHelper","gger","5340060BTdJFF","#000","showGridHelper","string","392563ZxxUxE","106323swphLp","TresAxesHelper","warn","autoRotate","info","error","495bGvvjf","1628488tgVjqH","action","disableRender","stateObject","493664TYnwyX","TresAmbientLight","209528CvHgSb","prototype","$slots","__proto__","#000000"];return(at=function(){return t})()}function lt(t,n){const o=at();return(lt=function(t,n){return o[t-=134]})(t,n)}const ft=h({__name:ot(175),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(162),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(154)]}),u=_({autoRotate:r[n(148)],enableDamping:!0});let l=null;r[n(177)]&&([o,e]=C((()=>G())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=x("TresCanvas");return w(),I(c,E({ref_key:e(134),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(173),{ref_key:e(167),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),S(O(u)),null,16),it,ut,r[e(177)]&&b(l)?(w(),v(z,{key:0},[j(Y,{model:b(l)},null,8,[e(166)]),j(tt,{builds:b(l)[e(163)],color:e(141)},null,8,[e(179)])],64)):B("",!0),R(t[e(160)],e(184)),r[e(168)]?(w(),v(e(146),ct)):B("",!0),r[e(142)]?(w(),v(e(138),st)):B("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=lt;if(typeof t===o(143))return function(t){}.constructor(o(183)).apply("counter");1!==(""+t/t)[o(164)]||t%20==0?function(){return!0}.constructor(o(137)+o(139))[o(178)](o(153)):function(){return!1}[o(172)](o(137)+o(139)).apply(o(155)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Y as _,tt as a,ft as b,G as l};
