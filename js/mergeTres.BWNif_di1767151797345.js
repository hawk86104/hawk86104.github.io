import{importShared as e}from"./3d-tiles-renderer.BWkWgmMi1767151797345.js";import{AMapLoader as a}from"./index.DkbnvIn41767151797345.js";import{defineStore as t,_export_sfc as n,useTres as o}from"./index.DdZsEhdb1767151797345.js";const{shallowRef:l}=await e("vue"),r=t("mapStore",()=>({aMap:l(null),mapHandle:l(null),cameraState:l(null)})),{defineComponent:p}=await e("vue"),{openBlock:c,createElementBlock:m}=await e("vue"),s={id:"mapContainer"},{onMounted:u}=await e("vue"),d=n(p({__name:"mapContainer",props:{center:{default:[0,0]},zoom:{default:14},pitch:{default:50},mapStyle:{default:"normal"}},setup(e){const t=e,n=r();let o=null;return u(async()=>{await a.load({key:"0c7222955570f1b434c4adfcc1e955e8",version:"2.0"}).then(e=>{o=new e.Map("mapContainer",{center:t.center,zooms:[1,20],viewMode:"3D",zoom:t.zoom,pitch:t.pitch,mapStyle:"amap://styles/"+t.mapStyle}),o.on("click",e=>{const a=`您在 [ ${e.lnglat.getLng()},${e.lnglat.getLat()} ] 的位置单击了地图！`;console.log(a)}),n.$patch({aMap:e}),n.$patch({mapHandle:o})}).catch(e=>{console.log(e)})}),(e,a)=>(c(),m("div",s))}}),[["__scopeId","data-v-e1a7e2c4"]]),{watchEffect:i}=await e("vue"),v={__name:"mergeTres",props:{center:{default:[0,0]}},setup(e){const a=e,{camera:t,scene:n,renderer:l}=o(),p=r();let c=null,m=null;return i(()=>{p.aMap&&(c=p.mapHandle.customCoords,m=new p.aMap.CustomLayer(l.domElement,{zIndex:10,render:()=>{l.resetState(),c.setCenter(a.center);const{near:e,far:o,fov:r,up:m,lookAt:s,position:u}=c.getCameraParams();t.value.near=e,t.value.far=o,t.value.fov=r,p.$patch({cameraState:{near:e,far:o,fov:r,position:u}}),t.value.position.set(...u),t.value.up.set(...m),t.value.lookAt(...s),t.value.updateProjectionMatrix(),l.render(n.value,t.value),l.resetState()},alwaysRender:!0}),p.mapHandle.add(m))}),(e,a)=>null}};export{v as _sfc_main,d as mapContainer,r as useMapStore};
