import{A as e}from"./@amap.D8CfaEsq1763540743861.js";import"./axios.BTiLLHcy1763540743861.js";import{j as a}from"./global.BBGVMLjY1763540743861.js";import"./lodash.CybtBilg1763540743861.js";import{u as o}from"./useChartDataFetch.hook.DFkwif_P1763540743861.js";import"./echarts.1o70n-tX1763540743861.js";import{u as t}from"./chartEditStore.CHAh6jvI1763540743861.js";import{a as r}from"./config.B1lBmiTh1763540743861.js";import{d as l,x as s,a as i,w as p,H as n,o as u}from"./@vue.Co_gxueH1763540743861.js";const m=l({__name:"index",props:{chartConfig:{type:Object,required:!0}},setup(l){const m=l;let{amapKey:c,amapStyleKey:v,amapLon:d,amapLat:f,amapZindex:h,mapMarkerType:y,lang:w,amapStyleKeyCustom:C,features:g,viewMode:z,showLabel:M,pitch:j,skyColor:k,marker:x,satelliteTileLayer:L,roadNetTileLayer:b,trafficTileLayer:T}=s(m.chartConfig.option.mapOptions),_=null,R=[],S=null;const E=i(),I=a=>{e.load({key:c.value,version:"1.4.15",plugins:["AMap.PlaceSearch","AMap.AutoComplete"]}).then(e=>{S=e,_=new e.Map(E.value,{resizeEnable:!0,zoom:h.value,center:[d.value,f.value],lang:w.value,features:g.value,pitch:j.value,skyColor:k.value,viewMode:z.value,showLabel:M.value,willReadFrequently:!0}),A(m.chartConfig.option.dataset);let a=new e.TileLayer.Satellite({zIndex:L.value.zIndex,opacity:L.value.opacity,zooms:L.value.zooms}),o=new e.TileLayer.RoadNet({zIndex:b.value.zIndex,opacity:b.value.opacity,zooms:b.value.zooms}),t=new e.TileLayer.Traffic({zIndex:T.value.zIndex,opacity:T.value.opacity,zooms:T.value.zooms});_.remove([a,o,t]),L.value.show&&_.add([a]),b.value.show&&_.add([o]),T.value.show&&_.add([t]),_.setMapStyle(`amap://styles/${""!==C.value?C.value:v.value}`)}).catch(e=>{})},A=e=>{_||S?a(e.markers)&&(_.remove(R),R=[],y.value===r.MARKER?e.markers.forEach(e=>{const a=new S.Marker({position:[e.position[0],e.position[1]],offset:new S.Pixel(-13,-30)});R.push(a),a.setMap(_)}):y.value===r.CIRCLE_MARKER&&e.markers.forEach(e=>{const a=new S.CircleMarker({center:[e.position[0],e.position[1]],radius:e.value,...x.value});R.push(a),a.setMap(_)})):I(m.chartConfig.option)},K=p(()=>m.chartConfig.option.mapOptions,e=>{I()},{immediate:!0,deep:!0});return p(()=>m.chartConfig.option.dataset,e=>{try{A(e)}catch(a){console.log(a)}},{deep:!1}),o(m.chartConfig,t,e=>{K(),A(e)}),(e,a)=>(u(),n("div",{ref_key:"vChartRef",ref:E},null,512))}}),c=Object.freeze(Object.defineProperty({__proto__:null,default:m},Symbol.toStringTag,{value:"Module"}));export{c as _};
