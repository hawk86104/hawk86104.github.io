import{n as e,V as a,az as t,l as o,d2 as s,d0 as n,d1 as r,f as i,dp as l,du as m}from"./three.rXKzP9fQ1763540743861.js";import{F as d,r as c,c as p,_ as h}from"./@tresjs.BCHtwiaC1763540743861.js";import{g as u}from"./gsap.CY1N3EIL1763540743861.js";import{d as g,w,H as f,I as v,u as y,o as M}from"./@vue.Co_gxueH1763540743861.js";const P=["object"],_=g({__name:"hexagonalWall",props:{color:{default:"#7432B4"}},setup(g){const{renderer:_,scene:x,camera:z,sizes:j}=d(),I=g;let b=null;const{textures:B,isLoading:S}=c(["./plugins/floor/image/concrete_wet_floor_basecolor.jpg","./plugins/floor/image/metal_plate_diff_1k.jpg"]),{state:U}=p("https://opensource.cdn.icegl.cn/model/floor/baseModelI.glb",{draco:!0,decoderPath:"./draco/"});let k=null;w([U,B,S],([s,n,r])=>{s&&n&&!r&&(k=s.scene,k.traverse(s=>{if(s instanceof e){const e=s.position.clone(),r=20+30*Math.random(),i=Math.random()*Math.PI*2,l=20*(Math.random()-.5),m=new a(e.x+Math.cos(i)*r,e.y+l,e.z+Math.sin(i)*r);E.push({mesh:s,originalPosition:e,scatteredPosition:m}),s.position.copy(m),s.name.includes("_")?(n[0].wrapS=t,n[0].wrapT=t,n[0].repeat.set(10,10),s.material.map=B.map,s.material.needsUpdate=!0,s.material.emissive=new o("#7432B4"),s.material.emissiveIntensity=3.5):(n[1]&&(n[1].wrapS=t,n[1].wrapT=t,n[1].repeat.set(10,10),s.material.map=n[1]),s.material.color=new o("#7432B4"),s.material.metalness=.8,s.material.roughness=.2,s.material.envMapIntensity=2.5,s.material.needsUpdate=!0)}}),L(),H(),T())});const E=[],T=()=>{if(0===E.length)return;const e=u.timeline();E.forEach((a,t)=>{const o=.8*Math.random(),s={x:(Math.random()-.5)*Math.PI*2,y:(Math.random()-.5)*Math.PI*2,z:(Math.random()-.5)*Math.PI*2};a.mesh.rotation.set(s.x,s.y,s.z),e.to(a.mesh.position,{x:a.originalPosition.x,y:a.originalPosition.y,z:a.originalPosition.z,duration:3,ease:"power2.out",delay:o},0),e.to(a.mesh.rotation,{x:0,y:0,z:0,duration:3,ease:"power2.out",delay:o},0)}),e.call(()=>{F()}),console.log(`开始拼合动画，共 ${E.length} 个mesh`)},F=()=>{E.forEach((e,a)=>{u.to(e.mesh.position,{z:e.originalPosition.z+3+a/50,duration:2,repeat:-1,yoyo:!0,ease:"power1.inOut"})}),console.log("Z轴微动动画已启动")},H=()=>{if(!_||!z.value||!j.width.value)return;b=new s(_);const e=new n(x.value,z.value);b.addPass(e);const a=new r(new i(j.width.value,j.height.value),.6,.05,.25);b.addPass(a)},L=()=>{const a=new l(_),t=new m,o=a.fromScene(t).texture;x.value.environment=o,k.traverse(a=>{a instanceof e&&a.material&&(a.material.envMap=o,a.material.needsUpdate=!0)}),t.dispose()},{onRender:O}=h();return O(()=>{b&&b.render()}),w(()=>[I.color],([a])=>{k.traverse(t=>{t instanceof e&&t.material&&(t.material.color=new o(a),t.material.emissive=new o(a))})}),(e,a)=>y(U)?(M(),f("primitive",{key:0,object:y(U)?.scene,"position-y":.01},null,8,P)):v("",!0)}});export{_};
