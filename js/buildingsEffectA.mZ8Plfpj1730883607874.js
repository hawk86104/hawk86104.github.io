import{P as t}from"./tweakpane.BCjFYDHx1730883607874.js";import{l as n,b as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.BsjY64hW1730883607874.js";import{e}from"./@tresjs.C3WO4ZW41730883607874.js";import{z as r}from"./three-custom-shader-material.DD5mBNmu1730883607874.js";import{_ as i,C as u,ce as c,m as a,bb as s}from"./three.fIUcjaNz1730883607874.js";import{d as l,a3 as f,w as p,o as d,D as m,u as g,a6 as v,r as y,f as h,g as w,j as C,m as _}from"./@vue.Cfu43fwq1730883607874.js";import"./@vueuse.BSum2YDk1730883607874.js";const b=M;!function(t,n){const o=M,e=S();for(;;)try{if(109289===-parseInt(o(340))/1*(-parseInt(o(327))/2)+parseInt(o(348))/3+parseInt(o(332))/4+parseInt(o(303))/5+parseInt(o(355))/6+parseInt(o(358))/7+parseInt(o(317))/8*(-parseInt(o(336))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=M,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(352),"i"),e=O("init");n[t(306)](e+t(324))&&o[t(306)](e+t(350))?O():e("0")}))()}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(311)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(t,n){const o=S();return(M=function(t,n){return o[t-=290]})(t,n)}function S(){const t=["debu","while (true) {}","land","exception","chain","object","computeBoundingSphere","11558ftFiTj","toString","constructor","color","__csm","541060XNnJdH","trace","#112233","setStyle","7497WnnRvB","uColor","opacity","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","3gUyOxM","uniforms","table","prototype","bind","action","MeshBasicMaterial","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","281265qsJeLx","#ffff00","input","counter","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","Color","computeBoundingBox","693582bJxgiy","material","gger","419685iGNHKU","children","info",'{}.constructor("return this")( )',"city","boundingBox","string","error","length","gradient","isArray","call","topColor","dispose","606865sxlnSE","side","primitive","test","bulidingsColor","uGradient","DoubleSide","bModel","apply","console","model","value","uTime","__proto__","4168KXJJQp","return (function() ","landColor"];return(S=function(){return t})()}I(void 0,(function(){const t=M;let n;try{n=Function(t(318)+t(292)+");")()}catch(r){n=window}const o=n[t(312)]=n[t(312)]||{},e=["log","warn",t(291),t(296),t(323),t(342),t(333)];for(let i=0;i<e[t(297)];i++){const n=I.constructor[t(343)].bind(I),r=e[i],u=o[r]||n;n[t(316)]=I[t(344)](I),n[t(328)]=u[t(328)].bind(u),o[r]=n}}))();const T=[b(325)],j=l({__name:b(310),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:b(334)},topColor:{default:b(349)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,o=t,u=o[n(313)][n(293)];o[n(313)][n(313)][n(290)][0][n(356)]=new(i[n(346)])({color:n(349)}),u.renderOrder=1001;const c=o[n(313)].land;(()=>{const t=n,{geometry:e}=u;e[t(354)](),e[t(326)]();const{max:c,min:a}=e[t(294)];if(u[t(356)][t(331)])return;const s=new r({al:u[t(356)],vertexShader:t(339),fragmentShader:t(347),silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(353)])(o[t(307)])},uOpacity:{value:o.opacity},uLightColor:{value:new(i[t(353)])("#ffffff")},uTopColor:{value:new(i[t(353)])(o[t(301)])},uTime:{value:0},uGradient:{value:o[t(298)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(309)]});u[t(356)][t(302)](),u[t(356)]=s})();const{onLoop:a}=e();a((({delta:t})=>{const o=n;u.material[o(341)][o(315)][o(314)]+=t})),f((()=>{const t=n;o[t(307)]&&u[t(356)][t(341)][t(337)][t(314)].setStyle(o[t(307)]),o.landColor&&((t,e)=>{const r=n;let u;"cu"===t||t===r(322)&&(u=Array[r(299)](c[r(356)])?c.material:[c[r(356)]],u.forEach((t=>{const n=r;t[e][n(335)](o[n(319)]),t[n(304)]=i[n(309)]})))})(t(322),t(330)),o[t(338)]&&(u[t(356)][t(341)].uOpacity.value=o[t(338)])})),p(o,((t,o)=>{const e=n;u[e(356)].uniforms[e(308)][e(314)]=t.gradient}));const s=o[n(313)][n(313)].clone();return(t,o)=>{const e=n;return d(),m(e(305),{object:g(s)},null,8,T)}}});function O(t){function n(t){const o=M;if(typeof t===o(295))return function(t){}.constructor(o(321))[o(311)](o(351));1!==(""+t/t)[o(297)]||t%20==0?function(){return!0}[o(329)](o(320)+"gger")[o(300)](o(345)):function(){return!1}.constructor(o(320)+o(357)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function P(){const t=["info","geometry","debu","prototype","length","while (true) {}","58935uITxDe","builds","8645329iVNfxy","1215694nSlaqY","uniforms","function *\\( *\\)","string","__proto__","width","stateObject","constructor","#000","console","renderOrder","uGradual","log","value","trace","gger","#FFF","uSrcColor","scale","uScale","bLine","srcColor","gradual","clone","uColor","toString","color","linewidth","2054840MoZimy","apply","primitive","error","579881rgyrIu","2719135yUDQAi","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bind","exception","table","speed","object","input","164TDAnSM","counter","warn","chain","return (function() ","6yeJcpx",'{}.constructor("return this")( )',"call","33107958BCgkUp"];return(P=function(){return t})()}const A=E;!function(t,n){const o=E,e=P();for(;;)try{if(737414===-parseInt(o(313))/1+-parseInt(o(281))/2+-parseInt(o(278))/3*(parseInt(o(263))/4)+parseInt(o(314))/5*(parseInt(o(268))/6)+-parseInt(o(280))/7+-parseInt(o(309))/8+parseInt(o(271))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[E(310)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=E,n=new RegExp(t(283)),o=new RegExp(t(315),"i"),e=D("init");n.test(e+t(266))&&o.test(e+t(262))?D():e("0")}))()}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();F(void 0,(function(){const t=E,n=function(){const t=E;let n;try{n=Function(t(267)+t(269)+");")()}catch(o){n=window}return n}(),o=n[t(290)]=n.console||{},e=[t(293),t(265),t(272),t(312),t(258),t(259),t(295)];for(let r=0;r<e[t(276)];r++){const n=F[t(288)][t(275)][t(257)](F),i=e[r],u=o[i]||n;n[t(285)]=F[t(257)](F),n.toString=u[t(306)][t(257)](u),o[i]=n}}))();const Z=[A(261)];function E(t,n){const o=P();return(E=function(t,n){return o[t-=257]})(t,n)}const z=l({__name:A(301),props:{builds:{},color:{default:A(297)},srcColor:{default:A(289)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=A,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(o[n(307)])},uSrcColor:{value:new u(o[n(302)])},uScale:{value:o[n(299)]},uTime:{value:0},uGradual:{value:o.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(o[n(279)][n(273)])[n(304)]();l=l.applyMatrix4(o[n(279)].matrix);const p=new a(i);r=new s(l,p),r.material[n(308)]=o[n(286)],r[n(291)]=1e3,f((()=>{const t=n;o[t(307)]&&(i[t(282)][t(305)].value=new u(o[t(307)])),o[t(302)]&&(i[t(282)][t(298)][t(294)]=new u(o[t(302)])),o[t(299)]&&(i.uniforms[t(300)][t(294)]=o[t(299)]),o[t(303)]&&(i.uniforms[t(292)].value=o.gradual)}));const{onLoop:v}=e();return v((({delta:t})=>{const e=n;i[e(282)].uTime[e(294)]+=t*o[e(260)],i[e(282)].uTime[e(294)]%=1})),(t,o)=>{const e=n;return d(),m(e(311),{object:g(r)},null,8,Z)}}});function D(t){function n(t){const o=E;if(typeof t===o(284))return function(t){}.constructor(o(277))[o(310)](o(264));1!==(""+t/t).length||t%20==0?function(){return!0}[o(288)](o(274)+"gger")[o(270)]("action"):function(){return!1}[o(288)](o(274)+o(296))[o(310)](o(287)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=k;function R(){const t=["#000","效果参数","4656bBwbbO","7126UHhHwF","1004IxPNqQ","function *\\( *\\)","线原颜色","#112233","最大扩散","10058010ABudWO","buildingsEffectA","console","chain","714swMtuZ","model","debu","8570mZVOPA","length","return (function() ","srcColor","3447dzRflY","线扫颜色","info","exception","addBinding","constructor","gger","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#000000","log","apply","__proto__","init","bind","945322jZtaOC","63816291vAgZYm","toString","builds","#999","color","#FFF","trace","717XYECEx","扩散系数","action","error","stateObject","scale","while (true) {}","33105AFPNPh","string","counter"];return(R=function(){return t})()}!function(t,n){const o=k,e=R();for(;;)try{if(935263===-parseInt(o(455))/1+parseInt(o(476))/2*(-parseInt(o(463))/3)+parseInt(o(477))/4*(-parseInt(o(470))/5)+-parseInt(o(482))/6+-parseInt(o(433))/7*(parseInt(o(475))/8)+-parseInt(o(440))/9*(-parseInt(o(436))/10)+parseInt(o(456))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){H(this,(function(){const t=k,n=new RegExp(t(478)),o=new RegExp(t(448),"i"),e=W(t(453));n.test(e+t(432))&&o[t(447)](e+"input")?W():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(451)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function k(t,n){const o=R();return(k=function(t,n){return o[t-=432]})(t,n)}L(void 0,(function(){const t=k,n=function(){const t=k;let n;try{n=Function(t(438)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(484)]=n[t(484)]||{},e=[t(450),"warn",t(442),t(466),t(443),"table",t(462)];for(let r=0;r<e[t(437)];r++){const n=L[t(445)].prototype[t(454)](L),i=e[r],u=o[i]||n;n[t(452)]=L.bind(L),n[t(457)]=u[t(457)][t(454)](u),o[i]=n}}))();const J=l({__name:G(483),async setup(e){const r=G;let i,u;const c=([i,u]=v((()=>n())),i=await i,u(),i),a=y({color:r(461),srcColor:r(473),scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(474),expanded:!0});return s[r(444)](a,r(439),{label:r(479)}),s[r(444)](a,r(460),{label:r(441)}),s[r(444)](a,"speed",{label:"速度",min:.1,max:1,step:.1}),s[r(444)](a,r(468),{label:r(481),min:10,max:2e3,step:10}),s.addBinding(a,"gradual",{label:r(464),min:1.1,max:10,step:.1}),(t,n)=>{const e=r;return d(),h(o,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[C(j,{model:g(c),bulidingsColor:e(449),landColor:e(480),topColor:e(459)},null,8,[e(434)]),C(z,_({builds:g(c).city},a),null,16,[e(458)])])),_:1})}}});function W(t){function n(t){const o=k;if(typeof t===o(471))return function(t){}[o(445)](o(469))[o(451)](o(472));1!==(""+t/t)[o(437)]||t%20==0?function(){return!0}[o(445)](o(435)+o(446)).call(o(465)):function(){return!1}[o(445)](o(435)+o(446))[o(451)](o(467)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{J as default};
