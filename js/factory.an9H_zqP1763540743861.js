import{F as e}from"./@tresjs.BCHtwiaC1763540743861.js";import{i as t}from"./index.Crdf3MNx1763540743861.js";import{g as o}from"./gsap.CY1N3EIL1763540743861.js";import{l as s,cU as i,B as a,V as r,G as n,ac as c,u as l,n as m,aw as p,ax as d}from"./three.rXKzP9fQ1763540743861.js";import{b as j,o as f,e as h,J as u,u as g,ad as y}from"./@vue.Co_gxueH1763540743861.js";import"./postprocessing.51l5tmA-1763540743861.js";import"./@vueuse.CfFJ-iFV1763540743861.js";import"./@fesjs.BEMFm_yJ1763540743861.js";import"./vue-router.BxG8XxK11763540743861.js";import"./lodash-es.B7GkVYRo1763540743861.js";import"./pinia.CEQ6XgE61763540743861.js";import"./@qlin.y-0Z8WnK1763540743861.js";import"./@babel.BPq7uOAK1763540743861.js";import"./@floating-ui.Bhq4ibgf1763540743861.js";import"./@juggle.Vc7cP4_P1763540743861.js";import"./chalk.BHLFMujs1763540743861.js";/* empty css                                 */import"./iconify-icon.1JyQPtAK1763540743861.js";import"./@iconify.DDuAktjw1763540743861.js";import"./vite-plugin-qiankun.B06WoCqG1763540743861.js";import"./dompurify.C4MEnGDh1763540743861.js";import"./oimophysics.CfVKSiAm1763540743861.js";import"./three-stdlib.DJsODJ8R1763540743861.js";import"./@pmndrs.C5SFDEDA1763540743861.js";import"./object-hash.DlZNhpf61763540743861.js";import"./@amap.D8CfaEsq1763540743861.js";import"./crypto-js.CLP5yTup1763540743861.js";import"./naive-ui.qjPOP62h1763540743861.js";import"./date-fns.eh-WGDI81763540743861.js";import"./@css-render.DtSd-BuN1763540743861.js";import"./css-render.Dlx27V_T1763540743861.js";import"./@emotion.DFFAhID71763540743861.js";import"./seemly.D2hUckm91763540743861.js";import"./vooks.CVMU_ROE1763540743861.js";import"./evtd.C4K_ichY1763540743861.js";import"./vueuc.CEvnhvIm1763540743861.js";import"./vdirs.DlTVi7SG1763540743861.js";import"./treemate.Qc8YxXqZ1763540743861.js";import"./date-fns-tz.CIz1xaH61763540743861.js";import"./async-validator.DJtlKCAR1763540743861.js";import"./tweakpane.CqZAnw7f1763540743861.js";function w(e,t,j,f={}){return e?.name!==t?null:function(e,t,j={}){let{coneHeight:f=5,coneRadius:h=3.5,coneColor:u="#60a5fa",labelFont:g='bold 32px "Microsoft YaHei", sans-serif',labelBg:y="rgba(7, 9, 15, 0.9)",labelColor:w="#e5e7eb",type:v="success"}=j;"warning"==j.type?(w="#000",y="rgba(251, 146, 60, 0.9)",u="#f59e0b",e.material.color=new s(u)):"error"==j.type&&(w="#000",y="rgba(239, 68, 68, 0.9)",u="#ef4444",e.material.color=new s(u));const x=e.getObjectByName("mesh-marker");if(x){const e=x.children.find(e=>e.isSprite);if(e&&e.material.map instanceof i){const o=e.material.map,s=o.image,i=s.getContext("2d");i.clearRect(0,0,s.width,s.height);const a=16,r=s.width,n=s.height;i.fillStyle=y,b(i,4,4,r-8,n-8,a),i.fill(),i.font=g,i.fillStyle=w,i.textAlign="center",i.textBaseline="middle",i.fillText(t,r/2,n/2),o.needsUpdate=!0}return x}e.updateWorldMatrix(!0,!0);const S=(new a).setFromObject(e),T=new r;S.getCenter(T);const k=S.max.y,O=new n;O.name="mesh-marker";const _=new c(h,f,3),B=new l({color:u,emissive:new s(u),emissiveIntensity:.35}),M=new m(_,B);M.castShadow=!0,M.receiveShadow=!1,M.rotation.x=Math.PI,M.position.copy(new r(T.x,T.y,T.z));const C=document.createElement("canvas");C.width=512,C.height=128;const I=C.getContext("2d");I.clearRect(0,0,C.width,C.height);const z=C.width,A=C.height;I.fillStyle=y,b(I,4,4,z-8,A-8,16),I.fill(),I.font=g,I.fillStyle=w,I.textAlign="center",I.textBaseline="middle",I.fillText(t,z/2,A/2);const F=new i(C);F.anisotropy=4,F.needsUpdate=!0;const P=new p({map:F,transparent:!0}),U=new d(P),E=6.5*C.height/C.width;U.scale.set(6.5,E,1),U.position.copy(new r(T.x,T.y+5,T.z)),O.add(M),O.add(U);const H=new r(T.x,k+.6*f,T.z),R=e.worldToLocal(H.clone());return O.position.copy(R),O.parent||e.add(O),o.to(M.rotation,{y:M.rotation.y+2*Math.PI,duration:10,ease:"none",repeat:-1}),O}(e,j,f)}function b(e,t,o,s,i,a){const r=Math.min(a,s/2,i/2);e.beginPath(),e.moveTo(t+r,o),e.arcTo(t+s,o,t+s,o+i,r),e.arcTo(t+s,o+i,t,o+i,r),e.arcTo(t,o+i,t,o,r),e.arcTo(t,o,t+s,o,r),e.closePath()}const v=["object"],x={__name:"factory",props:{darkModel:{type:Boolean,default:!1}},setup(o){const{scene:s}=e();console.log(t);const{scene:i,nodes:a,materials:r}=t.getItem("factory.glb");return i&&i.traverse(e=>{if(e instanceof m){let t=w(e,"Object_30","设备故障...",{type:"warning"}),o=w(e,"Object_46","正在作业...",{type:"success"}),i=w(e,"Object_72","停止作业...",{type:"error"});t&&s.value.add(t),o&&s.value.add(o),i&&s.value.add(i),e.castShadow=!0,e.receiveShadow=!0;const a=e.material,r=e=>{e&&("metalness"in e&&(e.metalness=1),"roughness"in e&&(e.roughness=.2),e.needsUpdate=!0)};Array.isArray(a)?a.forEach(r):r(a)}}),(e,t)=>(f(),j(y,null,{default:h(()=>[u("primitive",{object:g(i),scale:7,position:[-50,-45,-60]},null,8,v)]),_:1}))}};export{x as default};
