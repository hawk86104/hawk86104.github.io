import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as t,_ as a,r as n,N as o,q as r,n as i,z as l}from"./@tresjs.B1f7s3pS1767066396612.js";import{u as s,h as p}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.DS9PWjZT1767066396612.js";import"./index.vue_vue_type_script_setup_true_lang.iYOGhvYh1767066396612.js";import{F as c,C as u}from"./three-stdlib.Clo1XHat1767066396612.js";import{i as m}from"./Resource.BqPJptsT1767066396612.js";import{E as d,f,U as v,at as h,a5 as w}from"./three.BD1hRFgo1767066396612.js";import{g}from"./gsap.CY1N3EIL1767066396612.js";import{B as x,Q as y}from"./three.quarks.CFGwYRX_1767066396612.js";import{C as S,a as P}from"./quarks.core.C3xH0YPO1767066396612.js";const{UniformsUtils:M,Vector2:b}=await e("three");function _(e){const t={...e};return"defines"in e&&(t.defines={...e.defines}),"uniforms"in e&&(t.uniforms=M.clone(e.uniforms)),t}const z={defines:{X_IS_EVEN:1,Y_IS_EVEN:1},uniforms:{map:{value:null},originalMapSize:{value:new b},parentMapSize:{value:new b},parentLevel:{value:0}},vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\n\t\t\t#include <begin_vertex>\n\t\t\t#include <project_vertex>\n\t\t\tvUv = uv;\n\n\t\t}\n\t",fragmentShader:'\n\t\tvarying vec2 vUv;\n\t\tuniform sampler2D map;\n\t\tuniform int parentLevel;\n\t\tuniform vec2 parentMapSize;\n\t\tuniform vec2 originalMapSize;\n\n\t\t\n\n\t// Without original size argument for power of two targets\n\tvec4 packedTexture2DLOD( sampler2D tex, vec2 uv, int level ) {\n\n\t\t// the fraction of the uv space used by the target mip\n\t\tfloat targetSubview = 1.0 / pow( 2.0, float( level ) );\n\t\tfloat widthRatio = 2.0 / 3.0;\n\t\tvec2 scaledDimensions = vec2( targetSubview * widthRatio, targetSubview );\n\n\t\t// all levels > 0 are on the right third of the texture\n\t\t// y is offset from the bottom\n\t\tvec2 offset = vec2(\n\t\t\tlevel > 0 ? widthRatio : 0.0,\n\t\t\tlevel > 0 ? targetSubview : 0.0\n\t\t);\n\n\t\tvec2 samplePoint = mix( offset, offset + scaledDimensions, uv );\n\t\treturn texture2D( tex, samplePoint );\n\n\t}\n\n\tvec4 packedTexture2DLOD( sampler2D tex, vec2 uv, float level ) {\n\n\t\tfloat ratio = mod( level, 1.0 );\n\t\tint minLevel = int( floor( level ) );\n\t\tint maxLevel = int( ceil( level ) );\n\n\t\tvec4 minValue = packedTexture2DLOD( tex, uv, minLevel );\n\t\tvec4 maxValue = packedTexture2DLOD( tex, uv, maxLevel );\n\n\t\treturn mix( minValue, maxValue, ratio );\n\n\t}\n\n\t// With original size argument\n\tvec4 packedTexture2DLOD( sampler2D tex, vec2 uv, int level, vec2 originalPixelSize ) {\n\n\t\tfloat floatLevel = float( level );\n\t\tvec2 atlasSize;\n\t\tatlasSize.x = floor( originalPixelSize.x * 1.5 );\n\t\tatlasSize.y = originalPixelSize.y;\n\n\t\t// we stop making mip maps when one dimension == 1\n\t\tfloat maxLevel = min( floor( log2( originalPixelSize.x ) ), floor( log2( originalPixelSize.y ) ) );\n\t\tfloatLevel = min( floatLevel, maxLevel );\n\n\t\t// use inverse pow of 2 to simulate right bit shift operator\n\t\tvec2 currentPixelDimensions = floor( originalPixelSize / pow( 2.0, floatLevel ) );\n\t\tvec2 pixelOffset = vec2(\n\t\t\tfloatLevel > 0.0 ? originalPixelSize.x : 0.0,\n\t\t\tfloatLevel > 0.0 ? currentPixelDimensions.y : 0.0\n\t\t);\n\n\t\t// "minPixel / atlasSize" samples the top left piece of the first pixel\n\t\t// "maxPixel / atlasSize" samples the bottom right piece of the last pixel\n\t\tvec2 minPixel = pixelOffset;\n\t\tvec2 maxPixel = pixelOffset + currentPixelDimensions;\n\t\tvec2 samplePoint = mix( minPixel, maxPixel, uv );\n\t\tsamplePoint /= atlasSize;\n\n\t\tvec2 halfPixelSize = 1.0 / ( 2.0 * atlasSize );\n\t\tsamplePoint = min( samplePoint, maxPixel / atlasSize - halfPixelSize );\n\t\tsamplePoint = max( samplePoint, minPixel / atlasSize + halfPixelSize );\n\n\t\treturn texture2D( tex, samplePoint );\n\n\t}\n\n\tvec4 packedTexture2DLOD( sampler2D tex, vec2 uv, float level, vec2 originalPixelSize ) {\n\n\t\tfloat ratio = mod( level, 1.0 );\n\t\tint minLevel = int( floor( level ) );\n\t\tint maxLevel = int( ceil( level ) );\n\n\t\tvec4 minValue = packedTexture2DLOD( tex, uv, minLevel, originalPixelSize );\n\t\tvec4 maxValue = packedTexture2DLOD( tex, uv, maxLevel, originalPixelSize );\n\n\t\treturn mix( minValue, maxValue, ratio );\n\n\t}\n\n\n\n\t\t#if X_IS_EVEN && Y_IS_EVEN\n\n\t\t#define SAMPLES 4\n\t\t#define WIDTH 2\n\t\t#define HEIGHT 2\n\n\t\t#elif X_IS_EVEN\n\n\t\t#define SAMPLES 6\n\t\t#define WIDTH 2\n\t\t#define HEIGHT 3\n\n\t\t#elif Y_IS_EVEN\n\n\t\t#define SAMPLES 6\n\t\t#define WIDTH 3\n\t\t#define HEIGHT 2\n\n\t\t#else\n\n\t\t#define SAMPLES 9\n\t\t#define WIDTH 3\n\t\t#define HEIGHT 3\n\n\t\t#endif\n\n\t\tvec4 sampleAt( vec2 uv ) {\n\n\t\t\treturn packedTexture2DLOD( map, uv, parentLevel, originalMapSize );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvec2 childMapSize = parentMapSize / 2.0;\n\t\t\t// vec2 childPixelSize = 1.0 / childMapSize;\n\t\t\t// vec2 halfChildPixelSize = childPixelSize / 2.0;\n\t\t\tvec2 childPixelPos = floor( vUv * childMapSize );\n\n\t\t\tvec2 parentPixelSize = 1.0 / parentMapSize;\n\t\t\tvec2 halfParentPixelSize = parentPixelSize / 2.0;\n\t\t\tvec2 parentPixelPos = childPixelPos * 2.0;\n\n\t\t\tvec2 baseUv = ( parentPixelPos / parentMapSize ) + halfParentPixelSize;\n\n\t\t\tvec4 samples[ SAMPLES ];\n\t\t\tfloat weights[ SAMPLES ];\n\n\t\t\t#if X_IS_EVEN && Y_IS_EVEN\n\n\t\t\tsamples[ 0 ] = sampleAt( baseUv );\n\t\t\tsamples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );\n\t\t\tsamples[ 2 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );\n\t\t\tsamples[ 3 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );\n\n\t\t\tweights[ 0 ] = 0.25;\n\t\t\tweights[ 1 ] = 0.25;\n\t\t\tweights[ 2 ] = 0.25;\n\t\t\tweights[ 3 ] = 0.25;\n\n\t\t\t#elif X_IS_EVEN\n\n\t\t\tfloat wx0 = 0.5;\n\t\t\tfloat wx1 = 0.5;\n\n\t\t\tfloat yden = 2.0 * parentMapSize.y + 1.0;\n\t\t\tfloat wy0 = ( parentMapSize.y - parentPixelPos.y ) / yden;\n\t\t\tfloat wy1 = ( parentMapSize.y ) / yden;\n\t\t\tfloat wy2 = ( parentPixelPos.y + 1.0 ) / yden;\n\n\t\t\tsamples[ 0 ] = sampleAt( baseUv );\n\t\t\tsamples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );\n\n\t\t\tsamples[ 2 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );\n\t\t\tsamples[ 3 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );\n\n\t\t\tsamples[ 4 ] = sampleAt( baseUv + vec2( 0.0, 2.0 * parentPixelSize.y ) );\n\t\t\tsamples[ 5 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 2.0 * parentPixelSize.y ) );\n\n\t\t\tweights[ 0 ] = wx0 * wy0;\n\t\t\tweights[ 1 ] = wx1 * wy0;\n\n\t\t\tweights[ 2 ] = wx0 * wy1;\n\t\t\tweights[ 3 ] = wx1 * wy1;\n\n\t\t\tweights[ 4 ] = wx0 * wy2;\n\t\t\tweights[ 5 ] = wx1 * wy2;\n\n\t\t\t#elif Y_IS_EVEN\n\n\t\t\tfloat xden = 2.0 * parentMapSize.x + 1.0;\n\t\t\tfloat wx0 = ( parentMapSize.x - parentPixelPos.x ) / xden;\n\t\t\tfloat wx1 = ( parentMapSize.x ) / xden;\n\t\t\tfloat wx2 = ( parentPixelPos.x + 1.0 ) / xden;\n\n\t\t\tfloat wy0 = 0.5;\n\t\t\tfloat wy1 = 0.5;\n\n\t\t\tsamples[ 0 ] = sampleAt( baseUv );\n\t\t\tsamples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );\n\t\t\tsamples[ 2 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, 0.0 ) );\n\n\t\t\tsamples[ 3 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );\n\t\t\tsamples[ 4 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );\n\t\t\tsamples[ 5 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, parentPixelSize.y ) );\n\n\t\t\tweights[ 0 ] = wx0 * wy0;\n\t\t\tweights[ 1 ] = wx1 * wy0;\n\t\t\tweights[ 2 ] = wx2 * wy0;\n\n\t\t\tweights[ 3 ] = wx0 * wy1;\n\t\t\tweights[ 4 ] = wx1 * wy1;\n\t\t\tweights[ 5 ] = wx2 * wy1;\n\n\t\t\t#else\n\n\t\t\tfloat xden = 2.0 * parentMapSize.x + 1.0;\n\t\t\tfloat wx0 = ( parentMapSize.x - parentPixelPos.x ) / xden;\n\t\t\tfloat wx1 = ( parentMapSize.x ) / xden;\n\t\t\tfloat wx2 = ( parentPixelPos.x + 1.0 ) / xden;\n\n\t\t\tfloat yden = 2.0 * parentMapSize.y + 1.0;\n\t\t\tfloat wy0 = ( parentMapSize.y - parentPixelPos.y ) / yden;\n\t\t\tfloat wy1 = ( parentMapSize.y ) / yden;\n\t\t\tfloat wy2 = ( parentPixelPos.y + 1.0 ) / yden;\n\n\t\t\tsamples[ 0 ] = sampleAt( baseUv );\n\t\t\tsamples[ 1 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 0.0 ) );\n\t\t\tsamples[ 2 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, 0.0 ) );\n\n\t\t\tsamples[ 3 ] = sampleAt( baseUv + vec2( 0.0, parentPixelSize.y ) );\n\t\t\tsamples[ 4 ] = sampleAt( baseUv + vec2( parentPixelSize.x, parentPixelSize.y ) );\n\t\t\tsamples[ 5 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, parentPixelSize.y ) );\n\n\t\t\tsamples[ 6 ] = sampleAt( baseUv + vec2( 0.0, 2.0 * parentPixelSize.y ) );\n\t\t\tsamples[ 7 ] = sampleAt( baseUv + vec2( parentPixelSize.x, 2.0 * parentPixelSize.y ) );\n\t\t\tsamples[ 8 ] = sampleAt( baseUv + vec2( 2.0 * parentPixelSize.x, 2.0 * parentPixelSize.y ) );\n\n\t\t\tweights[ 0 ] = wx0 * wy0;\n\t\t\tweights[ 1 ] = wx1 * wy0;\n\t\t\tweights[ 2 ] = wx2 * wy0;\n\n\t\t\tweights[ 3 ] = wx0 * wy1;\n\t\t\tweights[ 4 ] = wx1 * wy1;\n\t\t\tweights[ 5 ] = wx2 * wy1;\n\n\t\t\tweights[ 6 ] = wx0 * wy2;\n\t\t\tweights[ 7 ] = wx1 * wy2;\n\t\t\tweights[ 8 ] = wx2 * wy2;\n\n\t\t\t#endif\n\n\t\t\t<mipmap_logic>\n\n\t\t}\n\t'},{Color:T,ShaderMaterial:C,MathUtils:E,WebGLRenderTarget:k,NearestFilter:R}=await e("three"),W=new T;class L{constructor(e){e||(e="\n\n\t\t\t\t#pragma unroll_loop\n\t\t\t\tfor ( int i = 0; i < SAMPLES; i ++ ) {\n\n\t\t\t\t\tgl_FragColor += samples[ i ] * weights[ i ];\n\n\t\t\t\t}\n\n\t\t\t");const t=_(z);t.fragmentShader=t.fragmentShader.replace(/<mipmap_logic>/g,e);const a=new Array(4);a[0]=new C(_(t)),a[0].defines.X_IS_EVEN=0,a[0].defines.Y_IS_EVEN=0,a[1]=new C(_(t)),a[1].defines.X_IS_EVEN=1,a[1].defines.Y_IS_EVEN=0,a[2]=new C(_(t)),a[2].defines.X_IS_EVEN=0,a[2].defines.Y_IS_EVEN=1,a[3]=new C(_(t)),a[3].defines.X_IS_EVEN=1,a[3].defines.Y_IS_EVEN=1;const n=new k;n.texture.minFilter=R,n.texture.magFilter=R,this._swapTarget=n,this._copyQuad=new c(new C(u)),this._mipQuad=new c(null),this._mipMaterials=a}update(e,t,a,n=!1){e.isWebGLRenderTarget&&(e=e.texture);const o=a.autoClear,r=a.getClearAlpha(),i=a.getRenderTarget();a.getClearColor(W);const l=this._copyQuad,s=this._mipQuad,p=this._swapTarget,c=this._mipMaterials;let u,m;n?(u=E.floorPowerOfTwo(e.image.width),m=E.floorPowerOfTwo(e.image.height)):(u=Math.floor(e.image.width),m=Math.floor(e.image.height));const d=Math.floor(1.5*u),f=Math.floor(m);t.setSize(d,f),p.texture.type!==t.texture.type?(p.dispose(),p.copy(t),p.texture.image={...p.texture.image}):p.setSize(d,f),a.autoClear=!1,a.setClearColor(0),a.setClearAlpha(),l.material.uniforms.tDiffuse.value=e,l.camera.setViewOffset(u,m,0,0,d,f),a.setRenderTarget(t),a.clear(),l.render(a),a.setRenderTarget(p),a.clear(),l.render(a);let v=u,h=m,w=0;for(;v>1&&h>1;){const e=c[(v%2==0?1:0)|(h%2==0?2:0)];e.uniforms.map.value=p.texture,e.uniforms.parentLevel.value=w,e.uniforms.parentMapSize.value.set(v,h),e.uniforms.originalMapSize.value.set(u,m),s.material=e,v=Math.floor(v/2),h=Math.floor(h/2);const n=f-2*h;a.setRenderTarget(t),s.camera.setViewOffset(v,h,-u,-n,d,f),s.render(a),a.setRenderTarget(p),e.uniforms.map.value=t.texture,s.render(a),w++}return a.setRenderTarget(i),a.setClearAlpha(r),a.setClearColor(W),a.autoClear=o,w+1}dispose(){this._swapTarget.dispose(),this._mipQuad.dispose(),this._copyQuad.dispose(),this._mipMaterials.forEach(e=>e.dispose())}}const{defineComponent:V}=await e("vue"),A=await e("three"),U=V({__name:"reflectorMipMap",props:{parent:{},resolution:{default:512},ignoreObjects:{default:[]}},setup(e,{expose:n}){const o=e,r=new A.Plane,i=new A.Matrix4,l=new A.PerspectiveCamera,p=new L,c=s({width:o.resolution,height:o.resolution,settings:{type:A.UnsignedByteType}}),u=s({width:o.resolution,height:o.resolution,settings:{type:A.UnsignedByteType}}),{camera:m,renderer:d,scene:f}=t(),{onBeforeRender:v}=a();return v(()=>{(()=>{if(!m.value)return;r.set(new A.Vector3(0,1,0),0),r.applyMatrix4(o.parent.matrixWorld),l.copy(m.value);const e=new A.Vector3(0,0,1).clone().negate(),t=m.value.getWorldPosition(new A.Vector3);e.reflect(r.normal);const a=new A.Vector3;r.projectPoint(t,a);const n=a.clone();n.sub(t),n.add(a),l.position.copy(n);const s=new A.Vector3(0,0,-1);s.applyQuaternion(m.value.getWorldQuaternion(new A.Quaternion)),s.add(t);const p=new A.Vector3;o.parent.getWorldPosition(p),p.sub(s),p.reflect(r.normal).negate(),p.add(o.parent.getWorldPosition(new A.Vector3)),l.up.set(0,1,0),l.applyQuaternion(m.value.getWorldQuaternion(new A.Quaternion)),l.up.reflect(r.normal),l.lookAt(p),l.updateMatrixWorld();const u=new A.Matrix4;u.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),u.multiply(l.projectionMatrix),u.multiply(l.matrixWorldInverse),i.copy(u),r.applyMatrix4(l.matrixWorldInverse);const v=new A.Vector4(r.normal.x,r.normal.y,r.normal.z,r.constant),h=l.projectionMatrix,w=new A.Vector4;w.x=(Math.sign(v.x)+h.elements[8])/h.elements[0],w.y=(Math.sign(v.y)+h.elements[9])/h.elements[5],w.z=-1,w.w=(1+h.elements[10])/h.elements[14],v.multiplyScalar(2/v.dot(w)),h.elements[2]=v.x,h.elements[6]=v.y,h.elements[10]=v.z+1,h.elements[14]=v.w;const g=d.getRenderTarget();d.setRenderTarget(c.value),d.state.buffers.depth.setMask(!0),!1===d.autoClear&&d.clear(),o.ignoreObjects.forEach(e=>e.visible=!1),d.render(f.value,l),o.ignoreObjects.forEach(e=>e.visible=!0),d.setRenderTarget(g)})(),c.value&&u.value&&d&&p.update(c.value.texture,u.value,d)}),n({matrix:i,renderTarget:u}),(e,t)=>null}}),{withAsyncContext:B,defineComponent:I}=await e("vue"),{createElementVNode:D,unref:j,openBlock:O,createElementBlock:F}=await e("vue"),N=["rotateX","receiveShadow"],G=["color","map","normalMap","metalnessMap","roughnessMap","metalness","roughness","normalScale","side"],{watch:H}=await e("vue"),Q=await e("three"),X=I({__name:"rubberTiles",props:{color:{default:"#FFFFFF"},repeat:{default:{x:1,y:1}},metalness:{default:1},roughness:{default:.66},normalScale:{default:1},receiveShadow:{type:Boolean,default:!1}},async setup(e){let t,a;const o=e,{textures:r}=([t,a]=B(()=>n(["./plugins/floor/image/rubber_tiles_diff_1k.jpg","./plugins/floor/image/rubber_tiles_nor_gl_1k.jpg","./plugins/floor/image/rubber_tiles_arm_1k.jpg"])),t=await t,a(),t);return H([r],([e])=>{if(e&&e.length)for(let t=0;t<e.length;t++)e[t].colorSpace=Q.LinearSRGBColorSpace,e[t].wrapS=Q.RepeatWrapping,e[t].wrapT=Q.RepeatWrapping,e[t].magFilter=Q.LinearFilter,e[t].minFilter=Q.LinearMipmapLinearFilter,e[t].repeat.set(o.repeat.x,o.repeat.y)}),H(()=>o.repeat,e=>{for(let t=0;t<r.value.length;t++)r.value[t].repeat.set(e.x,e.y)},{deep:!0}),(e,t)=>(O(),F("TresGroup",null,[D("TresMesh",{rotateX:-Math.PI/2,receiveShadow:e.receiveShadow},[t[0]||(t[0]=D("TresPlaneGeometry",{args:[10,10]},null,-1)),D("TresMeshStandardMaterial",{color:o.color,map:j(r)[0],normalMap:j(r)[1],metalnessMap:j(r)[2],roughnessMap:j(r)[2],metalness:e.metalness,roughness:e.roughness,normalScale:e.normalScale,side:Q.DoubleSide},null,8,G)],8,N)]))}}),{defineComponent:Y}=await e("vue"),{openBlock:Z,createElementBlock:$,createCommentVNode:q}=await e("vue"),J=["object"],{ref:K,toRaw:ee,watch:te}=await e("vue"),ae=Y({__name:"topoBase",props:{selected:{default:"baseModelA"},type:{default:["baseModelA","baseModelB"]},colorlist:{default:["#6381EE","#FFFFFF"]},roughness:{default:.5},metalness:{default:.6}},setup(e){const t=e,a=K(!1);(async()=>{for(const e of t.type)await m.getResource("GLTFLoader",`./plugins/floor/models/topoBase/${e}.glb`,`topo-${e}.glb`);a.value=!0})();const n=K(null),o={};te(()=>a.value,e=>{e&&(n.value=m.getReactiveItem(`topo-${t.selected}.glb`)().scene.clone(),r(n.value))},{immediate:!0}),te(()=>t.selected,async e=>{n.value=m.getReactiveItem(`topo-${e}.glb`)().scene.clone(),r(n.value)});const r=e=>{for(const t in o)o[t].dispose(),delete o[t];e.traverse(e=>{if(e.isMesh&&e.material){const t=e.material;o[t.uuid]||(o[t.uuid]=t.clone()),e.material=o[t.uuid]}}),i(t.colorlist)},i=e=>{let t=0;for(const a in o)o.hasOwnProperty(a)&&o[a].color.set(e[t]),t++},l=(e,t)=>{for(const a in o)o.hasOwnProperty(a)&&(o[a][e]=t)};return te(()=>t.colorlist,e=>{i(e)},{deep:!0}),te(()=>[t.roughness,t.metalness],([e,t])=>{l("roughness",e),l("metalness",t)},{deep:!0}),(e,t)=>(Z(),$("TresGroup",null,[n.value?(Z(),$("primitive",{key:0,object:ee(n.value)},null,8,J)):q("",!0)]))}}),{defineComponent:ne}=await e("vue"),{unref:oe,openBlock:re,createElementBlock:ie,createCommentVNode:le}=await e("vue"),se=["object"],{watch:pe}=await e("vue"),ce=await e("three"),ue=ne({__name:"hexagonalWall",props:{color:{default:"#7432B4"}},setup(e){const{renderer:r,scene:i,camera:l,sizes:s}=t(),p=e;let c=null;const{textures:u,isLoading:m}=n(["./plugins/floor/image/concrete_wet_floor_basecolor.jpg","./plugins/floor/image/metal_plate_diff_1k.jpg"]),{state:w}=o("https://opensource.cdn.icegl.cn/model/floor/baseModelI.glb",{draco:!0,decoderPath:"./draco/"});let x=null;pe([w,u,m],([e,t,a])=>{e&&t&&!a&&(x=e.scene,x.traverse(e=>{if(e instanceof ce.Mesh){const a=e.position.clone(),n=20+30*Math.random(),o=Math.random()*Math.PI*2,r=20*(Math.random()-.5),i=new ce.Vector3(a.x+Math.cos(o)*n,a.y+r,a.z+Math.sin(o)*n);y.push({mesh:e,originalPosition:a,scatteredPosition:i}),e.position.copy(i),e.name.includes("_")?(t[0].wrapS=ce.RepeatWrapping,t[0].wrapT=ce.RepeatWrapping,t[0].repeat.set(10,10),e.material.map=u.map,e.material.needsUpdate=!0,e.material.emissive=new ce.Color("#7432B4"),e.material.emissiveIntensity=3.5):(t[1]&&(t[1].wrapS=ce.RepeatWrapping,t[1].wrapT=ce.RepeatWrapping,t[1].repeat.set(10,10),e.material.map=t[1]),e.material.color=new ce.Color("#7432B4"),e.material.metalness=.8,e.material.roughness=.2,e.material.envMapIntensity=2.5,e.material.needsUpdate=!0)}}),b(),M(),S())});const y=[],S=()=>{if(0===y.length)return;const e=g.timeline();y.forEach((t,a)=>{const n=.8*Math.random(),o={x:(Math.random()-.5)*Math.PI*2,y:(Math.random()-.5)*Math.PI*2,z:(Math.random()-.5)*Math.PI*2};t.mesh.rotation.set(o.x,o.y,o.z),e.to(t.mesh.position,{x:t.originalPosition.x,y:t.originalPosition.y,z:t.originalPosition.z,duration:3,ease:"power2.out",delay:n},0),e.to(t.mesh.rotation,{x:0,y:0,z:0,duration:3,ease:"power2.out",delay:n},0)}),e.call(()=>{P()}),console.log(`开始拼合动画，共 ${y.length} 个mesh`)},P=()=>{y.forEach((e,t)=>{g.to(e.mesh.position,{z:e.originalPosition.z+3+t/50,duration:2,repeat:-1,yoyo:!0,ease:"power1.inOut"})}),console.log("Z轴微动动画已启动")},M=()=>{if(!r||!l.value||!s.width.value)return;c=new d(r);const e=new f(i.value,l.value);c.addPass(e);const t=new v(new ce.Vector2(s.width.value,s.height.value),.6,.05,.25);c.addPass(t)},b=()=>{const e=new ce.PMREMGenerator(r),t=new h,a=e.fromScene(t).texture;i.value.environment=a,x.traverse(e=>{e instanceof ce.Mesh&&e.material&&(e.material.envMap=a,e.material.needsUpdate=!0)}),t.dispose()},{onRender:_}=a();return _(()=>{c&&c.render()}),pe(()=>[p.color],([e])=>{x.traverse(t=>{t instanceof ce.Mesh&&t.material&&(t.material.color=new ce.Color(e),t.material.emissive=new ce.Color(e))})}),(e,t)=>oe(w)?(re(),ie("primitive",{key:0,object:oe(w)?.scene,"position-y":.01},null,8,se)):le("",!0)}}),{defineComponent:me}=await e("vue"),{createElementVNode:de,unref:fe,openBlock:ve,createElementBlock:he,createCommentVNode:we}=await e("vue"),ge={key:0},xe=["object"],ye=["object"],Se=["object"],{onMounted:Pe,watch:Me,computed:be}=await e("vue"),_e=await e("three"),ze=me({__name:"mechaFloor",props:{color:{default:"#ffed00"}},setup(e){const{renderer:n,scene:i,camera:l,sizes:s}=t(),p=e;let c=null;const u={uniforms:{tDiffuse:{value:null},contrast:{value:1.8}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",fragmentShader:"\n        uniform sampler2D tDiffuse;\n        uniform float contrast;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb = (color.rgb - 0.5) * contrast + 0.8;\n            gl_FragColor = color;\n        }\n    "},{state:m}=o("https://opensource.cdn.icegl.cn/model/floor/baseModelJ.glb",{draco:!0,decoderPath:"./draco/"}),g=be(()=>m?.value?.scene),{state:x}=o("plugins/floor/models/topoBase/baseModelL.glb",{draco:!0,decoderPath:"./draco/"}),{state:y}=o("https://opensource.cdn.icegl.cn/model/floor/baseModelK.glb",{draco:!0,decoderPath:"./draco/"}),S=be(()=>y.value?.animations||[]),P=be(()=>y?.value?.scene),{actions:M}=r(S,P);Me(M,e=>{e.Scene&&e.Scene.play()}),Me(g,e=>{e&&e.traverse(e=>{e instanceof _e.Mesh&&(e.material.emissive=new _e.Color("#ffed00"),e.material.emissiveIntensity=20.5,e.material.toneMapped=!0,e.material.needsUpdate=!0)})});const{onRender:b}=a();return b(()=>{c&&c.render()}),Pe(()=>{(()=>{const e=new _e.PMREMGenerator(n),t=new h,a=e.fromScene(t).texture;i.value.environment=a,g.value&&g.value.traverse(e=>{e instanceof _e.Mesh&&e.material&&(e.material.envMap=a,e.material.needsUpdate=!0)}),t.dispose()})(),setTimeout(()=>{(()=>{if(!n||!l.value||!s.width.value)return;c=new d(n);const e=new f(i.value,l.value);c.addPass(e);const t=new v(new _e.Vector2(s.width.value,s.height.value),.1,.1,.1);c.addPass(t);const a=new w(u);a.uniforms.contrast.value=1.1,c.addPass(a)})()},200)}),Me(()=>[p.color],([e])=>{g.value&&g.value.traverse(t=>{t instanceof _e.Mesh&&t.material&&(t.material.emissive=new _e.Color(e))})}),(e,t)=>g.value&&P.value?(ve(),he("TresGroup",ge,[de("primitive",{object:g.value,"position-y":.01},null,8,xe),fe(x)?(ve(),he("primitive",{key:0,object:fe(x)?.scene,"position-y":.1},null,8,ye)):we("",!0),de("primitive",{object:P.value,"position-y":.1},null,8,Se)])):we("",!0)}}),{defineComponent:Te}=await e("vue"),{unref:Ce,openBlock:Ee,createElementBlock:ke,createCommentVNode:Re}=await e("vue"),We=["object"],{watch:Le}=await e("vue"),Ve=await e("three"),Ae=Te({__name:"hexagonalFloor",props:{floorColor:{default:"#ff0000"},floorMetalness:{default:.8},floorRoughness:{default:.2},floorEnvMapIntensity:{default:2.5},sideColor:{default:"#ffffff"},sideOpacity:{default:.9},speed:{default:.3}},setup(e){const{renderer:a,scene:n}=t(),r=e,{state:l}=i("./plugins/floor/image/concrete_wet_floor_basecolor.jpg");Le(l,e=>{e&&(e.wrapS=Ve.RepeatWrapping,e.wrapT=Ve.RepeatWrapping,e.repeat.set(10,10))});const{state:s}=o("https://opensource.cdn.icegl.cn/model/floor/baseModelI.glb",{draco:!0,decoderPath:"./draco/"}),p=[],c=g.timeline();Le(()=>s.value,e=>{if(!e.scene)return;e.scene.traverse(e=>{if(e instanceof Ve.Mesh){const t=e.position.clone(),a=e.rotation.clone(),n=Math.random()-.5,o=new Ve.Vector3(t.x,t.y+n,t.z),r=Math.PI/12,i=new Ve.Euler(a.x+(Math.random()-.5)*r,a.y+(Math.random()-.5)*r,a.z);p.push({mesh:e,originalPosition:t,scatteredPosition:o,originalRotation:a,scatteredRotation:i}),e.name.includes("_")?(e.material.emissiveIntensity=2,e.material.metalness=1,e.material.roughness=0,e.material.transparent=!0):e.material.map=l.value,e.material.needsUpdate=!0}}),p.forEach(({mesh:e,scatteredPosition:t,scatteredRotation:a},n)=>{c.to(e.position,{x:t.x,y:t.y,z:t.z,ease:"power1.inOut",repeat:-1,yoyo:!0},0),c.to(e.rotation,{x:a.x,y:a.y,z:a.z,ease:"power1.inOut",repeat:-1,yoyo:!0},0)}),u()});const u=()=>{const e=new Ve.PMREMGenerator(a),t=new h,o=e.fromScene(t).texture;n.value.environment=o,s.value.scene.traverse(e=>{e instanceof Ve.Mesh&&e.material&&(e.material.envMap=o,e.material.needsUpdate=!0)}),t.dispose(),m(r.sideColor,r.floorColor,r.sideOpacity,r.floorMetalness,r.floorRoughness,r.floorEnvMapIntensity)},m=(e,t,a,n,o,r)=>{s.value?.scene&&s.value.scene.traverse(i=>{i instanceof Ve.Mesh&&i.material&&(i.name.includes("_")?(i.material.emissive.set(e),i.material.opacity=a):(i.material.color.set(t),i.material.metalness=n,i.material.roughness=o,i.material.envMapIntensity=r))})};return Le(()=>[r.sideColor,r.floorColor,r.sideOpacity,r.floorMetalness,r.floorRoughness,r.floorEnvMapIntensity],([e,t,a,n,o,r])=>{m(e,t,a,n,o,r)}),Le(()=>[r.speed],([e])=>{c.timeScale(e)},{immediate:!0}),(e,t)=>(Ee(),ke("TresGroup",null,[Ce(s)?(Ee(),ke("primitive",{key:0,object:Ce(s)?.scene,position:[0,-.1,0]},null,8,We)):Re("",!0)]))}}),{unref:Ue,createElementVNode:Be,openBlock:Ie,createElementBlock:De}=await e("vue"),je=["geometry"],Oe=["color","transparent","opacity","side"],Fe=["geometry"],Ne=["map","side"],{watch:Ge}=await e("vue"),He=await e("three"),Qe={__name:"ribbonArrow",props:{length:{default:20},width:{default:1},bendPosition:{default:.5},curvature:{default:.4},backgroundColor:{default:"#00aaff"},backgroundAlpha:{default:.25},segments:{default:240},arrowColor:{default:"#ffffff"},arrowWidth:{default:.3},arrowHeight:{default:.5},arrowSpacing:{default:.5},arrowOffset:{default:0},arrowLineWidth:{default:2},arrowStyle:{default:"chevron"},speed:{default:.5},pixelWorldScale:{default:.03}},setup(e){const t=e,n=()=>{const e=Math.max(1e-4,t.length),a=He.MathUtils.clamp(t.bendPosition,0,1),n=e*a,o=e-n,r=Math.min(n,o),i=t.curvature>0&&a>0&&a<1?Math.min(.9*r,.2*e*t.curvature):0,l=Math.max(0,n-i),s=i>0?Math.PI*i/2:0;return{fullLen:l+s+Math.max(0,o-i),L1val:n,radius:i,len1:l,arcLen:s}};let{fullLen:o,L1val:r,radius:i,len1:l,arcLen:s}=n();const p=e=>{if((e=He.MathUtils.clamp(e,0,o))<=l)return new He.Vector2(e,0);if(e<=l+s&&i>0){const t=(e-l)/s,a=-Math.PI/2+t*(Math.PI/2),n=r-i,o=i;return new He.Vector2(n+Math.cos(a)*i,o+Math.sin(a)*i)}{const t=e-(l+s);return new He.Vector2(r,i+t)}};let c=[],u=[],m=0;const d=()=>{c=[],u=[];const e=Math.max(8,Math.floor(t.segments));let a=p(0),n=0;c.push(a),u.push(0),m=0;for(let t=1;t<=e;t++){const r=p(o*(t/e));n+=r.clone().sub(a).length(),c.push(r),u.push(n),a=r}m=n};d();let f=null;const v=()=>{const e=2*c.length,a=new Float32Array(3*e),n=new Float32Array(3*e),o=new Float32Array(2*e),r=[],i=t.width/2;function l(e){return 0===e?c[1].clone().sub(c[0]).normalize():e===c.length-1?c[e].clone().sub(c[e-1]).normalize():c[e+1].clone().sub(c[e-1]).normalize()}for(let s=0;s<c.length;s++){const e=c[s],r=l(s),p=new He.Vector2(-r.y,r.x).normalize(),m=e.x-p.x*i,d=e.y-p.y*i,f=e.x+p.x*i,v=e.y+p.y*i;a[3*(2*s+0)+0]=m,a[3*(2*s+0)+1]=d,a[3*(2*s+0)+2]=0,a[3*(2*s+1)+0]=f,a[3*(2*s+1)+1]=v,a[3*(2*s+1)+2]=0,n[3*(2*s+0)+0]=0,n[3*(2*s+0)+1]=0,n[3*(2*s+0)+2]=1,n[3*(2*s+1)+0]=0,n[3*(2*s+1)+1]=0,n[3*(2*s+1)+2]=1;const h=u[s]/(t.arrowWidth+t.arrowSpacing);o[2*(2*s+0)+0]=h,o[2*(2*s+0)+1]=0,o[2*(2*s+1)+0]=h,o[2*(2*s+1)+1]=1}for(let t=0;t<c.length-1;t++){const e=2*t,a=2*t+1,n=2*(t+1),o=2*(t+1)+1;r.push(e,n,a),r.push(a,n,o)}f&&f.dispose(),f=new He.BufferGeometry,f.setAttribute("position",new He.BufferAttribute(a,3)),f.setAttribute("normal",new He.BufferAttribute(n,3)),f.setAttribute("uv",new He.BufferAttribute(o,2)),f.setIndex(r),f.computeBoundingBox(),f.computeBoundingSphere()};v();let h=null;const w=()=>{h&&h.dispose(),h=(({arrowWidthPx:e,arrowHeightPx:a,spacingPx:n,style:o,color:r,lineWidth:i,offset:l})=>{const s=n,p=e+2*s,c=a+2*s,u=Math.max(1,window.devicePixelRatio||1),d=document.createElement("canvas");d.width=p*u,d.height=c*u,d.style.width=p+"px",d.style.height=c+"px";const f=d.getContext("2d");f.scale(u,u),f.clearRect(0,0,p,c),f.strokeStyle=r,f.fillStyle=r,f.lineWidth=i,f.lineJoin="round",f.lineCap="round";const v=s,h=e,w=a,g=v+h/2,x=s+w/2+l;"chevron"===o?(f.beginPath(),f.moveTo(v,x-w/2),f.lineTo(v+h,x),f.lineTo(v,x+w/2),f.stroke()):"double"===o?(f.beginPath(),f.moveTo(v,x-w/2),f.lineTo(v+.7*h,x),f.lineTo(v,x+w/2),f.stroke(),f.beginPath(),f.moveTo(v+.8*h,x-w/2),f.lineTo(v+1.5*h,x),f.lineTo(v+.8*h,x+w/2),f.stroke()):"triangle"===o?(f.beginPath(),f.moveTo(v,x-w/2),f.lineTo(v+h,x),f.lineTo(v,x+w/2),f.closePath(),f.fill()):"diamond"===o?(f.beginPath(),f.moveTo(g,x-w/2),f.lineTo(g+h/2,x),f.lineTo(g,x+w/2),f.lineTo(g-h/2,x),f.closePath(),f.fill()):(f.beginPath(),f.moveTo(v,x-w/2),f.lineTo(v+h,x),f.lineTo(v,x+w/2),f.stroke());const y=new He.CanvasTexture(d);return y.generateMipmaps=!1,y.minFilter=He.LinearFilter,y.magFilter=He.LinearFilter,y.wrapS=He.RepeatWrapping,y.wrapT=He.ClampToEdgeWrapping,y.repeat.set(m/(t.arrowWidth+t.arrowSpacing),1),y.needsUpdate=!0,y})({arrowWidthPx:t.arrowWidth/t.pixelWorldScale,arrowHeightPx:t.arrowHeight/t.pixelWorldScale,spacingPx:t.arrowSpacing/t.pixelWorldScale,style:t.arrowStyle,color:t.arrowColor,lineWidth:t.arrowLineWidth,offset:t.arrowOffset})};w(),Ge(()=>[t.length,t.width,t.bendPosition,t.curvature,t.segments,t.arrowColor,t.arrowWidth,t.arrowHeight,t.arrowSpacing,t.arrowOffset,t.arrowLineWidth,t.arrowStyle,t.pixelWorldScale],()=>{({fullLen:o,L1val:r,radius:i,len1:l,arcLen:s}=n()),d(),v(),w()});const{onBeforeRender:g}=a();return g(()=>{if(h){const e=.01*t.speed;h.offset.x=(h.offset.x-e)%1,h.offset.x>1&&(h.offset.x-=1),h.needsUpdate=!0}}),(t,a)=>(Ie(),De("TresGroup",null,[Be("TresMesh",{geometry:Ue(f)},[Be("TresMeshBasicMaterial",{color:e.backgroundColor,transparent:e.backgroundAlpha<1,opacity:e.backgroundAlpha,side:He.DoubleSide,depthWrite:""},null,8,Oe)],8,je),Be("TresMesh",{geometry:Ue(f)},[Be("TresMeshBasicMaterial",{map:Ue(h),transparent:"",side:He.DoubleSide,depthWrite:"",renderOrder:1},null,8,Ne)],8,Fe)]))}},{defineComponent:Xe}=await e("vue"),{createElementVNode:Ye,mergeProps:Ze,openBlock:$e,createElementBlock:qe}=await e("vue"),Je=["rotation-x"],Ke=await e("three"),{reactive:et,watch:tt,ref:at}=await e("vue"),nt=Xe({__name:"shaderCircleWave",props:{color:{default:"#ffffff"},colorDark:{default:"#000000"},speed:{default:1}},setup(e){const t=e,n=et({side:Ke.DoubleSide,transparent:!0,blending:Ke.AdditiveBlending,flatShading:!0,depthTest:!0,depthWrite:!1,uniforms:{uTime:{type:"f",value:0},uScanTex:{type:"t",value:null},uScanColor:{type:"v3",value:new Ke.Color(t.color)},uScanColorDark:{type:"v3",value:new Ke.Color(t.colorDark)}},vertexShader:"\nvarying vec2 vUv;\nvarying vec3 vPosition;\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}\n",fragmentShader:"\n#define uScanOrigin vec3(0.,0.,0.)\n#define uScanWaveRatio1 3.2\n#define uScanWaveRatio2 2.8\n\nuniform float uTime;\nuniform sampler2D uScanTex;\nvarying vec2 vUv;\nvarying vec3 vPosition;\nuniform vec3 uScanColor;\nuniform vec3 uScanColorDark;\n\nfloat circleWave(vec3 p,vec3 origin,float distRatio){\n    float t=uTime;\n    float dist=distance(p,origin)*distRatio;\n    float radialMove=fract(dist-t);\n    float fadeOutMask=1.-smoothstep(1.,3.,dist);\n    radialMove*=fadeOutMask;\n    float cutInitialMask=1.-step(t,dist);\n    radialMove*=cutInitialMask;\n    return radialMove;\n}\n\nvec3 getScanColor(vec3 worldPos,vec2 uv,vec3 col){\n    // mask\n    float scanMask=texture(uScanTex,uv).r;\n    // waves\n    float cw=circleWave(worldPos,uScanOrigin,uScanWaveRatio1);\n    float cw2=circleWave(worldPos,uScanOrigin,uScanWaveRatio2);\n    // scan\n    float mask1=smoothstep(.3,0.,1.-cw);\n    mask1*=(1.+scanMask*.7);\n    \n    float mask2=smoothstep(.07,0.,1.-cw2)*.8;\n    mask1+=mask2;\n    \n    float mask3=smoothstep(.09,0.,1.-cw)*1.5;\n    mask1+=mask3;\n\n    // color\n    vec3 scanCol=mix(uScanColorDark,uScanColor,mask1);\n    col=mix(col,scanCol,mask1);\n    \n    return col;\n\t\t// return vec3(cw);\n\t\t// return vec3(scanMask);\n\t\t// return worldPos;\n\t\t// return vec3(mask1);\n\t\t// return scanCol;\n}\n\nvoid main()\n{\n    vec3 col=vec3(0.);\n    col=getScanColor(vPosition,vUv*10.0,col);\n    gl_FragColor=vec4(col,1.);\n}\n"}),o=at(null),{state:r}=i("./plugins/floor/image/scan.png");tt(()=>r.value,e=>{e&&(e.wrapS=Ke.RepeatWrapping,e.wrapT=Ke.RepeatWrapping,n.uniforms.uScanTex.value=e,o.value.needsUpdate=!0,o.value.uniformsNeedUpdate=!0)}),tt(()=>[t.color,t.colorDark],([e,t])=>{n.uniforms.uScanColor.value=new Ke.Color(e),n.uniforms.uScanColorDark.value=new Ke.Color(t)});const{onBeforeRender:l}=a();return l(()=>{n.uniforms.uTime.value+=.01*t.speed}),(e,t)=>($e(),qe("TresGroup",null,[Ye("TresMesh",{"rotation-x":-Math.PI/2},[t[0]||(t[0]=Ye("TresPlaneGeometry",{args:[1,1]},null,-1)),Ye("TresShaderMaterial",Ze({ref_key:"tsmRef",ref:o},n),null,16)],8,Je)]))}}),{defineComponent:ot}=await e("vue"),{unref:rt,createElementVNode:it,openBlock:lt,createElementBlock:st}=await e("vue"),pt=["object"],ct=await e("three"),{watch:ut,onUnmounted:mt}=await e("vue"),dt=ot({__name:"cartoonMagic",props:{color:{default:"#00ffff"},speed:{default:1}},setup(e){const t=e,n=e=>{const a=new ct.Color(t.color),n=new ct.Vector4(a.r,a.g,a.b,e);return new P(n)},o=new x,r=new y;r.setCrossOrigin("");const{scene:i}=l(),s=new ct.Group;i.value.add(s),mt(()=>{i.value.remove(s)}),r.load("./plugins/floor/json/CartoonMagicZone2.json",e=>{e.traverse(e=>{if("ParticleEmitter"===e.type){"BasicZoneRedEmitter"===e.name&&e.rotation.set(Math.PI/2,0,0);const t=e.system;-.25===t.startSpeed.value&&(t.startSpeed=new S(-.5)),t.startColor=n(t.startColor.color.w),o.addSystem(t)}}),"ParticleEmitter"===e.type&&o.addSystem(e.system),s.add(e)});const{onBeforeRender:p}=a();return p(()=>{o.update(.01*t.speed)}),ut(()=>[t.color],()=>{o.systemToBatchIndex.forEach((e,t)=>{t.startColor=n(t.startColor.color.w)})}),(e,t)=>(lt(),st("TresGroup",null,[it("primitive",{object:rt(o)},null,8,pt)]))}}),{defineComponent:ft}=await e("vue"),{createElementVNode:vt,normalizeProps:ht,guardReactiveProps:wt,openBlock:gt,createElementBlock:xt}=await e("vue"),yt=await e("three"),{watch:St,reactive:Pt,ref:Mt}=await e("vue"),bt=ft({__name:"dynamicRotatingBase",props:{type:{default:"imgA"},color:{default:"#fff"},opacity:{default:.95},rotationZ:{default:.01},videoLoop:{type:Boolean,default:!1}},setup(e){const t=Mt(),{onBeforeRender:n}=a();n(()=>{t.value&&(t.value.rotation.z+=r.rotationZ)});const o={imgA:{type:"img",path:"./plugins/floor/image/imgFloor1.png"},imgB:{type:"img",path:"./plugins/floor/image/imgFloor2.png"},imgC:{type:"img",path:"./plugins/floor/image/imgFloor3.png"},videoA:{type:"video",path:"https://opensource.cdn.icegl.cn/video/floor/floorV1.mp4"},videoB:{type:"video",path:"https://opensource.cdn.icegl.cn/video/floor/floorV2.mp4"},videoC:{type:"video",path:"https://opensource.cdn.icegl.cn/video/floor/floorV3.mp4"}},r=e,i=Pt({color:r.color,map:null,side:yt.DoubleSide,transparent:!0,opacity:r.opacity,blending:yt.AdditiveBlending,depthTest:!0,depthWrite:!1}),l=document.createElement("video");return St(()=>r.type,async e=>{if(i.map?.dispose(),"img"===o[e].type){const t=await p(o[e].path);t.colorSpace=yt.SRGBColorSpace,t.wrapS=yt.RepeatWrapping,t.wrapT=yt.RepeatWrapping,t.repeat.set(1,1),i.map=t}else if("video"===o[e].type){l.src=o[e].path,l.crossOrigin="anonymous",l.loop=r.videoLoop,l.muted=!0,l.play();const t=new yt.VideoTexture(l);t.colorSpace=yt.SRGBColorSpace,t.wrapS=yt.RepeatWrapping,t.wrapT=yt.RepeatWrapping,t.repeat.set(1,1),i.map=t}},{immediate:!0}),St(()=>[r.color,r.opacity,r.videoLoop],([e,t,a])=>{i.color=new yt.Color(e),i.opacity=t,l.loop=a}),(e,a)=>(gt(),xt("TresMesh",{ref_key:"tmRef",ref:t},[a[0]||(a[0]=vt("TresPlaneGeometry",{args:[10,10]},null,-1)),vt("TresMeshBasicMaterial",ht(wt(i)),null,16)],512))}});export{dt as _,nt as a,bt as b,Ae as c,ue as d,ze as e,Qe as f,X as g,ae as h,U as i};
