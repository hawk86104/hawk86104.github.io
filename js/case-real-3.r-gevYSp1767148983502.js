import{importShared as v}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{T_ as ge,Gy as fe,Hy as he,_sfc_main as ve,_a as B,ly as L,By as N,cy as me,$d as _e,ol as X,J_ as V}from"./DevTDTTiles.vue_vue_type_script_setup_true_lang.BByDxm3U1767148983502.js";import{sz as we,_export_sfc as Ce}from"./index.DTe2qqjO1767148983502.js";const{defineComponent:be}=await v("vue"),{createElementVNode:d,unref:e,createVNode:n,withCtx:s,openBlock:b,createBlock:z,createCommentVNode:J,Suspense:ke,resolveComponent:ye,mergeProps:Pe,Fragment:Me,createElementBlock:xe}=await v("vue"),Se={scale:[5,5,5]},{SRGBColorSpace:Te,BasicShadowMap:Be,NoToneMapping:Le,CurvePath:Ne,LineCurve:Ve,Vector2:j,RepeatWrapping:D,Vector3:ze}=await v("three"),{reactive:Oe,ref:l}=await v("vue"),{watch:Re}=await v("vue"),K=40,Q=8e5,Y=90.85,Z=500,Ee=be({__name:"case-real-3",setup(He){const ee=Oe({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:Be,outputColorSpace:Te,toneMapping:Le}),m=l({lon:117.84796240906425,lat:38.95216229684954,height:20}),_=l({lon:117.8533521756129,lat:38.95128,height:20});function O(t,o,i,a,r=!0){const f=o-t;return h=>{let p=(h-t)/f;return r&&(p=Math.max(0,Math.min(1,p))),i+p*(a-i)}}const k=l();function te(t){const o=t.x,i=t.y,a=t.z,r=6378137,f=6356752314245e-6,h=r*r,p=f*f,M=(h-p)/h,de=(h-p)/p,C=Math.hypot(o,i);if(C===0&&a===0)return Math.sqrt(o*o+i*i+a*a)-r;const $=Math.atan2(a*r,C*f),x=Math.sin($),S=Math.cos($),q=Math.atan2(a+de*f*x*x*x,C-M*r*S*S*S),T=Math.sin(q),A=Math.cos(q),U=r/Math.sqrt(1-M*T*T);return Math.abs(A)>1e-12?C/A-U:a/Math.sign(T)-U*(1-M)}const R=l(0),E=l(2e3),y=l(100),H=l(1),I=l(1),W=O(5e3,1e7,1,1e3),ne=O(5e3,1e7,.001,1);Re(R,t=>{E.value=2e3/W(t),y.value=100*W(t),H.value=ne(t),I.value=(t-1e5)/9e5*.5});const oe=l(1),c=l({lon:Y,lat:K,height:Q});function ae(){const i=performance.now()/1e3*oe.value%Z/Z*2*Math.PI;c.value.lon=(Y+i*180/Math.PI)%360,c.value.lat=K+5*Math.cos(i),c.value.height=Q}const le=()=>{ae(),k.value&&(R.value=te(k.value?.getWorldPosition(new ze)))},ie=l({effectProps:{enabled:!1,focusArea:.7,feather:.1},ambientLight:{color:"#fff",intensity:1},directionalLight:{color:"#fff",intensity:2,position:[-1500,500,500]},background:"/plugins/earthSample/image/menuA/bg-img.png"}),g=l({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132}),F=l({heading:90,pitch:45,distance:200}),P=[{lon:117.85481967875631,lat:38.95025551631983},{lon:117.85566616248491,lat:38.95427209924625},{lon:117.85712202478027,lat:38.95970065499051},{lon:118.10293300958989,lat:38.92203696242356},{lon:118.21571040844162,lat:38.8584869570214},{lon:118.56457646308445,lat:38.792815766352845},{lon:119.52790645782477,lat:38.717044062084426},{lon:120.65902562748857,lat:38.60702467836941},{lon:120.79461456776448,lat:38.58622713855249},{lon:120.92076119840306,lat:38.52106665879057},{lon:121.9906916889725,lat:38.18314251246517},{lon:124.14446035378819,lat:37.44557549519065},{lon:125.9802772978905,lat:37.39012819157668},{lon:126.42446686403741,lat:37.35004753338622},{lon:126.48154639818023,lat:37.36107410768207},{lon:126.56124848326965,lat:37.40711309766567},{lon:126.57255884697423,lat:37.421008747816884},{lon:126.581932075672,lat:37.42778825439147},{lon:126.59275992012022,lat:37.42831387228446},{lon:126.60078120441494,lat:37.42464694776248}],G=new Ne;for(let t=0;t<P.length-1;t++){const o=P[t],i=P[t+1];G.add(new Ve(new j(o.lon,o.lat),new j(i.lon,i.lat)))}const w=G.getSpacedPoints(1e3).map(t=>({lon:t.x,lat:t.y,height:20})),u=l(!1),se=l({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132});function ce(){g.value={heading:0,pitch:-45,distance:1e5,longitude:c.value.lon,latitude:c.value.lat},u.value=!0}function re(){g.value={heading:0,pitch:-45,distance:500,longitude:m.value.lon,latitude:m.value.lat},u.value=!1}function ue(){g.value={heading:0,pitch:-45,distance:500,longitude:_.value.lon,latitude:_.value.lat},u.value=!1}function pe(){g.value={...se.value},u.value=!1}return(t,o)=>{const i=ye("TresCanvas");return b(),xe(Me,null,[n(i,Pe(ee,{"window-size":"",onLoop:le}),{default:s(()=>[d("TresPerspectiveCamera",{fov:45,near:.1,far:1e3,"look-at":[0,0,0],ref_key:"cameraRef",ref:k},null,512),n(e(ge)),n(e(fe),{position:g.value,"onUpdate:position":o[0]||(o[0]=a=>g.value=a),targetPosition:F.value,"onUpdate:targetPosition":o[1]||(o[1]=a=>F.value=a),target:u.value?c.value:null,"min-distance":1},null,8,["position","targetPosition","target"]),n(e(he),{sceneConfig:ie.value},null,8,["sceneConfig"]),n(ve,{layer:"img"}),n(e(B),{point:m.value},{default:s(()=>[n(e(L),{rotate:-12,"scale-x":.9},{default:s(()=>[n(e(N),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})]),_:1})]),_:1},8,["point"]),n(e(B),{point:_.value},{default:s(()=>[n(e(L),{rotate:-12,"scale-x":.9},{default:s(()=>[n(e(N),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})]),_:1})]),_:1},8,["point"]),(b(),z(ke,null,{default:s(()=>[n(e(we),{path:"/plugins/geokit/case-real-3/image/road-texture.png"},{default:s(({state:a})=>[n(e(me),{texture:a,wrapT:e(D),wrapS:e(D)},null,8,["texture","wrapT","wrapS"]),e(w).length?(b(),z(e(_e),{key:0,speed:H.value},{default:s(()=>[n(e(X),{repeat:[E.value,1],map:a,duration:4,points:e(w),width:y.value,color:"#fff",renderOrder:500},null,8,["repeat","map","points","width"])]),_:2},1032,["speed"])):J("",!0)]),_:1})]),_:1})),e(w).length?(b(),z(e(X),{key:0,points:e(w),width:y.value,color:"#fff",opacity:I.value,renderOrder:200},null,8,["points","width","opacity"])):J("",!0),n(e(B),{point:c.value},{default:s(()=>[n(e(L),{rotate:-12,"scale-x":.9},{default:s(()=>[d("TresGroup",Se,[n(e(N),{url:"/plugins/geokit/case-real-3/model/weixing.glb",draco:""})])]),_:1})]),_:1},8,["point"]),n(e(V),{icon:"/plugins/geokit/case-real-3/icons/satellite.svg",size:16,point:c.value,onClick:o[2]||(o[2]=a=>u.value=!u.value)},null,8,["point"]),n(e(V),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:m.value},null,8,["point"]),n(e(V),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:_.value},null,8,["point"])]),_:1},16),d("div",{class:"control-panel"},[d("button",{onClick:ce,class:"focus-btn satellite-btn"}," 聚焦卫星 "),d("button",{onClick:re,class:"focus-btn ship-btn"}," 聚焦船只1 "),d("button",{onClick:ue,class:"focus-btn ship-btn"}," 聚焦船只2 "),d("button",{onClick:pe,class:"reset-btn"}," 还原镜头 ")])],64)}}}),Ge=Ce(Ee,[["__scopeId","data-v-4ac10c4d"]]);export{Ge as default};
