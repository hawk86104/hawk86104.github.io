import{_ as e}from"./@tresjs.BCHtwiaC1763540743861.js";import{l as a,dh as o,V as r,M as n,ae as i}from"./three.rXKzP9fQ1763540743861.js";import{d as t,a as u,w as l,a6 as s,H as d,o as c,J as v,ac as m,ao as f}from"./@vue.Co_gxueH1763540743861.js";const p=["args"],M=t({__name:"radraB",props:{radius:{default:10},maxRadius:{default:200},color:{default:"#ffff00"},opacity:{default:.5},period:{default:2},height:{default:100}},setup(t,{expose:M}){const x=t,y=u(),h=u(1),g=u(.1),w={color:x.color,opacity:x.opacity,transparent:!0,depthWrite:!1,depthTest:!0,side:i,vertexShader:"\n\tvarying vec4 vPosition;\n  void main() {\n    vPosition = modelMatrix * vec4(position,1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }\n  ",fragmentShader:"\n\tuniform vec3 uColor; // 光墙半径        \n  uniform vec3 uMax; \n  uniform vec3 uMin;\n  uniform mat4 modelMatrix; // 世界矩阵\n  varying vec4 vPosition; // 接收顶点着色传递进来的位置数据\n  void main() {\n    // 转世界坐标\n    vec4 uMax_world = modelMatrix * vec4(uMax,1.0);\n    vec4 uMin_world = modelMatrix * vec4(uMin,1.0);\n    // 根据像素点世界坐标的y轴高度,设置透明度\n    float opacity =1.0 - (vPosition.y - uMin_world.y) / (uMax_world.y -uMin_world.y) ; \n    gl_FragColor = vec4( uColor, opacity);\n  }\n  ",uniforms:{uMax:h,uMin:g,uColor:{value:new a(x.color)}}},_=u();let T=null;l(_,(e,a)=>{e&&void 0===a&&(_.value.computeBoundingBox(),h.value=_.value.boundingBox.max,g.value=_.value.boundingBox.min,T=y.value.scale.clone())});const B=u(new o(new r(0,0,0),new r(0,x.height,0)));s(()=>{x.color&&(w.uniforms.uColor.value=new a(x.color))});const{onBeforeRender:R}=e(),j={value:0};return R(({delta:e})=>{j.value+=e;const a=(j.value%x.period/x.period*(x.maxRadius-x.radius)+x.radius)/x.radius,o=(new n).makeScale(a,1,a);T&&(y.value.scale.copy(T.clone().applyMatrix4(o)),y.value.updateMatrix())}),M({MeshRef:y}),(e,a)=>(c(),d("TresMesh",{ref_key:"MeshRef",ref:y,renderOrder:2e3},[v("TresTubeGeometry",{ref_key:"TresTubeGeometryRef",ref:_,args:[B.value,20,x.radius,100,!1]},null,8,p),v("TresShaderMaterial",m(f(w)),null,16)],512))}});export{M as _};
