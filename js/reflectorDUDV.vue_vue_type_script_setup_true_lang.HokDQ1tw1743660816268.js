import{ce as e,ae as i,l as s,m as t}from"./three.2wx8FU0g1743660816268.js";import{a as r}from"./@tresjs.zc7faK4J1743660816268.js";import{R as a,b as l}from"./all.three.q3DPAGr01743660816268.js";import{q as o}from"./vite-plugin-qiankun.DT7p3NC_1743660816268.js";import{d as n,a4 as u,a2 as f,w as c,o as p,H as v,N as m,u as d}from"./@vue.B5PFBfKs1743660816268.js";const _=["scale"],b=["object"],j=["object"],w=n({__name:"reflectorDUDV",props:{reflectivity:{default:.8},showGridHelper:{type:Boolean,default:!0},scale:{default:1},ignoreObjects:{default:[]},size:{default:[10,10]},mapUrl:{default:"./plugins/floor/image/waterdudv.jpg"}},async setup(n,{expose:w}){let h,g;const y=n,U=new a,x=new e(y.size[0]-.5,y.size[1]);x.visible=y.showGridHelper;let M=y.mapUrl;o.__POWERED_BY_QIANKUN__&&(M=o.__INJECTED_PUBLIC_PATH_BY_QIANKUN__+M);const{map:R}=([h,g]=u((()=>r({map:M}))),h=await h,g(),h);R.wrapS=i,R.wrapT=i,R.repeat.set(6,3);const B=new l({map:R,reflectivity:y.reflectivity});B.uniforms.tReflect={value:U.renderTarget.texture},B.uniforms.tReflectBlur=U.renderTargetUniform,B.uniforms.uMatrix=U.textureMatrixUniform;const E=new s(new t(y.size[0],y.size[1]),B);return E.rotation.x=-Math.PI/2,E.add(U),E.onBeforeRender=(e,i,s)=>{E.visible=!1,y.ignoreObjects.forEach((e=>{e.isMesh&&(e.visible=!1),e.value&&e.value.isMesh&&(e.value.visible=!1)})),U.update(e,i,s),y.ignoreObjects.forEach((e=>{e.isMesh&&(e.visible=!0),e.value&&e.value.isMesh&&(e.value.visible=!0)})),E.visible=!0},f((()=>{y.reflectivity&&(B.uniforms.uReflectivity.value=y.reflectivity)})),c((()=>y.showGridHelper),(e=>{x.visible=e})),w({reflector:U}),(e,i)=>(p(),v("TresGroup",{scale:y.scale},[m("primitive",{object:d(E),"position-y":-.01},null,8,b),m("primitive",{object:d(x)},null,8,j)],8,_))}});export{w as _};
