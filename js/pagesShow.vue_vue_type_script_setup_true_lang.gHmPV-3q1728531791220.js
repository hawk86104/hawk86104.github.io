import{a0 as t,_ as n,C as o,cd as e,ce as r,cf as i,cg as u,m as c,bU as s,ak as a,am as l}from"./three.QbUqWzuy1728531791220.js";import{c as f,U as p,Y as d}from"./@tresjs.TFxw2EXb1728531791220.js";import{C as h}from"./three-custom-shader-material._Yy71uo31728531791220.js";import"./object-hash.lBPFZZ1y1728531791220.js";import"./@amap.OnfPw1bC1728531791220.js";import"./glsl-tokenizer.jsOyVPm91728531791220.js";import{d as m,b as y,a3 as g,w,o as v,E as b,u as _,r as C,a4 as I,e as x,f as S,g as M,L as R,j,aj as A,ak as O,F as T,J as B,H as L,m as E}from"./@vue.bvMz0l_u1728531791220.js";function k(){const t=["505780UKMrxt","904BCjRfV","input","prototype","constructor","debu","info","34uSuBJu","apply","bind","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","error","warn","counter","LANDMASS","log","table","exception","trace","traverse","toString","16ECAUyu","CITY_UNTRIANGULATED","console","358771KEjqES","630420EnYwKd",'{}.constructor("return this")( )',"call","while (true) {}","5060uSzLPY","init","517668CSUdjG","49bSANOq","116271XaJlnP","length","3895407gvESRL","chain","name","string","test"];return(k=function(){return t})()}!function(t,n){const o=F,e=k();for(;;)try{if(681488===-parseInt(o(446))/1+parseInt(o(469))/2*(parseInt(o(455))/3)+-parseInt(o(463))/4*(-parseInt(o(451))/5)+-parseInt(o(453))/6*(parseInt(o(454))/7)+-parseInt(o(483))/8*(-parseInt(o(457))/9)+-parseInt(o(447))/10+-parseInt(o(462))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=F,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(472),"i"),e=H(t(452));n[t(461)](e+t(458))&&o[t(461)](e+t(464))?H():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(470)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();D(void 0,(function(){const t=F;let n;try{n=Function("return (function() "+t(448)+");")()}catch(r){n=window}const o=n.console=n[t(445)]||{},e=[t(477),t(474),t(468),t(473),t(479),t(478),t(480)];for(let i=0;i<e[t(456)];i++){const n=D[t(466)][t(465)][t(471)](D),r=e[i],u=o[r]||n;n.__proto__=D[t(471)](D),n.toString=u[t(482)][t(471)](u),o[r]=n}}))();const P=async()=>{const t=F,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(481)]((n=>{const i=t;n[i(459)]===i(444)&&(o=n),n[i(459)]===i(476)&&(e=n),"ROADS"===n[i(459)]&&(r=n)})),{model:n,city:o,land:e,roads:r}};function F(t,n){const o=k();return(F=function(t,n){return o[t-=444]})(t,n)}function H(t){function n(t){const o=F;if(typeof t===o(460))return function(t){}.constructor(o(450))[o(470)](o(475));1!==(""+t/t).length||t%20==0?function(){return!0}[o(466)](o(467)+"gger")[o(449)]("action"):function(){return!1}.constructor("debugger")[o(470)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=Q;!function(t,n){const o=Q,e=U();for(;;)try{if(617877===parseInt(o(464))/1+-parseInt(o(472))/2*(-parseInt(o(445))/3)+-parseInt(o(495))/4*(-parseInt(o(480))/5)+-parseInt(o(487))/6*(parseInt(o(482))/7)+-parseInt(o(471))/8+parseInt(o(493))/9+-parseInt(o(450))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function U(){const t=["bulidingsColor","__proto__","land","object","material","uColor","70WaLJnB","side","186977OeGoqQ","init","bind","#ffff00","model","168RZHRFl","forEach","uGradient","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","action","chain","7739145SppwdK","topColor","95028dwiDrg","#112233","clone","gger","uOpacity","uniforms","buildingsModelCustomShader","primitive","apply","table","debu","computeBoundingBox","constructor","call","value","return (function() ","isArray","trace","length","warn","20490VlRzrQ","log","landColor","while (true) {}","function *\\( *\\)","1436170ODtzLA","info","gradient","city","stateObject","opacity","counter","exception","console","Color","toString","setStyle","renderOrder","DoubleSide","278545HfOLar","input","__csm","computeBoundingSphere","#e523ff","error","test","1059168RkWicY","50idXjLI","prototype"];return(U=function(){return t})()}!function(){W(this,(function(){const t=Q,n=new RegExp(t(449)),o=new RegExp(t(490),"i"),e=K(t(483));n[t(470)](e+t(492))&&o[t(470)](e+t(465))?K():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=Q,n=function(){const t=Q;let n;try{n=Function(t(440)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(458)]=n[t(458)]||{},e=[t(446),t(444),t(451),t(469),t(457),t(504),t(442)];for(let r=0;r<e[t(443)];r++){const n=Z.constructor[t(473)][t(484)](Z),i=e[r],u=o[i]||n;n[t(475)]=Z.bind(Z),n[t(460)]=u[t(460)][t(484)](u),o[i]=n}}))();const $=[G(477)];function Q(t,n){const o=U();return(Q=function(t,n){return o[t-=440]})(t,n)}const Y=m({__name:G(501),props:{model:{},bulidingsColor:{default:G(468)},landColor:{default:G(496)},topColor:{default:G(485)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=G,i=e,u=y(0),c=i[r(486)][r(453)];c[r(462)]=1001;const s=i[r(486)].land;(()=>{const t=r,{geometry:e}=c;e[t(506)](),e[t(467)]();const{max:s,min:a}=e.boundingBox;if(c[t(478)][t(466)])return;const l=new h({baseMaterial:c[t(478)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(n[t(459)])(i[t(474)])},uOpacity:{value:i[t(455)]},uLightColor:{value:new(n[t(459)])("#ffffff")},uTopColor:{value:new o(i[t(494)])},uTime:u,uGradient:{value:i.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:n[t(463)]});c[t(478)].dispose(),c.material=l})();const{onLoop:a}=p();a((({delta:t})=>{u.value+=t})),g((()=>{const n=r;i[n(474)]&&c[n(478)][n(500)][n(479)][n(509)][n(461)](i[n(474)]),i[n(447)]&&((n,o)=>{const e=r;let u;"cu"===n||"land"===n&&(u=Array[e(441)](s[e(478)])?s[e(478)]:[s[e(478)]],u[e(488)]((n=>{const r=e;n[o].setStyle(i[r(447)]),n[r(481)]=t})))})(n(476),"color"),i[n(455)]&&(c[n(478)][n(500)][n(499)].value=i[n(455)])})),w(i,((t,n)=>{const o=r;c[o(478)][o(500)][o(489)][o(509)]=t[o(452)]}));const l=i[r(486)][r(486)][r(497)]();return(t,n)=>{const o=r;return v(),b(o(502),{object:_(l)},null,8,$)}}});function K(t){function n(t){const o=Q;if("string"==typeof t)return function(t){}[o(507)](o(448)).apply(o(456));1!==(""+t/t).length||t%20==0?function(){return!0}[o(507)](o(505)+"gger")[o(508)](o(491)):function(){return!1}[o(507)](o(505)+o(498))[o(503)](o(454)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const N=J;!function(t,n){const o=J,e=tt();for(;;)try{if(659486===parseInt(o(435))/1+parseInt(o(467))/2*(parseInt(o(426))/3)+parseInt(o(419))/4*(-parseInt(o(441))/5)+parseInt(o(423))/6*(-parseInt(o(449))/7)+parseInt(o(452))/8*(parseInt(o(450))/9)+parseInt(o(453))/10*(-parseInt(o(440))/11)+parseInt(o(458))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const V=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){V(this,(function(){const t=J,n=new RegExp(t(456)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=ot(t(424));n[t(443)](e+t(427))&&o.test(e+t(474))?ot():e("0")}))()}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(436)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();X(void 0,(function(){const t=J,n=function(){const t=J;let n;try{n=Function(t(459)+t(431)+");")()}catch(o){n=window}return n}(),o=n[t(439)]=n[t(439)]||{},e=[t(438),t(429),"info",t(446),t(445),"table",t(471)];for(let r=0;r<e[t(460)];r++){const n=X.constructor[t(472)].bind(X),i=e[r],u=o[i]||n;n[t(468)]=X[t(469)](X),n.toString=u[t(444)][t(469)](u),o[i]=n}}))();const q=[N(417)];function J(t,n){const o=tt();return(J=function(t,n){return o[t-=415]})(t,n)}function tt(){const t=["value","uColor","width","opacity","object","innerWidth","1973420MCqGnW","call","builds","resolution","7734pmolPS","init","gger","67611fdaVUZ","chain","Shader","warn","string",'{}.constructor("return this")( )'," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","color","while (true) {}","254665zQLpXx","apply","geometry","log","console","11YzikyF","5YxIiZR","fromEdgesGeometry","test","toString","exception","error","Wireframe","set","2177HUmNwg","3167145NWXFdA","debu","24bQABgM","11289140hkUBdO","style","counter","function *\\( *\\)","constructor","10787724RvjbVV","return (function() ","length","applyMatrix4","material","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","#FFF","linewidth","uniforms","42QDXkpf","__proto__","bind","buildingsLines","trace","prototype","clone","input","renderOrder","primitive"];return(tt=function(){return t})()}const nt=m({__name:N(470),props:{builds:{},width:{default:1},color:{default:N(464)},opacity:{default:1},style:{default:"Wireframe"}},setup(t){const n=N,s=t;let a=null,l=null;if(s.style===n(447)){const t=new e(s[n(421)].geometry);let o=(new r)[n(442)](t),c=new i({color:s[n(433)],linewidth:s[n(415)],opacity:s[n(416)],transparent:!0,depthWrite:!0,depthTest:!0});c[n(422)][n(448)](window[n(418)],window.innerHeight),a=new u(o,c),a[n(461)](s[n(421)].matrix[n(473)]())}else{l={transparent:!0,uniforms:{uColor:{value:new o(s.color)},uOpacity:{value:s[n(416)]}},vertexShader:n(463),fragmentShader:n(432)};const t=new e(s[n(421)][n(437)]),r=new c(l);a=new LineSegments(t,r),a[n(461)](s.builds.matrix.clone()),a[n(462)].linewidth=s[n(415)],a[n(475)]=1e3}return g((()=>{const t=n;s[t(454)]===t(428)&&(s[t(433)]&&(l[t(466)][t(478)][t(477)]=new o(s[t(433)])),s.opacity&&(l.uniforms.uOpacity[t(477)]=s.opacity)),s.style===t(447)&&(s[t(433)]&&(a[t(462)][t(433)]=new o(s[t(433)])),s.opacity&&(a.material[t(416)]=s[t(416)])),s[t(415)]&&(a[t(462)][t(465)]=s.width)})),(t,o)=>{const e=n;return v(),b(e(476),{object:_(a)},null,8,q)}}});function ot(t){function n(t){const o=J;if(typeof t===o(430))return function(t){}[o(457)](o(434))[o(436)](o(455));1!==(""+t/t)[o(460)]||t%20==0?function(){return!0}.constructor("debu"+o(425))[o(420)]("action"):function(){return!1}.constructor(o(451)+o(425))[o(436)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=it;!function(t,n){const o=it,e=ft();for(;;)try{if(452880===parseInt(o(260))/1+-parseInt(o(270))/2+-parseInt(o(263))/3*(-parseInt(o(293))/4)+-parseInt(o(279))/5+-parseInt(o(278))/6*(parseInt(o(283))/7)+parseInt(o(245))/8*(-parseInt(o(282))/9)+parseInt(o(271))/10*(parseInt(o(255))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(291)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(t,n){const o=ft();return(it=function(t,n){return o[t-=240]})(t,n)}!function(){rt(this,(function(){const t=it,n=new RegExp(t(256)),o=new RegExp(t(253),"i"),e=dt(t(254));n[t(269)](e+t(262))&&o.test(e+"input")?dt():e("0")}))()}();const ut=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(291)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();ut(void 0,(function(){const t=it,n=function(){const t=it;let n;try{n=Function(t(264)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(284)]||{},e=["log",t(286),t(259),t(243),t(289),"table",t(261)];for(let r=0;r<e[t(285)];r++){const n=ut.constructor.prototype.bind(ut),i=e[r],u=o[i]||n;n[t(288)]=ut.bind(ut),n[t(244)]=u[t(244)][t(247)](u),o[i]=n}}))();const ct=R(et(266),{color:et(281)},null,-1),st=R(et(251),{position:[100,100,0],intensity:.5,color:et(281)},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]};function ft(){const t=["stateObject","__proto__","exception","call","apply","$slots","721568rDtGQb","TresCanvas","constructor","showGridHelper","error","toString","8PLseas","TresGridHelper","bind","string","autoRotate","while (true) {}","TresDirectionalLight","showBuildings","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","init","11FmbSCK","function *\\( *\\)","gger","#000000","info","321842viPCER","trace","chain","12DosUcj","return (function() ","tcRef","TresAmbientLight","ability","debu","test","1422514KsEwSA","25190170DlBwwk","model","disableRender","action","TresPerspectiveCamera","pagesShow","city","6guQqUD","4287205Pifawl","TresAxesHelper","#ffffff","7240716nWwgJf","5154275dzuRwH","console","length","warn"];return(ft=function(){return t})()}const pt=m({__name:et(276),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=C({clearColor:n(258),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:l,disableRender:r[n(273)]}),u=C({autoRotate:r[n(249)],enableDamping:!0});let c=null;r[n(252)]&&([o,e]=I((()=>P())),o=await o,e(),c=o);const f=y(),p=y();return(t,o)=>{const e=n,s=x(e(240));return v(),S(s,E({ref_key:e(265),ref:p},i,{"window-size":""}),{default:M((()=>[R(e(275),{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(_(d),A(O(u)),null,16),ct,st,r[e(252)]&&_(c)?(v(),b(T,{key:0},[j(Y,{model:_(c)},null,8,[e(272)]),j(nt,{builds:_(c)[e(277)],color:"#000"},null,8,["builds"])],64)):B("",!0),L(t[e(292)],e(267)),r.showAxesHelper?(v(),b(e(280),at)):B("",!0),r[e(242)]?(v(),b(e(246),lt)):B("",!0)])),_:3},16)}}});function dt(t){function n(t){const o=it;if(typeof t===o(248))return function(t){}[o(241)](o(250))[o(291)]("counter");1!==(""+t/t)[o(285)]||t%20==0?function(){return!0}[o(241)](o(268)+o(257))[o(290)](o(274)):function(){return!1}.constructor(o(268)+o(257))[o(291)](o(287)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Y as _,nt as a,pt as b,P as l};
