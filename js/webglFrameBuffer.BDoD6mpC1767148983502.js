import{importShared as l}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{initShaders as N,resizeCanvasToDisplaySize as O,create as T,perspective as W,rotate as Y,lookAt as z,multiply as C,degToRad as H}from"./ice-utils.DxlS1nCJ1767148983502.js";const{defineComponent:k}=await l("vue"),{openBlock:q,createElementBlock:V}=await l("vue"),j={id:"canvaswebgl",style:{height:"500px",width:"500px"}},{onMounted:K}=await l("vue"),J=`
attribute vec4 a_position;
attribute vec2 a_texcoord;
uniform mat4 u_matrix;
varying vec2 v_texcoord;
void main() {
  gl_Position = u_matrix * a_position;
  v_texcoord = a_texcoord;
}`,Q=`
precision mediump float;
varying vec2 v_texcoord;
uniform sampler2D u_texture;
void main(){
	gl_FragColor=texture2D(u_texture, v_texcoord.xy);
}
`,re=k({__name:"webglFrameBuffer",setup(Z){const w=function(){const e=document.querySelector("#canvaswebgl")?.getContext("webgl");if(!e)return;var E=N(e,J,Q),f=e.getAttribLocation(E,"a_position"),A=e.getAttribLocation(E,"a_texcoord"),y=e.getUniformLocation(E,"u_matrix"),I=e.getUniformLocation(E,"u_texture"),x=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,x),M(e);var d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),h(e);var F=e.createTexture();e.bindTexture(e.TEXTURE_2D,F);{const a=e.RGBA,t=1,n=1,i=0,c=e.RGBA,_=e.UNSIGNED_BYTE,m=new Uint8Array([255,255,0,255]);e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,a,t,n,i,c,_,m),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}const R=256,u=256,v=e.createTexture();e.bindTexture(e.TEXTURE_2D,v);{const a=e.RGBA,t=0,n=e.RGBA,i=e.UNSIGNED_BYTE;e.texImage2D(e.TEXTURE_2D,0,a,R,u,t,n,i,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}const U=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,U);const S=e.COLOR_ATTACHMENT0;e.framebufferTexture2D(e.FRAMEBUFFER,S,e.TEXTURE_2D,v,0);var b=H(0),p=0;requestAnimationFrame(D);function B(o){e.useProgram(E),e.enableVertexAttribArray(f),e.bindBuffer(e.ARRAY_BUFFER,x);var a=3,t=e.FLOAT,n=!1,i=0,c=0;e.vertexAttribPointer(f,a,t,n,i,c),e.enableVertexAttribArray(A),e.bindBuffer(e.ARRAY_BUFFER,d);var a=2,t=e.FLOAT,n=!1,i=0,c=0;e.vertexAttribPointer(A,a,t,n,i,c);var _=T();W(_,-30,o,.1,1e4);var m=[0,0,2],g=[0,1,0],G=[0,0,0];let s=T();s=Y(s,s,b,[0,1,0]);var P=T();z(P,m,G,g);let L=T();C(L,P,s);var X=T();C(X,_,L),e.uniformMatrix4fv(y,!1,X),e.uniform1i(I,0),e.drawArrays(e.TRIANGLES,0,36)}function D(o){o*=.001;var a=o-p;p=o,b+=-.4*a,O(e.canvas),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST);{e.bindFramebuffer(e.FRAMEBUFFER,U),e.bindTexture(e.TEXTURE_2D,F),e.viewport(0,0,R,u),e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const t=R/u;B(t)}{e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,v),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const t=e.canvas.clientWidth/e.canvas.clientHeight;B(t)}requestAnimationFrame(D)}};K(()=>{w()});function M(r){var e=new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5]);r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)}function h(r){r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1]),r.STATIC_DRAW)}return(r,e)=>(q(),V("canvas",j))}});export{re as default};
