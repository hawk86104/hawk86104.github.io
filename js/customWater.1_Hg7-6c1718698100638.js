import{a5 as t,C as e}from"./three.erXpfL-r1718698100638.js";import{T as n,r,d as o,P as s}from"./@tresjs.aawOCoPx1718698100638.js";import{a}from"./index.eYkSz4SJ1718698100638.js";import"./index.3kkg0GDh1718698100638.js";import{C as i}from"./three-custom-shader-material.tCYfd9sl1718698100638.js";import"./object-hash.SpRbwitp1718698100638.js";import"./@amap.TW6HTmRb1718698100638.js";import"./glsl-tokenizer.RLlRtTA81718698100638.js";import{p as l}from"./gl-noise.BrVtymbx1718698100638.js";import{d as c,b as u,a2 as p,w as f,o as g,D as h,J as m,j as v,u as d,r as _,f as b,g as w,aj as j,ak as y,m as M,al as x}from"./@vue.CpOXM7bB1718698100638.js";import{P as C}from"./tweakpane.qqn77PB81718698100638.js";import{_ as T}from"./gridPlusCom.vue_vue_type_script_setup_true_lang.qDBlx9GX1718698100638.js";import"./@vueuse.TW6-TkVF1718698100638.js";import"./three-stdlib.Jy3o-bPq1718698100638.js";import"./@pmndrs.ZdH7ThqA1718698100638.js";import"./reflectorDiffuse.vue_vue_type_script_setup_true_lang.5Mxe9wyc1718698100638.js";import"./all.three.Qw9uPAR91718698100638.js";import"./oimophysics.x0jH7fze1718698100638.js";import"./reflectorDUDV.vue_vue_type_script_setup_true_lang.sS7BPjbz1718698100638.js";import"./reflectorShaderMesh.vue_vue_type_script_setup_true_lang.q9lKgk461718698100638.js";import"./whiteFloorMesh.vue_vue_type_script_setup_true_lang.Cm8BYm5T1718698100638.js";import"./videoFloor.vue_vue_type_script_setup_true_lang.lgnn57Ui1718698100638.js";import"./glsl-token-string.IbwI77yI1718698100638.js";import"./glsl-token-functions.LDKY2qLw1718698100638.js";import"./jszip.KspeudHJ1718698100638.js";const z=I;!function(t,e){const n=I,r=G();for(;;)try{if(515097===-parseInt(n(327))/1+parseInt(n(348))/2+parseInt(n(351))/3+parseInt(n(371))/4*(parseInt(n(342))/5)+parseInt(n(383))/6*(-parseInt(n(329))/7)+parseInt(n(328))/8*(-parseInt(n(338))/9)+parseInt(n(339))/10)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const S=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[I(335)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function I(t,e){const n=G();return(I=function(t,e){return n[t-=327]})(t,e)}!function(){S(this,(function(){const t=I,e=new RegExp(t(359)),n=new RegExp(t(344),"i"),r=D(t(369));e[t(372)](r+"chain")&&n[t(372)](r+"input")?D():r("0")}))()}();const W=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[I(335)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();W(void 0,(function(){const t=I,e=function(){const t=I;let e;try{e=Function(t(366)+t(334)+");")()}catch(n){e=window}return e}(),n=e[t(353)]=e.console||{},r=["log","warn",t(362),"error",t(345),t(368),t(336)];for(let o=0;o<r.length;o++){const e=W.constructor.prototype.bind(W),s=r[o],a=n[s]||e;e.__proto__=W[t(352)](W),e.toString=a.toString[t(352)](a),n[s]=e}}))();const B=["rotation-x"],P=[z(365)];function G(){const t=["fragment","765387PlLdUy","14376870dbgXWt","uTime","Flatshading","1395gKXqVr","#52a7f7","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","exception","tmRef","baseMaterial","427294YuqjKC","while (true) {}","length","1004022ETTXwL","bind","console","convertLinearToSRGB","customWaterMesh","needsUpdate","vertexShader","waterHighlight","function *\\( *\\)","vertex","uHeight","info","MeshPhysicalMaterial","TresMesh","args","return (function() ","material","table","init","counter","10980jZcVFU","test","TresBoxGeometry","value","Color","height","constructor","waterColor","action","gger","debu","DoubleSide","6VbgPAs","#b3ffff","call","1005013FyPJpb","56AwIjIE","4455164zICJDG","brightness","side","flatShading","fragmentShader",'{}.constructor("return this")( )',"apply","trace"];return(G=function(){return t})()}const H=c({__name:z(355),props:{height:{default:.2},Flatshading:{type:Boolean,default:!1},waterColor:{default:z(343)},waterHighlight:{default:z(384)},brightness:{default:1},baseMaterial:{default:t[z(363)]}},setup(o){const s=z,a=o,c=u(null),_={vertex:"\nuniform float uTime;\nuniform float uHeight;\nvarying float vHeight;\n\nvec3 displace(vec3 point) {\n  vec3 p = point;\n  p.y += uTime * 2.0;\n  gln_tFBMOpts fbmOpts = gln_tFBMOpts(1.0, 0.4, 2.3, 0.4, 1.0, 5, false, false);\n  gln_tGerstnerWaveOpts A = gln_tGerstnerWaveOpts(vec2(0.0, -1.0), 0.5, 2.0);\n  gln_tGerstnerWaveOpts B = gln_tGerstnerWaveOpts(vec2(0.0, 1.0), 0.25, 4.0);\n  gln_tGerstnerWaveOpts C = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.15, 6.0);\n  gln_tGerstnerWaveOpts D = gln_tGerstnerWaveOpts(vec2(1.0, 1.0), 0.4, 2.0);\n  vec3 n = vec3(0.0);\n  if(p.z >= uHeight / 2.0) {\n      n.z += gln_normalize(gln_pfbm(p.xy + (uTime * 0.5), fbmOpts));\n      n += gln_GerstnerWave(p, A, uTime).xzy;\n      n += gln_GerstnerWave(p, B, uTime).xzy * 0.5;\n      n += gln_GerstnerWave(p, C, uTime).xzy * 0.25;\n      n += gln_GerstnerWave(p, D, uTime).xzy * 0.2;\n  }\n  vHeight = n.z;\n  return point + n;\n}\n\nvec3 orthogonal(vec3 v) {\n  return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0)\n  : vec3(0.0, -v.z, v.y));\n}\n\nvec3 recalcNormals(vec3 newPos) {\n  float offset = 0.001;\n  vec3 tangent = orthogonal(normal);\n  vec3 bitangent = normalize(cross(normal, tangent));\n  vec3 neighbour1 = position + tangent * offset;\n  vec3 neighbour2 = position + bitangent * offset;\n\n  vec3 displacedNeighbour1 = displace(neighbour1);\n  vec3 displacedNeighbour2 = displace(neighbour2);\n\n  vec3 displacedTangent = displacedNeighbour1 - newPos;\n  vec3 displacedBitangent = displacedNeighbour2 - newPos;\n\n  return normalize(cross(displacedTangent, displacedBitangent));\n}\n\nvoid main() {\n  csm_Position = displace(position);\n  csm_Normal = recalcNormals(csm_Position);\n}\n\t",fragment:"\nvarying float vHeight;\nuniform vec3 waterColor;\nuniform vec3 waterHighlight;\nuniform float offset;\nuniform float contrast;\nuniform float brightness;\n\nvec3 calcColor() {\n  float mask = (pow(vHeight, 2.) - offset) * contrast;\n  vec3 diffuseColor = mix(waterColor, waterHighlight, mask);\n  diffuseColor *= brightness;\n  return diffuseColor;\n}\n\nvoid main() {\n  csm_DiffuseColor = vec4(calcColor(), 1.0);\n}\n\t"},b={uTime:{value:0},waterColor:{value:new(t[s(375)])(a[s(378)])[s(354)]()},waterHighlight:{value:new(t[s(375)])(a.waterHighlight)[s(354)]()},offset:{value:.4},contrast:{value:3.1},brightness:{value:a.brightness},uHeight:{value:a[s(376)]}},{onLoop:w}=r();return w((({elapsed:t})=>{b[s(340)].value=-t/5})),p((()=>{const t=s;a[t(376)]&&(b[t(361)][t(374)]=a[t(376)]),a[t(378)]&&(b.waterColor[t(374)]=new e(a[t(378)])[t(354)]()),a[t(358)]&&(b[t(358)].value=new e(a[t(358)])[t(354)]()),a.brightness&&(b[t(330)][t(374)]=a[t(330)])})),f((()=>a[s(341)]),(t=>{const e=s;c[e(374)][e(367)][e(356)]=!0})),f((()=>a[s(347)]),(e=>{const n=s,r=new i({baseMaterial:t[e],vertexShader:l(_[n(360)]),fragmentShader:_[n(337)],uniforms:b,flatShading:a[n(341)],side:t[n(382)],roughness:.2,metalness:.1,silent:!0});c[n(374)][n(367)].dispose(),c[n(374)][n(367)]=r})),(e,r)=>{const o=s;return g(),h(o(364),{ref_key:o(346),ref:c,"rotation-x":-Math.PI/2},[m(o(373),{args:[5,5,e.height,64,64,1]},null,8,P),v(d(n),{baseMaterial:t[o(363)],vertexShader:d(l)(_[o(360)]),fragmentShader:_[o(337)],uniforms:b,side:t[o(382)],roughness:.2,metalness:.1,flatShading:e.Flatshading,silent:""},null,8,[o(347),o(357),o(333),o(331),o(332)])],8,B)}}});function D(t){function e(t){const n=I;if("string"==typeof t)return function(t){}[n(377)](n(349))[n(335)](n(370));1!==(""+t/t)[n(350)]||t%20==0?function(){return!0}[n(377)](n(381)+n(380))[n(385)](n(379)):function(){return!1}.constructor(n(381)+n(380))[n(335)]("stateObject"),e(++t)}try{if(t)return e;e(0)}catch(n){}}const O=A;!function(t,e){const n=A,r=F();for(;;)try{if(207792===-parseInt(n(129))/1+-parseInt(n(146))/2+-parseInt(n(148))/3*(parseInt(n(144))/4)+parseInt(n(118))/5+-parseInt(n(153))/6+parseInt(n(135))/7*(parseInt(n(119))/8)+parseInt(n(143))/9)break;r.push(r.shift())}catch(o){r.push(r.shift())}}();const k=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[A(172)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function F(){const t=["prototype","MeshStandardMaterial","log","label","https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/images/skyBox/6jpg/","MeshNormalMaterial","neg-z.jpg","debu","346664OYTpkh","#3a78a2","customWater","baseMaterial","constructor","error","638638qcyOCS","neg-y.jpg","MeshToonMaterial","waterColor","MeshDepthMaterial","brightness","TresAmbientLight","MeshPhongMaterial","9637119rwjfqS","4hJplHW","MeshLambertMaterial","789634tDKeWl","string","994701Nvmsaj","水体颜色","test","ACESFilmicToneMapping","value","1624272BMaEZy","input","addBlade","length","toString","function *\\( *\\)","addBinding","bind","counter","files",'{}.constructor("return this")( )',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","target","call","__proto__","init","#b3ffff","table","pos-x.jpg","apply","console","gger","TresPerspectiveCamera","#52a7f7","exception","height","info","Flatshading","579125owcWZB","32hXNDWs","MeshPhysicalMaterial"];return(F=function(){return t})()}!function(){k(this,(function(){const t=A,e=new RegExp(t(158)),n=new RegExp(t(164),"i"),r=q(t(168));e[t(150)](r+"chain")&&n[t(150)](r+t(154))?q():r("0")}))()}();const N=function(){let t=!0;return function(e,n){const r=t?function(){if(n){const t=n[A(172)](e,arguments);return n=null,t}}:function(){};return t=!1,r}}();function A(t,e){const n=F();return(A=function(t,e){return n[t-=114]})(t,e)}N(void 0,(function(){const t=A,e=function(){const t=A;let e;try{e=Function("return (function() "+t(163)+");")()}catch(n){e=window}return e}(),n=e[t(173)]=e[t(173)]||{},r=[t(123),"warn",t(116),t(134),t(114),t(170),"trace"];for(let o=0;o<r[t(156)];o++){const e=N.constructor[t(121)][t(160)](N),s=r[o],a=n[s]||e;e[t(167)]=N[t(160)](N),e[t(157)]=a[t(157)][t(160)](a),n[s]=e}}))();const E=m(O(175),{position:[5,5,5],fov:45,near:.1,far:1e3},null,-1),R=m(O(141),{intensity:.5},null,-1),L=m("TresDirectionalLight",{position:[15,15,15],intensity:1},null,-1),Z=c({__name:O(131),setup(e){const n=O,r=_({alpha:!0,toneMapping:t[n(151)],windowSize:!0,clearColor:10066329}),i=_({enableDamping:!0,autoRotate:!1}),l=_({cellSize:.6,cellThickness:1.1,cellColor:"#627179",sectionColor:n(130),sectionSize:2.4,sectionThickness:1.8,fadeDistance:27,fadeStrength:.76,followCamera:!1,infiniteGrid:!0}),c=_({height:.2,Flatshading:!1,waterColor:n(176),waterHighlight:n(169),brightness:1,baseMaterial:n(120)}),u=new C;return u.addBinding(c,n(115),{label:"高度",min:.1,max:5,step:.1}),u[n(159)](c,n(138),{label:n(149)}),u.addBinding(c,"waterHighlight",{label:"浪头颜色"}),u[n(159)](c,n(140),{label:"亮度",min:0,max:1,step:.01}),u[n(159)](c,"Flatshading",{label:n(117)}),u[n(155)]({view:"list",label:"材质",options:[{text:n(120),value:n(120)},{text:"MeshBasicMaterial",value:"MeshBasicMaterial"},{text:n(126),value:n(126)},{text:n(122),value:n(122)},{text:"MeshPhongMaterial",value:n(142)},{text:n(137),value:n(137)},{text:n(145),value:n(145)},{text:"MeshDepthMaterial",value:n(139)}],value:c[n(132)]}),u.on("change",(t=>{const e=n;"材质"===t[e(165)][e(124)]&&(c[e(132)]=t[e(152)])})),(t,e)=>{const u=n;return g(),b(d(s),M(r,{"window-size":""}),{default:w((()=>[E,v(d(o),j(y(i)),null,16),R,L,v(H,j(y(c)),null,16),v(d(T),M({args:[3,3]},l,{position:[0,-.5,0]}),null,16),(g(),b(x,null,{default:w((()=>[v(d(a),{files:[u(171),"neg-x.jpg","pos-y.jpg",u(136),"pos-z.jpg",u(127)],path:u(125)},null,8,[u(162)])])),_:1}))])),_:1},16)}}});function q(t){function e(t){const n=A;if(typeof t===n(147))return function(t){}[n(133)]("while (true) {}")[n(172)](n(161));1!==(""+t/t)[n(156)]||t%20==0?function(){return!0}[n(133)](n(128)+n(174))[n(166)]("action"):function(){return!1}[n(133)](n(128)+n(174)).apply("stateObject"),e(++t)}try{if(t)return e;e(0)}catch(n){}}export{Z as default};
