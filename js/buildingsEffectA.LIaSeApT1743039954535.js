import{P as t}from"./tweakpane.ivGeiIdz1743039954535.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.b4o8R7En1743039954535.js";import{e}from"./@tresjs.05J-Im0t1743039954535.js";import{z as r}from"./three-custom-shader-material.CRbjOKjC1743039954535.js";import{A as i,_ as u,C as c,ct as a,n as s,bc as l}from"./three.XuMWWlrU1743039954535.js";import{d as f,a2 as p,w as d,o as m,H as v,u as g,a3 as h,r as y,f as w,g as C,j as _,m as b}from"./@vue.C4dqouNn1743039954535.js";import"./buildingsCustomShaderMaterial.hq-IAd4G1743039954535.js";import"./postprocessing.YRVqsIkW1743039954535.js";import"./@vueuse.NzAeD-Dt1743039954535.js";const x=P;!function(t,n){const o=P,e=j();for(;;)try{if(208884===-parseInt(o(447))/1*(-parseInt(o(454))/2)+-parseInt(o(479))/3+parseInt(o(459))/4+-parseInt(o(427))/5+parseInt(o(480))/6*(parseInt(o(421))/7)+-parseInt(o(434))/8*(-parseInt(o(450))/9)+parseInt(o(483))/10*(parseInt(o(431))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=P,n=new RegExp(t(473)),o=new RegExp(t(474),"i"),e=O(t(484));n[t(425)](e+t(472))&&o.test(e+t(467))?O():e("0")}))()}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[P(417)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();M(void 0,(function(){const t=P;let n;try{n=Function(t(426)+t(415)+");")()}catch(r){n=window}const o=n.console=n[t(476)]||{},e=[t(418),t(445),t(433),"error",t(435),t(448),t(464)];for(let i=0;i<e[t(429)];i++){const n=M[t(438)][t(466)].bind(M),r=e[i],u=o[r]||n;n[t(420)]=M[t(416)](M),n[t(444)]=u[t(444)][t(416)](u),o[r]=n}}))();const S=[x(443)];function j(){const t=["1aqXIiC","table","side","1989hJRZjQ","model","gger","string","354854liAZkM","landColor","material","computeBoundingSphere","gradient","631540erQjuJ","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","#ffff00","clone","#ffffff","trace","topColor","prototype","input","color","computeBoundingBox","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","city","chain","function *\\( *\\)","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","land","console","forEach","boundingBox","635124KqbBRZ","30432keoCkR","Color","debu","10DUYCbg","init",'{}.constructor("return this")( )',"bind","apply","log","uGradient","__proto__","105oKQIvR","setStyle","bModel","bulidingsColor","test","return (function() ","1992080osodPq","uniforms","length","uTime","601469ejVUwa","uOpacity","info","12776FSZYiR","exception","#e523ff","value","constructor","opacity","uColor","action","DoubleSide","object","toString","warn","counter"];return(j=function(){return t})()}const T=f({__name:x(423),props:{model:{},bulidingsColor:{default:x(436)},landColor:{default:"#112233"},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,c=o[n(451)][n(471)];o.model[n(451)].children[0][n(456)]=new i({color:n(461)}),c.renderOrder=1001;const a=o[n(451)][n(475)];(()=>{const t=n,{geometry:e}=c;e[t(469)](),e[t(457)]();const{max:i,min:a}=e[t(478)];if(c[t(456)].__csm)return;const s=new r({baseMaterial:c[t(456)],vertexShader:t(460),fragmentShader:t(470),silent:!0,uniforms:{uMax:{value:i},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(u[t(481)])(o[t(424)])},uOpacity:{value:o[t(439)]},uLightColor:{value:new(u[t(481)])(t(463))},uTopColor:{value:new(u[t(481)])(o[t(465)])},uTime:{value:0},uGradient:{value:o[t(458)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:u[t(442)]});c[t(456)].dispose(),c[t(456)]=s})();const{onLoop:s}=e();s((({delta:t})=>{const o=n;c[o(456)][o(428)][o(430)].value+=t})),p((()=>{const t=n;o[t(424)]&&c[t(456)][t(428)][t(440)][t(437)][t(422)](o[t(424)]),o[t(455)]&&((t,e)=>{const r=n;let i;"cu"===t||t===r(475)&&(i=Array.isArray(a[r(456)])?a.material:[a.material],i[r(477)]((t=>{const n=r;t[e].setStyle(o[n(455)]),t[n(449)]=u[n(442)]})))})("land",t(468)),o[t(439)]&&(c[t(456)][t(428)][t(432)].value=o.opacity)})),d(o,((t,o)=>{const e=n;c[e(456)][e(428)][e(419)][e(437)]=t[e(458)]}));const l=o[n(451)].model[n(462)]();return(t,n)=>(m(),v("primitive",{object:g(l)},null,8,S))}});function P(t,n){const o=j();return P=function(t,n){return o[t-=415]},P(t,n)}function O(t){function n(t){const o=P;if(typeof t===o(453))return function(t){}.constructor("while (true) {}").apply(o(446));1!==(""+t/t)[o(429)]||t%20==0?function(){return!0}[o(438)](o(482)+"gger").call(o(441)):function(){return!1}.constructor(o(482)+o(452)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const B=R;!function(t,n){const o=R,e=Z();for(;;)try{if(751292===parseInt(o(257))/1+parseInt(o(291))/2*(parseInt(o(272))/3)+-parseInt(o(246))/4+parseInt(o(258))/5*(-parseInt(o(259))/6)+-parseInt(o(251))/7+-parseInt(o(277))/8*(parseInt(o(278))/9)+parseInt(o(284))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(265)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function R(t,n){const o=Z();return R=function(t,n){return o[t-=239]},R(t,n)}!function(){F(this,(function(){const t=R,n=new RegExp(t(275)),o=new RegExp(t(250),"i"),e=E(t(264));n.test(e+t(255))&&o[t(274)](e+t(239))?E():e("0")}))()}();const A=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[R(265)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();A(void 0,(function(){const t=R,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(271)]=n[t(271)]||{},e=[t(294),t(240),t(269),t(279),t(263),t(254),t(280)];for(let r=0;r<e[t(270)];r++){const n=A[t(282)].prototype[t(252)](A),i=e[r],u=o[i]||n;n[t(241)]=A[t(252)](A),n[t(247)]=u[t(247)][t(252)](u),o[i]=n}}))();const z=[B(290)];function Z(){const t=["apply","matrix","builds","primitive","info","length","console","3ePtJzy","string","test","function *\\( *\\)","while (true) {}","24WRsxze","335169NhtlQY","error","trace","uniforms","constructor","gradual","25978770GTVIbC","scale","uTime","uColor","renderOrder","linewidth","object","1079204TeVXoP","speed","debu","log","width","input","warn","__proto__","applyMatrix4","bLine","uGradual","#000","5736992zbYlof","toString","color","material","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","1645350UfiMTS","bind","value","table","chain","srcColor","569132oUnHiH","5MMNsqo","7045788kNfpOw","gger","counter","#FFF","exception","init"];return(Z=function(){return t})()}const k=f({__name:B(243),props:{builds:{},color:{default:B(262)},srcColor:{default:B(245)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o.color)},uSrcColor:{value:new c(o[n(256)])},uScale:{value:o.scale},uTime:{value:0},uGradual:{value:o[n(283)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new a(o[n(267)].geometry).clone();u=u[n(242)](o[n(267)][n(266)]);const f=new s(i);r=new l(u,f),r[n(249)][n(289)]=o[n(295)],r[n(288)]=1e3,p((()=>{const t=n;o[t(248)]&&(i.uniforms[t(287)][t(253)]=new c(o[t(248)])),o[t(256)]&&(i[t(281)].uSrcColor[t(253)]=new c(o[t(256)])),o.scale&&(i[t(281)].uScale[t(253)]=o[t(285)]),o[t(283)]&&(i[t(281)][t(244)][t(253)]=o[t(283)])}));const{onLoop:d}=e();return d((({delta:t})=>{const e=n;i[e(281)][e(286)][e(253)]+=t*o[e(292)],i[e(281)][e(286)][e(253)]%=1})),(t,o)=>{const e=n;return m(),v(e(268),{object:g(r)},null,8,z)}}});function E(t){function n(t){const o=R;if(typeof t===o(273))return function(t){}.constructor(o(276)).apply(o(261));1!==(""+t/t)[o(270)]||t%20==0?function(){return!0}[o(282)](o(293)+"gger").call("action"):function(){return!1}[o(282)]("debu"+o(260))[o(265)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const G=W;!function(t,n){const o=W,e=H();for(;;)try{if(581073===-parseInt(o(328))/1*(parseInt(o(317))/2)+parseInt(o(298))/3+parseInt(o(338))/4+parseInt(o(309))/5*(parseInt(o(312))/6)+-parseInt(o(327))/7*(parseInt(o(330))/8)+-parseInt(o(319))/9*(parseInt(o(310))/10)+parseInt(o(315))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){L(this,(function(){const t=W,n=new RegExp(t(346)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=J(t(307));n.test(e+t(323))&&o[t(324)](e+"input")?J():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(342)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["trace","call","toString","1673764EpSJLL","info","length","console","apply","gger","bind","效果参数","function *\\( *\\)","return (function() ","gradual","table","stateObject","698064qxByHp","string","action","constructor","log","扩散系数","#999","线扫颜色","exception","init","while (true) {}","95PXfJpO","3108170ccuiWE","warn","88260JxkNRY","builds","scale","21916763oAVDhF","addBinding","2212250otbLPZ","最大扩散","9jeevze","prototype",'{}.constructor("return this")( )',"city","chain","test","speed","counter","161dShXos","1rNQNeZ","debu","321752WbgQjb","线原颜色","buildingsEffectA","srcColor","#FFF"];return(H=function(){return t})()}function W(t,n){const o=H();return W=function(t,n){return o[t-=298]},W(t,n)}D(void 0,(function(){const t=W,n=function(){const t=W;let n;try{n=Function(t(347)+t(321)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(341)]||{},e=[t(302),t(311),t(339),"error",t(306),t(349),t(335)];for(let r=0;r<e[t(340)];r++){const n=D[t(301)][t(320)][t(344)](D),i=e[r],u=o[i]||n;n.__proto__=D[t(344)](D),n[t(337)]=u[t(337)][t(344)](u),o[i]=n}}))();const $=f({__name:G(332),async setup(e){const r=G;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),a=y({color:r(334),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),s=new t({title:r(345),expanded:!0});return s[r(316)](a,r(333),{label:r(331)}),s[r(316)](a,"color",{label:r(305)}),s.addBinding(a,r(325),{label:"速度",min:.1,max:1,step:.1}),s[r(316)](a,r(314),{label:r(318),min:10,max:2e3,step:10}),s.addBinding(a,r(348),{label:r(303),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[_(T,{model:g(c),bulidingsColor:"#000000",landColor:"#112233",topColor:e(304)},null,8,["model"]),_(k,b({builds:g(c)[e(322)]},a),null,16,[e(313)])])),_:1})}}});function J(t){function n(t){const o=W;if(typeof t===o(299))return function(t){}.constructor(o(308))[o(342)](o(326));1!==(""+t/t)[o(340)]||t%20==0?function(){return!0}[o(301)](o(329)+o(343))[o(336)](o(300)):function(){return!1}[o(301)](o(329)+o(343))[o(342)](o(350)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
