{"version":3,"file":"regionGlow.vue_vue_type_script_setup_true_lang.BrZi8ehe1767105581793.js","sources":["../../src/plugins/digitalCity/components/fence/regionGlow.vue"],"sourcesContent":["<!--\n * @Description: \n * @Version: 1.668\n * @Autor: 地虎降天龙\n * @Date: 2024-02-02 10:15:51\n * @LastEditors: 地虎降天龙\n * @LastEditTime: 2025-07-04 10:49:56\n-->\n<template>\n\t<TresGroup>\n\t\t<primitive :object=\"fakeGlowMesh\" :renderOrder=\"9999\" :rotation-x=\"Math.PI / 2\" />\n\t\t<primitive :object=\"line2Mesh\" :renderOrder=\"9999\" :rotation-x=\"Math.PI / 2\" />\n\t</TresGroup>\n</template>\n\n<script setup lang=\"ts\">\nimport * as THREE from 'three'\nimport { Line2 } from 'three/examples/jsm/lines/Line2.js'\nimport { LineGeometry } from 'three/examples/jsm/lines/LineGeometry.js'\nimport { LineMaterial } from 'three/examples/jsm/lines/LineMaterial.js'\nimport { resetUV } from '../../common/utils'\nimport { watchEffect } from 'vue'\n\nconst props = withDefaults(\n\tdefineProps<{\n\t\tpositionSrc?: Array<Array>\n\t\tcolor?: string\n\t}>(),\n\t{\n\t\tpositionSrc: [[0, 0], [1, 1]],\n\t\tcolor: '#ffff00',\n\t},\n)\n\nconst shape = new THREE.Shape()\nprops.positionSrc.forEach((item, idx) => {\n\tif (idx === 0) shape.moveTo(item[0], item[1])\n\telse shape.lineTo(item[0], item[1])\n})\n\nconst material = new THREE.ShaderMaterial({\n\tvertexShader: `\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  `,\n\tfragmentShader: `\n    varying vec2 vUv;\n\t\tuniform vec3 color;\n    void main() {\n\t\t\t// 计算距离四条边的最小距离\n        float distance = max(max(vUv.x, -vUv.x), max(vUv.y, -vUv.y));\n\n        // 将距离映射到透明度（从边缘到中心逐渐变透明）\n        float alpha = smoothstep(0.1, 0.9, distance*1.1);\n\n        // 设置最终颜色和透明度\n        gl_FragColor = vec4(color, alpha);\n    }\n  `,\n\ttransparent: true,\n\tside: THREE.DoubleSide,\n\tdepthWrite: false,\n\tdepthTest: true,\n\tuniforms: {\n\t\tcolor: {\n\t\t\ttype: \"uvs\",\n\t\t\tvalue: new THREE.Color(props.color)\n\t\t},\n\t}\n})\n\nlet geometry = new THREE.ShapeGeometry(shape)\nresetUV(geometry, true)\nconst fakeGlowMesh = new THREE.Mesh(\n\tgeometry,\n\tmaterial\n\t// new THREE.MeshBasicMaterial({\n\t// \tcolor: 0x00ff00,\n\t// \ttransparent: true,\n\t// \tside: THREE.DoubleSide,\n\t// }),\n)\n\nconst linePoints = shape.getPoints()\nconst lineGeometry = new LineGeometry()\nlineGeometry.setPositions(linePoints.flatMap(p => [p.x, p.y, 0]))\n\nvar lineMaterial = new LineMaterial({\n\tcolor: new THREE.Color(props.color), linewidth: 2\n})\nconst line2Mesh = new Line2(lineGeometry, lineMaterial)\n\nwatchEffect(() => {\n\tmaterial.uniforms.color.value = new THREE.Color(props.color)\n\tlineMaterial.color = new THREE.Color(props.color)\n})\n</script>"],"names":[],"mappings":"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"}