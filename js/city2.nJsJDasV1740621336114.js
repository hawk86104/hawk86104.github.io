import{e as n,D as e,o as t}from"./@tresjs.Td0X-dew1740621336114.js";import{l as o,a_ as r,C as i,a7 as a,aX as s,y as c,a0 as l,aK as u,cm as f,cn as p,co as d,cp as m}from"./three.sXv6UbbL1740621336114.js";import{z as v}from"./three-custom-shader-material.zFJQzgaY1740621336114.js";import{r as g,i as h,s as y}from"./utils.HPQMEn2J1740621336114.js";import{b as _,a as w}from"./buildingsCustomShaderMaterial.hq-IAd4G1740621336114.js";import{d as b,a3 as x,b as S,o as j,H as I,f as C,g as k,N as O,u as z,al as A,j as M,F as B,e as E}from"./@vue.NRI7TcgI1740621336114.js";import{_ as P}from"./roadLight.vue_vue_type_script_setup_true_lang.ElAVaYKi1740621336114.js";import"./@vueuse.cgJUSr_21740621336114.js";import"./@fesjs.LqZjJP5K1740621336114.js";import"./vue-router.42s9Lhcm1740621336114.js";import"./lodash-es.pklfUAS51740621336114.js";import"./@qlin.yHhFDldE1740621336114.js";import"./pinia.va49Nygd1740621336114.js";import"./@floating-ui.BPbuo5Gx1740621336114.js";import"./@juggle.7yjBMqoW1740621336114.js";import"./three-mesh-bvh.C_z0wpFH1740621336114.js";var T=U;!function(n,e){for(var t=U,o=Z();;)try{if(777713===parseInt(t(127))/1+-parseInt(t(115))/2*(-parseInt(t(139))/3)+-parseInt(t(138))/4*(-parseInt(t(120))/5)+-parseInt(t(149))/6*(parseInt(t(161))/7)+parseInt(t(157))/8*(parseInt(t(137))/9)+parseInt(t(151))/10+-parseInt(t(136))/11)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();var W=function(){var n=!0;return function(e,t){var o=n?function(){if(t){var n=t.apply(e,arguments);return t=null,n}}:function(){};return n=!1,o}}();function U(n,e){var t=Z();return(U=function(n,e){return t[n-=112]})(n,e)}!function(){W(this,(function(){var n=U,e=new RegExp(n(124)),t=new RegExp(n(130),"i"),o=F(n(134));e[n(145)](o+n(112))&&t[n(145)](o+n(155))?F():o("0")}))()}();var N=function(){var n=!0;return function(e,t){var o=n?function(){if(t){var n=t[U(146)](e,arguments);return t=null,n}}:function(){};return n=!1,o}}();function Z(){var n=["enableBlinking","input","length","1864cYowcQ","counter","scanlineSize","setValues","4744089TWwTxG","uniforms",'{}.constructor("return this")( )',"clock","chain","toString","bind","162142RjPqAk","action","table","hologramOpacity","fresnelOpacity","2760pkQwDV","warn","depthTest","signalSpeed","function *\\( *\\)","string","debu","1126823TRJkgw","fragmentShader","hologramBrightness","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","console","stateObject","trace","init","side","13535071jDklSZ","5355mnLPnc","6440LNSWrr","21DMfxaj","constructor","hologramColor","getElapsedTime","prototype","fresnelAmount","test","apply","update"," \n      varying vec2 vUv;\n      varying vec3 vPositionW;\n      varying vec4 vPos;\n      varying vec3 vNormalW;\n      \n      uniform float time;\n      uniform float fresnelOpacity;\n      uniform float scanlineSize;\n      uniform float fresnelAmount;\n      uniform float signalSpeed;\n      uniform float hologramBrightness;\n      uniform float hologramOpacity;\n      uniform bool blinkFresnelOnly;\n      uniform bool enableBlinking;\n      uniform vec3 hologramColor;\n\n      float flicker( float amt, float time ) {return clamp( fract( cos( time ) * 43758.5453123 ), amt, 1.0 );}\n      float random(in float a, in float b) { return fract((cos(dot(vec2(a,b) ,vec2(12.9898,78.233))) * 43758.5453)); }\n\n      void main() {\n        vec2 vCoords = vPos.xy;\n        vCoords /= vPos.w;\n        vCoords = vCoords * 0.5 + 0.5;\n        vec2 myUV = fract( vCoords );\n\n        // Defines hologram main color\n        vec4 hologramColor = vec4(hologramColor, mix(hologramBrightness, vUv.y, 0.5));\n\n        // Add scanlines\n        float scanlines = 10.;\n        scanlines += 20. * sin(time *signalSpeed * 20.8 - myUV.y * 60. * scanlineSize);\n        scanlines *= smoothstep(1.3 * cos(time *signalSpeed + myUV.y * scanlineSize), 0.78, 0.9);\n        scanlines *= max(0.25, sin(time *signalSpeed) * 1.0);        \n        \n        // Scanlines offsets\n        float r = random(vUv.x, vUv.y);\n        float g = random(vUv.y * 20.2, \tvUv.y * .2);\n        float b = random(vUv.y * .9, \tvUv.y * .2);\n\n        // Scanline composition\n        hologramColor += vec4(r*scanlines, b*scanlines, r, 1.0) / 84.;\n        vec4 scanlineMix = mix(vec4(0.0), hologramColor, hologramColor.a);\n\n        // Calculates fresnel\n        vec3 viewDirectionW = normalize(cameraPosition - vPositionW);\n        float fresnelEffect = dot(viewDirectionW, vNormalW) * (1.6 - fresnelOpacity/2.);\n        fresnelEffect = clamp(fresnelAmount - fresnelEffect, 0., fresnelOpacity);\n\n        // Blinkin effect\n        //Suggested by Octano - https://x.com/OtanoDesign?s=20\n        float blinkValue = enableBlinking ? 0.6 - signalSpeed : 1.0;\n        float blink = flicker(blinkValue, time * signalSpeed * .02);\n    \n        // Final shader composition\n        vec3 finalColor;\n\n        if(blinkFresnelOnly){\n          // finalColor = vec3(1.0,1.0,0);\n          finalColor = scanlineMix.rgb + fresnelEffect * blink;\n        }else{\n          finalColor = scanlineMix.rgb * blink + fresnelEffect;\n        }\n\n        gl_FragColor = vec4( finalColor, hologramOpacity);\n\n      }","12jKQMKs","call","6419530SdtxKM","gger","info"];return(Z=function(){return n})()}N(void 0,(function(){var n,e=U;try{n=Function("return (function() "+e(163)+");")()}catch(c){n=window}for(var t=n.console=n[e(131)]||{},o=["log",e(121),e(153),"error","exception",e(117),e(133)],r=0;r<o[e(156)];r++){var i=N.constructor[e(143)][e(114)](N),a=o[r],s=t[a]||i;i.__proto__=N.bind(N),i[e(113)]=s[e(113)][e(114)](s),t[a]=i}}))();class D extends o{constructor(n={}){var e=U;super(),this.vertexShader="\n      #define STANDARD\n      varying vec3 vViewPosition;\n      #ifdef USE_TRANSMISSION\n      varying vec3 vWorldPosition;\n      #endif\n    \n      varying vec2 vUv;\n      varying vec4 vPos;\n      varying vec3 vNormalW;\n      varying vec3 vPositionW;\n\n      #include <common>\n      #include <uv_pars_vertex>\n      #include <envmap_pars_vertex>\n      #include <color_pars_vertex>\n      #include <fog_pars_vertex>\n      #include <morphtarget_pars_vertex>\n      #include <skinning_pars_vertex>\n      #include <logdepthbuf_pars_vertex>\n      #include <clipping_planes_pars_vertex>\n\n      void main() {\n        \n        #include <uv_vertex>\n        #include <color_vertex>\n        #include <morphcolor_vertex>\n      \n        #if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n      \n          #include <beginnormal_vertex>\n          #include <morphnormal_vertex>\n          #include <skinbase_vertex>\n          #include <skinnormal_vertex>\n          #include <defaultnormal_vertex>\n      \n        #endif\n      \n        #include <begin_vertex>\n        #include <morphtarget_vertex>\n        #include <skinning_vertex>\n        #include <project_vertex>\n        #include <logdepthbuf_vertex>\n        #include <clipping_planes_vertex>\n      \n        #include <worldpos_vertex>\n        #include <envmap_vertex>\n        #include <fog_vertex>\n\n        mat4 modelViewProjectionMatrix = projectionMatrix * modelViewMatrix;\n\n        vUv = uv;\n        vPos = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n        vPositionW = vec3( vec4( transformed, 1.0 ) * modelMatrix);\n        vNormalW = normalize( vec3( vec4( normal, 0.0 ) * modelMatrix ) );\n        \n        gl_Position = modelViewProjectionMatrix * vec4( transformed, 1.0 );\n\n      }",this[e(128)]=e(148),this.uniforms={time:new r(0),fresnelOpacity:new r(void 0!==n[e(119)]?n.fresnelOpacity:1),fresnelAmount:new r(void 0!==n[e(144)]?n[e(144)]:.45),scanlineSize:new r(void 0!==n.scanlineSize?n[e(159)]:8),hologramBrightness:new r(void 0!==n[e(129)]?n[e(129)]:1),signalSpeed:new r(void 0!==n[e(123)]?n[e(123)]:1),hologramColor:new r(void 0!==n[e(141)]?new i(n[e(141)]):new i("#00d5ff")),enableBlinking:new r(void 0===n[e(154)]||n[e(154)]),blinkFresnelOnly:new r(void 0===n.blinkFresnelOnly||n.blinkFresnelOnly),hologramOpacity:new r(void 0!==n[e(118)]?n[e(118)]:1)},this[e(164)]=new a,this[e(160)](n),this.depthTest=void 0!==n[e(122)]&&n[e(122)],this.blending=void 0!==n.blendMode?n.blendMode:s,this.transparent=!0,this[e(135)]=void 0!==n.side?n[e(135)]:c}[T(147)](){var n=T;this[n(162)].time.value=this[n(164)][n(142)]()}}const R=D;function F(n){function e(n){var t=U;if(typeof n===t(125))return function(n){}.constructor("while (true) {}").apply(t(158));1!==(""+n/n)[t(156)]||n%20==0?function(){return!0}[t(140)](t(126)+t(152))[t(150)](t(116)):function(){return!1}.constructor(t(126)+t(152))[t(146)](t(132)),e(++n)}try{if(n)return e;e(0)}catch(t){}}const V=$;!function(n,e){const t=$,o=L();for(;;)try{if(412536===-parseInt(t(395))/1+-parseInt(t(404))/2*(-parseInt(t(394))/3)+parseInt(t(407))/4*(parseInt(t(424))/5)+parseInt(t(388))/6+parseInt(t(381))/7+parseInt(t(399))/8*(parseInt(t(428))/9)+-parseInt(t(385))/10)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const q=function(){let n=!0;return function(e,t){const o=n?function(){if(t){const n=t[$(409)](e,arguments);return t=null,n}}:function(){};return n=!1,o}}();function L(){const n=["log","console","bind","dispose","543987fAdvtw","443940DlUTbB","input","hologramColor","环球金融中心","72888oqyycA","trace","#e00f0f","scanlineSize","error","8Yqbvaj","info","string","36JCGbgn","value","apply","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","name","while (true) {}","toString","金茂大厦","return (function() ","signalSpeed","length","test","call","depthTest",'{}.constructor("return this")( )',"material","01-shanghaizhongxindasha_shanghaizhongxindasha_0","177410qwZoSi","02-huanqiujinrongzhongxin_huanqiujinrongzhongxin_0","gger","uniforms","81aArbUN","geometry","table","clone","constructor","getObjectByName","04-dongfangmingzhu_dongfangmingzhu_0","update","#5e0fe0","group","init","东方明珠塔","fresnelAmount","importantBuildings","1233414BCkKNZ","stateObject","上海中心","counter","9625680qvnrdE","exception","function *\\( *\\)","3097134bnEsbp","prototype"];return(L=function(){return n})()}!function(){q(this,(function(){const n=$,e=new RegExp(n(387)),t=new RegExp(n(410),"i"),o=J(n(377));e[n(418)](o+"chain")&&t[n(418)](o+n(396))?J():o("0")}))()}();const K=function(){let n=!0;return function(e,t){const o=n?function(){if(t){const n=t.apply(e,arguments);return t=null,n}}:function(){};return n=!1,o}}();function $(n,e){const t=L();return($=function(n,e){return t[n-=374]})(n,e)}K(void 0,(function(){const n=$,e=function(){const n=$;let e;try{e=Function(n(415)+n(421)+");")()}catch(t){e=window}return e}(),t=e[n(391)]=e[n(391)]||{},o=[n(390),"warn",n(405),n(403),n(386),n(430),n(400)];for(let r=0;r<o.length;r++){const e=K[n(432)][n(389)][n(392)](K),i=o[r],a=t[i]||e;e.__proto__=K[n(392)](K),e[n(413)]=a.toString[n(392)](a),t[i]=e}}))();const G=b({__name:V(380),props:{group:{}},setup(e){const t=V,o=e,r={fresnelAmount:0,fresnelOpacity:0,scanlineSize:15,signalSpeed:1.3,hologramColor:"#e05b0f"},a=new R({blendMode:s,hologramBrightness:2.5,side:l});a.uniforms.fresnelAmount[t(408)]=r[t(379)],a[t(427)][t(402)][t(408)]=r[t(402)],a.uniforms[t(416)][t(408)]=r[t(416)],a[t(427)].fresnelOpacity[t(408)]=r.fresnelOpacity,a[t(427)][t(397)][t(408)]=new i(r.hologramColor),a[t(427)].enableBlinking[t(408)]=!1,a[t(420)]=!0;let c,u,f=null;(()=>{const n=t,e=o[n(376)][n(433)](n(425));e.name=n(398),e.material[n(393)](),g(e.geometry),e.material=a,c=o[n(376)][n(433)](n(423)),c[n(411)]=n(383),c[n(422)][n(393)](),g(c.geometry),c[n(422)]=a[n(431)](),c[n(422)][n(427)][n(397)][n(408)]=new i("#006cf9"),c.material.uniforms[n(379)][n(408)]=1,c[n(422)][n(427)].scanlineSize.value=2.1,c[n(422)][n(427)][n(416)][n(408)]=.4,u=o.group[n(433)]("03-jinmaodasha_jjinmaodasha_0"),u[n(411)]=n(414),u[n(422)][n(393)](),g(u[n(429)]),u.material=a[n(431)](),u.material[n(427)][n(397)][n(408)]=new i(n(375)),u[n(422)][n(427)].scanlineSize[n(408)]=15,u.material[n(427)][n(416)][n(408)]=.18,f=o[n(376)][n(433)](n(434)),f.name=n(378),f[n(422)][n(393)](),g(f.geometry),f[n(422)]=a[n(431)](),f[n(422)][n(427)][n(402)][n(408)]=5,f.material[n(427)].signalSpeed[n(408)]=1.3,f[n(422)].uniforms[n(397)][n(408)]=new i(n(401)),f.material.uniforms.fresnelOpacity[n(408)]=.1})();const{onLoop:p}=n();return p((()=>{const n=t;a[n(374)](),c[n(422)].update(),u[n(422)][n(374)](),f[n(422)][n(374)]()})),(n,e)=>null}});function J(n){function e(n){const t=$;if(typeof n===t(406))return function(n){}[t(432)](t(412))[t(409)](t(384));1!==(""+n/n)[t(417)]||n%20==0?function(){return!0}.constructor("debu"+t(426))[t(419)]("action"):function(){return!1}[t(432)]("debu"+t(426))[t(409)](t(382)),e(++n)}try{if(n)return e;e(0)}catch(t){}}const H=X;!function(n,e){const t=X,o=nn();for(;;)try{if(800486===parseInt(t(246))/1+parseInt(t(220))/2+parseInt(t(194))/3+parseInt(t(228))/4+-parseInt(t(222))/5+-parseInt(t(195))/6+parseInt(t(245))/7*(-parseInt(t(235))/8))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const Q=function(){let n=!0;return function(e,t){const o=n?function(){if(t){const n=t.apply(e,arguments);return t=null,n}}:function(){};return n=!1,o}}();!function(){Q(this,(function(){const n=X,e=new RegExp("function *\\( *\\)"),t=new RegExp(n(200),"i"),o=on(n(243));e.test(o+"chain")&&t[n(213)](o+n(218))?on():o("0")}))()}();const Y=function(){let n=!0;return function(e,t){const o=n?function(){if(t){const n=t.apply(e,arguments);return t=null,n}}:function(){};return n=!1,o}}();function X(n,e){const t=nn();return(X=function(n,e){return t[n-=193]})(n,e)}function nn(){const n=["4571043JxBOsD","1205718kHPnkb","exception","table","set","gger","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","boundingBox","./draco/","resolution","Object","object","length","constructor","while (true) {}","bind","dispose","clone","primitive","test","log","counter","toString","Floor","input","innerWidth","2989466CEzpTl","info","6288930JIoIvq","warn",'{}.constructor("return this")( )',"computeBoundingBox","geometry","computeBoundingSphere","6000056wkZZml","return (function() ","string","fromEdgesGeometry","isMesh","prototype","#005c58","19104992KbKqeZ","add","material","stateObject","Shanghai","trace","console","innerHeight","init","#000","7FyeLSW","128921LWbvCh","name","traverse","value","position","computeBoundsTree","apply","indexOf","call","error","group","action","#990"];return(nn=function(){return n})()}Y(void 0,(function(){const n=X;let e;try{e=Function(n(229)+n(224)+");")()}catch(r){e=window}const t=e[n(241)]=e[n(241)]||{},o=[n(214),n(223),n(221),n(255),n(196),n(197),n(240)];for(let i=0;i<o[n(206)];i++){const e=Y[n(207)][n(233)][n(209)](Y),r=o[i],a=t[r]||e;e.__proto__=Y[n(209)](Y),e[n(216)]=a.toString[n(209)](a),t[r]=e}}))();const en=[H(205)],tn=b({__name:"buildingsMode",async setup(t){const o=H;let r,a;h();const{scene:s}=([r,a]=x((()=>e("./plugins/digitalCity/model/shanghaiDraco/shanghaiDraco.gltf",{draco:!0,decoderPath:o(202)}))),r=await r,a(),r),c=s[o(211)](),g=S(0);c[o(248)]((async n=>{const e=o;if(n[e(232)]&&(-1!==n[e(247)][e(253)](e(239))||-1!==n.name[e(253)](e(204))))if(-1!==n[e(247)][e(253)](e(217)));else if(-1!==n.name.indexOf("River")){const t=await y(n);t[e(250)][e(198)](0,0,1800),n[e(236)](t)}else(n=>{const e=o,{geometry:t}=n;t[e(225)](),t[e(227)](),t[e(251)]();const{max:r,min:a}=t[e(201)],s=new v({baseMaterial:u,vertexShader:_,fragmentShader:w,silent:!0,uniforms:{uMax:{value:r},uMin:{value:a},uBorderWidth:{value:.006},uCircleTime:{value:3},uColor:{value:new i(e(234))},uOpacity:{value:.8},uLightColor:{value:new i(e(193))},uTopColor:{value:new i("#888800")},uTime:g,uGradient:{value:!0}},depthWrite:!0,depthTest:!0,transparent:!0,side:l});n[e(237)][e(210)](),n.material=s})(n),(n=>{const e=o,t=new f(n[e(226)],1e3);let r=(new p)[e(231)](t);r[e(251)]();let a=new d({color:new i(e(244)),linewidth:.8,opacity:.6,transparent:!0,depthWrite:!0,depthTest:!0});a[e(203)][e(198)](window[e(219)],window[e(242)]),n[e(236)](new m(r,a))})(n)}));const{onLoop:b}=n();return b((({delta:n})=>{g[o(249)]+=n})),(n,e)=>{const t=o;return j(),I(B,null,[(j(),C(A,null,{default:k((()=>[O(t(212),{object:z(c),position:[1,0,1],"cast-shadow":"","receive-shadow":""},null,8,en)])),_:1})),M(G,{group:z(c)},null,8,[t(256)])],64)}}});function on(n){function e(n){const t=X;if(typeof n===t(230))return function(n){}.constructor(t(208))[t(252)](t(215));1!==(""+n/n)[t(206)]||n%20==0?function(){return!0}[t(207)]("debu"+t(199))[t(254)](t(257)):function(){return!1}[t(207)]("debu"+t(199))[t(252)](t(238)),e(++n)}try{if(n)return e;e(0)}catch(t){}}!function(n,e){const t=ln,o=sn();for(;;)try{if(272209===parseInt(t(257))/1+parseInt(t(248))/2+-parseInt(t(263))/3+parseInt(t(278))/4+-parseInt(t(249))/5*(-parseInt(t(272))/6)+-parseInt(t(251))/7+-parseInt(t(252))/8)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const rn=function(){let n=!0;return function(e,t){const o=n?function(){if(t){const n=t[ln(264)](e,arguments);return t=null,n}}:function(){};return n=!1,o}}();!function(){rn(this,(function(){const n=ln,e=new RegExp("function *\\( *\\)"),t=new RegExp(n(259),"i"),o=un(n(268));e.test(o+n(267))&&t.test(o+n(283))?un():o("0")}))()}();const an=function(){let n=!0;return function(e,t){const o=n?function(){if(t){const n=t[ln(264)](e,arguments);return t=null,n}}:function(){};return n=!1,o}}();function sn(){const n=["bind","action","gger","171750ZBlvlp","toString","length","warn","info","call","1092968JLxrfy","plugins/digitalCity/geojson/secondarySmall.geojson","debu","TresDirectionalLight","prototype","input","stateObject","762340fIgKRE","35qgZZyS","TresCanvas","2633848tRgqNh","2098544uPkooH","TresGridHelper","#ffffff","console","constructor","494199MlGwse","log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__proto__","return (function() ","trace","1314585rhrXhu","apply","table","TresAmbientLight","chain","init"];return(sn=function(){return n})()}an(void 0,(function(){const n=ln,e=function(){const n=ln;let e;try{e=Function(n(261)+'{}.constructor("return this")( ));')()}catch(t){e=window}return e}(),t=e[n(255)]=e[n(255)]||{},o=[n(258),n(275),n(276),"error","exception",n(265),n(262)];for(let r=0;r<o.length;r++){const e=an[n(256)][n(282)].bind(an),i=o[r],a=t[i]||e;e[n(260)]=an[n(269)](an),e[n(273)]=a[n(273)].bind(a),t[i]=e}}))();const cn=b({__name:"city2",setup:n=>(n,e)=>{const o=ln,r=E(o(250));return j(),C(r,{shadows:"","window-size":"",clearColor:"#333"},{default:k((()=>[e[0]||(e[0]=O("TresPerspectiveCamera",{position:[.5,2,1.5],fov:45,near:.1,far:1e5},null,-1)),M(z(t)),e[1]||(e[1]=O(o(266),{color:o(254)},null,-1)),e[2]||(e[2]=O(o(281),{position:[0,3,3],intensity:2,color:o(254),"cast-shadow":"","shadow-mapSize-width":1024,"shadow-mapSize-height":1024},null,-1)),(j(),C(A,null,{default:k((()=>[M(tn)])),_:1})),(j(),C(A,null,{default:k((()=>[M(P,{color:o(254),radius:1,speed:1,geoJson:o(279),"rotation-y":1.3826597599330712,scale:.001025905404044292,position:[-1.877460474821603,.01,-1.5464791950519081]})])),_:1})),e[3]||(e[3]=O(o(253),{args:[6,10],position:[0,0,0]},null,-1))])),_:1})}});function ln(n,e){const t=sn();return(ln=function(n,e){return t[n-=248]})(n,e)}function un(n){function e(n){const t=ln;if("string"==typeof n)return function(n){}[t(256)]("while (true) {}")[t(264)]("counter");1!==(""+n/n)[t(274)]||n%20==0?function(){return!0}[t(256)](t(280)+t(271))[t(277)](t(270)):function(){return!1}.constructor(t(280)+t(271))[t(264)](t(284)),e(++n)}try{if(n)return e;e(0)}catch(t){}}export{cn as default};
