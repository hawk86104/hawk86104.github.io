import{m as n,e as t}from"./@tresjs.qWeugQU61734239885681.js";import{_ as o,co as e,cp as r,cq as i,cM as u}from"./three.NPKhDGTA1734239885681.js";import{z as c}from"./three-custom-shader-material._Q1qyIV-1734239885681.js";import{T as a}from"./3d-tiles-renderer._RgVDLoS1734239885681.js";import{d as s,b as f,a3 as l,o as p,D as d,J as m,u as h}from"./@vue.-THQH3GC1734239885681.js";import{P as g,U as v,M as w,T as y,a as x}from"./index.e2fFC5B51734239885681.js";import"./mapBoxShow.vue_vue_type_script_setup_true_lang.8-v6EVEj1734239885681.js";import"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.THY-wPni1734239885681.js";import"./utils.QIztJSEs1734239885681.js";function _(){const n=["279739LWQPPq","table","onLoadTileSet","init","call","string","trace","position","Vector3","Box3","14rhNOJV","group","error","2182794ghpckJ","Quaternion","warn","center","__proto__","clone",'{}.constructor("return this")( )',"length","normalize","prototype","constructor","gger","apply","log","Matrix4","Sphere","exception","stateObject","3942942FZDOCU","toString","chain","1203933BgoLwI","while (true) {}","quaternion","2740652jGDEbv","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","test","setFromMatrixPosition","dot","console","counter","function *\\( *\\)","4975704ORBqNL","bind","debu","1401195PkVhmv","getOrientedBounds"];return(_=function(){return n})()}function b(n,t){const o=_();return(b=function(n,t){return o[n-=142]})(n,t)}!function(n,t){const o=b,e=_();for(;;)try{if(581346===parseInt(o(162))/1+-parseInt(o(175))/2+parseInt(o(146))/3+parseInt(o(149))/4+-parseInt(o(160))/5+-parseInt(o(143))/6+-parseInt(o(172))/7*(-parseInt(o(157))/8))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[b(187)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();!function(){I(this,(function(){const n=b,t=new RegExp(n(156)),o=new RegExp(n(150),"i"),e=j(n(165));t[n(151)](e+n(145))&&o[n(151)](e+"input")?j():e("0")}))()}();const C=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[b(187)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();C(void 0,(function(){const n=b,t=function(){const n=b;let t;try{t=Function("return (function() "+n(181)+");")()}catch(o){t=window}return t}(),o=t[n(154)]=t.console||{},e=[n(188),n(177),"info",n(174),n(191),n(163),n(168)];for(let r=0;r<e[n(182)];r++){const t=C.constructor[n(184)][n(158)](C),i=e[r],u=o[i]||t;t[n(179)]=C.bind(C),t[n(144)]=u.toString[n(158)](u),o[i]=t}}))();const M=n=>{const t=b;n[t(164)]=e=>{const r=t,i=new(o[r(171)]),u=new(o[r(190)]),c=new(o[r(189)]);let a=null,s=0;n[r(161)](i,c)?(a=(new(o[r(170)]))[r(152)](c),s=a[r(182)]()):n.getBoundingSphere(u)&&(a=u[r(178)].clone(),s=a[r(182)]());const f=((n,t)=>{const e=b,r=new(o[e(176)]),i=(new(o[e(170)])).crossVectors(n,t);return r.x=i.x,r.y=i.y,r.z=i.z,r.w=1+n[e(180)]()[e(153)](t),r[e(183)](),r})(null==a?void 0:a[r(183)](),new(o[r(170)])(0,1,0));n[r(173)][r(148)].x=f.x,n.group[r(148)].y=f.y,n[r(173)].quaternion.z=f.z,n[r(173)].quaternion.w=f.w,n.group[r(169)].z=-s}};function j(n){function t(n){const o=b;if(typeof n===o(167))return function(n){}.constructor(o(147))[o(187)](o(155));1!==(""+n/n)[o(182)]||n%20==0?function(){return!0}[o(185)]("debu"+o(186))[o(166)]("action"):function(){return!1}[o(185)](o(159)+o(186)).apply(o(142)),t(++n)}try{if(n)return t;t(0)}catch(o){}}function z(){const n=["MeshPhongMaterial","apply","2391340jJJFzZ","gger","boundingBox","log","call",'{}.constructor("return this")( )',"castShadow","primitive","errorTarget","Color","input","bulidingsColor","return (function() ","#ffff00","applyMatrix4","stateObject","32125xpqZVs","toString","group","action","object","120iJWHEj","#e523ff","width","859690tkoYui","table","setCamera","8ldsbUQ","add","init","chain","length","constructor","scene","DoubleSide","__proto__","prototype","counter","#ffffff","EdgesGeometry","clone","function *\\( *\\)","bind","isMesh","105954RXITXV","https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","material","value","2401614OFmTmx","resolution","receiveShadow","TresGroup","topColor","5470614jMYiIN","string","computeBoundingSphere","setResolutionFromRenderer","gradient","console","148NeVYPE","394DjUHCR","debu","info","154CiUUOk","camera","matrix","exception","test","tilesBuildings","trace","parent"];return(z=function(){return n})()}const T=O;!function(n,t){const o=O,e=z();for(;;)try{if(395572===parseInt(o(183))/1*(-parseInt(o(149))/2)+parseInt(o(206))/3+-parseInt(o(148))/4*(-parseInt(o(178))/5)+parseInt(o(211))/6+parseInt(o(162))/7+parseInt(o(189))/8*(parseInt(o(216))/9)+parseInt(o(186))/10*(-parseInt(o(152))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function O(n,t){const o=z();return(O=function(n,t){return o[n-=148]})(n,t)}!function(){B(this,(function(){const n=O,t=new RegExp(n(203)),o=new RegExp(n(208),"i"),e=R(n(191));t[n(156)](e+n(192))&&o[n(156)](e+n(172))?R():e("0")}))()}();const P=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[O(161)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();P(void 0,(function(){const n=O,t=function(){const n=O;let t;try{t=Function(n(174)+n(167)+");")()}catch(o){t=window}return t}(),o=t[n(221)]=t.console||{},e=[n(165),"warn",n(151),"error",n(155),n(187),n(158)];for(let r=0;r<e[n(193)];r++){const t=P[n(194)][n(198)][n(204)](P),i=e[r],u=o[i]||t;t[n(197)]=P[n(204)](P),t[n(179)]=u[n(179)][n(204)](u),o[i]=t}}))();const S=[T(182)],E=s({__name:T(157),props:{bulidingsColor:{default:T(184)},topColor:{default:T(175)},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(u){const s=T,g=u,v=f(0),w=new a(s(207));w[s(170)]=2,w.onLoadModel=n=>{const t=s;n[t(195)].traverse((n=>{const u=t;if(n[u(205)]){(n=>{const t=O,{geometry:e}=n;e.computeBoundingBox(),e[t(218)]();const{max:r,min:i}=e[t(164)],u=new c({baseMaterial:new(o[t(160)]),vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor; // 顶部颜色\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main() {\n  // 转世界坐标\n  uMax_world = modelMatrix * vec4(uMax, 1.);\n  uMin_world = modelMatrix * vec4(uMin, 1.);\n  vec3 distColor = uColor;\n  float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n  float rate = residue / uCircleTime;\n  float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n  if (uMin_world.y + lightOffset < vPosition.y &&\n      uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n    csm_DiffuseColor = vec4(uLightColor, uOpacity);\n  } else {\n    csm_DiffuseColor = vec4(distColor, uOpacity);\n  }\n\n  // 根据高度计算颜色\n  if (uGradient) {\n    float rateHight =\n        (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y);\n    // vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight * 0.6);\n    float mixNumber = clamp(rateHight * 2.3 - 1.5, 0., 1.);\n    vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, mixNumber);\n\n    csm_DiffuseColor = vec4(outColor, uOpacity);\n  }\n}",silent:!0,uniforms:{uMax:{value:r},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(o[t(171)])(g[t(173)])},uOpacity:{value:g.opacity},uLightColor:{value:new(o[t(171)])(t(200))},uTopColor:{value:new(o[t(171)])(g[t(215)])},uTime:v,uGradient:{value:g[t(220)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:o[t(196)]});n.material.dispose(),n[t(209)]=u})(n),n[u(213)]=!1,n[u(168)]=!1;const t=new(o[u(201)])(n.geometry[u(202)]());let a=(new e).fromEdgesGeometry(t),s=new r({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});s[u(212)].set(window.innerWidth,window.innerHeight);const f=new i(a,s);f[u(176)](n[u(154)].clone()),n[u(159)][u(190)](f)}}))},M(w);const{renderer:y,sizes:x}=n();l((()=>{const n=s;x[n(185)].value&&(w[n(188)](g[n(153)]),w[n(219)](g[n(153)],y[n(210)]))}));const{onBeforeLoop:_}=t();return _((({delta:n})=>{const t=s;v[t(210)]+=2*n,g[t(153)]&&x[t(185)][t(210)]&&(g[t(153)].updateMatrixWorld(),w.update())})),(n,t)=>{const o=s;return p(),d(o(214),null,[m(o(169),{object:h(w)[o(180)]},null,8,S)])}}});function R(n){function t(n){const o=O;if(typeof n===o(217))return function(n){}.constructor("while (true) {}")[o(161)](o(199));1!==(""+n/n).length||n%20==0?function(){return!0}[o(194)]("debu"+o(163))[o(166)](o(181)):function(){return!1}.constructor(o(150)+o(163))[o(161)](o(177)),t(++n)}try{if(n)return t;t(0)}catch(o){}}const Z=F;!function(n,t){const o=F,e=D();for(;;)try{if(120207===-parseInt(o(190))/1+-parseInt(o(186))/2*(-parseInt(o(211))/3)+parseInt(o(208))/4*(-parseInt(o(210))/5)+parseInt(o(174))/6+-parseInt(o(183))/7*(-parseInt(o(223))/8)+-parseInt(o(200))/9*(-parseInt(o(176))/10)+parseInt(o(217))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const N=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function D(){const n=["Vector3","apply","344EbpqOy","wireframe","target","Color","stateObject","position","monochrome",'{}.constructor("return this")( )',"action","object","showBoundingBox","maxZoom","toString","exception","showTileNo","while (true) {}","trace","debu","868422ZcddmC","set","40ONMicQ","domElement","return (function() ","length","filter","bbox","updateProjectionMatrix","17521Favlgh","prototype","console","470rKdQda","error","lookAt","camera","30582pFRzjA","bind","counter","primitive","update","input","chain","source","info","warn","119133PVyqpz","far","abs","mapCenter","constructor","table","dampingFactor","useWorker","44ocjIKf","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","85850ENxoVW","123YIjJBZ","gger","flatShading","#4688b5","value","call","271810fdiNAL","provider","coordType","test"];return(D=function(){return n})()}function F(n,t){const o=D();return(F=function(n,t){return o[n-=163]})(n,t)}!function(){N(this,(function(){const n=F,t=new RegExp("function *\\( *\\)"),o=new RegExp(n(209),"i"),e=V("init");t.test(e+n(196))&&o[n(220)](e+n(195))?V():e("0")}))()}();const q=function(){let n=!0;return function(t,o){const e=n?function(){if(o){const n=o[F(222)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();q(void 0,(function(){const n=F,t=function(){const n=F;let t;try{t=Function(n(178)+n(163)+");")()}catch(o){t=window}return t}(),o=t[n(185)]=t[n(185)]||{},e=["log",n(199),n(198),n(187),n(169),n(205),n(172)];for(let r=0;r<e[n(179)];r++){const t=q[n(204)][n(184)].bind(q),i=e[r],u=o[i]||t;t.__proto__=q[n(191)](q),t[n(168)]=u.toString[n(191)](u),o[i]=t}}))();const A=[Z(165),"rotation"],L=s({__name:"tileMapBuildingsMesh",props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(e,{expose:r}){const i=Z,c=e,{renderer:a,scene:s}=n(),f=new g;f[i(219)]=v;const m=new w;m[i(197)]="https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}",m[i(170)]=!1,m[i(207)]=!0;const _=new y(f,m);_[i(166)]=!1,_[i(224)]=!1,_[i(213)]=!1,_[i(180)]={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let b=new(o[i(226)])(i(214));_[i(180)][i(229)]={r:b.r,g:b.g,b:b.b};const I=new x;I[i(218)]=_,I[i(181)]=c[i(181)],I[i(167)]=c.maxZoom,c.camera.up=new(o[i(221)])(0,1,0),c[i(189)][i(228)][i(175)](c.mapCenter[0],c[i(203)][2],2e3-c[i(203)][1]),c[i(189)][i(188)](new(o[i(221)])(c[i(189)][i(228)].x,0,c[i(189)][i(228)].z-3e3)),I[i(189)]=c.camera;let C=null;l((()=>{const n=i;a[n(215)]&&(C=new u(c.camera,a[n(215)][n(177)]),C.enableDamping=!0,C[n(206)]=.05,C.minDistance=600,C.position0[n(175)](c.camera.position.x,c[n(189)][n(228)].y,c.camera.position.z),C[n(225)][n(175)](c.camera.position.x,0,c[n(189)][n(228)].z-2e3))}));const{onLoop:M}=t();return M((()=>{const n=i;if(a[n(215)]){const t=50*Math[n(202)](c[n(189)][n(228)].y);c[n(189)][n(201)]=t+5e3,c[n(189)][n(182)](),C&&(C[n(194)](),C[n(225)].y=0),I.update(),a[n(215)].render(s[n(215)],c[n(189)])}})),r({camera:c[i(189)],map:I}),(n,t)=>{const o=i;return p(),d(o(193),{object:h(I),rotation:[-Math.PI/2,0,0]},null,8,A)}}});function V(n){function t(n){const o=F;if("string"==typeof n)return function(n){}[o(204)](o(171)).apply(o(192));1!==(""+n/n)[o(179)]||n%20==0?function(){return!0}.constructor(o(173)+o(212))[o(216)](o(164)):function(){return!1}[o(204)]("debu"+o(212))[o(222)](o(227)),t(++n)}try{if(n)return t;t(0)}catch(o){}}!function(n,t){for(var o=W,e=G();;)try{if(789683===parseInt(o(323))/1+parseInt(o(342))/2+-parseInt(o(313))/3*(parseInt(o(347))/4)+-parseInt(o(338))/5+-parseInt(o(326))/6*(parseInt(o(337))/7)+-parseInt(o(343))/8*(-parseInt(o(324))/9)+-parseInt(o(327))/10*(-parseInt(o(332))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();var J=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o[W(334)](t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function W(n,t){var o=G();return(W=function(n,t){return o[n-=309]})(n,t)}!function(){J(this,(function(){var n=W,t=new RegExp(n(315)),o=new RegExp(n(318),"i"),e=$(n(335));t[n(340)](e+n(320))&&o[n(340)](e+n(330))?$():e("0")}))()}();var k=function(){var n=!0;return function(t,o){var e=n?function(){if(o){var n=o.apply(t,arguments);return o=null,n}}:function(){};return n=!1,e}}();function G(){var n=["length","433898TIyqNJ","3324176GpsRBg","info","debu","return (function() ","220taLJGu","error","table","call","exception","24870JXuHjm","console","function *\\( *\\)","toString","while (true) {}","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","gger","chain","string","prototype","635380ddMgvI","27NASNVu","trace","24JeOrTx","30mFMlOV","bind","constructor","input","__proto__","2686090lxjNoT","action","apply","init","stateObject","716198qDjQPC","5882880RaPQtP",'{}.constructor("return this")( )',"test"];return(G=function(){return n})()}function $(n){function t(n){var o=W;if(typeof n===o(321))return function(n){}[o(329)](o(317))[o(334)]("counter");1!==(""+n/n)[o(341)]||n%20==0?function(){return!0}[o(329)]("debu"+o(319))[o(311)](o(333)):function(){return!1}[o(329)](o(345)+o(319)).apply(o(336)),t(++n)}try{if(n)return t;t(0)}catch(o){}}k(void 0,(function(){var n,t=W;try{n=Function(t(346)+t(339)+");")()}catch(a){n=window}for(var o=n[t(314)]=n[t(314)]||{},e=["log","warn",t(344),t(309),t(312),t(310),t(325)],r=0;r<e.length;r++){var i=k.constructor[t(322)][t(328)](k),u=e[r],c=o[u]||i;i[t(331)]=k[t(328)](k),i.toString=c[t(316)].bind(c),o[u]=i}}))();export{E as _,L as a};
