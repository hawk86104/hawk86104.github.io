import{importShared as e}from"./3d-tiles-renderer.de6b_qgz1767149344623.js";import{Fs as t,Kk as a}from"./index.Btae5S5d1767149344623.js";import{scaleImg as n,pt as o,en as r,controlsEvents as l,showLocation as i,informationDiv as c}from"./informationDiv.BoN9Prf81767149344623.js";import{useTexture$1 as p}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.C_pYeFAB1767149344623.js";import"./index.vue_vue_type_script_setup_true_lang.C9DbtXj-1767149344623.js";import{Pane as s}from"./tweakpane.BbuIEN141767149344623.js";const{withAsyncContext:m,defineComponent:u}=await e("vue"),{unref:d,createElementVNode:g,openBlock:h,createElementBlock:_}=await e("vue"),f=["position"],v=["scale","material","rotateX","position-y"],S=await e("three"),{watch:w}=await e("vue"),y=u({__name:"cloundSateShow",props:{map:{},height:{default:100},color:{default:"#cccccc"},opacity:{default:.6}},async setup(e){let t,a;const o=e,r=new S.MeshPhongMaterial({displacementMap:new S.Texture,transparent:!0,side:S.DoubleSide,opacity:o.opacity,color:new S.Color(o.color)});r.onBeforeCompile=e=>{e.vertexShader="uniform sampler2D map;\n\t\t"+e.vertexShader,e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","transformed += normalize( objectNormal ) * ( texture2D(map, vMapUv ).a * 0.5 + 0.0 );"),e.fragmentShader=e.fragmentShader.replace("#include <alphamap_fragment>","\n            #include <alphamap_fragment>\n            float h = texture2D(map, vMapUv ).a;\n            diffuseColor.rgb *= h;\n            diffuseColor.a = clamp(diffuseColor.a * 2.0, 0.0, 1.0);\n            ")};const l=o.map.geo2map(new S.Vector3(105,34,0));l.applyMatrix4(o.map.matrix);const i=n(o.map,{x:67,y:11},{x:140,y:57},1e3*o.height),c=["https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171300.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171400.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171500.HDF.png","https://opensource.cdn.icegl.cn/images/simpleGIS/SATE_L1_F2G_VISSR_MWB_NOM_FDI-201906171600.HDF.png"];let s=0;const u=([t,a]=m(()=>p(c)),t=await t,a(),t);r.map=u[s],w(()=>[o.color,o.opacity],([e,t])=>{r.color.setStyle(e),r.opacity=t});let y=null,x=!1;return x?(clearInterval(y),y=null,x=!1):(y=setInterval(()=>{s=s<c.length-1?s+1:0,r.map=u[s],r.needsUpdate=!0,console.log(s)},1e3),x=!0),(e,t)=>(h(),_("TresGroup",{position:[...d(l)]},[g("TresMesh",{scale:[d(i).x,d(i).y,1e3*e.height],material:d(r),rotateX:-Math.PI/2,renderOrder:9999,"position-y":1e3*e.height/5},[...t[0]||(t[0]=[g("TresPlaneGeometry",{args:[1,1,529,420]},null,-1)])],8,v)],8,f))}}),{defineComponent:x}=await e("vue"),{createElementVNode:M,unref:B,mergeProps:D,createVNode:I,Suspense:C,withCtx:T,openBlock:F,createBlock:V,Fragment:b,createElementBlock:k}=await e("vue"),E=["object"],{watch:P,ref:G,reactive:N}=await e("vue"),j=await e("three"),L=x({__name:"mapBoxShow2",setup(e){const a=N({height:500,color:"#cccccc",opacity:.6}),n=new s({title:"参数"});n.addBinding(a,"color",{label:"颜色"}),n.addBinding(a,"height",{label:"高度",min:10,max:5e3,step:10}),n.addBinding(a,"opacity",{label:"透明度",min:0,max:1,step:.1});const c=o.create({imgSource:[new r({style:"6"}),new r({style:"8"})],minLevel:2,maxLevel:18,lon0:90});c.rotateX(-Math.PI/2);const p=new j.Vector3(105,34,0),m=new j.Vector3(110,0,1e7),u=c.localToWorld(c.geo2map(p)),d=c.localToWorld(c.geo2map(m)),g=G(),{camera:h,controls:_,scene:f,renderer:v}=t();return h.value&&h.value.position.copy(d),P(()=>_.value,e=>{e&&(e.target.copy(u),l(e,h.value,f.value))}),P(()=>g.value,e=>{e&&e.target.position.copy(u)}),i(h.value,v.domElement,c),(e,t)=>(F(),k(b,null,[M("TresDirectionalLight",{ref_key:"tdLight",ref:g,position:[0,2e3,1e3],intensity:1},null,512),M("primitive",{object:B(c)},null,8,E),(F(),V(C,null,{default:T(()=>[I(y,D({map:B(c)},a),null,16,["map"])]),_:1}))],64))}}),{defineComponent:A}=await e("vue"),{createElementVNode:W,unref:O,normalizeProps:R,guardReactiveProps:H,createVNode:z,resolveComponent:U,mergeProps:X,withCtx:$,Fragment:q,openBlock:J,createElementBlock:K}=await e("vue"),{reactive:Q}=await e("vue"),Y=A({__name:"cloundSate",setup(e){const t=Q({clearColor:"#dbf0ff",alpha:!0,antialias:!1,logarithmicDepthBuffer:!0,precision:"highp"}),n=Q({enableDamping:!0,makeDefault:!0,screenSpacePanning:!1,keyPanSpeed:5});return(e,o)=>{const r=U("TresCanvas");return J(),K(q,null,[z(r,X(t,{"window-size":""}),{default:$(()=>[o[0]||(o[0]=W("TresPerspectiveCamera",{position:[0,12,0],fov:70,near:1,far:4e10},null,-1)),z(O(a),R(H(n)),null,16),o[1]||(o[1]=W("TresAmbientLight",{intensity:1},null,-1)),z(L)]),_:1},16),z(c)],64)}}});export{Y as default};
