import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.OkSaFJOI1722409645193.js";import{$ as o}from"./@tresjs.qmCJ68Vp1722409645193.js";import{C as e}from"./three-custom-shader-material.Tfk8gm3s1722409645193.js";import"./object-hash.Une5niKX1722409645193.js";import{a6 as r,C as i,cc as u,k as c,b0 as a}from"./three.6E5muTWJ1722409645193.js";import"./@amap.VDWlHANn1722409645193.js";import"./glsl-tokenizer.bKHxJMPW1722409645193.js";import{d as s,a1 as l,w as f,o as p,D as d,u as m,a4 as g,r as v,f as h,g as y,j as C,m as w}from"./@vue.9bHx4gg21722409645193.js";import{P as b}from"./tweakpane.yHWGBmom1722409645193.js";import"./@vueuse.NFOCyQQL1722409645193.js";import"./glsl-token-string.tLooI1vy1722409645193.js";import"./glsl-token-functions.9RlG2kRC1722409645193.js";import"./jszip.EBLL5bdU1722409645193.js";const _=j;!function(t,n){const o=j,e=S();for(;;)try{if(609591===-parseInt(o(298))/1*(parseInt(o(287))/2)+parseInt(o(270))/3+parseInt(o(269))/4+-parseInt(o(294))/5+parseInt(o(263))/6+-parseInt(o(292))/7*(-parseInt(o(266))/8)+parseInt(o(314))/9*(-parseInt(o(254))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[j(321)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=j,n=new RegExp(t(289)),o=new RegExp(t(275),"i"),e=F(t(283));n[t(326)](e+t(262))&&o[t(326)](e+t(278))?F():e("0")}))()}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();I(void 0,(function(){const t=j,n=function(){const t=j;let n;try{n=Function(t(290)+t(268)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(276)]||{},e=[t(299),t(288),t(303),"error",t(259),t(273),t(313)];for(let r=0;r<e.length;r++){const n=I[t(304)][t(300)][t(325)](I),i=e[r],u=o[i]||n;n[t(324)]=I[t(325)](I),n.toString=u[t(296)].bind(u),o[i]=n}}))();const M=[_(272)];function j(t,n){const o=S();return(j=function(t,n){return o[t-=253]})(t,n)}function S(){const t=["dispose","uniforms","material","apply","primitive","topColor","__proto__","bind","test","gger","#112233","6167790Xgxltr","uColor","clone","while (true) {}","color","exception","setStyle","land","chain","6466050FTfowU","computeBoundingSphere","uTime","144728gokmTJ","#e523ff",'{}.constructor("return this")( )',"1947764jzQsFt","474018tKgmYy","computeBoundingBox","object","table","side","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","console","MeshBasicMaterial","input","landColor","call","length","bModel","init","string","gradient","debu","33802uyYneR","warn","function *\\( *\\)","return (function() ","action","35ToREhK","city","2764525FIXxrp","#ffff00","toString","#ffffff","2YyDupL","log","prototype","counter","isArray","info","constructor","uOpacity","Color","model","uGradient","value","children","opacity","bulidingsColor","trace","9nqdDCi","forEach","DoubleSide","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t"];return(S=function(){return t})()}const T=s({__name:_(282),props:{model:{},bulidingsColor:{default:_(267)},landColor:{default:_(253)},topColor:{default:_(295)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=_,u=t,c=u[n(307)][n(293)];u[n(307)][n(307)][n(310)][0].material=new(r[n(277)])({color:n(295)}),c.renderOrder=1001;const a=u.model[n(261)];(()=>{const t=n,{geometry:o}=c;o[t(271)](),o[t(264)]();const{max:a,min:s}=o.boundingBox;if(c.material.__csm)return;const l=new e({baseMaterial:c[t(320)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:t(317),silent:!0,uniforms:{uMax:{value:a},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(306)])(u[t(312)])},uOpacity:{value:u.opacity},uLightColor:{value:new i(t(297))},uTopColor:{value:new(r[t(306)])(u[t(323)])},uTime:{value:0},uGradient:{value:u[t(285)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(316)]});c[t(320)][t(318)](),c[t(320)]=l})();const{onLoop:s}=o();s((({delta:t})=>{const o=n;c[o(320)][o(319)][o(265)][o(309)]+=t})),l((()=>{const t=n;u[t(312)]&&c[t(320)][t(319)][t(255)][t(309)].setStyle(u[t(312)]),u.landColor&&((t,o)=>{const e=n;let i;"cu"===t||t===e(261)&&(i=Array[e(302)](a[e(320)])?a[e(320)]:[a[e(320)]],i[e(315)]((t=>{const n=e;t[o][n(260)](u[n(279)]),t[n(274)]=r[n(316)]})))})(t(261),t(258)),u.opacity&&(c[t(320)][t(319)][t(305)].value=u[t(311)])})),f(u,((t,o)=>{const e=n;c.material.uniforms[e(308)][e(309)]=t[e(285)]}));const g=u.model[n(307)][n(256)]();return(t,o)=>{const e=n;return p(),d(e(322),{object:m(g)},null,8,M)}}});function F(t){function n(t){const o=j;if(typeof t===o(284))return function(t){}[o(304)](o(257)).apply(o(301));1!==(""+t/t)[o(281)]||t%20==0?function(){return!0}[o(304)](o(286)+o(327))[o(280)](o(291)):function(){return!1}[o(304)](o(286)+o(327)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=H;function P(){const t=["function *\\( *\\)","uScale","32hRdLHJ","9210488RszHsH","log","apply","gger","renderOrder","uColor","error","counter","warn","bind","console","clone","linewidth","init","260560HaibOR","5036HCHXFp","__proto__","constructor","uniforms","uSrcColor","test","877176YtOpGJ","20olGYNH","chain","speed","applyMatrix4","debu","scale","gradual","matrix","18902133Ziyixm","table",'{}.constructor("return this")( )',"action","1649886XULVSZ","srcColor","toString","primitive","info","exception","10454100DeJtiJ","#FFF","return (function() ","trace","value","color","prototype","uTime","length","1065qLbjnc"];return(P=function(){return t})()}!function(t,n){const o=H,e=P();for(;;)try{if(874893===parseInt(o(393))/1+-parseInt(o(427))/2*(-parseInt(o(408))/3)+parseInt(o(411))/4*(-parseInt(o(426))/5)+parseInt(o(399))/6+parseInt(o(412))/7+-parseInt(o(433))/8+parseInt(o(389))/9*(-parseInt(o(434))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(414)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=H,n=new RegExp(t(409)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=L(t(425));n[t(432)](e+t(435))&&o[t(432)](e+"input")?L():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(414)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();G(void 0,(function(){const t=H;let n;try{n=Function(t(401)+t(391)+");")()}catch(r){n=window}const o=n[t(422)]=n.console||{},e=[t(413),t(420),t(397),t(418),t(398),t(390),t(402)];for(let i=0;i<e[t(407)];i++){const n=G[t(429)][t(405)][t(421)](G),r=e[i],u=o[r]||n;n[t(428)]=G[t(421)](G),n.toString=u[t(395)].bind(u),o[r]=n}}))();const R=["object"];function H(t,n){const o=P();return(H=function(t,n){return o[t-=386]})(t,n)}const B=s({__name:"bLine",props:{builds:{},color:{default:O(400)},srcColor:{default:"#000"},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,e=t;let r=null;const s={transparent:!0,uniforms:{uColor:{value:new i(e[n(404)])},uSrcColor:{value:new i(e[n(394)])},uScale:{value:e[n(386)]},uTime:{value:0},uGradual:{value:e.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e.builds.geometry)[n(423)]();f=f[n(437)](e.builds[n(388)]);const g=new c(s);r=new a(f,g),r.material[n(424)]=e.width,r[n(416)]=1e3,l((()=>{const t=n;e.color&&(s[t(430)][t(417)][t(403)]=new i(e[t(404)])),e[t(394)]&&(s[t(430)][t(431)][t(403)]=new i(e[t(394)])),e[t(386)]&&(s[t(430)][t(410)].value=e[t(386)]),e.gradual&&(s.uniforms.uGradual[t(403)]=e[t(387)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;s.uniforms[o(406)][o(403)]+=t*e[o(436)],s.uniforms[o(406)][o(403)]%=1})),(t,o)=>{const e=n;return p(),d(e(396),{object:m(r)},null,8,R)}}});function L(t){function n(t){const o=H;if("string"==typeof t)return function(t){}[o(429)]("while (true) {}")[o(414)](o(419));1!==(""+t/t).length||t%20==0?function(){return!0}[o(429)](o(438)+o(415)).call(o(392)):function(){return!1}[o(429)]("debu"+o(415)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function k(){const t=["apply","gradual","最大扩散","12649470GVPeFq","扩散系数","线原颜色","log","15144bNvuGV","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","input",'{}.constructor("return this")( )',"function *\\( *\\)","3pKQUsz","prototype","info","addBinding","model","6TDeeHG","builds","toString","buildingsEffectA","speed","call","3530372bLwoUC","chain","while (true) {}","19761336iVusGw","#000000","线扫颜色","test","table","counter","11lvcWJo","srcColor","exception","length","2583dWHbMa","65519WCpCoY","return (function() ","string","scale","#FFF","350065leFTxz","action","constructor","gger","bind","11974545fUXmdx","city","init","32MKZrap"];return(k=function(){return t})()}const A=D;function D(t,n){const o=k();return(D=function(t,n){return o[t-=420]})(t,n)}!function(t,n){const o=D,e=k();for(;;)try{if(787005===-parseInt(o(452))/1*(parseInt(o(465))/2)+-parseInt(o(427))/3*(-parseInt(o(438))/4)+-parseInt(o(457))/5*(-parseInt(o(432))/6)+parseInt(o(451))/7*(-parseInt(o(422))/8)+-parseInt(o(462))/9+parseInt(o(469))/10*(parseInt(o(447))/11)+parseInt(o(441))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=D,n=new RegExp(t(426)),o=new RegExp(t(423),"i"),e=$(t(464));n.test(e+t(439))&&o[t(444)](e+t(424))?$():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(466)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=D;let n;try{n=Function(t(453)+t(425)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(421),"warn",t(429),"error",t(449),t(445),"trace"];for(let i=0;i<e.length;i++){const n=Z.constructor[t(428)][t(461)](Z),r=e[i],u=o[r]||n;n.__proto__=Z.bind(Z),n[t(434)]=u.toString[t(461)](u),o[r]=n}}))();const W=s({__name:A(435),async setup(o){const e=A;let r,i;const u=([r,i]=g((()=>n())),r=await r,i(),r),c=v({color:e(456),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),a=new b({title:"效果参数",expanded:!0});return a[e(430)](c,e(448),{label:e(420)}),a[e(430)](c,"color",{label:e(443)}),a[e(430)](c,e(436),{label:"速度",min:.1,max:1,step:.1}),a[e(430)](c,e(455),{label:e(468),min:10,max:2e3,step:10}),a[e(430)](c,e(467),{label:e(470),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[C(T,{model:m(u),bulidingsColor:r(442),landColor:"#112233",topColor:"#999"},null,8,[r(431)]),C(B,w({builds:m(u)[r(463)]},c),null,16,[r(433)])])),_:1})}}});function $(t){function n(t){const o=D;if(typeof t===o(454))return function(t){}[o(459)](o(440))[o(466)](o(446));1!==(""+t/t)[o(450)]||t%20==0?function(){return!0}[o(459)]("debugger")[o(437)](o(458)):function(){return!1}.constructor("debu"+o(460))[o(466)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{W as default};
