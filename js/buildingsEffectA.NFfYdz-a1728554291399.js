import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.A2-s57Hh1728554291399.js";import{U as o}from"./@tresjs.IlQvaTJ91728554291399.js";import{C as e}from"./three-custom-shader-material.jyK-33IL1728554291399.js";import"./object-hash.T8hJJgjS1728554291399.js";import{_ as r,C as i,ce as u,m as c,a$ as a}from"./three.YiCjTDWq1728554291399.js";import"./@amap.pS6gfiLZ1728554291399.js";import"./glsl-tokenizer.y_V5nCRK1728554291399.js";import{d as s,a3 as l,w as f,o as p,E as d,u as m,a4 as v,r as g,f as h,g as y,j as C,m as w}from"./@vue.JNsx1iN61728554291399.js";import{P as _}from"./tweakpane.yHWGBmom1728554291399.js";import"./@vueuse.nb-8z3af1728554291399.js";import"./glsl-token-string.dXz7aW6T1728554291399.js";import"./glsl-token-functions.ziXdc34f1728554291399.js";import"./jszip.ZN8xj_JH1728554291399.js";const b=T;!function(t,n){const o=T,e=j();for(;;)try{if(270630===parseInt(o(410))/1*(parseInt(o(399))/2)+-parseInt(o(435))/3*(parseInt(o(420))/4)+parseInt(o(425))/5*(parseInt(o(376))/6)+-parseInt(o(396))/7+parseInt(o(433))/8*(parseInt(o(401))/9)+parseInt(o(377))/10+parseInt(o(436))/11*(parseInt(o(388))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const x=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(400)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){x(this,(function(){const t=T,n=new RegExp(t(429)),o=new RegExp(t(405),"i"),e=P("init");n.test(e+t(380))&&o[t(382)](e+"input")?P():e("0")}))()}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[T(400)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();I(void 0,(function(){const t=T;let n;try{n=Function(t(397)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n.console||{},e=[t(372),t(402),"info",t(374),t(426),t(387),t(412)];for(let i=0;i<e.length;i++){const n=I.constructor[t(371)].bind(I),r=e[i],u=o[r]||n;n[t(427)]=I[t(428)](I),n[t(421)]=u.toString[t(428)](u),o[r]=n}}))();const M=[b(389)];function j(){const t=["constructor","call","color","table","24gKiPUp","object","gradient","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","land","while (true) {}","action","landColor","181566OdYcPH","return (function() ","isArray","230546XQrzUk","apply","9slVIBx","warn","#ffffff","#e523ff","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","side","gger","Color","counter","1WjFRif","uOpacity","trace","computeBoundingBox","material","__csm","uColor","primitive","debu","value","8koQrWU","toString","uTime","setStyle","computeBoundingSphere","443315pTirHa","exception","__proto__","bind","function *\\( *\\)","renderOrder","clone","length","2347784RHaAMY","uGradient","595923upFUUU","318758pHqMXE","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","#ffff00","MeshBasicMaterial","model","dispose","prototype","log","#112233","error","bulidingsColor","6bSttym","1384850zxzhqD","opacity","bModel","chain","DoubleSide","test","uniforms"];return(j=function(){return t})()}const S=s({__name:b(379),props:{model:{},bulidingsColor:{default:b(404)},landColor:{default:b(373)},topColor:{default:b(438)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=b,i=t,u=i[n(369)].city;i.model[n(369)].children[0].material=new(r[n(439)])({color:"#ffff00"}),u[n(430)]=1001;const c=i[n(369)][n(392)];(()=>{const t=n,{geometry:o}=u;o[t(413)](),o[t(424)]();const{max:c,min:a}=o.boundingBox;if(u[t(414)][t(415)])return;const s=new e({baseMaterial:u.material,vertexShader:t(437),fragmentShader:t(391),silent:!0,uniforms:{uMax:{value:c},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(r[t(408)])(i[t(375)])},uOpacity:{value:i.opacity},uLightColor:{value:new(r[t(408)])(t(403))},uTopColor:{value:new(r[t(408)])(i.topColor)},uTime:{value:0},uGradient:{value:i[t(390)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:r[t(381)]});u[t(414)][t(370)](),u[t(414)]=s})();const{onLoop:a}=o();a((({delta:t})=>{const o=n;u.material[o(383)][o(422)][o(419)]+=t})),l((()=>{const t=n;i.bulidingsColor&&u.material[t(383)][t(416)][t(419)][t(423)](i[t(375)]),i.landColor&&((t,o)=>{const e=n;let u;"cu"===t||t===e(392)&&(u=Array[e(398)](c[e(414)])?c.material:[c.material],u.forEach((t=>{const n=e;t[o][n(423)](i[n(395)]),t[n(406)]=r[n(381)]})))})("land",t(386)),i.opacity&&(u[t(414)][t(383)][t(411)][t(419)]=i[t(378)])})),f(i,((t,o)=>{const e=n;u[e(414)][e(383)][e(434)].value=t[e(390)]}));const s=i.model[n(369)][n(431)]();return(t,o)=>{const e=n;return p(),d(e(417),{object:m(s)},null,8,M)}}});function T(t,n){const o=j();return(T=function(t,n){return o[t-=369]})(t,n)}function P(t){function n(t){const o=T;if("string"==typeof t)return function(t){}[o(384)](o(393)).apply(o(409));1!==(""+t/t)[o(432)]||t%20==0?function(){return!0}[o(384)]("debu"+o(407))[o(385)](o(394)):function(){return!1}[o(384)](o(418)+o(407)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const F=k;!function(t,n){const o=k,e=B();for(;;)try{if(644094===parseInt(o(408))/1+parseInt(o(365))/2*(parseInt(o(400))/3)+-parseInt(o(390))/4*(parseInt(o(405))/5)+parseInt(o(383))/6+-parseInt(o(395))/7+-parseInt(o(376))/8*(parseInt(o(417))/9)+parseInt(o(403))/10*(parseInt(o(384))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const O=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(374)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){O(this,(function(){const t=k,n=new RegExp(t(377)),o=new RegExp(t(397),"i"),e=R("init");n[t(370)](e+t(407))&&o.test(e+t(387))?R():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(374)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=k,n=function(){const t=k;let n;try{n=Function(t(394)+t(371)+");")()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=["log",t(422),t(373),t(386),t(415),"table",t(392)];for(let r=0;r<e[t(366)];r++){const n=z[t(419)].prototype[t(396)](z),i=e[r],u=o[i]||n;n[t(410)]=z.bind(z),n[t(404)]=u.toString[t(396)](u),o[i]=n}}))();const A=[F(391)];function B(){const t=["srcColor","uniforms","exception","geometry","9PmYjbP","speed","constructor","color","material","warn","1004AFvHoG","length","matrix","string","while (true) {}","test",'{}.constructor("return this")( )',"value","info","apply","gradual","3323464nMUYMt","function *\\( *\\)","clone","#000","gger","stateObject","bLine","6821250rCeJLq","55FAtsQK","linewidth","error","input","uTime","uColor","2096EIPitL","object","trace","#FFF","return (function() ","8266510uREoEP","bind","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","renderOrder","builds","2973lKdXiZ","action","debu","1150140zkwaJp","toString","1245shkVyA","call","chain","161506noSTVZ","uGradual","__proto__","scale","applyMatrix4"];return(B=function(){return t})()}function k(t,n){const o=B();return(k=function(t,n){return o[t-=365]})(t,n)}const E=s({__name:F(382),props:{builds:{},color:{default:F(393)},srcColor:{default:F(379)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=F,e=t;let r=null;const s={transparent:!0,uniforms:{uColor:{value:new i(e[n(420)])},uSrcColor:{value:new i(e.srcColor)},uScale:{value:e[n(411)]},uTime:{value:0},uGradual:{value:e[n(375)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let f=new u(e[n(399)][n(416)])[n(378)]();f=f[n(412)](e.builds[n(367)]);const v=new c(s);r=new a(f,v),r[n(421)][n(385)]=e.width,r[n(398)]=1e3,l((()=>{const t=n;e.color&&(s[t(414)][t(389)][t(372)]=new i(e[t(420)])),e[t(413)]&&(s[t(414)].uSrcColor[t(372)]=new i(e.srcColor)),e[t(411)]&&(s[t(414)].uScale[t(372)]=e[t(411)]),e[t(375)]&&(s[t(414)][t(409)][t(372)]=e[t(375)])}));const{onLoop:g}=o();return g((({delta:t})=>{const o=n;s[o(414)].uTime.value+=t*e[o(418)],s[o(414)][o(388)][o(372)]%=1})),(t,n)=>(p(),d("primitive",{object:m(r)},null,8,A))}});function R(t){function n(t){const o=k;if(typeof t===o(368))return function(t){}[o(419)](o(369))[o(374)]("counter");1!==(""+t/t)[o(366)]||t%20==0?function(){return!0}.constructor(o(402)+o(380))[o(406)](o(401)):function(){return!1}[o(419)](o(402)+o(380)).apply(o(381)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Z=U;!function(t,n){const o=U,e=H();for(;;)try{if(165151===parseInt(o(179))/1+-parseInt(o(168))/2*(-parseInt(o(145))/3)+parseInt(o(151))/4+-parseInt(o(159))/5*(-parseInt(o(135))/6)+-parseInt(o(136))/7*(-parseInt(o(171))/8)+parseInt(o(133))/9+-parseInt(o(141))/10*(parseInt(o(142))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[U(143)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["builds","warn","model","926163BdmWqb","string","41214CYvfwt","1470nxfNoW","toString","gger","bind","constructor","11120aOezoY","8261Nfxflk","apply","return (function() ","15735GxoaCV","线原颜色","while (true) {}","效果参数","addBinding","call","1180396ytcjJk","table","#000","#999","#000000","input","log","#112233","85ZfICVH","action","线扫颜色","buildingsEffectA","length","chain",'{}.constructor("return this")( )',"info","扩散系数","14VVZKYt","#FFF","counter","4984uppoNT","speed","最大扩散","scale","gradual","error","debu","prototype","317939obuuAt","console"];return(H=function(){return t})()}!function(){G(this,(function(){const t=U,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=W("init");n.test(e+t(164))&&o.test(e+t(156))?W():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[U(143)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function U(t,n){const o=H();return(U=function(t,n){return o[t-=131]})(t,n)}L(void 0,(function(){const t=U;let n;try{n=Function(t(144)+t(165)+");")()}catch(r){n=window}const o=n.console=n[t(180)]||{},e=[t(157),t(131),t(166),t(176),"exception",t(152),"trace"];for(let i=0;i<e[t(163)];i++){const n=L[t(140)][t(178)][t(139)](L),r=e[i],u=o[r]||n;n.__proto__=L[t(139)](L),n[t(137)]=u[t(137)][t(139)](u),o[r]=n}}))();const V=s({__name:Z(162),async setup(o){const e=Z;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=g({color:e(169),srcColor:e(153),scale:2e3,gradual:6.6,speed:.3}),a=new _({title:e(148),expanded:!0});return a.addBinding(c,"srcColor",{label:e(146)}),a[e(149)](c,"color",{label:e(161)}),a[e(149)](c,e(172),{label:"速度",min:.1,max:1,step:.1}),a[e(149)](c,e(174),{label:e(173),min:10,max:2e3,step:10}),a.addBinding(c,e(175),{label:e(167),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return p(),h(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:y((()=>[C(S,{model:m(u),bulidingsColor:r(155),landColor:r(158),topColor:r(154)},null,8,[r(132)]),C(E,w({builds:m(u).city},c),null,16,[r(181)])])),_:1})}}});function W(t){function n(t){const o=U;if(typeof t===o(134))return function(t){}[o(140)](o(147))[o(143)](o(170));1!==(""+t/t)[o(163)]||t%20==0?function(){return!0}[o(140)]("debu"+o(138))[o(150)](o(160)):function(){return!1}.constructor(o(177)+"gger")[o(143)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as default};
