import{a6 as t,C as n,cc as o,cd as e,ce as r,cf as i,k as u,bS as c,ab as s,ad as a}from"./three.6cxCQsIj1724511658098.js";import{f as l,$ as f,d as p}from"./@tresjs.6SjGVF2a1724511658098.js";import{C as d}from"./three-custom-shader-material.hzuMkh_s1724511658098.js";import"./object-hash.Ic9VzAZ81724511658098.js";import"./@amap.T3VNXNvb1724511658098.js";import"./glsl-tokenizer.iUIReWhC1724511658098.js";import{d as h,b as m,a1 as y,w as g,o as w,D as v,u as _,r as b,a4 as C,e as I,f as x,g as M,J as T,j as S,aj as j,ak as A,F as R,I as O,G as B,m as z}from"./@vue.Q1VpS3901724511658098.js";!function(t,n){const o=G,e=D();for(;;)try{if(724364===-parseInt(o(380))/1+parseInt(o(382))/2*(parseInt(o(348))/3)+-parseInt(o(365))/4+-parseInt(o(384))/5*(-parseInt(o(346))/6)+parseInt(o(378))/7+-parseInt(o(374))/8*(parseInt(o(367))/9)+-parseInt(o(353))/10*(-parseInt(o(364))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(354)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function G(t,n){const o=D();return(G=function(t,n){return o[t-=343]})(t,n)}!function(){k(this,(function(){const t=G,n=new RegExp(t(385)),o=new RegExp(t(359),"i"),e=P(t(372));n[t(363)](e+t(345))&&o[t(363)](e+"input")?P():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(354)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(){const t=["while (true) {}","test","1339888GICQpv","5148720WXrsZc","stateObject","4527jzULSj","ROADS","exception","LANDMASS","trace","init","console","13992fvuPgg","prototype","return (function() ","call","1433509WbmGUV","name","181322BFTsoO","gger","3412ORXqkI","length","258270HoPkBl","function *\\( *\\)","info","debu","log","chain","156UlRrml","string","2253Gkscoy","__proto__","constructor","warn","action","20UKQPFe","apply","bind","error","counter","CITY_UNTRIANGULATED","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","traverse","toString"];return(D=function(){return t})()}L(void 0,(function(){const t=G,n=function(){const t=G;let n;try{n=Function(t(376)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(373)]=n[t(373)]||{},e=[t(344),t(351),t(386),t(356),t(369),"table",t(371)];for(let r=0;r<e[t(383)];r++){const n=L.constructor[t(375)][t(355)](L),i=e[r],u=o[i]||n;n[t(349)]=L[t(355)](L),n[t(361)]=u[t(361)][t(355)](u),o[i]=n}}))();const F=async()=>{const t=G,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(360)]((n=>{const i=t;n[i(379)]===i(358)&&(o=n),n.name===i(370)&&(e=n),n.name===i(368)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function P(t){function n(t){const o=G;if(typeof t===o(347))return function(t){}[o(350)](o(362)).apply(o(357));1!==(""+t/t)[o(383)]||t%20==0?function(){return!0}[o(350)](o(343)+o(381))[o(377)](o(352)):function(){return!1}[o(350)](o(343)+o(381))[o(354)](o(366)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const H=W;function W(t,n){const o=V();return(W=function(t,n){return o[t-=117]})(t,n)}!function(t,n){const o=W,e=V();for(;;)try{if(154956===-parseInt(o(143))/1*(parseInt(o(120))/2)+parseInt(o(150))/3+parseInt(o(157))/4+-parseInt(o(136))/5+-parseInt(o(142))/6+parseInt(o(147))/7+-parseInt(o(160))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=W,n=new RegExp(t(156)),o=new RegExp(t(159),"i"),e=N(t(131));n[t(146)](e+t(134))&&o[t(146)](e+t(133))?N():e("0")}))()}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(137)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Z(void 0,(function(){const t=W;let n;try{n=Function("return (function() "+t(132)+");")()}catch(r){n=window}const o=n[t(164)]=n.console||{},e=[t(129),t(155),"info","error",t(170),t(174),t(151)];for(let i=0;i<e[t(171)];i++){const n=Z[t(178)].prototype[t(145)](Z),r=e[i],u=o[r]||n;n[t(180)]=Z[t(145)](Z),n[t(119)]=u[t(119)][t(145)](u),o[r]=n}}))();const $=[H(128)],U=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:H(168)},landColor:{default:H(181)},topColor:{default:H(127)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=H,r=o,i=m(0),u=r[e(166)].city;u[e(177)]=1001;const c=r[e(166)][e(144)];(()=>{const o=e,{geometry:c}=u;c[o(163)](),c[o(167)]();const{max:s,min:a}=c[o(182)];if(u.material[o(149)])return;const l=new d({baseMaterial:u[o(125)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(r.bulidingsColor)},uOpacity:{value:r[o(162)]},uLightColor:{value:new(t[o(117)])(o(126))},uTopColor:{value:new(t[o(117)])(r[o(173)])},uTime:i,uGradient:{value:r[o(124)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(153)]});u[o(125)].dispose(),u[o(125)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(172)]+=t})),y((()=>{const n=e;r[n(158)]&&u[n(125)][n(121)][n(175)].value[n(130)](r[n(158)]),r[n(179)]&&((n,o)=>{const i=e;let u;"cu"===n||"land"===n&&(u=Array[i(148)](c[i(125)])?c.material:[c[i(125)]],u[i(169)]((n=>{const e=i;n[o][e(130)](r[e(179)]),n[e(165)]=t[e(153)]})))})(n(144),n(140)),r[n(162)]&&(u[n(125)][n(121)][n(154)][n(172)]=r[n(162)])})),g(r,((t,n)=>{const o=e;u[o(125)][o(121)][o(161)][o(172)]=t[o(124)]}));const a=r[e(166)][e(166)][e(139)]();return(t,n)=>{const o=e;return w(),v(o(135),{object:_(a)},null,8,$)}}});function N(t){function n(t){const o=W;if(typeof t===o(176))return function(t){}[o(178)](o(152))[o(137)](o(138));1!==(""+t/t)[o(171)]||t%20==0?function(){return!0}.constructor(o(141)+o(122)).call(o(123)):function(){return!1}[o(178)](o(141)+o(122))[o(137)](o(118)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function V(){const t=["710HnbYMg","uniforms","gger","action","gradient","material","#ffffff","#ffff00","object","log","setStyle","init",'{}.constructor("return this")( )',"input","chain","primitive","682100eLpIde","apply","counter","clone","color","debu","228024jlSttY","3tWzDRM","land","bind","test","256312PQAUuC","isArray","__csm","356286CaNwqn","trace","while (true) {}","DoubleSide","uOpacity","warn","function *\\( *\\)","765664aiBAop","bulidingsColor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","130792NXLGSY","uGradient","opacity","computeBoundingBox","console","side","model","computeBoundingSphere","#e523ff","forEach","exception","length","value","topColor","table","uColor","string","renderOrder","constructor","landColor","__proto__","#112233","boundingBox","Color","stateObject","toString"];return(V=function(){return t})()}function Y(){const t=["innerWidth","260846rOyuYw","trace","return (function() ","Shader","185AKTwCV","material","length","init","while (true) {}","warn","error","171354VguSTA","width","function *\\( *\\)",'{}.constructor("return this")( )',"value","clone","fromEdgesGeometry","color","1484634MSlJUS","linewidth","log","buildingsLines","toString","string","779960URyqYJ"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","gger","opacity","builds","primitive","test","renderOrder","applyMatrix4","geometry","object","stateObject","1717488sMozNR","call","set","exception","uColor","chain","style","uniforms","console","__proto__","counter","resolution","constructor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","table","2390460MrRrmS","prototype","Wireframe","action","debu","apply","3494862jMGIDb","bind","innerHeight","matrix"];return(Y=function(){return t})()}const K=Q;function Q(t,n){const o=Y();return(Q=function(t,n){return o[t-=434]})(t,n)}!function(t,n){const o=Q,e=Y();for(;;)try{if(609535===parseInt(o(489))/1+-parseInt(o(445))/2+-parseInt(o(478))/3+parseInt(o(463))/4+parseInt(o(493))/5*(parseInt(o(437))/6)+parseInt(o(484))/7+-parseInt(o(451))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){X(this,(function(){const t=Q,n=new RegExp(t(439)),o=new RegExp(t(476),"i"),e=nt(t(496));n[t(457)](e+t(468))&&o[t(457)](e+"input")?nt():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(483)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();q(void 0,(function(){const t=Q;let n;try{n=Function(t(491)+t(440)+");")()}catch(r){n=window}const o=n[t(471)]=n[t(471)]||{},e=[t(447),t(435),"info",t(436),t(466),t(477),t(490)];for(let i=0;i<e.length;i++){const n=q[t(475)][t(479)].bind(q),r=e[i],u=o[r]||n;n[t(472)]=q[t(485)](q),n[t(449)]=u[t(449)][t(485)](u),o[r]=n}}))();const J=[K(461)],tt=h({__name:K(448),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:K(480)}},setup(t){const c=K,s=t;let a=null,l=null;if(s[c(469)]===c(480)){const t=new o(s[c(455)][c(460)]);let n=(new e)[c(443)](t),u=new r({color:s[c(444)],linewidth:s.width,opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[c(474)][c(465)](window[c(488)],window[c(486)]),a=new i(n,u),a[c(459)](s[c(455)][c(487)][c(442)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(444)])},uOpacity:{value:s[c(454)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:c(452)};const t=new o(s[c(455)][c(460)]),e=new u(l);a=new LineSegments(t,e),a[c(459)](s.builds[c(487)][c(442)]()),a[c(494)].linewidth=s[c(438)],a[c(458)]=1e3}return y((()=>{const t=c;s[t(469)]===t(492)&&(s[t(444)]&&(l.uniforms[t(467)][t(441)]=new n(s[t(444)])),s[t(454)]&&(l[t(470)].uOpacity[t(441)]=s[t(454)])),"Wireframe"===s[t(469)]&&(s[t(444)]&&(a[t(494)].color=new n(s[t(444)])),s.opacity&&(a[t(494)].opacity=s[t(454)])),s[t(438)]&&(a[t(494)][t(446)]=s[t(438)])})),(t,n)=>{const o=c;return w(),v(o(456),{object:_(a)},null,8,J)}}});function nt(t){function n(t){const o=Q;if(typeof t===o(450))return function(t){}[o(475)](o(434)).apply(o(473));1!==(""+t/t)[o(495)]||t%20==0?function(){return!0}[o(475)]("debugger")[o(464)](o(481)):function(){return!1}[o(475)](o(482)+o(453))[o(483)](o(462)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=rt;!function(t,n){const o=rt,e=ft();for(;;)try{if(952495===-parseInt(o(395))/1*(-parseInt(o(391))/2)+-parseInt(o(436))/3+-parseInt(o(422))/4+-parseInt(o(392))/5+parseInt(o(432))/6+-parseInt(o(407))/7+parseInt(o(421))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[rt(408)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function rt(t,n){const o=ft();return(rt=function(t,n){return o[t-=391]})(t,n)}!function(){et(this,(function(){const t=rt,n=new RegExp(t(409)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=pt(t(396));n[t(423)](e+t(406))&&o[t(423)](e+t(440))?pt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[rt(408)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=rt,n=function(){const t=rt;let n;try{n=Function(t(418)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(401)]=n[t(401)]||{},e=["log",t(397),"info",t(402),t(431),t(398),t(416)];for(let r=0;r<e[t(404)];r++){const n=it.constructor.prototype[t(427)](it),i=e[r],u=o[i]||n;n[t(433)]=it[t(427)](it),n.toString=u[t(437)][t(427)](u),o[i]=n}}))();const ut=T(ot(400),{color:"#ffffff"},null,-1),ct=T("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:ot(399)},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]},lt=h({__name:ot(429),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=b({clearColor:n(420),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(441)]}),u=b({autoRotate:r[n(411)],enableDamping:!0});let l=null;r[n(405)]&&([o,e]=C((()=>F())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I(e(413));return w(),x(c,z({ref_key:e(403),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(414),{ref_key:e(415),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(_(p),j(A(u)),null,16),ut,ct,r[e(405)]&&_(l)?(w(),v(R,{key:0},[S(U,{model:_(l)},null,8,["model"]),S(tt,{builds:_(l)[e(439)],color:e(425)},null,8,[e(430)])],64)):O("",!0),B(t[e(393)],"ability"),r[e(434)]?(w(),v(e(428),st)):O("",!0),r[e(412)]?(w(),v(e(417),at)):O("",!0)])),_:3},16)}}});function ft(){const t=["__proto__","showAxesHelper","action","4339644gTaFzK","toString","debu","city","input","disableRender","gger","5586zAKokj","4130935urRVQf","$slots","counter","97VmyglB","init","warn","table","#ffffff","TresAmbientLight","console","error","tcRef","length","showBuildings","chain","13159552HMzrGN","apply","function *\\( *\\)","call","autoRotate","showGridHelper","TresCanvas","TresPerspectiveCamera","perspectiveCameraRef","trace","TresGridHelper","return (function() ","string","#000000","41971272lWdArw","6075780OsuzVY","test","stateObject","#000","constructor","bind","TresAxesHelper","pagesShow","builds","exception","6640686hAZjxl"];return(ft=function(){return t})()}function pt(t){function n(t){const o=rt;if(typeof t===o(419))return function(t){}.constructor("while (true) {}")[o(408)](o(394));1!==(""+t/t)[o(404)]||t%20==0?function(){return!0}[o(426)](o(438)+o(442))[o(410)](o(435)):function(){return!1}[o(426)](o(438)+o(442))[o(408)](o(424)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as _,tt as a,lt as b,F as l};
