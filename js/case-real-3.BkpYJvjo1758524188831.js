import{N as a,_ as e,co as t,V as l,ao as n,d4 as o,a as s,aP as i}from"./three.CC50Wz7a1758524188831.js";import{M as u,$ as r,K as p,v as c,p as d,V as g,f as h,Y as v,a as f,i as m}from"./@icegl.Dn91pVda1758524188831.js";import{e as b,F as _}from"./@tresjs.BL1sBIDK1758524188831.js";import{_ as w}from"./DevTDTTiles.vue_vue_type_script_setup_true_lang.CRRKJ2YI1758524188831.js";import{d as j,r as M,b as k,w as y,h as x,G as C,o as P,j as T,I as z,f as S,e as I,H as q,u as L,a5 as U,m as A,F as D}from"./@vue.pEDXJ_3Z1758524188831.js";import{_ as F}from"./@fesjs.C0vFiD6Z1758524188831.js";import"./@vueuse.C-O_6is-1758524188831.js";import"./postprocessing.DYlQqnRh1758524188831.js";import"./vue-router.DFx_OtVs1758524188831.js";import"./lodash-es.C7pWAXPe1758524188831.js";import"./pinia.DVrvLNCY1758524188831.js";import"./@qlin.q6OWdsQV1758524188831.js";import"./@babel.BPq7uOAK1758524188831.js";import"./@floating-ui.BFjFSAYt1758524188831.js";import"./@juggle.CcBCnTIR1758524188831.js";const G={scale:[5,5,5]},O=8e5,V=F(j({__name:"case-real-3",setup(j){const F=M({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:t,outputColorSpace:e,toneMapping:a}),V=k({lon:117.84796240906425,lat:38.95216229684954,height:20}),H=k({lon:117.8533521756129,lat:38.95128,height:20});function K(a,e,t,l,n=!0){const o=e-a;return e=>{let s=(e-a)/o;return n&&(s=Math.max(0,Math.min(1,s))),t+s*(l-t)}}const N=k();const R=k(0),W=k(2e3),Y=k(100),$=k(1),B=k(1),E=K(5e3,1e7,1,1e3),J=K(5e3,1e7,.001,1);y(R,(a=>{W.value=2e3/E(a),Y.value=100*E(a),$.value=J(a),B.value=(a-1e5)/9e5*.5}));const Q=k(1),X=k({lon:90.85,lat:40,height:O});const{onLoop:Z}=b();Z((()=>{!function(){const a=performance.now()/1e3*Q.value%500/500*2*Math.PI;X.value.lon=(90.85+180*a/Math.PI)%360,X.value.lat=40+5*Math.cos(a),X.value.height=O}(),N.value&&(R.value=function(a){const e=a.x,t=a.y,l=a.z,n=6378137,o=6356752.314245,s=n*n,i=o*o,u=(s-i)/s,r=(s-i)/i,p=Math.hypot(e,t);if(0===p&&0===l)return Math.sqrt(e*e+t*t+l*l)-n;const c=Math.atan2(l*n,p*o),d=Math.sin(c),g=Math.cos(c),h=Math.atan2(l+r*o*d*d*d,p-u*n*g*g*g),v=Math.sin(h),f=Math.cos(h),m=n/Math.sqrt(1-u*v*v);return Math.abs(f)>1e-12?p/f-m:l/Math.sign(v)-m*(1-u)}(N.value?.getWorldPosition(new l)))}));const aa=k({effectProps:{enabled:!1,focusArea:.7,feather:.1},ambientLight:{color:"#fff",intensity:1},directionalLight:{color:"#fff",intensity:2,position:[-1500,500,500]},background:"/plugins/earthSample/image/menuA/bg-img.png"}),ea=k({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132}),ta=k({heading:90,pitch:45,distance:200}),la=[{lon:117.85481967875631,lat:38.95025551631983},{lon:117.85566616248491,lat:38.95427209924625},{lon:117.85712202478027,lat:38.95970065499051},{lon:118.10293300958989,lat:38.92203696242356},{lon:118.21571040844162,lat:38.8584869570214},{lon:118.56457646308445,lat:38.792815766352845},{lon:119.52790645782477,lat:38.717044062084426},{lon:120.65902562748857,lat:38.60702467836941},{lon:120.79461456776448,lat:38.58622713855249},{lon:120.92076119840306,lat:38.52106665879057},{lon:121.9906916889725,lat:38.18314251246517},{lon:124.14446035378819,lat:37.44557549519065},{lon:125.9802772978905,lat:37.39012819157668},{lon:126.42446686403741,lat:37.35004753338622},{lon:126.48154639818023,lat:37.36107410768207},{lon:126.56124848326965,lat:37.40711309766567},{lon:126.57255884697423,lat:37.421008747816884},{lon:126.581932075672,lat:37.42778825439147},{lon:126.59275992012022,lat:37.42831387228446},{lon:126.60078120441494,lat:37.42464694776248}],na=new n;for(let a=0;a<la.length-1;a++){const e=la[a],t=la[a+1];na.add(new o(new s(e.lon,e.lat),new s(t.lon,t.lat)))}const oa=na.getSpacedPoints(1e3).map((a=>({lon:a.x,lat:a.y,height:20}))),sa=k(!1),ia=k({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132});function ua(){ea.value={heading:0,pitch:-45,distance:1e5,longitude:X.value.lon,latitude:X.value.lat},sa.value=!0}function ra(){ea.value={heading:0,pitch:-45,distance:500,longitude:V.value.lon,latitude:V.value.lat},sa.value=!1}function pa(){ea.value={heading:0,pitch:-45,distance:500,longitude:H.value.lon,latitude:H.value.lat},sa.value=!1}function ca(){ea.value={...ia.value},sa.value=!1}return(a,e)=>{const t=x("TresCanvas");return P(),C(D,null,[T(t,A(F,{"window-size":""}),{default:S((()=>[z("TresPerspectiveCamera",{fov:45,near:.1,far:1e3,"look-at":[0,0,0],ref_key:"cameraRef",ref:N},null,512),T(L(u)),T(L(r),{position:ea.value,"onUpdate:position":e[0]||(e[0]=a=>ea.value=a),targetPosition:ta.value,"onUpdate:targetPosition":e[1]||(e[1]=a=>ta.value=a),target:sa.value?X.value:null,"min-distance":1},null,8,["position","targetPosition","target"]),T(L(p),{sceneConfig:aa.value},null,8,["sceneConfig"]),T(w,{layer:"img"}),T(L(c),{point:V.value},{default:S((()=>[T(L(d),{rotate:-12,"scale-x":.9},{default:S((()=>[T(L(g),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})])),_:1})])),_:1},8,["point"]),T(L(c),{point:H.value},{default:S((()=>[T(L(d),{rotate:-12,"scale-x":.9},{default:S((()=>[T(L(g),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})])),_:1})])),_:1},8,["point"]),(P(),I(U,null,{default:S((()=>[T(L(_),{map:"/plugins/geokit/case-real-3/image/road-texture.png"},{default:S((({textures:a})=>[T(L(h),{texture:a.map,wrapT:L(i),wrapS:L(i)},null,8,["texture","wrapT","wrapS"]),L(oa).length?(P(),I(L(v),{key:0,speed:$.value},{default:S((()=>[T(L(f),{repeat:[W.value,1],map:a.map,duration:4,points:L(oa),width:Y.value,color:"#fff",renderOrder:500},null,8,["repeat","map","points","width"])])),_:2},1032,["speed"])):q("",!0)])),_:1})])),_:1})),L(oa).length?(P(),I(L(f),{key:0,points:L(oa),width:Y.value,color:"#fff",opacity:B.value,renderOrder:200},null,8,["points","width","opacity"])):q("",!0),T(L(c),{point:X.value},{default:S((()=>[T(L(d),{rotate:-12,"scale-x":.9},{default:S((()=>[z("TresGroup",G,[T(L(g),{url:"/plugins/geokit/case-real-3/model/weixing.glb",draco:""})])])),_:1})])),_:1},8,["point"]),T(L(m),{icon:"/plugins/geokit/case-real-3/icons/satellite.svg",size:16,point:X.value,onClick:e[2]||(e[2]=a=>sa.value=!sa.value)},null,8,["point"]),T(L(m),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:V.value},null,8,["point"]),T(L(m),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:H.value},null,8,["point"])])),_:1},16),z("div",{class:"control-panel"},[z("button",{onClick:ua,class:"focus-btn satellite-btn"}," 聚焦卫星 "),z("button",{onClick:ra,class:"focus-btn ship-btn"}," 聚焦船只1 "),z("button",{onClick:pa,class:"focus-btn ship-btn"}," 聚焦船只2 "),z("button",{onClick:ca,class:"reset-btn"}," 还原镜头 ")])],64)}}}),[["__scopeId","data-v-b629d52e"]]);export{V as default};
