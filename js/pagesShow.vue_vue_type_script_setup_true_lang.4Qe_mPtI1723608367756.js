import{Z as t,a6 as n,C as o,cc as e,cd as r,ce as i,cf as u,k as s,bS as c,ab as a,ad as l}from"./three.X8FgZbPT1723608367756.js";import{f,$ as p,d}from"./@tresjs.zzLYikgQ1723608367756.js";import{C as h}from"./three-custom-shader-material.cv-Ci-gX1723608367756.js";import"./object-hash.UuJege4m1723608367756.js";import"./@amap.AaCaABAE1723608367756.js";import"./glsl-tokenizer.ThrrjBBu1723608367756.js";import{d as m,b as g,a1 as y,w,o as v,D as b,u as _,r as C,a4 as I,e as x,f as M,g as T,J as S,j,aj as A,ak as B,F as R,I as O,G as D,m as G}from"./@vue.Q1VpS3901723608367756.js";!function(t,n){const o=z,e=L();for(;;)try{if(183028===-parseInt(o(188))/1*(-parseInt(o(178))/2)+-parseInt(o(176))/3+-parseInt(o(166))/4*(-parseInt(o(183))/5)+parseInt(o(190))/6+parseInt(o(171))/7+parseInt(o(184))/8*(-parseInt(o(194))/9)+-parseInt(o(169))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(170)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=z,n=new RegExp(t(189)),o=new RegExp(t(205),"i"),e=H(t(181));n[t(180)](e+t(185))&&o[t(180)](e+t(193))?H():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(170)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function z(t,n){const o=L();return(z=function(t,n){return o[t-=166]})(t,n)}k(void 0,(function(){const t=z,n=function(){const t=z;let n;try{n=Function(t(200)+t(204)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(187)]||{},e=[t(186),t(175),t(206),t(182),t(196),"table",t(191)];for(let r=0;r<e[t(192)];r++){const n=k[t(195)].prototype[t(199)](k),i=e[r],u=o[i]||n;n.__proto__=k[t(199)](k),n[t(203)]=u[t(203)][t(199)](u),o[i]=n}}))();const F=async()=>{const t=z,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(174)]((n=>{const i=t;n[i(198)]===i(167)&&(o=n),n[i(198)]===i(197)&&(e=n),n[i(198)]===i(172)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function H(t){function n(t){const o=z;if(typeof t===o(207))return function(t){}[o(195)](o(201))[o(170)](o(173));1!==(""+t/t)[o(192)]||t%20==0?function(){return!0}[o(195)](o(179)+o(202))[o(168)](o(177)):function(){return!1}[o(195)]("debugger")[o(170)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function L(){const t=["exception","LANDMASS","name","bind","return (function() ","while (true) {}","gger","toString",'{}.constructor("return this")( )',"\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","info","string","1035712TJMBlK","CITY_UNTRIANGULATED","call","1387350YRqWOg","apply","1459934vJHDQQ","ROADS","counter","traverse","warn","1012113CyMKaE","action","54506ejXQhY","debu","test","init","error","5UPQSrn","5072urNNGv","chain","log","console","1kXgKrD","function *\\( *\\)","2062878SLiSPo","trace","length","input","2547XvDEZl","constructor"];return(L=function(){return t})()}const X=Q;!function(t,n){const o=Q,e=P();for(;;)try{if(228693===-parseInt(o(215))/1+-parseInt(o(217))/2*(-parseInt(o(237))/3)+-parseInt(o(232))/4*(parseInt(o(196))/5)+-parseInt(o(219))/6+parseInt(o(202))/7*(-parseInt(o(229))/8)+-parseInt(o(178))/9+-parseInt(o(226))/10*(-parseInt(o(235))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function P(){const t=["12xoQYnu","boundingBox","138540idxgXw","toString","Color","trace","#ffff00","debu","primitive","30piQgMV","uColor","table","614696sofgEY","value","bind","458316qfWyxH","city","#e523ff","2064491IUuFCX","return (function() ","193512wCRskq","info","object","gger","warn","buildingsModelCustomShader","2802393JrTmSz","land","color","computeBoundingBox","while (true) {}","renderOrder","#ffffff","material","topColor","console","landColor","call","chain","opacity","error","clone","log","model","10jDrnAD","isArray","forEach","#112233","apply","input","7SRGmtz","__proto__","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","side","test","uGradient","__csm","gradient","string","length","action","uniforms","bulidingsColor","80912FwQUCB","constructor"];return(P=function(){return t})()}!function(){Z(this,(function(){const t=Q,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(204),"i"),e=J("init");n[t(206)](e+t(190))&&o[t(206)](e+t(201))?J():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(200)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Q(t,n){const o=P();return(Q=function(t,n){return o[t-=177]})(t,n)}$(void 0,(function(){const t=Q,n=function(){const t=Q;let n;try{n=Function(t(236)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n.console=n[t(187)]||{},e=[t(194),t(241),t(238),t(192),"exception",t(228),t(222)];for(let r=0;r<e[t(211)];r++){const n=$[t(216)].prototype[t(231)]($),i=e[r],u=o[i]||n;n[t(203)]=$[t(231)]($),n.toString=u[t(220)].bind(u),o[i]=n}}))();const W=[X(239)],Y=m({__name:X(177),props:{model:{},bulidingsColor:{default:X(234)},landColor:{default:X(199)},topColor:{default:X(223)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=X,i=e,u=g(0),s=i[r(195)][r(233)];s[r(183)]=1001;const c=i[r(195)][r(179)];(()=>{const e=r,{geometry:c}=s;c[e(181)](),c.computeBoundingSphere();const{max:a,min:l}=c[e(218)];if(s[e(185)][e(208)])return;const f=new h({baseMaterial:s[e(185)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:a},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(n[e(221)])(i[e(214)])},uOpacity:{value:i.opacity},uLightColor:{value:new o(e(184))},uTopColor:{value:new(n[e(221)])(i[e(186)])},uTime:u,uGradient:{value:i[e(209)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t});s[e(185)].dispose(),s[e(185)]=f})();const{onLoop:a}=p();a((({delta:t})=>{u[r(230)]+=t})),y((()=>{const n=r;i[n(214)]&&s[n(185)][n(213)][n(227)].value.setStyle(i.bulidingsColor),i[n(188)]&&((n,o)=>{const e=r;let u;"cu"===n||n===e(179)&&(u=Array[e(197)](c[e(185)])?c[e(185)]:[c.material],u[e(198)]((n=>{const r=e;n[o].setStyle(i.landColor),n[r(205)]=t})))})("land",n(180)),i.opacity&&(s.material[n(213)].uOpacity[n(230)]=i[n(191)])})),w(i,((t,n)=>{const o=r;s[o(185)][o(213)][o(207)][o(230)]=t.gradient}));const l=i[r(195)][r(195)][r(193)]();return(t,n)=>{const o=r;return v(),b(o(225),{object:_(l)},null,8,W)}}});function J(t){function n(t){const o=Q;if(typeof t===o(210))return function(t){}[o(216)](o(182))[o(200)]("counter");1!==(""+t/t)[o(211)]||t%20==0?function(){return!0}[o(216)](o(224)+o(240))[o(189)](o(212)):function(){return!1}[o(216)](o(224)+o(240))[o(200)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const U=tt;function N(){const t=["16531785lcxgMJ","toString","style","action","primitive","renderOrder","apply","counter","210736DfXZGJ","color","chain","exception","matrix","return (function() ","value","width","test","buildingsLines","Shader","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bind","object","100364vgstXY","geometry","debu","5724402zyuiAB","call","length","7994476RKvZSH","set","error",'{}.constructor("return this")( )',"775982mJtNYU","5euvgjA","warn","Wireframe"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","material","clone","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","trace","gger","builds","opacity","constructor","48iUTZbA","input","while (true) {}","#FFF","linewidth","stateObject","uColor","898426JdRhBB","innerHeight","resolution","applyMatrix4","log","table","innerWidth"];return(N=function(){return t})()}!function(t,n){const o=tt,e=N();for(;;)try{if(798783===-parseInt(o(297))/1+-parseInt(o(258))/2+-parseInt(o(310))/3*(-parseInt(o(287))/4)+-parseInt(o(298))/5*(-parseInt(o(290))/6)+-parseInt(o(293))/7+-parseInt(o(273))/8+parseInt(o(265))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[tt(271)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){K(this,(function(){const t=tt,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(284),"i"),e=ot("init");n[t(281)](e+t(275))&&o.test(e+t(311))?ot():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[tt(271)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();q(void 0,(function(){const t=tt;let n;try{n=Function(t(278)+t(296)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(262),t(299),"info",t(295),t(276),t(263),t(305)];for(let i=0;i<e[t(292)];i++){const n=q[t(309)].prototype.bind(q),r=e[i],u=o[r]||n;n.__proto__=q[t(285)](q),n.toString=u[t(266)].bind(u),o[r]=n}}))();const V=[U(286)];function tt(t,n){const o=N();return(tt=function(t,n){return o[t-=253]})(t,n)}const nt=m({__name:U(282),props:{builds:{},width:{default:1},color:{default:U(254)},opacity:{default:1},style:{default:U(300)}},setup(t){const n=U,c=t;let a=null,l=null;if(c[n(267)]===n(300)){const t=new e(c[n(307)][n(288)]);let o=(new r).fromEdgesGeometry(t),s=new i({color:c[n(274)],linewidth:c[n(280)],opacity:c.opacity,transparent:!0,depthWrite:!0,depthTest:!0});s[n(260)][n(294)](window[n(264)],window[n(259)]),a=new u(o,s),a[n(261)](c[n(307)][n(277)][n(303)]())}else{l={transparent:!0,uniforms:{uColor:{value:new o(c.color)},uOpacity:{value:c[n(308)]}},vertexShader:n(304),fragmentShader:n(301)};const t=new e(c[n(307)][n(288)]),r=new s(l);a=new LineSegments(t,r),a[n(261)](c[n(307)][n(277)].clone()),a[n(302)][n(255)]=c.width,a[n(270)]=1e3}return y((()=>{const t=n;c[t(267)]===t(283)&&(c[t(274)]&&(l.uniforms[t(257)].value=new o(c[t(274)])),c[t(308)]&&(l.uniforms.uOpacity[t(279)]=c[t(308)])),c[t(267)]===t(300)&&(c[t(274)]&&(a[t(302)][t(274)]=new o(c.color)),c[t(308)]&&(a[t(302)][t(308)]=c[t(308)])),c.width&&(a[t(302)][t(255)]=c[t(280)])})),(t,o)=>{const e=n;return v(),b(e(269),{object:_(a)},null,8,V)}}});function ot(t){function n(t){const o=tt;if("string"==typeof t)return function(t){}[o(309)](o(253)).apply(o(272));1!==(""+t/t)[o(292)]||t%20==0?function(){return!0}.constructor("debu"+o(306))[o(291)](o(268)):function(){return!1}[o(309)](o(289)+o(306))[o(271)](o(256)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=ft;!function(t,n){const o=ft,e=lt();for(;;)try{if(654309===-parseInt(o(450))/1*(-parseInt(o(426))/2)+parseInt(o(439))/3*(parseInt(o(431))/4)+parseInt(o(459))/5+parseInt(o(461))/6*(parseInt(o(425))/7)+-parseInt(o(470))/8*(parseInt(o(424))/9)+parseInt(o(430))/10+-parseInt(o(451))/11*(parseInt(o(434))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(428)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){rt(this,(function(){const t=ft,n=new RegExp(t(446)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=dt(t(456));n[t(441)](e+"chain")&&o[t(441)](e+"input")?dt():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(428)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=ft,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(471)]=n.console||{},e=["log",t(460),t(448),t(449),"exception",t(458),t(454)];for(let r=0;r<e.length;r++){const n=it[t(463)][t(464)].bind(it),i=e[r],u=o[i]||n;n.__proto__=it[t(437)](it),n[t(466)]=u[t(466)][t(437)](u),o[i]=n}}))();const ut=S(et(462),{color:et(432)},null,-1),st=S(et(440),{position:[100,100,0],intensity:.5,color:et(432)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(){const t=["function *\\( *\\)","call","info","error","1osDoBo","1704637XGlXnX","debu","action","trace","pagesShow","init","while (true) {}","table","4053695MQosaG","warn","675672wrGGBY","TresAmbientLight","constructor","prototype","tcRef","toString","model","#000000","showBuildings","48lVvoHm","console","632439TLrqjx","35KYwpfE","665822kfHFXP","builds","apply","TresCanvas","12530810XQnSNz","1215484fyBATh","#ffffff","TresPerspectiveCamera","240bUpois","$slots","TresAxesHelper","bind","disableRender","12OEFhCg","TresDirectionalLight","test","perspectiveCameraRef","TresGridHelper","autoRotate","gger"];return(lt=function(){return t})()}function ft(t,n){const o=lt();return(ft=function(t,n){return o[t-=424]})(t,n)}const pt=m({__name:et(455),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=C({clearColor:n(468),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:a,toneMapping:l,disableRender:r[n(438)]}),u=C({autoRotate:r[n(444)],enableDamping:!0});let s=null;r[n(469)]&&([o,e]=I((()=>F())),o=await o,e(),s=o);const f=g(),p=g();return(t,o)=>{const e=n,c=x(e(429));return v(),M(c,G({ref_key:e(465),ref:p},i,{"window-size":""}),{default:T((()=>[S(e(433),{ref_key:e(442),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(_(d),A(B(u)),null,16),ut,st,r[e(469)]&&_(s)?(v(),b(R,{key:0},[j(Y,{model:_(s)},null,8,[e(467)]),j(nt,{builds:_(s).city,color:"#000"},null,8,[e(427)])],64)):O("",!0),D(t[e(435)],"ability"),r.showAxesHelper?(v(),b(e(436),ct)):O("",!0),r.showGridHelper?(v(),b(e(443),at)):O("",!0)])),_:3},16)}}});function dt(t){function n(t){const o=ft;if("string"==typeof t)return function(t){}[o(463)](o(457))[o(428)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(452)+o(445))[o(447)](o(453)):function(){return!1}[o(463)]("debu"+o(445))[o(428)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{Y as _,nt as a,pt as b,F as l};
