import{m as n,e as t}from"./@tresjs.lftldzUe1733214749102.js";import{_ as e,V as o,cd as r,ce as i,cf as u,C as c,cA as a}from"./three.aWgA1gea1733214749102.js";import{z as s}from"./three-custom-shader-material.uIcenEYv1733214749102.js";import{T as f}from"./3d-tiles-renderer.OQ2ncZZ51733214749102.js";import{d as l,b as p,a3 as d,o as m,D as h,J as g,u as v}from"./@vue.-THQH3GC1733214749102.js";import{P as w,U as y,M as x,T as _,a as b}from"./index.xqKa2GFZ1733214749102.js";import"./mapBoxShow.vue_vue_type_script_setup_true_lang.eCBeTodo1733214749102.js";import"./informationDiv.vue_vue_type_style_index_0_scoped_d511bb21_lang.2NWQ16AB1733214749102.js";import"./utils.Wgmc-DBO1733214749102.js";!function(n,t){const e=S,o=C();for(;;)try{if(603602===parseInt(e(533))/1+parseInt(e(529))/2*(-parseInt(e(519))/3)+-parseInt(e(500))/4+parseInt(e(499))/5+-parseInt(e(528))/6*(parseInt(e(523))/7)+parseInt(e(495))/8*(-parseInt(e(510))/9)+parseInt(e(532))/10*(parseInt(e(505))/11))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const I=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function C(){const n=["test","onLoadTileSet","Sphere","error","string","return (function() ","215184SfIAqn","debu","bind","apply","2722910GxXLlm","1117544YPYtNp","quaternion","position",'{}.constructor("return this")( )',"normalize","11olZFSV","prototype","Matrix4","warn","group","189KhkSRd","exception","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__proto__","setFromMatrixPosition","crossVectors","console","info","counter","1904034lJxNXs","function *\\( *\\)","length","getBoundingSphere","539JZYnXn","Box3","Vector3","call","init","90564KexcKY","2AifQYJ","constructor","Quaternion","19043620pkWaFp","795818jlKtSv","table","chain","getOrientedBounds","action","stateObject","trace","clone"];return(C=function(){return n})()}!function(){I(this,(function(){const n=S,t=new RegExp(n(520)),e=new RegExp(n(512),"i"),o=T(n(527));t[n(489)](o+n(535))&&e[n(489)](o+"input")?T():o("0")}))()}();const M=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[S(498)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();M(void 0,(function(){const n=S,t=function(){const n=S;let t;try{t=Function(n(494)+n(503)+");")()}catch(e){t=window}return t}(),e=t.console=t[n(516)]||{},o=["log",n(508),n(517),n(492),n(511),n(534),n(487)];for(let r=0;r<o[n(521)];r++){const t=M[n(530)][n(506)][n(497)](M),i=o[r],u=e[i]||t;t[n(513)]=M[n(497)](M),t.toString=u.toString[n(497)](u),e[i]=t}}))();const z=n=>{const t=S;n[t(490)]=r=>{const i=t,u=new(e[i(524)]),c=new(e[i(491)]),a=new(e[i(507)]);let s=null,f=0;n[i(536)](u,a)?(s=(new o)[i(514)](a),f=s[i(521)]()):n[i(522)](c)&&(s=c.center[i(488)](),f=s[i(521)]());const l=((n,t)=>{const o=S,r=new(e[o(531)]),i=(new(e[o(525)]))[o(515)](n,t);return r.x=i.x,r.y=i.y,r.z=i.z,r.w=1+n[o(488)]().dot(t),r[o(504)](),r})(null==s?void 0:s.normalize(),new(e[i(525)])(0,1,0));n[i(509)][i(501)].x=l.x,n[i(509)][i(501)].y=l.y,n.group.quaternion.z=l.z,n[i(509)][i(501)].w=l.w,n[i(509)][i(502)].z=-f}};function S(n,t){const e=C();return(S=function(n,t){return e[n-=487]})(n,t)}function T(n){function t(n){const e=S;if(typeof n===e(493))return function(n){}[e(530)]("while (true) {}")[e(498)](e(518));1!==(""+n/n).length||n%20==0?function(){return!0}.constructor(e(496)+"gger")[e(526)](e(537)):function(){return!1}[e(530)](e(496)+"gger")[e(498)](e(538)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const j=R;!function(n,t){const e=R,o=P();for(;;)try{if(133886===parseInt(e(512))/1+-parseInt(e(457))/2+parseInt(e(461))/3*(parseInt(e(470))/4)+parseInt(e(497))/5*(parseInt(e(488))/6)+-parseInt(e(454))/7*(parseInt(e(459))/8)+-parseInt(e(460))/9*(-parseInt(e(472))/10)+-parseInt(e(463))/11*(-parseInt(e(516))/12))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const B=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){B(this,(function(){const n=R,t=new RegExp(n(513)),e=new RegExp(n(496),"i"),o=E(n(474));t[n(491)](o+n(506))&&e[n(491)](o+"input")?E():o("0")}))()}();const O=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[R(446)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function R(n,t){const e=P();return(R=function(n,t){return e[n-=438]})(n,t)}O(void 0,(function(){const n=R;let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(r){t=window}const e=t[n(451)]=t[n(451)]||{},o=[n(478),n(495),n(483),n(503),n(462),n(510),n(443)];for(let i=0;i<o[n(486)];i++){const t=O[n(445)][n(471)][n(473)](O),r=o[i],u=e[r]||t;t[n(444)]=O.bind(O),t.toString=u[n(484)][n(473)](u),e[r]=t}}))();const A=[j(438)];function P(){const n=["#ffff00","innerWidth","geometry","setResolutionFromRenderer","info","toString","material","length","string","52170aQKhnc","EdgesGeometry","opacity","test","DoubleSide","resolution","scene","warn","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","35UfrZho","camera","applyMatrix4","stateObject","errorTarget","#ffffff","error","update","fromEdgesGeometry","chain","gger","clone","while (true) {}","table","isMesh","122009iOxmNJ","function *\\( *\\)","add","TresGroup","2431716ccncVH","object","dispose","matrix","gradient","castShadow","trace","__proto__","constructor","apply","set","updateMatrixWorld","onLoadModel","counter","console","debu","parent","421995gppEOc","width","#e523ff","481204SIbObx","value","8wZUQPe","439335CNYWds","147ogQWzM","exception","11KpNWxU","setCamera","MeshPhongMaterial","tilesBuildings","boundingBox","Color","group","36FfmRRl","prototype","10vetOzH","bind","init","computeBoundingBox","https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json","action","log"];return(P=function(){return n})()}const Z=l({__name:j(466),props:{bulidingsColor:{default:j(456)},topColor:{default:j(479)},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(o){const a=j,l=o,w=p(0),y=new f(a(476));y[a(501)]=2,y[a(449)]=n=>{const t=a;n[t(494)].traverse((n=>{const o=t;if(n[o(511)]){(n=>{const t=R,{geometry:o}=n;o[t(475)](),o.computeBoundingSphere();const{max:r,min:i}=o[t(467)],u=new s({baseMaterial:new(e[t(465)]),vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor; // 顶部颜色\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main() {\n  // 转世界坐标\n  uMax_world = modelMatrix * vec4(uMax, 1.);\n  uMin_world = modelMatrix * vec4(uMin, 1.);\n  vec3 distColor = uColor;\n  float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n  float rate = residue / uCircleTime;\n  float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n  if (uMin_world.y + lightOffset < vPosition.y &&\n      uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n    csm_DiffuseColor = vec4(uLightColor, uOpacity);\n  } else {\n    csm_DiffuseColor = vec4(distColor, uOpacity);\n  }\n\n  // 根据高度计算颜色\n  if (uGradient) {\n    float rateHight =\n        (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y);\n    // vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight * 0.6);\n    float mixNumber = clamp(rateHight * 2.3 - 1.5, 0., 1.);\n    vec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, mixNumber);\n\n    csm_DiffuseColor = vec4(outColor, uOpacity);\n  }\n}",silent:!0,uniforms:{uMax:{value:r},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(e[t(468)])(l.bulidingsColor)},uOpacity:{value:l[t(490)]},uLightColor:{value:new c(t(502))},uTopColor:{value:new(e[t(468)])(l.topColor)},uTime:w,uGradient:{value:l[t(441)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:e[t(492)]});n[t(485)][t(439)](),n[t(485)]=u})(n),n.receiveShadow=!1,n[o(442)]=!1;const t=new(e[o(489)])(n[o(481)].clone());let a=(new r)[o(505)](t),f=new i({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});f[o(493)][o(447)](window[o(480)],window.innerHeight);const p=new u(a,f);p[o(499)](n[o(440)][o(508)]()),n[o(453)][o(514)](p)}}))},z(y);const{renderer:x,sizes:_}=n();d((()=>{const n=a;_[n(455)][n(458)]&&(y[n(464)](l[n(498)]),y[n(482)](l[n(498)],x.value))}));const{onBeforeLoop:b}=t();return b((({delta:n})=>{const t=a;w[t(458)]+=2*n,l[t(498)]&&_.width[t(458)]&&(l[t(498)][t(448)](),y[t(504)]())})),(n,t)=>{const e=a;return m(),h(e(515),null,[g("primitive",{object:v(y)[e(469)]},null,8,A)])}}});function E(n){function t(n){const e=R;if(typeof n===e(487))return function(n){}[e(445)](e(509))[e(446)](e(450));1!==(""+n/n)[e(486)]||n%20==0?function(){return!0}[e(445)]("debu"+e(507)).call(e(477)):function(){return!1}[e(445)](e(452)+e(507))[e(446)](e(500)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const W=L;!function(n,t){const e=L,o=G();for(;;)try{if(421330===-parseInt(e(404))/1*(parseInt(e(401))/2)+parseInt(e(425))/3*(parseInt(e(396))/4)+parseInt(e(440))/5*(-parseInt(e(402))/6)+parseInt(e(391))/7*(parseInt(e(442))/8)+-parseInt(e(423))/9+parseInt(e(418))/10*(-parseInt(e(441))/11)+parseInt(e(429))/12)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const F=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[L(448)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){F(this,(function(){const n=L,t=new RegExp(n(390)),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=Q(n(405));t[n(398)](o+n(408))&&e[n(398)](o+n(389))?Q():o("0")}))()}();const D=function(){let n=!0;return function(t,e){const o=n?function(){if(e){const n=e[L(448)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();D(void 0,(function(){const n=L;let t;try{t=Function(n(443)+n(400)+");")()}catch(r){t=window}const e=t[n(432)]=t.console||{},o=[n(421),n(454),"info",n(447),"exception",n(437),n(420)];for(let i=0;i<o[n(397)];i++){const t=D[n(416)][n(456)][n(399)](D),r=o[i],u=e[r]||t;t[n(434)]=D.bind(D),t[n(413)]=u.toString[n(399)](u),e[r]=t}}))();const H=[W(433),"rotation"];function L(n,t){const e=G();return(L=function(n,t){return e[n-=389]})(n,t)}const k=l({__name:"tileMapBuildingsMesh",props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(o,{expose:r}){const i=W,u=o,{renderer:s,scene:f}=n(),l=new w;l[i(414)]=y;const p=new x;p[i(427)]=i(444),p[i(431)]=!1,p[i(411)]=!0;const g=new _(l,p);g.showBoundingBox=!1,g[i(449)]=!1,g[i(455)]=!1,g[i(424)]={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let I=new c(i(450));g.filter[i(410)]={r:I.r,g:I.g,b:I.b};const C=new b;C[i(415)]=g,C[i(412)]=u[i(412)],C[i(409)]=u[i(409)],u.camera.up=new(e[i(407)])(0,1,0),u.camera[i(451)][i(419)](u[i(453)][0],u[i(453)][2],2e3-u[i(453)][1]),u[i(446)][i(417)](new(e[i(407)])(u.camera[i(451)].x,0,u[i(446)][i(451)].z-3e3)),C.camera=u.camera;let M=null;d((()=>{const n=i;s[n(438)]&&(M=new a(u.camera,s[n(438)][n(439)]),M[n(452)]=!0,M[n(435)]=.05,M[n(445)]=600,M[n(436)][n(419)](u.camera[n(451)].x,u.camera[n(451)].y,u[n(446)][n(451)].z),M[n(430)].set(u.camera[n(451)].x,0,u[n(446)][n(451)].z-2e3))}));const{onLoop:z}=t();return z((()=>{const n=i;if(s.value){const t=50*Math.abs(u[n(446)][n(451)].y);u[n(446)][n(403)]=t+5e3,u[n(446)].updateProjectionMatrix(),M&&(M.update(),M[n(430)].y=0),C[n(393)](),s[n(438)][n(406)](f.value,u.camera)}})),r({camera:u[i(446)],map:C}),(n,t)=>{const e=i;return m(),h(e(428),{object:v(C),rotation:[-Math.PI/2,0,0]},null,8,H)}}});function G(){const n=["log","action","4425687AdJeeo","filter","213LTsHNB","string","source","primitive","25472784WemXfK","target","showTileNo","console","object","__proto__","dampingFactor","position0","table","value","domElement","520eBHaoM","22nYoaGY","86272GHkQgr","return (function() ","https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}","minDistance","camera","error","apply","wireframe","#4688b5","position","enableDamping","mapCenter","warn","flatShading","prototype","call","input","function *\\( *\\)","91kMftXV","gger","update","counter","stateObject","2024eXTwnF","length","test","bind",'{}.constructor("return this")( )',"2CCpSyV","31206rxTQrC","far","807485zcIxAf","init","render","Vector3","chain","maxZoom","monochrome","useWorker","bbox","toString","coordType","provider","constructor","lookAt","186940AHHSgD","set","trace"];return(G=function(){return n})()}function Q(n){function t(n){const e=L;if(typeof n===e(426))return function(n){}.constructor("while (true) {}")[e(448)](e(394));1!==(""+n/n)[e(397)]||n%20==0?function(){return!0}[e(416)]("debugger")[e(457)](e(422)):function(){return!1}[e(416)]("debu"+e(392))[e(448)](e(395)),t(++n)}try{if(n)return t;t(0)}catch(e){}}!function(n,t){for(var e=V,o=N();;)try{if(921844===parseInt(e(182))/1+parseInt(e(202))/2*(parseInt(e(195))/3)+parseInt(e(177))/4+-parseInt(e(183))/5+parseInt(e(172))/6+-parseInt(e(178))/7*(parseInt(e(174))/8)+-parseInt(e(176))/9)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();var Y=function(){var n=!0;return function(t,e){var o=n?function(){if(e){var n=e[V(179)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();!function(){Y(this,(function(){var n=V,t=new RegExp(n(185)),e=new RegExp(n(188),"i"),o=J(n(184));t[n(191)](o+n(171))&&e[n(191)](o+n(200))?J():o("0")}))()}();var K=function(){var n=!0;return function(t,e){var o=n?function(){if(e){var n=e[V(179)](t,arguments);return e=null,n}}:function(){};return n=!1,o}}();function N(){var n=["7qayghK","apply","return (function() ","toString","543382YjRRJC","2627255anQCQy","init","function *\\( *\\)","log","trace","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","action","exception","test","debu","table","constructor","102bdgLKJ","counter","gger","bind","while (true) {}","input","string","78538qUCeIT","prototype","chain","7063848PFMQRB","__proto__","2793360sgVasw","stateObject","21964599nvemoE","4724560Ypltuy"];return(N=function(){return n})()}function V(n,t){var e=N();return(V=function(n,t){return e[n-=170]})(n,t)}function J(n){function t(n){var e=V;if(typeof n===e(201))return function(n){}[e(194)](e(199)).apply(e(196));1!==(""+n/n).length||n%20==0?function(){return!0}[e(194)](e(192)+"gger").call(e(189)):function(){return!1}[e(194)](e(192)+e(197))[e(179)](e(175)),t(++n)}try{if(n)return t;t(0)}catch(e){}}K(void 0,(function(){var n,t=V;try{n=Function(t(180)+'{}.constructor("return this")( ));')()}catch(a){n=window}for(var e=n.console=n.console||{},o=[t(186),"warn","info","error",t(190),t(193),t(187)],r=0;r<o.length;r++){var i=K[t(194)][t(170)][t(198)](K),u=o[r],c=e[u]||i;i[t(173)]=K[t(198)](K),i[t(181)]=c.toString[t(198)](c),e[u]=i}}))();export{Z as _,k as a};
