import{a0 as t,C as n,cf as o,cg as e,ch as r,ci as i,m as u,bU as c,ak as s,am as a}from"./three.ZWd_rX7H1726563592429.js";import{c as l,U as f,Y as p}from"./@tresjs.Mu0zjs701726563592429.js";import{C as d}from"./three-custom-shader-material.fdrKMsxZ1726563592429.js";import"./object-hash.PY2g7Wtg1726563592429.js";import"./@amap.JADYh6_E1726563592429.js";import"./glsl-tokenizer.Mx0qLbNn1726563592429.js";import{d as h,b as m,a3 as y,w as g,o as w,E as v,u as b,r as _,a4 as I,e as C,f as x,g as M,L as T,j as S,aj as j,ak as O,F as R,J as A,H as B,m as k}from"./@vue.bvMz0l_u1726563592429.js";!function(t,n){const o=F,e=H();for(;;)try{if(924720===parseInt(o(384))/1*(-parseInt(o(368))/2)+-parseInt(o(378))/3+parseInt(o(382))/4*(-parseInt(o(363))/5)+-parseInt(o(372))/6+parseInt(o(364))/7*(parseInt(o(385))/8)+-parseInt(o(362))/9*(-parseInt(o(357))/10)+parseInt(o(390))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(383)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=F,n=new RegExp(t(370)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=G(t(393));n.test(e+t(374))&&o[t(360)](e+t(367))?G():e("0")}))()}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(383)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();L(void 0,(function(){const t=F,n=function(){const t=F;let n;try{n=Function(t(386)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(387)]=n[t(387)]||{},e=[t(358),t(388),"info",t(377),"exception",t(381),t(359)];for(let r=0;r<e[t(366)];r++){const n=L[t(371)][t(355)][t(356)](L),i=e[r],u=o[i]||n;n[t(376)]=L.bind(L),n[t(369)]=u[t(369)][t(356)](u),o[i]=n}}))();const E=async()=>{const t=F,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(375)]((n=>{const i=t;n[i(394)]===i(379)&&(o=n),n[i(394)]===i(392)&&(e=n),n[i(394)]===i(389)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function F(t,n){const o=H();return(F=function(t,n){return o[t-=354]})(t,n)}function G(t){function n(t){const o=F;if(typeof t===o(365))return function(t){}.constructor(o(354))[o(383)]("counter");1!==(""+t/t)[o(366)]||t%20==0?function(){return!0}.constructor(o(391)+"gger")[o(373)](o(380)):function(){return!1}[o(371)]("debugger")[o(383)](o(361)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function H(){const t=["constructor","3223704BisGfK","call","chain","traverse","__proto__","error","1246257ZTOOxy","CITY_UNTRIANGULATED","action","table","3722172wBwcjR","apply","200FHhTzd","32jOXkMm","return (function() ","console","warn","ROADS","7963890kYePSc","debu","LANDMASS","init","name","while (true) {}","prototype","bind","2060XlXSus","log","trace","test","stateObject","76518kqVdcc","5VRTEGf","2851737KRwRKH","string","length","input","12970yMoNCP","toString","function *\\( *\\)"];return(H=function(){return t})()}const Z=D;!function(t,n){const o=D,e=U();for(;;)try{if(905980===parseInt(o(330))/1*(-parseInt(o(347))/2)+-parseInt(o(351))/3*(-parseInt(o(311))/4)+-parseInt(o(337))/5*(-parseInt(o(355))/6)+parseInt(o(332))/7+parseInt(o(300))/8*(parseInt(o(331))/9)+-parseInt(o(348))/10+-parseInt(o(322))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(354)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){P(this,(function(){const t=D,n=new RegExp(t(304)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=N("init");n[t(340)](e+"chain")&&o[t(340)](e+"input")?N():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[D(354)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function D(t,n){const o=U();return(D=function(t,n){return o[t-=300]})(t,n)}W(void 0,(function(){const t=D,n=function(){const t=D;let n;try{n=Function(t(320)+t(309)+");")()}catch(o){n=window}return n}(),o=n[t(329)]=n[t(329)]||{},e=[t(302),t(345),t(303),t(328),t(343),"table",t(321)];for(let r=0;r<e.length;r++){const n=W[t(335)].prototype.bind(W),i=e[r],u=o[i]||n;n[t(313)]=W.bind(W),n[t(314)]=u[t(314)].bind(u),o[i]=n}}))();const $=[Z(341)];function U(){const t=['{}.constructor("return this")( )',"landColor","372996zSSaui","opacity","__proto__","toString","setStyle","debu","#112233","material","gradient","return (function() ","trace","165440Zyuqha","bulidingsColor","__csm","counter","isArray","color","error","console","239IIdBYQ","81yIWETn","4392591xLnajh","uniforms","value","constructor","uGradient","680145RhemVy","length","string","test","object","renderOrder","exception","gger","warn","forEach","8572eDtLGF","127710yYZEqO","uOpacity","clone","3kmwjJr","call","land","apply","54QnHIOX","boundingBox","11664wVeFsw","computeBoundingSphere","log","info","function *\\( *\\)","#ffffff","model","action","side"];return(U=function(){return t})()}const V=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:Z(317)},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=Z,r=o,i=m(0),u=r.model.city;u[e(342)]=1001;const c=r[e(306)][e(353)];(()=>{const o=e,{geometry:c}=u;c.computeBoundingBox(),c[o(301)]();const{max:s,min:a}=c[o(356)];if(u[o(318)][o(324)])return;const l=new d({baseMaterial:u[o(318)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(r[o(323)])},uOpacity:{value:r.opacity},uLightColor:{value:new n(o(305))},uTopColor:{value:new n(r.topColor)},uTime:i,uGradient:{value:r[o(319)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t});u[o(318)].dispose(),u[o(318)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i.value+=t})),y((()=>{const n=e;r[n(323)]&&u.material.uniforms.uColor[n(334)][n(315)](r[n(323)]),r[n(310)]&&((n,o)=>{const i=e;let u;"cu"===n||n===i(353)&&(u=Array[i(326)](c[i(318)])?c[i(318)]:[c[i(318)]],u[i(346)]((n=>{const e=i;n[o][e(315)](r.landColor),n[e(308)]=t})))})(n(353),n(327)),r[n(312)]&&(u[n(318)][n(333)][n(349)].value=r[n(312)])})),g(r,((t,n)=>{const o=e;u[o(318)].uniforms[o(336)][o(334)]=t[o(319)]}));const a=r[e(306)].model[e(350)]();return(t,n)=>(w(),v("primitive",{object:b(a)},null,8,$))}});function N(t){function n(t){const o=D;if(typeof t===o(339))return function(t){}[o(335)]("while (true) {}")[o(354)](o(325));1!==(""+t/t)[o(338)]||t%20==0?function(){return!0}[o(335)]("debu"+o(344))[o(352)](o(307)):function(){return!1}[o(335)](o(316)+o(344))[o(354)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const q=Y;!function(t,n){const o=Y,e=Q();for(;;)try{if(256358===-parseInt(o(316))/1+-parseInt(o(294))/2*(-parseInt(o(323))/3)+parseInt(o(308))/4*(parseInt(o(332))/5)+parseInt(o(301))/6+parseInt(o(304))/7+-parseInt(o(309))/8+parseInt(o(297))/9*(-parseInt(o(288))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Y(280)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=Y,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(321),"i"),e=nt(t(281));n[t(287)](e+t(298))&&o[t(287)](e+t(317))?nt():e("0")}))()}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Y(t,n){const o=Q();return(Y=function(t,n){return o[t-=277]})(t,n)}function Q(){const t=[" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","clone","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","style","672723kBUeAm","matrix","log","table","trace","linewidth","buildingsLines","Shader","warn","40XMhngT","gger","string","width","apply","init","geometry","innerWidth","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","value","debu","test","75220tVzsiY","stateObject","color","Wireframe","renderOrder","opacity","4Clgpqp","uColor","console","963ShZiqz","chain","#FFF","object","2702220loGknB","constructor","action","3032862VTROyL","uniforms","applyMatrix4","bind","103036gxarzn","502216ZkPczw",'{}.constructor("return this")( )',"fromEdgesGeometry","info","builds","material","counter","414201GCydjU","input","primitive"];return(Q=function(){return t})()}X(void 0,(function(){const t=Y;let n;try{n=Function("return (function() "+t(310)+");")()}catch(r){n=window}const o=n[t(296)]=n[t(296)]||{},e=[t(325),t(331),t(312),"error","exception",t(326),t(327)];for(let i=0;i<e.length;i++){const n=X[t(302)].prototype.bind(X),r=e[i],u=o[r]||n;n.__proto__=X[t(307)](X),n.toString=u.toString[t(307)](u),o[r]=n}}))();const K=[q(300)],tt=h({__name:q(329),props:{builds:{},width:{default:1},color:{default:q(299)},opacity:{default:1},style:{default:q(291)}},setup(t){const c=q,s=t;let a=null,l=null;if(s[c(322)]===c(291)){const t=new o(s[c(313)][c(282)]);let n=(new e)[c(311)](t),u=new r({color:s.color,linewidth:s[c(279)],opacity:s[c(293)],transparent:!0,depthWrite:!0,depthTest:!0});u.resolution.set(window[c(283)],window.innerHeight),a=new i(n,u),a.applyMatrix4(s.builds[c(324)][c(320)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(290)])},uOpacity:{value:s[c(293)]}},vertexShader:c(284),fragmentShader:c(319)};const t=new o(s[c(313)][c(282)]),e=new u(l);a=new LineSegments(t,e),a[c(306)](s.builds.matrix[c(320)]()),a[c(314)][c(328)]=s[c(279)],a[c(292)]=1e3}return y((()=>{const t=c;s[t(322)]===t(330)&&(s.color&&(l[t(305)][t(295)].value=new n(s[t(290)])),s[t(293)]&&(l.uniforms.uOpacity[t(285)]=s[t(293)])),"Wireframe"===s[t(322)]&&(s.color&&(a[t(314)].color=new n(s.color)),s.opacity&&(a[t(314)][t(293)]=s[t(293)])),s[t(279)]&&(a[t(314)][t(328)]=s.width)})),(t,n)=>{const o=c;return w(),v(o(318),{object:b(a)},null,8,K)}}});function nt(t){function n(t){const o=Y;if(typeof t===o(278))return function(t){}[o(302)]("while (true) {}")[o(280)](o(315));1!==(""+t/t).length||t%20==0?function(){return!0}[o(302)]("debu"+o(277)).call(o(303)):function(){return!1}[o(302)](o(286)+"gger")[o(280)](o(289)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=lt;!function(t,n){const o=lt,e=at();for(;;)try{if(473826===-parseInt(o(145))/1+-parseInt(o(125))/2*(parseInt(o(139))/3)+parseInt(o(130))/4*(-parseInt(o(163))/5)+parseInt(o(152))/6*(-parseInt(o(165))/7)+parseInt(o(138))/8+-parseInt(o(161))/9+parseInt(o(122))/10*(parseInt(o(150))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(155)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=lt,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(157),"i"),e=pt(t(126));n[t(144)](e+"chain")&&o[t(144)](e+t(124))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(155)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=lt,n=function(){const t=lt;let n;try{n=Function(t(132)+t(119)+");")()}catch(o){n=window}return n}(),o=n[t(129)]=n.console||{},e=["log","warn",t(120),t(137),"exception",t(143),t(156)];for(let r=0;r<e[t(148)];r++){const n=rt[t(128)][t(146)][t(149)](rt),i=e[r],u=o[i]||n;n.__proto__=rt[t(149)](rt),n[t(142)]=u.toString[t(149)](u),o[i]=n}}))();const it=T(ot(154),{color:ot(160)},null,-1),ut=T(ot(134),{position:[100,100,0],intensity:.5,color:ot(160)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(){const t=["disableRender","TresAmbientLight","apply","trace","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","TresPerspectiveCamera","counter","#ffffff","7247817SugoFR","stateObject","6505fyuFpI","gger","805ocUWcp","#000",'{}.constructor("return this")( )',"info","action","1590LDfJfI","TresAxesHelper","input","37418SyWNfR","init","showAxesHelper","constructor","console","2888xHjZTN","$slots","return (function() ","call","TresDirectionalLight","pagesShow","tcRef","error","106992mnSzHA","72dJqUNl","showGridHelper","showBuildings","toString","table","test","857750FPIEGQ","prototype","debu","length","bind","261822mAbJQW","builds","14226vJMrVj"];return(at=function(){return t})()}function lt(t,n){const o=at();return(lt=function(t,n){return o[t-=118]})(t,n)}const ft=h({__name:ot(135),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(153)]}),u=_({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r[n(141)]&&([o,e]=I((()=>E())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,k({ref_key:e(136),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(158),{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(p),j(O(u)),null,16),it,ut,r[e(141)]&&b(l)?(w(),v(R,{key:0},[S(V,{model:b(l)},null,8,["model"]),S(tt,{builds:b(l).city,color:e(118)},null,8,[e(151)])],64)):A("",!0),B(t[e(131)],"ability"),r[e(127)]?(w(),v(e(123),ct)):A("",!0),r[e(140)]?(w(),v("TresGridHelper",st)):A("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=lt;if("string"==typeof t)return function(t){}[o(128)]("while (true) {}").apply(o(159));1!==(""+t/t)[o(148)]||t%20==0?function(){return!0}[o(128)](o(147)+"gger")[o(133)](o(121)):function(){return!1}[o(128)](o(147)+o(164))[o(155)](o(162)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{V as _,tt as a,ft as b,E as l};
