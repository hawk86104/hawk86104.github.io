import{B as e}from"./three-custom-shader-material.C6taB_aY1763540743861.js";import{am as t,ae as n,ei as a,M as i}from"./three.rXKzP9fQ1763540743861.js";import{u as r}from"./colorList.DbCLsRg71763540743861.js";import{u as s}from"./rawData.Bm5IktqG1763540743861.js";import{d as o,r as l,a as m,w as d,H as h,o as p,J as x,u as c}from"./@vue.Co_gxueH1763540743861.js";const u=["visible"],g=["scale"],w=["object"],f=["object"],T=o({__name:"surfaceSection",props:{paneControl:{}},setup(o){const T=o,b=r(),v=s(),S=(()=>{const e=new a(v.xExtent,v.yExtent,v.zExtent,v.dataType[v.selectDataType].title,v.byteArray);return e.spacing=[1,1,1],e.RASDimensions=[Math.floor(e.xLength),Math.floor(e.yLength),Math.floor(e.zLength)],e.matrix=new i,e.inverseMatrix=new i,e.inverseMatrix.copy(e.matrix).invert(),e.computeMinMax(),e.windowLow=-200,e.windowHigh=250,e.lowerThreshold=0,e.upperThreshold=250,e})(v.byteArray),L=l({x:Math.floor(S.RASDimensions[0]/2),z:Math.floor(S.RASDimensions[2]/2)}),M=S.extractSlice("x",L.x),A=S.extractSlice("z",L.z),D={vertexShader:"\n\tvoid main() {\n\t\tcsm_Position = position * vec3(1.0);\n\t}\n\t",fragmentShader:"\n\t\t\tuniform sampler2D eTexture;     //纹理图像\n\t\t\tvoid main() {\n\t\t\t\t\tcsm_DiffuseColor = texture2D( eTexture, vec2(csm_DiffuseColor.r,0.5));\n\t\t\t}\n\t",uniforms:{eTexture:{value:b.updateTransferFunction()}},silent:!0,flatShading:!0,side:n,transparent:!0,depthWrite:!0,depthTest:!0,blending:t};M.mesh.material=new e({baseMaterial:M.mesh.material,...D}),A.mesh.material=new e({baseMaterial:A.mesh.material,...D});const y=T.paneControl;y.addBinding(L,"x",{label:"x剖面",min:0,max:S.RASDimensions[0],step:1}),y.addBinding(L,"z",{label:"z剖面",min:0,max:S.RASDimensions[2],step:1}),y.addBinding(S,"lowerThreshold",{label:"lowerThreshold",min:S.min-200,max:S.max+100,step:1}).on("change",()=>{S.repaintAllSlices()}),y.addBinding(S,"upperThreshold",{label:"upperThreshold",min:S.min-100,max:S.max+100,step:1}).on("change",()=>{S.repaintAllSlices()}),y.addBinding(S,"windowLow",{label:"windowLow",min:S.min-200,max:S.max,step:1}).on("change",()=>{S.repaintAllSlices()}),y.addBinding(S,"windowHigh",{label:"windowHigh",min:S.min,max:S.max+100,step:1}).on("change",()=>{S.repaintAllSlices()});const z=m(!0);return y.addBinding(z,"value",{label:"显示三维体"}),d(()=>L,e=>{M.index=e.x,M.repaint.call(M),A.index=e.z,A.repaint.call(A)},{deep:!0}),d(()=>b.colorsStops,()=>{M.mesh.material.uniforms.eTexture.value=b.updateTransferFunction(),A.mesh.material.uniforms.eTexture.value=b.updateTransferFunction()},{deep:!0,immediate:!0}),(e,t)=>(p(),h("TresGroup",{visible:z.value},[x("TresGroup",{scale:[1/c(S).xLength,1/c(S).xLength*c(S).xLength/c(S).yLength,1/c(S).xLength*c(S).xLength/c(S).zLength]},[x("primitive",{object:c(M).mesh,renderOrder:99993},null,8,w),x("primitive",{object:c(A).mesh,renderOrder:99992},null,8,f)],8,g)],8,u))}});export{T as _};
