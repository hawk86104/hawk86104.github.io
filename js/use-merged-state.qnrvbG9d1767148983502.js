import{importShared as q}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";function P(r){return r.composedPath()[0]}const A={mousemoveoutside:new WeakMap,clickoutside:new WeakMap};function B(r,i,s){if(r==="mousemoveoutside"){const c=u=>{i.contains(P(u))||s(u)};return{mousemove:c,touchstart:c}}else if(r==="clickoutside"){let c=!1;const u=w=>{c=!i.contains(P(w))},d=w=>{c&&(i.contains(P(w))||s(w))};return{mousedown:u,mouseup:d,touchstart:u,touchend:d}}return console.error(`[evtd/create-trap-handler]: name \`${r}\` is invalid. This could be a bug of evtd.`),{}}function x(r,i,s){const c=A[r];let u=c.get(i);u===void 0&&c.set(i,u=new WeakMap);let d=u.get(s);return d===void 0&&u.set(s,d=B(r,i,s)),d}function F(r,i,s,c){if(r==="mousemoveoutside"||r==="clickoutside"){const u=x(r,i,s);return Object.keys(u).forEach(d=>{K(d,document,u[d],c)}),!0}return!1}function G(r,i,s,c){if(r==="mousemoveoutside"||r==="clickoutside"){const u=x(r,i,s);return Object.keys(u).forEach(d=>{Q(d,document,u[d],c)}),!0}return!1}function J(){if(typeof window>"u")return{on:()=>{},off:()=>{}};const r=new WeakMap,i=new WeakMap;function s(){r.set(this,!0)}function c(){r.set(this,!0),i.set(this,!0)}function u(n,e,t){const o=n[e];return n[e]=function(){return t.apply(n,arguments),o.apply(n,arguments)},n}function d(n,e){n[e]=Event.prototype[e]}const w=new WeakMap,W=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function z(){var n;return(n=w.get(this))!==null&&n!==void 0?n:null}function M(n,e){W!==void 0&&Object.defineProperty(n,"currentTarget",{configurable:!0,enumerable:!0,get:e??W.get})}const T={bubble:{},capture:{}},v={};function I(){const n=function(e){const{type:t,eventPhase:o,bubbles:a}=e,p=P(e);if(o===2)return;const b=o===1?"capture":"bubble";let f=p;const l=[];for(;f===null&&(f=window),l.push(f),f!==window;)f=f.parentNode||null;const h=T.capture[t],H=T.bubble[t];if(u(e,"stopPropagation",s),u(e,"stopImmediatePropagation",c),M(e,z),b==="capture"){if(h===void 0)return;for(let g=l.length-1;g>=0&&!r.has(e);--g){const m=l[g],k=h.get(m);if(k!==void 0){w.set(e,m);for(const E of k){if(i.has(e))break;E(e)}}if(g===0&&!a&&H!==void 0){const E=H.get(m);if(E!==void 0)for(const $ of E){if(i.has(e))break;$(e)}}}}else if(b==="bubble"){if(H===void 0)return;for(let g=0;g<l.length&&!r.has(e);++g){const m=l[g],k=H.get(m);if(k!==void 0){w.set(e,m);for(const E of k){if(i.has(e))break;E(e)}}}}d(e,"stopPropagation"),d(e,"stopImmediatePropagation"),M(e)};return n.displayName="evtdUnifiedHandler",n}function S(){const n=function(e){const{type:t,eventPhase:o}=e;if(o!==2)return;const a=v[t];a!==void 0&&a.forEach(p=>p(e))};return n.displayName="evtdUnifiedWindowEventHandler",n}const O=I(),j=S();function D(n,e){const t=T[n];return t[e]===void 0&&(t[e]=new Map,window.addEventListener(e,O,n==="capture")),t[e]}function C(n){return v[n]===void 0&&(v[n]=new Set,window.addEventListener(n,j)),v[n]}function L(n,e){let t=n.get(e);return t===void 0&&n.set(e,t=new Set),t}function y(n,e,t,o){const a=T[e][t];if(a!==void 0){const p=a.get(n);if(p!==void 0&&p.has(o))return!0}return!1}function N(n,e){const t=v[n];return!!(t!==void 0&&t.has(e))}function _(n,e,t,o){let a;if(typeof o=="object"&&o.once===!0?a=h=>{U(n,e,a,o),t(h)}:a=t,F(n,e,a,o))return;const b=o===!0||typeof o=="object"&&o.capture===!0?"capture":"bubble",f=D(b,n),l=L(f,e);if(l.has(a)||l.add(a),e===window){const h=C(n);h.has(a)||h.add(a)}}function U(n,e,t,o){if(G(n,e,t,o))return;const p=o===!0||typeof o=="object"&&o.capture===!0,b=p?"capture":"bubble",f=D(b,n),l=L(f,e);if(e===window&&!y(e,p?"bubble":"capture",n,t)&&N(n,t)){const H=v[n];H.delete(t),H.size===0&&(window.removeEventListener(n,j),v[n]=void 0)}l.has(t)&&l.delete(t),l.size===0&&f.delete(e),f.size===0&&(window.removeEventListener(n,O,b==="capture"),T[b][n]=void 0)}return{on:_,off:U}}const{on:K,off:Q}=J(),{watch:V,computed:X}=await q("vue");function Z(r,i){return V(r,s=>{s!==void 0&&(i.value=s)}),X(()=>r.value===void 0?i.value:r.value)}export{Q as off,K as on,Z as useMergedState};
