import{u as e}from"./index.DfC8-s1F1763540743861.js";import{a}from"./util.BuhND_SZ1763540743861.js";import{_ as l}from"./@fesjs.BEMFm_yJ1763540743861.js";import{u as t,s,t as r,a as i,B as o,v as n,w as u,N as p,g as c,x as d,y as m}from"./naive-ui.qjPOP62h1763540743861.js";import{a8 as f,a as v,H as y,o as g,I as j,J as b,h,u as k,e as x,N as _,y as w,F as C,S as z}from"./@vue.Co_gxueH1763540743861.js";import"./pinia.CEQ6XgE61763540743861.js";import"./three.rXKzP9fQ1763540743861.js";import"./vue-router.BxG8XxK11763540743861.js";import"./lodash-es.B7GkVYRo1763540743861.js";import"./@vueuse.CfFJ-iFV1763540743861.js";import"./@qlin.y-0Z8WnK1763540743861.js";import"./@babel.BPq7uOAK1763540743861.js";import"./@floating-ui.Bhq4ibgf1763540743861.js";import"./@juggle.Vc7cP4_P1763540743861.js";import"./date-fns.eh-WGDI81763540743861.js";import"./@css-render.DtSd-BuN1763540743861.js";import"./css-render.Dlx27V_T1763540743861.js";import"./@emotion.DFFAhID71763540743861.js";import"./seemly.D2hUckm91763540743861.js";import"./vooks.CVMU_ROE1763540743861.js";import"./evtd.C4K_ichY1763540743861.js";import"./vueuc.CEvnhvIm1763540743861.js";import"./vdirs.DlTVi7SG1763540743861.js";import"./treemate.Qc8YxXqZ1763540743861.js";import"./date-fns-tz.CIz1xaH61763540743861.js";import"./async-validator.DJtlKCAR1763540743861.js";const B={key:0,class:"upload-mask"},L={class:"upload-mask-content"},R={class:"image-uploader-panel"},A={style:{"margin-bottom":"6px","padding-bottom":"6px","border-bottom":"2px solid #5f5f5f","word-break":"break-all"}},U={key:0},D={key:1},I={style:{"margin-top":"10px"}},M={key:2},O={style:{"margin-top":"10px"}},T={style:{"margin-left":"30px","margin-top":"10px"}},F=l({__name:"leftImg",async setup(l){let F,J;const N=e();N.curModelArrayBuffer=([F,J]=f(()=>a("./plugins/hunyuan3D/model/icegl-bm.glb")),F=await F,J(),F);const P=t(),S=v(null),H=v("https://cdn.index.icegl.cn/uploads/20221122/9ed6756107c4e0c031ae26d54cb46c0d.png"),q=v(!0),G=v(!1),K=s(),Y=v("http://localhost:8081/generate");function Z({file:e}){S.value=e.file,H.value=URL.createObjectURL(e.file)}async function E(){if(S.value){G.value=!0;try{const a={image:await(e=S.value,new Promise((a,l)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>{const e=t.result.split(",")[1];a(e)},t.onerror=l}))},l=await fetch(Y.value,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});N.curModelArrayBuffer=await l.arrayBuffer(),q.value=!0,P.success("传递接口成功，模型已生成")}catch(a){console.error(a),P.error("传递接口失败")}finally{G.value=!1}var e}}function Q(){if(!N.curModelArrayBuffer)return void P.error("没有可下载的模型");const e=new Blob([N.curModelArrayBuffer],{type:"model/gltf-binary"}),a=URL.createObjectURL(e);m(a,"generated-model.glb"),URL.revokeObjectURL(a)}function V(){S.value=null,H.value="",q.value=!1,N.curModelArrayBuffer=null}const W=()=>{const e=v(""),a=v(Y.value);K.create({title:"请输入混元3D服务地址:",content:()=>z("div",{},[z(c,{value:a.value,placeholder:"服务说明详见'说明'按钮",onInput:l=>{a.value=l,e.value=""}}),e.value&&z(d,{type:"error",style:"margin-top: 8px"},{default:()=>e.value})]),positiveText:"确认",negativeText:"取消",maskClosable:!1,onPositiveClick:()=>a.value.trim()?(Y.value=a.value.trim(),!0):(e.value="配置不能为空",!1)})},X=()=>{window.open("https://icegl.cn/ask/article/22765.html","_blank")};return(e,a)=>(g(),y(C,null,[G.value?(g(),y("div",B,[b("div",L,[h(k(r),{size:"large"}),a[0]||(a[0]=b("div",{class:"upload-text"},"模型生成中，请稍候...",-1))])])):j("",!0),b("div",R,[h(k(p),{title:"参考图片生产3D",size:"small",class:"panel-card","header-style":{textAlign:"center"},style:{backgroundColor:"#1a1a1a",color:"#ffffff",border:"1px solid #444"}},{default:x(()=>[b("div",A,[a[3]||(a[3]=b("span",null,"混元3D服务：",-1)),a[4]||(a[4]=b("br",null,null,-1)),b("span",null,_(Y.value?Y.value:"未配置"),1),h(k(i),{justify:"end"},{default:x(()=>[h(k(o),{type:"primary",size:"tiny",onClick:W},{default:x(()=>[...a[1]||(a[1]=[w(" 设置 ",-1)])]),_:1}),h(k(o),{type:"info",size:"tiny",style:{"margin-right":"6px"},onClick:X},{default:x(()=>[...a[2]||(a[2]=[w(" 说明 ",-1)])]),_:1})]),_:1})]),G.value||q.value?j("",!0):(g(),y("div",U,[h(k(n),{"default-upload":!1,"show-file-list":!1,accept:"image/*",onChange:Z},{default:x(()=>[h(k(o),{type:"primary",size:"small"},{default:x(()=>[...a[5]||(a[5]=[w("选择图片",-1)])]),_:1})]),_:1})])),S.value&&!q.value?(g(),y("div",D,[h(k(u),{src:H.value,width:"100",height:"100","object-fit":"cover",style:{"margin-top":"10px"}},null,8,["src"]),b("div",I,[h(k(o),{type:"success",size:"small",loading:G.value,onClick:E},{default:x(()=>[...a[6]||(a[6]=[w(" 提交 ",-1)])]),_:1},8,["loading"])])])):j("",!0),q.value?(g(),y("div",M,[a[9]||(a[9]=b("span",null,"参考图片：",-1)),a[10]||(a[10]=b("br",null,null,-1)),h(k(u),{src:H.value,width:"100",height:"100","object-fit":"cover",style:{"margin-top":"10px"}},null,8,["src"]),h(k(i),null,{default:x(()=>[b("div",O,[h(k(o),{type:"info",size:"small",onClick:V},{default:x(()=>[...a[7]||(a[7]=[w("重新生产",-1)])]),_:1})]),b("div",T,[h(k(o),{type:"success",size:"small",onClick:Q},{default:x(()=>[...a[8]||(a[8]=[w("下载模型",-1)])]),_:1})])]),_:1})])):j("",!0)]),_:1})])],64))}},[["__scopeId","data-v-75b74eb7"]]);export{F as default};
