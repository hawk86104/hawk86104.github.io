import{a0 as t,_ as n,C as o,ce as e,cf as r,cg as i,ch as u,m as c,bU as s,ak as a,am as l}from"./three.3RwiW87x1731987698599.js";import{d as f,e as p,U as d}from"./@tresjs.juy9qkLz1731987698599.js";import{z as h}from"./three-custom-shader-material.0aidFALX1731987698599.js";import{d as m,b as y,a3 as g,w,o as v,D as _,u as b,r as C,a6 as I,e as x,f as M,g as O,J as T,j as S,aj as B,ak as R,F as A,I as j,G as P,m as E}from"./@vue.-THQH3GC1731987698599.js";function G(){const t=["console","error","27RoVVai","function *\\( *\\)","1819092rFNAPQ","prototype","apply","name","test","2501688BiEiNW","toString","13093WbhpqB","CITY_UNTRIANGULATED","call","3046337uvIDvq","trace","ROADS","23812430lOZmSD","action","debu","gger","chain","178nRItmh",'{}.constructor("return this")( )',"6lECSde","init","6199685nxPcAg","return (function() ","input","table","counter","length","constructor","stateObject","log","118716RzNRPd","while (true) {}","traverse","bind"];return(G=function(){return t})()}!function(t,n){const o=W,e=G();for(;;)try{if(855008===parseInt(o(306))/1*(-parseInt(o(317))/2)+-parseInt(o(330))/3+-parseInt(o(299))/4+-parseInt(o(321))/5+-parseInt(o(319))/6*(-parseInt(o(309))/7)+parseInt(o(304))/8*(parseInt(o(297))/9)+parseInt(o(312))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(301)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=W,n=new RegExp(t(298)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=H(t(320));n[t(303)](e+t(316))&&o.test(e+t(323))?H():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(301)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function W(t,n){const o=G();return(W=function(t,n){return o[t-=295]})(t,n)}D(void 0,(function(){const t=W;let n;try{n=Function(t(322)+t(318)+");")()}catch(r){n=window}const o=n[t(295)]=n.console||{},e=[t(329),"warn","info",t(296),"exception",t(324),t(310)];for(let i=0;i<e[t(326)];i++){const n=D.constructor[t(300)][t(333)](D),r=e[i],u=o[r]||n;n.__proto__=D.bind(D),n[t(305)]=u[t(305)].bind(u),o[r]=n}}))();const z=async()=>{const t=W,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(332)]((n=>{const i=t;n[i(302)]===i(307)&&(o=n),"LANDMASS"===n.name&&(e=n),n[i(302)]===i(311)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function H(t){function n(t){const o=W;if("string"==typeof t)return function(t){}[o(327)](o(331))[o(301)](o(325));1!==(""+t/t)[o(326)]||t%20==0?function(){return!0}.constructor(o(314)+o(315))[o(308)](o(313)):function(){return!1}[o(327)]("debu"+o(315))[o(301)](o(328)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=F;function k(){const t=["2664380SPPyEk","buildingsModelCustomShader","bulidingsColor","constructor","bind","object","opacity","boundingBox","4097082HurftN","14625CvaCuh","3464OgqYAZ","Color","color","prototype","console","return (function() ","city","test","uOpacity","length","exception","7rGftOY","#112233","1067076ZgtZYc","isArray","chain","landColor","action","3009910catlpO","__proto__","toString","primitive","computeBoundingBox","table","uGradient","debu","forEach","#ffffff","setStyle","clone","init","land",'{}.constructor("return this")( )',"stateObject","uColor","counter","apply","uniforms","1463174RuHnWq","gradient","__csm","material","830951xXHevf","value","side","model","topColor","warn","input","renderOrder"];return(k=function(){return t})()}function F(t,n){const o=k();return(F=function(t,n){return o[t-=146]})(t,n)}!function(t,n){const o=F,e=k();for(;;)try{if(736319===-parseInt(o(154))/1+-parseInt(o(150))/2+-parseInt(o(185))/3+parseInt(o(162))/4+parseInt(o(190))/5+parseInt(o(170))/6*(parseInt(o(183))/7)+parseInt(o(172))/8*(parseInt(o(171))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const N=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(148)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){N(this,(function(){const t=F,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=V(t(202));n[t(179)](e+t(187))&&o.test(e+t(160))?V():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();$(void 0,(function(){const t=F;let n;try{n=Function(t(177)+t(204)+");")()}catch(r){n=window}const o=n[t(176)]=n[t(176)]||{},e=["log",t(159),"info","error",t(182),t(195),"trace"];for(let i=0;i<e[t(181)];i++){const n=$.constructor[t(175)][t(166)]($),r=e[i],u=o[r]||n;n[t(191)]=$[t(166)]($),n.toString=u[t(192)][t(166)](u),o[r]=n}}))();const q=[L(167)],U=m({__name:L(163),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:L(184)},topColor:{default:"#ffff00"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=L,i=e,u=y(0),c=i[r(157)][r(178)];c[r(161)]=1001;const s=i.model.land;(()=>{const e=r,{geometry:s}=c;s[e(194)](),s.computeBoundingSphere();const{max:a,min:l}=s[e(169)];if(c.material[e(152)])return;const f=new h({baseMaterial:c[e(153)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:a},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(n[e(173)])(i.bulidingsColor)},uOpacity:{value:i[e(168)]},uLightColor:{value:new(n[e(173)])(e(199))},uTopColor:{value:new o(i[e(158)])},uTime:u,uGradient:{value:i[e(151)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t});c[e(153)].dispose(),c[e(153)]=f})();const{onLoop:a}=p();a((({delta:t})=>{u[r(155)]+=t})),g((()=>{const n=r;i[n(164)]&&c[n(153)].uniforms[n(146)][n(155)].setStyle(i.bulidingsColor),i[n(188)]&&((n,o)=>{const e=r;let u;"cu"===n||"land"===n&&(u=Array[e(186)](s[e(153)])?s[e(153)]:[s[e(153)]],u[e(198)]((n=>{const r=e;n[o][r(200)](i.landColor),n[r(156)]=t})))})(n(203),n(174)),i[n(168)]&&(c[n(153)][n(149)][n(180)][n(155)]=i[n(168)])})),w(i,((t,n)=>{const o=r;c[o(153)][o(149)][o(196)][o(155)]=t[o(151)]}));const l=i[r(157)][r(157)][r(201)]();return(t,n)=>{const o=r;return v(),_(o(193),{object:b(l)},null,8,q)}}});function V(t){function n(t){const o=F;if("string"==typeof t)return function(t){}.constructor("while (true) {}")[o(148)](o(147));1!==(""+t/t)[o(181)]||t%20==0?function(){return!0}[o(165)](o(197)+"gger").call(o(189)):function(){return!1}[o(165)](o(197)+"gger").apply(o(205)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const K=nt;function X(){const t=["#FFF","length","48CFiGPW","warn","7IqltXl","10373040gxGoOa","input","152367ZMMEKK","315BlTwlq","linewidth","apply","width","function *\\( *\\)","140380pPlBwL","material","matrix","uniforms","error","2650528YsobWa","init","1015302BVNgua","trace","console","stateObject","bind","clone","opacity","builds","info","Shader","color","toString","test","1801955PBVHmf","resolution","style",'{}.constructor("return this")( )',"chain","__proto__"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","applyMatrix4","debu","1275438nvIcBW","renderOrder","call","action","geometry","constructor","string","buildingsLines","gger","set","table","primitive","value","Wireframe"];return(X=function(){return t})()}!function(t,n){const o=nt,e=X();for(;;)try{if(687094===-parseInt(o(414))/1+parseInt(o(412))/2+-parseInt(o(457))/3*(-parseInt(o(452))/4)+parseInt(o(427))/5+parseInt(o(436))/6*(parseInt(o(454))/7)+-parseInt(o(455))/8+-parseInt(o(458))/9*(-parseInt(o(463))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Y=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[nt(460)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Y(this,(function(){const t=nt,n=new RegExp(t(462)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=ot(t(413));n[t(426)](e+t(431))&&o[t(426)](e+t(456))?ot():e("0")}))()}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[nt(460)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Q(void 0,(function(){const t=nt;let n;try{n=Function("return (function() "+t(430)+");")()}catch(r){n=window}const o=n[t(416)]=n[t(416)]||{},e=["log",t(453),t(422),t(411),"exception",t(446),t(415)];for(let i=0;i<e[t(451)];i++){const n=Q[t(441)].prototype[t(418)](Q),r=e[i],u=o[r]||n;n[t(432)]=Q[t(418)](Q),n[t(425)]=u[t(425)][t(418)](u),o[r]=n}}))();const J=["object"],tt=m({__name:K(443),props:{builds:{},width:{default:1},color:{default:K(450)},opacity:{default:1},style:{default:K(449)}},setup(t){const n=K,s=t;let a=null,l=null;if("Wireframe"===s[n(429)]){const t=new e(s[n(421)][n(440)]);let o=(new r).fromEdgesGeometry(t),c=new i({color:s[n(424)],linewidth:s.width,opacity:s[n(420)],transparent:!0,depthWrite:!0,depthTest:!0});c[n(428)][n(445)](window.innerWidth,window.innerHeight),a=new u(o,c),a[n(434)](s[n(421)][n(409)][n(419)]())}else{l={transparent:!0,uniforms:{uColor:{value:new o(s.color)},uOpacity:{value:s[n(420)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:n(433)};const t=new e(s[n(421)][n(440)]),r=new c(l);a=new LineSegments(t,r),a.applyMatrix4(s[n(421)].matrix[n(419)]()),a[n(408)][n(459)]=s[n(461)],a[n(437)]=1e3}return g((()=>{const t=n;s[t(429)]===t(423)&&(s[t(424)]&&(l[t(410)].uColor[t(448)]=new o(s[t(424)])),s.opacity&&(l.uniforms.uOpacity[t(448)]=s[t(420)])),s[t(429)]===t(449)&&(s[t(424)]&&(a[t(408)][t(424)]=new o(s[t(424)])),s[t(420)]&&(a[t(408)][t(420)]=s[t(420)])),s[t(461)]&&(a[t(408)][t(459)]=s.width)})),(t,o)=>{const e=n;return v(),_(e(447),{object:b(a)},null,8,J)}}});function nt(t,n){const o=X();return(nt=function(t,n){return o[t-=408]})(t,n)}function ot(t){function n(t){const o=nt;if(typeof t===o(442))return function(t){}[o(441)]("while (true) {}")[o(460)]("counter");1!==(""+t/t)[o(451)]||t%20==0?function(){return!0}.constructor(o(435)+o(444))[o(438)](o(439)):function(){return!1}.constructor(o(435)+o(444))[o(460)](o(417)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=at;function rt(){const t=["ability","init","city","debu","action","TresPerspectiveCamera","apply","builds","trace","test","#000","disableRender","warn","7580GiZTOI","length","pagesShow","2963436XqKfAn","table","showBuildings","bind","2389486lJoyiD","counter","log","29733zozysi","10UaxQKC","TresGridHelper","788676sKSchQ","toString","TresDirectionalLight","showAxesHelper","autoRotate",'{}.constructor("return this")( )',"__proto__","while (true) {}","18awjmRp","107165UuZcMb","#ffffff","prototype","100sDTXCx","59bnaoeG","gger","30eiOnuc","console","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","string","error","perspectiveCameraRef","821432INBSVi","info","return (function() ","constructor","TresCanvas","call","showGridHelper","stateObject"];return(rt=function(){return t})()}!function(t,n){const o=at,e=rt();for(;;)try{if(156969===parseInt(o(477))/1*(parseInt(o(451))/2)+-parseInt(o(461))/3*(parseInt(o(476))/4)+-parseInt(o(473))/5*(parseInt(o(479))/6)+parseInt(o(464))/7+parseInt(o(430))/8*(parseInt(o(472))/9)+-parseInt(o(462))/10*(-parseInt(o(458))/11)+-parseInt(o(454))/12)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(444)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){it(this,(function(){const t=at,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(481),"i"),e=ft(t(439));n[t(447)](e+"chain")&&o[t(447)](e+"input")?ft():e("0")}))()}();const ut=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(444)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();ut(void 0,(function(){const t=at;let n;try{n=Function(t(432)+t(469)+");")()}catch(r){n=window}const o=n[t(480)]=n[t(480)]||{},e=[t(460),t(450),t(431),t(428),"exception",t(455),t(446)];for(let i=0;i<e.length;i++){const n=ut.constructor[t(475)].bind(ut),r=e[i],u=o[r]||n;n[t(470)]=ut[t(457)](ut),n[t(465)]=u[t(465)][t(457)](u),o[r]=n}}))();const ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(t,n){const o=rt();return(at=function(t,n){return o[t-=428]})(t,n)}const lt=m({__name:et(453),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=C({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:l,disableRender:r[n(449)]}),u=C({autoRotate:r[n(468)],enableDamping:!0});let c=null;r[n(456)]&&([o,e]=I((()=>z())),o=await o,e(),c=o);const f=y(),p=y();return(t,o)=>{const e=n,s=x(e(434));return v(),M(s,E({ref_key:"tcRef",ref:p},i,{"window-size":""}),{default:O((()=>[T(e(443),{ref_key:e(429),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),S(b(d),B(R(u)),null,16),o[0]||(o[0]=T("TresAmbientLight",{color:"#ffffff"},null,-1)),o[1]||(o[1]=T(e(466),{position:[100,100,0],intensity:.5,color:e(474)},null,-1)),r[e(456)]&&b(c)?(v(),_(A,{key:0},[S(U,{model:b(c)},null,8,["model"]),S(tt,{builds:b(c)[e(440)],color:e(448)},null,8,[e(445)])],64)):j("",!0),P(t.$slots,e(438)),r[e(467)]?(v(),_("TresAxesHelper",ct)):j("",!0),r[e(436)]?(v(),_(e(463),st)):j("",!0)])),_:3},16)}}});function ft(t){function n(t){const o=at;if(typeof t===o(482))return function(t){}[o(433)](o(471))[o(444)](o(459));1!==(""+t/t)[o(452)]||t%20==0?function(){return!0}[o(433)]("debu"+o(478))[o(435)](o(442)):function(){return!1}[o(433)](o(441)+o(478))[o(444)](o(437)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as _,tt as a,lt as b,z as l};
