import{P as e}from"./tweakpane.C0HtAJSg1758524188831.js";import{m as a,A as s,e as o,k as t,a as r}from"./@tresjs.BL1sBIDK1758524188831.js";import"./OimoPhysicsBuffer.CcBMdMc41758524188831.js";import{_ as n}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.0p0XW2Cf1758524188831.js";import"./vanilla.esm.5.5.0.UWCjMdOF1758524188831.js";import"./PackedMipMapGenerator.7JJE-1Hp1758524188831.js";import"./Resource.DxdCIUkg1758524188831.js";import{l as i,C as l,ct as c,cr as m,cs as p,a as u,cJ as d,c_ as v,c$ as f}from"./three.CC50Wz7a1758524188831.js";import{d as j,aa as h,s as g,w,G as b,o as _,I as y,u as P,F as D,r as M,h as x,e as U,f as k,j as C,a5 as F,a7 as S,a8 as z}from"./@vue.pEDXJ_3Z1758524188831.js";import"./postprocessing.DYlQqnRh1758524188831.js";import"./@vueuse.C-O_6is-1758524188831.js";import"./oimophysics.BBtHVm4j1758524188831.js";import"./dither.glsl.tNAdkJUa1758524188831.js";import"./Reflector.hbefUijb1758524188831.js";import"./vite-plugin-qiankun.B06WoCqG1758524188831.js";import"./object-hash.COWhg4aZ1758524188831.js";import"./@amap.CGUF9xH41758524188831.js";import"./jszip.BzP0QdiD1758524188831.js";import"./three-stdlib.CYvtwvCB1758524188831.js";const B=["object"],G=["object"],J=["object"],L=j({__name:"mechaFloor",props:{color:{default:"#ffed00"}},async setup(e){let r,n;const{renderer:j,scene:M,camera:x,sizes:U}=a(),k=e;let C=null;const F={uniforms:{tDiffuse:{value:null},contrast:{value:1.8}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",fragmentShader:"\n        uniform sampler2D tDiffuse;\n        uniform float contrast;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb = (color.rgb - 0.5) * contrast + 0.8;\n            gl_FragColor = color;\n        }\n    "},{scene:S}=([r,n]=h((()=>t("https://opensource.cdn.icegl.cn/model/floor/baseModelJ.glb",{draco:!0,decoderPath:"./draco/"}))),r=await r,n(),r),{scene:z}=([r,n]=h((()=>t("plugins/floor/models/topoBase/baseModelL.glb",{draco:!0,decoderPath:"./draco/"}))),r=await r,n(),r),{scene:L,animations:T}=([r,n]=h((()=>t("https://opensource.cdn.icegl.cn/model/floor/baseModelK.glb",{draco:!0,decoderPath:"./draco/"}))),r=await r,n(),r),{actions:I}=s(T,L);I.Scene.play(),S.traverse((e=>{e instanceof i&&(e.material.emissive=new l("#ffed00"),e.material.emissiveIntensity=20.5,e.material.toneMapped=!0,e.material.needsUpdate=!0)}));const{onLoop:R}=o();return R((()=>{C&&C.render()})),g((()=>{(()=>{const e=new v(j.value),a=new f,s=e.fromScene(a).texture;M.value.environment=s,S.traverse((e=>{e instanceof i&&e.material&&(e.material.envMap=s,e.material.needsUpdate=!0)})),a.dispose()})(),setTimeout((()=>{(()=>{if(!j.value||!x.value||!U.width.value)return;C=new c(j.value);const e=new m(M.value,x.value);C.addPass(e);const a=new p(new u(U.width.value,U.height.value),.1,.1,.1);C.addPass(a);const s=new d(F);s.uniforms.contrast.value=1.1,C.addPass(s)})()}),200)})),w((()=>[k.color]),(([e])=>{S.traverse((a=>{a instanceof i&&a.material&&(a.material.emissive=new l(e))}))})),(e,a)=>(_(),b(D,null,[y("primitive",{object:P(S),"position-y":.01},null,8,B),y("primitive",{object:P(z),"position-y":.1},null,8,G),y("primitive",{object:P(L),"position-y":.1},null,8,J)],64))}}),T=j({__name:"mechaFloor",setup(a){const s=M({color:"#ffed00"}),o=new e({expanded:!0}),t={reflectivity:1,showGridHelper:!1,scale:2};return o.addBinding(s,"color",{label:"颜色"}),(e,a)=>{const o=x("TresCanvas");return _(),U(o,{clearColor:"#000000","window-size":""},{default:k((()=>[a[0]||(a[0]=y("TresPerspectiveCamera",{position:[3,5,0],fov:45,near:.1,far:1e4},null,-1)),C(P(r),{enableDamping:""}),(_(),U(F,null,{default:k((()=>[C(P(L),S(z(s)),null,16)])),_:1})),(_(),U(F,null,{default:k((()=>[C(n,S(z(t)),null,16)])),_:1}))])),_:1})}}});export{T as default};
