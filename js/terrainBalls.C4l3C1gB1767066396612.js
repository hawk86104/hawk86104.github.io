import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{_ as a,a as t,K as r}from"./@tresjs.B1f7s3pS1767066396612.js";import{c as o}from"./simplex-noise.DjdePFRN1767066396612.js";import{W as n,S as s,B as l,H as i,V as p}from"./cannon-es.D0mCsqyd1767066396612.js";const{defineComponent:u}=await e("vue"),m=u({__name:"terrainBallsCannon",props:{sphereGroup:{default:null},plane:{default:null}},setup(e){const t=e,r=new n;r.gravity.set(0,-9.82,0);const o=[];t.sphereGroup.children.forEach(e=>{const a=e.geometry.parameters.radius,t=new s(a),n=new l({mass:1});n.addShape(t),n.position.copy(e.position),o.push(n),r.addBody(n)});let u=[];const m=t.plane.geometry.getAttribute("position"),c=t.plane.geometry.parameters.widthSegments+1,d=t.plane.geometry.parameters.heightSegments+1;for(let a=0;a<d;a++)u.push([]);for(let a=0;a<c;a++)for(let e=0;e<d;e++)u[e][a]=m.getZ((c-1-a)*d+e);const h=new i(u,{elementSize:t.plane.geometry.parameters.width/(c-1)}),f=new l({mass:0});f.addShape(h,new p(-t.plane.geometry.parameters.width/2,-t.plane.geometry.parameters.height/2,0)),f.quaternion.set(...t.plane.quaternion.toArray()),r.addBody(f);const{onRender:w}=a();return w(({delta:e})=>{r.fixedStep(1/120,e),o.forEach((e,a)=>{t.sphereGroup.children[a].position.copy(e.position)})}),(e,a)=>null}}),{defineComponent:c}=await e("vue"),{renderList:d,Fragment:h,openBlock:f,createElementBlock:w,createElementVNode:g,unref:y,createBlock:v,createCommentVNode:S}=await e("vue"),B=["position"],T=["geometry","rotation-x"],k=["side"],{ref:M}=await e("vue"),_=await e("three"),C=c({__name:"terrainBallsThree",setup(e){const a=M(),t=M(),r=o(),n=(e,a)=>1.2*(3.2*r(.1*e,.1*a)+.2*r(.3*e,.3*a)),s=new _.PlaneGeometry(100,100,49,49),l=s.getAttribute("position");for(var i=0;i<l.count;i++)l.setZ(i,n(l.getX(i),l.getY(i)));return s.computeBoundingSphere(),s.computeVertexNormals(),console.log(s),(e,r)=>(f(),w(h,null,[g("TresGroup",{ref_key:"sphereGroupRef",ref:a},[(f(),w(h,null,d(10,e=>(f(),w(h,{key:e},[(f(),w(h,null,d(10,a=>g("TresMesh",{key:a,position:[10*e-55,26,10*a-55],"cast-shadow":""},[...r[0]||(r[0]=[g("TresSphereGeometry",{args:[.6,16,16]},null,-1),g("TresMeshStandardMaterial",{color:"#ffffff"},null,-1)])],8,B)),64))],64))),64))],512),g("TresMesh",{ref_key:"planeRef",ref:t,geometry:y(s),"rotation-x":-Math.PI/2,"receive-shadow":""},[g("TresMeshPhysicalMaterial",{roughness:1,metalness:0,color:"gray",side:_.DoubleSide},null,8,k)],8,T),t.value?(f(),v(m,{key:0,sphereGroup:a.value,plane:t.value},null,8,["sphereGroup","plane"])):S("",!0)],64))}}),{defineComponent:G}=await e("vue"),{createElementVNode:b,unref:x,normalizeProps:P,guardReactiveProps:R,createVNode:A,mergeProps:E,withCtx:N,openBlock:V,createBlock:j}=await e("vue"),{SRGBColorSpace:D,BasicShadowMap:L,NoToneMapping:z}=await e("three"),{reactive:Z,shallowRef:q,watchEffect:F}=await e("vue"),H=G({__name:"terrainBalls",setup(e){const a=Z({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:L,outputColorSpace:D,toneMapping:z}),o=Z({enableDamping:!0,dampingFactor:.05,enableZoom:!0,autoRotate:!1}),n=q();return F(()=>{n.value&&(n.value.shadow.mapSize.set(1e3,1e3),n.value.shadow.camera.near=.5,n.value.shadow.camera.far=5e4,n.value.shadow.camera.top=20,n.value.shadow.camera.right=20,n.value.shadow.camera.left=-20,n.value.shadow.camera.bottom=-20)}),(e,s)=>(V(),j(x(t),E(a,{"window-size":""}),{default:N(()=>[s[0]||(s[0]=b("TresPerspectiveCamera",{position:[110,70,20],fov:45,near:.1,far:1e3},null,-1)),A(x(r),P(R(o)),null,16),s[1]||(s[1]=b("TresAmbientLight",{intensity:2},null,-1)),b("TresDirectionalLight",{ref_key:"TDirectionalLight",ref:n,position:[10,8,4],intensity:2,"cast-shadow":""},null,512),s[2]||(s[2]=b("TresDirectionalLight",{position:[10,2,4],intensity:2,"cast-shadow":""},null,-1)),A(C)]),_:1},16))}});export{H as default};
