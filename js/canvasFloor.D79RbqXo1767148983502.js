import{importShared as l}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{Pane as P}from"./tweakpane.BQRZXf8M1767148983502.js";import{_l as b,Kk as M}from"./index.DTe2qqjO1767148983502.js";function h(e,t){return Math.random()*(t-e)+e}function v(e,t){return Math.floor(e+Math.random()*(t-e+1))}let d=0,c=0,i=null;const g=30;let f=0;const r=[];let y=10;class k{constructor(){this.path=[],this.rspeed=h(1,2),this.count=v(10,30),this.x=d/2+1,this.y=c/2+1,this.target={x:d/2,y:c/2},this.dist=0,this.angle=0,this.hue=f/5,this.life=1,this.updateAngle(),this.updateDist()}step(t){this.speed=this.rspeed*y,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.updateDist(),this.dist<this.speed&&(this.x=this.target.x,this.y=this.target.y,this.changeTarget()),this.path.push({x:this.x,y:this.y}),this.path.length>this.count&&this.path.shift(),this.life-=.001,this.life<=0&&(this.path=null,r.splice(t,1))}updateDist(){const t=this.target.x-this.x,n=this.target.y-this.y;this.dist=Math.sqrt(t*t+n*n)}updateAngle(){const t=this.target.x-this.x,n=this.target.y-this.y;this.angle=Math.atan2(n,t)}changeTarget(){switch(v(0,3)){case 0:this.target.y=this.y-g;break;case 1:this.target.x=this.x+g;break;case 2:this.target.y=this.y+g;break;case 3:this.target.x=this.x-g;break}this.updateAngle()}draw(){i.beginPath();const t=h(0,10);for(let a=0,s=this.path.length;a<s;a++)i[a===0?"moveTo":"lineTo"](this.path[a].x+h(-t,t),this.path[a].y+h(-t,t));let n=this.hue;n=30,i.strokeStyle=`hsla(${h(n-30,n)}, 0%, 80%, ${this.life/3})`,i.lineWidth=h(.1,2),i.stroke()}}const B=(e,t,n,a)=>{d=e,c=t,i=n,f=0,y=a;for(let s=0;s<10;s++)r.push(new k)},R=e=>{y=e};function S(){f%10===0&&r.push(new k)}function $(){let e=r.length;for(;e--;)r[e].step(e)}function E(){i.globalCompositeOperation="destination-out",i.fillStyle="hsla(0, 0%, 10%, 0.1)",i.fillRect(0,0,d,c),i.globalCompositeOperation="lighter"}function N(){i.save(),i.translate(d/2,c/2),i.translate(-d/2,-c/2);let e=r.length;for(;e--;)r[e].draw(e);i.restore()}const z=()=>{S(),$(),E(),N(),f++},{defineComponent:V}=await l("vue"),{createElementVNode:w,normalizeProps:A,guardReactiveProps:D,openBlock:L,createElementBlock:G}=await l("vue"),H=["rotation-x"],W=["args"],p=await l("three"),{watch:x,reactive:I,createVNode:O,render:j}=await l("vue"),_=1024,T=768,q=V({__name:"lightningPattern",props:{size:{default:[10,10]},color:{default:"#fff"},opacity:{default:.95},textureRepeat:{default:[1,1]},speed:{default:10}},setup(e){const t=e,n=O("canvas",{width:_,height:T,style:{backgroundColor:"green"}});j(n,document.createElement("div")),B(_,T,n.el.getContext("2d"),t.speed);const a=new p.CanvasTexture(n.el);a.wrapS=p.RepeatWrapping,a.wrapT=p.RepeatWrapping,a.repeat.set(t.textureRepeat[0],t.textureRepeat[1]);const s=I({color:t.color,map:a,side:p.DoubleSide,transparent:!0,opacity:t.opacity,blending:p.AdditiveBlending,flatShading:!0,depthTest:!0});x(()=>t.color,u=>{s.color=new p.Color(u)}),x(()=>t.opacity,u=>{s.opacity=u}),x(()=>t.speed,u=>{R(t.speed)});const{onBeforeRender:m}=b();return m(()=>{z(),a.needsUpdate=!0}),(u,et)=>(L(),G("TresMesh",{"rotation-x":-Math.PI/2},[w("TresPlaneGeometry",{args:t.size},null,8,W),w("TresMeshStandardMaterial",A(D(s)),null,16)],8,H))}}),{defineComponent:F}=await l("vue"),{createElementVNode:o,unref:K,createVNode:C,normalizeProps:U,guardReactiveProps:J,resolveComponent:Q,withCtx:X,openBlock:Y,createBlock:Z}=await l("vue"),{reactive:tt}=await l("vue"),it=F({__name:"canvasFloor",setup(e){const t=tt({color:"#1a79fe",opacity:.95,speed:10}),n=new P({title:"canvas地面",expanded:!0});return n.addBinding(t,"color",{label:"颜色"}),n.addBinding(t,"opacity",{label:"透明度",min:0,max:1,step:.01}),n.addBinding(t,"speed",{label:"速度",min:0,max:20,step:1}),(a,s)=>{const m=Q("TresCanvas");return Y(),Z(m,{clearColor:"#000000","window-size":""},{default:X(()=>[s[0]||(s[0]=o("TresPerspectiveCamera",{position:[15,20,0],fov:45,near:.1,far:1e4},null,-1)),C(K(M),{enableDamping:"","auto-rotate":""}),s[1]||(s[1]=o("TresAmbientLight",{intensity:6},null,-1)),s[2]||(s[2]=o("TresDirectionalLight",{position:[0,8,0],intensity:1,color:"#fff"},null,-1)),s[3]||(s[3]=o("TresMesh",{position:[0,1,0]},[o("TresBoxGeometry",{args:[1,1,1]}),o("TresMeshNormalMaterial")],-1)),C(q,U(J(t)),null,16),s[4]||(s[4]=o("TresAxesHelper",{args:[10],position:[0,0,0]},null,-1)),s[5]||(s[5]=o("TresGridHelper",{args:[10,10],position:[0,0,0]},null,-1))]),_:1})}}});export{it as default};
