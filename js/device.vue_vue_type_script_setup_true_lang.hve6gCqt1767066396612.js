import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as t,_ as r}from"./@tresjs.B1f7s3pS1767066396612.js";import{m as a,f as s,U as n,E as o,a5 as i,O as l}from"./three.BD1hRFgo1767066396612.js";import"./customShaderMaterial.vue_vue_type_script_setup_true_lang.DS9PWjZT1767066396612.js";import"./index.vue_vue_type_script_setup_true_lang.iYOGhvYh1767066396612.js";import{u as d}from"./index.Y8o_qofm1767066396612.js";const u=await e("three");let c=new u.Color("#0fb1fb");const m=new u.MeshBasicMaterial({color:c,transparent:!0,opacity:.3}),h=new u.LineBasicMaterial({color:new u.Color(c),depthTest:!0,transparent:!0}),v=0,p=.972,f=.21,{withAsyncContext:w,defineComponent:_}=await e("vue"),{unref:b,openBlock:g,createElementBlock:x}=await e("vue"),y=["object"],{MeshBasicMaterial:M,Color:S}=await e("three"),{watchEffect:P,toRaw:j}=await e("vue"),C=_({__name:"device",props:{threshold:{default:0},strength:{default:.972},radius:{default:.21}},async setup(e){let c,_;const C=e,{nodes:T}=([c,_]=w(()=>d("https://opensource.cdn.icegl.cn/model/industry4/modelDraco.glb")),c=await c,_(),c),B=(e=>{const t=[];e.traverse(e=>{e.isMesh&&(t.push(e.geometry),e.material=m)});const r=a(t),s=new u.EdgesGeometry(r,6.137*Math.PI),n=new u.LineSegments(s);return h.opacity=1,n.material=h,n})(T.Sketchfab_model),{camera:k,renderer:R,scene:U,sizes:D}=t();let E=null,L=null,F=null;const G=new M({color:"black"});P(()=>{if(k.value){R.setPixelRatio(window.devicePixelRatio),U.value.add(B);const{finalComposer:e,effectComposer:t,bloomPass:r}=((e,t,r,a,d)=>{const c=new s(e,t),m=new n(new u.Vector2(a,d),p,f,v),h=new o(r);h.renderToScreen=!1,h.addPass(c),h.addPass(m);const w=new i(new u.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:h.renderTarget2.texture}},vertexShader:"varying vec2 vUv;\nvoid main(){\n\tvUv=uv;\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}",fragmentShader:"uniform sampler2D baseTexture;\nuniform sampler2D bloomTexture;\nvarying vec2 vUv;\nvoid main(){\n\tgl_FragColor=(texture2D(baseTexture,vUv)+vec4(1.)*texture2D(bloomTexture,vUv));\n}",defines:{}}),"baseTexture");w.needsSwap=!0;const _=new l,b=new o(r);return b.addPass(c),b.addPass(w),b.addPass(_),{finalComposer:b,effectComposer:h,renderScene:c,bloomPass:m}})(U.value,k.value,R,D.width.value,D.height.value);E=e,L=t,F=r,F.threshold=C.threshold,F.strength=C.strength,F.radius=C.radius}C.threshold&&(F.threshold=C.threshold),C.strength&&(F.strength=C.strength),C.radius&&(F.radius=C.radius)});const N={},{onBeforeRender:O}=r();let V=T.Sketchfab_model.getObjectByName("canister_turbine_011_Nickel-Light-PBR_0"),z=V.material.clone(),A=new M({color:new S("red"),transparent:!0,opacity:1});return O(({elapsed:e})=>{T.hull_turbine&&(T.hull_turbine.rotation.x+=.03,T.blades_turbine_003.rotation.x+=.03),Math.floor(e)%2?V.material=z:V.material=A},-1),O(({elapsed:e})=>{L&&(U.value.traverse(e=>{var t;((t=e).isMesh||"GridHelper"===t.type||"reflectorShaderMesh"===t.name)&&(N[t.uuid]=t.material,t.material=G)}),L.render(e)),E&&(U.value.traverse(e=>{var t;N[(t=e).uuid]&&(t.material=N[t.uuid],delete N[t.uuid])}),E.render(e))},1),(e,t)=>(g(),x("primitive",{object:j(b(T).Sketchfab_model)},null,8,y))}});export{C as _};
