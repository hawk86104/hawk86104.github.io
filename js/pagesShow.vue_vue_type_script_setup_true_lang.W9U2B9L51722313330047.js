import{a6 as t,C as n,ca as o,cb as e,cc as r,cd as i,k as u,bS as c,ab as s,ad as a}from"./three.0L1oP_mX1722313330047.js";import{f as l,$ as f,d as p}from"./@tresjs.Q03Md-En1722313330047.js";import{C as d}from"./three-custom-shader-material.rXUjQmJB1722313330047.js";import"./object-hash.aoN2vIR61722313330047.js";import"./@amap.cDim55ZW1722313330047.js";import"./glsl-tokenizer.pGV5rb2g1722313330047.js";import{d as h,b as m,a1 as y,w as g,o as w,D as v,u as b,r as _,a4 as I,e as C,f as x,g as M,J as T,j,aj as S,ak as O,F as R,I as A,G as D,m as L}from"./@vue.Q1VpS3901722313330047.js";!function(t,n){const o=F,e=B();for(;;)try{if(334588===-parseInt(o(202))/1*(parseInt(o(194))/2)+-parseInt(o(196))/3*(parseInt(o(188))/4)+-parseInt(o(213))/5+parseInt(o(199))/6+parseInt(o(215))/7+-parseInt(o(216))/8*(-parseInt(o(212))/9)+parseInt(o(214))/10*(parseInt(o(206))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[F(200)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){G(this,(function(){const t=F,n=new RegExp(t(197)),o=new RegExp(t(217),"i"),e=E(t(195));n[t(218)](e+t(222))&&o.test(e+"input")?E():e("0")}))()}();const k=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function B(){const t=["console","error",'{}.constructor("return this")( )',"prototype","trace","ROADS","gger","32GKdcZQ","name","action","table","constructor","counter","47254jpMGPl","init","229443qiDoZN","function *\\( *\\)","log","871692IOuTQh","apply","bind","17bfhTAj","length","return (function() ","exception","17369ybmlev","toString","CITY_UNTRIANGULATED","while (true) {}","debu","LANDMASS","324OHqLjm","3129980hrQkRu","8090Fcatog","2117206enNoem","55320LcxWxd","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","test","__proto__","warn","call","chain"];return(B=function(){return t})()}function F(t,n){const o=B();return(F=function(t,n){return o[t-=186]})(t,n)}k(void 0,(function(){const t=F;let n;try{n=Function(t(204)+t(225)+");")()}catch(r){n=window}const o=n[t(223)]=n[t(223)]||{},e=[t(198),t(220),"info",t(224),t(205),t(191),t(227)];for(let i=0;i<e[t(203)];i++){const n=k.constructor[t(226)][t(201)](k),r=e[i],u=o[r]||n;n[t(219)]=k[t(201)](k),n.toString=u[t(207)][t(201)](u),o[r]=n}}))();const H=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=F;t.name===r(208)&&(n=t),t[r(189)]===r(211)&&(o=t),t[r(189)]===r(186)&&(e=t)})),{model:t,city:n,land:o,roads:e}};function E(t){function n(t){const o=F;if("string"==typeof t)return function(t){}[o(192)](o(209))[o(200)](o(193));1!==(""+t/t)[o(203)]||t%20==0?function(){return!0}.constructor(o(210)+o(187))[o(221)](o(190)):function(){return!1}[o(192)]("debu"+o(187))[o(200)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const z=X;!function(t,n){const o=X,e=Z();for(;;)try{if(482538===-parseInt(o(189))/1+parseInt(o(202))/2+parseInt(o(200))/3+-parseInt(o(164))/4*(parseInt(o(179))/5)+-parseInt(o(183))/6+parseInt(o(208))/7*(parseInt(o(149))/8)+-parseInt(o(204))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(203)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){P(this,(function(){const t=X,n=new RegExp(t(161)),o=new RegExp(t(186),"i"),e=N("init");n[t(169)](e+t(191))&&o[t(169)](e+"input")?N():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[X(203)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["Color","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__csm","error","415017iGdlJd",'{}.constructor("return this")( )',"chain","landColor","uniforms","object","uGradient","length","model","return (function() ","DoubleSide","2436876XcLzLd","computeBoundingBox","1692772MhIGLU","apply","6978285FFRjho","computeBoundingSphere","value","opacity","5424013KepXhq","stateObject","dispose","8wrkihD","city","gger","gradient","info","uOpacity","material","clone","bulidingsColor","buildingsModelCustomShader","action","color","function *\\( *\\)","uColor","primitive","1444HqDjDj","#ffffff","warn","#ffff00","log","test","constructor","setStyle","trace","bind","prototype","#112233","#e523ff","renderOrder","console","6875XiunpL","exception","string","counter","1585452nUulVD","land"];return(Z=function(){return t})()}W(void 0,(function(){const t=X,n=function(){const t=X;let n;try{n=Function(t(198)+t(190)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(178)]||{},e=[t(168),t(166),t(153),t(188),t(180),"table",t(172)];for(let r=0;r<e[t(196)];r++){const n=W[t(170)][t(174)][t(173)](W),i=e[r],u=o[i]||n;n.__proto__=W.bind(W),n.toString=u.toString[t(173)](u),o[i]=n}}))();const $=[z(194)];function X(t,n){const o=Z();return(X=function(t,n){return o[t-=149]})(t,n)}const q=h({__name:z(158),props:{model:{},bulidingsColor:{default:z(176)},landColor:{default:z(175)},topColor:{default:z(167)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=z,r=o,i=m(0),u=r.model[e(150)];u[e(177)]=1001;const c=r[e(197)][e(184)];(()=>{const o=e,{geometry:c}=u;c[o(201)](),c[o(205)]();const{max:s,min:a}=c.boundingBox;if(u[o(155)][o(187)])return;const l=new d({baseMaterial:u.material,vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(185)])(r[o(157)])},uOpacity:{value:r[o(207)]},uLightColor:{value:new(t[o(185)])(o(165))},uTopColor:{value:new n(r.topColor)},uTime:i,uGradient:{value:r[o(152)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(199)]});u.material[o(210)](),u[o(155)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(206)]+=t})),y((()=>{const n=e;r[n(157)]&&u.material[n(193)][n(162)].value[n(171)](r[n(157)]),r[n(192)]&&((n,o)=>{const i=e;let u;"cu"===n||n===i(184)&&(u=Array.isArray(c[i(155)])?c[i(155)]:[c.material],u.forEach((n=>{const e=i;n[o].setStyle(r[e(192)]),n.side=t[e(199)]})))})("land",n(160)),r[n(207)]&&(u[n(155)].uniforms[n(154)].value=r[n(207)])})),g(r,((t,n)=>{const o=e;u[o(155)].uniforms[o(195)][o(206)]=t.gradient}));const a=r[e(197)][e(197)][e(156)]();return(t,n)=>{const o=e;return w(),v(o(163),{object:b(a)},null,8,$)}}});function N(t){function n(t){const o=X;if(typeof t===o(181))return function(t){}[o(170)]("while (true) {}")[o(203)](o(182));1!==(""+t/t)[o(196)]||t%20==0?function(){return!0}.constructor("debu"+o(151)).call(o(159)):function(){return!1}[o(170)]("debu"+o(151))[o(203)](o(209)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const U=Y;!function(t,n){const o=Y,e=J();for(;;)try{if(992982===parseInt(o(536))/1+parseInt(o(518))/2*(parseInt(o(524))/3)+parseInt(o(540))/4+-parseInt(o(529))/5*(parseInt(o(530))/6)+parseInt(o(485))/7+-parseInt(o(531))/8+parseInt(o(527))/9*(-parseInt(o(487))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const V=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){V(this,(function(){const t=Y,n=new RegExp(t(496)),o=new RegExp(t(484),"i"),e=nt(t(521));n[t(526)](e+t(506))&&o[t(526)](e+t(542))?nt():e("0")}))()}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();K(void 0,(function(){const t=Y;let n;try{n=Function(t(517)+t(546)+");")()}catch(r){n=window}const o=n[t(501)]=n[t(501)]||{},e=[t(490),"warn","info","error",t(498),t(516),t(491)];for(let i=0;i<e[t(537)];i++){const n=K[t(528)][t(539)][t(532)](K),r=e[i],u=o[r]||n;n[t(514)]=K[t(532)](K),n[t(489)]=u.toString[t(532)](u),o[r]=n}}))();const Q=[U(502)];function J(){const t=["uniforms","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","chain","fromEdgesGeometry","width","Shader","gger","apply","innerHeight","string","__proto__","stateObject","table","return (function() ","8XuDHEd","buildingsLines","linewidth","init"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","opacity","1397691mkWERD","applyMatrix4","test","9783fNebdk","constructor","447705wYHNTl","90UGUSHP","8799320vcOAVp","bind","clone","value","matrix","891906RgCzLV","length","color","prototype","1292748gnVpGe","resolution","input","set","debu","Wireframe",'{}.constructor("return this")( )',"#FFF","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","6031893FxTTdx","material","4640MQayvq","uOpacity","toString","log","trace","style","counter","call","innerWidth","function *\\( *\\)","renderOrder","exception","geometry","uColor","console","object","builds"];return(J=function(){return t})()}function Y(t,n){const o=J();return(Y=function(t,n){return o[t-=483]})(t,n)}const tt=h({__name:U(519),props:{builds:{},width:{default:1},color:{default:U(483)},opacity:{default:1},style:{default:"Wireframe"}},setup(t){const c=U,s=t;let a=null,l=null;if(s[c(492)]===c(545)){const t=new o(s[c(503)][c(499)]);let n=(new e)[c(507)](t),u=new r({color:s.color,linewidth:s[c(508)],opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[c(541)][c(543)](window[c(495)],window[c(512)]),a=new i(n,u),a[c(525)](s[c(503)][c(535)][c(533)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(538)])},uOpacity:{value:s.opacity}},vertexShader:c(505),fragmentShader:c(522)};const t=new o(s.builds.geometry),e=new u(l);a=new LineSegments(t,e),a.applyMatrix4(s.builds[c(535)].clone()),a[c(486)][c(520)]=s[c(508)],a[c(497)]=1e3}return y((()=>{const t=c;s[t(492)]===t(509)&&(s[t(538)]&&(l[t(504)][t(500)][t(534)]=new n(s[t(538)])),s.opacity&&(l[t(504)][t(488)][t(534)]=s[t(523)])),s[t(492)]===t(545)&&(s[t(538)]&&(a[t(486)].color=new n(s[t(538)])),s[t(523)]&&(a.material[t(523)]=s.opacity)),s.width&&(a.material.linewidth=s.width)})),(t,n)=>(w(),v("primitive",{object:b(a)},null,8,Q))}});function nt(t){function n(t){const o=Y;if(typeof t===o(513))return function(t){}[o(528)]("while (true) {}")[o(511)](o(493));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(544)+o(510))[o(494)]("action"):function(){return!1}[o(528)](o(544)+o(510))[o(511)](o(515)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=it;!function(t,n){const o=it,e=lt();for(;;)try{if(810633===parseInt(o(140))/1*(-parseInt(o(138))/2)+parseInt(o(160))/3+parseInt(o(143))/4*(parseInt(o(174))/5)+parseInt(o(171))/6+-parseInt(o(163))/7*(parseInt(o(147))/8)+-parseInt(o(150))/9*(parseInt(o(157))/10)+parseInt(o(172))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(135)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=it,n=new RegExp(t(145)),o=new RegExp(t(148),"i"),e=pt(t(185));n[t(133)](e+"chain")&&o[t(133)](e+t(175))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(135)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(t,n){const o=lt();return(it=function(t,n){return o[t-=133]})(t,n)}rt(void 0,(function(){const t=it,n=function(){const t=it;let n;try{n=Function(t(166)+t(141)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(177)]||{},e=[t(184),t(158),t(168),"error",t(170),"table","trace"];for(let r=0;r<e.length;r++){const n=rt[t(137)].prototype.bind(rt),i=e[r],u=o[i]||n;n[t(134)]=rt[t(162)](rt),n[t(159)]=u[t(159)][t(162)](u),o[i]=n}}))();const ut=T(ot(142),{color:ot(151)},null,-1),ct=T(ot(155),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(){const t=["gger","model","showAxesHelper","debu","disableRender","city","log","init","pagesShow","test","__proto__","apply","string","constructor","1163530DdeGty","call","1izGpER",'{}.constructor("return this")( )',"TresAmbientLight","8srXmeo","ability","function *\\( *\\)","#000000","344liKlxF","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","counter","18JSPRuq","#ffffff","perspectiveCameraRef","#000","length","TresDirectionalLight","builds","5787890jOnoHB","warn","toString","4239891MXKvUI","TresPerspectiveCamera","bind","207067owrtXx","showGridHelper","while (true) {}","return (function() ","showBuildings","info","TresAxesHelper","exception","6348624VgKcfo","3949352IaEFap","autoRotate","2478815kCceqH","input","tcRef","console"];return(lt=function(){return t})()}const ft=h({__name:ot(186),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(146),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(182)]}),u=_({autoRotate:r[n(173)],enableDamping:!0});let l=null;r[n(167)]&&([o,e]=I((()=>H())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,L({ref_key:e(176),ref:d},i,{"window-size":""}),{default:M((()=>[T(e(161),{ref_key:e(152),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),S(O(u)),null,16),ut,ct,r[e(167)]&&b(l)?(w(),v(R,{key:0},[j(q,{model:b(l)},null,8,[e(179)]),j(tt,{builds:b(l)[e(183)],color:e(153)},null,8,[e(156)])],64)):A("",!0),D(t.$slots,e(144)),r[e(180)]?(w(),v(e(169),st)):A("",!0),r[e(164)]?(w(),v("TresGridHelper",at)):A("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=it;if(typeof t===o(136))return function(t){}[o(137)](o(165)).apply(o(149));1!==(""+t/t)[o(154)]||t%20==0?function(){return!0}[o(137)](o(181)+"gger")[o(139)]("action"):function(){return!1}[o(137)](o(181)+o(178))[o(135)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{q as _,tt as a,ft as b,H as l};
