import{t as e}from"./lodash.CybtBilg1763540743861.js";import{P as t}from"./chartEditStore.CHAh6jvI1763540743861.js";import{a as i,q as a,W as n,v as s,i as o}from"./@vue.Co_gxueH1763540743861.js";import{q as r,v as d,V as w}from"./echarts.1o70n-tX1763540743861.js";const l="scale-value",h=o=>{const r=i(),d=i(),w=i(o.editCanvasConfig.width),h=i(o.editCanvasConfig.height),c=i({width:1,height:1});s(l,c);const v=e=>{addEventListener("wheel",t=>{if(window?.$KeyboardActive?.ctrl){t.preventDefault(),t.stopPropagation(),e();const i=d.value?.style.transform,a=i.match(/scale\((\d+\.?\d*)*/)[1],n=document.querySelector(".go-preview"),s=document.querySelector(".go-preview-entity");if(n&&(n.style.overflow="unset",n.style.position="absolute"),s&&(s.style.overflow="unset"),t.wheelDelta>0){const e=parseFloat(Number(a).toFixed(2));d.value.style.transform=`scale(${e>5?5:e+.1})`}else{const e=parseFloat(Number(a).toFixed(2));d.value.style.transform=`scale(${e<.2?.2:e-.1})`}}},{passive:!1})},u=e=>{c.value={...e}};return a(()=>{switch(o.editCanvasConfig.previewScaleType){case t.FIT:(()=>{const{calcRate:t,windowResize:i,unWindowResize:a}=((t,i,a,n)=>{const s=t,o=i,r={width:1,height:1},d=parseFloat((s/o).toFixed(5)),w=()=>{const e=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));a&&(e>d?(r.width=parseFloat((window.innerHeight*d/s).toFixed(5)),r.height=parseFloat((window.innerHeight/o).toFixed(5)),a.style.transform=`scale(${r.width}, ${r.height})`):(r.height=parseFloat((window.innerWidth/d/o).toFixed(5)),r.width=parseFloat((window.innerWidth/s).toFixed(5)),a.style.transform=`scale(${r.width}, ${r.height})`),n&&n(r))},l=e(()=>{w()},200);return{calcRate:w,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}})(w.value,h.value,d.value,u);t(),i(),v(a),n(()=>{a()})})();break;case t.SCROLL_Y:(()=>{const{calcRate:t,windowResize:i,unWindowResize:a}=((t,i,a,n)=>{const s=t,o=i,r={width:1,height:1},d=parseFloat((s/o).toFixed(5)),w=()=>{a&&(r.height=parseFloat((window.innerWidth/d/o).toFixed(5)),r.width=parseFloat((window.innerWidth/s).toFixed(5)),a.style.transform=`scale(${r.width}, ${r.height})`,n&&n(r))},l=e(()=>{w()},200);return{calcRate:w,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}})(w.value,h.value,d.value,e=>{const t=r.value;t.style.width=w.value*e.width+"px",t.style.height=h.value*e.height+"px",u(e)});t(),i(),v(a),n(()=>{a()})})();break;case t.SCROLL_X:(()=>{const{calcRate:t,windowResize:i,unWindowResize:a}=((t,i,a,n)=>{const s=t,o=i,r={height:1,width:1},d=parseFloat((s/o).toFixed(5)),w=()=>{a&&(r.width=parseFloat((window.innerHeight*d/s).toFixed(5)),r.height=parseFloat((window.innerHeight/o).toFixed(5)),a.style.transform=`scale(${r.width}, ${r.height})`,n&&n(r))},l=e(()=>{w()},200);return{calcRate:w,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}})(w.value,h.value,d.value,e=>{const t=r.value;t.style.width=w.value*e.width+"px",t.style.height=h.value*e.height+"px",u(e)});t(),i(),v(a),n(()=>{a()})})();break;case t.FULL:(()=>{const{calcRate:t,windowResize:i,unWindowResize:a}=((t,i,a,n)=>{const s={width:1,height:1},o=()=>{a&&(s.width=parseFloat((window.innerWidth/t).toFixed(5)),s.height=parseFloat((window.innerHeight/i).toFixed(5)),a.style.transform=`scale(${s.width}, ${s.height})`,n&&n(s))},r=e(()=>{o()},200);return{calcRate:o,windowResize:()=>{window.addEventListener("resize",r)},unWindowResize:()=>{window.removeEventListener("resize",r)}}})(w.value,h.value,d.value,u);t(),i(),v(a),n(()=>{a()})})()}}),{entityRef:r,previewRef:d,scaleRef:c}};function c(e,t){const i=e.renderer||t.renderer,a={renderer:i},n=o(l)||{value:{width:1,height:1}};return"canvas"===i&&(a.devicePixelRatio=Math.ceil(Math.max(window.devicePixelRatio,n.value.width,n.value.height))),a}r([d,w]);export{c as a,h as u};
