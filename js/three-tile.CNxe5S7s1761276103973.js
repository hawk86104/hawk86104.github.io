import{a2 as t,V as e,B as r,ah as s,M as i,m as n,y as o,o as a,z as l,F as d,ca as c,L as h,i as u,j as m,n as b,C as Z,cb as p,A as y,b as W,t as f,u as L,aV as G,d as V,Y as x,R as w,P as g,E as v,O as M,a8 as X,cc as T,ae as Y}from"./three.Bhn4-0ry1761276103973.js";var P=Object.defineProperty,S=(t,e,r)=>((t,e,r)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);const K="0.11.9",I=new b;var z=(t=>(t[t.none=0]="none",t[t.create=1]="create",t[t.remove=2]="remove",t))(z||{});function k(t,e,r,s,i,n,o,a){const l=new D(t,e,r);return l.position.set(s,i,0),l.scale.set(n,o,a),l}const F=new e,U=new class extends d{constructor(){super(),S(this,"points"),this.points=Array(8).fill(0).map(()=>new e)}setFromProjectionMatrix(t,e=c){return super.setFromProjectionMatrix(t,e),this.calculateFrustumPoints(),this}calculateFrustumPoints(){const{planes:t,points:e}=this;[[t[0],t[3],t[4]],[t[1],t[3],t[4]],[t[0],t[2],t[4]],[t[1],t[2],t[4]],[t[0],t[3],t[5]],[t[1],t[3],t[5]],[t[0],t[2],t[5]],[t[1],t[2],t[5]]].forEach((t,r)=>{!function(t,e,r,s){const i=I.set(t.normal.x,t.normal.y,t.normal.z,e.normal.x,e.normal.y,e.normal.z,r.normal.x,r.normal.y,r.normal.z);s.set(-t.constant,-e.constant,-r.constant),s.applyMatrix3(i.invert())}(t[0],t[1],t[2],e[r])})}},R=new i,H=new e;class D extends t{constructor(t=0,e=0,r=0){super(),S(this,"x"),S(this,"y"),S(this,"z"),S(this,"isTile",!0),S(this,"_isLoading",!1),S(this,"_root",this),S(this,"_sizeInWorld",-1),S(this,"_model"),S(this,"_subTiles"),S(this,"_isDirty",!1),this.x=t,this.y=e,this.z=r,this.name=`Tile ${r}-${t}-${e}`,this.up.set(0,0,1)}get model(){return this._model}get subTiles(){return this._subTiles}get distRatio(){const t=(new e).applyMatrix4(this.matrixWorld);t.setY(this.model?.geometry.boundingBox?.max.z||0);const r=F.distanceTo(t)/this._sizeInWorld;return this.inFrustum?.8*r:2*r}get inFrustum(){const t=this.getBBox();return U.intersectsBox(t)}get isLeaf(){return!this.subTiles}get showing(){return!!this.model&&this.model.visible}set showing(t){this.model?(t&&this._updateShadow(),t!=this.showing&&(this.model.traverse(e=>e.layers.set(t?0:31)),this.model.visible=t,this._root.dispatchEvent({type:"tile-visible-changed",tile:this,visible:t}))):console.assert(!t)}_needsLoad(t){return!(t.downloadingThreads>=t.maxThreads)&&(!this.model||!(!this._isDirty||!this.inFrustum)&&!this.subTiles?.some(t=>!t._isDirty))}raycast(t){return this.inFrustum}getBBox(){const t=new r(new e(-.5,-.5,0),new e(.5,.5,0)).applyMatrix4(this.matrixWorld);return this.model?t.max.setY(this.model.geometry.boundingBox?.max.z||0):(t.min.setY(-300),t.max.setY(9e3)),t}getTileSize(){if(this._sizeInWorld<0){const t=new r(new e(-.5,-.5,0),new e(.5,.5,0)).applyMatrix4(this.matrixWorld);this._sizeInWorld=t.getSize(H).length(),console.assert(this._sizeInWorld>10)}return this._sizeInWorld}_addBBox(){const t=this.getBBox().clone().applyMatrix4(this.matrixWorld.clone().invert()),e=new s(t,1044480);e.name="tilebox",this.add(e)}update(t){if(!this.parent||this._isLoading)return;this.parent instanceof D&&(this._root=this.parent._root),console.assert(0===this._root.z);const{loader:e,minLevel:r,camera:s}=t;0===this.z&&(s.getWorldPosition(F),U.setFromProjectionMatrix(R.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse))),this.z>=r&&this._needsLoad(e)?this._startLoad(e):(this.model&&e.update(this,this.model),this._updateShadow(),this.LOD(t),this.subTiles?.forEach(e=>e.update(t)))}_updateShadow(){this.model&&(this.model.castShadow=this._root.castShadow,this.model.receiveShadow=this._root.receiveShadow)}LOD(t){const{loader:e,minLevel:r,maxLevel:s,LODThreshold:i}=t,n=function(t,e,r,s){if(!t.isLeaf&&t.z>r)return 2;const i=t.distRatio;return t.isLeaf&&t.inFrustum&&t.z<r&&i<s&&(t.showing||t.z<=e)?1:!t.isLeaf&&t.z>=e&&i>s?2:0}(this,r,s,i);if(n===z.create){const t=function(t,e){const{x:r,y:s,z:i}=t,n=[],o=2*r,a=i+1,l=.25,d=.5;if(0===i&&"4326"===e.projectionID){const t=s,e=1,r=k(o,t,a,-.25,0,d,e,1),i=k(o+1,t,a,l,0,d,e,1);n.push(r,i)}else{const t=2*s,e=.5,r=k(o,t,a,-.25,l,d,e,1),i=k(o+1,t,a,l,l,d,e,1),c=k(o,t+1,a,-.25,-.25,d,e,1),h=k(o+1,t+1,a,l,-.25,d,e,1);n.push(r,i,c,h)}return n}(this,e);this.add(...t),this._subTiles=t,this._subTiles.forEach(t=>{t.updateMatrixWorld(),t.updateMatrix(),t.getTileSize(),this._root.dispatchEvent({type:"tile-created",tile:t})})}else n===z.remove&&this.model&&(this.showing=!0,this.unLoad(e,!1));return n}_checkVisible(){const t=this.parent;if(t instanceof D)if(t.model){const e=t.subTiles;if(e){const r=!e.some(t=>!t.model);e.forEach(t=>t.showing=r),t.showing=!r}}else this.showing=!0;return this}async _startLoad(t){const e=this._isDirty;this._isLoading=!0;const r=await t.load(this,this.model);this.model&&this.model.removeFromParent(),this._model=r,r.geometry.computeBoundingBox(),this.add(r),this._root.dispatchEvent({type:"tile-visible-changed",tile:this,visible:!0}),e?this._isDirty=!1:this.isLeaf&&this._checkVisible(),t.debug>1&&this._addBBox(),this._isLoading=!1,this._root.dispatchEvent({type:"tile-loaded",tile:this})}reload(t,e=!0){return e?this.unLoad(t,!0):(this.traverse(t=>{t instanceof D&&(t.model||t._isLoading)&&(t._isDirty=!0)}),this)}unLoad(t,e=!0){return this.subTiles&&(this.subTiles.forEach(e=>{e.unLoad(t,!0)}),this.remove(...this.subTiles),this._subTiles=void 0),e&&this.model&&(this.model.removeFromParent(),t.unload(this.model),this._model=void 0,this._isDirty=!1,this._root.dispatchEvent({type:"tile-unload",tile:this})),t.debug>1&&this.getObjectByName("tilebox")?.geometry.dispose(),this}}class j extends L{constructor(t={}){super({transparent:!1,side:G,...t})}}function E(...t){const e=t,r=e&&e.length>1&&e[0].constructor||null;if(!r)throw new Error("concatenateTypedArrays - incorrect quantity of arguments or arguments have incompatible data types");const s=new r(e.reduce((t,e)=>t+e.length,0));let i=0;for(const n of e)s.set(n,i),i+=n.length;return s}function C(t,e,r,s){const i=function(t){const e=[],r=Array.isArray(t)?t:Array.from(t);for(let i=0;i<r.length;i+=3){const t=r[i],s=r[i+1],n=r[i+2];e.push([t,s],[s,n],[n,t])}e.sort(([t,e],[r,s])=>{const i=Math.min(t,e),n=Math.min(r,s);return i!==n?i-n:Math.max(t,e)-Math.max(r,s)});const s=[];for(let i=0;i<e.length;i++)i+1<e.length&&e[i][0]===e[i+1][1]&&e[i][1]===e[i+1][0]?i++:s.push(e[i]);return s}(e),n=i.length,o=new Float32Array(6*n),a=new Float32Array(4*n),l=new e.constructor(6*n),d=new Float32Array(6*n);for(let c=0;c<n;c++)J({edge:i[c],edgeIndex:c,attributes:t,skirtHeight:r,newPosition:o,newTexcoord0:a,newTriangles:l,newNormals:d});t.position.value=E(t.position.value,o),t.texcoord.value=E(t.texcoord.value,a),t.normal.value=E(t.normal.value,d);return{attributes:t,indices:E(e,l)}}function J({edge:t,edgeIndex:e,attributes:r,skirtHeight:s,newPosition:i,newTexcoord0:n,newTriangles:o,newNormals:a}){const l=r.position.value.length,d=2*e,c=d+1;i.set(r.position.value.subarray(3*t[0],3*t[0]+3),3*d),i[3*d+2]=i[3*d+2]-s,i.set(r.position.value.subarray(3*t[1],3*t[1]+3),3*c),i[3*c+2]=i[3*c+2]-s,n.set(r.texcoord.value.subarray(2*t[0],2*t[0]+2),2*d),n.set(r.texcoord.value.subarray(2*t[1],2*t[1]+2),2*c);const h=2*e*3;o[h]=t[0],o[h+1]=l/3+c,o[h+2]=t[1],o[h+3]=l/3+c,o[h+4]=t[0],o[h+5]=l/3+d,a[h]=0,a[h+1]=0,a[h+2]=1,a[h+3]=0,a[h+4]=0,a[h+5]=1}function N(t,e,r){const s=r*e,i=new Float32Array(3*s),n=new Float32Array(2*s);let o=0;for(let a=0;a<e;a++)for(let s=0;s<r;s++){const l=s/(r-1),d=a/(e-1);n[2*o]=l,n[2*o+1]=d,i[3*o]=l-.5,i[3*o+1]=d-.5,i[3*o+2]=t[(e-a-1)*r+s],o++}return{position:{value:i,size:3},texcoord:{value:n,size:2},normal:{value:O(i,B(e,r)),size:3}}}function B(t,e){const r=new Uint16Array(6*(e-1)*(t-1));let s=0;for(let i=0;i<t-1;i++)for(let t=0;t<e-1;t++){const n=i*e+t,o=n+1,a=n+e,l=a+1,d=6*s;r[d]=n,r[d+1]=o,r[d+2]=a,r[d+3]=a,r[d+4]=o,r[d+5]=l,s++}return r}function O(t,e){const r=new Float32Array(t.length);for(let s=0;s<e.length;s+=3){const i=3*e[s],n=3*e[s+1],o=3*e[s+2],a=t[i],l=t[i+1],d=t[i+2],c=t[n]-a,h=t[n+1]-l,u=t[n+2]-d,m=t[o]-a,b=t[o+1]-l,Z=t[o+2]-d,p=h*Z-u*b,y=u*m-c*Z,W=c*b-h*m,f=Math.sqrt(p*p+y*y+W*W),L=[0,0,1];if(f>0){const t=1/f;L[0]=p*t,L[1]=y*t,L[2]=W*t}for(let t=0;t<3;t++)r[i+t]=r[n+t]=r[o+t]=L[t]}return r}let Q=class extends u{constructor(){super(),S(this,"type","TileGeometry");const t=new Float32Array([0,0,0,0,1,0,1,1,0,1,0,0]);this.setData(t)}setData(t,e=1e3){let r=t instanceof Float32Array?function(t){if(t.length<4)throw new Error(`DEM array must > 4, got ${t.length}!`);const e=Math.floor(Math.sqrt(t.length)),r=e,s=e,i=B(s,r);return{attributes:N(t,s,r),indices:i}}(t):t;r=C(r.attributes,r.indices,e);const{attributes:s,indices:i}=r;return this.setIndex(new m(i,1)),this.setAttribute("position",new m(s.position.value,s.position.size)),this.setAttribute("uv",new m(s.texcoord.value,s.texcoord.size)),this.setAttribute("normal",new m(s.normal.value,s.normal.size)),this.computeBoundingBox(),this.computeBoundingSphere(),this}};const A="GuoJF",_={manager:new class extends h{constructor(){super(...arguments),S(this,"onParseEnd")}parseEnd(t){this.onParseEnd&&this.onParseEnd(t)}},demLoaderMap:new Map,imgLoaderMap:new Map,registerMaterialLoader(t){_.imgLoaderMap.set(t.dataType,t),t.info.author=t.info.author??A},registerGeometryLoader(t){_.demLoaderMap.set(t.dataType,t),t.info.author=t.info.author??A},getMaterialLoader(t){const e="string"==typeof t?t:t.dataType,r=_.imgLoaderMap.get(e);if(r)return r;throw`Image source dataType("${e}") is not support!`},getGeometryLoader(t){const e="string"==typeof t?t:t.dataType,r=_.demLoaderMap.get(e);if(r)return r;throw`Terrain source dataType("${e}") is not support!`},getLoaders:()=>({imgLoaders:Array.from(_.imgLoaderMap.values()),demLoaders:Array.from(_.demLoaderMap.values())})};function q(t,e){return{sx:Math.floor(t[0]*e),sy:Math.floor(t[1]*e),sw:Math.floor((t[2]-t[0])*e),sh:Math.floor((t[3]-t[1])*e)}}function $(t,e,r,s){if(s<t.minLevel)return{url:void 0,clipBounds:[0,0,1,1]};if(s<=t.maxLevel)return{url:t.getUrl(e,r,s),clipBounds:[0,0,1,1]};const i=function(t,e,r,s){const i=r-s,n={x:t>>i,y:e>>i,z:r-i},o=Math.pow(2,i),a=Math.pow(.5,i),l=t%o/o-.5+a/2,d=e%o/o-.5+a/2,c=new V(l,d),h=(new x).setFromCenterAndSize(c,new V(a,a)),u=[h.min.x+.5,h.min.y+.5,h.max.x+.5,h.max.y+.5];return{parentCoord:n,bounds:u}}(e,r,s,t.maxLevel),n=i.parentCoord;return{url:t.getUrl(n.x,n.y,n.z),clipBounds:i.bounds}}class tt{constructor(){S(this,"_downloadingThreads",0),S(this,"_bounds",[-180,-85,180,85]),S(this,"_maxThreads",10),S(this,"_imgSource",[]),S(this,"_demSource"),S(this,"debug",0),S(this,"_errorMaterial",new o({color:16711680,transparent:!0,opacity:0,name:"error-material"}))}get bounds(){return this._bounds}set bounds(t){this._bounds=t}get maxThreads(){return this._maxThreads}set maxThreads(t){this._maxThreads=t}get downloadingThreads(){return this._downloadingThreads}get imgSource(){return this._imgSource}set imgSource(t){this._imgSource=t}get demSource(){return this._demSource}set demSource(t){this._demSource=t}get projectionID(){return this.imgSource[0].projectionID}get manager(){return _.manager}async load(t,e){const r=this.demSource?1:0+this.imgSource.length;let s;this._downloadingThreads+=r;try{const r=await this.loadGeometry(t,e?.geometry),i=await this.loadMaterial(t,e?.material);if(e){const t=e.geometry,n=e.material;s=e,s.geometry=r,s.material=i,t.userData.toDispose&&(t.dispose(),delete t.userData.source,delete t.userData.toDispose),n.forEach(t=>{t.userData.toDispose&&(t.dispose(),delete t.userData.source,delete t.userData.toDispose)})}else s=new a(r,i);s.geometry.clearGroups();for(let t=0;t<s.material.length;t++)s.geometry.addGroup(0,1/0,t)}finally{this._downloadingThreads-=r}return s}unload(t){const e=t.material;for(let r=0;r<e.length;r++)e[r].dispose(),t.geometry.groups.pop();t.geometry.dispose()}update(t,e){const r=this.imgSource.filter(e=>this._checkBounds(e,t));for(let s=0;s<r.length;s++)r[s].dynamic}async loadGeometry(t,e){if(this.demSource&&this._checkBounds(this.demSource,t)){if(e){if(this.demSource===e.userData.source)return e.userData.toDispose=!1,e;e.userData.toDispose=!0}const r=_.getGeometryLoader(this.demSource),s=this.demSource;return await r.load({source:s,...t}).then(t=>(t.userData.source=s,t)).catch(t=>(this.debug>0&&console.error("Load Geometry Error:",t),new Q))}return new Q}async loadMaterial(t,e){e&&e.forEach(t=>t.userData.toDispose=!0);const r=[],s=this.imgSource.filter(e=>this._checkBounds(e,t));for(let i=0;i<s.length;i++){const n=s[i];if(e){const t=e[i];if(t&&n===t.userData.source){t.userData.toDispose=!1,r.push(t);continue}}const o=await _.getMaterialLoader(n).load({source:n,...t}).then(t=>(t.userData.source=n,t)).catch(t=>(this.debug>0&&console.error("Load Material Error:",t.target.src),this._errorMaterial.clone()));this._materialClip(o,n,t),r.push(o)}return r}_materialClip(t,e,r){if("map"in t&&t.map instanceof l){const s=t.map;s.image&&(s.image=function(t,e,r){if(e[0]<=r[0]&&e[1]<=r[1]&&e[2]>=r[2]&&e[3]>=r[3])return t;const[s,i,n,o]=e,[a,l,d,c]=r,h=Math.max(s,a),u=Math.max(i,l),m=Math.min(n,d),b=Math.min(o,c);if(h>=m||u>=b)return t;const Z=new OffscreenCanvas(t.width,t.height),p=Z.getContext("2d");p.drawImage(t,0,0);const y=Math.max(a,s),W=Math.min(d,n),f=Math.max(l,i),L=Math.min(c,o);p.globalCompositeOperation="destination-in";const G=d-a,V=c-l,x=(y-a)/G*Z.width,w=(W-a)/G*Z.width,g=Z.height-(L-l)/V*Z.height,v=Z.height-(f-l)/V*Z.height;return p.beginPath(),p.rect(x,g,w-x,v-g),p.fill(),Z}(s.image,e._projectionBounds,r.bounds)),s.needsUpdate=!0}return this}_checkBounds(t,e){return e.z>=t.minLevel&&((t,e)=>{const r=t._projectionBounds;return e[2]>=r[0]&&e[3]>=r[1]&&e[0]<=r[2]&&e[1]<=r[3]})(t,e.bounds)}}class et{constructor(){S(this,"info",{version:K,description:"Terrain loader base class"}),S(this,"dataType","")}async load(t){const{source:e,x:r,y:s,z:i}=t,{url:n,clipBounds:o}=$(e,r,s,i);if(!n)return new Q;const a=await this.doLoad(n,{...t,clipBounds:o});return _.manager.parseEnd(a),a}}class rt{constructor(){S(this,"info",{version:K,description:"Image loader base class"}),S(this,"dataType",""),S(this,"_material",new j)}get material(){return this._material}set material(t){this.material.dispose(),this._material=t}async load(t){const{source:e,x:r,y:s,z:i}=t,n=this.createMaterial(t);n.transparent=t.source.transparent,n.opacity=t.source.opacity;const{url:o,clipBounds:a}=$(e,r,s,i);return o&&(n.map=await this.doLoad(o,{...t,clipBounds:a}),n.addEventListener("dispose",st)),n}createMaterial(t){return this.material.clone()}async doLoad(t,e){return Promise.resolve(void 0)}}const st=t=>{const e=t.target.map;e&&(e.image instanceof ImageBitmap&&e.image.close(),e.dispose()),t.target.removeEventListener("dispose",st)};class it extends rt{constructor(){super(...arguments),S(this,"info",{version:K,description:"Tile image loader. It can load xyz tile image."}),S(this,"dataType","image"),S(this,"loader",new p(_.manager))}async doLoad(t,e){let r=await this.loader.loadAsync(t);const s=e.clipBounds;s[2]-s[0]<1&&(r=function(t,e){const r=t.width,s=new OffscreenCanvas(r,r),i=s.getContext("2d"),{sx:n,sy:o,sw:a,sh:l}=q(e,t.width);return i.drawImage(t,n,o,a,l,0,0,r,r),s}(r,s));const i=new l(r);return i.colorSpace=y,i}}Xt(new it);class nt{constructor(t=4){this.pool=t,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(t){if(!this.workers[t]){const e=this.workerCreator();e.addEventListener("message",this._onMessage.bind(this,t)),this.workers[t]=e}}_getIdleWorker(){for(let t=0;t<this.pool;t++)if(!(this.workerStatus&1<<t))return t;return-1}_onMessage(t,e){const r=this.workersResolve[t];if(r&&r(e),this.queue.length){const{resolve:e,msg:r,transfer:s}=this.queue.shift();this.workersResolve[t]=e,this.workers[t].postMessage(r,s)}else this.workerStatus^=1<<t}setWorkerCreator(t){this.workerCreator=t}setWorkerLimit(t){this.pool=t}postMessage(t,e){return new Promise(r=>{const s=this._getIdleWorker();-1!==s?(this._initWorker(s),this.workerStatus|=1<<s,this.workersResolve[s]=r,this.workers[s].postMessage(t,e)):this.queue.push({resolve:r,msg:t,transfer:e})})}dispose(){this.workers.forEach(t=>t.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const ot="dmFyIGNlPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgbWU9KGosWixxKT0+WiBpbiBqP2NlKGosWix7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6cX0pOmpbWl09cTt2YXIgTj0oaixaLHEpPT5tZShqLHR5cGVvZiBaIT0ic3ltYm9sIj9aKyIiOloscSk7KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGooQSxwKXtjb25zdCBrPW5ldyBGbG9hdDMyQXJyYXkoQS5sZW5ndGgpO2ZvcihsZXQgVT0wO1U8cC5sZW5ndGg7VSs9Myl7Y29uc3QgYT1wW1VdKjMsZT1wW1UrMV0qMyxyPXBbVSsyXSozLHM9QVthXSx0PUFbYSsxXSxuPUFbYSsyXSxoPUFbZV0saT1BW2UrMV0sbz1BW2UrMl0sYz1BW3JdLHU9QVtyKzFdLG09QVtyKzJdLHc9aC1zLGw9aS10LGY9by1uLGc9Yy1zLE09dS10LFY9bS1uLGQ9bCpWLWYqTSx5PWYqZy13KlYsST13Kk0tbCpnLHo9TWF0aC5zcXJ0KGQqZCt5KnkrSSpJKSx4PVswLDAsMV07aWYoej4wKXtjb25zdCB2PTEvejt4WzBdPWQqdix4WzFdPXkqdix4WzJdPUkqdn1mb3IobGV0IHY9MDt2PDM7disrKWtbYSt2XT1rW2Urdl09a1tyK3ZdPXhbdl19cmV0dXJuIGt9Y2xhc3MgWntjb25zdHJ1Y3RvcihwPTI1Nyl7Tih0aGlzLCJncmlkU2l6ZSIpO04odGhpcywibnVtVHJpYW5nbGVzIik7Tih0aGlzLCJudW1QYXJlbnRUcmlhbmdsZXMiKTtOKHRoaXMsImluZGljZXMiKTtOKHRoaXMsImNvb3JkcyIpO3RoaXMuZ3JpZFNpemU9cDtjb25zdCBrPXAtMTtpZihrJmstMSl0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIGdyaWQgc2l6ZSB0byBiZSAyXm4rMSwgZ290ICR7cH0uYCk7dGhpcy5udW1UcmlhbmdsZXM9ayprKjItMix0aGlzLm51bVBhcmVudFRyaWFuZ2xlcz10aGlzLm51bVRyaWFuZ2xlcy1rKmssdGhpcy5pbmRpY2VzPW5ldyBVaW50MzJBcnJheSh0aGlzLmdyaWRTaXplKnRoaXMuZ3JpZFNpemUpLHRoaXMuY29vcmRzPW5ldyBVaW50MTZBcnJheSh0aGlzLm51bVRyaWFuZ2xlcyo0KTtmb3IobGV0IFU9MDtVPHRoaXMubnVtVHJpYW5nbGVzO1UrKyl7bGV0IGE9VSsyLGU9MCxyPTAscz0wLHQ9MCxuPTAsaD0wO2ZvcihhJjE/cz10PW49azplPXI9aD1rOyhhPj49MSk+MTspe2NvbnN0IG89ZStzPj4xLGM9cit0Pj4xO2EmMT8ocz1lLHQ9cixlPW4scj1oKTooZT1zLHI9dCxzPW4sdD1oKSxuPW8saD1jfWNvbnN0IGk9VSo0O3RoaXMuY29vcmRzW2krMF09ZSx0aGlzLmNvb3Jkc1tpKzFdPXIsdGhpcy5jb29yZHNbaSsyXT1zLHRoaXMuY29vcmRzW2krM109dH19Y3JlYXRlVGlsZShwKXtyZXR1cm4gbmV3IHEocCx0aGlzKX19Y2xhc3MgcXtjb25zdHJ1Y3RvcihwLGspe04odGhpcywibWFydGluaSIpO04odGhpcywidGVycmFpbiIpO04odGhpcywiZXJyb3JzIik7Y29uc3QgVT1rLmdyaWRTaXplO2lmKHAubGVuZ3RoIT09VSpVKXRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgdGVycmFpbiBkYXRhIG9mIGxlbmd0aCAke1UqVX0gKCR7VX0geCAke1V9KSwgZ290ICR7cC5sZW5ndGh9LmApO3RoaXMudGVycmFpbj1wLHRoaXMubWFydGluaT1rLHRoaXMuZXJyb3JzPW5ldyBGbG9hdDMyQXJyYXkocC5sZW5ndGgpLHRoaXMudXBkYXRlKCl9dXBkYXRlKCl7Y29uc3R7bnVtVHJpYW5nbGVzOnAsbnVtUGFyZW50VHJpYW5nbGVzOmssY29vcmRzOlUsZ3JpZFNpemU6YX09dGhpcy5tYXJ0aW5pLHt0ZXJyYWluOmUsZXJyb3JzOnJ9PXRoaXM7Zm9yKGxldCBzPXAtMTtzPj0wO3MtLSl7Y29uc3QgdD1zKjQsbj1VW3QrMF0saD1VW3QrMV0saT1VW3QrMl0sbz1VW3QrM10sYz1uK2k+PjEsdT1oK28+PjEsbT1jK3UtaCx3PXUrbi1jLGw9KGVbaCphK25dK2VbbyphK2ldKS8yLGY9dSphK2MsZz1NYXRoLmFicyhsLWVbZl0pO2lmKHJbZl09TWF0aC5tYXgocltmXSxnKSxzPGspe2NvbnN0IE09KGgrdz4+MSkqYSsobittPj4xKSxWPShvK3c+PjEpKmErKGkrbT4+MSk7cltmXT1NYXRoLm1heChyW2ZdLHJbTV0scltWXSl9fX1nZXRHZW9tZXRyeURhdGEocD0wKXtjb25zdHtncmlkU2l6ZTprLGluZGljZXM6VX09dGhpcy5tYXJ0aW5pLHtlcnJvcnM6YX09dGhpcztsZXQgZT0wLHI9MDtjb25zdCBzPWstMTtsZXQgdCxuLGg9MDtVLmZpbGwoMCk7ZnVuY3Rpb24gaShmLGcsTSxWLGQseSl7Y29uc3QgST1mK00+PjEsej1nK1Y+PjE7TWF0aC5hYnMoZi1kKStNYXRoLmFicyhnLXkpPjEmJmFbeiprK0ldPnA/KGkoZCx5LGYsZyxJLHopLGkoTSxWLGQseSxJLHopKToodD1nKmsrZixuPVYqaytNLGg9eSprK2QsVVt0XT09PTAmJihVW3RdPSsrZSksVVtuXT09PTAmJihVW25dPSsrZSksVVtoXT09PTAmJihVW2hdPSsrZSkscisrKX1pKDAsMCxzLHMscywwKSxpKHMscywwLDAsMCxzKTtjb25zdCBvPWUqMixjPXIqMyx1PW5ldyBVaW50MTZBcnJheShvKSxtPW5ldyBVaW50MzJBcnJheShjKTtsZXQgdz0wO2Z1bmN0aW9uIGwoZixnLE0sVixkLHkpe2NvbnN0IEk9ZitNPj4xLHo9ZytWPj4xO2lmKE1hdGguYWJzKGYtZCkrTWF0aC5hYnMoZy15KT4xJiZhW3oqaytJXT5wKWwoZCx5LGYsZyxJLHopLGwoTSxWLGQseSxJLHopO2Vsc2V7Y29uc3QgeD1VW2cqaytmXS0xLHY9VVtWKmsrTV0tMSxEPVVbeSprK2RdLTE7dVsyKnhdPWYsdVsyKngrMV09Zyx1WzIqdl09TSx1WzIqdisxXT1WLHVbMipEXT1kLHVbMipEKzFdPXksbVt3KytdPXgsbVt3KytdPXYsbVt3KytdPUR9fXJldHVybiBsKDAsMCxzLHMscywwKSxsKHMscywwLDAsMCxzKSx7YXR0cmlidXRlczp0aGlzLl9nZXRNZXNoQXR0cmlidXRlcyh0aGlzLnRlcnJhaW4sdSxtKSxpbmRpY2VzOm19fV9nZXRNZXNoQXR0cmlidXRlcyhwLGssVSl7Y29uc3QgYT1NYXRoLmZsb29yKE1hdGguc3FydChwLmxlbmd0aCkpLGU9YS0xLHI9ay5sZW5ndGgvMixzPW5ldyBGbG9hdDMyQXJyYXkociozKSx0PW5ldyBGbG9hdDMyQXJyYXkocioyKTtmb3IobGV0IGg9MDtoPHI7aCsrKXtjb25zdCBpPWtbaCoyXSxvPWtbaCoyKzFdLGM9byphK2k7c1szKmgrMF09aS9lLS41LHNbMypoKzFdPS41LW8vZSxzWzMqaCsyXT1wW2NdLHRbMipoKzBdPWkvZSx0WzIqaCsxXT0xLW8vZX1jb25zdCBuPWoocyxVKTtyZXR1cm57cG9zaXRpb246e3ZhbHVlOnMsc2l6ZTozfSx0ZXhjb29yZDp7dmFsdWU6dCxzaXplOjJ9LG5vcm1hbDp7dmFsdWU6bixzaXplOjN9fX19LyogQ29weXJpZ2h0IDIwMTUtMjAyMSBFc3JpLiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wIEBwcmVzZXJ2ZSAqL2NvbnN0IGVlPWZ1bmN0aW9uKCl7dmFyIEE9e307QS5kZWZhdWx0Tm9EYXRhVmFsdWU9LTM0MDI3OTk5Mzg3OTAxNDg0ZTIyLEEuZGVjb2RlPWZ1bmN0aW9uKHIscyl7cz1zfHx7fTt2YXIgdD1zLmVuY29kZWRNYXNrRGF0YXx8cy5lbmNvZGVkTWFza0RhdGE9PT1udWxsLG49YShyLHMuaW5wdXRPZmZzZXR8fDAsdCksaD1zLm5vRGF0YVZhbHVlIT09bnVsbD9zLm5vRGF0YVZhbHVlOkEuZGVmYXVsdE5vRGF0YVZhbHVlLGk9cChuLHMucGl4ZWxUeXBlfHxGbG9hdDMyQXJyYXkscy5lbmNvZGVkTWFza0RhdGEsaCxzLnJldHVybk1hc2spLG89e3dpZHRoOm4ud2lkdGgsaGVpZ2h0Om4uaGVpZ2h0LHBpeGVsRGF0YTppLnJlc3VsdFBpeGVscyxtaW5WYWx1ZTppLm1pblZhbHVlLG1heFZhbHVlOm4ucGl4ZWxzLm1heFZhbHVlLG5vRGF0YVZhbHVlOmh9O3JldHVybiBpLnJlc3VsdE1hc2smJihvLm1hc2tEYXRhPWkucmVzdWx0TWFzaykscy5yZXR1cm5FbmNvZGVkTWFzayYmbi5tYXNrJiYoby5lbmNvZGVkTWFza0RhdGE9bi5tYXNrLmJpdHNldD9uLm1hc2suYml0c2V0Om51bGwpLHMucmV0dXJuRmlsZUluZm8mJihvLmZpbGVJbmZvPWsobikscy5jb21wdXRlVXNlZEJpdERlcHRocyYmKG8uZmlsZUluZm8uYml0RGVwdGhzPVUobikpKSxvfTt2YXIgcD1mdW5jdGlvbihyLHMsdCxuLGgpe3ZhciBpPTAsbz1yLnBpeGVscy5udW1CbG9ja3NYLGM9ci5waXhlbHMubnVtQmxvY2tzWSx1PU1hdGguZmxvb3Ioci53aWR0aC9vKSxtPU1hdGguZmxvb3Ioci5oZWlnaHQvYyksdz0yKnIubWF4WkVycm9yLGw9TnVtYmVyLk1BWF9WQUxVRSxmO3Q9dHx8KHIubWFzaz9yLm1hc2suYml0c2V0Om51bGwpO3ZhciBnLE07Zz1uZXcgcyhyLndpZHRoKnIuaGVpZ2h0KSxoJiZ0JiYoTT1uZXcgVWludDhBcnJheShyLndpZHRoKnIuaGVpZ2h0KSk7Zm9yKHZhciBWPW5ldyBGbG9hdDMyQXJyYXkodSptKSxkLHksST0wO0k8PWM7SSsrKXt2YXIgej1JIT09Yz9tOnIuaGVpZ2h0JWM7aWYoeiE9PTApZm9yKHZhciB4PTA7eDw9bzt4Kyspe3ZhciB2PXghPT1vP3U6ci53aWR0aCVvO2lmKHYhPT0wKXt2YXIgRD1JKnIud2lkdGgqbSt4KnUsVD1yLndpZHRoLXYsUz1yLnBpeGVscy5ibG9ja3NbaV0sQixMLEY7Uy5lbmNvZGluZzwyPyhTLmVuY29kaW5nPT09MD9CPVMucmF3RGF0YTooZShTLnN0dWZmZWREYXRhLFMuYml0c1BlclBpeGVsLFMubnVtVmFsaWRQaXhlbHMsUy5vZmZzZXQsdyxWLHIucGl4ZWxzLm1heFZhbHVlKSxCPVYpLEw9MCk6Uy5lbmNvZGluZz09PTI/Rj0wOkY9Uy5vZmZzZXQ7dmFyIGI7aWYodClmb3IoeT0wO3k8ejt5Kyspe2ZvcihEJjcmJihiPXRbRD4+M10sYjw8PUQmNyksZD0wO2Q8djtkKyspRCY3fHwoYj10W0Q+PjNdKSxiJjEyOD8oTSYmKE1bRF09MSksZj1TLmVuY29kaW5nPDI/QltMKytdOkYsbD1sPmY/ZjpsLGdbRCsrXT1mKTooTSYmKE1bRF09MCksZ1tEKytdPW4pLGI8PD0xO0QrPVR9ZWxzZSBpZihTLmVuY29kaW5nPDIpZm9yKHk9MDt5PHo7eSsrKXtmb3IoZD0wO2Q8djtkKyspZj1CW0wrK10sbD1sPmY/ZjpsLGdbRCsrXT1mO0QrPVR9ZWxzZSBmb3IobD1sPkY/RjpsLHk9MDt5PHo7eSsrKXtmb3IoZD0wO2Q8djtkKyspZ1tEKytdPUY7RCs9VH1pZihTLmVuY29kaW5nPT09MSYmTCE9PVMubnVtVmFsaWRQaXhlbHMpdGhyb3ciQmxvY2sgYW5kIE1hc2sgZG8gbm90IG1hdGNoIjtpKyt9fX1yZXR1cm57cmVzdWx0UGl4ZWxzOmcscmVzdWx0TWFzazpNLG1pblZhbHVlOmx9fSxrPWZ1bmN0aW9uKHIpe3JldHVybntmaWxlSWRlbnRpZmllclN0cmluZzpyLmZpbGVJZGVudGlmaWVyU3RyaW5nLGZpbGVWZXJzaW9uOnIuZmlsZVZlcnNpb24saW1hZ2VUeXBlOnIuaW1hZ2VUeXBlLGhlaWdodDpyLmhlaWdodCx3aWR0aDpyLndpZHRoLG1heFpFcnJvcjpyLm1heFpFcnJvcixlb2ZPZmZzZXQ6ci5lb2ZPZmZzZXQsbWFzazpyLm1hc2s/e251bUJsb2Nrc1g6ci5tYXNrLm51bUJsb2Nrc1gsbnVtQmxvY2tzWTpyLm1hc2subnVtQmxvY2tzWSxudW1CeXRlczpyLm1hc2subnVtQnl0ZXMsbWF4VmFsdWU6ci5tYXNrLm1heFZhbHVlfTpudWxsLHBpeGVsczp7bnVtQmxvY2tzWDpyLnBpeGVscy5udW1CbG9ja3NYLG51bUJsb2Nrc1k6ci5waXhlbHMubnVtQmxvY2tzWSxudW1CeXRlczpyLnBpeGVscy5udW1CeXRlcyxtYXhWYWx1ZTpyLnBpeGVscy5tYXhWYWx1ZSxub0RhdGFWYWx1ZTpyLm5vRGF0YVZhbHVlfX19LFU9ZnVuY3Rpb24ocil7Zm9yKHZhciBzPXIucGl4ZWxzLm51bUJsb2Nrc1gqci5waXhlbHMubnVtQmxvY2tzWSx0PXt9LG49MDtuPHM7bisrKXt2YXIgaD1yLnBpeGVscy5ibG9ja3Nbbl07aC5lbmNvZGluZz09PTA/dC5mbG9hdDMyPSEwOmguZW5jb2Rpbmc9PT0xP3RbaC5iaXRzUGVyUGl4ZWxdPSEwOnRbMF09ITB9cmV0dXJuIE9iamVjdC5rZXlzKHQpfSxhPWZ1bmN0aW9uKHIscyx0KXt2YXIgbj17fSxoPW5ldyBVaW50OEFycmF5KHIscywxMCk7aWYobi5maWxlSWRlbnRpZmllclN0cmluZz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsaCksbi5maWxlSWRlbnRpZmllclN0cmluZy50cmltKCkhPT0iQ250WkltYWdlIil0aHJvdyJVbmV4cGVjdGVkIGZpbGUgaWRlbnRpZmllciBzdHJpbmc6ICIrbi5maWxlSWRlbnRpZmllclN0cmluZztzKz0xMDt2YXIgaT1uZXcgRGF0YVZpZXcocixzLDI0KTtpZihuLmZpbGVWZXJzaW9uPWkuZ2V0SW50MzIoMCwhMCksbi5pbWFnZVR5cGU9aS5nZXRJbnQzMig0LCEwKSxuLmhlaWdodD1pLmdldFVpbnQzMig4LCEwKSxuLndpZHRoPWkuZ2V0VWludDMyKDEyLCEwKSxuLm1heFpFcnJvcj1pLmdldEZsb2F0NjQoMTYsITApLHMrPTI0LCF0KWlmKGk9bmV3IERhdGFWaWV3KHIscywxNiksbi5tYXNrPXt9LG4ubWFzay5udW1CbG9ja3NZPWkuZ2V0VWludDMyKDAsITApLG4ubWFzay5udW1CbG9ja3NYPWkuZ2V0VWludDMyKDQsITApLG4ubWFzay5udW1CeXRlcz1pLmdldFVpbnQzMig4LCEwKSxuLm1hc2subWF4VmFsdWU9aS5nZXRGbG9hdDMyKDEyLCEwKSxzKz0xNixuLm1hc2subnVtQnl0ZXM+MCl7dmFyIG89bmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKG4ud2lkdGgqbi5oZWlnaHQvOCkpO2k9bmV3IERhdGFWaWV3KHIscyxuLm1hc2subnVtQnl0ZXMpO3ZhciBjPWkuZ2V0SW50MTYoMCwhMCksdT0yLG09MDtkb3tpZihjPjApZm9yKDtjLS07KW9bbSsrXT1pLmdldFVpbnQ4KHUrKyk7ZWxzZXt2YXIgdz1pLmdldFVpbnQ4KHUrKyk7Zm9yKGM9LWM7Yy0tOylvW20rK109d31jPWkuZ2V0SW50MTYodSwhMCksdSs9Mn13aGlsZSh1PG4ubWFzay5udW1CeXRlcyk7aWYoYyE9PS0zMjc2OHx8bTxvLmxlbmd0aCl0aHJvdyJVbmV4cGVjdGVkIGVuZCBvZiBtYXNrIFJMRSBlbmNvZGluZyI7bi5tYXNrLmJpdHNldD1vLHMrPW4ubWFzay5udW1CeXRlc31lbHNlIG4ubWFzay5udW1CeXRlc3xuLm1hc2subnVtQmxvY2tzWXxuLm1hc2subWF4VmFsdWV8fChuLm1hc2suYml0c2V0PW5ldyBVaW50OEFycmF5KE1hdGguY2VpbChuLndpZHRoKm4uaGVpZ2h0LzgpKSk7aT1uZXcgRGF0YVZpZXcocixzLDE2KSxuLnBpeGVscz17fSxuLnBpeGVscy5udW1CbG9ja3NZPWkuZ2V0VWludDMyKDAsITApLG4ucGl4ZWxzLm51bUJsb2Nrc1g9aS5nZXRVaW50MzIoNCwhMCksbi5waXhlbHMubnVtQnl0ZXM9aS5nZXRVaW50MzIoOCwhMCksbi5waXhlbHMubWF4VmFsdWU9aS5nZXRGbG9hdDMyKDEyLCEwKSxzKz0xNjt2YXIgbD1uLnBpeGVscy5udW1CbG9ja3NYLGY9bi5waXhlbHMubnVtQmxvY2tzWSxnPWwrKG4ud2lkdGglbD4wPzE6MCksTT1mKyhuLmhlaWdodCVmPjA/MTowKTtuLnBpeGVscy5ibG9ja3M9bmV3IEFycmF5KGcqTSk7Zm9yKHZhciBWPTAsZD0wO2Q8TTtkKyspZm9yKHZhciB5PTA7eTxnO3krKyl7dmFyIEk9MCx6PXIuYnl0ZUxlbmd0aC1zO2k9bmV3IERhdGFWaWV3KHIscyxNYXRoLm1pbigxMCx6KSk7dmFyIHg9e307bi5waXhlbHMuYmxvY2tzW1YrK109eDt2YXIgdj1pLmdldFVpbnQ4KDApO2lmKEkrKyx4LmVuY29kaW5nPXYmNjMseC5lbmNvZGluZz4zKXRocm93IkludmFsaWQgYmxvY2sgZW5jb2RpbmcgKCIreC5lbmNvZGluZysiKSI7aWYoeC5lbmNvZGluZz09PTIpe3MrKztjb250aW51ZX1pZih2IT09MCYmdiE9PTIpe2lmKHY+Pj02LHgub2Zmc2V0VHlwZT12LHY9PT0yKXgub2Zmc2V0PWkuZ2V0SW50OCgxKSxJKys7ZWxzZSBpZih2PT09MSl4Lm9mZnNldD1pLmdldEludDE2KDEsITApLEkrPTI7ZWxzZSBpZih2PT09MCl4Lm9mZnNldD1pLmdldEZsb2F0MzIoMSwhMCksSSs9NDtlbHNlIHRocm93IkludmFsaWQgYmxvY2sgb2Zmc2V0IHR5cGUiO2lmKHguZW5jb2Rpbmc9PT0xKWlmKHY9aS5nZXRVaW50OChJKSxJKysseC5iaXRzUGVyUGl4ZWw9diY2Myx2Pj49Nix4Lm51bVZhbGlkUGl4ZWxzVHlwZT12LHY9PT0yKXgubnVtVmFsaWRQaXhlbHM9aS5nZXRVaW50OChJKSxJKys7ZWxzZSBpZih2PT09MSl4Lm51bVZhbGlkUGl4ZWxzPWkuZ2V0VWludDE2KEksITApLEkrPTI7ZWxzZSBpZih2PT09MCl4Lm51bVZhbGlkUGl4ZWxzPWkuZ2V0VWludDMyKEksITApLEkrPTQ7ZWxzZSB0aHJvdyJJbnZhbGlkIHZhbGlkIHBpeGVsIGNvdW50IHR5cGUifWlmKHMrPUkseC5lbmNvZGluZyE9PTMpe3ZhciBELFQ7aWYoeC5lbmNvZGluZz09PTApe3ZhciBTPShuLnBpeGVscy5udW1CeXRlcy0xKS80O2lmKFMhPT1NYXRoLmZsb29yKFMpKXRocm93InVuY29tcHJlc3NlZCBibG9jayBoYXMgaW52YWxpZCBsZW5ndGgiO0Q9bmV3IEFycmF5QnVmZmVyKFMqNCksVD1uZXcgVWludDhBcnJheShEKSxULnNldChuZXcgVWludDhBcnJheShyLHMsUyo0KSk7dmFyIEI9bmV3IEZsb2F0MzJBcnJheShEKTt4LnJhd0RhdGE9QixzKz1TKjR9ZWxzZSBpZih4LmVuY29kaW5nPT09MSl7dmFyIEw9TWF0aC5jZWlsKHgubnVtVmFsaWRQaXhlbHMqeC5iaXRzUGVyUGl4ZWwvOCksRj1NYXRoLmNlaWwoTC80KTtEPW5ldyBBcnJheUJ1ZmZlcihGKjQpLFQ9bmV3IFVpbnQ4QXJyYXkoRCksVC5zZXQobmV3IFVpbnQ4QXJyYXkocixzLEwpKSx4LnN0dWZmZWREYXRhPW5ldyBVaW50MzJBcnJheShEKSxzKz1MfX19cmV0dXJuIG4uZW9mT2Zmc2V0PXMsbn0sZT1mdW5jdGlvbihyLHMsdCxuLGgsaSxvKXt2YXIgYz0oMTw8cyktMSx1PTAsbSx3PTAsbCxmLGc9TWF0aC5jZWlsKChvLW4pL2gpLE09ci5sZW5ndGgqNC1NYXRoLmNlaWwocyp0LzgpO2ZvcihyW3IubGVuZ3RoLTFdPDw9OCpNLG09MDttPHQ7bSsrKXtpZih3PT09MCYmKGY9clt1KytdLHc9MzIpLHc+PXMpbD1mPj4+dy1zJmMsdy09cztlbHNle3ZhciBWPXMtdztsPShmJmMpPDxWJmMsZj1yW3UrK10sdz0zMi1WLGwrPWY+Pj53fWlbbV09bDxnP24rbCpoOm99cmV0dXJuIGl9O3JldHVybiBBfSgpLHJlPWZ1bmN0aW9uKCl7dmFyIEE9e3Vuc3R1ZmY6ZnVuY3Rpb24oYSxlLHIscyx0LG4saCxpKXt2YXIgbz0oMTw8ciktMSxjPTAsdSxtPTAsdyxsLGYsZyxNPWEubGVuZ3RoKjQtTWF0aC5jZWlsKHIqcy84KTtpZihhW2EubGVuZ3RoLTFdPDw9OCpNLHQpZm9yKHU9MDt1PHM7dSsrKW09PT0wJiYobD1hW2MrK10sbT0zMiksbT49cj8odz1sPj4+bS1yJm8sbS09cik6KGY9ci1tLHc9KGwmbyk8PGYmbyxsPWFbYysrXSxtPTMyLWYsdys9bD4+Pm0pLGVbdV09dFt3XTtlbHNlIGZvcihnPU1hdGguY2VpbCgoaS1uKS9oKSx1PTA7dTxzO3UrKyltPT09MCYmKGw9YVtjKytdLG09MzIpLG0+PXI/KHc9bD4+Pm0tciZvLG0tPXIpOihmPXItbSx3PShsJm8pPDxmJm8sbD1hW2MrK10sbT0zMi1mLHcrPWw+Pj5tKSxlW3VdPXc8Zz9uK3cqaDppfSx1bnN0dWZmTFVUOmZ1bmN0aW9uKGEsZSxyLHMsdCxuKXt2YXIgaD0oMTw8ZSktMSxpPTAsbz0wLGM9MCx1PTAsbT0wLHcsbD1bXSxmPWEubGVuZ3RoKjQtTWF0aC5jZWlsKGUqci84KTthW2EubGVuZ3RoLTFdPDw9OCpmO3ZhciBnPU1hdGguY2VpbCgobi1zKS90KTtmb3Iobz0wO288cjtvKyspdT09PTAmJih3PWFbaSsrXSx1PTMyKSx1Pj1lPyhtPXc+Pj51LWUmaCx1LT1lKTooYz1lLXUsbT0odyZoKTw8YyZoLHc9YVtpKytdLHU9MzItYyxtKz13Pj4+dSksbFtvXT1tPGc/cyttKnQ6bjtyZXR1cm4gbC51bnNoaWZ0KHMpLGx9LHVuc3R1ZmYyOmZ1bmN0aW9uKGEsZSxyLHMsdCxuLGgsaSl7dmFyIG89KDE8PHIpLTEsYz0wLHUsbT0wLHc9MCxsLGYsZztpZih0KWZvcih1PTA7dTxzO3UrKyltPT09MCYmKGY9YVtjKytdLG09MzIsdz0wKSxtPj1yPyhsPWY+Pj53Jm8sbS09cix3Kz1yKTooZz1yLW0sbD1mPj4+dyZvLGY9YVtjKytdLG09MzItZyxsfD0oZiYoMTw8ZyktMSk8PHItZyx3PWcpLGVbdV09dFtsXTtlbHNle3ZhciBNPU1hdGguY2VpbCgoaS1uKS9oKTtmb3IodT0wO3U8czt1KyspbT09PTAmJihmPWFbYysrXSxtPTMyLHc9MCksbT49cj8obD1mPj4+dyZvLG0tPXIsdys9cik6KGc9ci1tLGw9Zj4+PncmbyxmPWFbYysrXSxtPTMyLWcsbHw9KGYmKDE8PGcpLTEpPDxyLWcsdz1nKSxlW3VdPWw8TT9uK2wqaDppfXJldHVybiBlfSx1bnN0dWZmTFVUMjpmdW5jdGlvbihhLGUscixzLHQsbil7dmFyIGg9KDE8PGUpLTEsaT0wLG89MCxjPTAsdT0wLG09MCx3PTAsbCxmPVtdLGc9TWF0aC5jZWlsKChuLXMpL3QpO2ZvcihvPTA7bzxyO28rKyl1PT09MCYmKGw9YVtpKytdLHU9MzIsdz0wKSx1Pj1lPyhtPWw+Pj53JmgsdS09ZSx3Kz1lKTooYz1lLXUsbT1sPj4+dyZoLGw9YVtpKytdLHU9MzItYyxtfD0obCYoMTw8YyktMSk8PGUtYyx3PWMpLGZbb109bTxnP3MrbSp0Om47cmV0dXJuIGYudW5zaGlmdChzKSxmfSxvcmlnaW5hbFVuc3R1ZmY6ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ9KDE8PHIpLTEsbj0wLGgsaT0wLG8sYyx1LG09YS5sZW5ndGgqNC1NYXRoLmNlaWwocipzLzgpO2ZvcihhW2EubGVuZ3RoLTFdPDw9OCptLGg9MDtoPHM7aCsrKWk9PT0wJiYoYz1hW24rK10saT0zMiksaT49cj8obz1jPj4+aS1yJnQsaS09cik6KHU9ci1pLG89KGMmdCk8PHUmdCxjPWFbbisrXSxpPTMyLXUsbys9Yz4+PmkpLGVbaF09bztyZXR1cm4gZX0sb3JpZ2luYWxVbnN0dWZmMjpmdW5jdGlvbihhLGUscixzKXt2YXIgdD0oMTw8ciktMSxuPTAsaCxpPTAsbz0wLGMsdSxtO2ZvcihoPTA7aDxzO2grKylpPT09MCYmKHU9YVtuKytdLGk9MzIsbz0wKSxpPj1yPyhjPXU+Pj5vJnQsaS09cixvKz1yKToobT1yLWksYz11Pj4+byZ0LHU9YVtuKytdLGk9MzItbSxjfD0odSYoMTw8bSktMSk8PHItbSxvPW0pLGVbaF09YztyZXR1cm4gZX19LHA9e0hVRkZNQU5fTFVUX0JJVFNfTUFYOjEyLGNvbXB1dGVDaGVja3N1bUZsZXRjaGVyMzI6ZnVuY3Rpb24oYSl7Zm9yKHZhciBlPTY1NTM1LHI9NjU1MzUscz1hLmxlbmd0aCx0PU1hdGguZmxvb3Iocy8yKSxuPTA7dDspe3ZhciBoPXQ+PTM1OT8zNTk6dDt0LT1oO2RvIGUrPWFbbisrXTw8OCxyKz1lKz1hW24rK107d2hpbGUoLS1oKTtlPShlJjY1NTM1KSsoZT4+PjE2KSxyPShyJjY1NTM1KSsocj4+PjE2KX1yZXR1cm4gcyYxJiYocis9ZSs9YVtuXTw8OCksZT0oZSY2NTUzNSkrKGU+Pj4xNikscj0ociY2NTUzNSkrKHI+Pj4xNiksKHI8PDE2fGUpPj4+MH0scmVhZEhlYWRlckluZm86ZnVuY3Rpb24oYSxlKXt2YXIgcj1lLnB0cixzPW5ldyBVaW50OEFycmF5KGEsciw2KSx0PXt9O2lmKHQuZmlsZUlkZW50aWZpZXJTdHJpbmc9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLHMpLHQuZmlsZUlkZW50aWZpZXJTdHJpbmcubGFzdEluZGV4T2YoIkxlcmMyIiwwKSE9PTApdGhyb3ciVW5leHBlY3RlZCBmaWxlIGlkZW50aWZpZXIgc3RyaW5nIChleHBlY3QgTGVyYzIgKTogIit0LmZpbGVJZGVudGlmaWVyU3RyaW5nO3IrPTY7dmFyIG49bmV3IERhdGFWaWV3KGEsciw4KSxoPW4uZ2V0SW50MzIoMCwhMCk7dC5maWxlVmVyc2lvbj1oLHIrPTQsaD49MyYmKHQuY2hlY2tzdW09bi5nZXRVaW50MzIoNCwhMCkscis9NCksbj1uZXcgRGF0YVZpZXcoYSxyLDEyKSx0LmhlaWdodD1uLmdldFVpbnQzMigwLCEwKSx0LndpZHRoPW4uZ2V0VWludDMyKDQsITApLHIrPTgsaD49ND8odC5udW1EaW1zPW4uZ2V0VWludDMyKDgsITApLHIrPTQpOnQubnVtRGltcz0xLG49bmV3IERhdGFWaWV3KGEsciw0MCksdC5udW1WYWxpZFBpeGVsPW4uZ2V0VWludDMyKDAsITApLHQubWljcm9CbG9ja1NpemU9bi5nZXRJbnQzMig0LCEwKSx0LmJsb2JTaXplPW4uZ2V0SW50MzIoOCwhMCksdC5pbWFnZVR5cGU9bi5nZXRJbnQzMigxMiwhMCksdC5tYXhaRXJyb3I9bi5nZXRGbG9hdDY0KDE2LCEwKSx0LnpNaW49bi5nZXRGbG9hdDY0KDI0LCEwKSx0LnpNYXg9bi5nZXRGbG9hdDY0KDMyLCEwKSxyKz00MCxlLmhlYWRlckluZm89dCxlLnB0cj1yO3ZhciBpLG87aWYoaD49MyYmKG89aD49ND81Mjo0OCxpPXRoaXMuY29tcHV0ZUNoZWNrc3VtRmxldGNoZXIzMihuZXcgVWludDhBcnJheShhLHItbyx0LmJsb2JTaXplLTE0KSksaSE9PXQuY2hlY2tzdW0pKXRocm93IkNoZWNrc3VtIGZhaWxlZC4iO3JldHVybiEwfSxjaGVja01pbk1heFJhbmdlczpmdW5jdGlvbihhLGUpe3ZhciByPWUuaGVhZGVySW5mbyxzPXRoaXMuZ2V0RGF0YVR5cGVBcnJheShyLmltYWdlVHlwZSksdD1yLm51bURpbXMqdGhpcy5nZXREYXRhVHlwZVNpemUoci5pbWFnZVR5cGUpLG49dGhpcy5yZWFkU3ViQXJyYXkoYSxlLnB0cixzLHQpLGg9dGhpcy5yZWFkU3ViQXJyYXkoYSxlLnB0cit0LHMsdCk7ZS5wdHIrPTIqdDt2YXIgaSxvPSEwO2ZvcihpPTA7aTxyLm51bURpbXM7aSsrKWlmKG5baV0hPT1oW2ldKXtvPSExO2JyZWFrfXJldHVybiByLm1pblZhbHVlcz1uLHIubWF4VmFsdWVzPWgsb30scmVhZFN1YkFycmF5OmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0O2lmKHI9PT1VaW50OEFycmF5KXQ9bmV3IFVpbnQ4QXJyYXkoYSxlLHMpO2Vsc2V7dmFyIG49bmV3IEFycmF5QnVmZmVyKHMpLGg9bmV3IFVpbnQ4QXJyYXkobik7aC5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLHMpKSx0PW5ldyByKG4pfXJldHVybiB0fSxyZWFkTWFzazpmdW5jdGlvbihhLGUpe3ZhciByPWUucHRyLHM9ZS5oZWFkZXJJbmZvLHQ9cy53aWR0aCpzLmhlaWdodCxuPXMubnVtVmFsaWRQaXhlbCxoPW5ldyBEYXRhVmlldyhhLHIsNCksaT17fTtpZihpLm51bUJ5dGVzPWguZ2V0VWludDMyKDAsITApLHIrPTQsKG49PT0wfHx0PT09bikmJmkubnVtQnl0ZXMhPT0wKXRocm93ImludmFsaWQgbWFzayI7dmFyIG8sYztpZihuPT09MClvPW5ldyBVaW50OEFycmF5KE1hdGguY2VpbCh0LzgpKSxpLmJpdHNldD1vLGM9bmV3IFVpbnQ4QXJyYXkodCksZS5waXhlbHMucmVzdWx0TWFzaz1jLHIrPWkubnVtQnl0ZXM7ZWxzZSBpZihpLm51bUJ5dGVzPjApe289bmV3IFVpbnQ4QXJyYXkoTWF0aC5jZWlsKHQvOCkpLGg9bmV3IERhdGFWaWV3KGEscixpLm51bUJ5dGVzKTt2YXIgdT1oLmdldEludDE2KDAsITApLG09Mix3PTAsbD0wO2Rve2lmKHU+MClmb3IoO3UtLTspb1t3KytdPWguZ2V0VWludDgobSsrKTtlbHNlIGZvcihsPWguZ2V0VWludDgobSsrKSx1PS11O3UtLTspb1t3KytdPWw7dT1oLmdldEludDE2KG0sITApLG0rPTJ9d2hpbGUobTxpLm51bUJ5dGVzKTtpZih1IT09LTMyNzY4fHx3PG8ubGVuZ3RoKXRocm93IlVuZXhwZWN0ZWQgZW5kIG9mIG1hc2sgUkxFIGVuY29kaW5nIjtjPW5ldyBVaW50OEFycmF5KHQpO3ZhciBmPTAsZz0wO2ZvcihnPTA7Zzx0O2crKylnJjc/KGY9b1tnPj4zXSxmPDw9ZyY3KTpmPW9bZz4+M10sZiYxMjgmJihjW2ddPTEpO2UucGl4ZWxzLnJlc3VsdE1hc2s9YyxpLmJpdHNldD1vLHIrPWkubnVtQnl0ZXN9cmV0dXJuIGUucHRyPXIsZS5tYXNrPWksITB9LHJlYWREYXRhT25lU3dlZXA6ZnVuY3Rpb24oYSxlLHIscyl7dmFyIHQ9ZS5wdHIsbj1lLmhlYWRlckluZm8saD1uLm51bURpbXMsaT1uLndpZHRoKm4uaGVpZ2h0LG89bi5pbWFnZVR5cGUsYz1uLm51bVZhbGlkUGl4ZWwqcC5nZXREYXRhVHlwZVNpemUobykqaCx1LG09ZS5waXhlbHMucmVzdWx0TWFzaztpZihyPT09VWludDhBcnJheSl1PW5ldyBVaW50OEFycmF5KGEsdCxjKTtlbHNle3ZhciB3PW5ldyBBcnJheUJ1ZmZlcihjKSxsPW5ldyBVaW50OEFycmF5KHcpO2wuc2V0KG5ldyBVaW50OEFycmF5KGEsdCxjKSksdT1uZXcgcih3KX1pZih1Lmxlbmd0aD09PWkqaClzP2UucGl4ZWxzLnJlc3VsdFBpeGVscz1wLnN3YXBEaW1lbnNpb25PcmRlcih1LGksaCxyLCEwKTplLnBpeGVscy5yZXN1bHRQaXhlbHM9dTtlbHNle2UucGl4ZWxzLnJlc3VsdFBpeGVscz1uZXcgcihpKmgpO3ZhciBmPTAsZz0wLE09MCxWPTA7aWYoaD4xKXtpZihzKXtmb3IoZz0wO2c8aTtnKyspaWYobVtnXSlmb3IoVj1nLE09MDtNPGg7TSsrLFYrPWkpZS5waXhlbHMucmVzdWx0UGl4ZWxzW1ZdPXVbZisrXX1lbHNlIGZvcihnPTA7ZzxpO2crKylpZihtW2ddKWZvcihWPWcqaCxNPTA7TTxoO00rKyllLnBpeGVscy5yZXN1bHRQaXhlbHNbVitNXT11W2YrK119ZWxzZSBmb3IoZz0wO2c8aTtnKyspbVtnXSYmKGUucGl4ZWxzLnJlc3VsdFBpeGVsc1tnXT11W2YrK10pfXJldHVybiB0Kz1jLGUucHRyPXQsITB9LHJlYWRIdWZmbWFuVHJlZTpmdW5jdGlvbihhLGUpe3ZhciByPXRoaXMuSFVGRk1BTl9MVVRfQklUU19NQVgscz1uZXcgRGF0YVZpZXcoYSxlLnB0ciwxNik7ZS5wdHIrPTE2O3ZhciB0PXMuZ2V0SW50MzIoMCwhMCk7aWYodDwyKXRocm93InVuc3VwcG9ydGVkIEh1ZmZtYW4gdmVyc2lvbiI7dmFyIG49cy5nZXRJbnQzMig0LCEwKSxoPXMuZ2V0SW50MzIoOCwhMCksaT1zLmdldEludDMyKDEyLCEwKTtpZihoPj1pKXJldHVybiExO3ZhciBvPW5ldyBVaW50MzJBcnJheShpLWgpO3AuZGVjb2RlQml0cyhhLGUsbyk7dmFyIGM9W10sdSxtLHcsbDtmb3IodT1oO3U8aTt1KyspbT11LSh1PG4/MDpuKSxjW21dPXtmaXJzdDpvW3UtaF0sc2Vjb25kOm51bGx9O3ZhciBmPWEuYnl0ZUxlbmd0aC1lLnB0cixnPU1hdGguY2VpbChmLzQpLE09bmV3IEFycmF5QnVmZmVyKGcqNCksVj1uZXcgVWludDhBcnJheShNKTtWLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLGYpKTt2YXIgZD1uZXcgVWludDMyQXJyYXkoTSkseT0wLEksej0wO2ZvcihJPWRbMF0sdT1oO3U8aTt1KyspbT11LSh1PG4/MDpuKSxsPWNbbV0uZmlyc3QsbD4wJiYoY1ttXS5zZWNvbmQ9STw8eT4+PjMyLWwsMzIteT49bD8oeSs9bCx5PT09MzImJih5PTAseisrLEk9ZFt6XSkpOih5Kz1sLTMyLHorKyxJPWRbel0sY1ttXS5zZWNvbmR8PUk+Pj4zMi15KSk7dmFyIHg9MCx2PTAsRD1uZXcgaztmb3IodT0wO3U8Yy5sZW5ndGg7dSsrKWNbdV0hPT12b2lkIDAmJih4PU1hdGgubWF4KHgsY1t1XS5maXJzdCkpO3g+PXI/dj1yOnY9eDt2YXIgVD1bXSxTLEIsTCxGLGIsQztmb3IodT1oO3U8aTt1KyspaWYobT11LSh1PG4/MDpuKSxsPWNbbV0uZmlyc3QsbD4wKWlmKFM9W2wsbV0sbDw9dilmb3IoQj1jW21dLnNlY29uZDw8di1sLEw9MTw8di1sLHc9MDt3PEw7dysrKVRbQnx3XT1TO2Vsc2UgZm9yKEI9Y1ttXS5zZWNvbmQsQz1ELEY9bC0xO0Y+PTA7Ri0tKWI9Qj4+PkYmMSxiPyhDLnJpZ2h0fHwoQy5yaWdodD1uZXcgayksQz1DLnJpZ2h0KTooQy5sZWZ0fHwoQy5sZWZ0PW5ldyBrKSxDPUMubGVmdCksRj09PTAmJiFDLnZhbCYmKEMudmFsPVNbMV0pO3JldHVybntkZWNvZGVMdXQ6VCxudW1CaXRzTFVUUWljazp2LG51bUJpdHNMVVQ6eCx0cmVlOkQsc3R1ZmZlZERhdGE6ZCxzcmNQdHI6eixiaXRQb3M6eX19LHJlYWRIdWZmbWFuOmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0PWUuaGVhZGVySW5mbyxuPXQubnVtRGltcyxoPWUuaGVhZGVySW5mby5oZWlnaHQsaT1lLmhlYWRlckluZm8ud2lkdGgsbz1pKmgsYz10aGlzLnJlYWRIdWZmbWFuVHJlZShhLGUpLHU9Yy5kZWNvZGVMdXQsbT1jLnRyZWUsdz1jLnN0dWZmZWREYXRhLGw9Yy5zcmNQdHIsZj1jLmJpdFBvcyxnPWMubnVtQml0c0xVVFFpY2ssTT1jLm51bUJpdHNMVVQsVj1lLmhlYWRlckluZm8uaW1hZ2VUeXBlPT09MD8xMjg6MCxkLHksSSx6PWUucGl4ZWxzLnJlc3VsdE1hc2sseCx2LEQsVCxTLEIsTCxGPTA7Zj4wJiYobCsrLGY9MCk7dmFyIGI9d1tsXSxDPWUuZW5jb2RlTW9kZT09PTEsUj1uZXcgcihvKm4pLE89UixYO2lmKG48Mnx8Qyl7Zm9yKFg9MDtYPG47WCsrKWlmKG4+MSYmKE89bmV3IHIoUi5idWZmZXIsbypYLG8pLEY9MCksZS5oZWFkZXJJbmZvLm51bVZhbGlkUGl4ZWw9PT1pKmgpZm9yKEI9MCxUPTA7VDxoO1QrKylmb3IoUz0wO1M8aTtTKyssQisrKXtpZih5PTAseD1iPDxmPj4+MzItZyx2PXgsMzItZjxnJiYoeHw9d1tsKzFdPj4+NjQtZi1nLHY9eCksdVt2XSl5PXVbdl1bMV0sZis9dVt2XVswXTtlbHNlIGZvcih4PWI8PGY+Pj4zMi1NLHY9eCwzMi1mPE0mJih4fD13W2wrMV0+Pj42NC1mLU0sdj14KSxkPW0sTD0wO0w8TTtMKyspaWYoRD14Pj4+TS1MLTEmMSxkPUQ/ZC5yaWdodDpkLmxlZnQsIShkLmxlZnR8fGQucmlnaHQpKXt5PWQudmFsLGY9ZitMKzE7YnJlYWt9Zj49MzImJihmLT0zMixsKyssYj13W2xdKSxJPXktVixDPyhTPjA/SSs9RjpUPjA/SSs9T1tCLWldOkkrPUYsSSY9MjU1LE9bQl09SSxGPUkpOk9bQl09SX1lbHNlIGZvcihCPTAsVD0wO1Q8aDtUKyspZm9yKFM9MDtTPGk7UysrLEIrKylpZih6W0JdKXtpZih5PTAseD1iPDxmPj4+MzItZyx2PXgsMzItZjxnJiYoeHw9d1tsKzFdPj4+NjQtZi1nLHY9eCksdVt2XSl5PXVbdl1bMV0sZis9dVt2XVswXTtlbHNlIGZvcih4PWI8PGY+Pj4zMi1NLHY9eCwzMi1mPE0mJih4fD13W2wrMV0+Pj42NC1mLU0sdj14KSxkPW0sTD0wO0w8TTtMKyspaWYoRD14Pj4+TS1MLTEmMSxkPUQ/ZC5yaWdodDpkLmxlZnQsIShkLmxlZnR8fGQucmlnaHQpKXt5PWQudmFsLGY9ZitMKzE7YnJlYWt9Zj49MzImJihmLT0zMixsKyssYj13W2xdKSxJPXktVixDPyhTPjAmJnpbQi0xXT9JKz1GOlQ+MCYmeltCLWldP0krPU9bQi1pXTpJKz1GLEkmPTI1NSxPW0JdPUksRj1JKTpPW0JdPUl9fWVsc2UgZm9yKEI9MCxUPTA7VDxoO1QrKylmb3IoUz0wO1M8aTtTKyspaWYoQj1UKmkrUywhenx8eltCXSlmb3IoWD0wO1g8bjtYKyssQis9byl7aWYoeT0wLHg9Yjw8Zj4+PjMyLWcsdj14LDMyLWY8ZyYmKHh8PXdbbCsxXT4+PjY0LWYtZyx2PXgpLHVbdl0peT11W3ZdWzFdLGYrPXVbdl1bMF07ZWxzZSBmb3IoeD1iPDxmPj4+MzItTSx2PXgsMzItZjxNJiYoeHw9d1tsKzFdPj4+NjQtZi1NLHY9eCksZD1tLEw9MDtMPE07TCsrKWlmKEQ9eD4+Pk0tTC0xJjEsZD1EP2QucmlnaHQ6ZC5sZWZ0LCEoZC5sZWZ0fHxkLnJpZ2h0KSl7eT1kLnZhbCxmPWYrTCsxO2JyZWFrfWY+PTMyJiYoZi09MzIsbCsrLGI9d1tsXSksST15LVYsT1tCXT1JfWUucHRyPWUucHRyKyhsKzEpKjQrKGY+MD80OjApLGUucGl4ZWxzLnJlc3VsdFBpeGVscz1SLG4+MSYmIXMmJihlLnBpeGVscy5yZXN1bHRQaXhlbHM9cC5zd2FwRGltZW5zaW9uT3JkZXIoUixvLG4scikpfSxkZWNvZGVCaXRzOmZ1bmN0aW9uKGEsZSxyLHMsdCl7e3ZhciBuPWUuaGVhZGVySW5mbyxoPW4uZmlsZVZlcnNpb24saT0wLG89YS5ieXRlTGVuZ3RoLWUucHRyPj01PzU6YS5ieXRlTGVuZ3RoLWUucHRyLGM9bmV3IERhdGFWaWV3KGEsZS5wdHIsbyksdT1jLmdldFVpbnQ4KDApO2krKzt2YXIgbT11Pj42LHc9bT09PTA/NDozLW0sbD0odSYzMik+MCxmPXUmMzEsZz0wO2lmKHc9PT0xKWc9Yy5nZXRVaW50OChpKSxpKys7ZWxzZSBpZih3PT09MilnPWMuZ2V0VWludDE2KGksITApLGkrPTI7ZWxzZSBpZih3PT09NClnPWMuZ2V0VWludDMyKGksITApLGkrPTQ7ZWxzZSB0aHJvdyJJbnZhbGlkIHZhbGlkIHBpeGVsIGNvdW50IHR5cGUiO3ZhciBNPTIqbi5tYXhaRXJyb3IsVixkLHksSSx6LHgsdixELFQsUz1uLm51bURpbXM+MT9uLm1heFZhbHVlc1t0XTpuLnpNYXg7aWYobCl7Zm9yKGUuY291bnRlci5sdXQrKyxEPWMuZ2V0VWludDgoaSksaSsrLEk9TWF0aC5jZWlsKChELTEpKmYvOCksej1NYXRoLmNlaWwoSS80KSxkPW5ldyBBcnJheUJ1ZmZlcih6KjQpLHk9bmV3IFVpbnQ4QXJyYXkoZCksZS5wdHIrPWkseS5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLnB0cixJKSksdj1uZXcgVWludDMyQXJyYXkoZCksZS5wdHIrPUksVD0wO0QtMT4+PlQ7KVQrKztJPU1hdGguY2VpbChnKlQvOCksej1NYXRoLmNlaWwoSS80KSxkPW5ldyBBcnJheUJ1ZmZlcih6KjQpLHk9bmV3IFVpbnQ4QXJyYXkoZCkseS5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLnB0cixJKSksVj1uZXcgVWludDMyQXJyYXkoZCksZS5wdHIrPUksaD49Mz94PUEudW5zdHVmZkxVVDIodixmLEQtMSxzLE0sUyk6eD1BLnVuc3R1ZmZMVVQodixmLEQtMSxzLE0sUyksaD49Mz9BLnVuc3R1ZmYyKFYscixULGcseCk6QS51bnN0dWZmKFYscixULGcseCl9ZWxzZSBlLmNvdW50ZXIuYml0c3R1ZmZlcisrLFQ9ZixlLnB0cis9aSxUPjAmJihJPU1hdGguY2VpbChnKlQvOCksej1NYXRoLmNlaWwoSS80KSxkPW5ldyBBcnJheUJ1ZmZlcih6KjQpLHk9bmV3IFVpbnQ4QXJyYXkoZCkseS5zZXQobmV3IFVpbnQ4QXJyYXkoYSxlLnB0cixJKSksVj1uZXcgVWludDMyQXJyYXkoZCksZS5wdHIrPUksaD49Mz9zPT1udWxsP0Eub3JpZ2luYWxVbnN0dWZmMihWLHIsVCxnKTpBLnVuc3R1ZmYyKFYscixULGcsITEscyxNLFMpOnM9PW51bGw/QS5vcmlnaW5hbFVuc3R1ZmYoVixyLFQsZyk6QS51bnN0dWZmKFYscixULGcsITEscyxNLFMpKX19LHJlYWRUaWxlczpmdW5jdGlvbihhLGUscixzKXt2YXIgdD1lLmhlYWRlckluZm8sbj10LndpZHRoLGg9dC5oZWlnaHQsaT1uKmgsbz10Lm1pY3JvQmxvY2tTaXplLGM9dC5pbWFnZVR5cGUsdT1wLmdldERhdGFUeXBlU2l6ZShjKSxtPU1hdGguY2VpbChuL28pLHc9TWF0aC5jZWlsKGgvbyk7ZS5waXhlbHMubnVtQmxvY2tzWT13LGUucGl4ZWxzLm51bUJsb2Nrc1g9bSxlLnBpeGVscy5wdHI9MDt2YXIgbD0wLGY9MCxnPTAsTT0wLFY9MCxkPTAseT0wLEk9MCx6PTAseD0wLHY9MCxEPTAsVD0wLFM9MCxCPTAsTD0wLEYsYixDLFIsTyxYLEc9bmV3IHIobypvKSxsZT1oJW98fG8sdWU9biVvfHxvLEssUSxKPXQubnVtRGltcywkLEU9ZS5waXhlbHMucmVzdWx0TWFzayxZPWUucGl4ZWxzLnJlc3VsdFBpeGVscyxoZT10LmZpbGVWZXJzaW9uLFA9aGU+PTU/MTQ6MTUsXyxXPXQuek1heCxIO2ZvcihnPTA7Zzx3O2crKylmb3IoVj1nIT09dy0xP286bGUsTT0wO008bTtNKyspZm9yKGQ9TSE9PW0tMT9vOnVlLHY9ZypuKm8rTSpvLEQ9bi1kLCQ9MDskPEo7JCsrKXtpZihKPjE/KEg9WSx2PWcqbipvK00qbyxZPW5ldyByKGUucGl4ZWxzLnJlc3VsdFBpeGVscy5idWZmZXIsaSokKnUsaSksVz10Lm1heFZhbHVlc1skXSk6SD1udWxsLHk9YS5ieXRlTGVuZ3RoLWUucHRyLEY9bmV3IERhdGFWaWV3KGEsZS5wdHIsTWF0aC5taW4oMTAseSkpLGI9e30sTD0wLEk9Ri5nZXRVaW50OCgwKSxMKyssXz10LmZpbGVWZXJzaW9uPj01P0kmNDowLHo9ST4+NiYyNTUseD1JPj4yJlAseCE9PShNKm8+PjMmUCl8fF8mJiQ9PT0wKXRocm93ImludGVncml0eSBpc3N1ZSI7aWYoWD1JJjMsWD4zKXRocm93IGUucHRyKz1MLCJJbnZhbGlkIGJsb2NrIGVuY29kaW5nICgiK1grIikiO2lmKFg9PT0yKXtpZihfKWlmKEUpZm9yKGw9MDtsPFY7bCsrKWZvcihmPTA7ZjxkO2YrKylFW3ZdJiYoWVt2XT1IW3ZdKSx2Kys7ZWxzZSBmb3IobD0wO2w8VjtsKyspZm9yKGY9MDtmPGQ7ZisrKVlbdl09SFt2XSx2Kys7ZS5jb3VudGVyLmNvbnN0YW50KyssZS5wdHIrPUw7Y29udGludWV9ZWxzZSBpZihYPT09MCl7aWYoXyl0aHJvdyJpbnRlZ3JpdHkgaXNzdWUiO2lmKGUuY291bnRlci51bmNvbXByZXNzZWQrKyxlLnB0cis9TCxUPVYqZCp1LFM9YS5ieXRlTGVuZ3RoLWUucHRyLFQ9VDxTP1Q6UyxDPW5ldyBBcnJheUJ1ZmZlcihUJXU9PT0wP1Q6VCt1LVQldSksUj1uZXcgVWludDhBcnJheShDKSxSLnNldChuZXcgVWludDhBcnJheShhLGUucHRyLFQpKSxPPW5ldyByKEMpLEI9MCxFKWZvcihsPTA7bDxWO2wrKyl7Zm9yKGY9MDtmPGQ7ZisrKUVbdl0mJihZW3ZdPU9bQisrXSksdisrO3YrPUR9ZWxzZSBmb3IobD0wO2w8VjtsKyspe2ZvcihmPTA7ZjxkO2YrKylZW3YrK109T1tCKytdO3YrPUR9ZS5wdHIrPUIqdX1lbHNlIGlmKEs9cC5nZXREYXRhVHlwZVVzZWQoXyYmYzw2PzQ6Yyx6KSxRPXAuZ2V0T25lUGl4ZWwoYixMLEssRiksTCs9cC5nZXREYXRhVHlwZVNpemUoSyksWD09PTMpaWYoZS5wdHIrPUwsZS5jb3VudGVyLmNvbnN0YW50b2Zmc2V0KyssRSlmb3IobD0wO2w8VjtsKyspe2ZvcihmPTA7ZjxkO2YrKylFW3ZdJiYoWVt2XT1fP01hdGgubWluKFcsSFt2XStRKTpRKSx2Kys7dis9RH1lbHNlIGZvcihsPTA7bDxWO2wrKyl7Zm9yKGY9MDtmPGQ7ZisrKVlbdl09Xz9NYXRoLm1pbihXLEhbdl0rUSk6USx2Kys7dis9RH1lbHNlIGlmKGUucHRyKz1MLHAuZGVjb2RlQml0cyhhLGUsRyxRLCQpLEw9MCxfKWlmKEUpZm9yKGw9MDtsPFY7bCsrKXtmb3IoZj0wO2Y8ZDtmKyspRVt2XSYmKFlbdl09R1tMKytdK0hbdl0pLHYrKzt2Kz1EfWVsc2UgZm9yKGw9MDtsPFY7bCsrKXtmb3IoZj0wO2Y8ZDtmKyspWVt2XT1HW0wrK10rSFt2XSx2Kys7dis9RH1lbHNlIGlmKEUpZm9yKGw9MDtsPFY7bCsrKXtmb3IoZj0wO2Y8ZDtmKyspRVt2XSYmKFlbdl09R1tMKytdKSx2Kys7dis9RH1lbHNlIGZvcihsPTA7bDxWO2wrKyl7Zm9yKGY9MDtmPGQ7ZisrKVlbdisrXT1HW0wrK107dis9RH19Sj4xJiYhcyYmKGUucGl4ZWxzLnJlc3VsdFBpeGVscz1wLnN3YXBEaW1lbnNpb25PcmRlcihlLnBpeGVscy5yZXN1bHRQaXhlbHMsaSxKLHIpKX0sZm9ybWF0RmlsZUluZm86ZnVuY3Rpb24oYSl7cmV0dXJue2ZpbGVJZGVudGlmaWVyU3RyaW5nOmEuaGVhZGVySW5mby5maWxlSWRlbnRpZmllclN0cmluZyxmaWxlVmVyc2lvbjphLmhlYWRlckluZm8uZmlsZVZlcnNpb24saW1hZ2VUeXBlOmEuaGVhZGVySW5mby5pbWFnZVR5cGUsaGVpZ2h0OmEuaGVhZGVySW5mby5oZWlnaHQsd2lkdGg6YS5oZWFkZXJJbmZvLndpZHRoLG51bVZhbGlkUGl4ZWw6YS5oZWFkZXJJbmZvLm51bVZhbGlkUGl4ZWwsbWljcm9CbG9ja1NpemU6YS5oZWFkZXJJbmZvLm1pY3JvQmxvY2tTaXplLGJsb2JTaXplOmEuaGVhZGVySW5mby5ibG9iU2l6ZSxtYXhaRXJyb3I6YS5oZWFkZXJJbmZvLm1heFpFcnJvcixwaXhlbFR5cGU6cC5nZXRQaXhlbFR5cGUoYS5oZWFkZXJJbmZvLmltYWdlVHlwZSksZW9mT2Zmc2V0OmEuZW9mT2Zmc2V0LG1hc2s6YS5tYXNrP3tudW1CeXRlczphLm1hc2subnVtQnl0ZXN9Om51bGwscGl4ZWxzOntudW1CbG9ja3NYOmEucGl4ZWxzLm51bUJsb2Nrc1gsbnVtQmxvY2tzWTphLnBpeGVscy5udW1CbG9ja3NZLG1heFZhbHVlOmEuaGVhZGVySW5mby56TWF4LG1pblZhbHVlOmEuaGVhZGVySW5mby56TWluLG5vRGF0YVZhbHVlOmEubm9EYXRhVmFsdWV9fX0sY29uc3RydWN0Q29uc3RhbnRTdXJmYWNlOmZ1bmN0aW9uKGEsZSl7dmFyIHI9YS5oZWFkZXJJbmZvLnpNYXgscz1hLmhlYWRlckluZm8uek1pbix0PWEuaGVhZGVySW5mby5tYXhWYWx1ZXMsbj1hLmhlYWRlckluZm8ubnVtRGltcyxoPWEuaGVhZGVySW5mby5oZWlnaHQqYS5oZWFkZXJJbmZvLndpZHRoLGk9MCxvPTAsYz0wLHU9YS5waXhlbHMucmVzdWx0TWFzayxtPWEucGl4ZWxzLnJlc3VsdFBpeGVscztpZih1KWlmKG4+MSl7aWYoZSlmb3IoaT0wO2k8bjtpKyspZm9yKGM9aSpoLHI9dFtpXSxvPTA7bzxoO28rKyl1W29dJiYobVtjK29dPXIpO2Vsc2UgZm9yKG89MDtvPGg7bysrKWlmKHVbb10pZm9yKGM9bypuLGk9MDtpPG47aSsrKW1bYytuXT10W2ldfWVsc2UgZm9yKG89MDtvPGg7bysrKXVbb10mJihtW29dPXIpO2Vsc2UgaWYobj4xJiZzIT09cilpZihlKWZvcihpPTA7aTxuO2krKylmb3IoYz1pKmgscj10W2ldLG89MDtvPGg7bysrKW1bYytvXT1yO2Vsc2UgZm9yKG89MDtvPGg7bysrKWZvcihjPW8qbixpPTA7aTxuO2krKyltW2MraV09dFtpXTtlbHNlIGZvcihvPTA7bzxoKm47bysrKW1bb109cn0sZ2V0RGF0YVR5cGVBcnJheTpmdW5jdGlvbihhKXt2YXIgZTtzd2l0Y2goYSl7Y2FzZSAwOmU9SW50OEFycmF5O2JyZWFrO2Nhc2UgMTplPVVpbnQ4QXJyYXk7YnJlYWs7Y2FzZSAyOmU9SW50MTZBcnJheTticmVhaztjYXNlIDM6ZT1VaW50MTZBcnJheTticmVhaztjYXNlIDQ6ZT1JbnQzMkFycmF5O2JyZWFrO2Nhc2UgNTplPVVpbnQzMkFycmF5O2JyZWFrO2Nhc2UgNjplPUZsb2F0MzJBcnJheTticmVhaztjYXNlIDc6ZT1GbG9hdDY0QXJyYXk7YnJlYWs7ZGVmYXVsdDplPUZsb2F0MzJBcnJheX1yZXR1cm4gZX0sZ2V0UGl4ZWxUeXBlOmZ1bmN0aW9uKGEpe3ZhciBlO3N3aXRjaChhKXtjYXNlIDA6ZT0iUzgiO2JyZWFrO2Nhc2UgMTplPSJVOCI7YnJlYWs7Y2FzZSAyOmU9IlMxNiI7YnJlYWs7Y2FzZSAzOmU9IlUxNiI7YnJlYWs7Y2FzZSA0OmU9IlMzMiI7YnJlYWs7Y2FzZSA1OmU9IlUzMiI7YnJlYWs7Y2FzZSA2OmU9IkYzMiI7YnJlYWs7Y2FzZSA3OmU9IkY2NCI7YnJlYWs7ZGVmYXVsdDplPSJGMzIifXJldHVybiBlfSxpc1ZhbGlkUGl4ZWxWYWx1ZTpmdW5jdGlvbihhLGUpe2lmKGU9PW51bGwpcmV0dXJuITE7dmFyIHI7c3dpdGNoKGEpe2Nhc2UgMDpyPWU+PS0xMjgmJmU8PTEyNzticmVhaztjYXNlIDE6cj1lPj0wJiZlPD0yNTU7YnJlYWs7Y2FzZSAyOnI9ZT49LTMyNzY4JiZlPD0zMjc2NzticmVhaztjYXNlIDM6cj1lPj0wJiZlPD02NTUzNjticmVhaztjYXNlIDQ6cj1lPj0tMjE0NzQ4MzY0OCYmZTw9MjE0NzQ4MzY0NzticmVhaztjYXNlIDU6cj1lPj0wJiZlPD00Mjk0OTY3Mjk2O2JyZWFrO2Nhc2UgNjpyPWU+PS0zNDAyNzk5OTM4NzkwMTQ4NGUyMiYmZTw9MzQwMjc5OTkzODc5MDE0ODRlMjI7YnJlYWs7Y2FzZSA3OnI9ZT49LTE3OTc2OTMxMzQ4NjIzMTU3ZTI5MiYmZTw9MTc5NzY5MzEzNDg2MjMxNTdlMjkyO2JyZWFrO2RlZmF1bHQ6cj0hMX1yZXR1cm4gcn0sZ2V0RGF0YVR5cGVTaXplOmZ1bmN0aW9uKGEpe3ZhciBlPTA7c3dpdGNoKGEpe2Nhc2UgMDpjYXNlIDE6ZT0xO2JyZWFrO2Nhc2UgMjpjYXNlIDM6ZT0yO2JyZWFrO2Nhc2UgNDpjYXNlIDU6Y2FzZSA2OmU9NDticmVhaztjYXNlIDc6ZT04O2JyZWFrO2RlZmF1bHQ6ZT1hfXJldHVybiBlfSxnZXREYXRhVHlwZVVzZWQ6ZnVuY3Rpb24oYSxlKXt2YXIgcj1hO3N3aXRjaChhKXtjYXNlIDI6Y2FzZSA0OnI9YS1lO2JyZWFrO2Nhc2UgMzpjYXNlIDU6cj1hLTIqZTticmVhaztjYXNlIDY6ZT09PTA/cj1hOmU9PT0xP3I9MjpyPTE7YnJlYWs7Y2FzZSA3OmU9PT0wP3I9YTpyPWEtMiplKzE7YnJlYWs7ZGVmYXVsdDpyPWE7YnJlYWt9cmV0dXJuIHJ9LGdldE9uZVBpeGVsOmZ1bmN0aW9uKGEsZSxyLHMpe3ZhciB0PTA7c3dpdGNoKHIpe2Nhc2UgMDp0PXMuZ2V0SW50OChlKTticmVhaztjYXNlIDE6dD1zLmdldFVpbnQ4KGUpO2JyZWFrO2Nhc2UgMjp0PXMuZ2V0SW50MTYoZSwhMCk7YnJlYWs7Y2FzZSAzOnQ9cy5nZXRVaW50MTYoZSwhMCk7YnJlYWs7Y2FzZSA0OnQ9cy5nZXRJbnQzMihlLCEwKTticmVhaztjYXNlIDU6dD1zLmdldFVJbnQzMihlLCEwKTticmVhaztjYXNlIDY6dD1zLmdldEZsb2F0MzIoZSwhMCk7YnJlYWs7Y2FzZSA3OnQ9cy5nZXRGbG9hdDY0KGUsITApO2JyZWFrO2RlZmF1bHQ6dGhyb3cidGhlIGRlY29kZXIgZG9lcyBub3QgdW5kZXJzdGFuZCB0aGlzIHBpeGVsIHR5cGUifXJldHVybiB0fSxzd2FwRGltZW5zaW9uT3JkZXI6ZnVuY3Rpb24oYSxlLHIscyx0KXt2YXIgbj0wLGg9MCxpPTAsbz0wLGM9YTtpZihyPjEpaWYoYz1uZXcgcyhlKnIpLHQpZm9yKG49MDtuPGU7bisrKWZvcihvPW4saT0wO2k8cjtpKyssbys9ZSljW29dPWFbaCsrXTtlbHNlIGZvcihuPTA7bjxlO24rKylmb3Iobz1uLGk9MDtpPHI7aSsrLG8rPWUpY1toKytdPWFbb107cmV0dXJuIGN9fSxrPWZ1bmN0aW9uKGEsZSxyKXt0aGlzLnZhbD1hLHRoaXMubGVmdD1lLHRoaXMucmlnaHQ9cn0sVT17ZGVjb2RlOmZ1bmN0aW9uKGEsZSl7ZT1lfHx7fTt2YXIgcj1lLm5vRGF0YVZhbHVlLHM9MCx0PXt9O2lmKHQucHRyPWUuaW5wdXRPZmZzZXR8fDAsdC5waXhlbHM9e30sISFwLnJlYWRIZWFkZXJJbmZvKGEsdCkpe3ZhciBuPXQuaGVhZGVySW5mbyxoPW4uZmlsZVZlcnNpb24saT1wLmdldERhdGFUeXBlQXJyYXkobi5pbWFnZVR5cGUpO2lmKGg+NSl0aHJvdyJ1bnN1cHBvcnRlZCBsZXJjIHZlcnNpb24gMi4iK2g7cC5yZWFkTWFzayhhLHQpLG4ubnVtVmFsaWRQaXhlbCE9PW4ud2lkdGgqbi5oZWlnaHQmJiF0LnBpeGVscy5yZXN1bHRNYXNrJiYodC5waXhlbHMucmVzdWx0TWFzaz1lLm1hc2tEYXRhKTt2YXIgbz1uLndpZHRoKm4uaGVpZ2h0O3QucGl4ZWxzLnJlc3VsdFBpeGVscz1uZXcgaShvKm4ubnVtRGltcyksdC5jb3VudGVyPXtvbmVzd2VlcDowLHVuY29tcHJlc3NlZDowLGx1dDowLGJpdHN0dWZmZXI6MCxjb25zdGFudDowLGNvbnN0YW50b2Zmc2V0OjB9O3ZhciBjPSFlLnJldHVyblBpeGVsSW50ZXJsZWF2ZWREaW1zO2lmKG4ubnVtVmFsaWRQaXhlbCE9PTApaWYobi56TWF4PT09bi56TWluKXAuY29uc3RydWN0Q29uc3RhbnRTdXJmYWNlKHQsYyk7ZWxzZSBpZihoPj00JiZwLmNoZWNrTWluTWF4UmFuZ2VzKGEsdCkpcC5jb25zdHJ1Y3RDb25zdGFudFN1cmZhY2UodCxjKTtlbHNle3ZhciB1PW5ldyBEYXRhVmlldyhhLHQucHRyLDIpLG09dS5nZXRVaW50OCgwKTtpZih0LnB0cisrLG0pcC5yZWFkRGF0YU9uZVN3ZWVwKGEsdCxpLGMpO2Vsc2UgaWYoaD4xJiZuLmltYWdlVHlwZTw9MSYmTWF0aC5hYnMobi5tYXhaRXJyb3ItLjUpPDFlLTUpe3ZhciB3PXUuZ2V0VWludDgoMSk7aWYodC5wdHIrKyx0LmVuY29kZU1vZGU9dyx3PjJ8fGg8NCYmdz4xKXRocm93IkludmFsaWQgSHVmZm1hbiBmbGFnICIrdzt3P3AucmVhZEh1ZmZtYW4oYSx0LGksYyk6cC5yZWFkVGlsZXMoYSx0LGksYyl9ZWxzZSBwLnJlYWRUaWxlcyhhLHQsaSxjKX10LmVvZk9mZnNldD10LnB0cjt2YXIgbDtlLmlucHV0T2Zmc2V0PyhsPXQuaGVhZGVySW5mby5ibG9iU2l6ZStlLmlucHV0T2Zmc2V0LXQucHRyLE1hdGguYWJzKGwpPj0xJiYodC5lb2ZPZmZzZXQ9ZS5pbnB1dE9mZnNldCt0LmhlYWRlckluZm8uYmxvYlNpemUpKToobD10LmhlYWRlckluZm8uYmxvYlNpemUtdC5wdHIsTWF0aC5hYnMobCk+PTEmJih0LmVvZk9mZnNldD10LmhlYWRlckluZm8uYmxvYlNpemUpKTt2YXIgZj17d2lkdGg6bi53aWR0aCxoZWlnaHQ6bi5oZWlnaHQscGl4ZWxEYXRhOnQucGl4ZWxzLnJlc3VsdFBpeGVscyxtaW5WYWx1ZTpuLnpNaW4sbWF4VmFsdWU6bi56TWF4LHZhbGlkUGl4ZWxDb3VudDpuLm51bVZhbGlkUGl4ZWwsZGltQ291bnQ6bi5udW1EaW1zLGRpbVN0YXRzOnttaW5WYWx1ZXM6bi5taW5WYWx1ZXMsbWF4VmFsdWVzOm4ubWF4VmFsdWVzfSxtYXNrRGF0YTp0LnBpeGVscy5yZXN1bHRNYXNrfTtpZih0LnBpeGVscy5yZXN1bHRNYXNrJiZwLmlzVmFsaWRQaXhlbFZhbHVlKG4uaW1hZ2VUeXBlLHIpKXt2YXIgZz10LnBpeGVscy5yZXN1bHRNYXNrO2ZvcihzPTA7czxvO3MrKylnW3NdfHwoZi5waXhlbERhdGFbc109cik7Zi5ub0RhdGFWYWx1ZT1yfXJldHVybiB0Lm5vRGF0YVZhbHVlPXIsZS5yZXR1cm5GaWxlSW5mbyYmKGYuZmlsZUluZm89cC5mb3JtYXRGaWxlSW5mbyh0KSksZn19LGdldEJhbmRDb3VudDpmdW5jdGlvbihhKXt2YXIgZT0wLHI9MCxzPXt9O2ZvcihzLnB0cj0wLHMucGl4ZWxzPXt9O3I8YS5ieXRlTGVuZ3RoLTU4OylwLnJlYWRIZWFkZXJJbmZvKGEscykscis9cy5oZWFkZXJJbmZvLmJsb2JTaXplLGUrKyxzLnB0cj1yO3JldHVybiBlfX07cmV0dXJuIFV9KCk7dmFyIG5lPWZ1bmN0aW9uKCl7dmFyIEE9bmV3IEFycmF5QnVmZmVyKDQpLHA9bmV3IFVpbnQ4QXJyYXkoQSksaz1uZXcgVWludDMyQXJyYXkoQSk7cmV0dXJuIGtbMF09MSxwWzBdPT09MX0oKSxpZT17ZGVjb2RlOmZ1bmN0aW9uKEEscCl7aWYoIW5lKXRocm93IkJpZyBlbmRpYW4gc3lzdGVtIGlzIG5vdCBzdXBwb3J0ZWQuIjtwPXB8fHt9O3ZhciBrPXAuaW5wdXRPZmZzZXR8fDAsVT1uZXcgVWludDhBcnJheShBLGssMTApLGE9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLFUpLGUscjtpZihhLnRyaW0oKT09PSJDbnRaSW1hZ2UiKWU9ZWUscj0xO2Vsc2UgaWYoYS5zdWJzdHJpbmcoMCw1KT09PSJMZXJjMiIpZT1yZSxyPTI7ZWxzZSB0aHJvdyJVbmV4cGVjdGVkIGZpbGUgaWRlbnRpZmllciBzdHJpbmc6ICIrYTtmb3IodmFyIHM9MCx0PUEuYnl0ZUxlbmd0aC0xMCxuLGg9W10saSxvLGM9e3dpZHRoOjAsaGVpZ2h0OjAscGl4ZWxzOltdLHBpeGVsVHlwZTpwLnBpeGVsVHlwZSxtYXNrOm51bGwsc3RhdGlzdGljczpbXX0sdT0wO2s8dDspe3ZhciBtPWUuZGVjb2RlKEEse2lucHV0T2Zmc2V0OmssZW5jb2RlZE1hc2tEYXRhOm4sbWFza0RhdGE6byxyZXR1cm5NYXNrOnM9PT0wLHJldHVybkVuY29kZWRNYXNrOnM9PT0wLHJldHVybkZpbGVJbmZvOiEwLHJldHVyblBpeGVsSW50ZXJsZWF2ZWREaW1zOnAucmV0dXJuUGl4ZWxJbnRlcmxlYXZlZERpbXMscGl4ZWxUeXBlOnAucGl4ZWxUeXBlfHxudWxsLG5vRGF0YVZhbHVlOnAubm9EYXRhVmFsdWV8fG51bGx9KTtrPW0uZmlsZUluZm8uZW9mT2Zmc2V0LG89bS5tYXNrRGF0YSxzPT09MCYmKG49bS5lbmNvZGVkTWFza0RhdGEsYy53aWR0aD1tLndpZHRoLGMuaGVpZ2h0PW0uaGVpZ2h0LGMuZGltQ291bnQ9bS5kaW1Db3VudHx8MSxjLnBpeGVsVHlwZT1tLnBpeGVsVHlwZXx8bS5maWxlSW5mby5waXhlbFR5cGUsYy5tYXNrPW8pLHI+MSYmKG8mJmgucHVzaChvKSxtLmZpbGVJbmZvLm1hc2smJm0uZmlsZUluZm8ubWFzay5udW1CeXRlcz4wJiZ1KyspLHMrKyxjLnBpeGVscy5wdXNoKG0ucGl4ZWxEYXRhKSxjLnN0YXRpc3RpY3MucHVzaCh7bWluVmFsdWU6bS5taW5WYWx1ZSxtYXhWYWx1ZTptLm1heFZhbHVlLG5vRGF0YVZhbHVlOm0ubm9EYXRhVmFsdWUsZGltU3RhdHM6bS5kaW1TdGF0c30pfXZhciB3LGwsZjtpZihyPjEmJnU+MSl7Zm9yKGY9Yy53aWR0aCpjLmhlaWdodCxjLmJhbmRNYXNrcz1oLG89bmV3IFVpbnQ4QXJyYXkoZiksby5zZXQoaFswXSksdz0xO3c8aC5sZW5ndGg7dysrKWZvcihpPWhbd10sbD0wO2w8ZjtsKyspb1tsXT1vW2xdJmlbbF07Yy5tYXNrRGF0YT1vfXJldHVybiBjfX07Y29uc3QgdGU9ezA6N2UzLDE6NmUzLDI6NWUzLDM6NGUzLDQ6M2UzLDU6MjUwMCw2OjJlMyw3OjE1MDAsODo4MDAsOTo1MDAsMTA6MjAwLDExOjEwMCwxMjo0MCwxMzoxMiwxNDo1LDE1OjIsMTY6MSwxNzouNSwxODouMiwxOTouMSwyMDouMDF9O2Z1bmN0aW9uIGFlKEEpe2NvbnN0e2hlaWdodDpwLHdpZHRoOmsscGl4ZWxzOlV9PWllLmRlY29kZShBKSxhPW5ldyBGbG9hdDMyQXJyYXkocCprKTtmb3IobGV0IGU9MDtlPGEubGVuZ3RoO2UrKylhW2VdPVVbMF1bZV07cmV0dXJue2FycmF5OmEsd2lkdGg6ayxoZWlnaHQ6cH19ZnVuY3Rpb24gc2UoQSxwLGspe2xldCBVPWFlKEEpO2tbMl0ta1swXTwxJiYoVT1mZShVLGspKTtjb25zdHthcnJheTphLHdpZHRoOmV9PVUscz1uZXcgWihlKS5jcmVhdGVUaWxlKGEpLHQ9dGVbcF18fDA7cmV0dXJuIHMuZ2V0R2VvbWV0cnlEYXRhKHQpfWZ1bmN0aW9uIGZlKEEscCl7ZnVuY3Rpb24gayhzLHQsbixoLGksbyxjLHUpe2NvbnN0IG09bmV3IEZsb2F0MzJBcnJheShpKm8pO2ZvcihsZXQgbD0wO2w8bztsKyspZm9yKGxldCBmPTA7ZjxpO2YrKyl7Y29uc3QgZz0obCtoKSp0KyhmK24pLE09bCppK2Y7bVtNXT1zW2ddfWNvbnN0IHc9bmV3IEZsb2F0MzJBcnJheSh1KmMpO2ZvcihsZXQgbD0wO2w8dTtsKyspZm9yKGxldCBmPTA7ZjxjO2YrKyl7Y29uc3QgZz1sKnUrZixNPU1hdGgucm91bmQoZipvL3UpLGQ9TWF0aC5yb3VuZChsKmkvYykqaStNO3dbZ109bVtkXX1yZXR1cm4gd31jb25zdCBVPW9lKHAsQS53aWR0aCksYT1VLnN3KzEsZT1VLnNoKzE7cmV0dXJue2FycmF5OmsoQS5hcnJheSxBLndpZHRoLFUuc3gsVS5zeSxVLnN3LFUuc2gsYSxlKSx3aWR0aDphLGhlaWdodDplfX1mdW5jdGlvbiBvZShBLHApe2NvbnN0IGs9TWF0aC5mbG9vcihBWzBdKnApLFU9TWF0aC5mbG9vcihBWzFdKnApLGE9TWF0aC5mbG9vcigoQVsyXS1BWzBdKSpwKSxlPU1hdGguZmxvb3IoKEFbM10tQVsxXSkqcCk7cmV0dXJue3N4Omssc3k6VSxzdzphLHNoOmV9fXNlbGYub25tZXNzYWdlPUE9Pntjb25zdCBwPUEuZGF0YSxrPXNlKHAuZGVtRGF0YSxwLnoscC5jbGlwQm91bmRzKTtzZWxmLnBvc3RNZXNzYWdlKGspfX0pKCk7Cg==",at=typeof self<"u"&&self.Blob&&new Blob([(lt=ot,Uint8Array.from(atob(lt),t=>t.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});var lt;function dt(t){let e;try{if(e=at&&(self.URL||self.webkitURL).createObjectURL(at),!e)throw"";const r=new Worker(e,{name:t?.name});return r.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),r}catch{return new Worker("data:text/javascript;base64,"+ot,{name:t?.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}class ct extends et{constructor(){super(),S(this,"info",{version:K,description:"Tile LERC terrain loader. It can load ArcGis-lerc format terrain data."}),S(this,"dataType","lerc"),S(this,"fileLoader",new f(_.manager)),S(this,"_workerPool",new nt(0)),this.fileLoader.setResponseType("arraybuffer"),this._workerPool.setWorkerCreator(()=>new dt)}async doLoad(t,e){0===this._workerPool.pool&&this._workerPool.setWorkerLimit(5);const{z:r,clipBounds:s}=e,i={demData:await this.fileLoader.loadAsync(t),z:r,clipBounds:s},n=(await this._workerPool.postMessage(i)).data;return(new Q).setData(n)}}const ht="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGModCl7cmV0dXJuIGEodC5kYXRhKX1mdW5jdGlvbiBhKHQpe2Z1bmN0aW9uIG4oZSx1KXtjb25zdCByPXUqNCxbaSxmLGcsbF09ZS5zbGljZShyLHIrNCk7cmV0dXJuIGw9PT0wPzA6LTFlNCsoaTw8MTZ8Zjw8OHxnKSouMX1jb25zdCBvPXQubGVuZ3RoPj4+MixzPW5ldyBGbG9hdDMyQXJyYXkobyk7Zm9yKGxldCBlPTA7ZTxvO2UrKylzW2VdPW4odCxlKTtyZXR1cm4gc31zZWxmLm9ubWVzc2FnZT10PT57Y29uc3Qgbj1jKHQuZGF0YS5pbWdEYXRhKTtzZWxmLnBvc3RNZXNzYWdlKG4pfX0pKCk7Cg==",ut=typeof self<"u"&&self.Blob&&new Blob([(t=>Uint8Array.from(atob(t),t=>t.charCodeAt(0)))(ht)],{type:"text/javascript;charset=utf-8"});function mt(t){let e;try{if(e=ut&&(self.URL||self.webkitURL).createObjectURL(ut),!e)throw"";const r=new Worker(e,{name:t?.name});return r.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(e)}),r}catch{return new Worker("data:text/javascript;base64,"+ht,{name:t?.name})}finally{e&&(self.URL||self.webkitURL).revokeObjectURL(e)}}class bt extends et{constructor(){super(),S(this,"info",{version:K,description:"Mapbox-RGB terrain loader, It can load Mapbox-RGB terrain data."}),S(this,"dataType","terrain-rgb"),S(this,"imageLoader",new p(_.manager)),S(this,"_workerPool",new nt(0)),this._workerPool.setWorkerCreator(()=>new mt)}async doLoad(t,e){const r=await this.imageLoader.loadAsync(t),{clipBounds:s,z:i}=e,n=function(t,e,r){const s=q(e,t.width);r=Math.min(r,s.sw);const i=new OffscreenCanvas(r,r).getContext("2d");return i.imageSmoothingEnabled=!1,i.drawImage(t,s.sx,s.sy,s.sw,s.sh,0,0,r,r),i.getImageData(0,0,r,r)}(r,s,W.clamp(3*(i+2),2,64));let o;0===this._workerPool.pool&&this._workerPool.setWorkerLimit(10),o=(await this._workerPool.postMessage({imgData:n},[n.data.buffer])).data;const a=new Q;return a.setData(o),a}}class Zt{constructor(t){S(this,"dataType","image"),S(this,"attribution","ThreeTile"),S(this,"minLevel",0),S(this,"maxLevel",18),S(this,"projectionID","3857"),S(this,"url",""),S(this,"subdomains",[]),S(this,"opacity",1),S(this,"transparent",!0),S(this,"isTMS",!1),S(this,"bounds"),S(this,"_projectionBounds",[-1/0,-1/0,1/0,1/0]),Object.assign(this,t)}_getBBox(t,e,r){const s=6378137*Math.PI,i=2*s/Math.pow(2,r);return`${t*i-s},${s-(e+1)*i},${(t+1)*i-s},${s-e*i}`}getUrl(t,e,r,s){const i=this.subdomains.length;let n;if(i>0){const t=Math.floor(Math.random()*i);n=this.subdomains[t]}const o=this._getBBox(t,e,r);e=this.isTMS?Math.pow(2,r)-1-e:e;const a={...this,x:t,y:e,z:r,s:n,bbox:o,...s};return function(t,e){const r=/\{ *([\w_-]+) *\}/g;return t.replace(r,(t,r)=>{const s=e[r]??(()=>{throw new Error(`source url template error, No value provided for variable: ${t}`)})();return"function"==typeof s?s(e):s})}(this.url,a)}static create(t){return new Zt(t)}}class pt{constructor(t=0){S(this,"_lon0",0),this._lon0=t}get lon0(){return this._lon0}getTileXWithCenterLon(t,e){const r=Math.pow(2,e);let s=t+Math.round(r/360*this._lon0);return s>=r?s-=r:s<0&&(s+=r),s}getProjBoundsFromLonLat(t){const e=t[2]-t[0]>180,r=this.project(t[0]+(e?this._lon0:0),t[1]),s=this.project(t[2]+(e?this._lon0:0),t[3]);return[Math.min(r.x,s.x),Math.min(r.y,s.y),Math.max(r.x,s.x),Math.max(r.y,s.y)]}getProjBoundsFromXYZ(t,e,r){const s=6378137*Math.PI,i=2*s/Math.pow(2,r);return[t*i-s,s-(e+1)*i,(t+1)*i-s,s-e*i]}getLonLatBoundsFromXYZ(t,e,r){const s=this.getProjBoundsFromXYZ(t,e,r),i=this.unProject(s[0],s[1]),n=this.unProject(s[2],s[3]);return[i.lon,i.lat,n.lon,n.lat]}}const yt=6378137;class Wt extends pt{constructor(){super(...arguments),S(this,"ID","3857"),S(this,"mapWidth",2*Math.PI*yt),S(this,"mapHeight",this.mapWidth),S(this,"mapDepth",1)}project(t,e){const r=(t-this.lon0)*(Math.PI/180),s=e*(Math.PI/180);return{x:yt*r,y:yt*Math.log(Math.tan(Math.PI/4+s/2))}}unProject(t,e){let r=t/yt*(180/Math.PI)+this.lon0;return r>180&&(r-=360),{lat:(2*Math.atan(Math.exp(e/yt))-Math.PI/2)*(180/Math.PI),lon:r}}}class ft extends pt{constructor(){super(...arguments),S(this,"ID","4326"),S(this,"mapWidth",36e6),S(this,"mapHeight",18e6),S(this,"mapDepth",1)}project(t,e){return{x:100*(t-this.lon0)*1e3,y:100*e*1e3}}unProject(t,e){return{lon:t/1e5+this.lon0,lat:e/1e5}}}const Lt=(t="3857",e)=>{let r;switch(t){case"3857":r=new Wt(e);break;case"4326":r=new ft(e);break;default:throw new Error(`Projection ID: ${t} is not supported.`)}return r};class Gt extends tt{constructor(){super(...arguments),S(this,"_projection",new Wt(0))}get imgSource(){return super.imgSource}set imgSource(t){super.imgSource=t,this._updateImgProjBounds()}get demSource(){return super.demSource}set demSource(t){super.demSource=t,this._updateDemPrjBounds()}_updateImgProjBounds(){const t=this._projection;this.imgSource.forEach(e=>{e._projectionBounds=t.getProjBoundsFromLonLat(e.bounds||this.bounds)})}_updateDemPrjBounds(){const t=this._projection;this.demSource&&(this.demSource._projectionBounds=t.getProjBoundsFromLonLat(this.demSource.bounds||this.bounds))}get projection(){return this._projection}set projection(t){this._projection=t,this._updateImgProjBounds(),this._updateDemPrjBounds()}async load(t,e){const{x:r,y:s,z:i,bounds:n,lonLatBounds:o}=this.getTileCoords(t);return super.load({x:r,y:s,z:i,bounds:n,lonLatBounds:o},e)}update(t,e){const{x:r,y:s,z:i,bounds:n,lonLatBounds:o}=this.getTileCoords(t);super.update({x:r,y:s,z:i,bounds:n,lonLatBounds:o},e)}getTileCoords(t){if(!this._projection)throw new Error("projection is undefined");const{x:e,y:r,z:s}=t;return{x:this._projection.getTileXWithCenterLon(e,s),y:r,z:s,bounds:this._projection.getProjBoundsFromXYZ(e,r,s),lonLatBounds:this._projection.getLonLatBoundsFromXYZ(e,r,s)}}}const Vt=new n,xt=new e(0,-1,0),wt=new e;function gt(t,e){const r=e.intersectObject(t.rootTile,!0);if(r.length>0){const e=r[0];console.assert(e.object.visible);const s=t.worldToLocal(e.point.clone()),i=t.map2geo(s);return Object.assign(e,{location:i})}}function vt(t,e){return wt.set(e.x,1e4,e.z),Vt.set(wt,xt),gt(t,Vt)}class Mt extends t{constructor(t){super(),S(this,"name","map"),S(this,"debug",0),S(this,"_mapClock",new Z),S(this,"isLOD",!0),S(this,"autoUpdate",!0),S(this,"updateInterval",100),S(this,"rootTile"),S(this,"loader"),S(this,"_minLevel",2),S(this,"_maxLevel",20),S(this,"_LODThreshold",1),this.up.set(0,0,1);const{loader:e=new Gt,rootTile:r=new D,minLevel:s=2,imgSource:i,demSource:n,bounds:o,lon0:a=0,debug:l=0}=t;this.minLevel=s,this.loader=e,this.rootTile=r,o&&(this.loader.bounds=o),this.debug=this.loader.debug=l,this.lon0=a,this.imgSource=i,this.demSource=n,this.add(r),this._resize(),function(t){const e=t.loader.manager,r=(e,r)=>{t.dispatchEvent({type:e,...r})};e.onStart=(t,e,s)=>{r("loading-start",{url:t,itemsLoaded:e,itemsTotal:s})},e.onError=t=>{r("loading-error",{url:t})},e.onLoad=()=>{r("loading-complete")},e.onProgress=(t,e,s)=>{r("loading-progress",{url:t,itemsLoaded:e,itemsTotal:s})},e.onParseEnd=t=>{r("parsing-end",{geometry:t})},t.rootTile.addEventListener("tile-created",t=>{r("tile-created",{tile:t.tile})}),t.rootTile.addEventListener("tile-loaded",t=>{r("tile-loaded",{tile:t.tile})}),t.rootTile.addEventListener("tile-unload",t=>{r("tile-unload",{tile:t.tile})}),t.rootTile.addEventListener("tile-visible-changed",t=>{r("tile-visible-changed",{tile:t.tile})})}(this);const d=()=>{this.dispatchEvent({type:"ready"}),this.removeEventListener("loading-complete",d)};this.addEventListener("loading-complete",d)}get minLevel(){return this._minLevel}set minLevel(t){this._minLevel=t}get maxLevel(){return this._maxLevel}set maxLevel(t){this._maxLevel=t}get lon0(){return this.projection.lon0}set lon0(t){this.projection.lon0!==t&&(0!=t&&this.minLevel<1&&console.warn(`Map centralMeridian is ${this.lon0}, minLevel must > 0`),this.projection=Lt(this.projection.ID,t),this._updateSource())}get projection(){return this.loader.projection}set projection(t){(t.ID!=this.projection.ID||t.lon0!=this.lon0)&&(this.loader.projection=t,this._resize(),this.reload(),this.debug>0&&console.log("Map Projection Changed:",t.ID,t.lon0),this.dispatchEvent({type:"projection-changed",projection:t}))}get imgSource(){return this.loader.imgSource}set imgSource(t){const e=Array.isArray(t)?t:[t];if(0===e.length)throw new Error("imgSource can not be empty");this.loader.imgSource=e,this.projection=Lt(e[0].projectionID,this.projection.lon0),this.debug>0&&console.log("Img Source Changed:",e),this._updateSource(),this.dispatchEvent({type:"source-changed",source:t})}get demSource(){return this.loader.demSource}set demSource(t){this.loader.demSource!==t&&(this.loader.demSource=t,this.debug>0&&console.log("DEM Source Changed:",this.demSource),this._updateSource(),this.dispatchEvent({type:"source-changed",source:t}))}get LODThreshold(){return this._LODThreshold}set LODThreshold(t){this._LODThreshold=t}get bounds(){return this.loader.bounds}set bounds(t){this.loader.bounds=t}get maxThreads(){return this.loader.maxThreads}set maxThreads(t){this.loader.maxThreads=t}get backgroundColor(){return 0}set backgroundColor(t){}static create(t){return new Mt(t)}_resize(){return this.rootTile.scale.set(this.projection.mapWidth,this.projection.mapHeight,this.projection.mapDepth),this.rootTile.updateMatrix(),this.rootTile.updateMatrixWorld(),this}_getMaxLevel(){let t=0;return this.imgSource.forEach(e=>t=Math.max(t,e.maxLevel)),this.demSource&&(t=Math.max(t,this.demSource.maxLevel)),this.debug&&console.log("Max Level:",t),t}update(t){const e=this._mapClock.getElapsedTime();e>this.updateInterval/1e3&&(this.rootTile.update({camera:t,loader:this.loader,minLevel:this.minLevel,maxLevel:this.maxLevel,LODThreshold:this.LODThreshold}),this.rootTile.castShadow=this.castShadow,this.rootTile.receiveShadow=this.receiveShadow,this.dispatchEvent({type:"update",delta:e}),this._mapClock.start())}_updateSource(){this._maxLevel=this._getMaxLevel(),this.rootTile.reload(this.loader,!1)}reload(t=!0){this.rootTile.reload(this.loader,t)}dispose(){this.removeFromParent(),this.reload()}geo2pos(t){return this.geo2map(t)}geo2map(t){const r=this.projection.project(t.x,t.y);return new e(r.x,r.y,t.z)}geo2world(t){return this.localToWorld(this.geo2map(t))}pos2geo(t){return this.map2geo(t)}map2geo(t){const r=this.projection.unProject(t.x,t.y);return new e(r.lon,r.lat,t.z)}world2geo(t){return this.pos2geo(this.worldToLocal(t.clone()))}getLocalInfoFromGeo(t){return vt(this,this.geo2world(t))}getLocalInfoFromWorld(t){return vt(this,t)}getLocalInfoFromScreen(t,e){return function(t,e,r){return Vt.setFromCamera(r,t),gt(e,Vt)}(t,this,e)}get downloading(){return this.loader.downloadingThreads}getTileCount(){let t=0,e=0,r=0,s=0,i=0,n=0;return this.rootTile.traverse(o=>{o instanceof D&&(t++,o.isLeaf&&(i++,o.showing&&e++,o.inFrustum&&r++),s=Math.max(s,o.z),n=this.loader.downloadingThreads)}),{total:t,leaf:i,visible:e,inFrustum:r,maxLevel:s,downloading:n}}}function Xt(t){return _.registerMaterialLoader(t),t}function Tt(t){return _.registerGeometryLoader(t),t}Xt(new it),Tt(new bt),Tt(new ct);var Yt=Object.defineProperty,Pt=(t,e,r)=>((t,e,r)=>e in t?Yt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),St=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(e){return t._tweens[e]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=performance.now()),void 0===e&&(e=!1);var r=Object.keys(this._tweens);if(0===r.length)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<r.length;s++){var i=this._tweens[r[s]],n=!e;i&&!1===i.update(t,n)&&!e&&delete this._tweens[r[s]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),Kt=new St;Kt.getAll.bind(Kt),Kt.removeAll.bind(Kt),Kt.add.bind(Kt),Kt.remove.bind(Kt),Kt.update.bind(Kt),new w,new g,Math.cos(70*W.DEG2RAD),new e,new v(0,0,0,"YXZ"),new e,new M(-1,1,1,-1,0,1);new class extends u{constructor(){super(),this.setAttribute("position",new Y([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Y([0,2,0,0,2,0],2))}};var It,zt,kt,Ft={};!function(){var t=function(){function t(t){this.message="JPEG error: "+t}return t.prototype=new Error,t.prototype.name="JpegError",t.constructor=t,t}(),e=function(){var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),s=4017,i=799,n=3406,o=2276,a=1567,l=3784,d=5793,c=2896;function h(t){null==t&&(t={}),null==t.w&&(t.w=-1),this.V=t.n,this.N=t.w}function u(t,e){for(var r,s,i,n=0,o=[],a=16;a>0&&!t[a-1];)a--;o.push({children:[],index:0});var l=o[0];for(r=0;r<a;r++){for(s=0;s<t[r];s++){for((l=o.pop()).children[l.index]=e[n];l.index>0;)l=o.pop();for(l.index++,o.push(l);o.length<=r;)o.push(i={children:[],index:0}),l.children[l.index]=i.children,l=i;n++}r+1<a&&(o.push(i={children:[],index:0}),l.children[l.index]=i.children,l=i)}return o[0].children}function m(t,e,r){return 64*((t.P+1)*e+r)}function b(s,i,n,o,a,l,d,c,h,u){null==u&&(u=!1);var b,Z,p,W,f,L,G,V,x,w,g,v=n.m,M=n.Z,X=i,T=0,Y=0,P=0,S=0,K=0,I=0;function z(){if(Y>0)return Y--,T>>Y&1;if(255===(T=s[i++])){var e=s[i++];if(e){if(220===e&&u){var o=r(s,i+=2);if(i+=2,o>0&&o!==n.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",o)}else if(217===e){if(u){var a=8*K;if(a>0&&a<n.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",a)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new t("unexpected marker")}}return Y=7,T>>>7}function k(e){for(var r=e;;){switch(typeof(r=r[z()])){case"number":return r;case"object":continue}throw new t("invalid huffman sequence")}}function F(t){for(var e=0;t>0;)e=e<<1|z(),t--;return e}function U(t){if(1===t)return 1===z()?1:-1;var e=F(t);return e>=1<<t-1?e:e+(-1<<t)+1}function R(t,e,r,s,i){var n=r%v;K=(r/v|0)*t.A+s;var o=n*t.h+i;e(t,m(t,K,o))}function H(t,e,r){K=r/t.P|0;var s=r%t.P;e(t,m(t,K,s))}var D=o.length;for(G=M?0===l?0===c?function(t,e){var r=k(t.J),s=0===r?0:U(r)<<h;t.D[e]=t.Q+=s}:function(t,e){t.D[e]|=z()<<h}:0===c?function(t,r){if(P>0)P--;else for(var s=l,i=d;s<=i;){var n=k(t.i),o=15&n,a=n>>4;if(0!==o){var c=e[s+=a];t.D[r+c]=U(o)*(1<<h),s++}else{if(a<15){P=F(a)+(1<<a)-1;break}s+=16}}}:function(r,s){for(var i,n,o=l,a=d,c=0;o<=a;){var u=s+e[o],m=r.D[u]<0?-1:1;switch(S){case 0:if(c=(n=k(r.i))>>4,0==(i=15&n))c<15?(P=F(c)+(1<<c),S=4):(c=16,S=1);else{if(1!==i)throw new t("invalid ACn encoding");b=U(i),S=c?2:3}continue;case 1:case 2:r.D[u]?r.D[u]+=m*(z()<<h):0===--c&&(S=2===S?3:0);break;case 3:r.D[u]?r.D[u]+=m*(z()<<h):(r.D[u]=b<<h,S=0);break;case 4:r.D[u]&&(r.D[u]+=m*(z()<<h))}o++}4===S&&0===--P&&(S=0)}:function(t,r){var s=k(t.J),i=0===s?0:U(s),n=1;for(t.D[r]=t.Q+=i;n<64;){var o=k(t.i),a=15&o,l=o>>4;if(0!==a){var d=e[n+=l];t.D[r+d]=U(a),n++}else{if(l<15)break;n+=16}}},x=1===D?o[0].P*o[0].c:v*n.R;I<=x;){var j=a?Math.min(x-I,a):x;if(j>0){for(p=0;p<D;p++)o[p].Q=0;if(P=0,1===D)for(Z=o[0],L=0;L<j;L++)H(Z,G,I),I++;else for(L=0;L<j;L++){for(p=0;p<D;p++)for(w=(Z=o[p]).h,g=Z.A,W=0;W<g;W++)for(f=0;f<w;f++)R(Z,G,I,W,f);I++}}if(Y=0,!(V=y(s,i)))break;if(V.u&&(i=V.offset),!(V.M>=65488&&V.M<=65495))break;i+=2}return i-X}function Z(e,r,h){var u,m,b,Z,p,y,W,f,L,G,V,x,w,g,v,M,X,T=e.$,Y=e.D;if(!T)throw new t("missing required Quantization Table.");for(var P=0;P<64;P+=8)L=Y[r+P],G=Y[r+P+1],V=Y[r+P+2],x=Y[r+P+3],w=Y[r+P+4],g=Y[r+P+5],v=Y[r+P+6],M=Y[r+P+7],L*=T[P],G|V|x|w|g|v|M?(G*=T[P+1],V*=T[P+2],x*=T[P+3],w*=T[P+4],g*=T[P+5],v*=T[P+6],M*=T[P+7],m=(u=(u=d*L+128>>8)+(m=d*w+128>>8)+1>>1)-m,X=(b=V)*l+(Z=v)*a+128>>8,b=b*a-Z*l+128>>8,W=(p=(p=c*(G-M)+128>>8)+(W=g<<4)+1>>1)-W,y=(f=(f=c*(G+M)+128>>8)+(y=x<<4)+1>>1)-y,Z=(u=u+(Z=X)+1>>1)-Z,b=(m=m+b+1>>1)-b,X=p*o+f*n+2048>>12,p=p*n-f*o+2048>>12,f=X,X=y*i+W*s+2048>>12,y=y*s-W*i+2048>>12,W=X,h[P]=u+f,h[P+7]=u-f,h[P+1]=m+W,h[P+6]=m-W,h[P+2]=b+y,h[P+5]=b-y,h[P+3]=Z+p,h[P+4]=Z-p):(X=d*L+512>>10,h[P]=X,h[P+1]=X,h[P+2]=X,h[P+3]=X,h[P+4]=X,h[P+5]=X,h[P+6]=X,h[P+7]=X);for(var S=0;S<8;++S)L=h[S],(G=h[S+8])|(V=h[S+16])|(x=h[S+24])|(w=h[S+32])|(g=h[S+40])|(v=h[S+48])|(M=h[S+56])?(m=(u=4112+((u=d*L+2048>>12)+(m=d*w+2048>>12)+1>>1))-m,X=(b=V)*l+(Z=v)*a+2048>>12,b=b*a-Z*l+2048>>12,Z=X,W=(p=(p=c*(G-M)+2048>>12)+(W=g)+1>>1)-W,y=(f=(f=c*(G+M)+2048>>12)+(y=x)+1>>1)-y,X=p*o+f*n+2048>>12,p=p*n-f*o+2048>>12,f=X,X=y*i+W*s+2048>>12,y=y*s-W*i+2048>>12,(L=(u=u+Z+1>>1)+f)<16?L=0:L>=4080?L=255:L>>=4,(G=(m=m+b+1>>1)+(W=X))<16?G=0:G>=4080?G=255:G>>=4,(V=(b=m-b)+y)<16?V=0:V>=4080?V=255:V>>=4,(x=(Z=u-Z)+p)<16?x=0:x>=4080?x=255:x>>=4,(w=Z-p)<16?w=0:w>=4080?w=255:w>>=4,(g=b-y)<16?g=0:g>=4080?g=255:g>>=4,(v=m-W)<16?v=0:v>=4080?v=255:v>>=4,(M=u-f)<16?M=0:M>=4080?M=255:M>>=4,Y[r+S]=L,Y[r+S+8]=G,Y[r+S+16]=V,Y[r+S+24]=x,Y[r+S+32]=w,Y[r+S+40]=g,Y[r+S+48]=v,Y[r+S+56]=M):(X=(X=d*L+8192>>14)<-2040?0:X>=2024?255:X+2056>>4,Y[r+S]=X,Y[r+S+8]=X,Y[r+S+16]=X,Y[r+S+24]=X,Y[r+S+32]=X,Y[r+S+40]=X,Y[r+S+48]=X,Y[r+S+56]=X)}function p(t,e){for(var r=e.P,s=e.c,i=new Int16Array(64),n=0;n<s;n++)for(var o=0;o<r;o++){Z(e,m(e,n,o),i)}return e.D}function y(t,e,s){null==s&&(s=e);var i=t.length-1,n=s<e?s:e;if(e>=i)return null;var o=r(t,e);if(o>=65472&&o<=65534)return{u:null,M:o,offset:e};for(var a=r(t,n);!(a>=65472&&a<=65534);){if(++n>=i)return null;a=r(t,n)}return{u:o.toString(16),M:a,offset:n}}return h.prototype={parse(s,i){null==i&&(i={});var n,o,a=i.F,l=0,d=null,c=null,h=0;function m(){var t=r(s,l),e=(l+=2)+t-2,i=y(s,e,l);i&&i.u&&(e=i.offset);var n=s.subarray(l,e);return l+=n.length,n}function Z(t){for(var e=Math.ceil(t.o/8/t.X),r=Math.ceil(t.s/8/t.B),s=0;s<t.W.length;s++){j=t.W[s];var i=Math.ceil(Math.ceil(t.o/8)*j.h/t.X),n=Math.ceil(Math.ceil(t.s/8)*j.A/t.B),o=e*j.h,a=64*(r*j.A)*(o+1);j.D=new Int16Array(a),j.P=i,j.c=n}t.m=e,t.R=r}var W=[],f=[],L=[],G=r(s,l);if(l+=2,65496!==G)throw new t("SOI not found");G=r(s,l),l+=2;t:for(;65497!==G;){var V,x,w;switch(G){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var g=m();65504===G&&74===g[0]&&70===g[1]&&73===g[2]&&70===g[3]&&0===g[4]&&(d={version:{d:g[5],T:g[6]},K:g[7],j:g[8]<<8|g[9],H:g[10]<<8|g[11],S:g[12],I:g[13],C:g.subarray(14,14+3*g[12]*g[13])}),65518===G&&65===g[0]&&100===g[1]&&111===g[2]&&98===g[3]&&101===g[4]&&(c={version:g[5]<<8|g[6],k:g[7]<<8|g[8],q:g[9]<<8|g[10],a:g[11]});break;case 65499:for(var v=r(s,l)+(l+=2)-2;l<v;){var M=s[l++],X=new Uint16Array(64);if(M>>4){if(M>>4!=1)throw new t("DQT - invalid table spec");for(x=0;x<64;x++)X[e[x]]=r(s,l),l+=2}else for(x=0;x<64;x++)X[e[x]]=s[l++];W[15&M]=X}break;case 65472:case 65473:case 65474:if(n)throw new t("Only single frame JPEGs supported");l+=2,(n={}).G=65473===G,n.Z=65474===G,n.precision=s[l++];var T,Y=r(s,l),P=0,S=0;l+=2,n.s=a||Y,n.o=r(s,l),l+=2,n.W=[],n._={};var K=s[l++];for(V=0;V<K;V++){T=s[l];var I=s[l+1]>>4,z=15&s[l+1];P<I&&(P=I),S<z&&(S=z);var k=s[l+2];w=n.W.push({h:I,A:z,L:k,$:null}),n._[T]=w-1,l+=3}n.X=P,n.B=S,Z(n);break;case 65476:var F=r(s,l);for(l+=2,V=2;V<F;){var U=s[l++],R=new Uint8Array(16),H=0;for(x=0;x<16;x++,l++)H+=R[x]=s[l];var D=new Uint8Array(H);for(x=0;x<H;x++,l++)D[x]=s[l];V+=17+H,(U>>4?f:L)[15&U]=u(R,D)}break;case 65501:o=r(s,l+=2),l+=2;break;case 65498:var j,E=1===++h&&!a;l+=2;var C=s[l++],J=[];for(V=0;V<C;V++){var N=s[l++],B=n._[N];(j=n.W[B]).index=N;var O=s[l++];j.J=L[O>>4],j.i=f[15&O],J.push(j)}var Q=s[l++],A=s[l++],_=s[l++];try{var q=b(s,l,n,J,o,Q,A,_>>4,15&_,E);l+=q}catch(et){if(et instanceof DNLMarkerError)return this.parse(s,{F:et.s});if(et instanceof EOIMarkerError)break t;throw et}break;case 65500:l+=4;break;case 65535:255!==s[l]&&l--;break;default:var $=y(s,l-2,l-3);if($&&$.u){l=$.offset;break}if(l>=s.length-1)break t;throw new t("JpegImage.parse - unknown marker: "+G.toString(16))}G=r(s,l),l+=2}for(this.width=n.o,this.height=n.s,this.g=d,this.b=c,this.W=[],V=0;V<n.W.length;V++){var tt=W[(j=n.W[V]).L];tt&&(j.$=tt),this.W.push({index:j.index,e:p(0,j),l:j.h/n.X,t:j.A/n.B,P:j.P,c:j.c})}this.p=this.W.length},Y(t,e,r){null==r&&(r=!1);var s,i,n,o,a,l,d,c,h,u,m,b,Z=this.width/t,p=this.height/e,y=0,W=this.W.length,f=t*e*W,L=new Uint8ClampedArray(f),G=new Uint32Array(t),V=4294967288;for(d=0;d<W;d++){if(i=(s=this.W[d]).l*Z,n=s.t*p,y=d,m=s.e,o=s.P+1<<3,i!==b){for(a=0;a<t;a++)c=0|a*i,G[a]=(c&V)<<3|7&c;b=i}for(l=0;l<e;l++)for(u=o*((c=0|l*n)&V)|(7&c)<<3,a=0;a<t;a++)L[y]=m[u+G[a]],y+=W}var x=this.V;if(!r&&4===W&&!x&&(x=new Int32Array([-256,255,-256,255,-256,255,-256,255])),x)for(d=0;d<f;)for(c=0,h=0;c<W;c++,d++,h+=2)L[d]=(L[d]*x[h]>>8)+x[h+1];return L},get f(){return this.b?!!this.b.a:3===this.p?0!==this.N&&!(82===this.W[0].index&&71===this.W[1].index&&66===this.W[2].index):1===this.N},z:function(t){for(var e,r,s,i=0,n=t.length;i<n;i+=3)e=t[i],r=t[i+1],s=t[i+2],t[i]=e-179.456+1.402*s,t[i+1]=e+135.459-.344*r-.714*s,t[i+2]=e-226.816+1.772*r;return t},O:function(t){for(var e,r,s,i,n=0,o=0,a=t.length;o<a;o+=4)e=t[o],r=t[o+1],s=t[o+2],i=t[o+3],t[n++]=r*(-660635669420364e-19*r+.000437130475926232*s-54080610064599e-18*e+.00048449797120281*i-.154362151871126)-122.67195406894+s*(-.000957964378445773*s+.000817076911346625*e-.00477271405408747*i+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),t[n++]=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*s+.000659397001245577*e+.000426105652938837*i-.176491792462875)+s*(-.000778269941513683*s+.00130872261408275*e+.000770482631801132*i-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),t[n++]=r*(-.000570115196973677*r-263409051004589e-19*s+.0020741088115012*e-.00288260236853442*i+.814272968359295)-20.810012546947+s*(-153496057440975e-19*s-.000132689043961446*e+.000560833691242812*i-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return t.subarray(0,n)},r:function(t){for(var e,r,s,i=0,n=t.length;i<n;i+=4)e=t[i],r=t[i+1],s=t[i+2],t[i]=434.456-e-1.402*s,t[i+1]=119.541-e+.344*r+.714*s,t[i+2]=481.816-e-1.772*r;return t},U:function(t){for(var e,r,s,i,n=0,o=0,a=t.length;o<a;o+=4)e=t[o],r=t[o+1],s=t[o+2],i=t[o+3],t[n++]=255+e*(-6747147073602441e-20*e+.0008379262121013727*r+.0002894718188643294*s+.003264231057537806*i-1.1185611867203937)+r*(26374107616089405e-21*r-8626949158638572e-20*s-.0002748769067499491*i-.02155688794978967)+s*(-3878099212869363e-20*s-.0003267808279485286*i+.0686742238595345)-i*(.0003361971776183937*i+.7430659151342254),t[n++]=255+e*(.00013596372813588848*e+.000924537132573585*r+.00010567359618683593*s+.0004791864687436512*i-.3109689587515875)+r*(-.00023545346108370344*r+.0002702845253534714*s+.0020200308977307156*i-.7488052167015494)+s*(6834815998235662e-20*s+.00015168452363460973*i-.09751927774728933)-i*(.0003189131175883281*i+.7364883807733168),t[n++]=255+e*(13598650411385307e-21*e+.00012423956175490851*r+.0004751985097583589*s-36729317476630422e-22*i-.05562186980264034)+r*(.00016141380598724676*r+.0009692239130725186*s+.0007782692450036253*i-.44015232367526463)+s*(5.068882914068769e-7*s+.0017778369011375071*i-.7591454649749609)-i*(.0003435319965105553*i+.7063770186160144);return t.subarray(0,n)},getData:function(e){var r=e.width,s=e.height,i=e.forceRGB,n=e.isSourcePDF;if(this.p>4)throw new t("Unsupported color mode");var o=this.Y(r,s,n);if(1===this.p&&i){for(var a=o.length,l=new Uint8ClampedArray(3*a),d=0,c=0;c<a;c++){var h=o[c];l[d++]=h,l[d++]=h,l[d++]=h}return l}if(3===this.p&&this.f)return this.z(o);if(4===this.p){if(this.f)return i?this.O(o):this.r(o);if(i)return this.U(o)}return o}},h}();function r(t,e){return t[e]<<8|t[e+1]}Ft.JpegDecoder=e}(),Ft.encodeImage=function(t,e,r,s){var i={t256:[e],t257:[r],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[r],t279:[e*r*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(s)for(var n in s)i[n]=s[n];var o=new Uint8Array(Ft.encode([i])),a=new Uint8Array(t),l=new Uint8Array(1e3+e*r*4);for(n=0;n<o.length;n++)l[n]=o[n];for(n=0;n<a.length;n++)l[1e3+n]=a[n];return l.buffer},Ft.encode=function(t){var e=new Uint8Array(2e4),r=4,s=Ft._binBE;e[0]=e[1]=77,s.writeUshort(e,2,42);var i=8;s.writeUint(e,r,i),r+=4;for(var n=0;n<t.length;n++){var o=Ft._writeIFD(s,Ft._types.basic,e,i,t[n]);i=o[1],n<t.length-1&&(3&i&&(i+=4-(3&i)),s.writeUint(e,o[0],i))}return e.slice(0,i).buffer},Ft.decode=function(t,e){null==e&&(e={parseMN:!0,debug:!1});var r=new Uint8Array(t),s=0,i=Ft._binBE.readASCII(r,s,2);s+=2;var n="II"==i?Ft._binLE:Ft._binBE;n.readUshort(r,s),s+=2;var o=n.readUint(r,s);s+=4;for(var a=[];;){var l=n.readUshort(r,o),d=n.readUshort(r,o+4);if(0!=l&&(d<1||13<d)){log("error in TIFF");break}if(Ft._readIFD(n,r,o,a,0,e),0==(o=n.readUint(r,o+2+12*l)))break}return a},Ft.decodeImage=function(t,e,r){if(!e.data){var s=new Uint8Array(t),i=Ft._binBE.readASCII(s,0,2);if(null!=e.t256){e.isLE="II"==i,e.width=e.t256[0],e.height=e.t257[0];var n=e.t259?e.t259[0]:1,o=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&log("PlanarConfiguration 2 should not be used!"),7==n&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3));var a=e.t277?e.t277[0]:1,l=(e.t258?e.t258[0]:1)*a;1==n&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(l=Math.round(8*e.t279[0]/(e.width*e.t278[0]))),e.t50885&&4==e.t50885[0]&&(l=3*e.t258[0]);var d=8*Math.ceil(e.width*l/8),c=e.t273;(null==c||e.t322)&&(c=e.t324);var h=e.t279;1==n&&1==c.length&&(h=[e.height*(d>>>3)]),(null==h||e.t322)&&(h=e.t325);var u=new Uint8Array(e.height*(d>>>3)),m=0;if(null!=e.t322){var b=e.t322[0],Z=e.t323[0],p=Math.floor((e.width+b-1)/b),y=Math.floor((e.height+Z-1)/Z),W=new Uint8Array(0|Math.ceil(b*Z*l/8));console.log("====",p,y);for(var f=0;f<y;f++)for(var L=0;L<p;L++){var G=f*p+L;W.fill(0),Ft.decode._decompress(e,r,s,c[G],h[G],n,W,0,o,b,Z),6==n?u=W:Ft._copyTile(W,0|Math.ceil(b*l/8),Z,u,0|Math.ceil(e.width*l/8),e.height,0|Math.ceil(L*b*l/8),f*Z)}m=8*u.length}else{if(null==c)return;var V=e.t278?e.t278[0]:e.height;V=Math.min(V,e.height);for(G=0;G<c.length;G++)Ft.decode._decompress(e,r,s,c[G],h[G],n,u,0|Math.ceil(m/8),o,e.width,V),m+=d*V;m=Math.min(m,8*u.length)}e.data=new Uint8Array(u.buffer,0,0|Math.ceil(m/8))}}},Ft.decode._decompress=function(t,e,r,s,i,n,o,a,l,d,c){if(t.t271&&"Panasonic"==t.t271[0]&&t.t45&&6==t.t45[0]&&(n=34316),1==n)for(var h=0;h<i;h++)o[a+h]=r[s+h];else if(2==n)Ft.decode._decodeG2(r,s,i,o,a,d,l);else if(3==n)Ft.decode._decodeG3(r,s,i,o,a,d,l,!!t.t292&&!(1&~t.t292[0]));else if(4==n)Ft.decode._decodeG4(r,s,i,o,a,d,l);else if(5==n)Ft.decode._decodeLZW(r,s,i,o,a,8);else if(6==n)Ft.decode._decodeOldJPEG(t,r,s,i,o,a);else if(7==n||34892==n)Ft.decode._decodeNewJPEG(t,r,s,i,o,a);else if(8==n||32946==n){var u=new Uint8Array(r.buffer,s+2,i-6),m=Ft._inflateRaw(u);a+m.length<=o.length&&o.set(m,a)}else 9==n?Ft.decode._decodeVC5(r,s,i,o,a,t.t33422):32767==n?Ft.decode._decodeARW(t,r,s,i,o,a):32773==n?Ft.decode._decodePackBits(r,s,i,o,a):32809==n?Ft.decode._decodeThunder(r,s,i,o,a):34316==n?Ft.decode._decodePanasonic(t,r,s,i,o,a):34713==n?Ft.decode._decodeNikon(t,e,r,s,i,o,a):34676==n?Ft.decode._decodeLogLuv32(t,r,s,i,o,a):log("Unknown compression",n);var b=t.t258?Math.min(32,t.t258[0]):1,Z=t.t277?t.t277[0]:1,p=b*Z>>>3,y=Math.ceil(b*Z*d/8);if(16==b&&!t.isLE&&null==t.t33422)for(var W=0;W<c;W++)for(var f=a+W*y,L=1;L<y;L+=2){var G=o[f+L];o[f+L]=o[f+L-1],o[f+L-1]=G}if(t.t317&&2==t.t317[0])for(W=0;W<c;W++){var V=a+W*y;if(16==b)for(h=p;h<y;h+=2){var x=(o[V+h+1]<<8|o[V+h])+(o[V+h-p+1]<<8|o[V+h-p]);o[V+h]=255&x,o[V+h+1]=x>>>8&255}else if(3==Z)for(h=3;h<y;h+=3)o[V+h]=o[V+h]+o[V+h-3]&255,o[V+h+1]=o[V+h+1]+o[V+h-2]&255,o[V+h+2]=o[V+h+2]+o[V+h-1]&255;else for(h=p;h<y;h++)o[V+h]=o[V+h]+o[V+h-p]&255}},Ft.decode._decodePanasonic=function(t,e,r,s,i,n){var o,a,l,d,c,h,u,m,b=e.buffer,Z=t.t2[0],p=t.t3[0],y=t.t10[0],W=t.t45[0],f=0,L=0,G=0,V=0,x=6==W?new Uint32Array(18):new Uint8Array(16),w=[0,0],g=[0,0],v=0,M=new Uint8Array(16384),X=new Uint16Array(i.buffer);function T(t){if(0==G){var e=new Uint8Array(b,r+L+8184,8200),s=new Uint8Array(b,r+L,8184);M.set(e),M.set(s,e.length),L+=16384}if(5!=W)return(M[V=(G=G-t&131071)>>3^16368]|M[V+1]<<8)>>(7&G)&~(-1<<t);for(o=0;o<16;o++)x[o]=M[G++],G&=16383}function Y(t){return M[G+15-t]}function P(){w[0]=0,w[1]=0,g[0]=0,g[1]=0}if(7==W)throw W;if(6==W){var S=12==y,K=S?function(){x[0]=Y(0)<<4|Y(1)>>4,x[1]=4095&((15&Y(1))<<8|Y(2)),x[2]=Y(3)>>6&3,x[3]=(63&Y(3))<<2|Y(4)>>6,x[4]=(63&Y(4))<<2|Y(5)>>6,x[5]=(63&Y(5))<<2|Y(6)>>6,x[6]=Y(6)>>4&3,x[7]=(15&Y(6))<<4|Y(7)>>4,x[8]=(15&Y(7))<<4|Y(8)>>4,x[9]=(15&Y(8))<<4|Y(9)>>4,x[10]=Y(9)>>2&3,x[11]=(3&Y(9))<<6|Y(10)>>2,x[12]=(3&Y(10))<<6|Y(11)>>2,x[13]=(3&Y(11))<<6|Y(12)>>2,x[14]=3&Y(12),x[15]=Y(13),x[16]=Y(14),x[17]=Y(15),G+=16,V=0}:function(){x[0]=Y(0)<<6|Y(1)>>2,x[1]=16383&((3&Y(1))<<12|Y(2)<<4|Y(3)>>4),x[2]=Y(3)>>2&3,x[3]=(3&Y(3))<<8|Y(4),x[4]=Y(5)<<2|Y(6)>>6,x[5]=(63&Y(6))<<4|Y(7)>>4,x[6]=Y(7)>>2&3,x[7]=(3&Y(7))<<8|Y(8),x[8]=Y(9)<<2&1020|Y(10)>>6,x[9]=1023&(Y(10)<<4|Y(11)>>4),x[10]=Y(11)>>2&3,x[11]=(3&Y(11))<<8|Y(12),x[12]=1023&(Y(13)<<2&1020|Y(14)>>6),x[13]=1023&(Y(14)<<4|Y(15)>>4),G+=16,V=0},I=S?14:11,z=S?128:512,k=S?2048:8192,F=S?16383:65535,U=S?4095:16383,R=Z/I,H=16*R,D=S?18:14;for(h=0;h<p-15;h+=16){var j=Math.min(16,p-h),E=H*j;for(M=new Uint8Array(b,r+f,E),G=0,f+=E,m=0,u=0;m<j;m++,u=0){v=(h+m)*Z;for(var C=0;C<R;C++)for(K(),P(),l=0,c=0,o=0;o<I;o++){if(d=1&o,o%3==2){var J=V<D?x[V++]:0;3==J&&(J=4),c=z<<J,l=1<<J}var N=V<D?x[V++]:0;w[d]?(N*=l,c<k&&g[d]>c&&(N+=g[d]-c),g[d]=N):(w[d]=N,N?g[d]=N:N=g[d]),X[v+u++]=N-15<=F?N-15&F:N+2147483633>>31&U}}}}else if(5==W){var B=12==y?10:9;for(h=0;h<p;h++)for(u=0;u<Z;u+=B)T(0),12==y?(X[v++]=((15&x[1])<<8)+x[0],X[v++]=16*x[2]+(x[1]>>4),X[v++]=((15&x[4])<<8)+x[3],X[v++]=16*x[5]+(x[4]>>4),X[v++]=((15&x[7])<<8)+x[6],X[v++]=16*x[8]+(x[7]>>4),X[v++]=((15&x[10])<<8)+x[9],X[v++]=16*x[11]+(x[10]>>4),X[v++]=((15&x[13])<<8)+x[12],X[v++]=16*x[14]+(x[13]>>4)):14==y&&(X[v++]=x[0]+((63&x[1])<<8),X[v++]=(x[1]>>6)+4*x[2]+((15&x[3])<<10),X[v++]=(x[3]>>4)+16*x[4]+((3&x[5])<<12),X[v++]=((252&x[5])>>2)+(x[6]<<6),X[v++]=x[7]+((63&x[8])<<8),X[v++]=(x[8]>>6)+4*x[9]+((15&x[10])<<10),X[v++]=(x[10]>>4)+16*x[11]+((3&x[12])<<12),X[v++]=((252&x[12])>>2)+(x[13]<<6),X[v++]=x[14]+((63&x[15])<<8))}else{if(4!=W)throw W;for(h=0;h<p;h++)for(u=0;u<Z;u++)d=1&(o=u%14),0==o&&P(),o%3==2&&(l=4>>3-T(2)),g[d]?0!=(a=T(8))&&(w[d]-=128<<l,(w[d]<0||4==l)&&(w[d]&=~(-1<<l)),w[d]+=a<<l):(g[d]=T(8),(g[d]||o>11)&&(w[d]=g[d]<<4|T(4))),X[v++]=w[1&u]}},Ft.decode._decodeVC5=function(){var t,e,r,s=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],i=[3,3,3,3,2,2,2,1,1,1];function n(t){var e=t[1],r=t[0][e>>>3]>>>7-(7&e)&1;return t[1]++,r}function o(e,r){if(null==t){t={};for(var i=0;i<s.length;i+=4)t[s[i+1]]=s.slice(i,i+4)}for(var o=n(e),a=t[o];null==a;)o=o<<1|n(e),a=t[o];var l=a[3];0!=l&&(l=0==n(e)?l:-l),r[0]=a[2],r[1]=l}function a(t,e){for(var r=0;r<e;r++)!(1&~t)&&t++,t>>>=1;return t}function l(t,e){return t>>e}function d(t,e,r,s,i,n){e[r]=l(l(11*t[i]-4*t[i+n]+t[i+n+n]+4,3)+t[s],1),e[r+n]=l(l(5*t[i]+4*t[i+n]-t[i+n+n]+4,3)-t[s],1)}function c(t,e,r,s,i,n){var o=t[i-n]-t[i+n],a=t[i],d=t[s];e[r]=l(l(o+4,3)+a+d,1),e[r+n]=l(l(4-o,3)+a-d,1)}function h(t,e,r,s,i,n){e[r]=l(l(5*t[i]+4*t[i-n]-t[i-n-n]+4,3)+t[s],1),e[r+n]=l(l(11*t[i]-4*t[i-n]+t[i-n-n]+4,3)-t[s],1)}function u(t){return t=r[t=t<0?0:t>4095?4095:t]>>>2}return function(t,s,n,l,m,b){l=new Uint16Array(l.buffer);var Z,p,y,W,f,L,G,V,x=Date.now(),w=Ft._binBE,g=s+n;s+=4;for(var v=1==b[0];s<g;){var M=w.readShort(t,s),X=w.readUshort(t,s+2);if(s+=4,12==M)z=X;else if(20==M)Z=X;else if(21==M)p=X;else if(48==M)y=X;else if(53==M)W=X;else if(35!=M)if(62==M)f=X;else if(101!=M)if(109==M)L=X;else if(84!=M&&106!=M&&107!=M&&108!=M&&102!=M)if(104==M)et=X;else if(105!=M){var T=M<0?-M:M,Y=65280&T,P=0;if(24576&T&&(8192&T?(P=65535&X,P+=(255&T)<<16):P=65535&X),24576&~T){if(16388==T)s+=4*P;else if(8192!=Y&&8448!=Y&&9216!=Y)throw T.toString(16)}else{if(null==G){G=[];for(var S=0;S<4;S++)G[S]=new Int16Array((Z>>>1)*(p>>>1));V=new Int16Array((Z>>>1)*(p>>>1)),e=new Int16Array(1024);for(S=0;S<1024;S++){var K=S-512,I=Math.abs(K),z=Math.floor(768*I*I*I/16581375)+I;e[S]=Math.sign(K)*z}r=new Uint16Array(4096);for(S=0;S<4096;S++){var k=S,F=65535*(Math.pow(113,k/4095)-1)/112;r[S]=Math.min(F,65535)}}var U=G[f],R=a(Z,1+i[y]),H=a(p,1+i[y]);if(0==y)for(var D=0;D<H;D++)for(var j=0;j<R;j++){var E=s+2*(D*R+j);U[D*(Z>>>1)+j]=t[E]<<8|t[E+1]}else{var C=[t,8*s],J=[],N=0,B=R*H,O=[0,0],Q=0;for(X=0;N<B;)for(o(C,O),Q=O[0],X=O[1];Q>0;)J[N++]=X,Q--;var A=(y-1)%3,_=1!=A?R:0,q=0!=A?H:0;for(D=0;D<H;D++){var $=(D+q)*(Z>>>1)+_,tt=D*R;for(j=0;j<R;j++)U[$+j]=e[J[tt+j]+512]*W}if(2==A){var et=Z>>>1,rt=2*R,st=2*H;for(D=0;D<H;D++)for(j=0;j<rt;j++){S=2*D*et+j;var it=H*et+(ot=D*et+j);0==D?d(U,V,S,it,ot,et):D==H-1?h(U,V,S,it,ot,et):c(U,V,S,it,ot,et)}var nt=U;U=V,V=nt;for(D=0;D<st;D++)for(j=0;j<R;j++){var ot;S=D*et+2*j,it=R+(ot=D*et+j);0==j?d(U,V,S,it,ot,1):j==R-1?h(U,V,S,it,ot,1):c(U,V,S,it,ot,1)}nt=U;U=V,V=nt;for(var at=[],lt=2-~~((y-1)/3),dt=0;dt<3;dt++)at[dt]=L>>14-2*dt&3;var ct=at[lt];if(0!=ct)for(D=0;D<st;D++)for(j=0;j<rt;j++){U[S=D*et+j]=U[S]<<ct}}}if(9==y&&3==f){var ht=G[0],ut=G[1],mt=G[2],bt=G[3];for(D=0;D<p;D+=2)for(j=0;j<Z;j+=2){var Zt=D*Z+j,pt=ht[E=(D>>>1)*(Z>>>1)+(j>>>1)],yt=ut[E]-2048,Wt=mt[E]-2048,ft=bt[E]-2048,Lt=(yt<<1)+pt,Gt=(Wt<<1)+pt,Vt=pt+ft,xt=pt-ft;v?(l[Zt]=u(Vt),l[Zt+1]=u(Gt),l[Zt+Z]=u(Lt),l[Zt+Z+1]=u(xt)):(l[Zt]=u(Lt),l[Zt+1]=u(Vt),l[Zt+Z]=u(xt),l[Zt+Z+1]=u(Gt))}}s+=4*P}}}console.log(Date.now()-x)}}(),Ft.decode._decodeLogLuv32=function(t,e,r,s,i,n){for(var o=t.width,a=4*o,l=0,d=new Uint8Array(a);l<s;){for(var c=0;c<a;){var h=e[r+l];if(l++,h<128){for(var u=0;u<h;u++)d[c+u]=e[r+l+u];c+=h,l+=h}else{h-=126;for(u=0;u<h;u++)d[c+u]=e[r+l];c+=h,l++}}for(var m=0;m<o;m++)i[n+0]=d[m],i[n+1]=d[m+o],i[n+2]=d[m+2*o],i[n+4]=d[m+3*o],n+=6}},Ft.decode._ljpeg_diff=function(t,e,r){var s,i,n=Ft.decode._getbithuff;return s=n(t,e,r[0],r),(i=n(t,e,s,0))&1<<s-1||(i-=(1<<s)-1),i},Ft.decode._decodeARW=function(t,e,r,s,i,n){var o=t.t256[0],a=t.t257[0],l=t.t258[0],d=t.isLE?Ft._binLE:Ft._binBE;if(o*a==s||o*a*1.5==s)if(o*a*1.5!=s){var c,h,u,m,b,Z,p,y,W=new Uint16Array(16),f=new Uint8Array(o+1);for(M=0;M<a;M++){for(var L=0;L<o;L++)f[L]=e[r++];for(y=0,v=0;v<o-30;y+=16){for(h=2047&(c=d.readUint(f,y)),u=2047&c>>>11,m=15&c>>>22,b=15&c>>>26,Z=0;Z<4&&128<<Z<=h-u;Z++);for(p=30,G=0;G<16;G++)G==m?W[G]=h:G==b?W[G]=u:(W[G]=((d.readUshort(f,y+(p>>3))>>>(7&p)&127)<<Z)+u,W[G]>2047&&(W[G]=2047),p+=7);for(G=0;G<16;G++,v+=2){z=W[G]<<1;Ft.decode._putsF(i,(M*o+v)*l,z<<16-l)}v-=1&v?1:31}}}else for(var G=0;G<s;G+=3){var V=e[r+G+0],x=e[r+G+1],w=e[r+G+2];i[n+G]=x<<4|V>>>4,i[n+G+1]=V<<4|w>>>4,i[n+G+2]=w<<4|x>>>4}else{a+=8;var g,v,M,X=[r,0,0,0],T=new Uint16Array(32770),Y=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],P=0,S=Ft.decode._ljpeg_diff;for(T[0]=15,g=G=0;G<18;G++)for(var K=32768>>>(Y[G]>>>8),I=0;I<K;I++)T[++g]=Y[G];for(v=o;v--;)for(M=0;M<a+1;M+=2)if(M==a&&(M=1),P+=S(e,X,T),M<a){var z=4095&P;Ft.decode._putsF(i,(M*o+v)*l,z<<16-l)}}},Ft.decode._decodeNikon=function(t,e,r,s,i,n,o){var a=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],l=t.t256[0],d=t.t257[0],c=t.t258[0],h=0,u=0,m=Ft.decode._make_decoder,b=Ft.decode._getbithuff,Z=e[0].exifIFD.makerNote,p=Z.t150?Z.t150:Z.t140,y=0,W=p[y++],f=p[y++];(73==W||88==f)&&(y+=2110),70==W&&(h=2),14==c&&(h+=3);for(var L=[[0,0],[0,0]],G=t.isLE?Ft._binLE:Ft._binBE,V=0;V<2;V++)for(var x=0;x<2;x++)L[V][x]=G.readShort(p,y),y+=2;var w=1<<c&32767,g=0,v=G.readShort(p,y);y+=2,v>1&&(g=Math.floor(w/(v-1))),68==W&&32==f&&g>0&&(u=G.readShort(p,562));var M,X,T,Y,P,S=[0,0],K=m(a[h]),I=[s,0,0,0];for(M=0;M<d;M++)for(u&&M==u&&(K=m(a[h+1])),X=0;X<l;X++){V=b(r,I,K[0],K),(P=1+(b(r,I,(T=15&V)-(Y=V>>>4),0)<<1)<<Y>>>1)&1<<T-1||(P-=(1<<T)-(0==Y?1:0)),X<2?S[X]=L[1&M][X]+=P:S[1&X]+=P;var z=Math.min(Math.max(S[1&X],0),(1<<c)-1),k=(M*l+X)*c;Ft.decode._putsF(n,k,z<<16-c)}},Ft.decode._putsF=function(t,e,r){r<<=8-(7&e);var s=e>>>3;t[s]|=r>>>16,t[s+1]|=r>>>8,t[s+2]|=r},Ft.decode._getbithuff=function(t,e,r,s){Ft.decode._get_byte;var i,n=e[0],o=e[1],a=e[2],l=e[3];if(0==r||a<0)return 0;for(;!l&&a<r&&-1!=(i=t[n++])&&!(l=0);)o=(o<<8)+i,a+=8;if(i=o<<32-a>>>32-r,s?(a-=s[i+1]>>>8,i=255&s[i+1]):a-=r,a<0)throw"e";return e[0]=n,e[1]=o,e[2]=a,e[3]=l,i},Ft.decode._make_decoder=function(t){var e,r,s,i,n,o=[];for(e=16;0!=e&&!t[e];e--);var a=17;for(o[0]=e,s=r=1;r<=e;r++)for(i=0;i<t[r];i++,++a)for(n=0;n<1<<e-r;n++)s<=1<<e&&(o[s++]=r<<8|t[a]);return o},Ft.decode._decodeNewJPEG=function(t,e,r,s,i,n){s=Math.min(s,e.length-r);var o=t.t347,a=o?o.length:0,l=new Uint8Array(a+s);if(o){for(var d=0,c=0;c<a-1&&(255!=o[c]||217!=o[c+1]);c++)l[d++]=o[c];var h=e[r],u=e[r+1];(255!=h||216!=u)&&(l[d++]=h,l[d++]=u);for(c=2;c<s;c++)l[d++]=e[r+c]}else for(c=0;c<s;c++)l[c]=e[r+c];if(32803==t.t262[0]||7==t.t259[0]&&34892==t.t262[0]){var m=t.t258[0],b=Ft.LosslessJpegDecode(l),Z=b.length;if(16==m)if(t.isLE)for(c=0;c<Z;c++)i[n+(c<<1)]=255&b[c],i[n+(c<<1)+1]=b[c]>>>8;else for(c=0;c<Z;c++)i[n+(c<<1)]=b[c]>>>8,i[n+(c<<1)+1]=255&b[c];else if(14==m||12==m||10==m){var p=16-m;for(c=0;c<Z;c++)Ft.decode._putsF(i,c*m,b[c]<<p)}else{if(8!=m)throw new Error("unsupported bit depth "+m);for(c=0;c<Z;c++)i[n+c]=b[c]}}else{var y=new Ft.JpegDecoder;y.parse(l);var W=y.getData({width:y.width,height:y.height,forceRGB:!0,isSourcePDF:!1});for(c=0;c<W.length;c++)i[n+c]=W[c]}6==t.t262[0]&&(t.t262[0]=2)},Ft.decode._decodeOldJPEGInit=function(t,e,r,s){var i,n,o,a,l,d=216,c=0,h=0,u=!1,m=t.t513,b=m?m[0]:0,Z=t.t514,p=Z?Z[0]:0,y=t.t324||t.t273||m,W=t.t530,f=0,L=0,G=t.t277?t.t277[0]:1,V=t.t515;if(y&&(h=y[0],u=y.length>1),!u){if(255==e[r]&&e[r+1]==d)return{jpegOffset:r};if(null!=m&&(255==e[r+b]&&e[r+b+1]==d?c=r+b:log("JPEGInterchangeFormat does not point to SOI"),null==Z?log("JPEGInterchangeFormatLength field is missing"):(b>=h||b+p<=h)&&log("JPEGInterchangeFormatLength field value is invalid"),null!=c))return{jpegOffset:c}}if(null!=W&&(f=W[0],L=W[1]),null!=m&&null!=Z)if(p>=2&&b+p<=h){for(i=255==e[r+b+p-2]&&e[r+b+p-1]==d?new Uint8Array(p-2):new Uint8Array(p),o=0;o<i.length;o++)i[o]=e[r+b+o];log("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else log("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==i){var x=0,w=[];w[x++]=255,w[x++]=d;var g=t.t519;if(null==g)throw new Error("JPEGQTables tag is missing");for(o=0;o<g.length;o++)for(w[x++]=255,w[x++]=219,w[x++]=0,w[x++]=67,w[x++]=o,a=0;a<64;a++)w[x++]=e[r+g[o]+a];for(l=0;l<2;l++){var v=t[0==l?"t520":"t521"];if(null==v)throw new Error((0==l?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(o=0;o<v.length;o++){w[x++]=255,w[x++]=196;var M=19;for(a=0;a<16;a++)M+=e[r+v[o]+a];for(w[x++]=M>>>8,w[x++]=255&M,w[x++]=o|l<<4,a=0;a<16;a++)w[x++]=e[r+v[o]+a];for(a=0;a<M;a++)w[x++]=e[r+v[o]+16+a]}}if(w[x++]=255,w[x++]=192,w[x++]=0,w[x++]=8+3*G,w[x++]=8,w[x++]=t.height>>>8&255,w[x++]=255&t.height,w[x++]=t.width>>>8&255,w[x++]=255&t.width,w[x++]=G,1==G)w[x++]=1,w[x++]=17,w[x++]=0;else for(o=0;o<3;o++)w[x++]=o+1,w[x++]=0!=o?17:(15&f)<<4|15&L,w[x++]=o;null!=V&&0!=V[0]&&(w[x++]=255,w[x++]=221,w[x++]=0,w[x++]=4,w[x++]=V[0]>>>8&255,w[x++]=255&V[0]),i=new Uint8Array(w)}var X=-1;for(o=0;o<i.length-1;){if(255==i[o]&&192==i[o+1]){X=o;break}o++}if(-1==X){var T=new Uint8Array(i.length+10+3*G);T.set(i);var Y=i.length;if(X=i.length,(i=T)[Y++]=255,i[Y++]=192,i[Y++]=0,i[Y++]=8+3*G,i[Y++]=8,i[Y++]=t.height>>>8&255,i[Y++]=255&t.height,i[Y++]=t.width>>>8&255,i[Y++]=255&t.width,i[Y++]=G,1==G)i[Y++]=1,i[Y++]=17,i[Y++]=0;else for(o=0;o<3;o++)i[Y++]=o+1,i[Y++]=0!=o?17:(15&f)<<4|15&L,i[Y++]=o}if(255==e[h]&&218==e[h+1]){var P=e[h+2]<<8|e[h+3];for((n=new Uint8Array(P+2))[0]=e[h],n[1]=e[h+1],n[2]=e[h+2],n[3]=e[h+3],o=0;o<P-2;o++)n[o+4]=e[h+o+4]}else{var S=0;if((n=new Uint8Array(8+2*G))[S++]=255,n[S++]=218,n[S++]=0,n[S++]=6+2*G,n[S++]=G,1==G)n[S++]=1,n[S++]=0;else for(o=0;o<3;o++)n[S++]=o+1,n[S++]=o<<4|o;n[S++]=0,n[S++]=63,n[S++]=0}return{jpegOffset:r,tables:i,sosMarker:n,sofPosition:X}},Ft.decode._decodeOldJPEG=function(t,e,r,s,i,n){var o,a,l,d,c=Ft.decode._decodeOldJPEGInit(t,e,r,s);if(null!=c.jpegOffset)for(o=r+s-c.jpegOffset,l=new Uint8Array(o),m=0;m<o;m++)l[m]=e[c.jpegOffset+m];else{for(a=c.tables.length,(l=new Uint8Array(a+c.sosMarker.length+s+2)).set(c.tables),d=a,l[c.sofPosition+5]=t.height>>>8&255,l[c.sofPosition+6]=255&t.height,l[c.sofPosition+7]=t.width>>>8&255,l[c.sofPosition+8]=255&t.width,(255!=e[r]||e[r+1]!=SOS)&&(l.set(c.sosMarker,d),d+=sosMarker.length),m=0;m<s;m++)l[d++]=e[r+m];l[d++]=255,l[d++]=EOI}var h=new Ft.JpegDecoder;h.parse(l);for(var u=h.getData({width:h.width,height:h.height,forceRGB:!0,isSourcePDF:!1}),m=0;m<u.length;m++)i[n+m]=u[m];t.t262&&6==t.t262[0]&&(t.t262[0]=2)},Ft.decode._decodePackBits=function(t,e,r,s,i){for(var n=new Int8Array(t.buffer),o=new Int8Array(s.buffer),a=e+r;e<a;){var l=n[e];if(e++,l>=0&&l<128)for(var d=0;d<l+1;d++)o[i]=n[e],i++,e++;if(l>=-127&&l<0){for(d=0;d<1-l;d++)o[i]=n[e],i++;e++}}return i},Ft.decode._decodeThunder=function(t,e,r,s,i){for(var n=[0,1,0,-1],o=[0,1,2,3,0,-3,-2,-1],a=e+r,l=2*i,d=0;e<a;){var c=t[e],h=c>>>6,u=63&c;if(e++,3==h&&(d=15&u,s[l>>>1]|=d<<4*(1-l&1),l++),0==h)for(var m=0;m<u;m++)s[l>>>1]|=d<<4*(1-l&1),l++;if(2==h)for(m=0;m<2;m++){4!=(b=u>>>3*(1-m)&7)&&(d+=o[b],s[l>>>1]|=d<<4*(1-l&1),l++)}if(1==h)for(m=0;m<3;m++){var b;2!=(b=u>>>2*(2-m)&3)&&(d+=n[b],s[l>>>1]|=d<<4*(1-l&1),l++)}}},Ft.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},Ft.decode._lens=function(){var t=function(t,e,r,s){for(var i=0;i<e.length;i++)t[e[i]]=r+i*s},e="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",r="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",s="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",i="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",n="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";e=e.split(","),r=r.split(","),s=s.split(","),i=i.split(","),n=n.split(",");var o={},a={};return t(o,e,0,1),t(o,s,64,64),t(o,n,1792,64),t(a,r,0,1),t(a,i,64,64),t(a,n,1792,64),[o,a]}(),Ft.decode._decodeG4=function(t,e,r,s,i,n,o){for(var a=Ft.decode,l=e<<3,d=0,c="",h=[],u=[],m=0;m<n;m++)u.push(0);u=a._makeDiff(u);for(var b=0,Z=0,p=0,y=0,W=0,f=0,L="",G=0,V=8*Math.ceil(n/8);l>>>3<e+r;){p=a._findDiff(u,b+(0==b?0:1),1-W),y=a._findDiff(u,p,W);var x=0;if(1==o&&(x=t[l>>>3]>>>7-(7&l)&1),2==o&&(x=t[l>>>3]>>>(7&l)&1),l++,c+=x,"H"==L){if(null!=a._lens[W][c]){var w=a._lens[W][c];c="",d+=w,w<64&&(a._addNtimes(h,d,W),b+=d,W=1-W,d=0,0==--G&&(L=""))}}else"0001"==c&&(c="",a._addNtimes(h,y-b,W),b=y),"001"==c&&(c="",L="H",G=2),null!=a._dmap[c]&&(Z=p+a._dmap[c],a._addNtimes(h,Z-b,W),b=Z,c="",W=1-W);h.length==n&&""==L&&(a._writeBits(h,s,8*i+f*V),W=0,f++,b=0,u=a._makeDiff(h),h=[])}},Ft.decode._findDiff=function(t,e,r){for(var s=0;s<t.length;s+=2)if(t[s]>=e&&t[s+1]==r)return t[s]},Ft.decode._makeDiff=function(t){var e=[];1==t[0]&&e.push(0,1);for(var r=1;r<t.length;r++)t[r-1]!=t[r]&&e.push(r,t[r]);return e.push(t.length,0,t.length,1),e},Ft.decode._decodeG2=function(t,e,r,s,i,n,o){for(var a=Ft.decode,l=e<<3,d=0,c="",h=[],u=0,m=0,b=8*Math.ceil(n/8);l>>>3<e+r;){var Z=0;1==o&&(Z=t[l>>>3]>>>7-(7&l)&1),2==o&&(Z=t[l>>>3]>>>(7&l)&1),l++,c+=Z,null!=(d=a._lens[u][c])&&(a._addNtimes(h,d,u),c="",d<64&&(u=1-u),h.length==n&&(a._writeBits(h,s,8*i+m*b),h=[],m++,u=0,7&l&&(l+=8-(7&l)),d>=64&&(l+=8)))}},Ft.decode._decodeG3=function(t,e,r,s,i,n,o,a){for(var l=Ft.decode,d=e<<3,c=0,h="",u=[],m=[],b=0;b<n;b++)u.push(0);for(var Z=0,p=0,y=0,W=0,f=0,L=-1,G="",V=0,x=!0,w=8*Math.ceil(n/8);d>>>3<e+r;){y=l._findDiff(m,Z+(0==Z?0:1),1-f),W=l._findDiff(m,y,f);var g=0;if(1==o&&(g=t[d>>>3]>>>7-(7&d)&1),2==o&&(g=t[d>>>3]>>>(7&d)&1),d++,h+=g,x){if(null!=l._lens[f][h]){var v=l._lens[f][h];h="",c+=v,v<64&&(l._addNtimes(u,c,f),f=1-f,c=0)}}else if("H"==G){if(null!=l._lens[f][h]){v=l._lens[f][h];h="",c+=v,v<64&&(l._addNtimes(u,c,f),Z+=c,f=1-f,c=0,0==--V&&(G=""))}}else"0001"==h&&(h="",l._addNtimes(u,W-Z,f),Z=W),"001"==h&&(h="",G="H",V=2),null!=l._dmap[h]&&(p=y+l._dmap[h],l._addNtimes(u,p-Z,f),Z=p,h="",f=1-f);h.endsWith("000000000001")&&(L>=0&&l._writeBits(u,s,8*i+L*w),a&&(1==o&&(x=1==(t[d>>>3]>>>7-(7&d)&1)),2==o&&(x=1==(t[d>>>3]>>>(7&d)&1)),d++),h="",f=0,L++,Z=0,m=l._makeDiff(u),u=[])}u.length==n&&l._writeBits(u,s,8*i+L*w)},Ft.decode._addNtimes=function(t,e,r){for(var s=0;s<e;s++)t.push(r)},Ft.decode._writeBits=function(t,e,r){for(var s=0;s<t.length;s++)e[r+s>>>3]|=t[s]<<7-(r+s&7)},Ft.decode._decodeLZW=Ft.decode._decodeLZW=function(){var t,e,r,s,i=0,n=0,o=0,a=0,l=function(){var r=t>>>3,s=(e[r]<<16|e[r+1]<<8|e[r+2])>>>24-(7&t)-n&(1<<n)-1;return t+=n,s},d=new Uint32Array(16384),c=0,h=function(t){n=t+1,i=a+1},u=function(t){for(var e=t<<2,i=d[e+2],n=s+i-1;65535!=e;)r[n--]=d[e],e=d[e+1];s+=i},m=function(t,e){var r=i<<2,s=t<<2;d[r]=d[3+(e<<2)],d[r+1]=s,d[r+2]=d[s+2]+1,d[r+3]=d[s+3],++i+1==1<<n&&12!=n&&n++};return function(n,b,Z,p,y,W){t=b<<3,e=n,r=p,s=y;var f=b+Z<<3,L=0,G=0;for(function(t){if(t!=c){c=t,a=1+(o=1<<t);for(var e=0;e<a+1;e++)d[4*e]=d[4*e+3]=e,d[4*e+1]=65535,d[4*e+2]=1}}(W),h(W);t<f&&(L=l())!=a;){if(L==o){if(h(W),(L=l())==a)break;u(L)}else L<i?(u(L),m(G,L)):(m(G,G),u(i-1));G=L}return s}}(),Ft.tags={},Ft._types=function(){var t=new Array(250);t.fill(0);return{basic:{main:t=t.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),Ft._readIFD=function(t,e,r,s,i,n){var o=t.readUshort(e,r);r+=2;var a={};n.debug&&log("   ".repeat(i),s.length-1,">>>----------------");for(var l=0;l<o;l++){var d=t.readUshort(e,r);r+=2;var c=t.readUshort(e,r);r+=2;var h=t.readUint(e,r);r+=4;var u=t.readUint(e,r);r+=4;var m=[];if(1==c||7==c){var b=h<5?r-4:u;b+h>e.buffer.byteLength&&(h=e.buffer.byteLength-b),m=new Uint8Array(e.buffer,b,h)}if(2==c){var Z=h<5?r-4:u,p=e[Z],y=Math.max(0,Math.min(h-1,e.length-Z));p<128||0==y?m.push(t.readASCII(e,Z,y)):m=new Uint8Array(e.buffer,Z,y)}if(3==c)for(var W=0;W<h;W++)m.push(t.readUshort(e,(h<3?r-4:u)+2*W));if(4==c||13==c)for(W=0;W<h;W++)m.push(t.readUint(e,(h<2?r-4:u)+4*W));if(5==c||10==c){var f=5==c?t.readUint:t.readInt;for(W=0;W<h;W++)m.push([f(e,u+8*W),f(e,u+8*W+4)])}if(8==c)for(W=0;W<h;W++)m.push(t.readShort(e,(h<3?r-4:u)+2*W));if(9==c)for(W=0;W<h;W++)m.push(t.readInt(e,(h<2?r-4:u)+4*W));if(11==c)for(W=0;W<h;W++)m.push(t.readFloat(e,u+4*W));if(12==c)for(W=0;W<h;W++)m.push(t.readDouble(e,u+8*W));if(0==h||0!=m.length){if(!(n.debug&&log("   ".repeat(i),d,c,Ft.tags[d],m),a["t"+d]=m,330==d&&a.t272&&"DSLR-A100"==a.t272[0]||!(330==d||34665==d||34853==d||50740==d&&t.readUshort(e,t.readUint(m,0))<300||61440==d))){var L=50740==d?[t.readUint(m,0)]:m,G=[];for(W=0;W<L.length;W++)Ft._readIFD(t,e,L[W],G,i+1,n);330==d&&(a.subIFD=G),34665==d&&(a.exifIFD=G[0]),34853==d&&(a.gpsiIFD=G[0]),50740==d&&(a.dngPrvt=G[0]),61440==d&&(a.fujiIFD=G[0])}if(37500==d&&n.parseMN){var V=m;if("Nikon"==t.readASCII(V,0,5))a.makerNote=Ft.decode(V.slice(10).buffer)[0];else if("OLYMP"==t.readASCII(V,0,5)||"OM SYSTEM"==t.readASCII(V,0,9)){var x=[8208,8224,8240,8256,8272],w=[];Ft._readIFD(t,V,77==V[1]?16:85==V[5]?12:8,w,i+1,n);var g=a.makerNote=w.pop();for(W=0;W<x.length;W++){var v="t"+x[W];null!=g[v]&&(Ft._readIFD(t,V,g[v][0],w,i+1,n),g[v]=w.pop())}g.t12288&&(Ft._readIFD(t,g.t12288,0,w,i+1,n),g.t12288=w.pop())}else if(t.readUshort(e,u)<300&&t.readUshort(e,u+4)<=12){w=[];Ft._readIFD(t,e,u,w,i+1,n),a.makerNote=w[0]}}}else if(log(d,"unknown TIFF tag type: ",c,"num:",h),0==l)return}return s.push(a),n.debug&&log("   ".repeat(i),"<<<---------------"),r},Ft._writeIFD=function(t,e,r,s,i){var n=Object.keys(i),o=n.length;i.exifIFD&&o--,i.gpsiIFD&&o--,t.writeUshort(r,s,o);for(var a=(s+=2)+12*o+4,l=0;l<n.length;l++){var d=n[l];if("t34665"!=d&&"t34853"!=d){"exifIFD"==d&&(d="t34665"),"gpsiIFD"==d&&(d="t34853");var c=parseInt(d.slice(1)),h=e.main[c];if(null==h&&(h=e.rest[c]),null==h||0==h)throw new Error("unknown type of tag: "+c);var u=i[d];if(34665==c)u=[a],a=Ft._writeIFD(t,e,r,a,i.exifIFD)[1];if(34853==c)u=[a],a=Ft._writeIFD(t,Ft._types.gps,r,a,i.gpsiIFD)[1];2==h&&(u=u[0]+"\0");var m=u.length;t.writeUshort(r,s,c),s+=2,t.writeUshort(r,s,h),s+=2,t.writeUint(r,s,m);var b=[-1,1,1,2,4,8,0,1,0,4,8,0,8][h]*m,Z=s+=4;if(b>4&&(t.writeUint(r,s,a),Z=a),1==h||7==h)for(var p=0;p<m;p++)r[Z+p]=u[p];else if(2==h)t.writeASCII(r,Z,u);else if(3==h)for(p=0;p<m;p++)t.writeUshort(r,Z+2*p,u[p]);else if(4==h)for(p=0;p<m;p++)t.writeUint(r,Z+4*p,u[p]);else if(5==h||10==h){var y=5==h?t.writeUint:t.writeInt;for(p=0;p<m;p++){var W=u[p],f=W[0],L=W[1];if(null==f)throw"e";y(r,Z+8*p,f),y(r,Z+8*p+4,L)}}else if(9==h)for(p=0;p<m;p++)t.writeInt(r,Z+4*p,u[p]);else{if(12!=h)throw h;for(p=0;p<m;p++)t.writeDouble(r,Z+8*p,u[p])}b>4&&(a+=b+=1&b),s+=4}}return[s,a]},Ft.toRGBA8=function(t,e){function r(t){return t<.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}var s=t.width,i=t.height,n=s*i,o=t.data,a=new Uint8Array(4*n),l=t.t262?t.t262[0]:2,d=t.t258?Math.min(32,t.t258[0]):1;null==t.t262&&1==d&&(l=0);var c=t.t277?t.t277[0]:t.t258?t.t258.length:[1,1,3,1,1,4,3][l],h=t.t339?t.t339[0]:null;if(1==l&&32==d&&3!=h)throw"e";var u=Math.ceil(c*d*s/8);if(0==l){e=1/256;for(var m=0;m<i;m++){var b=m*u,Z=m*s;if(1==d)for(var p=0;p<s;p++){var y=Z+p<<2,W=o[b+(p>>3)]>>7-(7&p)&1;a[y]=a[y+1]=a[y+2]=255*(1-W),a[y+3]=255}if(4==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[b+(p>>1)]>>4-4*(1&p)&15;a[y]=a[y+1]=a[y+2]=17*(15-W),a[y+3]=255}if(8==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[b+p];a[y]=a[y+1]=a[y+2]=255-W,a[y+3]=255}if(16==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[(L=b+2*p)+1]<<8|o[L];a[y]=a[y+1]=a[y+2]=Math.min(255,255-~~(W*e)),a[y+3]=255}}}else if(1==l){null==e&&(e=1/256);var f=3&o.length?null:new Float32Array(o.buffer);for(m=0;m<i;m++){b=m*u,Z=m*s;if(1==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[b+(p>>3)]>>7-(7&p)&1;a[y]=a[y+1]=a[y+2]=255*W,a[y+3]=255}if(2==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[b+(p>>2)]>>6-2*(3&p)&3;a[y]=a[y+1]=a[y+2]=85*W,a[y+3]=255}if(8==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[b+p*c];a[y]=a[y+1]=a[y+2]=W,a[y+3]=255}if(16==d)for(p=0;p<s;p++){y=Z+p<<2,W=o[(L=b+2*p)+1]<<8|o[L];a[y]=a[y+1]=a[y+2]=Math.min(255,~~(W*e)),a[y+3]=255}if(32==d)for(p=0;p<s;p++){var L;y=Z+p<<2,W=f[L=(b>>>2)+p];a[y]=a[y+1]=a[y+2]=~~(.5+255*W),a[y+3]=255}}}else if(2==l)if(8==d){if(1==c)for(p=0;p<n;p++)a[4*p]=a[4*p+1]=a[4*p+2]=o[p],a[4*p+3]=255;if(3==c)for(p=0;p<n;p++){var G=3*p;a[y=p<<2]=o[G],a[y+1]=o[G+1],a[y+2]=o[G+2],a[y+3]=255}if(c>=4)for(p=0;p<n;p++){G=p*c;a[y=p<<2]=o[G],a[y+1]=o[G+1],a[y+2]=o[G+2],a[y+3]=o[G+3]}}else if(16==d){if(4==c)for(p=0;p<n;p++){G=8*p+1;a[y=p<<2]=o[G],a[y+1]=o[G+2],a[y+2]=o[G+4],a[y+3]=o[G+6]}if(3==c)for(p=0;p<n;p++){G=6*p+1;a[y=p<<2]=o[G],a[y+1]=o[G+2],a[y+2]=o[G+4],a[y+3]=255}}else{if(32!=d)throw d;var V=new Float32Array(o.buffer),x=0;for(p=0;p<V.length;p++)x=Math.min(x,V[p]);if(x<0)for(p=0;p<o.length;p+=4){var w=o[p];o[p]=o[p+3],o[p+3]=w,w=o[p+1],o[p+1]=o[p+2],o[p+2]=w}var g=[];for(p=0;p<65536;p++)g.push(r(p/65535));for(p=0;p<V.length;p++){var v=Math.max(0,Math.min(1,V[p]));V[p]=g[~~(.5+65535*v)]}if(3==c)for(p=0;p<n;p++){G=3*p;a[y=p<<2]=~~(.5+255*V[G]),a[y+1]=~~(.5+255*V[G+1]),a[y+2]=~~(.5+255*V[G+2]),a[y+3]=255}else{if(4!=c)throw c;for(p=0;p<n;p++){G=4*p;a[y=p<<2]=~~(.5+255*V[G]),a[y+1]=~~(.5+255*V[G+1]),a[y+2]=~~(.5+255*V[G+2]),a[y+3]=~~(.5+255*V[G+3])}}}else if(3==l){var M=t.t320,X=1<<d,T=8==d&&c>1&&t.t338&&0!=t.t338[0];for(m=0;m<i;m++)for(var Y=0;Y<s;Y++){y=(p=m*s+Y)<<2;var P=0,S=m*u;if(1==d)P=o[S+(Y>>>3)]>>>7-(7&Y)&1;else if(2==d)P=o[S+(Y>>>2)]>>>6-2*(3&Y)&3;else if(4==d)P=o[S+(Y>>>1)]>>>4-4*(1&Y)&15;else{if(8!=d)throw d;P=o[S+Y*c]}a[y]=M[P]>>8,a[y+1]=M[X+P]>>8,a[y+2]=M[X+X+P]>>8,a[y+3]=T?o[S+Y*c+1]:255}}else if(5==l){var K=c>4?1:0;for(p=0;p<n;p++){y=p<<2;var I=p*c;if(window.UDOC){var z=o[I],k=o[I+1],F=o[I+2],U=o[I+3],R=UDOC.C.cmykToRgb([z*(1/255),k*(1/255),F*(1/255),U*(1/255)]);a[y]=~~(.5+255*R[0]),a[y+1]=~~(.5+255*R[1]),a[y+2]=~~(.5+255*R[2])}else{z=255-o[I],k=255-o[I+1],F=255-o[I+2],U=(255-o[I+3])*(1/255);a[y]=~~(z*U+.5),a[y+1]=~~(k*U+.5),a[y+2]=~~(F*U+.5)}a[y+3]=255*(1-K)+o[I+4]*K}}else if(6==l&&t.t278){var H=t.t278[0];for(m=0;m<i;m+=H){p=m*s;for(var D=H*s,j=0;j<D;j++){y=4*(p+j),F=o[(I=3*p+4*(j>>>1))+(1&j)];var E=o[I+2]-128,C=o[I+3]-128,J=F+((C>>2)+(C>>3)+(C>>5)),N=F-((E>>2)+(E>>4)+(E>>5))-((C>>1)+(C>>3)+(C>>4)+(C>>5)),B=F+(E+(E>>1)+(E>>2)+(E>>6));a[y]=Math.max(0,Math.min(255,J)),a[y+1]=Math.max(0,Math.min(255,N)),a[y+2]=Math.max(0,Math.min(255,B)),a[y+3]=255}}}else if(32845==l)for(m=0;m<i;m++)for(Y=0;Y<s;Y++){y=4*(m*s+Y);var O=o[(I=6*(m*s+Y))+1]<<8|o[I],Q=(O=Math.pow(2,(O+.5)/256-64),(o[I+3]+.5)/410),A=(o[I+5]+.5)/410,_=9*Q/(6*Q-16*A+12),q=4*A/(6*Q-16*A+12),$=_*O/q,tt=(1-_-q)*O/q;J=2.69*$-1.276*(F=O)-.414*tt,N=-1.022*$+1.978*F+.044*tt,B=.061*$-.224*F+1.163*tt;a[y]=255*r(Math.min(J,1)),a[y+1]=255*r(Math.min(N,1)),a[y+2]=255*r(Math.min(B,1)),a[y+3]=255}else log("Unknown Photometric interpretation: "+l);return a},Ft.replaceIMG=function(t){null==t&&(t=document.getElementsByTagName("img"));for(var e=["tif","tiff","dng","cr2","nef"],r=0;r<t.length;r++){var s=t[r],i=s.getAttribute("src");if(null!=i){var n=i.split(".").pop().toLowerCase();if(-1!=e.indexOf(n)){var o=new XMLHttpRequest;Ft._xhrs.push(o),Ft._imgs.push(s),o.open("GET",i),o.responseType="arraybuffer",o.onload=Ft._imgLoaded,o.send()}}}},Ft._xhrs=[],Ft._imgs=[],Ft._imgLoaded=function(t){var e=Ft._xhrs.indexOf(t.target),r=Ft._imgs[e];Ft._xhrs.splice(e,1),Ft._imgs.splice(e,1),r.setAttribute("src",Ft.bufferToURI(t.target.response))},Ft.bufferToURI=function(t){var e=Ft.decode(t),r=e,s=0,i=r[0];e[0].subIFD&&(r=r.concat(e[0].subIFD));for(var n=0;n<r.length;n++){var o=r[n];if(!(null==o.t258||o.t258.length<3)){var a=o.t256*o.t257;a>s&&(s=a,i=o)}}Ft.decodeImage(t,i,e);var l=Ft.toRGBA8(i),d=i.width,c=i.height,h=document.createElement("canvas");h.width=d,h.height=c;var u=h.getContext("2d"),m=new ImageData(new Uint8ClampedArray(l.buffer),d,c);return u.putImageData(m,0,0),h.toDataURL()},Ft._binBE={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},readShort:function(t,e){var r=Ft._binBE.ui8;return r[0]=t[e+1],r[1]=t[e+0],Ft._binBE.i16[0]},readInt:function(t,e){var r=Ft._binBE.ui8;return r[0]=t[e+3],r[1]=t[e+2],r[2]=t[e+1],r[3]=t[e+0],Ft._binBE.i32[0]},readUint:function(t,e){var r=Ft._binBE.ui8;return r[0]=t[e+3],r[1]=t[e+2],r[2]=t[e+1],r[3]=t[e+0],Ft._binBE.ui32[0]},readASCII:function(t,e,r){for(var s="",i=0;i<r;i++)s+=String.fromCharCode(t[e+i]);return s},readFloat:function(t,e){for(var r=Ft._binBE.ui8,s=0;s<4;s++)r[s]=t[e+3-s];return Ft._binBE.fl32[0]},readDouble:function(t,e){for(var r=Ft._binBE.ui8,s=0;s<8;s++)r[s]=t[e+7-s];return Ft._binBE.fl64[0]},writeUshort:function(t,e,r){t[e]=r>>8&255,t[e+1]=255&r},writeInt:function(t,e,r){var s=Ft._binBE.ui8;Ft._binBE.i32[0]=r,t[e+3]=s[0],t[e+2]=s[1],t[e+1]=s[2],t[e+0]=s[3]},writeUint:function(t,e,r){t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},writeASCII:function(t,e,r){for(var s=0;s<r.length;s++)t[e+s]=r.charCodeAt(s)},writeDouble:function(t,e,r){Ft._binBE.fl64[0]=r;for(var s=0;s<8;s++)t[e+s]=Ft._binBE.ui8[7-s]}},Ft._binBE.ui8=new Uint8Array(8),Ft._binBE.i16=new Int16Array(Ft._binBE.ui8.buffer),Ft._binBE.i32=new Int32Array(Ft._binBE.ui8.buffer),Ft._binBE.ui32=new Uint32Array(Ft._binBE.ui8.buffer),Ft._binBE.fl32=new Float32Array(Ft._binBE.ui8.buffer),Ft._binBE.fl64=new Float64Array(Ft._binBE.ui8.buffer),Ft._binLE={nextZero:Ft._binBE.nextZero,readUshort:function(t,e){return t[e+1]<<8|t[e]},readShort:function(t,e){var r=Ft._binBE.ui8;return r[0]=t[e+0],r[1]=t[e+1],Ft._binBE.i16[0]},readInt:function(t,e){var r=Ft._binBE.ui8;return r[0]=t[e+0],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],Ft._binBE.i32[0]},readUint:function(t,e){var r=Ft._binBE.ui8;return r[0]=t[e+0],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],Ft._binBE.ui32[0]},readASCII:Ft._binBE.readASCII,readFloat:function(t,e){for(var r=Ft._binBE.ui8,s=0;s<4;s++)r[s]=t[e+s];return Ft._binBE.fl32[0]},readDouble:function(t,e){for(var r=Ft._binBE.ui8,s=0;s<8;s++)r[s]=t[e+s];return Ft._binBE.fl64[0]},writeUshort:function(t,e,r){t[e]=255&r,t[e+1]=r>>8&255},writeInt:function(t,e,r){var s=Ft._binBE.ui8;Ft._binBE.i32[0]=r,t[e+0]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3]},writeUint:function(t,e,r){t[e]=r>>>0&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},writeASCII:Ft._binBE.writeASCII},Ft._copyTile=function(t,e,r,s,i,n,o,a){for(var l=Math.min(e,i-o),d=Math.min(r,n-a),c=0;c<d;c++)for(var h=(a+c)*i+o,u=c*e,m=0;m<l;m++)s[h+m]=t[u+m]},Ft._inflateRaw=((kt={H:{}}).H.N=function(t,e){var r,s,i=Uint8Array,n=0,o=0,a=0,l=0,d=0,c=0,h=0,u=0,m=0;if(3==t[0]&&0==t[1])return e||new i(0);var b=kt.H,Z=b.b,p=b.e,y=b.R,W=b.n,f=b.A,L=b.Z,G=b.m,V=null==e;for(V&&(e=new i(t.length>>>2<<5));0==n;)if(n=Z(t,m,1),o=Z(t,m+1,2),m+=3,0!=o){if(V&&(e=kt.H.W(e,u+(1<<17))),1==o&&(r=G.J,s=G.h,c=511,h=31),2==o){a=p(t,m,5)+257,l=p(t,m+5,5)+1,d=p(t,m+10,4)+4,m+=14;for(var x=1,w=0;w<38;w+=2)G.Q[w]=0,G.Q[w+1]=0;for(w=0;w<d;w++){var g=p(t,m+3*w,3);G.Q[1+(G.X[w]<<1)]=g,g>x&&(x=g)}m+=3*d,W(G.Q,x),f(G.Q,x,G.u),r=G.w,s=G.d,m=y(G.u,(1<<x)-1,a+l,t,m,G.v);var v=b.V(G.v,0,a,G.C);c=(1<<v)-1;var M=b.V(G.v,a,l,G.D);h=(1<<M)-1,W(G.C,v),f(G.C,v,r),W(G.D,M),f(G.D,M,s)}for(;;){var X=r[L(t,m)&c];m+=15&X;var T=X>>>4;if(T>>>8){if(256==T)break;var Y=u+T-254;if(T>264){var P=G.q[T-257];Y=u+(P>>>3)+p(t,m,7&P),m+=7&P}var S=s[L(t,m)&h];m+=15&S;var K=S>>>4,I=G.c[K],z=(I>>>4)+Z(t,m,15&I);for(m+=15&I;u<Y;)e[u]=e[u++-z],e[u]=e[u++-z],e[u]=e[u++-z],e[u]=e[u++-z];u=Y}else e[u++]=T}}else{7&m&&(m+=8-(7&m));var k=(m>>>3)+4,F=t[k-4]|t[k-3]<<8;V&&(e=kt.H.W(e,u+F)),e.set(new i(t.buffer,t.byteOffset+k,F),u),m=k+F<<3,u+=F}return e.length==u?e:e.slice(0,u)},kt.H.W=function(t,e){var r=t.length;if(e<=r)return t;var s=new Uint8Array(r<<1);return s.set(t,0),s},kt.H.R=function(t,e,r,s,i,n){for(var o=kt.H.e,a=kt.H.Z,l=0;l<r;){var d=t[a(s,i)&e];i+=15&d;var c=d>>>4;if(c<=15)n[l]=c,l++;else{var h=0,u=0;16==c?(u=3+o(s,i,2),i+=2,h=n[l-1]):17==c?(u=3+o(s,i,3),i+=3):18==c&&(u=11+o(s,i,7),i+=7);for(var m=l+u;l<m;)n[l]=h,l++}}return i},kt.H.V=function(t,e,r,s){for(var i=0,n=0,o=s.length>>>1;n<r;){var a=t[n+e];s[n<<1]=0,s[1+(n<<1)]=a,a>i&&(i=a),n++}for(;n<o;)s[n<<1]=0,s[1+(n<<1)]=0,n++;return i},kt.H.n=function(t,e){for(var r,s,i,n,o=kt.H.m,a=t.length,l=o.j,d=0;d<=e;d++)l[d]=0;for(d=1;d<a;d+=2)l[t[d]]++;var c=o.K;for(r=0,l[0]=0,s=1;s<=e;s++)r=r+l[s-1]<<1,c[s]=r;for(i=0;i<a;i+=2)0!=(n=t[i+1])&&(t[i]=c[n],c[n]++)},kt.H.A=function(t,e,r){for(var s=t.length,i=kt.H.m.r,n=0;n<s;n+=2)if(0!=t[n+1])for(var o=n>>1,a=t[n+1],l=o<<4|a,d=e-a,c=t[n]<<d,h=c+(1<<d);c!=h;)r[i[c]>>>15-e]=l,c++},kt.H.l=function(t,e){for(var r=kt.H.m.r,s=15-e,i=0;i<t.length;i+=2){var n=t[i]<<e-t[i+1];t[i]=r[n]>>>s}},kt.H.M=function(t,e,r){r<<=7&e;var s=e>>>3;t[s]|=r,t[s+1]|=r>>>8},kt.H.I=function(t,e,r){r<<=7&e;var s=e>>>3;t[s]|=r,t[s+1]|=r>>>8,t[s+2]|=r>>>16},kt.H.e=function(t,e,r){return(t[e>>>3]|t[(e>>>3)+1]<<8)>>>(7&e)&(1<<r)-1},kt.H.b=function(t,e,r){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(7&e)&(1<<r)-1},kt.H.Z=function(t,e){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(7&e)},kt.H.i=function(t,e){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16|t[(e>>>3)+3]<<24)>>>(7&e)},kt.H.m=(It=Uint16Array,zt=Uint32Array,{K:new It(16),j:new It(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new It(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new zt(32),J:new It(512),_:[],h:new It(32),$:[],w:new It(32768),C:[],v:[],d:new It(32768),D:[],u:new It(512),Q:[],r:new It(32768),s:new zt(286),Y:new zt(30),a:new zt(19),t:new zt(15e3),k:new It(65536),g:new It(32768)}),function(){for(var t=kt.H.m,e=0;e<32768;e++){var r=e;r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,t.r[e]=(r>>>16|r<<16)>>>17}function s(t,e,r){for(;0!=e--;)t.push(0,r)}for(e=0;e<32;e++)t.q[e]=t.S[e]<<3|t.T[e],t.c[e]=t.p[e]<<4|t.z[e];s(t._,144,8),s(t._,112,9),s(t._,24,7),s(t._,8,8),kt.H.n(t._,9),kt.H.A(t._,9,t.J),kt.H.l(t._,9),s(t.$,32,5),kt.H.n(t.$,5),kt.H.A(t.$,5,t.h),kt.H.l(t.$,5),s(t.Q,19,0),s(t.C,286,0),s(t.D,30,0),s(t.v,320,0)}(),kt.H.N),Ft.LosslessJpegDecode=function(){var t,e;function r(){return t[e++]}function s(){return t[e++]<<8|t[e++]}function i(t){for(var e=r(),s=[0,0,0,255],i=[],o=0;o<16;o++)i[o]=r();for(o=0;o<16;o++)for(var a=0;a<i[o];a++){s[n(s,0,o+1,1)+3]=r()}var l=new Uint8Array(256);t[e]=[new Uint8Array(s),l];for(o=0;o<256;o++){for(var d=8,c=o,h=0;255==s[h+3]&&0!=d;)h=s[h+(c>>--d&1)];l[o]=h}}function n(t,e,r,s){if(255!=t[e+3])return 0;if(0==r)return e;for(var i=0;i<2;i++){0==t[e+i]&&(t[e+i]=t.length,t.push(0,0,s,255));var o=n(t,t[e+i],r-1,s+1);if(0!=o)return o}return 0}function o(t){for(var e=t.b,r=t.f;e<25&&t.a<t.d;){var s=t.data[t.a++];255==s&&!t.c&&t.a++,r=r<<8|s,e+=8}if(e<0)throw"e";t.b=e,t.f=r}function a(t,e){return e.b<t&&o(e),e.f>>(e.b-=t)&65535>>16-t}function l(t,e){var r=t[0],s=0,i=255;e.b<16&&o(e);var n=e.f>>e.b-8&255;for(i=r[(s=t[1][n])+3],e.b-=r[s+2];255==i;)i=r[(s=r[s+(e.f>>--e.b&1)])+3];return i}function d(t,e){return t<32768>>16-e&&(t+=1-(1<<e)),t}function c(t,e){var r=l(t,e);return 0==r?0:16==r?-32768:d(a(r,e),r)}function h(t,e,r,s,i,n){for(var o=0,a=0;a<n;a++){for(var l=a*e,d=0;d<e;d+=i){o++;for(var h=0;h<i;h++)t[l+d+h]=c(s[h],r)}if(0!=r.e&&o%r.e==0&&0!=a){for(var u=r.a,m=r.data;255!=m[u]||!(208<=m[u+1]&&m[u+1]<=215);)u--;r.a=u+2,r.f=0,r.b=0}}}function u(t,e){return d(a(t,e),t)}function m(t,e,r,s,i,n,o,a){for(var l=r*o,d=i;d<n;d++)t[d]+=1<<a-1;for(var c=o;c<l;c+=o)for(d=i;d<n;d++)t[c+d]+=t[c+d-o];for(var h=1;h<s;h++){var u=h*l;for(d=i;d<n;d++)t[u+d]+=t[u+d-l];for(c=o;c<l;c+=o)for(d=i;d<n;d++){var m=u+c+d,b=m-l,Z=t[m-o],p=0;if(0==e)p=0;else if(1==e)p=Z;else if(2==e)p=t[b];else if(3==e)p=t[b-o];else if(4==e)p=Z+(t[b]-t[b-o]);else if(5==e)p=Z+(t[b]-t[b-o]>>>1);else if(6==e)p=t[b]+(Z-t[b-o]>>>1);else{if(7!=e)throw e;p=Z+t[b]>>>1}t[m]+=p}}}return function(n){if(t=n,e=0,65496!=s())throw"e";for(var o=[],a=0,d=0,c=0,b=[],Z=[],p=[],y=0,W=0,f=0;;){var L=s();if(65535!=L){var G=s();if(65475==L){d=r(),W=s(),f=s(),y=r();for(var V=0;V<y;V++){var x=r(),w=r();if(0!=r())throw"e";o[x]=[V,w>>4,15&w]}}else if(65476==L)for(var g=e+G-2;e<g;)i(Z);else{if(65498==L){e++;for(V=0;V<y;V++){var v=o[r()];p[v[0]]=Z[r()>>>4],b[v[0]]=v.slice(1)}a=r(),e+=2;break}65501==L?c=s():e+=G-2}}else e--}var M=new(d>8?Uint16Array:Uint8Array)(W*f*y),X={b:0,f:0,c:8==a,a:e,data:t,d:t.length,e:c};if(X.c)!function(r,s,i,n,o){for(var a=t.length-e,d=0;d<a;d+=4){var c=t[e+d];t[e+d]=t[e+d+3],t[e+d+3]=c,c=t[e+d+1],t[e+d+1]=t[e+d+2],t[e+d+2]=c}for(var h=0;h<o;h++)for(var m=32768,b=32768,Z=0;Z<s;Z+=2){var p=l(n,i),y=l(n,i);0!=p&&(m+=u(p,i)),0!=y&&(b+=u(y,i)),r[h*s+Z]=65535&m,r[h*s+Z+1]=65535&b}}(M,f*y,X,p[0],W);else{var T=[],Y=0,P=0;for(V=0;V<y;V++){var S=b[V];(j=S[0])>Y&&(Y=j),(D=S[1])>P&&(P=D),T.push(j*D)}if(1!=Y||1!=P){if(3!=y||1!=T[1]||1!=T[2]||2!=Y||1!=P&&2!=P)throw"e";var K=[],I=0;for(V=0;V<y;V++){for(var z=0;z<T[V];z++)K.push(p[V]);I+=T[V]}var k=f/Y,F=W/P,U=k*F;h(M,k*I,X,K,I,F),m(M,a,k,F,I-2,I,I,d);var R=new Uint16Array(U*T[0]);if(2==Y&&2==P){for(V=0;V<U;V++)R[4*V]=M[6*V],R[4*V+1]=M[6*V+1],R[4*V+2]=M[6*V+2],R[4*V+3]=M[6*V+3];m(R,a,4*k,F,0,1,1,d);for(V=0;V<U;V++)M[6*V]=R[4*V],M[6*V+1]=R[4*V+1],M[6*V+2]=R[4*V+2],M[6*V+3]=R[4*V+3]}if(2==Y&&1==P){for(V=0;V<U;V++)R[2*V]=M[4*V],R[2*V+1]=M[4*V+1];m(R,a,2*k,F,0,1,1,d);for(V=0;V<U;V++)M[4*V]=R[2*V],M[4*V+1]=R[2*V+1]}for(var H=M.slice(0),D=0;D<W;D++)if(2==P)for(var j=0;j<f;j++){var E=((D>>>1)*k+(j>>>1))*I,C=2*(1&D)+(1&j);M[J=(D*f+j)*y]=H[E+C],M[J+1]=H[E+4],M[J+2]=H[E+5]}else for(j=0;j<f;j++){var J;E=(D*k+(j>>>1))*I,C=1&j;M[J=(D*f+j)*y]=H[E+C],M[J+1]=H[E+2],M[J+2]=H[E+3]}}else if(h(M,f*y,X,p,y,W),0==c)m(M,a,f,W,0,y,y,d);else{var N=Math.floor(c/f);for(D=0;D<W;D+=N){var B=M.slice(D*f*y,(D+N)*f*y);m(B,a,f,N,0,y,y,d),M.set(B,D*f*y)}}}return M}}(),function(){var t=5,e=6,r=13,s=14;function i(t){var e={c:new Int8Array(2<<t.u)};return function(t,e,r){var s=[e,3*e+18,5*e+67,7*e+276,r];t.o=e,t.w=(s[4]+2*e)/(2*e+1)+1|0,t.v=Math.ceil(Math.log2(t.w)),t.t=9,function(t,e){for(var r=-e[4],s=0;r<=e[4];s++,r++)t[s]=r<=-276?-4:r<=-67?-3:r<=-18?-2:r<-0?-1:r<=e[0]?0:r<e[1]?1:r<e[2]?2:r<e[3]?3:4}(t.c,s)}(e,0,t.g),e}function n(t){for(var e=[[],[],[]],r=Math.max(2,t.w+32>>>6),s=0;s<3;s++)for(var i=0;i<41;i++)e[s][i]=[r,1];return e}function o(t,e){var r=0,s=8-t.a;if(t.j,t.a,e){if(e>=s)do{r<<=s,e-=s,r|=t[t.j]&(1<<s)-1,t.j++,s=8}while(e>=8);e&&(r<<=e,s-=e,r|=t[t.j]>>>s&(1<<e)-1),t.a=8-s}return r}function a(t,e,r,s,i,n,a,l){null==l&&(l=0);var d,c,h,u,m,b,Z=n+1,p=Z%2,y=0,W=s[i],f=s[i-1],L=s[i-2][Z],G=f[Z-1],V=f[Z],x=f[Z+1],w=W[Z-1],g=W[Z+1],v=Math.abs;if(p&&(h=v(x-V),u=v(L-V),m=v(G-V)),p){if(b=(b=h>m&&u<h?L+G:h<m&&u<m?L+x:x+G)+2*V>>>2,l)return void(W[Z]=b);d=e.t*e.c[t.g+V-L]+e.c[t.g+G-V]}else b=V>G&&V>x||V<G&&V<x?g+w+2*V>>>2:w+g>>>1,d=e.t*e.c[t.g+V-G]+e.c[t.g+G-w];c=v(d);var M=function(t){for(var e=-1,r=0;!r;e++)r=t[t.j]>>>7-t.a&1,t.a++,t.a&=7,t.a||t.j++;return e}(r);if(M<t.n-e.v-1){var X=function(t,e){var r=0;if(e<t)for(;r<=14&&e<<++r<t;);return r}(a[c][0],a[c][1]);y=o(r,X)+(M<<X)}else y=o(r,e.v)+1;y=1&y?-1-(y>>>1):y>>>1,a[c][0]+=v(y),a[c][1]==t.f&&(a[c][0]>>>=1,a[c][1]>>>=1),a[c][1]++,b=d<0?b-y:b+y,t.i&&(b<0?b+=e.w:b>t.g&&(b-=e.w)),W[Z]=b>=0?Math.min(b,t.g):0}function l(t,e,r){for(var s=t[0].length,i=e;i<=r;i++)t[i][0]=t[i-1][1],t[i][s-1]=t[i-1][s-2]}function d(t){l(t,7,12),l(t,2,4),l(t,15,17)}function c(t,e,s,i,n,o,l,c,h,u,m,b,Z){for(var p=0,y=1,W=n<r&&n>4;y<t.m;)p<t.m&&(a(t,e,s,i,n,p,l[h],t.h&&(W&&u||!W&&(m||(p&b)==Z))),a(t,e,s,i,o,p,l[h],t.h&&(!W&&u||W&&(m||(p&b)==Z))),p+=2),p>8&&(a(t,e,s,i,n,y,c[h]),a(t,e,s,i,o,y,c[h]),y+=2);d(i)}function h(t,e,r,s,i,n){c(t,e,r,s,2,7,i,n,0,0,1,0,8),c(t,e,r,s,8,15,i,n,1,0,1,0,8),c(t,e,r,s,3,9,i,n,2,1,0,3,0),c(t,e,r,s,10,16,i,n,0,0,0,3,2),c(t,e,r,s,4,11,i,n,1,0,0,3,2),c(t,e,r,s,12,17,i,n,2,1,0,3,0)}function u(t,e,r,s,i,n){var o=n.length,a=t.l;i+1==t.s&&(a=t.e-i*t.l);for(var l=6*t.e*s+i*t.l,d=0;d<6;d++){for(var c=0;c<a;c++){var h,u=n[d%o][c%o];h=0==u?2+(d>>>1):2==u?15+(d>>>1):7+d;var m=t.h?(2*c/3&2147483646|c%3&1)+(c%3>>>1):c>>>1;e[l+c]=r[h][m+1]}l+=t.e}}Ft._decompressRAF=function(o,a){var l=function(t){var e=Ft._binBE.readUshort,r={b:e(t,0),i:t[2],C:t[3],u:t[4],q:e(t,5),k:e(t,7),e:e(t,9),l:e(t,11),s:t[13],d:e(t,14)};if(18771!=r.b||r.i>1||r.q<6||r.q%6||r.e<768||r.e%24||768!=r.l||r.k<r.l||r.k%r.l||r.k-r.e>=r.l||r.s>16||r.s!=r.k/r.l||r.s!=Math.ceil(r.e/r.l)||r.d!=r.q/6||12!=r.u&&14!=r.u&&16!=r.u||16!=r.C&&0!=r.C)throw"Invalid data";if(0==r.i)throw"Not implemented. We need this file!";return r.h=16==r.C,r.m=0|(r.h?2*r.l/3:r.l>>>1),r.A=r.m+2,r.f=64,r.g=(1<<r.u)-1,r.n=4*r.u,r}(o),c=function(t,e){var r=new Array(e.s),s=4*e.s,i=16+s;12&s&&(i+=16-(12&s));for(var n=0,o=16;n<e.s;o+=4){var a=Ft._binBE.readUint(t,o);r[n]=t.slice(i,i+a),r[n].j=0,r[n].a=0,i+=a,n++}if(i!=t.length)throw"Invalid data";return r}(o,l),m=i(l),b=new Int16Array(l.e*l.q);null==a&&(a=l.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var Z=[[0,3],[1,4],[t,11],[e,12],[r,16],[s,17]],p=[],y=0;y<18;y++)p[y]=new Uint16Array(l.A);for(var W=0;W<l.s;W++){var f=n(m),L=n(m);for(y=0;y<18;y++)for(var G=0;G<l.A;G++)p[y][G]=0;for(var V=0;V<l.d;V++){h(l,m,c[W],p,f,L);for(y=0;y<6;y++)for(G=0;G<l.A;G++)p[Z[y][0]][G]=p[Z[y][1]][G];u(l,b,p,V,W,a);for(y=2;y<18;y++)if(-1==[t,e,r,s].indexOf(y))for(G=0;G<l.A;G++)p[y][G]=0;d(p)}}return b}}(),performance.now(),new e,new e;class Ut extends Zt{constructor(t){super(t),Pt(this,"token",""),Pt(this,"format","webp"),Pt(this,"style","mapbox.satellite"),Pt(this,"attribution","MapBox"),Pt(this,"maxLevel",19),Pt(this,"url","https://api.mapbox.com/v4/{style}/{z}/{x}/{y}.{format}?access_token={token}"),Object.assign(this,t)}}class Rt extends Zt{constructor(t){super(t),Pt(this,"dataType","image"),Pt(this,"attribution","高德[GS(2021)6375号]"),Pt(this,"style","8"),Pt(this,"subdomains","1234"),Pt(this,"maxLevel",18),Pt(this,"url","https://webst0{s}.is.autonavi.com/appmaptile?style={style}&x={x}&y={y}&z={z}"),Object.assign(this,t)}}function Ht(t,e){this.x=t,this.y=e}new e,new n,(new X).load("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),Ht.prototype={clone(){return new Ht(this.x,this.y)},add(t){return this.clone()._add(t)},sub(t){return this.clone()._sub(t)},multByPoint(t){return this.clone()._multByPoint(t)},divByPoint(t){return this.clone()._divByPoint(t)},mult(t){return this.clone()._mult(t)},div(t){return this.clone()._div(t)},rotate(t){return this.clone()._rotate(t)},rotateAround(t,e){return this.clone()._rotateAround(t,e)},matMult(t){return this.clone()._matMult(t)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(t){return this.x===t.x&&this.y===t.y},dist(t){return Math.sqrt(this.distSqr(t))},distSqr(t){const e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith(t){return this.angleWithSep(t.x,t.y)},angleWithSep(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult(t){const e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add(t){return this.x+=t.x,this.y+=t.y,this},_sub(t){return this.x-=t.x,this.y-=t.y,this},_mult(t){return this.x*=t,this.y*=t,this},_div(t){return this.x/=t,this.y/=t,this},_multByPoint(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint(t){return this.x/=t.x,this.y/=t.y,this},_unit(){return this._div(this.mag()),this},_perp(){const t=this.y;return this.y=this.x,this.x=-t,this},_rotate(t){const e=Math.cos(t),r=Math.sin(t),s=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=s,this.y=i,this},_rotateAround(t,e){const r=Math.cos(t),s=Math.sin(t),i=e.x+r*(this.x-e.x)-s*(this.y-e.y),n=e.y+s*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=n,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Ht},Ht.convert=function(t){if(t instanceof Ht)return t;if(Array.isArray(t))return new Ht(+t[0],+t[1]);if(void 0!==t.x&&void 0!==t.y)return new Ht(+t.x,+t.y);throw new Error("Expected [x, y] or {x, y} point format")},!(typeof TextDecoder>"u")&&new TextDecoder("utf-8");T.add=async function(t,e){T.enabled},T.get=function(t){T.enabled},new e,new r;export{Ut as $,Rt as e,Mt as p};
