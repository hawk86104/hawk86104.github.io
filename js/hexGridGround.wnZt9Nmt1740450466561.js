import{e as n,h as t,a as e,o as i}from"./@tresjs.9lmhsV6t1740450466561.js";import{P as o}from"./tweakpane.yDiyAAkA1740450466561.js";import{_ as r}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.jfM8meFi1740450466561.js";import{_ as a}from"./three.HaMTRCf61740450466561.js";import{d as s,a3 as u,w as c,o as l,f,u as d,H as p,N as v,g as h,j as m,m as g,al as w,r as x,e as b}from"./@vue.NRI7TcgI1740450466561.js";import"./@vueuse.q8gKo7tC1740450466561.js";import"./all.three.ZTuQc1_h1740450466561.js";import"./oimophysics.x0jH7fze1740450466561.js";function y(n,t){const e=M();return(y=function(n,t){return e[n-=271]})(n,t)}const _=y;!function(n,t){const e=y,i=M();for(;;)try{if(644016===parseInt(e(320))/1*(parseInt(e(303))/2)+-parseInt(e(317))/3+-parseInt(e(318))/4*(-parseInt(e(279))/5)+-parseInt(e(299))/6*(-parseInt(e(313))/7)+-parseInt(e(307))/8+parseInt(e(308))/9+parseInt(e(310))/10*(-parseInt(e(283))/11))break;i.push(i.shift())}catch(o){i.push(i.shift())}}();const I=function(){let n=!0;return function(t,e){const i=n?function(){if(e){const n=e[y(306)](t,arguments);return e=null,n}}:function(){};return n=!1,i}}();!function(){I(this,(function(){const n=y,t=new RegExp("function *\\( *\\)"),e=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),i=T(n(282));t[n(316)](i+n(273))&&e.test(i+n(312))?T():i("0")}))()}();const k=function(){let n=!0;return function(t,e){const i=n?function(){if(e){const n=e[y(306)](t,arguments);return e=null,n}}:function(){};return n=!1,i}}();function M(){const n=["value","test","359217NwaREs","12sALiuI","debu","31360hCPgYM","while (true) {}","maskTexture","prototype","stateObject","chain","warn","bind","info","fragmentShader","time","2015240ikUQch","wavePow","table","init","7029kVHsmJ","MeshPhongMaterial","divisionScaleX","length","\nvarying vec2 uvPosition;\nvoid main() {\n    uvPosition = uv;\n}\n","raisedBottom","division","hasMaskTexture","console","baseMaterial","waveFrequency","gridWeight","speed","toString","isReversed","counter","223422QfVksv","exception","gger","direction","36DbwTFJ","call","__proto__","apply","6912616rxHCee","137529AdaCLi","constructor","13010pqaLsm","DoubleSide","input","126rgUJXW","trace"];return(M=function(){return n})()}k(void 0,(function(){const n=y,t=function(){let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(t){n=window}return n}(),e=t[n(291)]=t[n(291)]||{},i=["log",n(274),n(276),"error",n(300),n(281),n(314)];for(let o=0;o<i[n(286)];o++){const t=k[n(309)][n(271)][n(275)](k),r=i[o],a=e[r]||t;t[n(305)]=k.bind(k),t[n(296)]=a[n(296)][n(275)](a),e[r]=t}}))();const C=_(287),P=s({__name:"hexGridMaterial",props:{baseMaterial:{default:new(a[_(284)])},speed:{default:1},gridWeight:{default:.03},raisedBottom:{default:.05},waveFrequency:{default:.2},wavePow:{default:4},division:{default:32},divisionScaleX:{default:1},direction:{default:4},isReversed:{default:!1},hasMaskTexture:{default:!1},maskTexture:{default:null}},async setup(i){const o=_;let r,s;const p=i,v={gridWeight:{value:p[o(294)]},raisedBottom:{value:p[o(288)]},waveFrequency:{value:p[o(293)]},wavePow:{value:p.wavePow},direction:{value:p[o(302)]},isReversed:{value:p[o(297)]},hasMaskTexture:{value:p.hasMaskTexture},maskTexture:{value:null},division:{value:p[o(289)]},divisionScaleX:{value:p[o(285)]},time:{value:0}};p[o(322)]&&(v[o(322)][o(315)]=([r,s]=u((()=>e([p.maskTexture]))),r=await r,s(),r)),c((()=>[p.gridWeight,p[o(288)],p[o(293)],p[o(280)],p.division,p[o(285)],p[o(302)],p.isReversed,p[o(290)]]),(([n,t,e,i,r,a,s,u,c])=>{const l=o;v.gridWeight.value=n,v[l(288)][l(315)]=t,v.waveFrequency.value=e,v[l(280)].value=i,v[l(289)].value=r,v[l(285)][l(315)]=a,v[l(302)][l(315)]=s,v[l(297)][l(315)]=u,v[l(290)][l(315)]=c}));const{onLoop:h}=n();return h((({delta:n})=>{const t=o;v[t(278)].value+=n*p[t(295)]})),(n,e)=>{const r=o;return l(),f(d(t),{baseMaterial:i[r(292)],vertexShader:C,side:a[r(311)],transparent:"",fragmentShader:d("varying vec2 uvPosition;\n\nuniform float time;\n\nuniform float raisedBottom;\nuniform float waveFrequency;\nuniform float wavePow;\nuniform int direction;\n\nuniform float division;\nuniform float divisionScaleX;\n\nuniform bool hasMaskTexture;\nuniform sampler2D maskTexture;\n\nuniform bool isReversed;\n\nuniform float gridWeight;\n\nfloat hexDist(vec2 p) {\n  p = abs(p);\n  float d = dot(p, normalize(vec2(1.0, 1.73)));\n  return max(d, p.x);\n}\nvec4 hexCoords(vec2 uv) {\n  vec2 r = vec2(1.0, 1.73);\n  vec2 h = r * 0.5;\n  vec2 a = mod(uv, r) - h;\n  vec2 b = mod(uv - h, r) - h;\n\n  vec2 gv = length(a) < length(b) ? a : b;\n  vec2 id = uv - gv;\n\n  float x = atan(gv.x, gv.y);\n  float y = 0.5 - hexDist(gv);\n\n  return vec4(x, y, id);\n}\n\nvoid main() {\n  vec2 uv = uvPosition * vec2(division * divisionScaleX, division);\n  vec4 hc = hexCoords(uv);\n  vec2 id = hc.zw;\n  float distance = id.y;\n  if (direction == 3) {\n    distance = id.x;\n  } else if (direction == 5) {\n    distance = length(id.xy);\n  } else if (direction == 6) {\n    vec2 center = vec2(0.5 * division * divisionScaleX, 0.5 * division);\n    distance = length(uv - center);\n  }\n  float wavy =\n      pow(sin((distance * waveFrequency - time)), wavePow) + raisedBottom;\n\n  float diffuseColorA = csm_DiffuseColor.a;\n  diffuseColorA *= wavy;\n\n  float mask = 1.0;\n  if (hasMaskTexture) {\n    vec2 uVm = id / vec2(division * divisionScaleX, division);\n    mask = texture2D(maskTexture, uVm).g;\n  }\n\n  float w = gridWeight + (1.0 - mask);\n  w = clamp(w, 0.0, 1.0);\n\n  float margin = clamp(w * 0.33, 0.00, 0.02);\n  float stepMax = w + margin;\n\n  float gridLine = smoothstep(w, stepMax, hc.y);\n  gridLine = isReversed ? 1.0 - gridLine : gridLine;\n  diffuseColorA *= gridLine;\n\n  \n  \n  csm_DiffuseColor.rgb *= diffuseColorA;\n\nfloat brightness = length(csm_DiffuseColor.rgb);\n\nfloat alphaBlend = smoothstep(0.0, 1.0, brightness);\n\ncsm_DiffuseColor.a *= alphaBlend;\n\ncsm_FragColor = vec4(csm_DiffuseColor.rgb, csm_DiffuseColor.a);\n}"),uniforms:v},null,8,[r(292),"side",r(277)])}}});function T(n){function t(n){const e=y;if("string"==typeof n)return function(n){}[e(309)](e(321))[e(306)](e(298));1!==(""+n/n).length||n%20==0?function(){return!0}[e(309)](e(319)+e(301))[e(304)]("action"):function(){return!1}[e(309)]("debu"+e(301))[e(306)](e(272)),t(++n)}try{if(n)return t;t(0)}catch(e){}}const S=F;function D(){const n=["return (function() ","39977hXoslz","call","debu","chain","trace","$attrs","init","TresMesh","7542380yOniWc","8gtlnPk","error","table","rotation","936400VkwRGu","constructor","action","12926dkWSTa","counter","string","gger","422005sJUBIN","183tgNEoY","length","log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","MeshBasicMaterial","while (true) {}","TresPlaneGeometry","test","info","exception","6026562fzlSfK","61002XzqclV","282weroeS","console","__proto__","bind","function *\\( *\\)"];return(D=function(){return n})()}!function(n,t){const e=F,i=D();for(;;)try{if(658583===parseInt(e(314))/1+-parseInt(e(337))/2*(-parseInt(e(303))/3)+-parseInt(e(334))/4+parseInt(e(341))/5+parseInt(e(315))/6*(parseInt(e(321))/7)+parseInt(e(330))/8*(-parseInt(e(313))/9)+parseInt(e(329))/10)break;i.push(i.shift())}catch(o){i.push(i.shift())}}();const R=function(){let n=!0;return function(t,e){const i=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,i}}();!function(){R(this,(function(){const n=F,t=new RegExp(n(319)),e=new RegExp(n(306),"i"),i=z(n(327));t[n(310)](i+n(324))&&e[n(310)](i+"input")?z():i("0")}))()}();const j=function(){let n=!0;return function(t,e){const i=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,i}}();j(void 0,(function(){const n=F;let t;try{t=Function(n(320)+'{}.constructor("return this")( ));')()}catch(o){t=window}const e=t[n(316)]=t[n(316)]||{},i=[n(305),"warn",n(311),n(331),n(312),n(332),n(325)];for(let r=0;r<i[n(304)];r++){const t=j[n(335)].prototype[n(318)](j),o=i[r],a=e[o]||t;t[n(317)]=j[n(318)](j),t.toString=a.toString[n(318)](a),e[o]=t}}))();const B=[S(333)];function F(n,t){const e=D();return(F=function(n,t){return e[n-=303]})(n,t)}const A=s({__name:"hexGridMesh",setup(n){const t=S,e=new(a[t(307)]);return(n,i)=>{const o=t;return l(),p(o(328),{rotation:[-Math.PI/2,0,0]},[i[0]||(i[0]=v(o(309),{args:[1,1]},null,-1)),(l(),f(w,null,{default:h((()=>[m(P,g({baseMaterial:d(e)},n[o(326)],{maskTexture:"./plugins/floor/image/logoBlack.png"}),null,16,["baseMaterial"])])),_:1}))],8,B)}}});function z(n){function t(n){const e=F;if(typeof n===e(339))return function(n){}[e(335)](e(308)).apply(e(338));1!==(""+n/n)[e(304)]||n%20==0?function(){return!0}[e(335)](e(323)+"gger")[e(322)](e(336)):function(){return!1}.constructor(e(323)+e(340)).apply("stateObject"),t(++n)}try{if(n)return t;t(0)}catch(e){}}const W=q;!function(n,t){const e=q,i=Z();for(;;)try{if(823964===-parseInt(e(491))/1+parseInt(e(512))/2*(parseInt(e(495))/3)+parseInt(e(492))/4*(-parseInt(e(509))/5)+parseInt(e(501))/6+parseInt(e(523))/7*(parseInt(e(497))/8)+parseInt(e(537))/9+-parseInt(e(486))/10*(parseInt(e(539))/11))break;i.push(i.shift())}catch(o){i.push(i.shift())}}();const X=function(){let n=!0;return function(t,e){const i=n?function(){if(e){const n=e[q(508)](t,arguments);return e=null,n}}:function(){};return n=!1,i}}();function q(n,t){const e=Z();return(q=function(n,t){return e[n-=481]})(n,t)}!function(){X(this,(function(){const n=q,t=new RegExp(n(485)),e=new RegExp(n(518),"i"),i=V(n(489));t[n(533)](i+n(504))&&e[n(533)](i+n(496))?V():i("0")}))()}();const L=function(){let n=!0;return function(t,e){const i=n?function(){if(e){const n=e.apply(t,arguments);return e=null,n}}:function(){};return n=!1,i}}();function Z(){const n=["counter","constructor","方向类别","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","渐变强度","error","speed","debu","1543927tAatFl","gridWeight","console","#de62f2","颜色取反","wavePow","table","#666666","hexGridGround","color","test","info","waveFrequency","gger","807993qVChUD","warn","8839237sRZGdy","direction","toString","图片纹理","stateObject","function *\\( *\\)","10KeDAZl","call","log","init","addBinding","1280353hPLuXZ","8NePFeV","string","division","1932369hGCcCJ","input","40ascvHz","while (true) {}","TresPerspectiveCamera","渐变宽度","6165744MHIcTn","hasMaskTexture","prototype","chain","bind","return (function() ","length","apply","1501420PeuhoD","__proto__","trace","4sWOZva","exception","网格横向缩放"];return(Z=function(){return n})()}L(void 0,(function(){const n=q,t=function(){const n=q;let t;try{t=Function(n(506)+'{}.constructor("return this")( ));')()}catch(e){t=window}return t}(),e=t.console=t[n(525)]||{},i=[n(488),n(538),n(534),n(520),n(513),n(529),n(511)];for(let o=0;o<i.length;o++){const t=L[n(516)][n(503)][n(505)](L),r=i[o],a=e[r]||t;t[n(510)]=L[n(505)](L),t[n(482)]=a[n(482)].bind(a),e[r]=t}}))();const G=s({__name:W(531),setup(n){const t=W,e=x({reflectivity:.8,showGridHelper:!1,scale:1}),a=x({color:t(526),speed:1.9,gridWeight:.223,raisedBottom:.66,waveFrequency:.066,wavePow:19,division:46,divisionScaleX:1,isReversed:!1,direction:4,hasMaskTexture:!0}),s=new o({title:t(531),expanded:!0});return s[t(490)](a,t(502),{label:t(483)}),s[t(490)](a,t(532),{label:"颜色"}),s.addBinding(a,t(521),{label:"速度",min:-5,max:5,step:.1}),s[t(490)](a,t(524),{label:"网格宽度",min:.001,max:.5,step:.001}),s[t(490)](a,"raisedBottom",{label:t(500),min:.001,max:1,step:.001}),s[t(490)](a,t(535),{label:"分段",min:.001,max:1,step:.001}),s[t(490)](a,t(528),{label:t(519),min:1,max:30,step:.1}),s.addBinding(a,t(494),{label:"网格整体缩放",min:.1,max:50,step:.1}),s[t(490)](a,"divisionScaleX",{label:t(514),min:.1,max:10,step:.1}),s[t(490)](a,"isReversed",{label:t(527)}),s[t(490)](a,t(481),{label:t(517),min:3,max:6,step:1}),(n,o)=>{const s=t,u=b("TresCanvas");return l(),f(u,{clearColor:s(530),"window-size":""},{default:h((()=>[o[0]||(o[0]=v(s(499),{position:[3,3,0],fov:45,near:.1,far:1e4},null,-1)),m(d(i),{enableDamping:"",autoRotate:""}),m(A,g(a,{scale:9}),null,16),(l(),f(w,null,{default:h((()=>[m(r,g({position:[0,-.06,0]},e),null,16)])),_:1}))])),_:1})}}});function V(n){function t(n){const e=q;if(typeof n===e(493))return function(n){}.constructor(e(498))[e(508)](e(515));1!==(""+n/n)[e(507)]||n%20==0?function(){return!0}[e(516)](e(522)+e(536))[e(487)]("action"):function(){return!1}.constructor(e(522)+e(536))[e(508)](e(484)),t(++n)}try{if(n)return t;t(0)}catch(e){}}export{G as default};
