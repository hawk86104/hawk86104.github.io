import{b as t}from"./pagesShow.vue_vue_type_script_setup_true_lang.JP4MOAqv1720750938663.js";import{bX as n,a5 as e,bV as o,c5 as r,j as i,cf as u,C as s}from"./three.c_4mN3mZ1720750938663.js";import{a as c,r as a}from"./@tresjs.toBU36DO1720750938663.js";import{d as l,a2 as p,r as f,o as d,f as v,g as m,j as h,aj as x,ak as w}from"./@vue.ApkyOKE71720750938663.js";import{P}from"./tweakpane.yHWGBmom1720750938663.js";import"./three-custom-shader-material.vDIhSa4e1720750938663.js";import"./object-hash.uK40h2Gd1720750938663.js";import"./@amap.aVWyhucH1720750938663.js";import"./jszip.U0Bj1EHt1720750938663.js";import"./glsl-tokenizer.bTdSVbty1720750938663.js";import"./glsl-token-string.Geqk9Ccy1720750938663.js";import"./glsl-token-functions.EGRZ6BGB1720750938663.js";import"./@vueuse.NiHn2U_k1720750938663.js";const S=b;!function(t,n){const e=b,o=j();for(;;)try{if(565872===-parseInt(e(131))/1+parseInt(e(156))/2+parseInt(e(170))/3*(-parseInt(e(151))/4)+parseInt(e(129))/5+-parseInt(e(133))/6+parseInt(e(153))/7+-parseInt(e(154))/8*(-parseInt(e(132))/9))break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const g=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[b(175)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){g(this,(function(){const t=b,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(181),"i"),o=I("init");n.test(o+"chain")&&e[t(152)](o+t(150))?I():o("0")}))()}();const y=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[b(175)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function b(t,n){const e=j();return(b=function(t,n){return e[t-=129]})(t,n)}function j(){const t=["uScaleone","console","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","set","3259150iyGCWA","uPosition","487209XkmhtM","1282374tDdLJV","3295956Zoeeiv","while (true) {}",'{}.constructor("return this")( )',"depthBuffer","time","stateObject","table","prototype","material","__proto__","DepthTexture","color","warn","debu","string","ShaderMaterial","readBuffer","input","31124ilLGRk","test","3384094XDKhcf","24RRGhEZ","info","1837860KPyqxU","width","constructor","toString","#FFF","Color","length","counter","uScalenum","gger","addPass","uWidth","uniforms","return (function() ","339KjqYsq","action","height","speed","depthTexture","apply","value","bind","render"];return(j=function(){return t})()}y(void 0,(function(){const t=b;let n;try{n=Function(t(169)+t(135)+");")()}catch(r){n=window}const e=n[t(180)]=n[t(180)]||{},o=["log",t(145),t(155),"error","exception",t(139),"trace"];for(let i=0;i<o[t(162)];i++){const n=y.constructor[t(140)][t(177)](y),r=o[i],u=e[r]||n;n[t(142)]=y[t(177)](y),n.toString=u[t(159)][t(177)](u),e[r]=n}}))();const _=l({__name:"buildingsPassA",props:{color:{default:S(160)},uScalenum:{default:150},uScaleone:{default:24},uWidth:{default:1},speed:{default:1},uPosition:{default:{x:0,y:0}}},setup(t){const l=t,{renderer:f,scene:d,camera:v,sizes:m}=c();let h,x=0,w=null,P=null;p((()=>{const t=b;m[t(157)].value&&(h=m[t(157)].value,x=m[t(172)].value,(()=>{const t=b;w=new n(f.value);const s=new(e[t(143)])(h,x);w.readBuffer[t(136)]=!0,w[t(149)][t(174)]=s;const c=new o(d[t(176)],v[t(176)]);w.addPass(c),P=new r(new(e[t(148)])({uniforms:{time:{value:0},tDiffuse:{value:null},depthTexture:{value:s},uProjectionInverse:{value:v.value.projectionMatrixInverse},uMatrixWorld:{value:v[t(176)].matrixWorld},uColor:{value:new(e[t(161)])(l[t(144)])},uScalenum:{value:l[t(164)]},uScaleone:{value:l.uScaleone},uWidth:{value:l[t(167)]},uPosition:{value:new i(l[t(130)].x,l[t(130)].y)}},vertexShader:"varying vec2 vUv;\nvarying vec3 vPosition;\n\nvoid main(){\n\tvUv=uv;\n\tvPosition=position;\n\tgl_Position=vec4(position,1.);\n}\n",fragmentShader:"varying vec2 vUv;\nvarying vec3 vPosition;\nuniform sampler2D tDiffuse;\nuniform sampler2D depthTexture;\n\nuniform mat4 uProjectionInverse;\nuniform mat4 uMatrixWorld;\n\nuniform float time;\nuniform vec3 uColor;\nuniform float uScalenum;//最大范围\nuniform float uScaleone;//单条圈间距\nuniform float uWidth;//单条厚度\nuniform vec2 uPosition;//位置\n\nvec3 WorldPosFromDepth(float depth){\n\tfloat z=(depth-.5)*2.;\n\tvec4 clipSpacePosition=vec4(vPosition.xy,z,1.);\n\tvec4 viewSpacePosition=uProjectionInverse*clipSpacePosition;\n\tviewSpacePosition/=viewSpacePosition.w;\n\tvec4 worldSpacePosition=uMatrixWorld*viewSpacePosition;\n\treturn worldSpacePosition.xyz;\n}\nvec3 WorldPosFromDepth2(float depth){\n\t// 规范化设备坐标系 ndc (Normalized Device Coordinates)\n\tvec4 ndc=vec4(vPosition.x,vPosition.y,((depth-.5)*2.),1.);\n\t// 根据视图中的位置和深度逆向MVP (ModelViewProjectionMatrix) 以获取真实渲染的位置\n\tvec4 worldSpacePosition=uMatrixWorld*uProjectionInverse*ndc;\n\t// 由于透视相机视图区域是一个截锥体 在乘以矩阵后，结果不在同一个射影空间上（这意味着 w 分量不是每个顶点的 1）\n\t// 为了完成转换，我们需要将向量的每个分量除以 w 分量本身\n\t// 这一步正常渲染时在GPU中做 我们复原需要手动处理\n\tworldSpacePosition/=worldSpacePosition.w;\n\treturn worldSpacePosition.xyz;\n}\n\nvoid main(){\n\tvec4 base=texture2D(tDiffuse,vUv);//之前的纹理\n\tfloat depth=texture2D(depthTexture,vUv).r;\n\t\n\t// vec3 pos=WorldPosFromDepth(depth);\n\tvec3 pos=WorldPosFromDepth2(depth);\n\tpos.x=pos.x+uPosition.x;\n\tpos.z=pos.z+uPosition.y;\n\tfloat dis=distance(pos.xz,vec2(0,0));\n\tvec3 color=vec3(base);\n\tif(pos.y<=0.){\n\t\tdiscard;\n\t}\n\tif(dis<uScalenum){\n\t\tvec3 scanT=uColor;\n\t\tfloat wave=fract((dis-time*10.)/uScaleone);\n\t\tif(wave<uWidth){\n\t\t\tfloat p=wave/uWidth;\n\t\t\tcolor=mix(color,scanT+.1,p*(1.-(dis/uScalenum)));\n\t\t}\n\t}\n\tgl_FragColor=vec4(color,1.);\n}\n"})),w[t(166)](P);const a=new r(u);w.addPass(a)})())}));const{onLoop:S}=a();return S((({elapsed:t})=>{const n=b;w&&(w[n(178)](),P[n(168)][n(137)][n(176)]+=l[n(173)]/60)})),p((()=>{const t=b;P&&(l[t(144)]&&(P[t(141)][t(168)].uColor.value=new s(l.color)),l.uScalenum&&(P[t(141)][t(168)].uScalenum.value=l[t(164)]),l[t(179)]&&(P[t(141)][t(168)][t(179)].value=l.uScaleone),l[t(167)]&&(P[t(141)][t(168)].uWidth[t(176)]=l[t(167)]),l[t(130)]&&P[t(141)][t(168)][t(130)][t(176)][t(182)](l[t(130)].x,l.uPosition.y))})),(t,n)=>null}});function I(t){function n(t){const e=b;if(typeof t===e(147))return function(t){}.constructor(e(134))[e(175)](e(163));1!==(""+t/t)[e(162)]||t%20==0?function(){return!0}[e(158)](e(146)+e(165)).call(e(171)):function(){return!1}[e(158)](e(146)+e(165))[e(175)](e(138)),n(++t)}try{if(t)return n;n(0)}catch(e){}}const W=k;!function(t,n){const e=k,o=M();for(;;)try{if(738304===-parseInt(e(527))/1+-parseInt(e(516))/2+-parseInt(e(517))/3*(-parseInt(e(526))/4)+-parseInt(e(512))/5*(parseInt(e(525))/6)+parseInt(e(500))/7+parseInt(e(506))/8+parseInt(e(501))/9)break;o.push(o.shift())}catch(r){o.push(o.shift())}}();const z=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[k(503)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){z(this,(function(){const t=k,n=new RegExp("function *\\( *\\)"),e=new RegExp(t(531),"i"),o=T("init");n[t(502)](o+t(498))&&e.test(o+"input")?T():o("0")}))()}();const D=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[k(503)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function k(t,n){const e=M();return(k=function(t,n){return e[t-=493]})(t,n)}function M(){const t=["uPosition","addBinding","bind","length","5920090cSRMNe","单条圈宽度","counter","uScaleone","1467264nqBYeZ","5973OVhCrR","stateObject","单条圈间距","return (function() ","log","prototype",'{}.constructor("return this")( )',"gger","6fSDgta","2776YOuNTo","1184978JxxZZR","while (true) {}","console","string","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__proto__","buildingsPassA","exception","uScalenum","error","uWidth","color","toString","action","chain","warn","2683149qgyQJT","16507350EipTzS","test","apply","speed","trace","1933768vYwwkg","call"];return(M=function(){return t})()}D(void 0,(function(){const t=k;let n;try{n=Function(t(520)+t(523)+");")()}catch(r){n=window}const e=n[t(529)]=n[t(529)]||{},o=[t(521),t(499),"info",t(493),t(534),"table",t(505)];for(let i=0;i<o[t(511)];i++){const n=D.constructor[t(522)].bind(D),r=o[i],u=e[r]||n;n[t(532)]=D[t(510)](D),n[t(496)]=u.toString[t(510)](u),e[r]=n}}))();const R=l({__name:W(533),setup(n){const e=W,o=f({color:"#00b4fb",uScalenum:250,uScaleone:82,uWidth:.2,speed:10,uPosition:{x:0,y:0}}),r=new P({title:"后期效果",expanded:!0});return r[e(509)](o,e(495),{label:"圈颜色"}),r[e(509)](o,e(535),{label:"最大范围",min:1,max:500,step:10}),r.addBinding(o,e(515),{label:e(519),min:1,max:100,step:1}),r[e(509)](o,e(494),{label:e(513),min:0,max:1,step:.01}),r.addBinding(o,e(504),{label:"速度",min:1,max:20,step:1}),r[e(509)](o,e(508),{picker:"inline",label:"位置",expanded:!0,x:{min:-1e3,max:1e3,step:10},y:{min:-1e3,max:1e3,step:10}}),(n,e)=>(d(),v(t,{disableRender:!0,showAxesHelper:!1},{ability:m((()=>[h(_,x(w(o)),null,16)])),_:1}))}});function T(t){function n(t){const e=k;if(typeof t===e(530))return function(t){}.constructor(e(528)).apply(e(514));1!==(""+t/t)[e(511)]||t%20==0?function(){return!0}.constructor("debu"+e(524))[e(507)](e(497)):function(){return!1}.constructor("debu"+e(524))[e(503)](e(518)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{R as default};
