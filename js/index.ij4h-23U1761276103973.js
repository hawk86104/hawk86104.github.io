import{M as e}from"./mqttTvt.BXipTFfP1761276103973.js";import{_ as l}from"./@fesjs.DnM7nINA1761276103973.js";import{u as a,c as t,d as s,y as u,N as o,A as n,q as r,B as i,C as v,D as d,b as c,w as p}from"./naive-ui.D8O_guiL1761276103973.js";import{r as m,a as f,V as j,G as b,o as _,h,e as g,u as w,v as y,F as T,W as k,b as q,M as x}from"./@vue.CKlgtJke1761276103973.js";import"./events.BU9utmI-1761276103973.js";import"./mqtt.rTqcrTe21761276103973.js";import"./vue-router.BFHj2xRz1761276103973.js";import"./lodash-es.DWe8oqPO1761276103973.js";import"./pinia.C8YT0eOZ1761276103973.js";import"./@qlin.y-0Z8WnK1761276103973.js";import"./@babel.BPq7uOAK1761276103973.js";import"./@floating-ui.Bhq4ibgf1761276103973.js";import"./@juggle.Vc7cP4_P1761276103973.js";import"./date-fns.eh-WGDI81761276103973.js";import"./@css-render.BSXysVcI1761276103973.js";import"./css-render.BQ97w-lT1761276103973.js";import"./@emotion.DFFAhID71761276103973.js";import"./seemly.D2hUckm91761276103973.js";import"./vooks.E32gv4TK1761276103973.js";import"./evtd.C4K_ichY1761276103973.js";import"./vueuc.Cmkqcic61761276103973.js";import"./vdirs.DDVjUFpz1761276103973.js";import"./treemate.Qc8YxXqZ1761276103973.js";import"./date-fns-tz.CgRdO23u1761276103973.js";import"./async-validator.DJtlKCAR1761276103973.js";const M={class:"w-full",style:{"background-color":"#ffffff"}},U=l({__name:"MqttTesterUI",setup(l){const p=a(),U=m({host:"a5183db3.ala.asia-southeast1.emqxsl.com",port:8084,protocol:"wss",clientId:`tvt-test-client-${Math.random().toString(16).slice(2,8)}`,username:"tvt.js",password:"test",topic:"tvtDevices/#"}),C=f("tvtDevices/uiDemo"),I=f('{ "hello": "world" }'),Q=f(null),$=f(!1),D=f([]),S=f(!1);function N(){Q.value&&(Q.value.removeAllListeners(),Q.value.disconnect(),Q.value=null,$.value=!1)}function A(){N(),S.value=!0,Q.value=new e(U),Q.value.on("connected",()=>{$.value=!0,S.value=!1,p.success("MQTT 连接成功")}),Q.value.on("close",()=>{$.value=!1,S.value=!1,p.warning("MQTT 连接关闭")}),Q.value.on("error",e=>{S.value=!1,console.error(e),p.error(`MQTT 错误: ${e.message}`)}),Q.value.on("message",(e,l)=>{D.value.push(`[${e}] ${JSON.stringify(l)}`),D.value.length>100&&D.value.shift()}),Q.value.connect()}const J=f(new Set);function O(){if(Q.value)for(const e of J.value)Q.value.unsubscribe(e);J.value.clear(),N(),p.success("已断开连接")}function B(){if(!Q.value||!$.value)return void p.warning("尚未连接 MQTT");const e=U.topic?.trim();e?J.value.has(e)?p.info(`已订阅该主题：${e}`):(Q.value.subscribe(e),J.value.add(e),p.success(`订阅成功：${e}`)):p.warning("请输入订阅主题")}function G(){try{const e=JSON.parse(I.value);Q.value.publish(C.value,e),p.info("已发送消息")}catch(e){p.error("JSON 格式错误")}}return j(()=>{O()}),(e,l)=>(_(),b("div",M,[h(w(c),{title:"MQTT 调试面板",class:"max-w-4xl mx-auto"},{default:g(()=>[h(w(t),{model:U,"label-width":"100"},{default:g(()=>[h(w(s),{label:"注意："},{default:g(()=>[h(w(u),{style:{"margin-left":"10px"},type:"warning"},{default:g(()=>[...l[8]||(l[8]=[y("免费服务每月流量/次数有限，若连接失败请自行更换自己的mqtt服务",-1)])]),_:1})]),_:1}),h(w(s),{label:"地址"},{default:g(()=>[h(w(o),{value:U.host,"onUpdate:value":l[0]||(l[0]=e=>U.host=e),placeholder:"例如: broker.hivemq.com"},null,8,["value"])]),_:1}),h(w(s),{label:"端口"},{default:g(()=>[h(w(n),{value:U.port,"onUpdate:value":l[1]||(l[1]=e=>U.port=e),min:1},null,8,["value"]),h(w(u),{style:{"margin-left":"10px"},type:"info"},{default:g(()=>[...l[9]||(l[9]=[y("浏览器端只支持：wws方式 的 mqtt",-1)])]),_:1})]),_:1}),h(w(s),{label:"Client ID"},{default:g(()=>[h(w(o),{value:U.clientId,"onUpdate:value":l[2]||(l[2]=e=>U.clientId=e),placeholder:"随机生成也可"},null,8,["value"])]),_:1}),h(w(s),{label:"用户名"},{default:g(()=>[h(w(o),{value:U.username,"onUpdate:value":l[3]||(l[3]=e=>U.username=e)},null,8,["value"])]),_:1}),h(w(s),{label:"密码"},{default:g(()=>[h(w(o),{value:U.password,"onUpdate:value":l[4]||(l[4]=e=>U.password=e)},null,8,["value"])]),_:1}),h(w(s),{label:"订阅主题"},{default:g(()=>[h(w(o),{value:U.topic,"onUpdate:value":l[5]||(l[5]=e=>U.topic=e),placeholder:"例如: tvt/demo"},null,8,["value"])]),_:1}),h(w(r),null,{default:g(()=>[h(w(i),{type:"primary",disabled:$.value||S.value,loading:S.value,onClick:A},{default:g(()=>[...l[10]||(l[10]=[y("连接",-1)])]),_:1},8,["disabled","loading"]),h(w(i),{type:"warning",disabled:!$.value,onClick:O},{default:g(()=>[...l[11]||(l[11]=[y("断开",-1)])]),_:1},8,["disabled"]),h(w(i),{type:"success",disabled:!$.value,onClick:B},{default:g(()=>[...l[12]||(l[12]=[y("订阅",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"]),h(w(v),null,{default:g(()=>[...l[13]||(l[13]=[y("已订阅主题",-1)])]),_:1}),h(w(r),null,{default:g(()=>[(_(!0),b(T,null,k(Array.from(J.value),e=>(_(),q(w(u),{key:e,type:"info",round:""},{default:g(()=>[y(x(e),1)]),_:2},1024))),128))]),_:1}),h(w(v),null,{default:g(()=>[...l[14]||(l[14]=[y("发送消息 [主题/json消息]",-1)])]),_:1}),h(w(o),{value:C.value,"onUpdate:value":l[6]||(l[6]=e=>C.value=e),placeholder:"主题",class:"mb-2"},null,8,["value"]),h(w(o),{value:I.value,"onUpdate:value":l[7]||(l[7]=e=>I.value=e),type:"textarea",placeholder:'{ "key": "value" }',rows:4},null,8,["value"]),h(w(i),{type:"info",class:"mt-2",disabled:!$.value,onClick:G},{default:g(()=>[...l[15]||(l[15]=[y("发送",-1)])]),_:1},8,["disabled"]),h(w(v),null,{default:g(()=>[...l[16]||(l[16]=[y("收到的消息",-1)])]),_:1}),h(w(d),{log:D.value.join("\n"),rows:12},null,8,["log"])]),_:1})]))}},[["__scopeId","data-v-e8d1d438"]]),C={__name:"index",setup:e=>(e,l)=>(_(),q(w(p),null,{default:g(()=>[h(U)]),_:1}))};export{C as default};
