import{_ as e}from"./@fesjs.DbrjsIBT1761100244891.js";import"./Resource.mX5inOAT1761100244891.js";/* empty css                                                                             */import{l as a}from"./bubbleLoading.CpUQAUq31761100244891.js";import"./three-mesh-ui.module.B6HSvFaK1761100244891.js";import"./global.CFybmx-G1761100244891.js";/* empty css                                                              */import{_ as t}from"./ScrollControls.vue_vue_type_script_setup_true_lang.D2CmaTHD1761100244891.js";import{P as o}from"./tweakpane.CqZAnw7f1761100244891.js";import{v as r,b1 as n,b2 as s,i,j as l,o as u,q as c,l as m,bJ as p,k as d,J as v,A as f,aD as g,cp as x,a1 as h,O as y,b as w,cq as _,cr as j,cs as P,d as b,r as M,ct as z,ad as S,as as T}from"./three.DvmzhRS91761100244891.js";import{N as A,_ as B,F as C}from"./@tresjs.DqJWjmrH1761100244891.js";import{l as F}from"./util.Bz2eiElJ1761100244891.js";import{d as D,G as R,o as U,u as I,a as k,ac as q,w as L,b as V,a3 as Y,r as G,g as J,h as O,I as N,e as X,ap as E,a9 as W,aa as H,F as K}from"./@vue.CKlgtJke1761100244891.js";import"./vue-router.AUgVvTqV1761100244891.js";import"./lodash-es.DWe8oqPO1761100244891.js";import"./pinia.-nSLzXOT1761100244891.js";import"./@qlin.y-0Z8WnK1761100244891.js";import"./@babel.BPq7uOAK1761100244891.js";import"./@floating-ui.Bhq4ibgf1761100244891.js";import"./@juggle.Vc7cP4_P1761100244891.js";import"./utils.g-0SwCPh1761100244891.js";import"./color.DSPNiGxi1761100244891.js";import"./color-string.Bn2Vqey71761100244891.js";import"./color-name.gyPnsvCn1761100244891.js";import"./lodash.DPxB_j171761100244891.js";import"./@amap.fjyZdsU91761100244891.js";import"./@vueuse.mZcBai3M1761100244891.js";import"./postprocessing.CYU4Fj-U1761100244891.js";const Q=e=>{let a=e.attributes.position.count,t=Math.ceil(Math.sqrt(a)),o=Math.ceil(a/t),i=new Float32Array(t*o*4);!function(e){for(let a=Math.floor(e.length/3)-1;a>0;a--){const t=Math.floor(Math.random()*(a+1));for(let o=0;o<3;o++){let r=e[3*a+o];e[3*a+o]=e[3*t+o],e[3*t+o]=r}}}(e.attributes.position.array);for(let r=0;r<a;r++){const a=e.attributes.position.array[3*r+0],t=e.attributes.position.array[3*r+1],o=e.attributes.position.array[3*r+2],n=0;i[4*r+0]=a,i[4*r+1]=t,i[4*r+2]=o,i[4*r+3]=n}let l=new r(i,t,o,n,s);return l.needsUpdate=!0,l},Z=()=>{const e=new c({uniforms:{uTextureA:{value:null},uTextureB:{value:null},uTime:{value:0},uScroll:{value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUv = uv;\n}",fragmentShader:"uniform sampler2D uTextureA;\nuniform sampler2D uTextureB;\nprecision mediump float; \nuniform float uTime;\nuniform float uScroll;\nvarying vec2 vUv;\n\nmat3 rotationMatrix3(vec3 axis, float angle) {\n  axis = normalize(axis);\n  float s = sin(angle);\n  float c = cos(angle);\n  float oc = 1. - c;\n\n  return mat3(oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s,\n              oc * axis.z * axis.x + axis.y * s,\n              oc * axis.x * axis.y + axis.z * s, oc * axis.y * axis.y + c,\n              oc * axis.y * axis.z - axis.x * s,\n              oc * axis.z * axis.x - axis.y * s,\n              oc * axis.y * axis.z + axis.x * s, oc * axis.z * axis.z + c);\n}\n\nvoid main() {\n  vec3 textureA = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureA, vUv).xyz;\n  \n\n  vec3 textureB = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureB, vUv).xyz;\n  \n\n  float t = uScroll;\n  vec3 pos = mix(textureA, textureB, t);\n\n  gl_FragColor = vec4(pos, 1.);\n}"}),a=new i;return a.setAttribute("position",new l(new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]),3)),a.setAttribute("uv",new l(new Float32Array([0,1,1,1,1,0,0,1,1,0,0,0]),2)),new u(a,e)};const $=["object"],ee=D({__name:"particalMesh",props:{progress:{default:0},width:{default:256},height:{default:256}},setup(e,{expose:a}){const t=e;let o=((e,a)=>{const t=e*a;let o=new Float32Array(3*t);for(let n=0;n<t;n++){let t=3*n;o[t+0]=n%e/e,o[t+1]=n/e/a}const r=new i;return r.setAttribute("position",new l(o,3)),new m(r,new c({uniforms:{uPositions:{value:null},uSize:{value:12},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uColor:{value:new d("#ffaa00")}},vertexShader:"uniform sampler2D\n    uPositions; \nuniform float uSize;\nuniform float uPixelRatio;\nvarying vec3 vPos;\nvarying vec2 vUv;\nvoid main() {\n  vec3 pos = texture2D(uPositions, position.xy).xyz;\n\n  float customSize = uSize;\n\n  vec4 modelPosition = modelMatrix * vec4(pos, 1.0);\n  vec4 viewPosition = viewMatrix * modelPosition;\n  vec4 projectionPosition = projectionMatrix * viewPosition;\n\n  gl_Position = projectionPosition;\n  gl_PointSize = customSize * uPixelRatio;\n  gl_PointSize *= (1.0 / -viewPosition.z);\n\n  vPos = pos;\n}",fragmentShader:"precision mediump float;\nvarying vec3 vPos;\nuniform vec3 uColor; \nvoid main() {\n\n  float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n  float strength = 0.05 / distanceToCenter - 0.1;\n\n  \n\n  gl_FragColor = vec4(uColor, strength * length(vPos));\n}",transparent:!0,depthWrite:!1,blending:p}))})(t.width,t.height);return a({particles:o}),(e,a)=>(U(),R("primitive",{object:I(o)},null,8,$))}}),ae=D({__name:"particalFBO",props:{progress:{default:0},width:{default:256},height:{default:256},color:{default:"#ffaa00"}},async setup(e){let a,t;const o=e,r=k(null),i=new v(o.width,o.height,{minFilter:g,magFilter:g,generateMipmaps:!1,colorSpace:f,depthBuffer:!1,stencilBuffer:!1,format:n,type:s}),l=e=>{const a=[];return e.traverse(e=>{e instanceof u&&(e.geometry.deleteAttribute("uv"),e.geometry.deleteAttribute("normal"),e.geometry.deleteAttribute("tangent"),a.push(e.geometry))}),_(a)},c="https://opensource.cdn.icegl.cn",m=c+"/model/medical/brainparts.OBJ",p=new x,d=([a,t]=q(()=>F(m,p)),a=await a,t(),a),j=l(d);j.scale(.01,.01,.01);const P=Q(j),b=k(null),M=k(null),z=c+"/model/eCommerce/guanYu.glb",{state:S,nodes:T,materials:D,animations:R}=A(z,{draco:!0,decoderPath:"./draco/"});L(()=>S.value,e=>{if(e?.scene)try{const a=e.scene||e?.scene||e.scene,t=a.children?.[0]??a,o=l(t);o.rotateX(Math.PI/2),o.translate(0,-.9,0),b.value=Q(o)}catch(a){console.warn("guanyu merge error",a)}},{immediate:!0});const I=c+"/model/industry4/modelDraco.glb",{state:Y,nodes:G,materials:J,animations:O}=A(I,{draco:!0,decoderPath:"./draco/"});L(()=>Y.value,e=>{if(e?.scene)try{const a=e.scene||e,t=a.children?.[0]??a,o=l(t);o.rotateX(-Math.PI/2),o.rotateY(Math.PI/3),o.translate(0,0,0),M.value=Q(o)}catch(a){console.warn("plane merge error",a)}},{immediate:!0});const N=Z(),X=new h,E=new y(-1,1,1,-1,1/Math.pow(2,53),1);X.add(N);const{onBeforeRender:W}=B(),{camera:H,renderer:K}=C();return W(({elapsed:e})=>{if(K&&H.value&&r.value){K.setRenderTarget(i),K.clear(),K.render(X,E),K.setRenderTarget(null);const a=b.value||null,t=P||null,n=M.value||null,s=w.clamp(-o.progress/2,0,1);if(s<.5?(N.material.uniforms.uTextureA.value=a??t,N.material.uniforms.uTextureB.value=t,N.material.uniforms.uScroll.value=2*s):(N.material.uniforms.uTextureA.value=t,N.material.uniforms.uTextureB.value=n??t,N.material.uniforms.uScroll.value=2*(s-.5)),N.material.uniforms.uTime.value=e,r.value?.particles?.material?.uniforms){r.value.particles.material.uniforms.uPositions.value=i.texture;const e=r.value.particles.material.uniforms.uColor;e&&e.value.setStyle(o.color)}}}),(e,a)=>(U(),V(ee,{ref_key:"pMesh",ref:r,progress:e.progress},null,8,["progress"]))}}),te=D({__name:"particalPass",props:{use:{type:Boolean,default:!0}},setup(e){const a=e,{camera:t,renderer:o,scene:r,sizes:s}=C(),i=0,l=.472,u=1.61;let c=null;Y(()=>{s.width.value&&((e,a,t,o,r)=>{const s=new j(e,a),m=new P(new b(o,r),l,u,i),p=new v(o,r,{generateMipmaps:!1,minFilter:M,magFilter:M,format:n,colorSpace:f,samples:0});c=new z(t,p),c.addPass(s),c.addPass(m)})(r.value,t.value,o,s.width.value,s.height.value)});const{onRender:m}=B();return m(()=>{a.use?c&&c.render():o&&t.value&&o.render(r.value,t.value)}),(e,a)=>null}}),oe=e(D({__name:"scrollPartical",setup(e){const r=k(0);Y(()=>{console.log("jaime ~ progress:",r.value)});const n={clearColor:"#000",outputColorSpace:T,toneMapping:S,toneMappingExposure:1,windowSize:!0,renderMode:"manual",powerPreference:"high-performance",antialias:!0,alpha:!1,useLegacyLights:!1,physicallyCorrectLights:!0},s=G({pass:!0,color:"#6aff00"}),i=new o({title:"参数",expanded:!0});return i.addBinding(s,"pass",{label:"后处理"}),i.addBinding(s,"color",{label:"颜色"}),(e,o)=>{const i=J("TresCanvas");return U(),R(K,null,[O(I(a),{styleNum:4}),O(i,W(H(n)),{default:X(()=>[o[1]||(o[1]=N("TresPerspectiveCamera",{position:[0,0,-4],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),O(te,{use:s.pass},null,8,["use"]),O(t,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=e=>r.value=e),distance:10,"smooth-scroll":.1,htmlScroll:""},{default:X(()=>[(U(),V(E,null,{default:X(()=>[O(ae,{progress:r.value,color:s.color},null,8,["progress","color"])]),_:1}))]),_:1},8,["modelValue"])]),_:1},16),o[2]||(o[2]=N("main",null,[N("section",null,[N("h1",null,"关羽 - GuanYu")]),N("section",null,[N("h1",{style:{"margin-left":"-11em","margin-bottom":"-10em"}},"大脑 - Brain")]),N("section",null,[N("h1",{style:{"margin-left":"11em","margin-bottom":"-10em"}},"设备 - Device")])],-1))],64)}}}),[["__scopeId","data-v-9439621a"]]);export{oe as default};
