var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,a=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&s(e,n,t[n]);if(r)for(var n of r(t))i.call(t,n)&&s(e,n,t[n]);return e},l=(e,r)=>t(e,n(r)),c=(e,t)=>{var n={};for(var s in e)o.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&r)for(var s of r(e))t.indexOf(s)<0&&i.call(e,s)&&(n[s]=e[s]);return n};import{a7 as u,a2 as h,q as d,a8 as p,_ as m,a9 as f,aa as g,ab as v,C as y,h as b,ac as _,B as w,ad as x,ae as T,s as E,$ as M,K as A,af as S,ag as O,ah as C,ai as I,aj as P,d as R,ak as L,al as k,am as D,a as U,an as F,k as N,V as z,a0 as j,m as B,U as H,ao as V,E as Y,R as X,e as G,ap as W,aq as Z,ar as K,M as q,D as Q,as as $,f as J,Q as ee,g as te,S as ne,at as re,au as oe,av as ie,aw as se,ax as ae,H as le,ay as ce,t as ue,az as he,aA as de,aB as pe,aC as me,aD as fe,aE as ge,aF as ve,l as ye,aG as be,O as _e,aH as we,aI as xe,aJ as Te,aK as Ee,aL as Me,aM as Ae,aN as Se,aO as Oe,A as Ce,aP as Ie,aQ as Pe,aR as Re,aS as Le,aT as ke,c as De,W as Ue,aU as Fe,aV as Ne,a3 as ze,aW as je,Y as Be,aX as He,N as Ve,aY as Ye,a4 as Xe,aZ as Ge,a_ as We,a$ as Ze,i as Ke,b0 as qe,b1 as Qe,b2 as $e,b3 as Je,b4 as et,p as tt,b5 as nt,b6 as rt,b7 as ot,b8 as it,a6 as st,I as at,T as lt,b9 as ct,n as ut,J as ht,P as dt,ba as pt,bb as mt,bc as ft,b as gt,bd as vt,be as yt,bf as bt,bg as _t,bh as wt,bi as xt,bj as Tt,bk as Et,bl as Mt,bm as At,bn as St,bo as Ot,bp as Ct,bq as It,z as Pt,br as Rt,bs as Lt,bt as kt,bu as Dt,bv as Ut}from"./three.CQvcOG671729762363846.js";import{l as Ft,n as Nt,u as zt,b as jt,w as Bt,D as Ht,q as Vt,t as Yt,x as Xt,a0 as Gt,p as Wt,a1 as Zt,a as Kt,a2 as qt,i as Qt,r as $t,d as Jt,a3 as en,Y as tn,V as nn,o as rn,E as on,G as sn,M as an,v as ln,a4 as cn,R as un,F as hn,a5 as dn,a6 as pn,J as mn,H as fn,s as gn,m as vn,f as yn,L as bn,a7 as _n,j as wn,_ as xn,a8 as Tn,a9 as En,g as Mn,W as An,I as Sn,O as On,Q as Cn,B as In,y as Pn}from"./@vue.n8X62v121729762363846.js";import{u as Rn,a as Ln,i as kn,b as Dn,d as Un,e as Fn,f as Nn,g as zn,h as jn}from"./@vueuse.DvZn62wO1729762363846.js";function Bn(e){return!!Ft()&&(Nt(e),!0)}function Hn(){const e=new Set,t=t=>{e.delete(t)};return{on:n=>{e.add(n);const r=()=>t(n);return Bn(r),{off:r}},off:t,trigger:(...t)=>Promise.all(Array.from(e).map((e=>e(...t))))}}function Vn(e){return"function"==typeof e?e():zt(e)}const Yn="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const Xn=e=>null!=e,Gn=Object.prototype.toString,Wn=e=>"[object Object]"===Gn.call(e),Zn=()=>{};function Kn(e,t=200,n={}){return function(e,t){return function(...n){return new Promise(((r,o)=>{Promise.resolve(e((()=>t.apply(this,n)),{fn:t,thisArg:this,args:n})).then(r).catch(o)}))}}(function(e,t={}){let n,r,o=Zn;const i=e=>{clearTimeout(e),o(),o=Zn};return s=>{const a=Vn(e),l=Vn(t.maxWait);return n&&i(n),a<=0||void 0!==l&&l<=0?(r&&(i(r),r=null),Promise.resolve(s())):new Promise(((e,c)=>{o=t.rejectOnCancel?c:e,l&&!r&&(r=setTimeout((()=>{n&&i(n),r=null,e(s())}),l)),n=setTimeout((()=>{r&&i(r),r=null,e(s())}),a)}))}}(t,n),e)}function qn(e,t=200,n={}){const r=jt(e.value),o=Kn((()=>{r.value=e.value}),t,n);return Bt(e,(()=>o())),r}function Qn(e,t=!0,n){Wt()?Vt(e,n):t?e():Yt(e)}function $n(e){var t;const n=Vn(e);return null!=(t=null==n?void 0:n.$el)?t:n}const Jn=Yn?window:void 0;function er(...e){let t,n,r,o;if("string"==typeof e[0]||Array.isArray(e[0])?([n,r,o]=e,t=Jn):[t,n,r,o]=e,!t)return Zn;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const i=[],s=()=>{i.forEach((e=>e())),i.length=0},l=Bt((()=>[$n(t),Vn(o)]),(([e,t])=>{if(s(),!e)return;const o=Wn(t)?a({},t):t;i.push(...n.flatMap((t=>r.map((n=>((e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)))(e,t,n,o))))))}),{immediate:!0,flush:"post"}),c=()=>{l(),s()};return Bn(c),c}function tr(e){const t=function(){const e=jt(!1),t=Wt();return t&&Vt((()=>{e.value=!0}),t),e}();return Kt((()=>(t.value,Boolean(e()))))}function nr(e,t={}){const{immediate:n=!0,fpsLimit:r,window:o=Jn}=t,i=jt(!1),s=r?1e3/r:null;let a=0,l=null;function c(t){if(!i.value||!o)return;a||(a=t);const n=t-a;s&&n<s||(a=t,e({delta:n,timestamp:t})),l=o.requestAnimationFrame(c)}function u(){!i.value&&o&&(i.value=!0,a=0,l=o.requestAnimationFrame(c))}function h(){i.value=!1,null!=l&&o&&(o.cancelAnimationFrame(l),l=null)}return n&&u(),Bn(h),{isActive:Zt(i),pause:h,resume:u}}function rr(e,t,n={}){const r=n,{window:o=Jn}=r,i=c(r,["window"]);let s;const a=tr((()=>o&&"ResizeObserver"in o)),l=()=>{s&&(s.disconnect(),s=void 0)},u=Kt((()=>Array.isArray(e)?e.map((e=>$n(e))):[$n(e)])),h=Bt(u,(e=>{if(l(),a.value&&o){s=new ResizeObserver(t);for(const t of e)t&&s.observe(t,i)}}),{immediate:!0,flush:"post"}),d=()=>{l(),h()};return Bn(d),{isSupported:a,stop:d}}function or(e,t={}){const{reset:n=!0,windowResize:r=!0,windowScroll:o=!0,immediate:i=!0}=t,s=jt(0),a=jt(0),l=jt(0),u=jt(0),h=jt(0),d=jt(0),p=jt(0),m=jt(0);function f(){const t=$n(e);if(!t)return void(n&&(s.value=0,a.value=0,l.value=0,u.value=0,h.value=0,d.value=0,p.value=0,m.value=0));const r=t.getBoundingClientRect();s.value=r.height,a.value=r.bottom,l.value=r.left,u.value=r.right,h.value=r.top,d.value=r.width,p.value=r.x,m.value=r.y}return rr(e,f),Bt((()=>$n(e)),(e=>!e&&f())),function(e,t,n={}){const r=n,{window:o=Jn}=r,i=c(r,["window"]);let s;const a=tr((()=>o&&"MutationObserver"in o)),l=()=>{s&&(s.disconnect(),s=void 0)},u=Kt((()=>{const t=Vn(e),n=(Array.isArray(t)?t:[t]).map($n).filter(Xn);return new Set(n)})),h=Bt((()=>u.value),(e=>{l(),a.value&&e.size&&(s=new MutationObserver(t),e.forEach((e=>s.observe(e,i))))}),{immediate:!0,flush:"post"}),d=()=>{l(),h()};Bn(d)}(e,f,{attributeFilter:["style","class"]}),o&&er("scroll",f,{capture:!0,passive:!0}),r&&er("resize",f,{passive:!0}),Qn((()=>{i&&f()})),{height:s,bottom:a,left:l,right:u,top:h,width:d,x:p,y:m,update:f}}function ir(e={}){const t=jt(),n=tr((()=>"undefined"!=typeof performance&&"memory"in performance));if(n.value){const{interval:n=1e3}=e;!function(e,t=1e3,n={}){const{immediate:r=!0,immediateCallback:o=!1}=n;let i=null;const s=jt(!1);function a(){i&&(clearInterval(i),i=null)}function l(){s.value=!1,a()}function c(){const n=Vn(t);n<=0||(s.value=!0,o&&e(),a(),i=setInterval(e,n))}r&&Yn&&c(),(Ht(t)||"function"==typeof t)&&Bn(Bt(t,(()=>{s.value&&Yn&&c()})));Bn(l)}((()=>{t.value=performance.memory}),n,{immediate:e.immediate,immediateCallback:e.immediateCallback})}return{isSupported:n,memory:t}}const sr={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},ar=Object.keys(sr);function lr(e={}){const{target:t=Jn}=e,n=jt(!1),r=jt(e.initialValue||{});Object.assign(r.value,sr,r.value);if(t){const o={passive:!0};er(t,["pointerdown","pointermove","pointerup"],(t=>{n.value=!0,e.pointerTypes&&!e.pointerTypes.includes(t.pointerType)||(r.value=function(e,t,n=!1){return t.reduce(((t,r)=>(r in e&&(n&&void 0===e[r]||(t[r]=e[r])),t)),{})}(t,ar,!1))}),o),er(t,"pointerleave",(()=>n.value=!1),o)}return l(a({},function(e,t={}){if(!Ht(e))return Xt(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const r in e.value)n[r]=Gt((()=>({get:()=>e.value[r],set(n){var o;if(null==(o=Vn(t.replaceRef))||o)if(Array.isArray(e.value)){const t=[...e.value];t[r]=n,e.value=t}else{const t=l(a({},e.value),{[r]:n});Object.setPrototypeOf(t,Object.getPrototypeOf(e.value)),e.value=t}else e.value[r]=n}})));return n}(r)),{isInside:n})}function cr(e={}){const{window:t=Jn,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:o=!0,includeScrollbar:i=!0}=e,s=jt(n),a=jt(r),l=()=>{t&&(i?(s.value=t.innerWidth,a.value=t.innerHeight):(s.value=t.document.documentElement.clientWidth,a.value=t.document.documentElement.clientHeight))};if(l(),Qn(l),er("resize",l,{passive:!0}),o){const e=function(e,t={}){const{window:n=Jn}=t,r=tr((()=>n&&"matchMedia"in n&&"function"==typeof n.matchMedia));let o;const i=jt(!1),s=e=>{i.value=e.matches},a=()=>{o&&("removeEventListener"in o?o.removeEventListener("change",s):o.removeListener(s))},l=qt((()=>{r.value&&(a(),o=n.matchMedia(Vn(e)),"addEventListener"in o?o.addEventListener("change",s):o.addListener(s),i.value=o.matches)}));return Bn((()=>{l(),a(),o=void 0})),i}("(orientation: portrait)");Bt(e,(()=>l()))}return{width:s,height:a}}var ur=Object.defineProperty,hr=(e,t,n)=>((e,t,n)=>t in e?ur(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const dr={name:"@tresjs/core",type:"module",version:"4.2.10",packageManager:"pnpm@9.1.4",description:"Declarative ThreeJS using Vue Components",author:"Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",license:"MIT",repository:{type:"git",url:"git+https://github.com/Tresjs/tres.git"},keywords:["vue","3d","threejs","three","threejs-vue"],sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},main:"./dist/tres.js",module:"./dist/tres.js",types:"./dist/index.d.ts",files:["*.d.ts","dist"],publishConfig:{access:"public"},scripts:{dev:"cd playground/vue && npm run dev","dev:nuxt":"cd playground/nuxt && npm run dev",build:"vite build",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts",prepare:"node .husky/install.mjs"},peerDependencies:{three:">=0.133",vue:">=3.4"},dependencies:{"@alvarosabu/utils":"^3.2.0","@vue/devtools-api":"^6.6.3","@vueuse/core":"^10.11.0"},devDependencies:{"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.11.0","@tresjs/cientos":"4.0.2","@tresjs/eslint-config":"^1.1.0","@types/three":"^0.168.0","@typescript-eslint/eslint-plugin":"^8.4.0","@typescript-eslint/parser":"^8.4.0","@vitejs/plugin-vue":"^5.0.5","@vitest/coverage-c8":"^0.33.0","@vitest/coverage-v8":"^2.0.2","@vitest/ui":"^2.0.2","@vue/test-utils":"^2.4.6",eslint:"^9.6.0","eslint-plugin-vue":"^9.28.0",esno:"^4.7.0",gsap:"^3.12.5",husky:"^9.0.11",jsdom:"^25.0.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.2","release-it":"^17.5.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.12.0",sponsorkit:"^0.15.4",three:"^0.168.0",unocss:"^0.62.3",unplugin:"^1.13.1","unplugin-vue-components":"^0.27.2",vite:"^5.4.3","vite-plugin-banner":"^0.8.0","vite-plugin-dts":"4.1.0","vite-plugin-inspect":"^0.8.4","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.3.4",vitest:"^2.0.2",vue:"3.5.0","vue-demi":"^0.14.8"}};function pr(e){return typeof e>"u"}function mr(e){return Array.isArray(e)}function fr(e){return"string"==typeof e}function gr(e){return"function"==typeof e}function vr(e){return e===Object(e)&&!mr(e)&&!gr(e)}function yr(e){return vr(e)&&"isObject3D"in e&&!!e.isObject3D}function br(e){return vr(e)&&"isCamera"in e&&!!e.isCamera}function _r(e){return yr(e)||function(e){return vr(e)&&"isBufferGeometry"in e&&!!e.isBufferGeometry}(e)||function(e){return vr(e)&&"isMaterial"in e&&!!e.isMaterial}(e)||function(e){return vr(e)&&"isFog"in e&&!!e.isFog}(e)}const wr=Hn(),xr=Hn(),Tr=Hn(),Er=new u;let Mr=0,Ar=0;const{pause:Sr,resume:Or,isActive:Cr}=nr((()=>{wr.trigger({delta:Mr,elapsed:Ar,clock:Er}),xr.trigger({delta:Mr,elapsed:Ar,clock:Er}),Tr.trigger({delta:Mr,elapsed:Ar,clock:Er})}),{immediate:!1});Tr.on((()=>{Mr=Er.getDelta(),Ar=Er.getElapsedTime()}));let Ir=!1;const Pr=()=>(Ir||(Ir=!0,Or()),{onBeforeLoop:wr.on,onLoop:xr.on,onAfterLoop:Tr.on,pause:Sr,resume:Or,isActive:Cr}),Rr="[TresJS â–² â–  â—] ";function Lr(){return{logError:function(...e){"string"==typeof e[0]?e[0]=Rr+e[0]:e.unshift(Rr),console.error(...e)},logWarning:function(...e){"string"==typeof e[0]?e[0]=Rr+e[0]:e.unshift(Rr),console.warn(...e)},logMessage:function(e,t){}}}function kr(e){return e instanceof y?e:Array.isArray(e)?new y(...e):new y(e)}let Dr=class extends E{constructor(...e){super(...e),hr(this,"type","HightlightMesh"),hr(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,t=1+.07*Math.sin(2.5*e);this.scale.set(t,t,t)}};const Ur=(e,t)=>{for(const n of Object.keys(t))t[n]instanceof Object&&Object.assign(t[n],Ur(e[n],t[n]));return Object.assign(e||{},t),e},Fr=Hr("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot");function Nr(e){return e&&1===e.nodeType}function zr(e){return e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()))}const jr=/\B([A-Z])/g;function Br(e){return e.replace(jr,"-$1").toLowerCase()}function Hr(e,t){const n=Object.create(null),r=e.split(",");for(let o=0;o<r.length;o++)n[r[o]]=!0;return e=>!!n[e]}const Vr=(e,t)=>{if(!t)return;const n=Array.isArray(t)?t:t.match(/([^[.\]])+/g);return null==n?void 0:n.reduce(((e,t)=>e&&e[t]),e)},Yr=(e,t,n)=>{const r=Array.isArray(t)?t:t.match(/([^[.\]])+/g);r&&r.reduce(((e,t,o)=>(void 0===e[t]&&(e[t]={}),o===r.length-1&&(e[t]=n),e[t])),e)};function Xr(e,t){if(Nr(e)&&Nr(t)){const n=e.attributes,r=t.attributes;return n.length===r.length&&Array.from(n).every((({name:e,value:n})=>t.getAttribute(e)===n))}if(e===t)return!0;if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const o of n)if(!r.includes(o)||!Xr(e[o],t[o]))return!1;return!0}const Gr=Array.isArray;function Wr(e){(function(e){return"map"in e})(e)&&e.map&&e.map.dispose(),e.dispose()}function Zr(e){var t,n;if(e.parent&&(null==(t=e.removeFromParent)||t.call(e)),delete e.__tres,[...e.children].forEach((e=>Zr(e))),!(e instanceof d)){const t=e;e&&(null==(n=e.dispose)||n.call(e)),t.geometry&&(t.geometry.dispose(),delete t.geometry),Array.isArray(t.material)?(t.material.forEach((e=>Wr(e))),delete t.material):t.material&&(Wr(t.material),delete t.material)}}function Kr(e,t){let n=e;if(t.includes("-")){const e=t.split("-");let r=e.shift();for(;n&&e.length;)r in n?(n=n[r],r=e.shift()):r=qr(r,e.shift());return{target:n,key:qr(r,...e)}}return{target:n,key:t}}function qr(...e){return e.map(((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1))).join("")}const Qr=/-\d+$/;function $r(e,t,n){const r=e;return r.__tres=a({type:"unknown",eventCount:0,root:n,handlers:{},memoizedProps:{},objects:[],parent:null,previousAttach:null},t),r.__tres.attach||(r.isMaterial?r.__tres.attach="material":r.isBufferGeometry?r.__tres.attach="geometry":r.isFog&&(r.__tres.attach="fog")),r}function Jr(e){var t;const n=null==(t=null==e?void 0:e.__tres)?void 0:t.root;n&&n.render&&n.render.canBeInvalidated.value&&n.invalidate()}function eo(e){return function(e){return vr(e)&&!!e.isPrimitive}(e)?(e.object.__tres=e.__tres,e.object):e}function to(e,t){var n,r,o,i;const s=(null==(n=e.__tres)?void 0:n.parent)||t.scene.value;e.__tres&&(e.__tres.parent=null),s&&s.__tres&&"objects"in s.__tres&&function(e,t){let n=0;for(let r=0;r<e.length;r++)t(e[r],r)&&(e[n]=e[r],n++);e.length=n}(s.__tres.objects,(t=>t!==e)),null!=(r=e.__tres)&&r.attach?function(e,t,n){var r,o,i;if(fr(n)){const{target:r,key:o}=Kr(e,n),i=t.__tres.previousAttach;void 0===i?delete r[o]:r[o]=i,"__tresDetach"in r&&r.__tresDetach()}else null==(o=null==(r=t.__tres)?void 0:r.previousAttach)||o.call(r,e,t);null==(i=t.__tres)||delete i.previousAttach}(s,e,e.__tres.attach):(null==(i=null==(o=e.parent)?void 0:o.remove)||i.call(o,eo(e)),e.parent=null)}function no(e,t){var n;null==(n=e.traverse)||n.call(e,(e=>{var n;t.deregisterCamera(e),null==(n=t.eventManager)||n.deregisterPointerMissedObject(e)})),t.deregisterCamera(e),Jr(e)}const ro=Number.parseInt(R.replace("dev","")),oo={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:L,toneMapping:v,toneMappingExposure:3,shadowMap:{enabled:!0,type:k}},flat:{toneMapping:D,toneMappingExposure:1}};function io({canvas:e,options:t,contextParts:{sizes:n,render:r,invalidate:o,advance:i}}){const s=Kt((()=>{var n,r;return{alpha:null==(n=Vn(t.alpha))||n,depth:Vn(t.depth),canvas:$n(e),context:Vn(t.context),stencil:Vn(t.stencil),antialias:null==(r=Vn(t.antialias))||r,precision:Vn(t.precision),powerPreference:Vn(t.powerPreference),premultipliedAlpha:Vn(t.premultipliedAlpha),preserveDrawingBuffer:Vn(t.preserveDrawingBuffer),logarithmicDepthBuffer:Vn(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:Vn(t.failIfMajorPerformanceCaveat)}})),a=tn(new g(s.value));function l(){"on-demand"===t.renderMode&&o()}Bt(s,(()=>{a.value.dispose(),a.value=new g(s.value),l()})),Bt([n.width,n.height],(()=>{a.value.setSize(n.width.value,n.height.value),l()}),{immediate:!0}),Bt((()=>t.clearColor),l);const{pixelRatio:c}=function(e={}){const{window:t=Jn}=e,n=jt(1);if(t){let e,r=function(){n.value=t.devicePixelRatio,o(),e=t.matchMedia("(resolution: ".concat(n.value,"dppx)")),e.addEventListener("change",r,{once:!0})},o=function(){null==e||e.removeEventListener("change",r)};r(),Bn(o)}return{pixelRatio:n}}(),{logError:u}=Lr(),h=(()=>{const e=new g,t={shadowMap:{enabled:e.shadowMap.enabled,type:e.shadowMap.type},toneMapping:e.toneMapping,toneMappingExposure:e.toneMappingExposure,outputColorSpace:e.outputColorSpace};return e.dispose(),t})(),d=Vn(t.renderMode);return"on-demand"===d&&o(),"manual"===d&&setTimeout((()=>{i()}),100),qt((()=>{var e;const n=Vn(t.preset);n&&(n in oo||u("Renderer Preset must be one of these: ".concat(Object.keys(oo).join(", "))),Ur(a.value,oo[n])),function(e,t,n){var r;if(!gr(e.setPixelRatio))return;let o=0;if(mr(n)&&n.length>=2){const[e,r]=n;o=b.clamp(t,e,r)}else o=function(e){return"number"==typeof e}(n)?n:t;o!==(null==(r=e.getPixelRatio)?void 0:r.call(e))&&e.setPixelRatio(o)}(a.value,c.value,Vn(t.dpr)),"always"===d&&(r.frames.value=Math.max(1,r.frames.value));const o=(e,t)=>{const r=Vn(e);if(void 0!==r)return r;const o=(()=>{if(n)return Vr(oo[n],t)})();return void 0!==o?o:Vr(h,t)},i=(e,t)=>Yr(a.value,t,o(e,t));i(t.shadows,"shadowMap.enabled"),i(null!=(e=t.toneMapping)?e:v,"toneMapping"),i(t.shadowMapType,"shadowMap.type"),ro<150&&i(!t.useLegacyLights,"physicallyCorrectLights"),i(t.outputColorSpace,"outputColorSpace"),i(t.toneMappingExposure,"toneMappingExposure");const s=o(t.clearColor,"clearColor");s&&a.value.setClearColor(s?kr(s):new y(0))})),nn((()=>{a.value.dispose(),a.value.forceContextLoss()})),{renderer:a}}async function so(e,t,n,r,o){const{logError:i}=Lr(),s=new e;return n&&n(s),await new Promise(((e,n)=>{s.load(t,(t=>{const n=t;n.scene&&Object.assign(n,function(e){const t={nodes:{},materials:{}};return e&&e.traverse((e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}(n.scene)),e(n)}),r,(e=>{i("[useLoader] - Failed to load resource",e),n(e)}))}))}async function ao(e,t){const n=new h(t),r=e=>new Promise(((t,r)=>{n.load(e,(e=>t(e)),(()=>null),(()=>{r(new Error("[useTextures] - Failed to load texture"))}))}));if(Gr(e)){const t=await Promise.all(e.map((e=>r(e))));return e.length>1?t:t[0]}{const{map:t,displacementMap:n,normalMap:o,roughnessMap:i,metalnessMap:s,aoMap:a,alphaMap:l,matcap:c}=e;return{map:t?await r(t):null,displacementMap:n?await r(n):null,normalMap:o?await r(o):null,roughnessMap:i?await r(i):null,metalnessMap:s?await r(s):null,aoMap:a?await r(a):null,alphaMap:l?await r(l):null,matcap:c?await r(c):null}}}const lo=(e,t)=>{const n=Kt((()=>t.renderer.value.domElement)),r=tn([]),{x:o,y:i}=lr({target:n});let s=0;const{width:c,height:u,top:h,left:d}=or(n),p=s=>{var a,l;const p=(({x:e,y:t})=>{if(n.value)return{x:(e-d.value)/c.value*2-1,y:-(t-h.value)/u.value*2+1}})({x:null!=(a=null==s?void 0:s.clientX)?a:o.value,y:null!=(l=null==s?void 0:s.clientY)?l:i.value});return p&&(({x:n,y:o})=>{if(t.camera.value)return t.raycaster.value.setFromCamera(new N(n,o),t.camera.value),r.value=t.raycaster.value.intersectObjects(e.value,!0),r.value})(p)||[]},m=Hn(),f=Hn(),g=Hn(),v=Hn(),y=Hn(),b=Hn(),_=Hn(),w=Hn();const x=(e,n)=>{var o,i,c;const u=function(e){const t={};for(const n in e)"function"!=typeof n&&(t[n]=e[n]);return t}(n),h=new z(null==n?void 0:n.clientX,null==n?void 0:n.clientY,0).unproject(null==(o=t.camera)?void 0:o.value);e.trigger(l(a({},u),{intersections:r.value,unprojectedPoint:h,ray:null==(i=t.raycaster)?void 0:i.value.ray,camera:null==(c=t.camera)?void 0:c.value,sourceEvent:n,delta:s,stopPropagating:!1}))};let T;const E=e=>{p(e),x(g,e),T=e};let M,A,S;const O=e=>{var t,n,a;M=null==(a=r.value[0])?void 0:a.object,s=0,A=new N(null!=(t=null==e?void 0:e.clientX)?t:o.value,null!=(n=null==e?void 0:e.clientY)?n:i.value),x(y,e)};let C,I=!1;const P=e=>{var t,n,a,l,c;e instanceof PointerEvent&&(0===r.value.length&&x(b,e),M===(null==(a=r.value[0])?void 0:a.object)&&(S=new N(null!=(t=null==e?void 0:e.clientX)?t:o.value,null!=(n=null==e?void 0:e.clientY)?n:i.value),s=null==A?void 0:A.distanceTo(S),0===e.button?(x(m,e),C===(null==(l=r.value[0])?void 0:l.object)?I=!0:(C=null==(c=r.value[0])?void 0:c.object,I=!1)):2===e.button&&x(_,e)),x(v,e))},R=e=>{I&&(x(f,e),C=void 0,I=!1)},L=e=>x(g,e),k=e=>x(w,e);return n.value.addEventListener("pointerup",P),n.value.addEventListener("pointerdown",O),n.value.addEventListener("pointermove",E),n.value.addEventListener("pointerleave",L),n.value.addEventListener("dblclick",R),n.value.addEventListener("wheel",k),nn((()=>{null!=n&&n.value&&(n.value.removeEventListener("pointerup",P),n.value.removeEventListener("pointerdown",O),n.value.removeEventListener("pointermove",E),n.value.removeEventListener("pointerleave",L),n.value.removeEventListener("dblclick",R),n.value.removeEventListener("wheel",k))})),{intersects:r,onClick:e=>m.on(e).off,onDblClick:e=>f.on(e).off,onContextMenu:e=>_.on(e).off,onPointerMove:e=>g.on(e).off,onPointerUp:e=>v.on(e).off,onPointerDown:e=>y.on(e).off,onPointerMissed:e=>b.on(e).off,onWheel:e=>w.on(e).off,forceUpdate:()=>{T&&E(T)}}};function co(){const{logWarning:e}=Lr();function t(t,n,r){let o=null;return t.traverse((e=>{e[n]===r&&(o=e)})),o||e("Child with ".concat(n," '").concat(r,"' not found.")),o}function n(t,n,r){const o=[];return t.traverse((e=>{e[n].includes(r)&&o.push(e)})),o.length||e("Children with ".concat(n," '").concat(r,"' not found.")),o}return{seek:t,seekByName:function(e,n){return t(e,"name",n)},seekAll:n,seekAllByName:function(e,t){return n(e,"name",t)}}}function uo(e){let t=0;return e.traverse((e=>{if(e.isMesh&&e.geometry&&"HightlightMesh"!==e.type){const n=e.geometry,r=3*n.attributes.position.count*Float32Array.BYTES_PER_ELEMENT,o=n.index?n.index.count*Uint32Array.BYTES_PER_ELEMENT:0,i=n.attributes.normal?3*n.attributes.normal.count*Float32Array.BYTES_PER_ELEMENT:0,s=n.attributes.uv?2*n.attributes.uv.count*Float32Array.BYTES_PER_ELEMENT:0;t+=r+o+i+s}})),t}function ho(e){return(e/1024).toFixed(2)}const po=jt({}),mo=e=>Object.assign(po.value,e);function fo(e,t,n=10){const r=Vn(e)?cr():function(e,t={width:0,height:0},n={}){const{window:r=Jn,box:o="content-box"}=n,i=Kt((()=>{var t,n;return null==(n=null==(t=$n(e))?void 0:t.namespaceURI)?void 0:n.includes("svg")})),s=jt(t.width),a=jt(t.height),{stop:l}=rr(e,(([t])=>{const n="border-box"===o?t.borderBoxSize:"content-box"===o?t.contentBoxSize:t.devicePixelContentBoxSize;if(r&&i.value){const t=$n(e);if(t){const e=t.getBoundingClientRect();s.value=e.width,a.value=e.height}}else if(n){const e=Array.isArray(n)?n:[n];s.value=e.reduce(((e,{inlineSize:t})=>e+t),0),a.value=e.reduce(((e,{blockSize:t})=>e+t),0)}else s.value=t.contentRect.width,a.value=t.contentRect.height}),n);Qn((()=>{const n=$n(e);n&&(s.value="offsetWidth"in n?n.offsetWidth:t.width,a.value="offsetHeight"in n?n.offsetHeight:t.height)}));const c=Bt((()=>$n(e)),(e=>{s.value=e?t.width:0,a.value=e?t.height:0}));return{width:s,height:a,stop:function(){l(),c()}}}(Kt((()=>Vn(t).parentElement))),o=Zt(qn(r.width,n)),i=Zt(qn(r.height,n)),s=Kt((()=>o.value/i.value));return{height:i,width:o,aspectRatio:s}}function go(){const e=new Map,t=new Set;let n=0,r=!1;const o=n=>{e.delete(n),t.delete(n)};return{on:(t,i=0)=>{e.set(t,{priority:i,addI:n++});const s=()=>o(t);return Bn(s),r=!0,{off:s}},off:o,trigger:(...n)=>{r&&((()=>{const n=Array.from(e.entries()).sort(((e,t)=>{const n=e[1].priority-t[1].priority;return 0===n?e[1].addI-t[1].addI:n}));t.clear(),n.forEach((e=>t.add(e[0])))})(),r=!1),t.forEach((e=>e(...n)))},dispose:()=>{e.clear(),t.clear()},get count(){return e.size}}}function vo(){let e=!0,t=!0,n=!1;const r=new u(!1),o=jt(r.running),i=jt(!1);let s;const l=b.generateUUID();let c=null;const h=go(),d=go(),p=go();g();let m={};function f(){if(!e)return void(s=requestAnimationFrame(f));const t=r.getDelta(),n=r.getElapsedTime(),l={camera:zt(m.camera),scene:zt(m.scene),renderer:zt(m.renderer),raycaster:zt(m.raycaster),controls:zt(m.controls),invalidate:m.invalidate,advance:m.advance},u=a({delta:t,elapsed:n,clock:r},l);o.value&&h.trigger(u),i.value||(d.count?d.trigger(u):c&&c(u)),o.value&&p.trigger(u),s=requestAnimationFrame(f)}function g(){const e=!t&&!n;r.running!==e&&(r.running?r.stop():r.start()),o.value=r.running}return{loopId:l,register:(e,t,n)=>function(e,t,n=0){switch(t){case"before":return h.on(e,n);case"render":return c||(c=e),d.dispose(),d.on(e);case"after":return p.on(e,n)}}(e,t,n),start:function(){t&&(t=!1,g(),f())},stop:function(){t=!0,g(),cancelAnimationFrame(s)},pause:function(){n=!0,g()},resume:function(){n=!1,g()},pauseRender:function(){i.value=!0},resumeRender:function(){i.value=!1},isRenderPaused:i,isActive:o,setContext:function(e){m=e},setReady:t=>e=t}}const yo=new WeakMap;function bo(e){if(e=e||wo(),yo.has(e))return yo.get(e);const t=Date.now(),n=function(e,t,n=100){n=n<=0?100:n;const r=Hn(),o=new Set;let i=!1,s=!1,a=null;return function l(){a&&clearTimeout(a),s||i||!e()?!s&&!i&&(a=setTimeout(l,n)):(r.trigger(t),o.forEach((e=>e())),o.clear(),i=!0)}(),{on:e=>{if(i)return((e,...t)=>{e(...t)})(e,t),{off:()=>{}};{const t=r.on(e);return o.add(t.off),r.on(e)}},off:r.off,trigger:r.trigger,cancel:function(){s=!0,a&&clearTimeout(a)}}}((()=>{if(Date.now()-t>=100)return!0;{const t=e.renderer.value,n=(null==t?void 0:t.domElement)||{width:0,height:0};return!!(t&&n.width>0&&n.height>0)}}),e);return yo.set(e,n),n}function _o({scene:e,canvas:t,windowSize:n,disableRender:r,rendererOptions:o,emit:i}){const s=tn(e),l=fo(n,t),{camera:c,cameras:u,registerCamera:h,deregisterCamera:d,setCameraActive:m}=(({sizes:e})=>{const t=jt([]),n=Kt((()=>t.value[0])),r=e=>{const n=e instanceof P?e:t.value.find((t=>t.uuid===e));if(!n)return;const r=t.value.filter((({uuid:e})=>e!==n.uuid));t.value=[n,...r]};return qt((()=>{e.aspectRatio.value&&t.value.forEach((t=>{!t.manual&&(t instanceof f||function(e){return e.hasOwnProperty("isOrthographicCamera")&&e.isOrthographicCamera}(t))&&(t instanceof f?t.aspect=e.aspectRatio.value:(t.left=-.5*e.width.value,t.right=.5*e.width.value,t.top=.5*e.height.value,t.bottom=-.5*e.height.value),t.updateProjectionMatrix())}))})),nn((()=>{t.value=[]})),{camera:n,cameras:t,registerCamera:(e,n=!1)=>{if(br(e)){const o=e;if(t.value.some((({uuid:e})=>e===o.uuid)))return;n?r(o):t.value.push(o)}},deregisterCamera:e=>{if(br(e)){const n=e;t.value=t.value.filter((({uuid:e})=>e!==n.uuid))}},setCameraActive:r}})({sizes:l,scene:e}),g={mode:jt(o.renderMode||"always"),priority:jt(0),frames:jt(0),maxFrames:60,canBeInvalidated:Kt((()=>"on-demand"===g.mode.value&&0===g.frames.value))};function v(e=1){"on-demand"===o.renderMode&&(g.frames.value=Math.min(g.maxFrames,g.frames.value+e))}function y(){"manual"===o.renderMode&&(g.frames.value=1)}const{renderer:b}=io({scene:e,canvas:t,options:o,emit:i,contextParts:{sizes:l,camera:c,render:g,invalidate:v,advance:y},disableRender:r}),_={sizes:l,scene:s,camera:c,cameras:Zt(u),renderer:b,raycaster:tn(new p),controls:jt(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},render:g,advance:y,extend:mo,invalidate:v,registerCamera:h,setCameraActive:m,deregisterCamera:d,loop:vo()};ln("useTres",_),_.scene.value.__tres={root:_},_.loop.register((()=>{c.value&&g.frames.value>0&&(b.value.render(e,c.value),i("render",_.renderer.value)),g.priority.value=0,"always"===g.mode.value?g.frames.value=1:g.frames.value=Math.max(0,g.frames.value-1)}),"render");const{on:w,cancel:x}=bo(_);_.loop.setReady(!1),_.loop.start(),w((()=>{i("ready",_),_.loop.setReady(!0),function(e,t,n){var r;const o=tn(),i=tn();e&&(o.value=e),t&&(i.value=t);const s=e=>{var t;return(null==(t=e.children)?void 0:t.some((e=>s(e))))||(e=>{var t;return(null==(t=e.__tres)?void 0:t.eventCount)>0})(e)},l=tn((null==(r=o.value)?void 0:r.children).filter(s)||[]);function c(e,t){if(Array.isArray(e))for(const n of e)n(t);"function"==typeof e&&e(t)}function u(e,t){const r=[];t.stopPropagation=()=>t.stopPropagating=!0;for(const o of null==t?void 0:t.intersections){if(t.stopPropagating)return;t=a(a({},t),o);const{object:i}=o;t.eventObject=i,c(i[e],t),r.push(i);let s=i.parent;for(;null!==s&&!t.stopPropagating&&!r.includes(s);)t.eventObject=s,c(s[e],t),r.push(s),s=s.parent;const l=Br(e.slice(2));n(l,{intersection:o,event:t})}}const{onClick:h,onDblClick:d,onContextMenu:p,onPointerMove:m,onPointerDown:f,onPointerUp:g,onPointerMissed:v,onWheel:y,forceUpdate:b}=lo(l,t);g((e=>u("onPointerUp",e))),f((e=>u("onPointerDown",e))),h((e=>u("onClick",e))),d((e=>u("onDoubleClick",e))),p((e=>u("onContextMenu",e))),y((e=>u("onWheel",e)));let _=[];m((e=>{const t=e.intersections.map((({object:e})=>e)),n=e.intersections;_.forEach((({object:n})=>{t.includes(n)||(e.intersections=_,u("onPointerLeave",e),u("onPointerOut",e))})),e.intersections=n,e.intersections.forEach((({object:t})=>{_.includes(t)||(u("onPointerEnter",e),u("onPointerOver",e))})),u("onPointerMove",e),_=e.intersections}));const w=[];function x(e){_r(e)&&yr(e)&&l.value.push(e)}function T(e){if(_r(e)&&yr(e)){const t=l.value.indexOf(e);t>-1&&l.value.splice(t,1)}}function E(e){_r(e)&&yr(e)&&e.onPointerMissed&&w.push(e)}function M(e){if(_r(e)&&yr(e)){const t=w.indexOf(e);t>-1&&w.splice(t,1)}}v((e=>{e.stopPropagation=()=>e.stopPropagating=!0,w.forEach((t=>{e.stopPropagating||(e.eventObject=t,c(t.onPointerMissed,e))})),n("pointer-missed",{event:e})})),t.eventManager={forceUpdate:b,registerObject:x,deregisterObject:T,registerPointerMissedObject:E,deregisterPointerMissedObject:M}}(e,_,i)})),nn((()=>{x(),_.loop.stop()}));const T=function(e){var t;const n=jt(0);if("undefined"==typeof performance)return n;const r=null!=(t=null==e?void 0:e.every)?t:10;let o=performance.now(),i=0;return nr((()=>{if(i+=1,i>=r){const e=performance.now(),t=e-o;n.value=Math.round(1e3/(t/i)),o=e,i=0}})),n}({every:100}),{isSupported:E,memory:M}=ir({interval:100});let A=performance.now();let S=0;const{pause:O}=nr((({delta:e})=>{window.__TRES__DEVTOOLS__&&((({timestamp:e})=>{_.scene.value&&(_.perf.memory.allocatedMem=uo(_.scene.value)),e-A>=100&&(A=e,_.perf.fps.accumulator.push(T.value),_.perf.fps.accumulator.length>160&&_.perf.fps.accumulator.shift(),_.perf.fps.value=T.value,E.value&&M.value&&(_.perf.memory.accumulator.push(M.value.usedJSHeapSize/1024/1024),_.perf.memory.accumulator.length>160&&_.perf.memory.accumulator.shift(),_.perf.memory.currentMem=_.perf.memory.accumulator.reduce(((e,t)=>e+t),0)/_.perf.memory.accumulator.length))})({timestamp:performance.now()}),S+=e,S>=1&&(window.__TRES__DEVTOOLS__.cb(_),S=0))}),{immediate:!0});return nn((()=>{O()})),_}function wo(){const e=Qt("useTres");if(!e)throw new Error("useTresContext must be used together with useTresContextProvider");return e}function xo(){const{camera:e,scene:t,renderer:n,loop:r,raycaster:o,controls:i,invalidate:s,advance:a}=wo();return r.setContext({camera:e,scene:t,renderer:n,raycaster:o,controls:i,invalidate:s,advance:a}),{pause:r.pause,resume:r.resume,pauseRender:r.pauseRender,resumeRender:r.resumeRender,isActive:r.isActive,onBeforeRender:function(e,t=0){return r.register(e,"before",t)},render:function(e){return r.register(e,"render")},onAfterRender:function(e,t=0){return r.register(e,"after",t)}}}const{logError:To}=Lr(),Eo=["onClick","onContextMenu","onPointerMove","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onDoubleClick","onPointerDown","onPointerUp","onPointerCancel","onPointerMissed","onLostPointerCapture","onWheel"],Mo=e=>{const t=e.scene.value;function n(n,r){var o,i,s;if(!n)return;r=r||t;const a=n.__tres?n:$r(n,{},e),l=r.__tres?r:$r(r,{},e);n=eo(a),r=eo(l),n.__tres&&(null==(o=n.__tres)?void 0:o.eventCount)>0&&(null==(i=e.eventManager)||i.registerObject(n)),e.registerCamera(n),null==(s=e.eventManager)||s.registerPointerMissedObject(n),a.__tres.attach?function(e,t,n){if(fr(n)){if(Qr.test(n)){const t=n.replace(Qr,""),{target:r,key:o}=Kr(e,t);if(!Array.isArray(r[o])){const e=r[o],t=[];t.__tresDetach=()=>{t.every((e=>pr(e)))&&(r[o]=e)},r[o]=t}}const{target:r,key:o}=Kr(e,n);t.__tres.previousAttach=r[o],r[o]=eo(t)}else t.__tres.previousAttach=n(e,t)}(l,a,a.__tres.attach):yr(n)&&yr(l)&&(l.add(n),n.dispatchEvent({type:"added"})),a.__tres.parent=l,l.__tres.objects&&!l.__tres.objects.includes(a)&&l.__tres.objects.push(a)}function r(t,n){var o,i,s,a;if(!t)return;null!=t&&t.__tres&&(null==(o=t.__tres)?void 0:o.eventCount)>0&&(null==(i=e.eventManager)||i.deregisterObject(t)),n=pr(n)?"default":n;const l=null==(s=t.__tres)?void 0:s.dispose;pr(l)||(n=null!==l&&l);const c=null==(a=t.__tres)?void 0:a.primitive,u="default"===n?!c:!!n;if(t.__tres&&"objects"in t.__tres&&[...t.__tres.objects].forEach((e=>r(e,n))),u&&t.children&&[...t.children].forEach((e=>r(e,n))),to(t,e),no(t,e),u&&!function(e){return vr(e)&&"isScene"in e&&!!e.isScene}(t))if(gr(n))n(t);else if(gr(t.dispose))try{t.dispose()}catch(h){}"__tres"in t&&delete t.__tres}function o(t,o,i,s){var a,l;if(!t)return;let c=t,u=o;if(t.__tres&&(t.__tres.memoizedProps[o]=s),"attach"===o){const o=(null==(a=t.__tres)?void 0:a.parent)||t.parent;return r(t),$r(t,{attach:s},e),void(o&&n(t,o))}if("dispose"===o)return t.__tres||(t=$r(t,{},e)),void(t.__tres.dispose=s);if(yr(t)&&"blocks-pointer-events"===u)return void(s||""===s?t[u]=s:delete t[u]);Eo.includes(o)&&t.__tres&&(t.__tres.eventCount+=1);let h=zr(u),d=null==c?void 0:c[h];if("args"===u){const e=t,n=null!=i?i:[],r=null!=s?s:[],o=(null==(l=t.__tres)?void 0:l.type)||t.type;return void(o&&n.length&&!function(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Xr(e[n],t[n]))return!1;return!0}(n,r)&&(c=Object.assign(e,new po.value[o](...s))))}if("BufferGeometry"===c.type){if("args"===u)return;return void c.setAttribute(zr(u),new U(...s))}if(u.includes("-")&&void 0===d){const e=u.split("-");d=e.reduce(((e,t)=>e[zr(t)]),c),u=e.pop(),h=u,null!=d&&d.set||(c=e.reduce(((e,t)=>e[zr(t)]),c))}let p=s;if(""===p&&(p=!0),gr(d))return Eo.includes(o)||(mr(p)?t[h](...p):t[h](p)),void(h.startsWith("on")&&gr(p)&&(c[h]=p));null!=d&&d.set||gr(d)?d.constructor===p.constructor&&null!=d&&d.copy?null==d||d.copy(p):mr(p)?d.set(...p):!d.isColor&&d.setScalar?d.setScalar(p):d.set(p):c[h]=p,Jr(t)}function i(e){var t;return(null==(t=null==e?void 0:e.__tres)?void 0:t.parent)||null}return{insert:n,remove:r,createElement:function(t,i,s,c){if(c||(c={}),c.args||(c.args=[]),"template"===t||Fr(t))return null;let u,h=t.replace("Tres","");if("primitive"===t){(!vr(c.object)||Ht(c.object))&&To("Tres primitives need an 'object' prop, whose value is an object or shallowRef<object>"),h=c.object.type;const t={};u=function(e,t={},n={}){let r=e;const o=e=>{r=e};let i=new Proxy({},{});return i=new Proxy({},{has:(e,n)=>n in t||n in r,get:(e,n,o)=>n in t?t[n](r):r[n],set:(e,t,s)=>(n[t]?n[t](s,r,i,o):r[t]=s,!0)}),i}(c.object,{object:e=>e,isPrimitive:()=>!0,__tres:()=>t},{object:(t,i,s,l)=>{!function(e,t,n,r,o){var i,s,l;const c=[...t.__tres.objects],u=eo(t);if(u===(e=eo(e)))return!0;const h=$r(e,null!=(i=t.__tres)?i:{},o),d=null!=(l=null!=(s=t.parent)?s:t.__tres.parent)?l:null,p=a({},t.__tres.memoizedProps);delete p.object;for(const a of c)to(a,o),no(a,o);u.__tres.objects=[],r.remove(t);for(const[a,m]of Object.entries(p))r.patchProp(h,a,h[a],m);n(e),r.insert(t,d);for(const a of c)r.insert(a,t)}(t,s,l,{patchProp:o,remove:r,insert:n},e)},__tres:e=>{Object.assign(t,e)}})}else{const e=po.value[h];e||To("".concat(h," is not defined on the THREE namespace. Use extend to add it to the catalog.")),u=new e(...c.args)}return u?(u.isCamera&&(null!=c&&c.position||u.position.set(3,3,3),null!=c&&c.lookAt||u.lookAt(0,0,0)),u=$r(u,l(a({},u.__tres),{type:h,memoizedProps:c,eventCount:0,primitive:"primitive"===t,attach:c.attach}),e),u):null},patchProp:o,parentNode:i,createText:()=>{},createComment:function(t){const n=$r(new F,{type:"Comment"},e);return n.name=t,n},setText:()=>{},setElementText:()=>{},nextSibling:function(e){var t;const n=i(e),r=(null==(t=null==n?void 0:n.__tres)?void 0:t.objects)||[],o=r.indexOf(e);return o<0||o>=r.length-1?null:r[o+1]},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}}};function Ao(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const So="function"==typeof Proxy,Oo="devtools-plugin:setup";let Co,Io;function Po(){return void 0!==Co||(typeof window<"u"&&window.performance?(Co=!0,Io=window.performance):typeof globalThis<"u"&&null!==(e=globalThis.perf_hooks)&&void 0!==e&&e.performance?(Co=!0,Io=globalThis.perf_hooks.performance):Co=!1),Co?Io.now():Date.now();var e}class Ro{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const s in e.settings){const t=e.settings[s];n[s]=t.defaultValue}const r="__vue-devtools-plugin-settings__".concat(e.id);let o=Object.assign({},n);try{const e=localStorage.getItem(r),t=JSON.parse(e);Object.assign(o,t)}catch(i){}this.fallbacks={getSettings:()=>o,setSettings(e){try{localStorage.setItem(r,JSON.stringify(e))}catch(i){}o=e},now:()=>Po()},t&&t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((n=>{this.targetQueue.push({method:t,args:e,resolve:n})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function Lo(e,t){const n=e,r=Ao(),o=Ao().__VUE_DEVTOOLS_GLOBAL_HOOK__,i=So&&n.enableEarlyProxy;if(!o||!r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&i){const e=i?new Ro(n,o):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:t,proxy:e}),e&&t(e.proxiedTarget)}else o.emit(Oo,e,t)}function ko(e,t){throw new Error(e+t)}const Do=e=>{const t={id:e.uuid,label:e.type,children:[],tags:[]};""!==e.name&&t.tags.push({label:e.name,textColor:5750629,backgroundColor:15793395});const n=uo(e);return n>0&&t.tags.push({label:"".concat(ho(n)," KB"),textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),e.type.includes("Light")&&(function(e){return vr(e)&&"isLight"in e&&!!e.isLight}(e)&&t.tags.push({label:"".concat(e.intensity),textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),t.tags.push({label:"#".concat(new y(e.color).getHexString()),textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),e.type.includes("Camera")&&(t.tags.push({label:"".concat(e.fov,"Â°"),textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),t.tags.push({label:"x: ".concat(Math.round(e.position.x)," y: ").concat(Math.round(e.position.y)," z: ").concat(Math.round(e.position.z)),textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),t};function Uo(e,t,n=""){e.children.forEach((e=>{if("HightlightMesh"===e.type||n&&!e.type.includes(n)&&!e.name.includes(n))return;const r=Do(e);t.children.push(r),Uo(e,r,n)}))}const Fo=[],No="tres:inspector",zo=$t({sceneGraph:null});function jo(e,t){Lo({id:"dev.esm.tres",label:"TresJS ðŸª",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:Fo,app:e},(e=>{"function"!=typeof e.now&&function(e,t){const n="â–² â–  â—".concat(e);ko(n,t)}("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),e.addInspector({id:No,label:"TresJS ðŸª",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval((()=>{e.sendInspectorTree(No)}),1e3),setInterval((()=>{e.notifyComponentUpdate()}),5e3),e.on.getInspectorTree((e=>{if(e.inspectorId===No){const n=Do(t.scene.value);Uo(t.scene.value,n,e.filter),zo.sceneGraph=n,e.rootNodes=[n]}}));let n=null,r=null;e.on.getInspectorState((e=>{var o;if(e.inspectorId===No){const[i]=t.scene.value.getObjectsByProperty("uuid",e.nodeId);if(!i)return;if(r&&n&&n.parent&&r.remove(n),i.isMesh){const e=function(e){const t=new M({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:j});return new Dr(e.geometry.clone(),t)}(i);i.add(e),n=e,r=i}e.state={object:Object.entries(i).map((([e,t])=>"children"===e?{key:e,value:t.filter((e=>"HightlightMesh"!==e.type))}:{key:e,value:t,editable:!0})).filter((({key:e})=>"parent"!==e))},i.isScene&&(e.state.info={memory:uo(i),objects:i.children.length,calls:t.renderer.value.info.render.calls,triangles:t.renderer.value.info.render.triangles,points:t.renderer.value.info.render.points,lines:t.renderer.value.info.render.lines},e.state.programs=(null==(o=t.renderer.value.info.programs)?void 0:o.map((e=>({key:e.name,value:l(a({},e),{vertexShader:e.vertexShader,attributes:e.getAttributes(),uniforms:e.getUniforms()})}))))||[])}})),e.on.editInspectorState((e=>{e.inspectorId===No&&function(e,t,n,r){const o=e=>{if(e.uuid===t)return e;for(const t of e.children){const e=o(t);if(e)return e}},i=o(e);if(!i)return void console.warn("Object with UUID not found in the scene.");let s=i;for(let l=0;l<n.length-1;l++){if(void 0===s[n[l]])return void console.warn("Property path is not valid: ".concat(n.join(".")));s=s[n[l]]}const a=n[n.length-1];void 0!==s[a]?s[a]=r:console.warn("Property path is not valid: ".concat(n.join(".")))}(t.scene.value,e.nodeId,e.path,e.state.value)}))}))}const Bo=["data-scene","data-tres"],Ho=Jt({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},dpr:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},emits:["render","click","double-click","context-menu","pointer-move","pointer-up","pointer-down","pointer-enter","pointer-leave","pointer-over","pointer-out","pointer-missed","wheel","ready"],setup(e,{expose:t,emit:n}){var r;const o=e,i=n,s=en(),{logWarning:l}=Lr(),c=jt(),u=tn(new d),h=null==(r=Wt())?void 0:r.appContext.app;mo(m);const p=(e,t=!1)=>{const n=((e,t=!1)=>Jt({setup(){var n;const r=null==(n=Wt())?void 0:n.appContext;return r&&(r.app=h),ln("useTres",e),ln("extend",mo),typeof window<"u"&&jo(null==r?void 0:r.app,e),()=>un(hn,null,t?[]:s.default())}}))(e,t),{render:r}=cn(Mo(e));r(un(n),u.value)},g=(e,t=!1)=>{Zr(e.scene.value),t&&(e.renderer.value.dispose(),e.renderer.value.renderLists.dispose(),e.renderer.value.forceContextLoss()),u.value.__tres={root:e}},v=Kt((()=>o.disableRender)),y=tn(null);t({context:y,dispose:()=>g(y.value,!0)});return Vt((()=>{var e,t;const n=c;y.value=_o({scene:u.value,canvas:n,windowSize:null!=(e=o.windowSize)&&e,disableRender:null!=(t=v.value)&&t,rendererOptions:o,emit:i});const{registerCamera:r,camera:s,cameras:a,deregisterCamera:h}=y.value;p(y.value);Bt((()=>o.camera),((e,t)=>{e&&r(e),t&&(t.removeFromParent(),h(t))}),{immediate:!0}),s.value||(l("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),(()=>{const e=new f(45,window.innerWidth/window.innerHeight,.1,1e3);e.position.set(3,3,3),e.lookAt(0,0,0),r(e);const t=qt((()=>{a.value.length>=2&&(e.removeFromParent(),h(e),null==t||t())}))})())})),nn((()=>{g(y.value),p(y.value,!0)})),(e,t)=>(rn(),on("canvas",{ref_key:"canvas",ref:c,"data-scene":u.value.uuid,class:sn(e.$attrs.class),"data-tres":"tresjs ".concat(zt(dr).version),style:an(a({display:"block",width:"100%",height:"100%",position:e.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none"},e.$attrs.style))},null,14,Bo))}});class Vo extends _{constructor(e,t){const n=new w;n.setAttribute("position",new x([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();super(n,new T({fog:!1})),this.light=e,this.color=t,this.type="RectAreaLightHelper";const r=new w;r.setAttribute("position",new x([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new E(r,new M({side:A,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const{logWarning:Yo}=Lr();let Xo,Go;const Wo={DirectionalLight:S,PointLight:O,SpotLight:C,HemisphereLight:I,RectAreaLight:Vo},Zo={mounted:e=>{e.isLight?(Xo=Wo[e.type],e.parent.add(new Xo(e,1,e.color.getHex()))):Yo("".concat(e.type," is not a light"))},updated:e=>{Go=e.parent.children.find((e=>e instanceof Xo)),!(Go instanceof Vo)&&Go.update()},unmounted:e=>{e.isLight?(Go=e.parent.children.find((e=>e instanceof Xo)),Go&&Go.dispose&&Go.dispose(),e.parent.remove(Go)):Yo("".concat(e.type," is not a light"))}},Ko={install(e){e.component("TresCanvas",Ho)}};var qo=Object.defineProperty,Qo=(e,t,n)=>((e,t,n)=>t in e?qo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const $o=parseInt(R.replace(/\D+/g,"")),Jo=$o>=125?"uv1":"uv2";var ei=Object.defineProperty;async function ti(e){const t=await e.arrayBuffer(),n=btoa(String.fromCharCode(...new Uint8Array(t)));return"data:".concat(e.type||"",";base64,").concat(n)}let ni,ri,oi,ii;function si(e,t=1/0,n=null){ri||(ri=new ue(2,2,1,1)),oi||(oi=new B({uniforms:{blitTexture:new Rt(e)},vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = vec4(position.xy * 1.0,0.,.999999);\n        }\n      ",fragmentShader:"\n          uniform sampler2D blitTexture; \n          varying vec2 vUv;\n\n          void main(){ \n              gl_FragColor = vec4(vUv.xy, 0, 1);\n              \n              #ifdef IS_SRGB\n              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n              #else\n              gl_FragColor = texture2D( blitTexture, vUv);\n              #endif\n          }\n      "})),oi.uniforms.blitTexture.value=e,oi.defines.IS_SRGB="colorSpace"in e?"srgb"===e.colorSpace:3001===e.encoding,oi.needsUpdate=!0,ii||(ii=new E(ri,oi),ii.frustrumCulled=!1);const r=new f,o=new d;o.add(ii),n||(n=ni=new g({antialias:!1})),n.setSize(Math.min(e.image.width,t),Math.min(e.image.height,t)),n.clear(),n.render(o,r);const i=new Be(n.domElement);return i.minFilter=e.minFilter,i.magFilter=e.magFilter,i.wrapS=e.wrapS,i.wrapT=e.wrapT,i.name=e.name,ni&&(ni.dispose(),ni=null),i}const ai={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class li{constructor(){this.pluginCallbacks=[],this.register((function(e){return new Vi(e)})),this.register((function(e){return new Yi(e)})),this.register((function(e){return new Wi(e)})),this.register((function(e){return new Zi(e)})),this.register((function(e){return new Ki(e)})),this.register((function(e){return new qi(e)})),this.register((function(e){return new Xi(e)})),this.register((function(e){return new Gi(e)})),this.register((function(e){return new Qi(e)})),this.register((function(e){return new $i(e)})),this.register((function(e){return new Ji(e)}))}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){const o=new Hi,i=[];for(let s=0,a=this.pluginCallbacks.length;s<a;s++)i.push(this.pluginCallbacks[s](o));o.setPlugins(i),o.write(e,t,r).catch(n)}parseAsync(e,t){const n=this;return new Promise((function(r,o){n.parse(e,r,o,t)}))}}var ci;ci={insertKeyframe:function(e,t){const n=e.getValueSize(),r=new e.TimeBufferType(e.times.length+1),o=new e.ValueBufferType(e.values.length+n),i=e.createInterpolant(new e.ValueBufferType(n));let s;if(0===e.times.length){r[0]=t;for(let e=0;e<n;e++)o[e]=0;s=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;r[0]=t,r.set(e.times,1),o.set(i.evaluate(t),0),o.set(e.values,n),s=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;r[r.length-1]=t,r.set(e.times,0),o.set(e.values,0),o.set(i.evaluate(t),e.values.length),s=r.length-1}else for(let a=0;a<e.times.length;a++){if(Math.abs(e.times[a]-t)<.001)return a;if(e.times[a]<t&&e.times[a+1]>t){r.set(e.times.slice(0,a+1),0),r[a+1]=t,r.set(e.times.slice(a+1),a+2),o.set(e.values.slice(0,(a+1)*n),0),o.set(i.evaluate(t),(a+1)*n),o.set(e.values.slice((a+1)*n),(a+2)*n),s=a+1;break}}return e.times=r,e.values=o,s},mergeMorphTargetTracks:function(e,t){const n=[],r={},o=e.tracks;for(let i=0;i<o.length;++i){let e=o[i];const s=he.parseTrackName(e.name),a=he.findNode(t,s.nodeName);if("morphTargetInfluences"!==s.propertyName||void 0===s.propertyIndex){n.push(e);continue}if(e.createInterpolant!==e.InterpolantFactoryMethodDiscrete&&e.createInterpolant!==e.InterpolantFactoryMethodLinear){if(e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),e=e.clone(),e.setInterpolation(de)}const l=a.morphTargetInfluences.length,c=a.morphTargetDictionary[s.propertyIndex];if(void 0===c)throw new Error("THREE.GLTFExporter: Morph target name not found: "+s.propertyIndex);let u;if(void 0===r[a.uuid]){u=e.clone();const t=new u.ValueBufferType(l*u.times.length);for(let e=0;e<u.times.length;e++)t[e*l+c]=u.values[e];u.name=(s.nodeName||"")+".morphTargetInfluences",u.values=t,r[a.uuid]=u,n.push(u);continue}const h=e.createInterpolant(new e.ValueBufferType(1));u=r[a.uuid];for(let t=0;t<u.times.length;t++)u.values[t*l+c]=h.evaluate(u.times[t]);for(let t=0;t<e.times.length;t++){const n=this.insertKeyframe(u,e.times[t]);u.values[n*l+c]=e.values[t]}}return e.tracks=n,e}},((e,t,n)=>{t in e?ei(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(li,"Utils"+"",ci);const ui=0,hi=1,di=2,pi=3,mi=4,fi=5120,gi=5121,vi=5122,yi=5123,bi=5124,_i=5125,wi=5126,xi=34962,Ti=34963,Ei=9728,Mi=9729,Ai=9984,Si=9985,Oi=9986,Ci=9987,Ii=33071,Pi=33648,Ri=10497,Li="KHR_mesh_quantization",ki={};ki[At]=Ei,ki[St]=Ai,ki[Ct]=Oi,ki[ut]=Mi,ki[Ot]=Si,ki[ht]=Ci,ki[je]=Ii,ki[ze]=Ri,ki[It]=Pi;const Di={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Ui=new y;function Fi(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}function Ni(e){return 4*Math.ceil(e/4)}function zi(e,t=0){const n=Ni(e.byteLength);if(n!==e.byteLength){const r=new Uint8Array(n);if(r.set(new Uint8Array(e)),0!==t)for(let o=e.byteLength;o<n;o++)r[o]=t;return r.buffer}return e}function ji(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Bi(e,t){if(void 0!==e.toBlob)return new Promise((n=>e.toBlob(n,t)));let n;return"image/jpeg"===t?n=.92:"image/webp"===t&&(n=.8),e.convertToBlob({type:t,quality:n})}class Hi{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,n={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const r=this,o=r.buffers,i=r.json;n=r.options;const s=r.extensionsUsed,a=r.extensionsRequired,l=new Blob(o,{type:"application/octet-stream"}),c=Object.keys(s),u=Object.keys(a);c.length>0&&(i.extensionsUsed=c),u.length>0&&(i.extensionsRequired=u),i.buffers&&i.buffers.length>0&&(i.buffers[0].byteLength=l.size),!0===n.binary?l.arrayBuffer().then((e=>{const n=zi(e),r=new DataView(new ArrayBuffer(8));r.setUint32(0,n.byteLength,!0),r.setUint32(4,5130562,!0);const o=zi(function(e){return(new TextEncoder).encode(e).buffer}(JSON.stringify(i)),32),s=new DataView(new ArrayBuffer(8));s.setUint32(0,o.byteLength,!0),s.setUint32(4,1313821514,!0);const a=new ArrayBuffer(12),l=new DataView(a);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);const c=12+s.byteLength+o.byteLength+r.byteLength+n.byteLength;l.setUint32(8,c,!0),new Blob([a,s,o,r,n],{type:"application/octet-stream"}).arrayBuffer().then(t)})):i.buffers&&i.buffers.length>0?ti(l).then((e=>{i.buffers[0].uri=e,t(i)})):t(i)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const n=this.options,r=this.extensionsUsed;try{const o=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&o.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in o.gltfExtensions)t.extensions[e]=o.gltfExtensions[e],r[e]=!0;delete o.gltfExtensions}Object.keys(o).length>0&&(t.extras=o)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new z;for(let n=0,r=e.count;n<r;n++)if(Math.abs(t.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const n=e.clone(),r=new z;for(let o=0,i=n.count;o<i;o++)r.fromBufferAttribute(n,o),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),n.setXYZ(o,r.x,r.y,r.z);return t.attributesNormalized.set(e,n),n}applyTextureTransform(e,t){let n=!1;const r={};(0!==t.offset.x||0!==t.offset.y)&&(r.offset=t.offset.toArray(),n=!0),0!==t.rotation&&(r.rotation=t.rotation,n=!0),(1!==t.repeat.x||1!==t.repeat.y)&&(r.scale=t.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function n(e){return("colorSpace"in e?"srgb"===e.colorSpace:3001===e.encoding)?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof yt&&(e=si(e)),t instanceof yt&&(t=si(t));const r=e?e.image:null,o=t?t.image:null,i=Math.max(r?r.width:0,o?o.width:0),s=Math.max(r?r.height:0,o?o.height:0),a=ji();a.width=i,a.height=s;const l=a.getContext("2d");l.fillStyle="#00ffff",l.fillRect(0,0,i,s);const c=l.getImageData(0,0,i,s);if(r){l.drawImage(r,0,0,i,s);const t=n(e),o=l.getImageData(0,0,i,s).data;for(let e=2;e<o.length;e+=4)c.data[e]=256*t(o[e]/256)}if(o){l.drawImage(o,0,0,i,s);const e=n(t),r=l.getImageData(0,0,i,s).data;for(let t=1;t<r.length;t+=4)c.data[t]=256*e(r[t]/256)}l.putImageData(c,0,0);const u=(e||t).clone();return u.source=new Be(a).source,"colorSpace"in u?u.colorSpace="":u.encoding=3e3,u.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),u}processBuffer(e){const t=this.json,n=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),n.push(e),0}processBufferView(e,t,n,r,o){const i=this.json;let s;switch(i.bufferViews||(i.bufferViews=[]),t){case fi:case gi:s=1;break;case vi:case yi:s=2;break;default:s=4}const a=Ni(r*e.itemSize*s),l=new DataView(new ArrayBuffer(a));let c=0;for(let h=n;h<n+r;h++)for(let n=0;n<e.itemSize;n++){let r;e.itemSize>4?r=e.array[h*e.itemSize+n]:(0===n?r=e.getX(h):1===n?r=e.getY(h):2===n?r=e.getZ(h):3===n&&(r=e.getW(h)),!0===e.normalized&&(r=b.normalize(r,e.array))),t===wi?l.setFloat32(c,r,!0):t===bi?l.setInt32(c,r,!0):t===_i?l.setUint32(c,r,!0):t===vi?l.setInt16(c,r,!0):t===yi?l.setUint16(c,r,!0):t===fi?l.setInt8(c,r):t===gi&&l.setUint8(c,r),c+=s}const u={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:a};return void 0!==o&&(u.target=o),o===xi&&(u.byteStride=e.itemSize*s),this.byteOffset+=a,i.bufferViews.push(u),{id:i.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,n=t.json;return n.bufferViews||(n.bufferViews=[]),e.arrayBuffer().then((e=>{const r=zi(e),o={buffer:t.processBuffer(r),byteOffset:t.byteOffset,byteLength:r.byteLength};return t.byteOffset+=r.byteLength,n.bufferViews.push(o)-1}))}processAccessor(e,t,n,r){const o=this.json;let i;if(e.array.constructor===Float32Array)i=wi;else if(e.array.constructor===Int32Array)i=bi;else if(e.array.constructor===Uint32Array)i=_i;else if(e.array.constructor===Int16Array)i=vi;else if(e.array.constructor===Uint16Array)i=yi;else if(e.array.constructor===Int8Array)i=fi;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);i=gi}if(void 0===n&&(n=0),void 0===r&&(r=e.count),0===r)return null;const s=function(e,t,n){const r={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let o=t;o<t+n;o++)for(let t=0;t<e.itemSize;t++){let n;e.itemSize>4?n=e.array[o*e.itemSize+t]:(0===t?n=e.getX(o):1===t?n=e.getY(o):2===t?n=e.getZ(o):3===t&&(n=e.getW(o)),!0===e.normalized&&(n=b.normalize(n,e.array))),r.min[t]=Math.min(r.min[t],n),r.max[t]=Math.max(r.max[t],n)}return r}(e,n,r);let a;void 0!==t&&(a=e===t.index?Ti:xi);const l=this.processBufferView(e,i,n,r,a),c={bufferView:l.id,byteOffset:l.byteOffset,componentType:i,count:r,max:s.max,min:s.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(c.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(c)-1}processImage(e,t,n,r="image/png"){if(null!==e){const o=this,i=o.cache,s=o.json,a=o.options,l=o.pending;i.images.has(e)||i.images.set(e,{});const c=i.images.get(e),u=r+":flipY/"+n.toString();if(void 0!==c[u])return c[u];s.images||(s.images=[]);const h={mimeType:r},d=ji();d.width=Math.min(e.width,a.maxTextureSize),d.height=Math.min(e.height,a.maxTextureSize);const p=d.getContext("2d");if(!0===n&&(p.translate(0,d.height),p.scale(1,-1)),void 0!==e.data){t!==bt&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>a.maxTextureSize||e.height>a.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const n=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<n.length;t+=4)n[t+0]=e.data[t+0],n[t+1]=e.data[t+1],n[t+2]=e.data[t+2],n[t+3]=e.data[t+3];p.putImageData(new ImageData(n,e.width,e.height),0,0)}else p.drawImage(e,0,0,d.width,d.height);!0===a.binary?l.push(Bi(d,r).then((e=>o.processBufferViewImage(e))).then((e=>{h.bufferView=e}))):void 0!==d.toDataURL?h.uri=d.toDataURL(r):l.push(Bi(d,r).then(ti).then((e=>{h.uri=e})));const m=s.images.push(h)-1;return c[u]=m,m}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const n={magFilter:ki[e.magFilter],minFilter:ki[e.minFilter],wrapS:ki[e.wrapS],wrapT:ki[e.wrapT]};return t.samplers.push(n)-1}processTexture(e){const t=this.options,n=this.cache,r=this.json;if(n.textures.has(e))return n.textures.get(e);r.textures||(r.textures=[]),e instanceof yt&&(e=si(e,t.maxTextureSize));let o=e.userData.mimeType;"image/webp"===o&&(o="image/png");const i={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(i.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,i)}));const s=r.textures.push(i)-1;return n.textures.set(e,s),s}processMaterial(e){const t=this.cache,n=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);const r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(Fi(o,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=.5,r.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const t=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),n={index:this.processTexture(t),channel:t.channel};this.applyTextureTransform(n,t),r.pbrMetallicRoughness.metallicRoughnessTexture=n}if(e.map){const t={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),r.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive;if(Math.max(t.r,t.g,t.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),r.emissiveTexture=t}}if(e.normalMap){const t={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),r.normalTexture=t}if(e.aoMap){const t={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),r.occlusionTexture=t}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===j&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,r)}));const i=n.materials.push(r)-1;return t.materials.set(e,i),i}processMesh(e){const t=this.cache,n=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let a=0,l=e.material.length;a<l;a++)r.push(e.material[a].uuid);else r.push(e.material.uuid);const o=r.join(":");if(t.meshes.has(o))return t.meshes.get(o);const i=e.geometry;let s;s=e.isLineSegments?hi:e.isLineLoop?di:e.isLine?pi:e.isPoints?ui:e.material.wireframe?hi:mi;const c={},u={},h=[],d=[],p=l(a({},$o>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"}),{color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"}),m=i.getAttribute("normal");void 0!==m&&!this.isNormalizedNormalAttribute(m)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),i.setAttribute("normal",this.createNormalizedNormalAttribute(m)));let f=null;for(let a in i.attributes){if("morph"===a.slice(0,5))continue;const e=i.attributes[a];if(a=p[a]||a.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(a)||(a="_"+a),t.attributes.has(this.getUID(e))){u[a]=t.attributes.get(this.getUID(e));continue}f=null;const n=e.array;"JOINTS_0"===a&&!(n instanceof Uint16Array)&&!(n instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),f=new U(new Uint16Array(n),e.itemSize,e.normalized));const r=this.processAccessor(f||e,i);null!==r&&(a.startsWith("_")||this.detectMeshQuantization(a,e),u[a]=r,t.attributes.set(this.getUID(e),r))}if(void 0!==m&&i.setAttribute("normal",m),0===Object.keys(u).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const n=[],r=[],o={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)o[e.morphTargetDictionary[t]]=t;for(let s=0;s<e.morphTargetInfluences.length;++s){const a={};let l=!1;for(const e in i.morphAttributes){if("position"!==e&&"normal"!==e){l||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),l=!0);continue}const n=i.morphAttributes[e][s],r=e.toUpperCase(),o=i.attributes[e];if(t.attributes.has(this.getUID(n,!0))){a[r]=t.attributes.get(this.getUID(n,!0));continue}const c=n.clone();if(!i.morphTargetsRelative)for(let e=0,t=n.count;e<t;e++)for(let r=0;r<n.itemSize;r++)0===r&&c.setX(e,n.getX(e)-o.getX(e)),1===r&&c.setY(e,n.getY(e)-o.getY(e)),2===r&&c.setZ(e,n.getZ(e)-o.getZ(e)),3===r&&c.setW(e,n.getW(e)-o.getW(e));a[r]=this.processAccessor(c,i),t.attributes.set(this.getUID(o,!0),a[r])}d.push(a),n.push(e.morphTargetInfluences[s]),void 0!==e.morphTargetDictionary&&r.push(o[s])}c.weights=n,r.length>0&&(c.extras={},c.extras.targetNames=r)}const g=Array.isArray(e.material);if(g&&0===i.groups.length)return null;const v=g?e.material:[e.material],y=g?i.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let a=0,l=y.length;a<l;a++){const e={mode:s,attributes:u};if(this.serializeUserData(i,e),d.length>0&&(e.targets=d),null!==i.index){let n=this.getUID(i.index);(void 0!==y[a].start||void 0!==y[a].count)&&(n+=":"+y[a].start+":"+y[a].count),t.attributes.has(n)?e.indices=t.attributes.get(n):(e.indices=this.processAccessor(i.index,i,y[a].start,y[a].count),t.attributes.set(n,e.indices)),null===e.indices&&delete e.indices}const n=this.processMaterial(v[y[a].materialIndex]);null!==n&&(e.material=n),h.push(e)}c.primitives=h,n.meshes||(n.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,c)}));const b=n.meshes.push(c)-1;return t.meshes.set(o,b),b}detectMeshQuantization(e,t){if(this.extensionsUsed[Li])return;let n;switch(t.array.constructor){case Int8Array:n="byte";break;case Uint8Array:n="unsigned byte";break;case Int16Array:n="short";break;case Uint16Array:n="unsigned short";break;default:return}t.normalized&&(n+=" normalized");const r=e.split("_",1)[0];ai[r]&&ai[r].includes(n)&&(this.extensionsUsed[Li]=!0,this.extensionsRequired[Li]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const n=e.isOrthographicCamera,r={type:n?"orthographic":"perspective"};return n?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:b.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const n=this.json,r=this.nodeMap;n.animations||(n.animations=[]);const o=(e=li.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,i=[],s=[];for(let a=0;a<o.length;++a){const e=o[a],n=he.parseTrackName(e.name);let l=he.findNode(t,n.nodeName);const c=Di[n.propertyName];if("bones"===n.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(n.objectIndex):void 0),!l||!c)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',e.name),null;const u=1;let h,d=e.values.length/e.times.length;c===Di.morphTargetInfluences&&(d/=l.morphTargetInfluences.length),!0===e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(h="CUBICSPLINE",d/=3):h=e.getInterpolation()===_t?"STEP":"LINEAR",s.push({input:this.processAccessor(new U(e.times,u)),output:this.processAccessor(new U(e.values,d)),interpolation:h}),i.push({sampler:s.length-1,target:{node:r.get(l),path:c}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:s,channels:i}),n.animations.length-1}processSkin(e){const t=this.json,n=this.nodeMap,r=t.nodes[n.get(e)],o=e.skeleton;if(void 0===o)return null;const i=e.skeleton.bones[0];if(void 0===i)return null;const s=[],a=new Float32Array(16*o.bones.length),l=new q;for(let c=0;c<o.bones.length;++c)s.push(n.get(o.bones[c])),l.copy(o.boneInverses[c]),l.multiply(e.bindMatrix).toArray(a,16*c);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new U(a,16)),joints:s,skeleton:n.get(i)}),r.skin=t.skins.length-1}processNode(e){const t=this.json,n=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const o={};if(n.trs){const t=e.quaternion.toArray(),n=e.position.toArray(),r=e.scale.toArray();Fi(t,[0,0,0,1])||(o.rotation=t),Fi(n,[0,0,0])||(o.translation=n),Fi(r,[1,1,1])||(o.scale=r)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function(e){return Fi(e.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(o.matrix=e.matrix.elements);if(""!==e.name&&(o.name=String(e.name)),this.serializeUserData(e,o),e.isMesh||e.isLine||e.isPoints){const t=this.processMesh(e);null!==t&&(o.mesh=t)}else e.isCamera&&(o.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const t=[];for(let r=0,o=e.children.length;r<o;r++){const o=e.children[r];if(o.visible||!1===n.onlyVisible){const e=this.processNode(o);null!==e&&t.push(e)}}t.length>0&&(o.children=t)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,o)}));const i=t.nodes.push(o)-1;return r.set(e,i),i}processScene(e){const t=this.json,n=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);const o=[];for(let i=0,s=e.children.length;i<s;i++){const t=e.children[i];if(t.visible||!1===n.onlyVisible){const e=this.processNode(t);null!==e&&o.push(e)}}o.length>0&&(r.nodes=o),this.serializeUserData(e,r)}processObjects(e){const t=new d;t.name="AuxScene";for(let n=0;n<e.length;n++)t.children.push(e[n]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));const n=[];for(let r=0;r<e.length;r++)e[r]instanceof d?this.processScene(e[r]):n.push(e[r]);n.length>0&&this.processObjects(n);for(let r=0;r<this.skins.length;++r)this.processSkin(this.skins[r]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}_invokeAll(e){for(let t=0,n=this.plugins.length;t<n;t++)e(this.plugins[t])}}class Vi{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const n=this.writer,r=n.json,o=n.extensionsUsed,i={};e.name&&(i.name=e.name),i.color=e.color.toArray(),i.intensity=e.intensity,e.isDirectionalLight?i.type="directional":e.isPointLight?(i.type="point",e.distance>0&&(i.range=e.distance)):e.isSpotLight&&(i.type="spot",e.distance>0&&(i.range=e.distance),i.spot={},i.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,i.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||-1!==e.target.position.z)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),o[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},o[this.name]=!0);const s=r.extensions[this.name].lights;s.push(i),t.extensions=t.extensions||{},t.extensions[this.name]={light:s.length-1}}}let Yi=class{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const n=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}},Xi=class{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const n=this.writer,r=n.extensionsUsed,o={};if(o.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:n.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};n.applyTextureTransform(t,e.clearcoatMap),o.clearcoatTexture=t}if(o.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:n.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};n.applyTextureTransform(t,e.clearcoatRoughnessMap),o.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:n.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};n.applyTextureTransform(t,e.clearcoatNormalMap),o.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},Gi=class{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const n=this.writer,r=n.extensionsUsed,o={};if(o.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:n.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};n.applyTextureTransform(t,e.iridescenceMap),o.iridescenceTexture=t}if(o.iridescenceIor=e.iridescenceIOR,o.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],o.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:n.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};n.applyTextureTransform(t,e.iridescenceThicknessMap),o.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},Wi=class{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const n=this.writer,r=n.extensionsUsed,o={};if(o.transmissionFactor=e.transmission,e.transmissionMap){const t={index:n.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};n.applyTextureTransform(t,e.transmissionMap),o.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},Zi=class{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const n=this.writer,r=n.extensionsUsed,o={};if(o.thicknessFactor=e.thickness,e.thicknessMap){const t={index:n.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};n.applyTextureTransform(t,e.thicknessMap),o.thicknessTexture=t}o.attenuationDistance=e.attenuationDistance,o.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},Ki=class{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const n=this.writer.extensionsUsed,r={};r.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}},qi=class{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(Ui)&&!e.specularIntensityMap&&!e.specularColorTexture)return;const n=this.writer,r=n.extensionsUsed,o={};if(e.specularIntensityMap){const t={index:n.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};n.applyTextureTransform(t,e.specularIntensityMap),o.specularTexture=t}if(e.specularColorMap){const t={index:n.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};n.applyTextureTransform(t,e.specularColorMap),o.specularColorTexture=t}o.specularFactor=e.specularIntensity,o.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},Qi=class{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const n=this.writer,r=n.extensionsUsed,o={};if(e.sheenRoughnessMap){const t={index:n.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};n.applyTextureTransform(t,e.sheenRoughnessMap),o.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:n.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};n.applyTextureTransform(t,e.sheenColorMap),o.sheenColorTexture=t}o.sheenRoughnessFactor=e.sheenRoughness,o.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},$i=class{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const n=this.writer,r=n.extensionsUsed,o={};if(e.anisotropyMap){const t={index:n.processTexture(e.anisotropyMap)};n.applyTextureTransform(t,e.anisotropyMap),o.anisotropyTexture=t}o.anisotropyStrength=e.anisotropy,o.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=o,r[this.name]=!0}},Ji=class{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const n=this.writer.extensionsUsed,r={};r.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}};var es=Uint8Array,ts=Uint16Array,ns=Uint32Array,rs=new es([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),os=new es([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),is=new es([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ss=function(e,t){for(var n=new ts(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var o=new ns(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},as=ss(rs,2),ls=as[0],cs=as[1];ls[28]=258,cs[258]=28;for(var us=ss(os,0)[0],hs=new ts(32768),ds=0;ds<32768;++ds){var ps=(43690&ds)>>>1|(21845&ds)<<1;ps=(61680&(ps=(52428&ps)>>>2|(13107&ps)<<2))>>>4|(3855&ps)<<4,hs[ds]=((65280&ps)>>>8|(255&ps)<<8)>>>1}var ms=function(e,t,n){for(var r=e.length,o=0,i=new ts(t);o<r;++o)++i[e[o]-1];var s,a=new ts(t);for(o=0;o<t;++o)a[o]=a[o-1]+i[o-1]<<1;s=new ts(1<<t);var l=15-t;for(o=0;o<r;++o)if(e[o])for(var c=o<<4|e[o],u=t-e[o],h=a[e[o]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)s[hs[h]>>>l]=c;return s},fs=new es(288);for(ds=0;ds<144;++ds)fs[ds]=8;for(ds=144;ds<256;++ds)fs[ds]=9;for(ds=256;ds<280;++ds)fs[ds]=7;for(ds=280;ds<288;++ds)fs[ds]=8;var gs=new es(32);for(ds=0;ds<32;++ds)gs[ds]=5;var vs=ms(fs,9),ys=ms(gs,5),bs=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},_s=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},ws=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},xs=function(e){return(e/8|0)+(7&e&&1)},Ts=function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new es(0);var o=!t||n,i=!n||n.i;n||(n={}),t||(t=new es(3*r));var s=function(e){var n=t.length;if(e>n){var r=new es(Math.max(2*n,e));r.set(t),t=r}},a=n.f||0,l=n.p||0,c=n.b||0,u=n.l,h=n.d,d=n.m,p=n.n,m=8*r;do{if(!u){n.f=a=_s(e,l,1);var f=_s(e,l+1,3);if(l+=3,!f){var g=e[(S=xs(l)+4)-4]|e[S-3]<<8,v=S+g;if(v>r){if(i)throw"unexpected EOF";break}o&&s(c+g),t.set(e.subarray(S,v),c),n.b=c+=g,n.p=l=8*v;continue}if(1==f)u=vs,h=ys,d=9,p=5;else{if(2!=f)throw"invalid block type";var y=_s(e,l,31)+257,b=_s(e,l+10,15)+4,_=y+_s(e,l+5,31)+1;l+=14;for(var w=new es(_),x=new es(19),T=0;T<b;++T)x[is[T]]=_s(e,l+3*T,7);l+=3*b;var E=bs(x),M=(1<<E)-1,A=ms(x,E);for(T=0;T<_;){var S,O=A[_s(e,l,M)];if(l+=15&O,(S=O>>>4)<16)w[T++]=S;else{var C=0,I=0;for(16==S?(I=3+_s(e,l,3),l+=2,C=w[T-1]):17==S?(I=3+_s(e,l,7),l+=3):18==S&&(I=11+_s(e,l,127),l+=7);I--;)w[T++]=C}}var P=w.subarray(0,y),R=w.subarray(y);d=bs(P),p=bs(R),u=ms(P,d),h=ms(R,p)}if(l>m){if(i)throw"unexpected EOF";break}}o&&s(c+131072);for(var L=(1<<d)-1,k=(1<<p)-1,D=l;;D=l){var U=(C=u[ws(e,l)&L])>>>4;if((l+=15&C)>m){if(i)throw"unexpected EOF";break}if(!C)throw"invalid length/literal";if(U<256)t[c++]=U;else{if(256==U){D=l,u=null;break}var F=U-254;if(U>264){var N=rs[T=U-257];F=_s(e,l,(1<<N)-1)+ls[T],l+=N}var z=h[ws(e,l)&k],j=z>>>4;if(!z)throw"invalid distance";l+=15&z;R=us[j];if(j>3){N=os[j];R+=ws(e,l)&(1<<N)-1,l+=N}if(l>m){if(i)throw"unexpected EOF";break}o&&s(c+131072);for(var B=c+F;c<B;c+=4)t[c]=t[c-R],t[c+1]=t[c+1-R],t[c+2]=t[c+2-R],t[c+3]=t[c+3-R];c=B}}n.l=u,n.p=D,n.b=c,u&&(a=1,n.m=d,n.d=h,n.n=p)}while(!a);return c==t.length?t:function(e,t,n){(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof ts?ts:e instanceof ns?ns:es)(n-t);return r.set(e.subarray(t,n)),r}(t,0,c)},Es=new es(0);var Ms=typeof TextDecoder<"u"&&new TextDecoder;try{Ms.decode(Es,{stream:!0}),1}catch(Vm){}var As=Object.defineProperty;const Ss=class extends E{constructor(e,t={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new f;const n=this,r=void 0!==t.color?new y(t.color):new y(8355711),o=t.textureWidth||512,i=t.textureHeight||512,s=t.clipBias||0,a=t.shader||Ss.ReflectorShader,l=void 0!==t.multisample?t.multisample:4,c=new G,u=new z,h=new z,d=new z,p=new q,m=new z(0,0,-1),g=new re,v=new z,b=new z,_=new re,w=new q,x=this.camera,T=new Ue(o,i,{samples:l,type:le}),E=new B({uniforms:H.clone(a.uniforms),fragmentShader:a.fragmentShader,vertexShader:a.vertexShader});E.uniforms.tDiffuse.value=T.texture,E.uniforms.color.value=r,E.uniforms.textureMatrix.value=w,this.material=E,this.onBeforeRender=function(e,t,r){if(h.setFromMatrixPosition(n.matrixWorld),d.setFromMatrixPosition(r.matrixWorld),p.extractRotation(n.matrixWorld),u.set(0,0,1),u.applyMatrix4(p),v.subVectors(h,d),v.dot(u)>0)return;v.reflect(u).negate(),v.add(h),p.extractRotation(r.matrixWorld),m.set(0,0,-1),m.applyMatrix4(p),m.add(d),b.subVectors(h,m),b.reflect(u).negate(),b.add(h),x.position.copy(v),x.up.set(0,1,0),x.up.applyMatrix4(p),x.up.reflect(u),x.lookAt(b),x.far=r.far,x.updateMatrixWorld(),x.projectionMatrix.copy(r.projectionMatrix),w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),w.multiply(x.projectionMatrix),w.multiply(x.matrixWorldInverse),w.multiply(n.matrixWorld),c.setFromNormalAndCoplanarPoint(u,h),c.applyMatrix4(x.matrixWorldInverse),g.set(c.normal.x,c.normal.y,c.normal.z,c.constant);const o=x.projectionMatrix;_.x=(Math.sign(g.x)+o.elements[8])/o.elements[0],_.y=(Math.sign(g.y)+o.elements[9])/o.elements[5],_.z=-1,_.w=(1+o.elements[10])/o.elements[14],g.multiplyScalar(2/g.dot(_)),o.elements[2]=g.x,o.elements[6]=g.y,o.elements[10]=g.z+1-s,o.elements[14]=g.w,n.visible=!1;const i=e.getRenderTarget(),a=e.xr.enabled,l=e.shadowMap.autoUpdate,f=e.toneMapping;let y=!1;y="outputColorSpace"in e?"srgb"===e.outputColorSpace:3001===e.outputEncoding,e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,"outputColorSpace"in e?e.outputColorSpace="srgb-linear":e.outputEncoding=3e3,e.toneMapping=D,e.setRenderTarget(T),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,x),e.xr.enabled=a,e.shadowMap.autoUpdate=l,e.toneMapping=f,"outputColorSpace"in e?e.outputColorSpace=y?"srgb":"srgb-linear":e.outputEncoding=y?3001:3e3,e.setRenderTarget(i);const E=r.viewport;void 0!==E&&e.state.viewport(E),n.visible=!0},this.getRenderTarget=function(){return T},this.dispose=function(){T.dispose(),n.material.dispose()}}};let Os=Ss;((e,t,n)=>{((e,t,n)=>{t in e?As(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n)})(Os,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}",fragmentShader:"\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <".concat($o>=154?"colorspace_fragment":"encodings_fragment",">\n\n\t\t}")});var Cs=Object.defineProperty,Is=(e,t,n)=>(((e,t,n)=>{t in e?Cs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Ps={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new z},up:{value:new z(0,1,0)}},vertexShader:"\n      uniform vec3 sunPosition;\n      uniform float rayleigh;\n      uniform float turbidity;\n      uniform float mieCoefficient;\n      uniform vec3 up;\n\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      // constants for atmospheric scattering\n      const float e = 2.71828182845904523536028747135266249775724709369995957;\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      // wavelength of used primaries, according to preetham\n      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n      // mie stuff\n      // K coefficient for the primaries\n      const float v = 4.0;\n      const vec3 K = vec3( 0.686, 0.678, 0.666 );\n      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n      // earth shadow hack\n      // cutoffAngle = pi / 1.95;\n      const float cutoffAngle = 1.6110731556870734;\n      const float steepness = 1.5;\n      const float EE = 1000.0;\n\n      float sunIntensity( float zenithAngleCos ) {\n        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n      }\n\n      vec3 totalMie( float T ) {\n        float c = ( 0.2 * T ) * 10E-18;\n        return 0.434 * c * MieConst;\n      }\n\n      void main() {\n\n        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        gl_Position.z = gl_Position.w; // set z to camera.far\n\n        vSunDirection = normalize( sunPosition );\n\n        vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n      // extinction (absorbtion + out scattering)\n      // rayleigh coefficients\n        vBetaR = totalRayleigh * rayleighCoefficient;\n\n      // mie coefficients\n        vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n      }\n    ",fragmentShader:"\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      uniform float mieDirectionalG;\n      uniform vec3 up;\n\n      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n      // constants for atmospheric scattering\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      const float n = 1.0003; // refractive index of air\n      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n      // optical length at zenith for molecules\n      const float rayleighZenithLength = 8.4E3;\n      const float mieZenithLength = 1.25E3;\n      // 66 arc seconds -> degrees, and the cosine of that\n      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n      // 3.0 / ( 16.0 * pi )\n      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n      // 1.0 / ( 4.0 * pi )\n      const float ONE_OVER_FOURPI = 0.07957747154594767;\n\n      float rayleighPhase( float cosTheta ) {\n        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n      }\n\n      float hgPhase( float cosTheta, float g ) {\n        float g2 = pow( g, 2.0 );\n        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n      }\n\n      void main() {\n\n        vec3 direction = normalize( vWorldPosition - cameraPos );\n\n      // optical length\n      // cutoff angle at 90 to avoid singularity in next formula.\n        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n        float sR = rayleighZenithLength * inverse;\n        float sM = mieZenithLength * inverse;\n\n      // combined extinction factor\n        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n      // in scattering\n        float cosTheta = dot( direction, vSunDirection );\n\n        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n        vec3 betaRTheta = vBetaR * rPhase;\n\n        float mPhase = hgPhase( cosTheta, mieDirectionalG );\n        vec3 betaMTheta = vBetaM * mPhase;\n\n        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n      // nightsky\n        float theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]\n        float phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]\n        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n        vec3 L0 = vec3( 0.1 ) * Fex;\n\n      // composition + solar disc\n        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n        gl_FragColor = vec4( retColor, 1.0 );\n\n      #include <tonemapping_fragment>\n      #include <".concat($o>=154?"colorspace_fragment":"encodings_fragment",">\n\n      }\n    ")},Rs=new B({name:"SkyShader",fragmentShader:Ps.fragmentShader,vertexShader:Ps.vertexShader,uniforms:H.clone(Ps.uniforms),side:A,depthWrite:!1});class Ls extends E{constructor(){super(new pe(1,1,1),Rs)}}Is(Ls,"SkyShader",Ps),Is(Ls,"material",Rs),new V,new z;var ks=Object.defineProperty,Ds=(e,t,n)=>(((e,t,n)=>{t in e?ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Us extends F{constructor(e,t){super(),Ds(this,"isTransformControls",!0),Ds(this,"visible",!1),Ds(this,"domElement"),Ds(this,"raycaster",new p),Ds(this,"gizmo"),Ds(this,"plane"),Ds(this,"tempVector",new z),Ds(this,"tempVector2",new z),Ds(this,"tempQuaternion",new ee),Ds(this,"unit",{X:new z(1,0,0),Y:new z(0,1,0),Z:new z(0,0,1)}),Ds(this,"pointStart",new z),Ds(this,"pointEnd",new z),Ds(this,"offset",new z),Ds(this,"rotationAxis",new z),Ds(this,"startNorm",new z),Ds(this,"endNorm",new z),Ds(this,"rotationAngle",0),Ds(this,"cameraPosition",new z),Ds(this,"cameraQuaternion",new ee),Ds(this,"cameraScale",new z),Ds(this,"parentPosition",new z),Ds(this,"parentQuaternion",new ee),Ds(this,"parentQuaternionInv",new ee),Ds(this,"parentScale",new z),Ds(this,"worldPositionStart",new z),Ds(this,"worldQuaternionStart",new ee),Ds(this,"worldScaleStart",new z),Ds(this,"worldPosition",new z),Ds(this,"worldQuaternion",new ee),Ds(this,"worldQuaternionInv",new ee),Ds(this,"worldScale",new z),Ds(this,"eye",new z),Ds(this,"positionStart",new z),Ds(this,"quaternionStart",new ee),Ds(this,"scaleStart",new z),Ds(this,"camera"),Ds(this,"object"),Ds(this,"enabled",!0),Ds(this,"axis",null),Ds(this,"mode","translate"),Ds(this,"translationSnap",null),Ds(this,"rotationSnap",null),Ds(this,"scaleSnap",null),Ds(this,"space","world"),Ds(this,"size",1),Ds(this,"dragging",!1),Ds(this,"showX",!0),Ds(this,"showY",!0),Ds(this,"showZ",!0),Ds(this,"changeEvent",{type:"change"}),Ds(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),Ds(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),Ds(this,"objectChangeEvent",{type:"objectChange"}),Ds(this,"intersectObjectWithRay",((e,t,n)=>{const r=t.intersectObject(e,!0);for(let o=0;o<r.length;o++)if(r[o].object.visible||n)return r[o];return!1})),Ds(this,"attach",(e=>(this.object=e,this.visible=!0,this))),Ds(this,"detach",(()=>(this.object=void 0,this.visible=!1,this.axis=null,this))),Ds(this,"reset",(()=>this.enabled?(this.dragging&&void 0!==this.object&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this)),Ds(this,"updateMatrixWorld",(()=>{void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()})),Ds(this,"pointerHover",(e=>{if(void 0===this.object||!0===this.dragging)return;this.raycaster.setFromCamera(e,this.camera);const t=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);this.axis=t?t.object.name:null})),Ds(this,"pointerDown",(e=>{if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){this.raycaster.setFromCamera(e,this.camera);const t=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(t){let e=this.space;if("scale"===this.mode?e="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(e="world"),"local"===e&&"rotate"===this.mode){const e=this.rotationSnap;"X"===this.axis&&e&&(this.object.rotation.x=Math.round(this.object.rotation.x/e)*e),"Y"===this.axis&&e&&(this.object.rotation.y=Math.round(this.object.rotation.y/e)*e),"Z"===this.axis&&e&&(this.object.rotation.z=Math.round(this.object.rotation.z/e)*e)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}})),Ds(this,"pointerMove",(e=>{const t=this.axis,n=this.mode,r=this.object;let o=this.space;if("scale"===n?o="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(o="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;this.raycaster.setFromCamera(e,this.camera);const i=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(i){if(this.pointEnd.copy(i.point).sub(this.worldPositionStart),"translate"===n)this.offset.copy(this.pointEnd).sub(this.pointStart),"local"===o&&"XYZ"!==t&&this.offset.applyQuaternion(this.worldQuaternionInv),-1===t.indexOf("X")&&(this.offset.x=0),-1===t.indexOf("Y")&&(this.offset.y=0),-1===t.indexOf("Z")&&(this.offset.z=0),"local"===o&&"XYZ"!==t?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),r.position.copy(this.offset).add(this.positionStart),this.translationSnap&&("local"===o&&(r.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this.quaternionStart)),"world"===o&&(r.parent&&r.position.add(this.tempVector.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(this.tempVector.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),this.tempVector2.set(e,e,e)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),-1===t.search("X")&&(this.tempVector2.x=1),-1===t.search("Y")&&(this.tempVector2.y=1),-1===t.search("Z")&&(this.tempVector2.z=1);r.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(-1!==t.search("X")&&(this.object.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this.offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(this.unit[t]),this.tempVector.copy(this.unit[t]),"local"===o&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===o&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this.quaternionStart),r.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),r.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}})),Ds(this,"pointerUp",(e=>{0===e.button&&(this.dragging&&null!==this.axis&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)})),Ds(this,"getPointer",(e=>{var t;if(this.domElement&&null!=(t=this.domElement.ownerDocument)&&t.pointerLockElement)return{x:0,y:0,button:e.button};{const t=e.changedTouches?e.changedTouches[0]:e,n=this.domElement.getBoundingClientRect();return{x:(t.clientX-n.left)/n.width*2-1,y:-(t.clientY-n.top)/n.height*2+1,button:e.button}}})),Ds(this,"onPointerHover",(e=>{if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(e))}})),Ds(this,"onPointerDown",(e=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(e)),this.pointerDown(this.getPointer(e)))})),Ds(this,"onPointerMove",(e=>{this.enabled&&this.pointerMove(this.getPointer(e))})),Ds(this,"onPointerUp",(e=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(e)))})),Ds(this,"getMode",(()=>this.mode)),Ds(this,"setMode",(e=>{this.mode=e})),Ds(this,"setTranslationSnap",(e=>{this.translationSnap=e})),Ds(this,"setRotationSnap",(e=>{this.rotationSnap=e})),Ds(this,"setScaleSnap",(e=>{this.scaleSnap=e})),Ds(this,"setSize",(e=>{this.size=e})),Ds(this,"setSpace",(e=>{this.space=e})),Ds(this,"update",(()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")})),Ds(this,"connect",(e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)})),Ds(this,"dispose",(()=>{var e,t,n,r,o,i;null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointermove",this.onPointerHover),null==(r=null==(n=this.domElement)?void 0:n.ownerDocument)||r.removeEventListener("pointermove",this.onPointerMove),null==(i=null==(o=this.domElement)?void 0:o.ownerDocument)||i.removeEventListener("pointerup",this.onPointerUp),this.traverse((e=>{const t=e;t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}))})),this.domElement=t,this.camera=e,this.gizmo=new Fs,this.add(this.gizmo),this.plane=new Ns,this.add(this.plane);const n=(e,t)=>{let n=t;Object.defineProperty(this,e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),this[e]=t,this.plane[e]=t,this.gizmo[e]=t};n("camera",this.camera),n("object",this.object),n("enabled",this.enabled),n("axis",this.axis),n("mode",this.mode),n("translationSnap",this.translationSnap),n("rotationSnap",this.rotationSnap),n("scaleSnap",this.scaleSnap),n("space",this.space),n("size",this.size),n("dragging",this.dragging),n("showX",this.showX),n("showY",this.showY),n("showZ",this.showZ),n("worldPosition",this.worldPosition),n("worldPositionStart",this.worldPositionStart),n("worldQuaternion",this.worldQuaternion),n("worldQuaternionStart",this.worldQuaternionStart),n("cameraPosition",this.cameraPosition),n("cameraQuaternion",this.cameraQuaternion),n("pointStart",this.pointStart),n("pointEnd",this.pointEnd),n("rotationAxis",this.rotationAxis),n("rotationAngle",this.rotationAngle),n("eye",this.eye),void 0!==t&&this.connect(t)}}class Fs extends F{constructor(){super(),Ds(this,"isTransformControlsGizmo",!0),Ds(this,"type","TransformControlsGizmo"),Ds(this,"tempVector",new z(0,0,0)),Ds(this,"tempEuler",new Y),Ds(this,"alignVector",new z(0,1,0)),Ds(this,"zeroVector",new z(0,0,0)),Ds(this,"lookAtMatrix",new q),Ds(this,"tempQuaternion",new ee),Ds(this,"tempQuaternion2",new ee),Ds(this,"identityQuaternion",new ee),Ds(this,"unitX",new z(1,0,0)),Ds(this,"unitY",new z(0,1,0)),Ds(this,"unitZ",new z(0,0,1)),Ds(this,"gizmo"),Ds(this,"picker"),Ds(this,"helper"),Ds(this,"rotationAxis",new z),Ds(this,"cameraPosition",new z),Ds(this,"worldPositionStart",new z),Ds(this,"worldQuaternionStart",new ee),Ds(this,"worldPosition",new z),Ds(this,"worldQuaternion",new ee),Ds(this,"eye",new z),Ds(this,"camera",null),Ds(this,"enabled",!0),Ds(this,"axis",null),Ds(this,"mode","translate"),Ds(this,"space","world"),Ds(this,"size",1),Ds(this,"dragging",!1),Ds(this,"showX",!0),Ds(this,"showY",!0),Ds(this,"showZ",!0),Ds(this,"updateMatrixWorld",(()=>{let e=this.space;"scale"===this.mode&&(e="local");const t="local"===e?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let n=[];n=n.concat(this.picker[this.mode].children),n=n.concat(this.gizmo[this.mode].children),n=n.concat(this.helper[this.mode].children);for(let r=0;r<n.length;r++){const e=n[r];let o;e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),(o=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(o*this.size/7),"helper"!==e.tag)?(e.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?(("X"===e.name||"XYZX"===e.name)&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),("Y"===e.name||"XYZY"===e.name)&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),("Z"===e.name||"XYZZ"===e.name)&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),-1!==e.name.search("X")&&(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.x*=-1:"bwd"===e.tag&&(e.visible=!1)),-1!==e.name.search("Y")&&(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.y*=-1:"bwd"===e.tag&&(e.visible=!1)),-1!==e.name.search("Z")&&(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.z*=-1:"bwd"===e.tag&&(e.visible=!1))):"rotate"===this.mode&&(this.tempQuaternion2.copy(t),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(t).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),"X"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion)),"Y"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion)),"Z"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion))),e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material.tempOpacity=e.material.tempOpacity||e.material.opacity,e.material.tempColor=e.material.tempColor||e.material.color.clone(),e.material.color.copy(e.material.tempColor),e.material.opacity=e.material.tempOpacity,this.enabled?this.axis&&(e.name===this.axis||this.axis.split("").some((function(t){return e.name===t}))?(e.material.opacity=1,e.material.color.lerp(new y(1,1,1),.5)):(e.material.opacity*=.25,e.material.color.lerp(new y(1,1,1),.5))):(e.material.opacity*=.5,e.material.color.lerp(new y(1,1,1),.5))):(e.visible=!1,"AXIS"===e.name?(e.position.copy(this.worldPositionStart),e.visible=!!this.axis,"X"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),e.quaternion.multiply(this.tempQuaternion),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(this.tempVector),e.visible=this.dragging):(e.quaternion.copy(t),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name))))}super.updateMatrixWorld()}));const e=new M({depthTest:!1,depthWrite:!1,transparent:!0,side:j,fog:!1,toneMapped:!1}),t=new T({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;const r=e.clone();r.opacity=.33;const o=e.clone();o.color.set(16711680);const i=e.clone();i.color.set(65280);const s=e.clone();s.color.set(255);const a=e.clone();a.opacity=.25;const l=a.clone();l.color.set(16776960);const c=a.clone();c.color.set(65535);const u=a.clone();u.color.set(16711935),e.clone().color.set(16776960);const h=t.clone();h.color.set(16711680);const d=t.clone();d.color.set(65280);const p=t.clone();p.color.set(255);const m=t.clone();m.color.set(65535);const f=t.clone();f.color.set(16711935);const g=t.clone();g.color.set(16776960);const v=t.clone();v.color.set(7895160);const b=g.clone();b.opacity=.25;const A=new me(0,.05,.2,12,1,!1),S=new pe(.125,.125,.125),O=new w;O.setAttribute("position",new x([0,0,0,1,0,0],3));const C=(e,t)=>{const n=new w,r=[];for(let o=0;o<=64*t;++o)r.push(0,Math.cos(o/32*Math.PI)*e,Math.sin(o/32*Math.PI)*e);return n.setAttribute("position",new x(r,3)),n},I={X:[[new E(A,o),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new E(A,o),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new _(O,h)]],Y:[[new E(A,i),[0,1,0],null,null,"fwd"],[new E(A,i),[0,1,0],[Math.PI,0,0],null,"bwd"],[new _(O,d),null,[0,0,Math.PI/2]]],Z:[[new E(A,s),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new E(A,s),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new _(O,p),null,[0,-Math.PI/2,0]]],XYZ:[[new E(new fe(.1,0),a.clone()),[0,0,0],[0,0,0]]],XY:[[new E(new ue(.295,.295),l.clone()),[.15,.15,0]],[new _(O,g),[.18,.3,0],null,[.125,1,1]],[new _(O,g),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new E(new ue(.295,.295),c.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new _(O,m),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new _(O,m),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new E(new ue(.295,.295),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new _(O,f),[.18,0,.3],null,[.125,1,1]],[new _(O,f),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},P={X:[[new E(new me(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new E(new me(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new E(new me(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new E(new fe(.2,0),n)]],XY:[[new E(new ue(.4,.4),n),[.2,.2,0]]],YZ:[[new E(new ue(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new E(new ue(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},R={START:[[new E(new fe(.01,2),r),null,null,null,"helper"]],END:[[new E(new fe(.01,2),r),null,null,null,"helper"]],DELTA:[[new _((()=>{const e=new w;return e.setAttribute("position",new x([0,0,0,1,1,1],3)),e})(),r),null,null,null,"helper"]],X:[[new _(O,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new _(O,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new _(O,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},L={X:[[new _(C(1,.5),h)],[new E(new fe(.04,0),o),[0,0,.99],null,[1,3,1]]],Y:[[new _(C(1,.5),d),null,[0,0,-Math.PI/2]],[new E(new fe(.04,0),i),[0,0,.99],null,[3,1,1]]],Z:[[new _(C(1,.5),p),null,[0,Math.PI/2,0]],[new E(new fe(.04,0),s),[.99,0,0],null,[1,3,1]]],E:[[new _(C(1.25,1),b),null,[0,Math.PI/2,0]],[new E(new me(.03,0,.15,4,1,!1),b),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new E(new me(.03,0,.15,4,1,!1),b),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new E(new me(.03,0,.15,4,1,!1),b),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new E(new me(.03,0,.15,4,1,!1),b),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new _(C(1,1),v),null,[0,Math.PI/2,0]]]},k={AXIS:[[new _(O,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},D={X:[[new E(new ge(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new E(new ge(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new E(new ge(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new E(new ge(1.25,.1,2,24),n)]],XYZE:[[new E(new ve(.7,10,8),n)]]},U={X:[[new E(S,o),[.8,0,0],[0,0,-Math.PI/2]],[new _(O,h),null,null,[.8,1,1]]],Y:[[new E(S,i),[0,.8,0]],[new _(O,d),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new E(S,s),[0,0,.8],[Math.PI/2,0,0]],[new _(O,p),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new E(S,l),[.85,.85,0],null,[2,2,.2]],[new _(O,g),[.855,.98,0],null,[.125,1,1]],[new _(O,g),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new E(S,c),[0,.85,.85],null,[.2,2,2]],[new _(O,m),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new _(O,m),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new E(S,u),[.85,0,.85],null,[2,.2,2]],[new _(O,f),[.855,0,.98],null,[.125,1,1]],[new _(O,f),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new E(new pe(.125,.125,.125),a.clone()),[1.1,0,0]]],XYZY:[[new E(new pe(.125,.125,.125),a.clone()),[0,1.1,0]]],XYZZ:[[new E(new pe(.125,.125,.125),a.clone()),[0,0,1.1]]]},N={X:[[new E(new me(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new E(new me(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new E(new me(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new E(S,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new E(S,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new E(S,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new E(new pe(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new E(new pe(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new E(new pe(.2,.2,.2),n),[0,0,1.1]]]},B={X:[[new _(O,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new _(O,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new _(O,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},H=e=>{const t=new F;for(let n in e)for(let r=e[n].length;r--;){const o=e[n][r][0].clone(),i=e[n][r][1],s=e[n][r][2],a=e[n][r][3],l=e[n][r][4];o.name=n,o.tag=l,i&&o.position.set(i[0],i[1],i[2]),s&&o.rotation.set(s[0],s[1],s[2]),a&&o.scale.set(a[0],a[1],a[2]),o.updateMatrix();const c=o.geometry.clone();c.applyMatrix4(o.matrix),o.geometry=c,o.renderOrder=1/0,o.position.set(0,0,0),o.rotation.set(0,0,0),o.scale.set(1,1,1),t.add(o)}return t};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=H(I)),this.add(this.gizmo.rotate=H(L)),this.add(this.gizmo.scale=H(U)),this.add(this.picker.translate=H(P)),this.add(this.picker.rotate=H(D)),this.add(this.picker.scale=H(N)),this.add(this.helper.translate=H(R)),this.add(this.helper.rotate=H(k)),this.add(this.helper.scale=H(B)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class Ns extends E{constructor(){super(new ue(1e5,1e5,2,2),new M({visible:!1,wireframe:!0,side:j,transparent:!0,opacity:.1,toneMapped:!1})),Ds(this,"isTransformControlsPlane",!0),Ds(this,"type","TransformControlsPlane"),Ds(this,"unitX",new z(1,0,0)),Ds(this,"unitY",new z(0,1,0)),Ds(this,"unitZ",new z(0,0,1)),Ds(this,"tempVector",new z),Ds(this,"dirVector",new z),Ds(this,"alignVector",new z),Ds(this,"tempMatrix",new q),Ds(this,"identityQuaternion",new ee),Ds(this,"cameraQuaternion",new ee),Ds(this,"worldPosition",new z),Ds(this,"worldQuaternion",new ee),Ds(this,"eye",new z),Ds(this,"axis",null),Ds(this,"mode","translate"),Ds(this,"space","world"),Ds(this,"updateMatrixWorld",(()=>{let e=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(e="local"),this.unitX.set(1,0,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0)}break;default:this.dirVector.set(0,0,0)}0===this.dirVector.length()?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()}))}}var zs=Object.defineProperty,js=(e,t,n)=>(((e,t,n)=>{t in e?zs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Bs=new Y(0,0,0,"YXZ"),Hs=new z,Vs={type:"change"},Ys={type:"lock"},Xs={type:"unlock"},Gs=Math.PI/2;class Ws extends ye{constructor(e,t){super(),js(this,"camera"),js(this,"domElement"),js(this,"isLocked"),js(this,"minPolarAngle"),js(this,"maxPolarAngle"),js(this,"pointerSpeed"),js(this,"onMouseMove",(e=>{if(!this.domElement||!1===this.isLocked)return;const t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;Bs.setFromQuaternion(this.camera.quaternion),Bs.y-=.002*t*this.pointerSpeed,Bs.x-=.002*n*this.pointerSpeed,Bs.x=Math.max(Gs-this.maxPolarAngle,Math.min(Gs-this.minPolarAngle,Bs.x)),this.camera.quaternion.setFromEuler(Bs),this.dispatchEvent(Vs)})),js(this,"onPointerlockChange",(()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(Ys),this.isLocked=!0):(this.dispatchEvent(Xs),this.isLocked=!1))})),js(this,"onPointerlockError",(()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")})),js(this,"connect",(e=>{this.domElement=e||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))})),js(this,"disconnect",(()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))})),js(this,"dispose",(()=>{this.disconnect()})),js(this,"getObject",(()=>this.camera)),js(this,"direction",new z(0,0,-1)),js(this,"getDirection",(e=>e.copy(this.direction).applyQuaternion(this.camera.quaternion))),js(this,"moveForward",(e=>{Hs.setFromMatrixColumn(this.camera.matrix,0),Hs.crossVectors(this.camera.up,Hs),this.camera.position.addScaledVector(Hs,e)})),js(this,"moveRight",(e=>{Hs.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(Hs,e)})),js(this,"lock",(()=>{this.domElement&&this.domElement.requestPointerLock()})),js(this,"unlock",(()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()})),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}}var Zs=Object.defineProperty,Ks=(e,t,n)=>(((e,t,n)=>{t in e?Zs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const qs=new X,Qs=new G,$s=Math.cos(Math.PI/180*70),Js=(e,t)=>(e%t+t)%t;class ea extends ye{constructor(e,t){super(),Ks(this,"object"),Ks(this,"domElement"),Ks(this,"enabled",!0),Ks(this,"target",new z),Ks(this,"minDistance",0),Ks(this,"maxDistance",1/0),Ks(this,"minZoom",0),Ks(this,"maxZoom",1/0),Ks(this,"minPolarAngle",0),Ks(this,"maxPolarAngle",Math.PI),Ks(this,"minAzimuthAngle",-1/0),Ks(this,"maxAzimuthAngle",1/0),Ks(this,"enableDamping",!1),Ks(this,"dampingFactor",.05),Ks(this,"enableZoom",!0),Ks(this,"zoomSpeed",1),Ks(this,"enableRotate",!0),Ks(this,"rotateSpeed",1),Ks(this,"enablePan",!0),Ks(this,"panSpeed",1),Ks(this,"screenSpacePanning",!0),Ks(this,"keyPanSpeed",7),Ks(this,"zoomToCursor",!1),Ks(this,"autoRotate",!1),Ks(this,"autoRotateSpeed",2),Ks(this,"reverseOrbit",!1),Ks(this,"reverseHorizontalOrbit",!1),Ks(this,"reverseVerticalOrbit",!1),Ks(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ks(this,"mouseButtons",{LEFT:be.ROTATE,MIDDLE:be.DOLLY,RIGHT:be.PAN}),Ks(this,"touches",{ONE:$.ROTATE,TWO:$.DOLLY_PAN}),Ks(this,"target0"),Ks(this,"position0"),Ks(this,"zoom0"),Ks(this,"_domElementKeyEvents",null),Ks(this,"getPolarAngle"),Ks(this,"getAzimuthalAngle"),Ks(this,"setPolarAngle"),Ks(this,"setAzimuthalAngle"),Ks(this,"getDistance"),Ks(this,"listenToKeyEvents"),Ks(this,"stopListenToKeyEvents"),Ks(this,"saveState"),Ks(this,"reset"),Ks(this,"update"),Ks(this,"connect"),Ks(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=Js(e,2*Math.PI),r=c.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let o=Math.abs(t-r);2*Math.PI-o<o&&(t<r?t+=2*Math.PI:r+=2*Math.PI),u.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=Js(e,2*Math.PI),r=c.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let o=Math.abs(t-r);2*Math.PI-o<o&&(t<r?t+=2*Math.PI:r+=2*Math.PI),u.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",J),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",J),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),a=s.NONE},this.update=(()=>{const t=new z,o=new z(0,1,0),i=(new ee).setFromUnitVectors(e.up,o),p=i.clone().invert(),m=new z,g=new ee,v=2*Math.PI;return function(){const y=n.object.position;i.setFromUnitVectors(e.up,o),p.copy(i).invert(),t.copy(y).sub(n.target),t.applyQuaternion(i),c.setFromVector3(t),n.autoRotate&&a===s.NONE&&C(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=u.theta*n.dampingFactor,c.phi+=u.phi*n.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let b=n.minAzimuthAngle,_=n.maxAzimuthAngle;isFinite(b)&&isFinite(_)&&(b<-Math.PI?b+=v:b>Math.PI&&(b-=v),_<-Math.PI?_+=v:_>Math.PI&&(_-=v),c.theta=b<=_?Math.max(b,Math.min(_,c.theta)):c.theta>(b+_)/2?Math.max(b,c.theta):Math.min(_,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),n.zoomToCursor&&M||n.object.isOrthographicCamera?c.radius=F(c.radius):c.radius=F(c.radius*h),t.setFromSpherical(c),t.applyQuaternion(p),y.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),d.set(0,0,0));let w=!1;if(n.zoomToCursor&&M){let r=null;if(n.object instanceof f&&n.object.isPerspectiveCamera){const e=t.length();r=F(e*h);const o=e-r;n.object.position.addScaledVector(T,o),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new z(E.x,E.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix(),w=!0;const o=new z(E.x,E.y,0);o.unproject(n.object),n.object.position.sub(o).add(e),n.object.updateMatrixWorld(),r=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==r&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(r).add(n.object.position):(qs.origin.copy(n.object.position),qs.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(qs.direction))<$s?e.lookAt(n.target):(Qs.setFromNormalAndCoplanarPoint(n.object.up,n.target),qs.intersectPlane(Qs,n.target))))}else n.object instanceof _e&&n.object.isOrthographicCamera&&(w=1!==h,w&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix()));return h=1,M=!1,!!(w||m.distanceToSquared(n.object.position)>l||8*(1-g.dot(n.object.quaternion))>l)&&(n.dispatchEvent(r),m.copy(n.object.position),g.copy(n.object.quaternion),w=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",te),n.domElement.addEventListener("pointerdown",Z),n.domElement.addEventListener("pointercancel",q),n.domElement.addEventListener("wheel",Q)},this.dispose=()=>{var e,t,r,o,i,s;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",te),null==(t=n.domElement)||t.removeEventListener("pointerdown",Z),null==(r=n.domElement)||r.removeEventListener("pointercancel",q),null==(o=n.domElement)||o.removeEventListener("wheel",Q),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",K),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointerup",q),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",J)};const n=this,r={type:"change"},o={type:"start"},i={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=s.NONE;const l=1e-6,c=new ne,u=new ne;let h=1;const d=new z,p=new N,m=new N,g=new N,v=new N,y=new N,b=new N,_=new N,w=new N,x=new N,T=new z,E=new N;let M=!1;const A=[],S={};function O(){return Math.pow(.95,n.zoomSpeed)}function C(e){n.reverseOrbit||n.reverseHorizontalOrbit?u.theta+=e:u.theta-=e}function I(e){n.reverseOrbit||n.reverseVerticalOrbit?u.phi+=e:u.phi-=e}const P=(()=>{const e=new z;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),d.add(e)}})(),R=(()=>{const e=new z;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),d.add(e)}})(),L=(()=>{const e=new z;return function(t,r){const o=n.domElement;if(o&&n.object instanceof f&&n.object.isPerspectiveCamera){const i=n.object.position;e.copy(i).sub(n.target);let s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180),P(2*t*s/o.clientHeight,n.object.matrix),R(2*r*s/o.clientHeight,n.object.matrix)}else o&&n.object instanceof _e&&n.object.isOrthographicCamera?(P(t*(n.object.right-n.object.left)/n.object.zoom/o.clientWidth,n.object.matrix),R(r*(n.object.top-n.object.bottom)/n.object.zoom/o.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function k(e){n.object instanceof f&&n.object.isPerspectiveCamera||n.object instanceof _e&&n.object.isOrthographicCamera?h/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function D(e){n.object instanceof f&&n.object.isPerspectiveCamera||n.object instanceof _e&&n.object.isOrthographicCamera?h*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function U(e){if(!n.zoomToCursor||!n.domElement)return;M=!0;const t=n.domElement.getBoundingClientRect(),r=e.clientX-t.left,o=e.clientY-t.top,i=t.width,s=t.height;E.x=r/i*2-1,E.y=-o/s*2+1,T.set(E.x,E.y,1).unproject(n.object).sub(n.object.position).normalize()}function F(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function j(e){p.set(e.clientX,e.clientY)}function B(e){v.set(e.clientX,e.clientY)}function H(){if(1==A.length)p.set(A[0].pageX,A[0].pageY);else{const e=.5*(A[0].pageX+A[1].pageX),t=.5*(A[0].pageY+A[1].pageY);p.set(e,t)}}function V(){if(1==A.length)v.set(A[0].pageX,A[0].pageY);else{const e=.5*(A[0].pageX+A[1].pageX),t=.5*(A[0].pageY+A[1].pageY);v.set(e,t)}}function Y(){const e=A[0].pageX-A[1].pageX,t=A[0].pageY-A[1].pageY,n=Math.sqrt(e*e+t*t);_.set(0,n)}function X(e){if(1==A.length)m.set(e.pageX,e.pageY);else{const t=oe(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);m.set(n,r)}g.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(C(2*Math.PI*g.x/t.clientHeight),I(2*Math.PI*g.y/t.clientHeight)),p.copy(m)}function G(e){if(1==A.length)y.set(e.pageX,e.pageY);else{const t=oe(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);y.set(n,r)}b.subVectors(y,v).multiplyScalar(n.panSpeed),L(b.x,b.y),v.copy(y)}function W(e){const t=oe(e),r=e.pageX-t.x,o=e.pageY-t.y,i=Math.sqrt(r*r+o*o);w.set(0,i),x.set(0,Math.pow(w.y/_.y,n.zoomSpeed)),k(x.y),_.copy(w)}function Z(e){var t,r;!1!==n.enabled&&(0===A.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",K),null==(r=n.domElement)||r.ownerDocument.addEventListener("pointerup",q)),function(e){A.push(e)}(e),"touch"===e.pointerType?function(e){switch(re(e),A.length){case 1:switch(n.touches.ONE){case $.ROTATE:if(!1===n.enableRotate)return;H(),a=s.TOUCH_ROTATE;break;case $.PAN:if(!1===n.enablePan)return;V(),a=s.TOUCH_PAN;break;default:a=s.NONE}break;case 2:switch(n.touches.TWO){case $.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&Y(),n.enablePan&&V(),a=s.TOUCH_DOLLY_PAN;break;case $.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&Y(),n.enableRotate&&H(),a=s.TOUCH_DOLLY_ROTATE;break;default:a=s.NONE}break;default:a=s.NONE}a!==s.NONE&&n.dispatchEvent(o)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case be.DOLLY:if(!1===n.enableZoom)return;(function(e){U(e),_.set(e.clientX,e.clientY)})(e),a=s.DOLLY;break;case be.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;B(e),a=s.PAN}else{if(!1===n.enableRotate)return;j(e),a=s.ROTATE}break;case be.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;j(e),a=s.ROTATE}else{if(!1===n.enablePan)return;B(e),a=s.PAN}break;default:a=s.NONE}a!==s.NONE&&n.dispatchEvent(o)}(e))}function K(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(re(e),a){case s.TOUCH_ROTATE:if(!1===n.enableRotate)return;X(e),n.update();break;case s.TOUCH_PAN:if(!1===n.enablePan)return;G(e),n.update();break;case s.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function(e){n.enableZoom&&W(e),n.enablePan&&G(e)})(e),n.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function(e){n.enableZoom&&W(e),n.enableRotate&&X(e)})(e),n.update();break;default:a=s.NONE}}(e):function(e){if(!1!==n.enabled)switch(a){case s.ROTATE:if(!1===n.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),g.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(C(2*Math.PI*g.x/t.clientHeight),I(2*Math.PI*g.y/t.clientHeight)),p.copy(m),n.update()}(e);break;case s.DOLLY:if(!1===n.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),x.subVectors(w,_),x.y>0?k(O()):x.y<0&&D(O()),_.copy(w),n.update()}(e);break;case s.PAN:if(!1===n.enablePan)return;!function(e){y.set(e.clientX,e.clientY),b.subVectors(y,v).multiplyScalar(n.panSpeed),L(b.x,b.y),v.copy(y),n.update()}(e)}}(e))}function q(e){var t,r,o;(function(e){delete S[e.pointerId];for(let t=0;t<A.length;t++)if(A[t].pointerId==e.pointerId)return void A.splice(t,1)})(e),0===A.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",K),null==(o=n.domElement)||o.ownerDocument.removeEventListener("pointerup",q)),n.dispatchEvent(i),a=s.NONE}function Q(e){!1===n.enabled||!1===n.enableZoom||a!==s.NONE&&a!==s.ROTATE||(e.preventDefault(),n.dispatchEvent(o),function(e){U(e),e.deltaY<0?D(O()):e.deltaY>0&&k(O()),n.update()}(e),n.dispatchEvent(i))}function J(e){!1===n.enabled||!1===n.enablePan||function(e){let t=!1;switch(e.code){case n.keys.UP:L(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:L(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:L(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:L(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function te(e){!1!==n.enabled&&e.preventDefault()}function re(e){let t=S[e.pointerId];void 0===t&&(t=new N,S[e.pointerId]=t),t.set(e.pageX,e.pageY)}function oe(e){const t=e.pointerId===A[0].pointerId?A[1]:A[0];return S[t.pointerId]}void 0!==t&&this.connect(t),this.update()}}class ta extends ea{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=be.PAN,this.mouseButtons.RIGHT=be.ROTATE,this.touches.ONE=$.PAN,this.touches.TWO=$.DOLLY_ROTATE}}function na(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let r=0,o=e.length;r<o;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(n){return t}}new z;class ra extends we{constructor(e,t={}){const n=t,{bevelEnabled:r=!1,bevelSize:o=8,bevelThickness:i=10,font:s,height:u=50,size:h=100,lineHeight:d=1,letterSpacing:p=0}=n,m=c(n,["bevelEnabled","bevelSize","bevelThickness","font","height","size","lineHeight","letterSpacing"]);if(void 0===s)super();else{super(s.generateShapes(e,h,{lineHeight:d,letterSpacing:p}),l(a({},m),{bevelEnabled:r,bevelSize:o,bevelThickness:i,depth:u}))}this.type="TextGeometry"}}const oa={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},ia={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "};function sa(e,t,n){const r=n.length-e-1;if(t>=n[r])return r-1;if(t<=n[e])return e;let o=e,i=r,s=Math.floor((o+i)/2);for(;t<n[s]||t>=n[s+1];)t<n[s]?i=s:o=s,s=Math.floor((o+i)/2);return s}function aa(e,t){let n=1;for(let o=2;o<=e;++o)n*=o;let r=1;for(let o=2;o<=t;++o)r*=o;for(let o=2;o<=e-t;++o)r*=o;return n/r}function la(e,t,n,r,o){const i=function(e,t,n,r,o){const i=o<e?o:e,s=[],a=sa(e,r,t),l=function(e,t,n,r,o){const i=[];for(let h=0;h<=n;++h)i[h]=0;const s=[];for(let h=0;h<=r;++h)s[h]=i.slice(0);const a=[];for(let h=0;h<=n;++h)a[h]=i.slice(0);a[0][0]=1;const l=i.slice(0),c=i.slice(0);for(let h=1;h<=n;++h){l[h]=t-o[e+1-h],c[h]=o[e+h]-t;let n=0;for(let e=0;e<h;++e){const t=c[e+1],r=l[h-e];a[h][e]=t+r;const o=a[e][h-1]/a[h][e];a[e][h]=n+t*o,n=r*o}a[h][h]=n}for(let h=0;h<=n;++h)s[0][h]=a[h][n];for(let h=0;h<=n;++h){let e=0,t=1;const o=[];for(let r=0;r<=n;++r)o[r]=i.slice(0);o[0][0]=1;for(let i=1;i<=r;++i){let r=0;const l=h-i,c=n-i;h>=i&&(o[t][0]=o[e][0]/a[c+1][l],r=o[t][0]*a[l][c]);const u=h-1<=c?i-1:n-h;for(let n=l>=-1?1:-l;n<=u;++n)o[t][n]=(o[e][n]-o[e][n-1])/a[c+1][l+n],r+=o[t][n]*a[l+n][c];h<=c&&(o[t][i]=-o[e][i-1]/a[c+1][h],r+=o[t][i]*a[h][c]),s[i][h]=r;const d=e;e=t,t=d}}let u=n;for(let h=1;h<=r;++h){for(let e=0;e<=n;++e)s[h][e]*=u;u*=n-h}return s}(a,r,e,i,t),c=[];for(let u=0;u<n.length;++u){const e=n[u].clone(),t=e.w;e.x*=t,e.y*=t,e.z*=t,c[u]=e}for(let u=0;u<=i;++u){const t=c[a-e].clone().multiplyScalar(l[u][0]);for(let n=1;n<=e;++n)t.add(c[a-e+n].clone().multiplyScalar(l[u][n]));s[u]=t}for(let u=i+1;u<=o+1;++u)s[u]=new re(0,0,0);return s}(e,t,n,r,o);return function(e){const t=e.length,n=[],r=[];for(let i=0;i<t;++i){const t=e[i];n[i]=new z(t.x,t.y,t.z),r[i]=t.w}const o=[];for(let i=0;i<t;++i){const e=n[i].clone();for(let t=1;t<=i;++t)e.sub(o[i-t].clone().multiplyScalar(aa(i,t)*r[t]));o[i]=e.divideScalar(r[0])}return o}(i)}class ca extends wt{constructor(e,t,n,r,o){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=o||this.knots.length-1;for(let i=0;i<n.length;++i){const e=n[i];this.controlPoints[i]=new re(e.x,e.y,e.z,e.w)}}getPoint(e,t){const n=t||new z,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=function(e,t,n,r){const o=sa(e,r,t),i=function(e,t,n,r){const o=[],i=[],s=[];o[0]=1;for(let a=1;a<=n;++a){i[a]=t-r[e+1-a],s[a]=r[e+a]-t;let n=0;for(let e=0;e<a;++e){const t=s[e+1],r=i[a-e],l=o[e]/(t+r);o[e]=n+t*l,n=r*l}o[a]=n}return o}(o,r,e,t),s=new re(0,0,0,0);for(let a=0;a<=e;++a){const t=n[o-e+a],r=i[a],l=t.w*r;s.x+=t.x*l,s.y+=t.y*l,s.z+=t.z*l,s.w+=t.w*r}return s}(this.degree,this.knots,this.controlPoints,r);return 1!=o.w&&o.divideScalar(o.w),n.set(o.x,o.y,o.z)}getTangent(e,t){const n=t||new z,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=la(this.degree,this.knots,this.controlPoints,r,1);return n.copy(o[1]).normalize(),n}}let ua,ha,da;class pa extends xe{constructor(e){super(e)}load(e,t,n,r){const o=this,i=""===o.path?Ne.extractUrlBase(e):o.path,s=new Te(this.manager);s.setPath(o.path),s.setResponseType("arraybuffer"),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,(function(n){try{t(o.parse(n,i))}catch(s){r?r(s):console.error(s),o.manager.itemError(e)}}),n,r)}parse(e,t){if(function(e){const t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===Ia(e,0,t.length)}(e))ua=(new ya).parse(e);else{const t=Ia(e);if(!function(e){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(t){const r=e[t-1];return e=e.slice(n+t),n++,r}for(let o=0;o<t.length;++o)if(r(1)===t[o])return!1;return!0}(t))throw new Error("THREE.FBXLoader: Unknown format.");if(wa(t)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+wa(t));ua=(new va).parse(t)}const n=new h(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new ma(n,this.manager).parse(ua)}}class ma{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){ha=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),r=this.parseDeformers(),o=(new fa).parse(r);return this.parseScene(r,o,n),da}parseConnections(){const e=new Map;return"Connections"in ua&&ua.Connections.connections.forEach((function(t){const n=t[0],r=t[1],o=t[2];e.has(n)||e.set(n,{parents:[],children:[]});const i={ID:r,relationship:o};e.get(n).parents.push(i),e.has(r)||e.set(r,{parents:[],children:[]});const s={ID:n,relationship:o};e.get(r).children.push(s)})),e}parseImages(){const e={},t={};if("Video"in ua.Objects){const n=ua.Objects.Video;for(const r in n){const o=n[r];if(e[parseInt(r)]=o.RelativeFilename||o.Filename,"Content"in o){const e=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,i="string"==typeof o.Content&&""!==o.Content;if(e||i){const e=this.parseImage(n[r]);t[o.RelativeFilename||o.Filename]=e}}}}for(const n in e){const r=e[n];void 0!==t[r]?e[n]=t[r]:e[n]=e[n].split("\\").pop()}return e}parseImage(e){const t=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let o;switch(r){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),o="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+o+";base64,"+t;{const e=new Uint8Array(t);return window.URL.createObjectURL(new Blob([e],{type:o}))}}parseTextures(e){const t=new Map;if("Texture"in ua.Objects){const n=ua.Objects.Texture;for(const r in n){const o=this.parseTexture(n[r],e);t.set(parseInt(r),o)}}return t}parseTexture(e,t){const n=this.loadTexture(e,t);n.ID=e.id,n.name=e.attrName;const r=e.WrapModeU,o=e.WrapModeV,i=void 0!==r?r.value:0,s=void 0!==o?o.value:0;if(n.wrapS=0===i?ze:je,n.wrapT=0===s?ze:je,"Scaling"in e){const t=e.Scaling.value;n.repeat.x=t[0],n.repeat.y=t[1]}return n}loadTexture(e,t){let n;const r=this.textureLoader.path,o=ha.get(e.id).children;let i;void 0!==o&&o.length>0&&void 0!==t[o[0].ID]&&(n=t[o[0].ID],(0===n.indexOf("blob:")||0===n.indexOf("data:"))&&this.textureLoader.setPath(void 0));const s=e.FileName.slice(-3).toLowerCase();if("tga"===s){const t=this.manager.getHandler(".tga");null===t?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),i=new Be):(t.setPath(this.textureLoader.path),i=t.load(n))}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),i=new Be):i=this.textureLoader.load(n);return this.textureLoader.setPath(r),i}parseMaterials(e){const t=new Map;if("Material"in ua.Objects){const n=ua.Objects.Material;for(const r in n){const o=this.parseMaterial(n[r],e);null!==o&&t.set(parseInt(r),o)}}return t}parseMaterial(e,t){const n=e.id,r=e.attrName;let o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!ha.has(n))return null;const i=this.parseParameters(e,t,n);let s;switch(o.toLowerCase()){case"phong":s=new He;break;case"lambert":s=new Ve;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),s=new He}return s.setValues(i),s.name=r,s}parseParameters(e,t,n){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new y).fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=(new y).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new y).fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=(new y).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new y).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new y).fromArray(e.SpecularColor.value));const o=this;return ha.get(n).children.forEach((function(e){const n=e.relationship;switch(n){case"Bump":r.bumpMap=o.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":r.aoMap=o.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=o.getTexture(t,e.ID),void 0!==r.map&&("colorSpace"in r.map?r.map.colorSpace="srgb":r.map.encoding=3001);break;case"DisplacementColor":r.displacementMap=o.getTexture(t,e.ID);break;case"EmissiveColor":r.emissiveMap=o.getTexture(t,e.ID),void 0!==r.emissiveMap&&("colorSpace"in r.emissiveMap?r.emissiveMap.colorSpace="srgb":r.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=o.getTexture(t,e.ID);break;case"ReflectionColor":r.envMap=o.getTexture(t,e.ID),void 0!==r.envMap&&(r.envMap.mapping=Re,"colorSpace"in r.envMap?r.envMap.colorSpace="srgb":r.envMap.encoding=3001);break;case"SpecularColor":r.specularMap=o.getTexture(t,e.ID),void 0!==r.specularMap&&("colorSpace"in r.specularMap?r.specularMap.colorSpace="srgb":r.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=o.getTexture(t,e.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n)}})),r}getTexture(e,t){return"LayeredTexture"in ua.Objects&&t in ua.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=ha.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in ua.Objects){const n=ua.Objects.Deformer;for(const r in n){const o=n[r],i=ha.get(parseInt(r));if("Skin"===o.attrType){const t=this.parseSkeleton(i,n);t.ID=r,i.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),t.geometryID=i.parents[0].ID,e[r]=t}else if("BlendShape"===o.attrType){const e={id:r};e.rawTargets=this.parseMorphTargets(i,n),e.id=r,i.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=e}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const n=[];return e.children.forEach((function(e){const r=t[e.ID];if("Cluster"!==r.attrType)return;const o={ID:e.ID,indices:[],weights:[],transformLink:(new q).fromArray(r.TransformLink.a)};"Indexes"in r&&(o.indices=r.Indexes.a,o.weights=r.Weights.a),n.push(o)})),{rawBones:n,bones:[]}}parseMorphTargets(e,t){const n=[];for(let r=0;r<e.children.length;r++){const o=e.children[r],i=t[o.ID],s={name:i.attrName,initialWeight:i.DeformPercent,id:i.id,fullWeights:i.FullWeights.a};if("BlendShapeChannel"!==i.attrType)return;s.geoID=ha.get(parseInt(o.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,n.push(s)}return n}parseScene(e,t,n){da=new De;const r=this.parseModels(e.skeletons,t,n),o=ua.Objects.Model,i=this;r.forEach((function(e){const t=o[e.ID];i.setLookAtProperties(e,t),ha.get(e.ID).parents.forEach((function(t){const n=r.get(t.ID);void 0!==n&&n.add(e)})),null===e.parent&&da.add(e)})),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),da.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);const t=Sa(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));const s=(new ga).parse();1===da.children.length&&da.children[0].isGroup&&(da.children[0].animations=s,da=da.children[0]),da.animations=s}parseModels(e,t,n){const r=new Map,o=ua.Objects.Model;for(const i in o){const s=parseInt(i),a=o[i],l=ha.get(s);let c=this.buildSkeleton(l,e,s,a.attrName);if(!c){switch(a.attrType){case"Camera":c=this.createCamera(l);break;case"Light":c=this.createLight(l);break;case"Mesh":c=this.createMesh(l,t,n);break;case"NurbsCurve":c=this.createCurve(l,t);break;case"LimbNode":case"Root":c=new Ye;break;default:c=new De}c.name=a.attrName?he.sanitizeNodeName(a.attrName):"",c.ID=s}this.getTransformData(c,a),r.set(s,c)}return r}buildSkeleton(e,t,n,r){let o=null;return e.parents.forEach((function(e){for(const i in t){const s=t[i];s.rawBones.forEach((function(t,i){if(t.ID===e.ID){const e=o;o=new Ye,o.matrixWorld.copy(t.transformLink),o.name=r?he.sanitizeNodeName(r):"",o.ID=n,s.bones[i]=o,null!==e&&o.add(e)}}))}})),o}createCamera(e){let t,n;if(e.children.forEach((function(e){const t=ua.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new F;else{let e=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(e=1);let r=1;void 0!==n.NearPlane&&(r=n.NearPlane.value/1e3);let o=1e3;void 0!==n.FarPlane&&(o=n.FarPlane.value/1e3);let i=window.innerWidth,s=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(i=n.AspectWidth.value,s=n.AspectHeight.value);const a=i/s;let l=45;void 0!==n.FieldOfView&&(l=n.FieldOfView.value);const c=n.FocalLength?n.FocalLength.value:null;switch(e){case 0:t=new f(l,a,r,o),null!==c&&t.setFocalLength(c);break;case 1:t=new _e(-i/2,i/2,s/2,-s/2,r,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+e+"."),t=new F}}return t}createLight(e){let t,n;if(e.children.forEach((function(e){const t=ua.Objects.NodeAttribute[e.ID];void 0!==t&&(n=t)})),void 0===n)t=new F;else{let e;e=void 0===n.LightType?0:n.LightType.value;let r=16777215;void 0!==n.Color&&(r=(new y).fromArray(n.Color.value));let o=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(o=0);let i=0;void 0!==n.FarAttenuationEnd&&(i=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const s=1;switch(e){case 0:t=new ot(r,o,i,s);break;case 1:t=new it(r,o);break;case 2:let e=Math.PI/3;void 0!==n.InnerAngle&&(e=b.degToRad(n.InnerAngle.value));let a=0;void 0!==n.OuterAngle&&(a=b.degToRad(n.OuterAngle.value),a=Math.max(a,1)),t=new rt(r,o,i,e,a,s);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),t=new ot(r,o)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,n){let r,o=null,i=null;const s=[];return e.children.forEach((function(e){t.has(e.ID)&&(o=t.get(e.ID)),n.has(e.ID)&&s.push(n.get(e.ID))})),s.length>1?i=s:s.length>0?i=s[0]:(i=new He({color:13421772}),s.push(i)),"color"in o.attributes&&s.forEach((function(e){e.vertexColors=!0})),o.FBX_Deformer?(r=new Xe(o,i),r.normalizeSkinWeights()):r=new E(o,i),r}createCurve(e,t){const n=e.children.reduce((function(e,n){return t.has(n.ID)&&(e=t.get(n.ID)),e}),null),r=new T({color:3342591,linewidth:1});return new _(n,r)}getTransformData(e,t){const n={};"InheritType"in t&&(n.inheritType=parseInt(t.InheritType.value)),n.eulerOrder="RotationOrder"in t?Oa(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(n.translation=t.Lcl_Translation.value),"PreRotation"in t&&(n.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(n.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(n.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(n.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(n.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(n.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(n.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(n.rotationPivot=t.RotationPivot.value),e.userData.transformData=n}setLookAtProperties(e,t){"LookAtProperty"in t&&ha.get(e.ID).children.forEach((function(t){if("LookAtProperty"===t.relationship){const n=ua.Objects.Model[t.ID];if("Lcl_Translation"in n){const t=n.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(t),da.add(e.target)):e.lookAt((new z).fromArray(t))}}}))}bindSkeleton(e,t,n){const r=this.parsePoseNodes();for(const o in e){const i=e[o];ha.get(parseInt(i.ID)).parents.forEach((function(e){if(t.has(e.ID)){const t=e.ID;ha.get(t).parents.forEach((function(e){n.has(e.ID)&&n.get(e.ID).bind(new Ge(i.bones),r[e.ID])}))}}))}}parsePoseNodes(){const e={};if("Pose"in ua.Objects){const t=ua.Objects.Pose;for(const n in t)if("BindPose"===t[n].attrType&&t[n].NbPoseNodes>0){const r=t[n].PoseNode;Array.isArray(r)?r.forEach((function(t){e[t.Node]=(new q).fromArray(t.Matrix.a)})):e[r.Node]=(new q).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in ua&&"AmbientColor"in ua.GlobalSettings){const e=ua.GlobalSettings.AmbientColor.value,t=e[0],n=e[1],r=e[2];if(0!==t||0!==n||0!==r){const e=new y(t,n,r);da.add(new We(e,1))}}}}class fa{parse(e){const t=new Map;if("Geometry"in ua.Objects){const n=ua.Objects.Geometry;for(const r in n){const o=ha.get(parseInt(r)),i=this.parseGeometry(o,n[r],e);t.set(parseInt(r),i)}}return t}parseGeometry(e,t,n){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,n);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,n){const r=n.skeletons,o=[],i=e.parents.map((function(e){return ua.Objects.Model[e.ID]}));if(0===i.length)return;const s=e.children.reduce((function(e,t){return void 0!==r[t.ID]&&(e=r[t.ID]),e}),null);e.children.forEach((function(e){void 0!==n.morphTargets[e.ID]&&o.push(n.morphTargets[e.ID])}));const a=i[0],l={};"RotationOrder"in a&&(l.eulerOrder=Oa(a.RotationOrder.value)),"InheritType"in a&&(l.inheritType=parseInt(a.InheritType.value)),"GeometricTranslation"in a&&(l.translation=a.GeometricTranslation.value),"GeometricRotation"in a&&(l.rotation=a.GeometricRotation.value),"GeometricScaling"in a&&(l.scale=a.GeometricScaling.value);const c=Sa(l);return this.genGeometry(t,s,o,c)}genGeometry(e,t,n,r){const o=new w;e.attrName&&(o.name=e.attrName);const i=this.parseGeoNode(e,t),s=this.genBuffers(i),a=new x(s.vertex,3);if(a.applyMatrix4(r),o.setAttribute("position",a),s.colors.length>0&&o.setAttribute("color",new x(s.colors,3)),t&&(o.setAttribute("skinIndex",new Ze(s.weightsIndices,4)),o.setAttribute("skinWeight",new x(s.vertexWeights,4)),o.FBX_Deformer=t),s.normal.length>0){const e=(new Ke).getNormalMatrix(r),t=new x(s.normal,3);t.applyNormalMatrix(e),o.setAttribute("normal",t)}if(s.uvs.forEach((function(e,t){"uv2"===Jo&&t++;const n=0===t?"uv":"uv".concat(t);o.setAttribute(n,new x(s.uvs[t],2))})),i.material&&"AllSame"!==i.material.mappingType){let e=s.materialIndex[0],t=0;if(s.materialIndex.forEach((function(n,r){n!==e&&(o.addGroup(t,r-t,e),e=n,t=r)})),o.groups.length>0){const t=o.groups[o.groups.length-1],n=t.start+t.count;n!==s.materialIndex.length&&o.addGroup(n,s.materialIndex.length-n,e)}0===o.groups.length&&o.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(o,e,n,r),o}parseGeoNode(e,t){const n={};if(n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(n.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(n.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){n.uv=[];let t=0;for(;e.LayerElementUV[t];)e.LayerElementUV[t].UV&&n.uv.push(this.parseUVs(e.LayerElementUV[t])),t++}return n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(r,o){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:t,weight:e.weights[o]})}))}))),n}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,o=!1,i=[],s=[],a=[],l=[],c=[],u=[];const h=this;return e.vertexIndices.forEach((function(d,p){let m,f=!1;d<0&&(d=~d,f=!0);let g=[],v=[];if(i.push(3*d,3*d+1,3*d+2),e.color){const t=Ea(p,n,d,e.color);a.push(t[0],t[1],t[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach((function(e){v.push(e.weight),g.push(e.id)})),v.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const e=[0,0,0,0],t=[0,0,0,0];v.forEach((function(n,r){let o=n,i=g[r];t.forEach((function(t,n,r){if(o>t){r[n]=o,o=t;const s=e[n];e[n]=i,i=s}}))})),g=e,v=t}for(;v.length<4;)v.push(0),g.push(0);for(let e=0;e<4;++e)c.push(v[e]),u.push(g[e])}if(e.normal){const t=Ea(p,n,d,e.normal);s.push(t[0],t[1],t[2])}e.material&&"AllSame"!==e.material.mappingType&&(m=Ea(p,n,d,e.material)[0]),e.uv&&e.uv.forEach((function(e,t){const r=Ea(p,n,d,e);void 0===l[t]&&(l[t]=[]),l[t].push(r[0]),l[t].push(r[1])})),r++,f&&(h.genFace(t,e,i,m,s,a,l,c,u,r),n++,r=0,i=[],s=[],a=[],l=[],c=[],u=[])})),t}genFace(e,t,n,r,o,i,s,a,l,c){for(let u=2;u<c;u++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(u-1)]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[n[3*u]]),e.vertex.push(t.vertexPositions[n[3*u+1]]),e.vertex.push(t.vertexPositions[n[3*u+2]]),t.skeleton&&(e.vertexWeights.push(a[0]),e.vertexWeights.push(a[1]),e.vertexWeights.push(a[2]),e.vertexWeights.push(a[3]),e.vertexWeights.push(a[4*(u-1)]),e.vertexWeights.push(a[4*(u-1)+1]),e.vertexWeights.push(a[4*(u-1)+2]),e.vertexWeights.push(a[4*(u-1)+3]),e.vertexWeights.push(a[4*u]),e.vertexWeights.push(a[4*u+1]),e.vertexWeights.push(a[4*u+2]),e.vertexWeights.push(a[4*u+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(u-1)]),e.weightsIndices.push(l[4*(u-1)+1]),e.weightsIndices.push(l[4*(u-1)+2]),e.weightsIndices.push(l[4*(u-1)+3]),e.weightsIndices.push(l[4*u]),e.weightsIndices.push(l[4*u+1]),e.weightsIndices.push(l[4*u+2]),e.weightsIndices.push(l[4*u+3])),t.color&&(e.colors.push(i[0]),e.colors.push(i[1]),e.colors.push(i[2]),e.colors.push(i[3*(u-1)]),e.colors.push(i[3*(u-1)+1]),e.colors.push(i[3*(u-1)+2]),e.colors.push(i[3*u]),e.colors.push(i[3*u+1]),e.colors.push(i[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(o[0]),e.normal.push(o[1]),e.normal.push(o[2]),e.normal.push(o[3*(u-1)]),e.normal.push(o[3*(u-1)+1]),e.normal.push(o[3*(u-1)+2]),e.normal.push(o[3*u]),e.normal.push(o[3*u+1]),e.normal.push(o[3*u+2])),t.uv&&t.uv.forEach((function(t,n){void 0===e.uvs[n]&&(e.uvs[n]=[]),e.uvs[n].push(s[n][0]),e.uvs[n].push(s[n][1]),e.uvs[n].push(s[n][2*(u-1)]),e.uvs[n].push(s[n][2*(u-1)+1]),e.uvs[n].push(s[n][2*u]),e.uvs[n].push(s[n][2*u+1])}))}addMorphTargets(e,t,n,r){if(0===n.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const i=ua.Objects.Geometry[n.geoID];void 0!==i&&o.genMorphGeometry(e,t,i,r,n.name)}))}))}genMorphGeometry(e,t,n,r,o){const i=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==n.Vertices?n.Vertices.a:[],a=void 0!==n.Indexes?n.Indexes.a:[],l=3*e.attributes.position.count,c=new Float32Array(l);for(let p=0;p<a.length;p++){const e=3*a[p];c[e]=s[3*p],c[e+1]=s[3*p+1],c[e+2]=s[3*p+2]}const u={vertexIndices:i,vertexPositions:c},h=this.genBuffers(u),d=new x(h.vertex,3);d.name=o||n.attrName,d.applyMatrix4(r),e.morphAttributes.position.push(d)}parseNormals(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a;let o=[];return"IndexToDirect"===n&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:o,mappingType:t,referenceType:n}}parseUVs(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a;let o=[];return"IndexToDirect"===n&&(o=e.UVIndex.a),{dataSize:2,buffer:r,indices:o,mappingType:t,referenceType:n}}parseVertexColors(e){const t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a;let o=[];return"IndexToDirect"===n&&(o=e.ColorIndex.a),{dataSize:4,buffer:r,indices:o,mappingType:t,referenceType:n}}parseMaterialIndices(e){const t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=e.Materials.a,o=[];for(let i=0;i<r.length;++i)o.push(i);return{dataSize:1,buffer:r,indices:o,mappingType:t,referenceType:n}}parseNurbsGeometry(e){if(void 0===ca)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new w;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new w;const n=t-1,r=e.KnotVector.a,o=[],i=e.Points.a;for(let c=0,u=i.length;c<u;c+=4)o.push((new re).fromArray(i,c));let s,a;if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){s=n,a=r.length-1-s;for(let e=0;e<n;++e)o.push(o[e])}const l=new ca(n,r,o,s,a).getPoints(12*o.length);return(new w).setFromPoints(l)}}class ga{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const n in t){const r=t[n],o=this.addClip(r);e.push(o)}return e}parseClips(){if(void 0===ua.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=ua.Objects.AnimationCurveNode,t=new Map;for(const n in e){const r=e[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const e={id:r.id,attr:r.attrName,curves:{}};t.set(e.id,e)}}return t}parseAnimationCurves(e){const t=ua.Objects.AnimationCurve;for(const n in t){const r={id:t[n].id,times:t[n].KeyTime.a.map(xa),values:t[n].KeyValueFloat.a},o=ha.get(r.id);if(void 0!==o){const t=o.parents[0].ID,n=o.parents[0].relationship;n.match(/X/)?e.get(t).curves.x=r:n.match(/Y/)?e.get(t).curves.y=r:n.match(/Z/)?e.get(t).curves.z=r:n.match(/d|DeformPercent/)&&e.has(t)&&(e.get(t).curves.morph=r)}}}parseAnimationLayers(e){const t=ua.Objects.AnimationLayer,n=new Map;for(const r in t){const t=[],o=ha.get(parseInt(r));void 0!==o&&(o.children.forEach((function(n,r){if(e.has(n.ID)){const o=e.get(n.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===t[r]){const e=ha.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID;if(void 0!==e){const o=ua.Objects.Model[e.toString()];if(void 0===o)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const i={modelName:o.attrName?he.sanitizeNodeName(o.attrName):"",ID:o.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};da.traverse((function(e){e.ID===o.id&&(i.transform=e.matrix,e.userData.transformData&&(i.eulerOrder=e.userData.transformData.eulerOrder))})),i.transform||(i.transform=new q),"PreRotation"in o&&(i.preRotation=o.PreRotation.value),"PostRotation"in o&&(i.postRotation=o.PostRotation.value),t[r]=i}}t[r]&&(t[r][o.attr]=o)}else if(void 0!==o.curves.morph){if(void 0===t[r]){const e=ha.get(n.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,o=ha.get(e).parents[0].ID,i=ha.get(o).parents[0].ID,s=ha.get(i).parents[0].ID,a=ua.Objects.Model[s],l={modelName:a.attrName?he.sanitizeNodeName(a.attrName):"",morphName:ua.Objects.Deformer[e].attrName};t[r]=l}t[r][o.attr]=o}}})),n.set(parseInt(r),t))}return n}parseAnimStacks(e){const t=ua.Objects.AnimationStack,n={};for(const r in t){const o=ha.get(parseInt(r)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const i=e.get(o[0].ID);n[r]={name:t[r].attrName,layer:i}}return n}addClip(e){let t=[];const n=this;return e.layer.forEach((function(e){t=t.concat(n.generateTracks(e))})),new qe(e.name,-1,t)}generateTracks(e){const t=[];let n=new z,r=new ee,o=new z;if(e.transform&&e.transform.decompose(n,r,o),n=n.toArray(),r=(new Y).setFromQuaternion(r,e.eulerOrder).toArray(),o=o.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.T.curves,n,"position");void 0!==r&&t.push(r)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const n=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==n&&t.push(n)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const n=this.generateVectorTrack(e.modelName,e.S.curves,o,"scale");void 0!==n&&t.push(n)}if(void 0!==e.DeformPercent){const n=this.generateMorphTrack(e);void 0!==n&&t.push(n)}return t}generateVectorTrack(e,t,n,r){const o=this.getTimesForAllAxes(t),i=this.getKeyframeTrackValues(o,t,n);return new Qe(e+"."+r,o,i)}generateRotationTrack(e,t,n,r,o,i){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(b.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(b.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(b.degToRad));const s=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(s,t,n);void 0!==r&&((r=r.map(b.degToRad)).push(i),r=(new Y).fromArray(r),r=(new ee).setFromEuler(r)),void 0!==o&&((o=o.map(b.degToRad)).push(i),o=(new Y).fromArray(o),o=(new ee).setFromEuler(o).invert());const l=new ee,c=new Y,u=[];for(let h=0;h<a.length;h+=3)c.set(a[h],a[h+1],a[h+2],i),l.setFromEuler(c),void 0!==r&&l.premultiply(r),void 0!==o&&l.multiply(o),l.toArray(u,h/3*4);return new $e(e+".quaternion",s,u)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,n=t.values.map((function(e){return e/100})),r=da.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Je(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort((function(e,t){return e-t})),t.length>1){let e=1,n=t[0];for(let r=1;r<t.length;r++){const o=t[r];o!==n&&(t[e]=o,n=o,e++)}t=t.slice(0,e)}return t}getKeyframeTrackValues(e,t,n){const r=n,o=[];let i=-1,s=-1,a=-1;return e.forEach((function(e){if(t.x&&(i=t.x.times.indexOf(e)),t.y&&(s=t.y.times.indexOf(e)),t.z&&(a=t.z.times.indexOf(e)),-1!==i){const e=t.x.values[i];o.push(e),r[0]=e}else o.push(r[0]);if(-1!==s){const e=t.y.values[s];o.push(e),r[1]=e}else o.push(r[1]);if(-1!==a){const e=t.z.values[a];o.push(e),r[2]=e}else o.push(r[2])})),o}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const n=e.values[t-1],r=e.values[t]-n,o=Math.abs(r);if(o>=180){const i=o/180,s=r/i;let a=n+s;const l=e.times[t-1],c=(e.times[t]-l)/i;let u=l+c;const h=[],d=[];for(;u<e.times[t];)h.push(u),u+=c,d.push(a),a+=s;e.times=Pa(e.times,t,h),e.values=Pa(e.values,t,d)}}}}class va{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new _a,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,n=e.split(/[\r\n]+/);return n.forEach((function(e,r){const o=e.match(/^[\s\t]*;/),i=e.match(/^[\s\t]*$/);if(o||i)return;const s=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),a=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");s?t.parseNodeBegin(e,s):a?t.parseNodeProperty(e,a,n[++r]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)})),this.allNodes}parseNodeBegin(e,t){const n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),o={name:n},i=this.parseNodeAttr(r),s=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,o):n in s?("PoseNode"===n?s.PoseNode.push(o):void 0!==s[n].id&&(s[n]={},s[n][s[n].id]=s[n]),""!==i.id&&(s[n][i.id]=o)):"number"==typeof i.id?(s[n]={},s[n][i.id]=o):"Properties70"!==n&&(s[n]="PoseNode"===n?[o]:o),"number"==typeof i.id&&(o.id=i.id),""!==i.name&&(o.attrName=i.name),""!==i.type&&(o.attrType=i.type),this.pushStack(o)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}}parseNodeProperty(e,t,n){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),o=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===o&&(o=n.replace(/"/g,"").replace(/,$/,"").trim());const i=this.getCurrentNode();if("Properties70"!==i.name){if("C"===r){const e=o.split(",").slice(1),t=parseInt(e[0]),n=parseInt(e[1]);let s=o.split(",").slice(3);s=s.map((function(e){return e.trim().replace(/^"/,"")})),r="connections",o=[t,n],function(e,t){for(let n=0,r=e.length,o=t.length;n<o;n++,r++)e[r]=t[n]}(o,s),void 0===i[r]&&(i[r]=[])}"Node"===r&&(i.id=o),r in i&&Array.isArray(i[r])?i[r].push(o):"a"!==r?i[r]=o:i.a=o,this.setCurrentProp(i,r),"a"===r&&","!==o.slice(-1)&&(i.a=Ca(o))}else this.parseNodeSpecialProperty(e,r,o)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=Ca(t.a))}parseNodeSpecialProperty(e,t,n){const r=n.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),o=r[0],i=r[1],s=r[2],a=r[3];let l=r[4];switch(i){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=Ca(l)}this.getPrevNode()[o]={type:i,type2:s,flag:a,value:l},this.setCurrentProp(this.getPrevNode(),o)}}class ya{parse(e){const t=new ba(e);t.skip(23);const n=t.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new _a;for(;!this.endOfContent(t);){const e=this.parseNode(t,n);null!==e&&r.add(e.name,e)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const n={},r=t>=7500?e.getUint64():e.getUint32(),o=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const i=e.getUint8(),s=e.getString(i);if(0===r)return null;const a=[];for(let h=0;h<o;h++)a.push(this.parseProperty(e));const l=a.length>0?a[0]:"",c=a.length>1?a[1]:"",u=a.length>2?a[2]:"";for(n.singleProperty=1===o&&e.getOffset()===r;r>e.getOffset();){const r=this.parseNode(e,t);null!==r&&this.parseSubNode(s,n,r)}return n.propertyList=a,"number"==typeof l&&(n.id=l),""!==c&&(n.attrName=c),""!==u&&(n.attrType=u),""!==s&&(n.name=s),n}parseSubNode(e,t,n){if(!0===n.singleProperty){const e=n.propertyList[0];Array.isArray(e)?(t[n.name]=n,n.a=e):t[n.name]=e}else if("Connections"===e&&"C"===n.name){const e=[];n.propertyList.forEach((function(t,n){0!==n&&e.push(t)})),void 0===t.connections&&(t.connections=[]),t.connections.push(e)}else if("Properties70"===n.name)Object.keys(n).forEach((function(e){t[e]=n[e]}));else if("Properties70"===e&&"P"===n.name){let e=n.propertyList[0],r=n.propertyList[1];const o=n.propertyList[2],i=n.propertyList[3];let s;0===e.indexOf("Lcl ")&&(e=e.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),s="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[e]={type:r,type2:o,flag:i,value:s}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)}parseProperty(e){const t=e.getString(1);let n;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return n=e.getUint32(),e.getArrayBuffer(n);case"S":return n=e.getUint32(),e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),o=e.getUint32(),i=e.getUint32();if(0===o)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const s=function(e,t){return Ts((function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"}(e),e.subarray(2,-4)),t)}(new Uint8Array(e.getArrayBuffer(i))),a=new ba(s.buffer);switch(t){case"b":case"c":return a.getBooleanArray(r);case"d":return a.getFloat64Array(r);case"f":return a.getFloat32Array(r);case"i":return a.getInt32Array(r);case"l":return a.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class ba{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return!(1&~this.getUint8())}getBooleanArray(e){const t=[];for(let n=0;n<e;n++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let n=0;n<e;n++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),na(new Uint8Array(t))}}class _a{add(e,t){this[e]=t}}function wa(e){const t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function xa(e){return e/46186158e3}const Ta=[];function Ea(e,t,n,r){let o;switch(r.mappingType){case"ByPolygonVertex":o=e;break;case"ByPolygon":o=t;break;case"ByVertice":o=n;break;case"AllSame":o=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(o=r.indices[o]);const i=o*r.dataSize,s=i+r.dataSize;return function(e,t,n,r){for(let o=n,i=0;o<r;o++,i++)e[i]=t[o];return e}(Ta,r.buffer,i,s)}const Ma=new Y,Aa=new z;function Sa(e){const t=new q,n=new q,r=new q,o=new q,i=new q,s=new q,a=new q,l=new q,c=new q,u=new q,h=new q,d=new q,p=e.inheritType?e.inheritType:0;if(e.translation&&t.setPosition(Aa.fromArray(e.translation)),e.preRotation){const t=e.preRotation.map(b.degToRad);t.push(e.eulerOrder),n.makeRotationFromEuler(Ma.fromArray(t))}if(e.rotation){const t=e.rotation.map(b.degToRad);t.push(e.eulerOrder),r.makeRotationFromEuler(Ma.fromArray(t))}if(e.postRotation){const t=e.postRotation.map(b.degToRad);t.push(e.eulerOrder),o.makeRotationFromEuler(Ma.fromArray(t)),o.invert()}e.scale&&i.scale(Aa.fromArray(e.scale)),e.scalingOffset&&a.setPosition(Aa.fromArray(e.scalingOffset)),e.scalingPivot&&s.setPosition(Aa.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(Aa.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(Aa.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(h.copy(e.parentMatrix),u.copy(e.parentMatrixWorld));const m=n.clone().multiply(r).multiply(o),f=new q;f.extractRotation(u);const g=new q;g.copyPosition(u);const v=g.clone().invert().multiply(u),y=f.clone().invert().multiply(v),_=i,w=new q;if(0===p)w.copy(f).multiply(m).multiply(y).multiply(_);else if(1===p)w.copy(f).multiply(y).multiply(m).multiply(_);else{const e=(new q).scale((new z).setFromMatrixScale(h)).clone().invert(),t=y.clone().multiply(e);w.copy(f).multiply(m).multiply(t).multiply(_)}const x=c.clone().invert(),T=s.clone().invert();let E=t.clone().multiply(l).multiply(c).multiply(n).multiply(r).multiply(o).multiply(x).multiply(a).multiply(s).multiply(i).multiply(T);const M=(new q).copyPosition(E),A=u.clone().multiply(M);return d.copyPosition(A),E=d.clone().multiply(w),E.premultiply(u.invert()),E}function Oa(e){const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function Ca(e){return e.split(",").map((function(e){return parseFloat(e)}))}function Ia(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.byteLength),na(new Uint8Array(e,t,n))}function Pa(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))}var Ra=Object.defineProperty,La=(e,t,n)=>(((e,t,n)=>{t in e?Ra(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class ka extends xe{constructor(e){super(e)}load(e,t,n,r){const o=new Te(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(e=>{if("string"!=typeof e)throw new Error("unsupported data type");const n=JSON.parse(e),r=this.parse(n);t&&t(r)}),n,r)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new Da(e)}}class Da{constructor(e){La(this,"data"),this.data=e}generateShapes(e,t=100,n){const r=[],o=a({letterSpacing:0,lineHeight:1},n),i=function(e,t,n,r){const o=Array.from(e),i=t/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[];let l=0,c=0;for(let u=0;u<o.length;u++){const e=o[u];if("\n"===e)l=0,c-=s*r.lineHeight;else{const t=Ua(e,i,l,c,n);t&&(l+=t.offsetX+r.letterSpacing,a.push(t.path))}}return a}(e,t,this.data,o);for(let s=0,a=i.length;s<a;s++)Array.prototype.push.apply(r,i[s].toShapes(!1));return r}}function Ua(e,t,n,r,o){const i=o.glyphs[e]||o.glyphs["?"];if(!i)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+o.familyName+".");const s=new Ee;let a,l,c,u,h,d,p,m;if(i.o){const e=i._cachedOutline||(i._cachedOutline=i.o.split(" "));for(let o=0,i=e.length;o<i;)switch(e[o++]){case"m":a=parseInt(e[o++])*t+n,l=parseInt(e[o++])*t+r,s.moveTo(a,l);break;case"l":a=parseInt(e[o++])*t+n,l=parseInt(e[o++])*t+r,s.lineTo(a,l);break;case"q":c=parseInt(e[o++])*t+n,u=parseInt(e[o++])*t+r,h=parseInt(e[o++])*t+n,d=parseInt(e[o++])*t+r,s.quadraticCurveTo(h,d,c,u);break;case"b":c=parseInt(e[o++])*t+n,u=parseInt(e[o++])*t+r,h=parseInt(e[o++])*t+n,d=parseInt(e[o++])*t+r,p=parseInt(e[o++])*t+n,m=parseInt(e[o++])*t+r,s.bezierCurveTo(h,d,p,m,c,u)}}return{offsetX:i.ha*t,path:s}}La(Da,"isFont"),La(Da,"type");class Fa extends et{constructor(e){super(e),this.type=le}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,n){t=t||1024;let r=e.pos,o=-1,i=0,s="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(o=a.indexOf("\n"))&&i<t&&r<e.byteLength;)s+=a,i+=a.length,r+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<o&&(e.pos+=i+o+1,s+a.slice(0,o))},r=function(e,t,n,r){const o=e[t+3],i=Math.pow(2,o-128)/255;n[r+0]=e[t+0]*i,n[r+1]=e[t+1]*i,n[r+2]=e[t+2]*i,n[r+3]=1},o=function(e,t,n,r){const o=e[t+3],i=Math.pow(2,o-128)/255;n[r+0]=xt.toHalfFloat(Math.min(e[t+0]*i,65504)),n[r+1]=xt.toHalfFloat(Math.min(e[t+1]*i,65504)),n[r+2]=xt.toHalfFloat(Math.min(e[t+2]*i,65504)),n[r+3]=xt.toHalfFloat(1)},i=new Uint8Array(e);i.pos=0;const s=function(e){const r=/^#\?(\S+)/,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let c,u;for((e.pos>=e.byteLength||!(c=n(e)))&&t(1,"no header found"),(u=c.match(r))||t(3,"bad initial token"),l.valid|=1,l.programtype=u[1],l.string+=c+"\n";c=n(e),!1!==c;)if(l.string+=c+"\n","#"!==c.charAt(0)){if((u=c.match(o))&&(l.gamma=parseFloat(u[1])),(u=c.match(i))&&(l.exposure=parseFloat(u[1])),(u=c.match(s))&&(l.valid|=2,l.format=u[1]),(u=c.match(a))&&(l.valid|=4,l.height=parseInt(u[1],10),l.width=parseInt(u[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=c+"\n";return 2&l.valid||t(3,"missing format specifier"),4&l.valid||t(3,"missing image size specifier"),l}(i),a=s.width,l=s.height,c=function(e,n,r){const o=n;if(o<8||o>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);o!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const i=new Uint8Array(4*n*r);i.length||t(4,"unable to allocate buffer space");let s=0,a=0;const l=4*o,c=new Uint8Array(4),u=new Uint8Array(l);let h=r;for(;h>0&&a<e.byteLength;){a+4>e.byteLength&&t(1),c[0]=e[a++],c[1]=e[a++],c[2]=e[a++],c[3]=e[a++],(2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=o)&&t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&a<e.byteLength;){n=e[a++];const o=n>128;if(o&&(n-=128),(0===n||r+n>l)&&t(3,"bad scanline data"),o){const t=e[a++];for(let e=0;e<n;e++)u[r++]=t}else u.set(e.subarray(a,a+n),r),r+=n,a+=n}const d=o;for(let e=0;e<d;e++){let t=0;i[s]=u[e+t],t+=o,i[s+1]=u[e+t],t+=o,i[s+2]=u[e+t],t+=o,i[s+3]=u[e+t],s+=4}h--}return i}(i.subarray(i.pos),a,l);let u,h,d;switch(this.type){case tt:d=c.length/4;const e=new Float32Array(4*d);for(let n=0;n<d;n++)r(c,4*n,e,4*n);u=e,h=tt;break;case le:d=c.length/4;const t=new Uint16Array(4*d);for(let n=0;n<d;n++)o(c,4*n,t,4*n);u=t,h=le;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:a,height:l,data:u,header:s.string,gamma:s.gamma,exposure:s.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,(function(e,n){switch(e.type){case tt:case le:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=ut,e.magFilter=ut,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),n,r)}}const Na=new WeakMap;class za extends xe{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const o=new Te(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(r)}),n,r)}decodeDracoFile(e,t,n,r){const o={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,o).then(t)}decodeGeometry(e,t){for(const a in t.attributeTypes){const e=t.attributeTypes[a];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[a]=e.name)}const n=JSON.stringify(t);if(Na.has(e)){const t=Na.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const o=this.workerNextTaskID++,i=e.byteLength,s=this._getWorker(o,i).then((n=>(r=n,new Promise(((n,i)=>{r._callbacks[o]={resolve:n,reject:i},r.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return s.catch((()=>!0)).then((()=>{r&&o&&this._releaseTask(r,o)})),Na.set(e,{key:n,promise:s}),s}_createGeometry(e){const t=new w;e.index&&t.setIndex(new U(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],o=r.name,i=r.array,s=r.itemSize;t.setAttribute(o,new U(i,s))}return t}_loadLibrary(e,t){const n=new Te(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,r)=>{n.load(e,t,void 0,r)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=ja.toString(),o=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function ja(){let e,t;function n(e,t,n,r,o,i){const s=i.num_components(),a=n.num_points()*s,l=a*o.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,o),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,i,c,l,u);const h=new o(e.HEAPF32.buffer,u,a).slice();return e._free(u),{name:r,array:h,itemSize:s}}onmessage=function(r){const o=r.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const r=o.buffer,i=o.taskConfig;t.then((e=>{const t=e.draco,s=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(r),r.byteLength);try{const e=function(e,t,r,o){const i=o.attributeIDs,s=o.attributeTypes;let a,l;const c=t.GetEncodedGeometryType(r);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,l=t.DecodeBufferToMesh(r,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,l=t.DecodeBufferToPointCloud(r,a)}if(!l.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const u={index:null,attributes:[]};for(const h in i){const r=self[s[h]];let l,c;if(o.useUniqueIDs)c=i[h],l=t.GetAttributeByUniqueId(a,c);else{if(c=t.GetAttributeId(a,e[i[h]]),-1===c)continue;l=t.GetAttribute(a,c)}u.attributes.push(n(e,t,a,h,r,l))}return c===e.TRIANGULAR_MESH&&(u.index=function(e,t,n){const r=3*n.num_faces(),o=4*r,i=e._malloc(o);t.GetTrianglesUInt32Array(n,o,i);const s=new Uint32Array(e.HEAPF32.buffer,i,r).slice();return e._free(i),{array:s,itemSize:1}}(e,t,a)),e.destroy(a),u}(t,s,a,i),r=e.attributes.map((e=>e.array.buffer));e.index&&r.push(e.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:e},r)}catch(l){console.error(l),self.postMessage({type:"error",id:o.id,error:l.message})}finally{t.destroy(a),t.destroy(s)}}))}}}const Ba=["args","center"],Ha=Jt({__name:"Text3D",props:{font:{},text:{},size:{default:.5},height:{default:.2},curveSegments:{default:5},bevelEnabled:{type:Boolean,default:!0},bevelThickness:{default:.05},bevelSize:{default:.02},bevelOffset:{default:0},bevelSegments:{default:4},center:{type:Boolean,default:!1},needUpdates:{type:Boolean,default:!1}},async setup(e,{expose:t}){let n,r;const o=e,{center:i,font:s,text:a,needUpdates:l,size:c,height:u,curveSegments:h,bevelEnabled:d,bevelThickness:p,bevelSize:m,bevelOffset:f,bevelSegments:g}=Xt(o),{extend:v,invalidate:y}=wo();Bt(o,(()=>y())),v({TextGeometry:ra});const b=new ka,_=en(),w=Kt((()=>{var e;return null!=a&&a.value?a.value:_.default?null==(e=_.default()[0].children)?void 0:e.trim():l.value?"":"TresJS"})),x=tn();t({instance:x});const T=([n,r]=dn((()=>new Promise(((e,t)=>{try{"string"==typeof s.value?b.load(s.value,(t=>{e(t)})):e(s.value)}catch(n){t(console.error("cientos",n))}})))),n=await n,r(),n),E=Kt((()=>({font:T,size:pn(c),height:pn(u),curveSegments:pn(h),bevelEnabled:pn(d),bevelThickness:pn(p),bevelSize:pn(m),bevelOffset:pn(f),bevelSegments:pn(g)})));return qt((()=>{x.value&&l.value&&(x.value.geometry.dispose(),x.value.geometry=new ra(w.value,E.value),i.value&&x.value.geometry.center())})),(e,t)=>zt(s)?(rn(),on("TresMesh",{key:0,ref_key:"text3DRef",ref:x},[w.value?(rn(),on("TresTextGeometry",{key:0,args:[w.value,E.value],center:zt(i)},null,8,Ba)):mn("",!0),fn(e.$slots,"default")],512)):mn("",!0)}});function Va(e,t){const n=jt(t),r=new W(n.value),o=gn({});e.forEach((e=>{const t=r.clipAction(e,n.value);o[e.name]=t}));const{onBeforeRender:i}=xo();return i((({delta:e})=>{r.update(e)})),{actions:o,mixer:r}}const Ya=Jt({__name:"Levioso",props:{speed:{default:1},rotationFactor:{default:1},floatFactor:{default:1},range:{default:()=>[-.1,.1]}},setup(e,{expose:t}){const n=e,r=tn();t({instance:r});{const e=1e4*Math.random(),{onBeforeRender:t}=xo();let o=e;t((({delta:e,invalidate:t})=>{if(!r.value)return;o+=e*n.speed;const i=.25*o,s=r.value;s.rotation.x=.125*Math.cos(i)*n.rotationFactor,s.rotation.y=.125*Math.sin(i)*n.rotationFactor,s.rotation.z=.05*Math.sin(i)*n.rotationFactor,s.position.y=b.mapLinear(Math.sin(i),-1,1,n.range[0],n.range[1])*n.floatFactor,t()}))}return(e,t)=>(rn(),on("TresGroup",vn(e.$attrs,{ref_key:"groupRef",ref:r}),[fn(e.$slots,"default")],16))}});function Xa(e){return!!Ft()&&(Nt(e),!0)}function Ga(e){return"function"==typeof e?e():zt(e)}Os.ReflectorShader;const Wa=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const Za=Object.prototype.toString,Ka=e=>"[object Object]"===Za.call(e),qa=()=>{};function Qa(e,t){return function(...n){return new Promise(((r,o)=>{Promise.resolve(e((()=>t.apply(this,n)),{fn:t,thisArg:this,args:n})).then(r).catch(o)}))}}function $a(e,t=200,n={}){return Qa(function(e,t={}){let n,r,o=qa;const i=e=>{clearTimeout(e),o(),o=qa};return s=>{const a=Ga(e),l=Ga(t.maxWait);return n&&i(n),a<=0||void 0!==l&&l<=0?(r&&(i(r),r=null),Promise.resolve(s())):new Promise(((e,c)=>{o=t.rejectOnCancel?c:e,l&&!r&&(r=setTimeout((()=>{n&&i(n),r=null,e(s())}),l)),n=setTimeout((()=>{r&&i(r),r=null,e(s())}),a)}))}}(t,n),e)}function Ja(e,t=200,n=!1,r=!0,o=!1){return Qa(function(...e){let t,n,r,o,i,s,a=0,l=!0,c=qa;Ht(e[0])||"object"!=typeof e[0]?[r,o=!0,i=!0,s=!1]=e:({delay:r,trailing:o=!0,leading:i=!0,rejectOnCancel:s=!1}=e[0]);const u=()=>{t&&(clearTimeout(t),t=void 0,c(),c=qa)};return e=>{const h=Ga(r),d=Date.now()-a,p=()=>n=e();return u(),h<=0?(a=Date.now(),p()):(d>h&&(i||!l)?(a=Date.now(),p()):o&&(n=new Promise(((e,n)=>{c=s?n:e,t=setTimeout((()=>{a=Date.now(),l=!0,e(p()),u()}),Math.max(0,h-d))}))),!i&&!t&&(t=setTimeout((()=>l=!0),h)),l=!1,n)}}(t,n,r,o),e)}function el(e,t=!0,n){Wt()?Vt(e,n):t?e():Yt(e)}function tl(e){var t;const n=Ga(e);return null!=(t=null==n?void 0:n.$el)?t:n}const nl=Wa?window:void 0;function rl(...e){let t,n,r,o;if("string"==typeof e[0]||Array.isArray(e[0])?([n,r,o]=e,t=nl):[t,n,r,o]=e,!t)return qa;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const i=[],s=()=>{i.forEach((e=>e())),i.length=0},l=Bt((()=>[tl(t),Ga(o)]),(([e,t])=>{if(s(),!e)return;const o=Ka(t)?a({},t):t;i.push(...n.flatMap((t=>r.map((n=>((e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)))(e,t,n,o))))))}),{immediate:!0,flush:"post"}),c=()=>{l(),s()};return Xa(c),c}function ol(e){const t=function(){const e=jt(!1),t=Wt();return t&&Vt((()=>{e.value=!0}),t),e}();return Kt((()=>(t.value,!!e())))}const il={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function sl(e={}){const{window:t=nl,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:o=!0,includeScrollbar:i=!0,type:s="inner"}=e,a=jt(n),l=jt(r),c=()=>{t&&("outer"===s?(a.value=t.outerWidth,l.value=t.outerHeight):i?(a.value=t.innerWidth,l.value=t.innerHeight):(a.value=t.document.documentElement.clientWidth,l.value=t.document.documentElement.clientHeight))};if(c(),el(c),rl("resize",c,{passive:!0}),o){const e=function(e,t={}){const{window:n=nl}=t,r=ol((()=>n&&"matchMedia"in n&&"function"==typeof n.matchMedia));let o;const i=jt(!1),s=e=>{i.value=e.matches},a=()=>{o&&("removeEventListener"in o?o.removeEventListener("change",s):o.removeListener(s))},l=qt((()=>{r.value&&(a(),o=n.matchMedia(Ga(e)),"addEventListener"in o?o.addEventListener("change",s):o.addListener(s),i.value=o.matches)}));return Xa((()=>{l(),a(),o=void 0})),i}("(orientation: portrait)");Bt(e,(()=>c()))}return{width:a,height:l}}class al extends E{constructor(){super(al.Geometry,new M({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new z,t=new z,n=new Me(16,16),r=new Me(16,16);let o=Ce;const i=al.Geometry,s=new Ae({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}",fragmentShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );\n\n\t\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),a=new Ae({uniforms:{map:{value:n},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\t\t\t\tattribute vec2 uv;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUV = uv;\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}",fragmentShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform sampler2D map;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = texture2D( map, vUV );\n\n\t\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),l=new E(i,s),c=[],u=ll.Shader,h=new Ae({name:u.name,uniforms:{map:{value:null},occlusionMap:{value:r},color:{value:new y(16777215)},scale:{value:new N},screenPosition:{value:new z}},vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:Se,transparent:!0,depthWrite:!1}),d=new E(i,h);this.addElement=function(e){c.push(e)};const p=new N,m=new N,f=new Oe,g=new re;this.onBeforeRender=function(u,v,y){u.getCurrentViewport(g);const b=u.getRenderTarget(),_=null!==b?b.texture.type:Ce;o!==_&&(n.dispose(),r.dispose(),n.type=r.type=_,o=_);const w=g.w/g.z,x=g.z/2,T=g.w/2;let E=16/g.w;if(p.set(E*w,E),f.min.set(g.x,g.y),f.max.set(g.x+(g.z-16),g.y+(g.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(y.matrixWorldInverse),!(t.z>0)&&(e.copy(t).applyMatrix4(y.projectionMatrix),m.x=g.x+e.x*x+x-8,m.y=g.y+e.y*T+T-8,f.containsPoint(m))){u.copyFramebufferToTexture(n,m);let t=s.uniforms;t.scale.value=p,t.screenPosition.value=e,u.renderBufferDirect(y,null,i,s,l,null),u.copyFramebufferToTexture(r,m),t=a.uniforms,t.scale.value=p,t.screenPosition.value=e,u.renderBufferDirect(y,null,i,a,l,null);const o=2*-e.x,f=2*-e.y;for(let n=0,r=c.length;n<r;n++){const t=c[n],r=h.uniforms;r.color.value.copy(t.color),r.map.value=t.texture,r.screenPosition.value.x=e.x+o*t.distance,r.screenPosition.value.y=e.y+f*t.distance,E=t.size/g.w;const s=g.w/g.z;r.scale.value.set(E*s,E),h.uniformsNeedUpdate=!0,u.renderBufferDirect(y,null,i,h,d,null)}}},this.dispose=function(){s.dispose(),a.dispose(),h.dispose(),n.dispose(),r.dispose();for(let e=0,t=c.length;e<t;e++)c[e].texture.dispose()}}}class ll{constructor(e,t=1,n=0,r=new y(16777215)){this.texture=e,this.size=t,this.distance=n,this.color=r}}ll.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform vec3 screenPosition;\n\t\tuniform vec2 scale;\n\n\t\tuniform sampler2D occlusionMap;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvUV = uv;\n\n\t\t\tvec2 pos = position.xy;\n\n\t\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\n\t\t\tvVisibility =        visibility.r / 9.0;\n\t\t\tvVisibility *= 1.0 - visibility.g / 9.0;\n\t\t\tvVisibility *=       visibility.b / 9.0;\n\n\t\t\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D map;\n\t\tuniform vec3 color;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texture = texture2D( map, vUV );\n\t\t\ttexture.a *= vVisibility;\n\t\t\tgl_FragColor = texture;\n\t\t\tgl_FragColor.rgb *= color;\n\n\t\t}"},al.Geometry=function(){const e=new w,t=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),n=new Z(t,5);return e.setIndex([0,1,2,0,2,3]),e.setAttribute("position",new K(n,3,0,!1)),e.setAttribute("uv",new K(n,2,3,!1)),e}(),b.clamp,b.lerp;const cl={sunset:"venice/venice_sunset_1k.hdr",studio:"studio/poly_haven_studio_1k.hdr",city:"city/canary_wharf_1k.hdr",umbrellas:"outdoor/outdoor_umbrellas_1k.hdr",night:"outdoor/satara_night_1k.hdr",forest:"outood/mossy_forest_1k.hdr",snow:"outdoor/snowy_forest_path_01_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",hangar:"indoor/small_hangar_01_1k.hdr",urban:"indoor/abandoned_games_room_02_1k.hdr",modern:"city/modern_buildings_2_1k.hdr",shangai:"city/shanghai_bund_1k.hdr"};function ul(e,t){if(t===Tt)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===Et||t===Mt){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const r=n.count-2,o=[];if(t===Et)for(let e=1;e<=r;e++)o.push(n.getX(0)),o.push(n.getX(e)),o.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(o.push(n.getX(e)),o.push(n.getX(e+1)),o.push(n.getX(e+2))):(o.push(n.getX(e+2)),o.push(n.getX(e+1)),o.push(n.getX(e)));o.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=e.clone();return i.setIndex(o),i.clearGroups(),i}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}class hl extends xe{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new vl(e)})),this.register((function(e){return new yl(e)})),this.register((function(e){return new Sl(e)})),this.register((function(e){return new Ol(e)})),this.register((function(e){return new Cl(e)})),this.register((function(e){return new _l(e)})),this.register((function(e){return new wl(e)})),this.register((function(e){return new xl(e)})),this.register((function(e){return new Tl(e)})),this.register((function(e){return new gl(e)})),this.register((function(e){return new El(e)})),this.register((function(e){return new bl(e)})),this.register((function(e){return new Al(e)})),this.register((function(e){return new Ml(e)})),this.register((function(e){return new ml(e)})),this.register((function(e){return new Il(e)})),this.register((function(e){return new Pl(e)}))}load(e,t,n,r){const o=this;let i;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){const t=Ne.extractUrlBase(e);i=Ne.resolveURL(t,this.path)}else i=Ne.extractUrlBase(e);this.manager.itemStart(e);const s=function(t){r?r(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},a=new Te(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{o.parse(n,i,(function(n){t(n),o.manager.itemEnd(e)}),s)}catch(r){s(r)}}),n,s)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let o;const i={},s={},a=new TextDecoder;if("string"==typeof e)o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===Rl){try{i[pl.KHR_BINARY_GLTF]=new Dl(e)}catch(c){return void(r&&r(c))}o=JSON.parse(i[pl.KHR_BINARY_GLTF].content)}else o=JSON.parse(a.decode(e));else o=e;if(void 0===o.asset||o.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new ac(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const e=this.pluginCallbacks[u](l);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),s[e.name]=e,i[e.name]=!0}if(o.extensionsUsed)for(let u=0;u<o.extensionsUsed.length;++u){const e=o.extensionsUsed[u],t=o.extensionsRequired||[];switch(e){case pl.KHR_MATERIALS_UNLIT:i[e]=new fl;break;case pl.KHR_DRACO_MESH_COMPRESSION:i[e]=new Ul(o,this.dracoLoader);break;case pl.KHR_TEXTURE_TRANSFORM:i[e]=new Fl;break;case pl.KHR_MESH_QUANTIZATION:i[e]=new Nl;break;default:t.indexOf(e)>=0&&void 0===s[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}l.setExtensions(i),l.setPlugins(s),l.parse(n,r)}parseAsync(e,t){const n=this;return new Promise((function(r,o){n.parse(e,t,r,o)}))}}function dl(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const pl={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ml{constructor(e){this.parser=e,this.name=pl.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const o=t.json,i=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let s;const a=new y(16777215);void 0!==i.color&&a.setRGB(i.color[0],i.color[1],i.color[2],nt);const l=void 0!==i.range?i.range:0;switch(i.type){case"directional":s=new it(a),s.target.position.set(0,0,-1),s.add(s.target);break;case"point":s=new ot(a),s.distance=l;break;case"spot":s=new rt(a),s.distance=l,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,s.angle=i.spot.outerConeAngle,s.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,s.target.position.set(0,0,-1),s.add(s.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return s.position.set(0,0,0),s.decay=2,tc(s,i),void 0!==i.intensity&&(s.intensity=i.intensity),s.name=t.createUniqueName(i.name||"light_"+e),r=Promise.resolve(s),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(e){return n._getNodeRef(t.cache,o,e)}))}}class fl{constructor(){this.name=pl.KHR_MATERIALS_UNLIT}getMaterialType(){return M}extendParams(e,t,n){const r=[];e.color=new y(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const t=o.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],nt),e.opacity=t[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(e,"map",o.baseColorTexture,L))}return Promise.all(r)}}class gl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class vl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];if(void 0!==i.clearcoatFactor&&(t.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&o.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(o.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){const e=i.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new N(e,e)}return Promise.all(o)}}class yl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.dispersion=void 0!==r.dispersion?r.dispersion:0,Promise.resolve()}}class bl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&o.push(n.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&o.push(n.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(o)}}class _l{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new y(0,0,0),t.sheenRoughness=0,t.sheen=1;const i=r.extensions[this.name];if(void 0!==i.sheenColorFactor){const e=i.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],nt)}return void 0!==i.sheenRoughnessFactor&&(t.sheenRoughness=i.sheenRoughnessFactor),void 0!==i.sheenColorTexture&&o.push(n.assignTexture(t,"sheenColorMap",i.sheenColorTexture,L)),void 0!==i.sheenRoughnessTexture&&o.push(n.assignTexture(t,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(o)}}class wl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&o.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(o)}}class xl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];t.thickness=void 0!==i.thicknessFactor?i.thicknessFactor:0,void 0!==i.thicknessTexture&&o.push(n.assignTexture(t,"thicknessMap",i.thicknessTexture)),t.attenuationDistance=i.attenuationDistance||1/0;const s=i.attenuationColor||[1,1,1];return t.attenuationColor=(new y).setRGB(s[0],s[1],s[2],nt),Promise.all(o)}}class Tl{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class El{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];t.specularIntensity=void 0!==i.specularFactor?i.specularFactor:1,void 0!==i.specularTexture&&o.push(n.assignTexture(t,"specularIntensityMap",i.specularTexture));const s=i.specularColorFactor||[1,1,1];return t.specularColor=(new y).setRGB(s[0],s[1],s[2],nt),void 0!==i.specularColorTexture&&o.push(n.assignTexture(t,"specularColorMap",i.specularColorTexture,L)),Promise.all(o)}}class Ml{constructor(e){this.parser=e,this.name=pl.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&o.push(n.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(o)}}class Al{constructor(e){this.parser=e,this.name=pl.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?st:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&o.push(n.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(o)}}class Sl{constructor(e){this.parser=e,this.name=pl.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=r.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,i)}}class Ol{constructor(e){this.parser=e,this.name=pl.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const i=o.extensions[t],s=r.images[i.source];let a=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(a=e)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,i.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Cl{constructor(e){this.parser=e,this.name=pl.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const i=o.extensions[t],s=r.images[i.source];let a=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(a=e)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,i.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class Il{constructor(e){this.name=pl.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,i=e.count,s=e.byteStride,a=new Uint8Array(t,n,r);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(i,s,a,e.mode,e.filter).then((function(e){return e.buffer})):o.ready.then((function(){const t=new ArrayBuffer(i*s);return o.decodeGltfBuffer(new Uint8Array(t),i,s,a,e.mode,e.filter),t}))}))}return null}}class Pl{constructor(e){this.name=pl.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const a of r.primitives)if(a.mode!==Hl.TRIANGLES&&a.mode!==Hl.TRIANGLE_STRIP&&a.mode!==Hl.TRIANGLE_FAN&&void 0!==a.mode)return null;const o=n.extensions[this.name].attributes,i=[],s={};for(const a in o)i.push(this.parser.getDependency("accessor",o[a]).then((e=>(s[a]=e,s[a]))));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],r=e[0].count,o=[];for(const i of n){const e=new q,t=new z,n=new ee,a=new z(1,1,1),l=new at(i.geometry,i.material,r);for(let o=0;o<r;o++)s.TRANSLATION&&t.fromBufferAttribute(s.TRANSLATION,o),s.ROTATION&&n.fromBufferAttribute(s.ROTATION,o),s.SCALE&&a.fromBufferAttribute(s.SCALE,o),l.setMatrixAt(o,e.compose(t,n,a));for(const r in s)if("_COLOR_0"===r){const e=s[r];l.instanceColor=new lt(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&i.geometry.setAttribute(r,s[r]);F.prototype.copy.call(l,i),this.parser.assignFinalMaterial(l),o.push(l)}return t.isGroup?(t.clear(),t.add(...o),t):o[0]})))}}const Rl="glTF",Ll=1313821514,kl=5130562;class Dl{constructor(e){this.name=pl.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Rl)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,o=new DataView(e,12);let i=0;for(;i<r;){const t=o.getUint32(i,!0);i+=4;const r=o.getUint32(i,!0);if(i+=4,r===Ll){const r=new Uint8Array(e,12+i,t);this.content=n.decode(r)}else if(r===kl){const n=12+i;this.body=e.slice(n,n+t)}i+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ul{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=pl.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,s={},a={},l={};for(const c in i){const e=Wl[c]||c.toLowerCase();s[e]=i[c]}for(const c in e.attributes){const t=Wl[c]||c.toLowerCase();if(void 0!==i[c]){const r=n.accessors[e.attributes[c]],o=Vl[r.componentType];l[t]=o.name,a[t]=!0===r.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t,n){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=a[t];void 0!==r&&(n.normalized=r)}t(e)}),s,l,nt,n)}))}))}}class Fl{constructor(){this.name=pl.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Nl{constructor(){this.name=pl.KHR_MESH_QUANTIZATION}}class zl extends Lt{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let i=0;i!==r;i++)t[i]=n[o+i];return t}interpolate_(e,t,n,r){const o=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=2*s,l=3*s,c=r-t,u=(n-t)/c,h=u*u,d=h*u,p=e*l,m=p-l,f=-2*d+3*h,g=d-h,v=1-f,y=g-h+u;for(let b=0;b!==s;b++){const e=i[m+b+s],t=i[m+b+a]*c,n=i[p+b+s],r=i[p+b]*c;o[b]=v*e+y*t+f*n+g*r}return o}}const jl=new ee;class Bl extends zl{interpolate_(e,t,n,r){const o=super.interpolate_(e,t,n,r);return jl.fromArray(o).normalize().toArray(o),o}}const Hl={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Vl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Yl={9728:At,9729:ut,9984:St,9985:Ot,9986:Ct,9987:ht},Xl={33071:je,33648:It,10497:ze},Gl={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Wl={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Zl={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Kl={CUBICSPLINE:void 0,LINEAR:de,STEP:_t},ql="OPAQUE",Ql="MASK",$l="BLEND";function Jl(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new ke({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Pt})),e.DefaultMaterial}function ec(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function tc(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function nc(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function rc(e){let t;const n=e.extensions&&e.extensions[pl.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+oc(n.attributes):e.indices+":"+oc(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,o=e.targets.length;r<o;r++)t+=":"+oc(e.targets[r]);return t}function oc(e){let t="";const n=Object.keys(e).sort();for(let r=0,o=n.length;r<o;r++)t+=n[r]+":"+e[n[r]]+";";return t}function ic(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const sc=new q;class ac{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new dl,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,o=!1,i=-1;if(typeof navigator<"u"){const e=navigator.userAgent;n=!0===/^((?!chrome|android).)*safari/i.test(e);const t=e.match(/Version\/(\d+)/);r=n&&t?parseInt(t[1],10):-1,o=e.indexOf("Firefox")>-1,i=o?e.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||o&&i<98?this.textureLoader=new h(this.options.manager):this.textureLoader=new ct(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Te(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};return ec(o,i,r),tc(i,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(i)}))).then((function(){for(const e of i.scenes)e.updateMatrixWorld();e(i)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let r=0,o=e.length;r<o;r++){const t=e[r];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),o=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[r,i]of e.children.entries())o(i,t.children[r])};return o(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&n.push(o)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[pl.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(e,o){n.load(Ne.resolveURL(t.uri,r.path),e,void 0,(function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const e=Gl[r.type],t=Vl[r.componentType],n=!0===r.normalized,o=new t(r.count*e);return Promise.resolve(new U(o,e,n))}const o=[];return void 0!==r.bufferView?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then((function(e){const o=e[0],i=Gl[r.type],s=Vl[r.componentType],a=s.BYTES_PER_ELEMENT,l=a*i,c=r.byteOffset||0,u=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;let d,p;if(u&&u!==l){const e=Math.floor(c/u),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let l=t.cache.get(n);l||(d=new s(o,e*u,r.count*u/a),l=new Z(d,u/a),t.cache.add(n,l)),p=new K(l,i,c%u/a,h)}else d=null===o?new s(r.count*i):new s(o,c,r.count*i),p=new U(d,i,h);if(void 0!==r.sparse){const t=Gl.SCALAR,n=Vl[r.sparse.indices.componentType],a=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,c=new n(e[1],a,r.sparse.count*t),u=new s(e[2],l,r.sparse.count*i);null!==o&&(p=new U(p.array.slice(),p.itemSize,p.normalized));for(let e=0,r=c.length;e<r;e++){const t=c[e];if(p.setX(t,u[e*i]),i>=2&&p.setY(t,u[e*i+1]),i>=3&&p.setZ(t,u[e*i+2]),i>=4&&p.setW(t,u[e*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,o=t.images[r];let i=this.textureLoader;if(o.uri){const e=n.manager.getHandler(o.uri);null!==e&&(i=e)}return this.loadTextureImage(e,r,i)}loadTextureImage(e,t,n){const r=this,o=this.json,i=o.textures[e],s=o.images[t],a=(s.uri||s.bufferView)+":"+i.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=i.name||s.name||"",""===t.name&&"string"==typeof s.uri&&!1===s.uri.startsWith("data:image/")&&(t.name=s.uri);const n=(o.samplers||{})[i.sampler]||{};return t.magFilter=Yl[n.magFilter]||ut,t.minFilter=Yl[n.minFilter]||ht,t.wrapS=Xl[n.wrapS]||ze,t.wrapT=Xl[n.wrapT]||ze,r.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const o=n.images[e],i=self.URL||self.webkitURL;let s=o.uri||"",a=!1;if(void 0!==o.bufferView)s=this.getDependency("bufferView",o.bufferView).then((function(e){a=!0;const t=new Blob([e],{type:o.mimeType});return s=i.createObjectURL(t),s}));else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(s).then((function(e){return new Promise((function(n,o){let i=n;!0===t.isImageBitmapLoader&&(i=function(e){const t=new Be(e);t.needsUpdate=!0,n(t)}),t.load(Ne.resolveURL(e,r.path),i,void 0,o)}))})).then((function(e){return!0===a&&i.revokeObjectURL(s),tc(e,o),e.userData.mimeType=o.mimeType||function(e){return e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",s),e}));return this.sourceCache[e]=l,l}assignTexture(e,t,n,r){const o=this;return this.getDependency("texture",n.index).then((function(i){if(!i)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((i=i.clone()).channel=n.texCoord),o.extensions[pl.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[pl.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=o.associations.get(i);i=o.extensions[pl.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),o.associations.set(i,t)}}return void 0!==r&&(i.colorSpace=r),e[t]=i,i}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,o=void 0!==t.attributes.color,i=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new dt,pt.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new T,pt.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(r||o||i){let e="ClonedMaterial:"+n.uuid+":";r&&(e+="derivative-tangents:"),o&&(e+="vertex-colors:"),i&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),o&&(t.vertexColors=!0),i&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return ke}loadMaterial(e){const t=this,n=this.json,r=this.extensions,o=n.materials[e];let i;const s={},a=[];if((o.extensions||{})[pl.KHR_MATERIALS_UNLIT]){const e=r[pl.KHR_MATERIALS_UNLIT];i=e.getMaterialType(),a.push(e.extendParams(s,o,t))}else{const n=o.pbrMetallicRoughness||{};if(s.color=new y(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;s.color.setRGB(e[0],e[1],e[2],nt),s.opacity=e[3]}void 0!==n.baseColorTexture&&a.push(t.assignTexture(s,"map",n.baseColorTexture,L)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(a.push(t.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),a.push(t.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture))),i=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),a.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)}))))}!0===o.doubleSided&&(s.side=j);const l=o.alphaMode||ql;if(l===$l?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,l===Ql&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&i!==M&&(a.push(t.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new N(1,1),void 0!==o.normalTexture.scale)){const e=o.normalTexture.scale;s.normalScale.set(e,e)}if(void 0!==o.occlusionTexture&&i!==M&&(a.push(t.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&i!==M){const e=o.emissiveFactor;s.emissive=(new y).setRGB(e[0],e[1],e[2],nt)}return void 0!==o.emissiveTexture&&i!==M&&a.push(t.assignTexture(s,"emissiveMap",o.emissiveTexture,L)),Promise.all(a).then((function(){const n=new i(s);return o.name&&(n.name=o.name),tc(n,o),t.associations.set(n,{materials:e}),o.extensions&&ec(r,n,o),n}))}createUniqueName(e){const t=he.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function o(e){return n[pl.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return lc(n,e,t)}))}const i=[];for(let s=0,a=e.length;s<a;s++){const n=e[s],a=rc(n),l=r[a];if(l)i.push(l.promise);else{let e;e=n.extensions&&n.extensions[pl.KHR_DRACO_MESH_COMPRESSION]?o(n):lc(new w,n,t),r[a]={primitive:n,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){const t=this,n=this.json,r=this.extensions,o=n.meshes[e],i=o.primitives,s=[];for(let a=0,l=i.length;a<l;a++){const e=void 0===i[a].material?Jl(this.cache):this.getDependency("material",i[a].material);s.push(e)}return s.push(t.loadGeometries(i)),Promise.all(s).then((function(n){const s=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let u=0,h=a.length;u<h;u++){const n=a[u],c=i[u];let h;const d=s[u];if(c.mode===Hl.TRIANGLES||c.mode===Hl.TRIANGLE_STRIP||c.mode===Hl.TRIANGLE_FAN||void 0===c.mode)h=!0===o.isSkinnedMesh?new Xe(n,d):new E(n,d),!0===h.isSkinnedMesh&&h.normalizeSkinWeights(),c.mode===Hl.TRIANGLE_STRIP?h.geometry=ul(h.geometry,Mt):c.mode===Hl.TRIANGLE_FAN&&(h.geometry=ul(h.geometry,Et));else if(c.mode===Hl.LINES)h=new mt(n,d);else if(c.mode===Hl.LINE_STRIP)h=new _(n,d);else if(c.mode===Hl.LINE_LOOP)h=new ft(n,d);else{if(c.mode!==Hl.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);h=new gt(n,d)}Object.keys(h.geometry.morphAttributes).length>0&&nc(h,o),h.name=t.createUniqueName(o.name||"mesh_"+e),tc(h,o),c.extensions&&ec(r,h,c),t.assignFinalMaterial(h),l.push(h)}for(let r=0,o=l.length;r<o;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return o.extensions&&ec(r,l[0],o),l[0];const c=new De;o.extensions&&ec(r,c,o),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c}))}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new f(b.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new _e(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),tc(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,o=t.joints.length;r<o;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),r=e,o=[],i=[];for(let s=0,a=r.length;s<a;s++){const e=r[s];if(e){o.push(e);const t=new q;null!==n&&t.fromArray(n.array,16*s),i.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[s])}return new Ge(o,i)}))}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],o=r.name?r.name:"animation_"+e,i=[],s=[],a=[],l=[],c=[];for(let u=0,h=r.channels.length;u<h;u++){const e=r.channels[u],t=r.samplers[e.sampler],n=e.target,o=n.node,h=void 0!==r.parameters?r.parameters[t.input]:t.input,d=void 0!==r.parameters?r.parameters[t.output]:t.output;void 0!==n.node&&(i.push(this.getDependency("node",o)),s.push(this.getDependency("accessor",h)),a.push(this.getDependency("accessor",d)),l.push(t),c.push(n))}return Promise.all([Promise.all(i),Promise.all(s),Promise.all(a),Promise.all(l),Promise.all(c)]).then((function(e){const t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],l=[];for(let o=0,c=t.length;o<c;o++){const e=t[o],c=r[o],u=i[o],h=s[o],d=a[o];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const p=n._createAnimationTracks(e,c,u,h,d);if(p)for(let t=0;t<p.length;t++)l.push(p[t])}return new qe(o,void 0,l)}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),o=[],i=n.children||[];for(let a=0,l=i.length;a<l;a++)o.push(t.getDependency("node",i[a]));const s=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(o),s]).then((function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,sc)}));for(let o=0,i=n.length;o<i;o++)t.add(n[o]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const o=t.nodes[e],i=o.name?r.createUniqueName(o.name):"",s=[],a=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return a&&s.push(a),void 0!==o.camera&&s.push(r.getDependency("camera",o.camera).then((function(e){return r._getNodeRef(r.cameraCache,o.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){s.push(e)})),this.nodeCache[e]=Promise.all(s).then((function(t){let s;if(s=!0===o.isBone?new Ye:t.length>1?new De:1===t.length?t[0]:new F,s!==t[0])for(let e=0,n=t.length;e<n;e++)s.add(t[e]);if(o.name&&(s.userData.name=o.name,s.name=i),tc(s,o),o.extensions&&ec(n,s,o),void 0!==o.matrix){const e=new q;e.fromArray(o.matrix),s.applyMatrix4(e)}else void 0!==o.translation&&s.position.fromArray(o.translation),void 0!==o.rotation&&s.quaternion.fromArray(o.rotation),void 0!==o.scale&&s.scale.fromArray(o.scale);return r.associations.has(s)||r.associations.set(s,{}),r.associations.get(s).nodes=e,s})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,o=new De;n.name&&(o.name=r.createUniqueName(n.name)),tc(o,n),n.extensions&&ec(t,o,n);const i=n.nodes||[],s=[];for(let a=0,l=i.length;a<l;a++)s.push(r.getDependency("node",i[a]));return Promise.all(s).then((function(e){for(let t=0,n=e.length;t<n;t++)o.add(e[t]);return r.associations=(e=>{const t=new Map;for(const[n,o]of r.associations)(n instanceof pt||n instanceof Be)&&t.set(n,o);return e.traverse((e=>{const n=r.associations.get(e);null!=n&&t.set(e,n)})),t})(o),o}))}_createAnimationTracks(e,t,n,r,o){const i=[],s=e.name?e.name:e.uuid,a=[];let l;switch(Zl[o.path]===Zl.weights?e.traverse((function(e){e.morphTargetInfluences&&a.push(e.name?e.name:e.uuid)})):a.push(s),Zl[o.path]){case Zl.weights:l=Je;break;case Zl.rotation:l=$e;break;case Zl.position:case Zl.scale:l=Qe;break;default:if(1===n.itemSize)l=Je;else l=Qe}const c=void 0!==r.interpolation?Kl[r.interpolation]:de,u=this._getArrayFromAccessor(n);for(let h=0,d=a.length;h<d;h++){const e=new l(a[h]+"."+Zl[o.path],t.array,u,c);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(e),i.push(e)}return i}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=ic(t.constructor),n=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)n[r]=t[r]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof $e?Bl:zl)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function lc(e,t,n){const r=t.attributes,o=[];function i(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const s in r){const t=Wl[s]||s.toLowerCase();t in e.attributes||o.push(i(r[s],t))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(r)}return vt.workingColorSpace!==nt&&"COLOR_0"in r&&console.warn('THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "'.concat(vt.workingColorSpace,'" not supported.')),tc(e,t),function(e,t,n){const r=t.attributes,o=new J;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,i=e.max;if(void 0===t||void 0===i)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(o.set(new z(t[0],t[1],t[2]),new z(i[0],i[1],i[2])),e.normalized){const t=ic(Vl[e.componentType]);o.min.multiplyScalar(t),o.max.multiplyScalar(t)}}const i=t.targets;if(void 0!==i){const e=new z,t=new z;for(let r=0,o=i.length;r<o;r++){const o=i[r];if(void 0!==o.POSITION){const r=n.json.accessors[o.POSITION],i=r.min,s=r.max;if(void 0!==i&&void 0!==s){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(s[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(s[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(s[2]))),r.normalized){const e=ic(Vl[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(e)}e.boundingBox=o;const s=new te;o.getCenter(s.center),s.radius=o.min.distanceTo(o.max)/2,e.boundingSphere=s}(e,t,n),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,n){let r=!1,o=!1,i=!1;for(let c=0,u=t.length;c<u;c++){const e=t[c];if(void 0!==e.POSITION&&(r=!0),void 0!==e.NORMAL&&(o=!0),void 0!==e.COLOR_0&&(i=!0),r&&o&&i)break}if(!r&&!o&&!i)return Promise.resolve(e);const s=[],a=[],l=[];for(let c=0,u=t.length;c<u;c++){const u=t[c];if(r){const t=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):e.attributes.position;s.push(t)}if(o){const t=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):e.attributes.normal;a.push(t)}if(i){const t=void 0!==u.COLOR_0?n.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(l)]).then((function(t){const n=t[0],s=t[1],a=t[2];return r&&(e.morphAttributes.position=n),o&&(e.morphAttributes.normal=s),i&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}let cc=null;async function uc(e,t={draco:!1},n){const r=await so(hl,e,function(e,t){return n=>{t&&t(n),e.draco&&(cc||(cc=new za),cc.setDecoderPath(e.decoderPath||"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),n.setDRACOLoader&&n.setDRACOLoader(cc))}}(t,n));return null==cc||cc.dispose(),cc=null,r}async function hc(e){return await so(pa,e)}const dc="[TresJS - Cientos â–² â–  â™¥] ";function pc(e,t){console.error("".concat(dc," ").concat(e),t||"")}function mc(e){console.warn("".concat(dc," ").concat(e))}function fc(e,t){}function gc(){return{logError:pc,logWarning:mc,logMessage:fc}}let vc=0;function yc(){const e=jt(!1),t=jt(0),n=jt([]),{logError:r}=gc();return new Promise((o=>{Q.onStart=()=>{e.value=!1},Q.onLoad=()=>{e.value=!0},Q.onProgress=(r,o,i)=>{o===i&&(vc=i,e.value=!0,n.value.push(r)),t.value=Math.round((o-vc)/(i-vc)*100||100)},Q.onError=t=>{r("Error loading assets",new Error(t)),e.value=!0},o({items:n,hasFinishLoading:e,progress:t})}))}async function bc(e,t){const{logError:n}=gc(),r=a({unsuspend:"loadedmetadata",crossOrigin:"Anonymous",muted:!0,loop:!0,start:!0,playsInline:!0},t),{unsuspend:o,start:i,crossOrigin:s,muted:l,loop:u}=r,h=c(r,["unsuspend","start","crossOrigin","muted","loop"]);try{const t=await new Promise(((t,n)=>{const r=Object.assign(document.createElement("video"),a({src:e,crossOrigin:s,loop:u,muted:l,autoplay:!0},h)),i=new Le(r);return r.addEventListener(o,(()=>t(i))),r.addEventListener("error",(()=>n(new Error("Error loading video")))),i}));return i&&t.image&&t.image.play(),t}catch(d){n("Error loading resource")}}const _c=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],wc=Jt({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:$.ROTATE,TWO:$.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,o=n,{makeDefault:i,autoRotate:s,autoRotateSpeed:a,enableDamping:l,dampingFactor:c,enablePan:u,keyPanSpeed:h,maxAzimuthAngle:d,minAzimuthAngle:p,maxPolarAngle:m,minPolarAngle:f,minDistance:g,maxDistance:v,minZoom:y,maxZoom:b,enableZoom:_,zoomSpeed:w,enableRotate:x,touches:T,rotateSpeed:E,target:M}=Xt(r),{camera:A,renderer:S,extend:O,controls:C,invalidate:I}=wo(),P=jt(null);O({OrbitControls:ea}),Bt(P,(e=>{rl(P.value,"change",(()=>{o("change",P.value),I()})),rl(P.value,"start",(()=>o("start",P.value))),rl(P.value,"end",(()=>o("end",P.value))),e&&i.value?C.value=e:C.value=null}));const{onBeforeRender:R}=xo();return R((({invalidate:e})=>{P.value&&(l.value||s.value)&&(P.value.update(),s.value&&e())})),nn((()=>{P.value&&P.value.dispose()})),t({instance:P}),(e,t)=>(e.camera||zt(A))&&(e.domElement||zt(S))?(rn(),on("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:P,target:zt(M),"auto-rotate":zt(s),"auto-rotate-speed":zt(a),"enable-damping":zt(l),"damping-factor":zt(c),"enable-pan":zt(u),"key-pan-speed":zt(h),keys:e.keys,"max-azimuth-angle":zt(d),"min-azimuth-angle":zt(p),"max-polar-angle":zt(m),"min-polar-angle":zt(f),"min-distance":zt(g),"max-distance":zt(v),"min-zoom":zt(y),"max-zoom":zt(b),touches:zt(T),"enable-zoom":zt(_),"zoom-speed":zt(w),"enable-rotate":zt(x),"rotate-speed":zt(E),args:[e.camera||zt(A),e.domElement||zt(S).domElement]},null,8,_c)):mn("",!0)}}),xc=Jt({__name:"KeyboardControls",props:{makeDefault:{type:Boolean,default:!0},camera:{},domElement:{},moveSpeed:{default:.2},selector:{}},emits:["isLock","change"],setup(e,{expose:t,emit:n}){const r=e,o=n,{moveSpeed:i}=Xt(r),{camera:s,controls:a,renderer:l,invalidate:c}=wo();Bt(r,(()=>{c()}));const u=jt(0),h=jt(0),{w:d,s:p,a:m,d:f,Up:g,Down:v,Left:y,Right:b}=function(e={}){const{reactive:t=!1,target:n=nl,aliasMap:r=il,passive:o=!0,onEventFired:i=qa}=e,s=$t(new Set),a={toJSON:()=>({}),current:s},l=t?$t(a):a,c=new Set,u=new Set;function h(e,n){e in l&&(t?l[e]=n:l[e].value=n)}function d(){s.clear();for(const e of u)h(e,!1)}function p(e,t){var n,r;const o=null==(n=e.key)?void 0:n.toLowerCase(),i=[null==(r=e.code)?void 0:r.toLowerCase(),o].filter(Boolean);o&&(t?s.add(o):s.delete(o));for(const s of i)u.add(s),h(s,t);"meta"!==o||t?"function"==typeof e.getModifierState&&e.getModifierState("Meta")&&t&&[...s,...i].forEach((e=>c.add(e))):(c.forEach((e=>{s.delete(e),h(e,!1)})),c.clear())}rl(n,"keydown",(e=>(p(e,!0),i(e))),{passive:o}),rl(n,"keyup",(e=>(p(e,!1),i(e))),{passive:o}),rl("blur",d,{passive:!0}),rl("focus",d,{passive:!0});const m=new Proxy(l,{get(e,n,o){if("string"!=typeof n)return Reflect.get(e,n,o);if((n=n.toLowerCase())in r&&(n=r[n]),!(n in l))if(/[+_-]/.test(n)){const e=n.split(/[+_-]/g).map((e=>e.trim()));l[n]=Kt((()=>e.every((e=>Ga(m[e])))))}else l[n]=jt(!1);const i=Reflect.get(e,n,o);return t?Ga(i):i}});return m}();qt((()=>{m.value||y.value?u.value=-i.value:f.value||b.value?u.value=i.value:u.value=0,d.value||g.value?h.value=i.value:p.value||v.value?h.value=-i.value:h.value=0})),t({instance:a});const _=e=>o("isLock",e),w=e=>o("change",e),x=new z,T=new z,E=new ee,{onBeforeRender:M}=xo();return M((({delta:e,invalidate:t})=>{var n;a.value instanceof Ws&&null!=(n=a.value)&&n.isLocked&&(((e,t)=>{var n;if(!(null!=(n=s.value)&&n.position||x))return;const r=s.value,i=.001*e;null==r||r.translateZ(-t),E.set(T.x*i,T.y*i,T.z*i,1).normalize(),null==r||r.quaternion.multiply(E),(u.value||h.value)&&o("change",a.value)})(e,h.value),a.value.moveRight(u.value),t())})),(e,t)=>(rn(),yn(zt(Ac),{selector:e.selector,"make-default":e.makeDefault,camera:e.camera||zt(s),"dom-element":e.domElement||zt(l).domElement,onIsLock:_,onChange:w},null,8,["selector","make-default","camera","dom-element"]))}}),Tc=["object","args","mode","enabled","axis","translation-snap","rotation-snap","scale-snap","space","size","show-x","show-y","show-z"],Ec=Jt({__name:"TransformControls",props:{object:{},camera:{},mode:{default:"translate"},enabled:{type:Boolean,default:!0},axis:{default:"XYZ"},translationSnap:{},rotationSnap:{},scaleSnap:{},space:{default:"world"},size:{default:1},showX:{type:Boolean,default:!0},showY:{type:Boolean,default:!0},showZ:{type:Boolean,default:!0}},emits:["dragging","change","mouseDown","mouseUp","objectChange"],setup(e,{expose:t,emit:n}){const r=e,o=n,{object:i,mode:s,enabled:a,axis:l,translationSnap:c,rotationSnap:u,scaleSnap:h,space:d,size:p,showX:m,showY:f,showZ:g}=Xt(r),v=tn(null),{controls:y,camera:b,renderer:_,extend:w,invalidate:x}=wo();Bt([i,s,a,l,c,u,h,d,p,m,f,g],(()=>{x()})),w({TransformControls:Us});const T=()=>{x(),o("change")},E=e=>{y.value&&(y.value.enabled=!e.value),x(),o("dragging",e.value)},M=()=>{x(),o("mouseDown")},A=()=>{x(),o("mouseDown")},S=()=>{x(),o("objectChange")};return Bt(v,(e=>{e&&(rl(v.value,"change",T),rl(v.value,"dragging-changed",E),rl(v.value,"mouseDown",M),rl(v.value,"mouseUp",A),rl(v.value,"objectChange",S))})),nn((()=>{v.value&&v.value.dispose()})),t({instance:v}),(e,t)=>{var n;return(e.camera||zt(b))&&zt(_)?(rn(),on("TresTransformControls",{ref_key:"controlsRef",ref:v,key:null==(n=e.camera||zt(b))?void 0:n.uuid,object:zt(i),args:[e.camera||zt(b),zt(_).domElement],mode:zt(s),enabled:zt(a),axis:zt(l),"translation-snap":zt(c),"rotation-snap":zt(u),"scale-snap":zt(h),space:zt(d),size:zt(p),"show-x":zt(m),"show-y":zt(f),"show-z":zt(g),visible:!0},null,8,Tc)):mn("",!0)}}}),Mc=["args"],Ac=Jt({__name:"PointerLockControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},selector:{}},emits:["isLock","change"],setup(e,{expose:t,emit:n}){const r=e,o=n,{camera:i,renderer:s,extend:a,controls:l,invalidate:c}=wo();Bt(r,(()=>{c()}));const u=jt(null);let h;a({PointerLockControls:Ws});const d=e=>{o("isLock",e)};return Bt(u,(e=>{e&&r.makeDefault?l.value=e:l.value=null,h=document.getElementById(r.selector||"")||s.value.domElement,rl(l.value,"change",(()=>{o("change",l.value),c()})),rl(h,"click",(()=>{var e,t,n;null==(e=u.value)||e.lock(),null==(t=u.value)||t.addEventListener("lock",(()=>d(!0))),null==(n=u.value)||n.addEventListener("unlock",(()=>d(!1))),c()}))})),nn((()=>{var e,t;null==(e=l.value)||e.removeEventListener("lock",(()=>d(!0))),null==(t=l.value)||t.removeEventListener("unlock",(()=>d(!1))),u.value&&u.value.dispose()})),t({instance:l}),(e,t)=>(e.camera||zt(i))&&(e.domElement||zt(s))?(rn(),on("TresPointerLockControls",{key:0,ref_key:"controlsRef",ref:u,args:[e.camera||zt(i),e.domElement||zt(s).domElement]},null,8,Mc)):mn("",!0)}}),Sc=["args","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","enable-zoom","zoom-speed","enable-rotate","rotate-speed"],Oc=Jt({__name:"MapControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,{autoRotate:o,autoRotateSpeed:i,enableDamping:s,dampingFactor:a,enablePan:l,keyPanSpeed:c,maxAzimuthAngle:u,minAzimuthAngle:h,maxPolarAngle:d,minPolarAngle:p,minDistance:m,maxDistance:f,minZoom:g,maxZoom:v,enableZoom:y,zoomSpeed:b,enableRotate:_,rotateSpeed:w}=Xt(r),{camera:x,renderer:T,extend:E,controls:M,invalidate:A}=wo();Bt(r,(()=>{A()}));const S=jt(null);E({MapControls:ta}),Bt(M,(e=>{e&&r.makeDefault?M.value=e:M.value=null}));const{onBeforeRender:O}=xo();return O((({invalidate:e})=>{S.value&&(s.value||o.value)&&(S.value.update(),e())})),nn((()=>{S.value&&S.value.dispose()})),t({instance:S}),(e,t)=>(e.camera||zt(x))&&(e.domElement||zt(T))?(rn(),on("TresMapControls",{key:0,ref_key:"controlsRef",ref:S,args:[e.camera||zt(x),e.domElement||zt(T).domElement],"auto-rotate":zt(o),"auto-rotate-speed":zt(i),"enable-damping":zt(s),"damping-factor":zt(a),"enable-pan":zt(l),"key-pan-speed":zt(c),keys:e.keys,"max-azimuth-angle":zt(u),"min-azimuth-angle":zt(h),"max-polar-angle":zt(d),"min-polar-angle":zt(p),"min-distance":zt(m),"max-distance":zt(f),"min-zoom":zt(g),"max-zoom":zt(v),"enable-zoom":zt(y),"zoom-speed":zt(b),"enable-rotate":zt(_),"rotate-speed":zt(w)},null,8,Sc)):mn("",!0)}}),Cc=Jt({__name:"ScrollControls",props:{pages:{default:4},distance:{default:4},smoothScroll:{default:.1},horizontal:{type:Boolean,default:!1},htmlScroll:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const r=e,o=n,{logWarning:i}=Lr();r.smoothScroll<0&&i("SmoothControl must be greater than zero"),r.pages<0&&i("Pages must be greater than zero");const{camera:s,controls:a,renderer:l,invalidate:c}=wo();Bt(r,(()=>{c()}));const u=tn(),h=document.createElement("div"),{y:d}=function(e={}){const{window:t=nl,behavior:n="auto"}=e;if(!t)return{x:jt(0),y:jt(0)};const r=jt(t.scrollX),o=jt(t.scrollY),i=Kt({get:()=>r.value,set(e){scrollTo({left:e,behavior:n})}}),s=Kt({get:()=>o.value,set(e){scrollTo({top:e,behavior:n})}});return rl(t,"scroll",(()=>{r.value=t.scrollX,o.value=t.scrollY}),{capture:!1,passive:!0}),{x:i,y:s}}(),{x:p,y:m,isScrolling:f}=function(e,t={}){const{throttle:n=0,idle:r=200,onStop:o=qa,onScroll:i=qa,offset:s={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0},behavior:l="auto",window:c=nl,onError:u=(e=>{console.error(e)})}=t,h=jt(0),d=jt(0),p=Kt({get:()=>h.value,set(e){f(e,void 0)}}),m=Kt({get:()=>d.value,set(e){f(void 0,e)}});function f(t,n){var r,o,i,s;if(!c)return;const a=Ga(e);if(!a)return;null==(i=a instanceof Document?c.document.body:a)||i.scrollTo({top:null!=(r=Ga(n))?r:m.value,left:null!=(o=Ga(t))?o:p.value,behavior:Ga(l)});const u=(null==(s=null==a?void 0:a.document)?void 0:s.documentElement)||(null==a?void 0:a.documentElement)||a;null!=p&&(h.value=u.scrollLeft),null!=m&&(d.value=u.scrollTop)}const g=jt(!1),v=$t({left:!0,right:!1,top:!0,bottom:!1}),y=$t({left:!1,right:!1,top:!1,bottom:!1}),b=e=>{g.value&&(g.value=!1,y.left=!1,y.right=!1,y.top=!1,y.bottom=!1,o(e))},_=$a(b,n+r),w=e=>{var t;if(!c)return;const n=(null==(t=null==e?void 0:e.document)?void 0:t.documentElement)||(null==e?void 0:e.documentElement)||tl(e),{display:r,flexDirection:o}=getComputedStyle(n),i=n.scrollLeft;y.left=i<h.value,y.right=i>h.value;const a=Math.abs(i)<=(s.left||0),l=Math.abs(i)+n.clientWidth>=n.scrollWidth-(s.right||0)-1;"flex"===r&&"row-reverse"===o?(v.left=l,v.right=a):(v.left=a,v.right=l),h.value=i;let u=n.scrollTop;e===c.document&&!u&&(u=c.document.body.scrollTop),y.top=u<d.value,y.bottom=u>d.value;const p=Math.abs(u)<=(s.top||0),m=Math.abs(u)+n.clientHeight>=n.scrollHeight-(s.bottom||0)-1;"flex"===r&&"column-reverse"===o?(v.top=m,v.bottom=p):(v.top=p,v.bottom=m),d.value=u},x=e=>{var t;if(!c)return;const n=null!=(t=e.target.documentElement)?t:e.target;w(n),g.value=!0,_(e),i(e)};return rl(e,"scroll",n?Ja(x,n,!0,!1):x,a),el((()=>{try{const t=Ga(e);if(!t)return;w(t)}catch(T){u(T)}})),rl(e,"scrollend",b,a),{x:p,y:m,isScrolling:g,arrivedState:v,directions:y,measure(){const t=Ga(e);c&&t&&w(t)}}}(h),{height:g,width:v}=sl();let y=0;const b=jt(!1),_=jt(0),w=jt(0),x=jt(0),T=r.horizontal?"x":"y",E=Bt(s,(e=>{b.value?E():(y=r.horizontal?(null==e?void 0:e.position.x)||0:(null==e?void 0:e.position.y)||0,b.value=!0)}),{immediate:!0});Bt(f,(e=>{a.value&&(a.value.enabled=!e)}),{immediate:!0}),Bt(d,(e=>{!f.value&&!r.htmlScroll||(w.value=e/g.value/(x.value/g.value-1),_.value=-1*w.value,o("update:modelValue",w.value))})),Bt(m,(e=>{w.value=e/g.value/(x.value/g.value),_.value=-1*w.value,o("update:modelValue",w.value)})),Bt(p,(e=>{w.value=e/v.value/(x.value/v.value-1),_.value=+w.value,o("update:modelValue",w.value)})),Bt(l,(e=>{var t,n;const o=null==e?void 0:e.domElement;if(r.htmlScroll&&null!=e&&e.domElement)null!=o&&o.style.width&&null!=o&&o.style.position&&null!=o&&o.style.top&&null!=o&&o.style.left&&(o.style.width="100%",o.style.position="fixed",o.style.zIndex=" -99999",o.style.top="0",o.style.left="0"),x.value=document.body.scrollHeight;else{const i=document.createElement("div"),s=document.createElement("div");h.style[r.horizontal?"overflowX":"overflowY"]="auto",h.style[r.horizontal?"overflowY":"overflowX"]="hidden",h.style.position="absolute",h.style.width="100%",h.style.height=" 100%",h.style.top="0",h.style.left="0",h.classList.add("scrollContainer"),i.style.position="sticky",i.style.top="0px",i.style.left="0px",i.style.width="100%",i.style.height="100%",i.style.overflow="hidden",h.appendChild(i),s.style.height=r.horizontal?"100%":"".concat(g.value*r.pages,"px"),s.style.width=r.horizontal?"".concat(v.value*r.pages,"px"):"100vw",s.style.pointerEvents="none",o.style.position="fixed",o.style.zIndex="0",null!=o&&o.style.width&&(o.style.width="100%"),h.appendChild(s),null!=e&&e.domElement.parentNode&&(e.domElement.parentNode.style.position="relative"),null==(n=null==(t=null==e?void 0:e.domElement)?void 0:t.parentNode)||n.appendChild(h),x.value=r.horizontal?v.value*r.pages:g.value*r.pages}}),{immediate:!0});const{onBeforeRender:M}=xo();return M((({invalidate:e})=>{var t;if(null!=(t=s.value)&&t.position){const t=(_.value*r.distance-s.value.position[T]+y)*r.smoothScroll;s.value.position[T]+=t,u.value.children.length>0&&(u.value.position[T]+=t),e()}})),t({instance:u}),(e,t)=>(rn(),on("TresGroup",{ref_key:"wrapperRef",ref:u},[fn(e.$slots,"default")],512))}}),Ic=1,Pc=2,Rc=4,Lc=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),kc=0,Dc=1,Uc=-1;
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */function Fc(e){return e.isPerspectiveCamera}function Nc(e){return e.isOrthographicCamera}const zc=2*Math.PI,jc=Math.PI/2,Bc=1e-5,Hc=Math.PI/180;function Vc(e,t,n){return Math.max(t,Math.min(n,e))}function Yc(e,t=Bc){return Math.abs(e)<t}function Xc(e,t,n=Bc){return Yc(e-t,n)}function Gc(e,t){return Math.round(e/t)*t}function Wc(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Zc(e){return Math.abs(e)<Number.MAX_VALUE?e:e*(1/0)}function Kc(e,t,n,r,o=1/0,i){const s=2/(r=Math.max(1e-4,r)),a=s*i,l=1/(1+a+.48*a*a+.235*a*a*a);let c=e-t;const u=t,h=o*r;c=Vc(c,-h,h),t=e-c;const d=(n.value+s*c)*i;n.value=(n.value-s*d)*l;let p=t+(c+d)*l;return u-e>0==p>u&&(p=u,n.value=(p-u)/i),p}function qc(e,t,n,r,o=1/0,i,s){const a=2/(r=Math.max(1e-4,r)),l=a*i,c=1/(1+l+.48*l*l+.235*l*l*l);let u=t.x,h=t.y,d=t.z,p=e.x-u,m=e.y-h,f=e.z-d;const g=u,v=h,y=d,b=o*r,_=p*p+m*m+f*f;if(_>b*b){const e=Math.sqrt(_);p=p/e*b,m=m/e*b,f=f/e*b}u=e.x-p,h=e.y-m,d=e.z-f;const w=(n.x+a*p)*i,x=(n.y+a*m)*i,T=(n.z+a*f)*i;n.x=(n.x-a*w)*c,n.y=(n.y-a*x)*c,n.z=(n.z-a*T)*c,s.x=u+(p+w)*c,s.y=h+(m+x)*c,s.z=d+(f+T)*c;const E=g-e.x,M=v-e.y,A=y-e.z;return E*(s.x-g)+M*(s.y-v)+A*(s.z-y)>0&&(s.x=g,s.y=v,s.z=y,n.x=(s.x-g)/i,n.y=(s.y-v)/i,n.z=(s.z-y)/i),s}function Qc(e,t){t.set(0,0),e.forEach((e=>{t.x+=e.clientX,t.y+=e.clientY})),t.x/=e.length,t.y/=e.length}function $c(e,t){return!!Nc(e)&&(console.warn("".concat(t," is not supported in OrthographicCamera")),!0)}class Jc{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}removeAllEventListeners(e){e?Array.isArray(this._listeners[e])&&(this._listeners[e].length=0):this._listeners={}}dispatchEvent(e){const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e)}}}var eu;const tu=1/8,nu=/Mac/.test(null===(eu=null==globalThis?void 0:globalThis.navigator)||void 0===eu?void 0:eu.platform);let ru,ou,iu,su,au,lu,cu,uu,hu,du,pu,mu,fu,gu,vu,yu,bu,_u,wu,xu,Tu,Eu,Mu,Au=class e extends Jc{static install(e){ru=e.THREE,ou=Object.freeze(new ru.Vector3(0,0,0)),iu=Object.freeze(new ru.Vector3(0,1,0)),su=Object.freeze(new ru.Vector3(0,0,1)),au=new ru.Vector2,lu=new ru.Vector3,cu=new ru.Vector3,uu=new ru.Vector3,hu=new ru.Vector3,du=new ru.Vector3,pu=new ru.Vector3,mu=new ru.Vector3,fu=new ru.Vector3,gu=new ru.Vector3,vu=new ru.Spherical,yu=new ru.Spherical,bu=new ru.Box3,_u=new ru.Box3,wu=new ru.Sphere,xu=new ru.Quaternion,Tu=new ru.Quaternion,Eu=new ru.Matrix4,Mu=new ru.Raycaster}static get ACTION(){return Lc}constructor(t,n){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Lc.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=kc,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new ru.Vector3,this._focalOffsetVelocity=new ru.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,n)=>{let r,o;if(Fc(this._camera)){const n=lu.copy(this._camera.position).sub(this._target),i=this._camera.getEffectiveFOV()*Hc,s=n.length()*Math.tan(.5*i);r=this.truckSpeed*e*s/this._elementRect.height,o=this.truckSpeed*t*s/this._elementRect.height}else{if(!Nc(this._camera))return;{const n=this._camera;r=e*(n.right-n.left)/n.zoom/this._elementRect.width,o=t*(n.top-n.bottom)/n.zoom/this._elementRect.height}}this.verticalDragToForward?(n?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(r,0,!0),this.forward(-o,!0)):n?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+o,this._focalOffsetEnd.z,!0):this.truck(r,o,!0)},this._rotateInternal=(e,t)=>{const n=zc*this.azimuthRotateSpeed*e/this._elementRect.height,r=zc*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(n,r,!0)},this._dollyInternal=(e,t,n)=>{const r=Math.pow(.95,-e*this.dollySpeed),o=this._sphericalEnd.radius,i=this._sphericalEnd.radius*r,s=Vc(i,this.minDistance,this.maxDistance),a=s-i;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(i,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(a,!0),this._dollyToNoClamp(s,!0)):this._dollyToNoClamp(s,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?i:s)-o,this._dollyControlCoord.set(t,n)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,n)=>{const r=Math.pow(.95,e*this.dollySpeed),o=this._zoom,i=this._zoom*r;this.zoomTo(i,!0),this.dollyToCursor&&(this._changedZoom+=i-o,this._dollyControlCoord.set(t,n))},typeof ru>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=(new ru.Quaternion).setFromUnitVectors(this._camera.up,iu),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Lc.NONE,this._target=new ru.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new ru.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new ru.Spherical).setFromVector3(lu.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new ru.Vector3,new ru.Vector3,new ru.Vector3,new ru.Vector3],this._updateNearPlaneCorners(),this._boundary=new ru.Box3(new ru.Vector3(-1/0,-1/0,-1/0),new ru.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new ru.Vector2,this.mouseButtons={left:Lc.ROTATE,middle:Lc.DOLLY,right:Lc.TRUCK,wheel:Fc(this._camera)?Lc.DOLLY:Nc(this._camera)?Lc.ZOOM:Lc.NONE},this.touches={one:Lc.TOUCH_ROTATE,two:Fc(this._camera)?Lc.TOUCH_DOLLY_TRUCK:Nc(this._camera)?Lc.TOUCH_ZOOM_TRUCK:Lc.NONE,three:Lc.TOUCH_TRUCK};const r=new ru.Vector2,o=new ru.Vector2,i=new ru.Vector2,s=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}const t="mouse"!==e.pointerType?null:(e.buttons&Ic)===Ic?Ic:(e.buttons&Rc)===Rc?Rc:(e.buttons&Pc)===Pc?Pc:null;if(null!==t){const e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&Ic)===Ic&&this._lockedPointer)return;const n={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(n),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),this._isDragging=!0,d(e)},a=e=>{e.cancelable&&e.preventDefault();const t=e.pointerId,n=this._lockedPointer||this._findPointerById(t);if(n){if(n.clientX=e.clientX,n.clientY=e.clientY,n.deltaX=e.movementX,n.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&Ic)===Ic)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&Rc)===Rc&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&Pc)===Pc&&(this._state=this._state|this.mouseButtons.right);p()}},l=e=>{const t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=Lc.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=Lc.NONE;m()}};let c=-1;const u=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Lc.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Lc.ROTATE||this.mouseButtons.wheel===Lc.TRUCK){const e=performance.now();c-e<1e3&&this._getClientRect(this._elementRect),c=e}const t=nu?-1:-3,n=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),r=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,o=this.dollyToCursor?(e.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Lc.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case Lc.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case Lc.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case Lc.DOLLY:this._dollyInternal(-n,r,o),this._isUserControllingDolly=!0;break;case Lc.ZOOM:this._zoomInternal(-n,r,o),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},h=t=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===e.ACTION.NONE){const e=t instanceof PointerEvent?t.pointerId:0,n=this._findPointerById(e);return n&&this._disposePointer(n),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),void this._domElement.ownerDocument.removeEventListener("pointerup",l)}t.preventDefault()}},d=e=>{if(this._enabled){if(Qc(this._activePointers,au),this._getClientRect(this._elementRect),r.copy(au),o.copy(au),this._activePointers.length>=2){const e=au.x-this._activePointers[1].clientX,t=au.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t);i.set(0,n);const r=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),s=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);o.set(r,s)}if(this._state=0,e)if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else!this._lockedPointer&&(e.buttons&Ic)===Ic&&(this._state=this._state|this.mouseButtons.left),(e.buttons&Rc)===Rc&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&Pc)===Pc&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&Lc.ROTATE)===Lc.ROTATE||(this._state&Lc.TOUCH_ROTATE)===Lc.TOUCH_ROTATE||(this._state&Lc.TOUCH_DOLLY_ROTATE)===Lc.TOUCH_DOLLY_ROTATE||(this._state&Lc.TOUCH_ZOOM_ROTATE)===Lc.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Lc.TRUCK)===Lc.TRUCK||(this._state&Lc.TOUCH_TRUCK)===Lc.TOUCH_TRUCK||(this._state&Lc.TOUCH_DOLLY_TRUCK)===Lc.TOUCH_DOLLY_TRUCK||(this._state&Lc.TOUCH_ZOOM_TRUCK)===Lc.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Lc.DOLLY)===Lc.DOLLY||(this._state&Lc.TOUCH_DOLLY)===Lc.TOUCH_DOLLY||(this._state&Lc.TOUCH_DOLLY_TRUCK)===Lc.TOUCH_DOLLY_TRUCK||(this._state&Lc.TOUCH_DOLLY_OFFSET)===Lc.TOUCH_DOLLY_OFFSET||(this._state&Lc.TOUCH_DOLLY_ROTATE)===Lc.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Lc.ZOOM)===Lc.ZOOM||(this._state&Lc.TOUCH_ZOOM)===Lc.TOUCH_ZOOM||(this._state&Lc.TOUCH_ZOOM_TRUCK)===Lc.TOUCH_ZOOM_TRUCK||(this._state&Lc.TOUCH_ZOOM_OFFSET)===Lc.TOUCH_ZOOM_OFFSET||(this._state&Lc.TOUCH_ZOOM_ROTATE)===Lc.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Lc.OFFSET)===Lc.OFFSET||(this._state&Lc.TOUCH_OFFSET)===Lc.TOUCH_OFFSET||(this._state&Lc.TOUCH_DOLLY_OFFSET)===Lc.TOUCH_DOLLY_OFFSET||(this._state&Lc.TOUCH_ZOOM_OFFSET)===Lc.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},p=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Qc(this._activePointers,au);const e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:o.x-au.x,n=e?-e.deltaY:o.y-au.y;if(o.copy(au),((this._state&Lc.ROTATE)===Lc.ROTATE||(this._state&Lc.TOUCH_ROTATE)===Lc.TOUCH_ROTATE||(this._state&Lc.TOUCH_DOLLY_ROTATE)===Lc.TOUCH_DOLLY_ROTATE||(this._state&Lc.TOUCH_ZOOM_ROTATE)===Lc.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,n),this._isUserControllingRotate=!0),(this._state&Lc.DOLLY)===Lc.DOLLY||(this._state&Lc.ZOOM)===Lc.ZOOM){const e=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0,o=this.dollyDragInverted?-1:1;(this._state&Lc.DOLLY)===Lc.DOLLY?(this._dollyInternal(o*n*tu,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(o*n*tu,e,t),this._isUserControllingZoom=!0)}if((this._state&Lc.TOUCH_DOLLY)===Lc.TOUCH_DOLLY||(this._state&Lc.TOUCH_ZOOM)===Lc.TOUCH_ZOOM||(this._state&Lc.TOUCH_DOLLY_TRUCK)===Lc.TOUCH_DOLLY_TRUCK||(this._state&Lc.TOUCH_ZOOM_TRUCK)===Lc.TOUCH_ZOOM_TRUCK||(this._state&Lc.TOUCH_DOLLY_OFFSET)===Lc.TOUCH_DOLLY_OFFSET||(this._state&Lc.TOUCH_ZOOM_OFFSET)===Lc.TOUCH_ZOOM_OFFSET||(this._state&Lc.TOUCH_DOLLY_ROTATE)===Lc.TOUCH_DOLLY_ROTATE||(this._state&Lc.TOUCH_ZOOM_ROTATE)===Lc.TOUCH_ZOOM_ROTATE){const e=au.x-this._activePointers[1].clientX,t=au.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t),r=i.y-n;i.set(0,n);const s=this.dollyToCursor?(o.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(o.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Lc.TOUCH_DOLLY)===Lc.TOUCH_DOLLY||(this._state&Lc.TOUCH_DOLLY_ROTATE)===Lc.TOUCH_DOLLY_ROTATE||(this._state&Lc.TOUCH_DOLLY_TRUCK)===Lc.TOUCH_DOLLY_TRUCK||(this._state&Lc.TOUCH_DOLLY_OFFSET)===Lc.TOUCH_DOLLY_OFFSET?(this._dollyInternal(r*tu,s,a),this._isUserControllingDolly=!0):(this._zoomInternal(r*tu,s,a),this._isUserControllingZoom=!0)}((this._state&Lc.TRUCK)===Lc.TRUCK||(this._state&Lc.TOUCH_TRUCK)===Lc.TOUCH_TRUCK||(this._state&Lc.TOUCH_DOLLY_TRUCK)===Lc.TOUCH_DOLLY_TRUCK||(this._state&Lc.TOUCH_ZOOM_TRUCK)===Lc.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,n,!1),this._isUserControllingTruck=!0),((this._state&Lc.OFFSET)===Lc.OFFSET||(this._state&Lc.TOUCH_OFFSET)===Lc.TOUCH_OFFSET||(this._state&Lc.TOUCH_DOLLY_OFFSET)===Lc.TOUCH_DOLLY_OFFSET||(this._state&Lc.TOUCH_ZOOM_OFFSET)===Lc.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,n,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},m=()=>{Qc(this._activePointers,au),o.copy(au),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",f),this._domElement.ownerDocument.addEventListener("pointerlockerror",g),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",l),d())},this.unlockPointer=()=>{var e,t,n;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",f),null===(n=this._domElement)||void 0===n||n.ownerDocument.removeEventListener("pointerlockerror",g),this.cancel()};const f=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},g=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",s),this._domElement.addEventListener("pointercancel",l),this._domElement.addEventListener("wheel",u,{passive:!1}),this._domElement.addEventListener("contextmenu",h)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",s),this._domElement.removeEventListener("pointercancel",l),this._domElement.removeEventListener("wheel",u,{passive:!1}),this._domElement.removeEventListener("contextmenu",h),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",l),this._domElement.ownerDocument.removeEventListener("pointerlockchange",f),this._domElement.ownerDocument.removeEventListener("pointerlockerror",g))},this.cancel=()=>{this._state!==Lc.NONE&&(this._state=Lc.NONE,this._activePointers.length=0,m())},n&&this.connect(n),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=Vc(e.width,0,1),this._interactiveArea.height=Vc(e.height,0,1),this._interactiveArea.x=Vc(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Vc(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=Vc(e,this.minAzimuthAngle,this.maxAzimuthAngle),o=Vc(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=o,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const i=!n||Xc(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Xc(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(i)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=kc,this._changedDolly=0,this._dollyToNoClamp(Vc(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const t=this._collisionTest(),r=Xc(t,this._spherical.radius);if(!(n>e)&&r)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||Xc(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(hu).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||Xc(this._target.x,this._targetEnd.x,this.restThreshold)&&Xc(this._target.y,this._targetEnd.y,this.restThreshold)&&Xc(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=Vc(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||Xc(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),du.setFromMatrixColumn(this._camera.matrix,0),pu.setFromMatrixColumn(this._camera.matrix,1),du.multiplyScalar(e),pu.multiplyScalar(-t);const r=lu.copy(du).add(pu),o=cu.copy(this._targetEnd).add(r);return this.moveTo(o.x,o.y,o.z,n)}forward(e,t=!1){lu.setFromMatrixColumn(this._camera.matrix,0),lu.crossVectors(this._camera.up,lu),lu.multiplyScalar(e);const n=cu.copy(this._targetEnd).add(lu);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return lu.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+lu.x,this._targetEnd.y+lu.y,this._targetEnd.z+lu.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const o=lu.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,o,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const i=!r||Xc(this._target.x,this._targetEnd.x,this.restThreshold)&&Xc(this._target.y,this._targetEnd.y,this.restThreshold)&&Xc(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}lookInDirectionOf(e,t,n,r=!1){const o=lu.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(o.x,o.y,o.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:o=0,paddingBottom:i=0,paddingTop:s=0}={}){const a=[],l=e.isBox3?bu.copy(e):bu.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=Gc(this._sphericalEnd.theta,jc),u=Gc(this._sphericalEnd.phi,jc);a.push(this.rotateTo(c,u,t));const h=lu.setFromSpherical(this._sphericalEnd).normalize(),d=xu.setFromUnitVectors(h,su),p=Xc(Math.abs(h.y),1);p&&d.multiply(Tu.setFromAxisAngle(iu,c)),d.multiply(this._yAxisUpSpaceInverse);const m=_u.makeEmpty();cu.copy(l.min).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.min).setX(l.max.x).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.min).setY(l.max.y).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.max).setZ(l.min.z).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.min).setZ(l.max.z).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.max).setY(l.min.y).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.max).setX(l.min.x).applyQuaternion(d),m.expandByPoint(cu),cu.copy(l.max).applyQuaternion(d),m.expandByPoint(cu),m.min.x-=r,m.min.y-=i,m.max.x+=o,m.max.y+=s,d.setFromUnitVectors(su,h),p&&d.premultiply(Tu.invert()),d.premultiply(this._yAxisUpSpace);const f=m.getSize(lu),g=m.getCenter(cu).applyQuaternion(d);if(Fc(this._camera)){const e=this.getDistanceToFitBox(f.x,f.y,f.z,n);a.push(this.moveTo(g.x,g.y,g.z,t)),a.push(this.dollyTo(e,t)),a.push(this.setFocalOffset(0,0,0,t))}else if(Nc(this._camera)){const e=this._camera,r=e.right-e.left,o=e.top-e.bottom,i=n?Math.max(r/f.x,o/f.y):Math.min(r/f.x,o/f.y);a.push(this.moveTo(g.x,g.y,g.z,t)),a.push(this.zoomTo(i,t)),a.push(this.setFocalOffset(0,0,0,t))}return Promise.all(a)}fitToSphere(t,n){const r=[],o="isObject3D"in t?e.createBoundingSphere(t,wu):wu.copy(t);if(r.push(this.moveTo(o.center.x,o.center.y,o.center.z,n)),Fc(this._camera)){const e=this.getDistanceToFitSphere(o.radius);r.push(this.dollyTo(e,n))}else if(Nc(this._camera)){const e=this._camera.right-this._camera.left,t=this._camera.top-this._camera.bottom,i=2*o.radius,s=Math.min(e/i,t/i);r.push(this.zoomTo(s,n))}return r.push(this.setFocalOffset(0,0,0,n)),Promise.all(r)}setLookAt(e,t,n,r,o,i,s=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=kc,this._changedDolly=0;const a=cu.set(r,o,i),l=lu.set(e,t,n);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(l.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,s||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const c=!s||Xc(this._target.x,this._targetEnd.x,this.restThreshold)&&Xc(this._target.y,this._targetEnd.y,this.restThreshold)&&Xc(this._target.z,this._targetEnd.z,this.restThreshold)&&Xc(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Xc(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Xc(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,n,r,o,i,s,a,l,c,u,h,d,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=kc,this._changedDolly=0;const m=lu.set(r,o,i),f=cu.set(e,t,n);vu.setFromVector3(f.sub(m).applyQuaternion(this._yAxisUpSpace));const g=uu.set(c,u,h),v=cu.set(s,a,l);yu.setFromVector3(v.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(m.lerp(g,d));const y=yu.theta-vu.theta,b=yu.phi-vu.phi,_=yu.radius-vu.radius;this._sphericalEnd.set(vu.radius+_*d,vu.phi+b*d,vu.theta+y*d),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const w=!p||Xc(this._target.x,this._targetEnd.x,this.restThreshold)&&Xc(this._target.y,this._targetEnd.y,this.restThreshold)&&Xc(this._target.z,this._targetEnd.z,this.restThreshold)&&Xc(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Xc(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Xc(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(w)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const o=this.getPosition(lu),i=this.setLookAt(o.x,o.y,o.z,e,t,n,r);return this._sphericalEnd.phi=Vc(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),i}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const o=!r||Xc(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Xc(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Xc(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),du.setFromMatrixColumn(this._camera.matrixWorldInverse,0),pu.setFromMatrixColumn(this._camera.matrixWorldInverse,1),mu.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=lu.set(e,t,n),o=r.distanceTo(this._camera.position),i=r.sub(this._camera.position);du.multiplyScalar(i.x),pu.multiplyScalar(i.y),mu.multiplyScalar(i.z),lu.copy(du).add(pu).add(mu),lu.z=lu.z+o,this.dollyTo(o,!1),this.setFocalOffset(-lu.x,lu.y,-lu.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){null!==e?(this._viewport=this._viewport||new ru.Vector4,"number"==typeof e?this._viewport.set(e,t,n,r):this._viewport.copy(e)):this._viewport=null}getDistanceToFitBox(e,t,n,r=!1){if($c(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const o=e/t,i=this._camera.getEffectiveFOV()*Hc,s=this._camera.aspect;return.5*((r?o>s:o<s)?t:e/s)/Math.tan(.5*i)+.5*n}getDistanceToFitSphere(e){if($c(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Hc,n=2*Math.atan(Math.tan(.5*t)*this._camera.aspect),r=1<this._camera.aspect?t:n;return e/Math.sin(.5*r)}getTarget(e,t=!0){return(e&&e.isVector3?e:new ru.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new ru.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new ru.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new ru.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%zc,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=zc),this._spherical.theta+=zc*Math.round((this._sphericalEnd.theta-this._spherical.theta)/zc)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!Xc(this._camera.up.x,this._cameraUp0.x)||!Xc(this._camera.up.y,this._cameraUp0.y)||!Xc(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const e=this.getPosition(lu);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,iu),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=lu.subVectors(this._target,this._camera.position).normalize(),t=cu.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(lu);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,o=fu.subVectors(this._targetEnd,this._target),i=gu.subVectors(this._focalOffsetEnd,this._focalOffset),s=this._zoomEnd-this._zoom;if(Yc(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Kc(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(Yc(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Kc(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(Yc(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Kc(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(Yc(o.x)&&Yc(o.y)&&Yc(o.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;qc(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Yc(i.x)&&Yc(i.y)&&Yc(i.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;qc(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Yc(s))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Kc(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor)if(Fc(this._camera)&&0!==this._changedDolly){const e=this._spherical.radius-this._lastDistance,t=this._camera,n=this._getCameraDirection(hu),r=lu.copy(n).cross(t.up).normalize();0===r.lengthSq()&&(r.x=1);const o=cu.crossVectors(r,n),i=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*Hc*.5),s=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=uu.copy(this._targetEnd).add(r.multiplyScalar(this._dollyControlCoord.x*i*t.aspect)).add(o.multiplyScalar(this._dollyControlCoord.y*i)),l=lu.copy(this._targetEnd).lerp(a,s),c=this._lastDollyDirection===Dc&&this._spherical.radius<=this.minDistance,u=this._lastDollyDirection===Uc&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||u)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;const t=cu.copy(n).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);const h=cu.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedDolly-=e,Yc(this._changedDolly)&&(this._changedDolly=0)}else if(Nc(this._camera)&&0!==this._changedZoom){const e=this._zoom-this._lastZoom,t=this._camera,n=lu.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),r=cu.set(0,0,-1).applyQuaternion(t.quaternion),o=uu.copy(n).add(r.multiplyScalar(-n.dot(t.up))),i=-(this._zoom-e-this._zoom)/this._zoom,s=this._getCameraDirection(hu),a=this._targetEnd.dot(s),l=lu.copy(this._targetEnd).lerp(o,i),c=l.dot(s),u=s.multiplyScalar(c-a);l.sub(u),this._boundary.clampPoint(l,l);const h=cu.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedZoom-=e,Yc(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Yc(this._focalOffset.x)||!Yc(this._focalOffset.y)||!Yc(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),du.setFromMatrixColumn(this._camera.matrix,0),pu.setFromMatrixColumn(this._camera.matrix,1),mu.setFromMatrixColumn(this._camera.matrix,2),du.multiplyScalar(this._focalOffset.x),pu.multiplyScalar(-this._focalOffset.y),mu.multiplyScalar(this._focalOffset.z),lu.copy(du).add(pu).add(mu),this._camera.position.add(lu)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),lu.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),Yc(t,this.restThreshold)&&Yc(n,this.restThreshold)&&Yc(r,this.restThreshold)&&Yc(o.x,this.restThreshold)&&Yc(o.y,this.restThreshold)&&Yc(o.z,this.restThreshold)&&Yc(i.x,this.restThreshold)&&Yc(i.y,this.restThreshold)&&Yc(i.z,this.restThreshold)&&Yc(s,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Wc(this.maxDistance),minZoom:this.minZoom,maxZoom:Wc(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Wc(this.maxPolarAngle),minAzimuthAngle:Wc(this.minAzimuthAngle),maxAzimuthAngle:Wc(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:lu.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=Zc(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=Zc(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=Zc(n.maxPolarAngle),this.minAzimuthAngle=Zc(n.minAzimuthAngle),this.maxAzimuthAngle=Zc(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),vu.setFromVector3(lu.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(vu.theta,vu.phi,t),this.dollyTo(vu.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){this._domElement?console.warn("camera-controls is already connected."):(e.setAttribute("data-camera-controls-version","2.9.0"),this._addAllEventListeners(e),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find((t=>t.pointerId===e))}_findPointerByMouseButton(e){return this._activePointers.find((t=>t.mouseButton===e))}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(0===r)return e;const o=cu.copy(t).add(e),i=this._boundary.clampPoint(o,uu).sub(o),s=i.lengthSq();if(0===s)return e.add(t);if(s===r)return e;if(0===n)return e.add(t).add(i);{const r=1+n*s/t.dot(i);return e.add(cu.copy(t).multiplyScalar(r)).add(i.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(Fc(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*Hc,r=Math.tan(.5*n)*t,o=r*e.aspect;this._nearPlaneCorners[0].set(-o,-r,0),this._nearPlaneCorners[1].set(o,-r,0),this._nearPlaneCorners[2].set(o,r,0),this._nearPlaneCorners[3].set(-o,r,0)}else if(Nc(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,o=e.top*t,i=e.bottom*t;this._nearPlaneCorners[0].set(n,o,0),this._nearPlaneCorners[1].set(r,o,0),this._nearPlaneCorners[2].set(r,i,0),this._nearPlaneCorners[3].set(n,i,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||$c(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(hu);Eu.lookAt(ou,t,this._camera.up);for(let n=0;n<4;n++){const r=cu.copy(this._nearPlaneCorners[n]);r.applyMatrix4(Eu);const o=uu.addVectors(this._target,r);Mu.set(o,t),Mu.far=this._spherical.radius+1;const i=Mu.intersectObjects(this.colliderMeshes);0!==i.length&&i[0].distance<e&&(e=i[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((e=>{const t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)})))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new ru.Sphere){const n=t,r=n.center;bu.makeEmpty(),e.traverseVisible((e=>{e.isMesh&&bu.expandByObject(e)})),bu.getCenter(r);let o=0;return e.traverseVisible((e=>{if(!e.isMesh)return;const t=e,n=t.geometry.clone();n.applyMatrix4(t.matrixWorld);const i=n.attributes.position;for(let s=0,a=i.count;s<a;s++)lu.fromBufferAttribute(i,s),o=Math.max(o,r.distanceToSquared(lu))})),n.radius=Math.sqrt(o),n}};const Su=e=>!(!e||!e.isPerspectiveCamera),Ou=e=>!(!e||!e.isOrthographicCamera),Cu=["min-polar-angle","max-polar-angle","min-azimuth-angle","max-azimuth-angle","distance","min-distance","max-distance","infinity-dolly","min-zoom","max-zoom","smooth-time","dragging-smooth-time","max-speed","azimuth-rotate-speed","polar-rotate-speed","dolly-speed","dolly-drag-inverted","truck-speed","dolly-to-cursor","drag-to-offset","vertical-drag-to-forward","boundary-friction","rest-threshold","collider-meshes","args","mouse-buttons","touches"],Iu=(e,t)=>a({left:Au.ACTION.ROTATE,middle:Au.ACTION.DOLLY,right:Au.ACTION.TRUCK,wheel:Su(e)?Au.ACTION.DOLLY:Ou(e)?Au.ACTION.ZOOM:Au.ACTION.NONE},t),Pu=(e,t)=>a({one:Au.ACTION.TOUCH_ROTATE,two:Su(e)?Au.ACTION.TOUCH_DOLLY_TRUCK:Ou(e)?Au.ACTION.TOUCH_ZOOM_TRUCK:Au.ACTION.NONE,three:Au.ACTION.TOUCH_TRUCK},t),Ru=Jt({__name:"CameraControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},minPolarAngle:{default:0},maxPolarAngle:{default:Math.PI},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},distance:{default:()=>wo().camera.value.position.z},minDistance:{default:Number.EPSILON},maxDistance:{default:Number.POSITIVE_INFINITY},infinityDolly:{type:Boolean,default:!1},minZoom:{default:.01},maxZoom:{default:Number.POSITIVE_INFINITY},smoothTime:{default:.25},draggingSmoothTime:{default:.125},maxSpeed:{default:Number.POSITIVE_INFINITY},azimuthRotateSpeed:{default:1},polarRotateSpeed:{default:1},dollySpeed:{default:1},dollyDragInverted:{type:Boolean,default:!1},truckSpeed:{default:2},dollyToCursor:{type:Boolean,default:!1},dragToOffset:{type:Boolean,default:!1},verticalDragToForward:{type:Boolean,default:!1},boundaryFriction:{default:0},restThreshold:{default:.01},colliderMeshes:{default:()=>[]},mouseButtons:{default:()=>Iu(wo().camera.value)},touches:{default:()=>Pu(wo().camera.value)}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,o=n,{makeDefault:i,minPolarAngle:s,maxPolarAngle:a,minAzimuthAngle:l,maxAzimuthAngle:c,distance:u,minDistance:h,maxDistance:d,infinityDolly:m,minZoom:f,maxZoom:g,smoothTime:v,draggingSmoothTime:y,maxSpeed:_,azimuthRotateSpeed:w,polarRotateSpeed:x,dollySpeed:T,dollyDragInverted:E,truckSpeed:M,dollyToCursor:A,dragToOffset:S,verticalDragToForward:O,boundaryFriction:C,restThreshold:I,colliderMeshes:P}=Xt(r),R={Box3:J,MathUtils:{clamp:b.clamp},Matrix4:q,Quaternion:ee,Raycaster:p,Sphere:te,Spherical:ne,Vector2:N,Vector3:z,Vector4:re};Au.install({THREE:R});const{camera:L,renderer:k,extend:D,controls:U,invalidate:F}=wo();Bt(r,(()=>{F()}));const j=Kt((()=>Iu(r.camera||L.value,r.mouseButtons))),B=Kt((()=>Pu(r.camera||L.value,r.touches))),H=jt(null);D({CameraControls:Au}),qt((()=>{rl(H.value,"update",(()=>{o("change",H.value),F()})),rl(H.value,"controlend",(()=>o("end",H.value))),rl(H.value,"controlstart",(()=>o("start",H.value))),H.value&&i.value?U.value=H.value:U.value=null}));const{onBeforeRender:V}=xo();return V((({delta:e,invalidate:t})=>{var n,r;null!=(n=H.value)&&n.enabled&&(null==(r=H.value)||r.update(e),t())})),nn((()=>{H.value&&H.value.disconnect()})),t({instance:H}),(e,t)=>(e.camera||zt(L))&&(e.domElement||zt(k))?(rn(),on("TresCameraControls",{key:0,ref_key:"controlsRef",ref:H,"min-polar-angle":zt(s),"max-polar-angle":zt(a),"min-azimuth-angle":zt(l),"max-azimuth-angle":zt(c),distance:zt(u),"min-distance":zt(h),"max-distance":zt(d),"infinity-dolly":zt(m),"min-zoom":zt(f),"max-zoom":zt(g),"smooth-time":zt(v),"dragging-smooth-time":zt(y),"max-speed":zt(_),"azimuth-rotate-speed":zt(w),"polar-rotate-speed":zt(x),"dolly-speed":zt(T),"dolly-drag-inverted":zt(E),"truck-speed":zt(M),"dolly-to-cursor":zt(A),"drag-to-offset":zt(S),"vertical-drag-to-forward":zt(O),"boundary-friction":zt(C),"rest-threshold":zt(I),"collider-meshes":zt(P),args:[e.camera||zt(L),e.domElement||zt(k).domElement],"mouse-buttons":j.value,touches:B.value},null,8,Cu)):mn("",!0)}});class Lu extends ke{constructor(e={}){super(e),Qo(this,"_time"),Qo(this,"_factor"),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms||(e.uniforms={}),e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader="\n        uniform float time;\n        uniform float factor;\n        ".concat(e.vertexShader,"\n      "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n          float c = cos( theta );\n          float s = sin( theta );\n          mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n          vec3 transformed = vec3( position ) * m;\n          vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const ku=["factor"],Du=Jt({__name:"index",props:{speed:{default:1},factor:{default:1}},setup(e,{expose:t}){const n=e,r=tn(),{extend:o,invalidate:i}=wo();o({MeshWobbleMaterial:Lu}),Bt(n,(()=>i()));const{onBeforeRender:s}=xo();return s((({elapsed:e,invalidate:t})=>{r.value&&(r.value.time=e*(null==n?void 0:n.speed),t())})),t({instance:r}),(e,t)=>(rn(),on("TresMeshWobbleMaterial",vn({ref_key:"materialRef",ref:r,factor:e.factor},e.$attrs),null,16,ku))}});function Uu(e,t,n){return Math.max(t,Math.min(n,e))}function Fu(e,t,n){return(1-n)*e+n*t}class Nu{constructor(e=0,t=0){Nu.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Uu(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),o=this.x-e.x,i=this.y-e.y;return this.x=o*n-i*r+e.x,this.y=o*r+i*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}const zu="srgb",ju="srgb-linear",Bu="display-p3",Hu="display-p3-linear",Vu="linear",Yu="srgb",Xu="rec709";class Gu{constructor(e,t,n,r,o,i,s,a,l){Gu.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,o,i,s,a,l)}set(e,t,n,r,o,i,s,a,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=o,c[5]=a,c[6]=n,c[7]=i,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,o=this.elements,i=n[0],s=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],m=r[0],f=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],w=r[5],x=r[8];return o[0]=i*m+s*v+a*_,o[3]=i*f+s*y+a*w,o[6]=i*g+s*b+a*x,o[1]=l*m+c*v+u*_,o[4]=l*f+c*y+u*w,o[7]=l*g+c*b+u*x,o[2]=h*m+d*v+p*_,o[5]=h*f+d*y+p*w,o[8]=h*g+d*b+p*x,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*i*c-t*s*l-n*o*c+n*s*a+r*o*l-r*i*a}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=c*i-s*l,h=s*a-c*o,d=l*o-i*a,p=t*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=u*m,e[1]=(r*l-c*n)*m,e[2]=(s*n-r*i)*m,e[3]=h*m,e[4]=(c*t-r*a)*m,e[5]=(r*o-s*t)*m,e[6]=d*m,e[7]=(n*a-l*t)*m,e[8]=(i*t-n*o)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,o,i,s){const a=Math.cos(o),l=Math.sin(o);return this.set(n*a,n*l,-n*(a*i+l*s)+i+e,-r*l,r*a,-r*(-l*i+a*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(Wu.makeScale(e,t)),this}rotate(e){return this.premultiply(Wu.makeRotation(-e)),this}translate(e,t){return this.premultiply(Wu.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Wu=new Gu,Zu=(new Gu).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Ku=(new Gu).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),qu={[ju]:{transfer:Vu,primaries:Xu,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e,fromReference:e=>e},[zu]:{transfer:Yu,primaries:Xu,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[Hu]:{transfer:Vu,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.applyMatrix3(Ku),fromReference:e=>e.applyMatrix3(Zu)},[Bu]:{transfer:Yu,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.convertSRGBToLinear().applyMatrix3(Ku),fromReference:e=>e.applyMatrix3(Zu).convertLinearToSRGB()}},Qu=new Set([ju,Hu]),$u={enabled:!0,_workingColorSpace:ju,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!Qu.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const r=qu[t].toReference;return(0,qu[n].fromReference)(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return qu[e].primaries},getTransfer:function(e){return""===e?Vu:qu[e].transfer},getLuminanceCoefficients:function(e,t=this._workingColorSpace){return e.fromArray(qu[t].luminanceCoefficients)}};function Ju(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function eh(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const th={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nh={h:0,s:0,l:0},rh={h:0,s:0,l:0};function oh(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class ih{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=zu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,$u.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=$u.workingColorSpace){return this.r=e,this.g=t,this.b=n,$u.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=$u.workingColorSpace){if(e=function(e,t){return(e%t+t)%t}(e,1),t=Uu(t,0,1),n=Uu(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=oh(o,r,e+1/3),this.g=oh(o,r,e),this.b=oh(o,r,e-1/3)}return $u.toWorkingColorSpace(this,r),this}setStyle(e,t=zu){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const i=r[1],s=r[2];switch(i){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],o=n.length;if(3===o)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=zu){const n=th[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ju(e.r),this.g=Ju(e.g),this.b=Ju(e.b),this}copyLinearToSRGB(e){return this.r=eh(e.r),this.g=eh(e.g),this.b=eh(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=zu){return $u.fromWorkingColorSpace(sh.copy(this),e),65536*Math.round(Uu(255*sh.r,0,255))+256*Math.round(Uu(255*sh.g,0,255))+Math.round(Uu(255*sh.b,0,255))}getHexString(e=zu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$u.workingColorSpace){$u.fromWorkingColorSpace(sh.copy(this),t);const n=sh.r,r=sh.g,o=sh.b,i=Math.max(n,r,o),s=Math.min(n,r,o);let a,l;const c=(s+i)/2;if(s===i)a=0,l=0;else{const e=i-s;switch(l=c<=.5?e/(i+s):e/(2-i-s),i){case n:a=(r-o)/e+(r<o?6:0);break;case r:a=(o-n)/e+2;break;case o:a=(n-r)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e,t=$u.workingColorSpace){return $u.fromWorkingColorSpace(sh.copy(this),t),e.r=sh.r,e.g=sh.g,e.b=sh.b,e}getStyle(e=zu){$u.fromWorkingColorSpace(sh.copy(this),e);const t=sh.r,n=sh.g,r=sh.b;return e!==zu?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}offsetHSL(e,t,n){return this.getHSL(nh),this.setHSL(nh.h+e,nh.s+t,nh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(nh),e.getHSL(rh);const n=Fu(nh.h,rh.h,t),r=Fu(nh.s,rh.s,t),o=Fu(nh.l,rh.l,t);return this.setHSL(n,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,o=e.elements;return this.r=o[0]*t+o[3]*n+o[6]*r,this.g=o[1]*t+o[4]*n+o[7]*r,this.b=o[2]*t+o[5]*n+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const sh=new ih;ih.NAMES=th;class ah extends ke{constructor(e={}){super(),Qo(this,"isMeshPhysicalMaterial"),Qo(this,"clearcoatMap"),Qo(this,"clearcoatRoughness"),Qo(this,"clearcoatRoughnessMap"),Qo(this,"clearcoatNormalScale"),Qo(this,"clearcoatNormalMap"),Qo(this,"ior"),Qo(this,"transmissionMap"),Qo(this,"thickness"),Qo(this,"thicknessMap"),Qo(this,"attenuationDistance"),Qo(this,"attenuationColor"),Qo(this,"specularIntensity"),Qo(this,"specularIntensityMap"),Qo(this,"specularColor"),Qo(this,"specularColorMap"),Qo(this,"_clearcoat"),Qo(this,"_transmission"),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Nu(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get(){return Uu(2.5*(this.ior-1)/(this.ior+1),0,1)},set(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.roughness=0,this.transmissionMap=null,this.thickness=.5,this.thicknessMap=null,this.attenuationDistance=Number.POSITIVE_INFINITY,this.attenuationColor=new ih(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ih(1,1,1),this.specularColorMap=null,this._clearcoat=.5,this._transmission=1,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const lh=Jt({__name:"index",setup(e,{expose:t}){const n=tn(),{extend:r}=wo();return r({MeshGlassMaterial:ah}),t({instance:n}),(e,t)=>(rn(),on("TresMeshGlassMaterial",{ref_key:"MeshGlassMaterialClass",ref:n},null,512))}});typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"&&self;function ch(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function uh(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hh={exports:{}};hh.exports=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){if(!a&&uh)return uh(s);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}a=n[s]={exports:{}},t[s][0].call(a.exports,(function(e){return o(t[s][1][e]||e)}),a,a.exports,e,t,n,r)}return n[s].exports}for(var i=uh,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){(function(r,o,i,s,a,l,c,u,h){var d=e("crypto");function p(e,t){var n;return void 0===(n="passthrough"!==(t=g(e,t)).algorithm?d.createHash(t.algorithm):new b).write&&(n.write=n.update,n.end=n.update),y(t,n).dispatch(e),n.update||n.end(""),n.digest?n.digest("buffer"===t.encoding?void 0:t.encoding):(e=n.read(),"buffer"!==t.encoding?e.toString(t.encoding):e)}(n=t.exports=p).sha1=function(e){return p(e)},n.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},n.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},n.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=d.getHashes?d.getHashes().slice():["sha1","md5"],f=(m.push("passthrough"),["buffer","hex","binary","base64"]);function g(e,t){var n={};if(n.algorithm=(t=t||{}).algorithm||"sha1",n.encoding=t.encoding||"hex",n.excludeValues=!!t.excludeValues,n.algorithm=n.algorithm.toLowerCase(),n.encoding=n.encoding.toLowerCase(),n.ignoreUnknown=!0===t.ignoreUnknown,n.respectType=!1!==t.respectType,n.respectFunctionNames=!1!==t.respectFunctionNames,n.respectFunctionProperties=!1!==t.respectFunctionProperties,n.unorderedArrays=!0===t.unorderedArrays,n.unorderedSets=!1!==t.unorderedSets,n.unorderedObjects=!1!==t.unorderedObjects,n.replacer=t.replacer||void 0,n.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var r=0;r<m.length;++r)m[r].toLowerCase()===n.algorithm.toLowerCase()&&(n.algorithm=m[r]);if(-1===m.indexOf(n.algorithm))throw new Error('Algorithm "'+n.algorithm+'"  not supported. supported values: '+m.join(", "));if(-1===f.indexOf(n.encoding)&&"passthrough"!==n.algorithm)throw new Error('Encoding "'+n.encoding+'"  not supported. supported values: '+f.join(", "));return n}function v(e){if("function"==typeof e)return null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function y(e,t,n){function r(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")}return n=n||[],{dispatch:function(t){return this["_"+(null===(t=e.replacer?e.replacer(t):t)?"null":typeof t)](t)},_object:function(t){var o,s=Object.prototype.toString.call(t),a=/\[object (.*)\]/i.exec(s);if(a=(a=a?a[1]:"unknown:["+s+"]").toLowerCase(),0<=(s=n.indexOf(t)))return this.dispatch("[CIRCULAR:"+s+"]");if(n.push(t),void 0!==i&&i.isBuffer&&i.isBuffer(t))return r("buffer:"),r(t);if("object"===a||"function"===a||"asyncfunction"===a)return s=Object.keys(t),e.unorderedObjects&&(s=s.sort()),!1===e.respectType||v(t)||s.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(s=s.filter((function(t){return!e.excludeKeys(t)}))),r("object:"+s.length+":"),o=this,s.forEach((function(n){o.dispatch(n),r(":"),e.excludeValues||o.dispatch(t[n]),r(",")}));if(!this["_"+a]){if(e.ignoreUnknown)return r("["+a+"]");throw new Error('Unknown object type "'+a+'"')}this["_"+a](t)},_array:function(t,o){o=void 0!==o?o:!1!==e.unorderedArrays;var i=this;if(r("array:"+t.length+":"),!o||t.length<=1)return t.forEach((function(e){return i.dispatch(e)}));var s=[];return o=t.map((function(t){var r=new b,o=n.slice();return y(e,r,o).dispatch(t),s=s.concat(o.slice(n.length)),r.read().toString()})),n=n.concat(s),o.sort(),this._array(o,!1)},_date:function(e){return r("date:"+e.toJSON())},_symbol:function(e){return r("symbol:"+e.toString())},_error:function(e){return r("error:"+e.toString())},_boolean:function(e){return r("bool:"+e.toString())},_string:function(e){r("string:"+e.length+":"),r(e.toString())},_function:function(t){r("fn:"),v(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return r("number:"+e.toString())},_xml:function(e){return r("xml:"+e.toString())},_null:function(){return r("Null")},_undefined:function(){return r("Undefined")},_regexp:function(e){return r("regex:"+e.toString())},_uint8array:function(e){return r("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return r("int8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return r("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return r("int16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return r("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return r("int32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return r("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return r("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return r("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return r("url:"+e.toString())},_map:function(t){return r("map:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_set:function(t){return r("set:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_file:function(e){return r("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(e.ignoreUnknown)return r("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return r("domwindow")},_bigint:function(e){return r("bigint:"+e.toString())},_process:function(){return r("process")},_timer:function(){return r("timer")},_pipe:function(){return r("pipe")},_tcp:function(){return r("tcp")},_udp:function(){return r("udp")},_tty:function(){return r("tty")},_statwatcher:function(){return r("statwatcher")},_securecontext:function(){return r("securecontext")},_connection:function(){return r("connection")},_zlib:function(){return r("zlib")},_context:function(){return r("context")},_nodescript:function(){return r("nodescript")},_httpparser:function(){return r("httpparser")},_dataview:function(){return r("dataview")},_signal:function(){return r("signal")},_fsevent:function(){return r("fsevent")},_tlswrap:function(){return r("tlswrap")}}}function b(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}n.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),y(t=g(e,t),n).dispatch(e)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,t,n){(function(e,t,r,o,i,s,a,l,c){!function(e){var t=typeof Uint8Array<"u"?Uint8Array:Array,n=43,r=47,o=48,i=97,s=65,a=45,l=95;function c(e){return(e=e.charCodeAt(0))===n||e===a?62:e===r||e===l?63:e<o?-1:e<o+10?e-o+26+26:e<s+26?e-s:e<i+26?e-i+26:void 0}e.toByteArray=function(e){var n,r;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var o=e.length,i=(o="="===e.charAt(o-2)?2:"="===e.charAt(o-1)?1:0,new t(3*e.length/4-o)),s=0<o?e.length-4:e.length,a=0;function l(e){i[a++]=e}for(n=0;n<s;n+=4,0)l((16711680&(r=c(e.charAt(n))<<18|c(e.charAt(n+1))<<12|c(e.charAt(n+2))<<6|c(e.charAt(n+3))))>>16),l((65280&r)>>8),l(255&r);return 2==o?l(255&(r=c(e.charAt(n))<<2|c(e.charAt(n+1))>>4)):1==o&&(l((r=c(e.charAt(n))<<10|c(e.charAt(n+1))<<4|c(e.charAt(n+2))>>2)>>8&255),l(255&r)),i},e.fromByteArray=function(e){var t,n,r,o,i=e.length%3,s="";function a(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,r=e.length-i;t<r;t+=3)s+=a((o=n=(e[t]<<16)+(e[t+1]<<8)+e[t+2])>>18&63)+a(o>>12&63)+a(o>>6&63)+a(63&o);switch(i){case 1:s=(s+=a((n=e[e.length-1])>>2))+a(n<<4&63)+"==";break;case 2:s=(s=(s+=a((n=(e[e.length-2]<<8)+e[e.length-1])>>10))+a(n>>4&63))+a(n<<2&63)+"="}return s}}(void 0===n?this.base64js={}:n)}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,t,n){(function(t,r,o,i,s,a,l,c,u){var h=e("base64-js"),d=e("ieee754");function o(e,t,n){if(!(this instanceof o))return new o(e,t,n);var r,i,s,a,l=typeof e;if("base64"===t&&"string"==l)for(e=(a=e).trim?a.trim():a.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if("number"==l)r=I(e);else if("string"==l)r=o.byteLength(e,t);else{if("object"!=l)throw new Error("First argument needs to be a number, array or string.");r=I(e.length)}if(o._useTypedArrays?i=o._augment(new Uint8Array(r)):((i=this).length=r,i._isBuffer=!0),o._useTypedArrays&&"number"==typeof e.byteLength)i._set(e);else if(P(a=e)||o.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length)for(s=0;s<r;s++)o.isBuffer(e)?i[s]=e.readUInt8(s):i[s]=e[s];else if("string"==l)i.write(e,0,t);else if("number"==l&&!o._useTypedArrays&&!n)for(s=0;s<r;s++)i[s]=0;return i}function p(e,t,n,r){return o._charsWritten=D(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function m(e,t,n,r){return o._charsWritten=D(function(e){for(var t,n,r=[],o=0;o<e.length;o++)t=(n=e.charCodeAt(o))>>8,n%=256,r.push(n),r.push(t);return r}(t),e,n,r)}function f(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;o++)r+=String.fromCharCode(e[o]);return r}function g(e,t,n,r){var o;if(r||(j("boolean"==typeof n,"missing or invalid endian"),j(null!=t,"missing offset"),j(t+1<e.length,"Trying to read beyond buffer length")),!((r=e.length)<=t))return n?(o=e[t],t+1<r&&(o|=e[t+1]<<8)):(o=e[t]<<8,t+1<r&&(o|=e[t+1])),o}function v(e,t,n,r){var o;if(r||(j("boolean"==typeof n,"missing or invalid endian"),j(null!=t,"missing offset"),j(t+3<e.length,"Trying to read beyond buffer length")),!((r=e.length)<=t))return n?(t+2<r&&(o=e[t+2]<<16),t+1<r&&(o|=e[t+1]<<8),o|=e[t],t+3<r&&(o+=e[t+3]<<24>>>0)):(t+1<r&&(o=e[t+1]<<16),t+2<r&&(o|=e[t+2]<<8),t+3<r&&(o|=e[t+3]),o+=e[t]<<24>>>0),o}function y(e,t,n,r){if(r||(j("boolean"==typeof n,"missing or invalid endian"),j(null!=t,"missing offset"),j(t+1<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 32768&(r=g(e,t,n,!0))?-1*(65535-r+1):r}function b(e,t,n,r){if(r||(j("boolean"==typeof n,"missing or invalid endian"),j(null!=t,"missing offset"),j(t+3<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 2147483648&(r=v(e,t,n,!0))?-1*(4294967295-r+1):r}function _(e,t,n,r){return r||(j("boolean"==typeof n,"missing or invalid endian"),j(t+3<e.length,"Trying to read beyond buffer length")),d.read(e,t,n,23,4)}function w(e,t,n,r){return r||(j("boolean"==typeof n,"missing or invalid endian"),j(t+7<e.length,"Trying to read beyond buffer length")),d.read(e,t,n,52,8)}function x(e,t,n,r,o){if(o||(j(null!=t,"missing value"),j("boolean"==typeof r,"missing or invalid endian"),j(null!=n,"missing offset"),j(n+1<e.length,"trying to write beyond buffer length"),F(t,65535)),!((o=e.length)<=n))for(var i=0,s=Math.min(o-n,2);i<s;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function T(e,t,n,r,o){if(o||(j(null!=t,"missing value"),j("boolean"==typeof r,"missing or invalid endian"),j(null!=n,"missing offset"),j(n+3<e.length,"trying to write beyond buffer length"),F(t,4294967295)),!((o=e.length)<=n))for(var i=0,s=Math.min(o-n,4);i<s;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function E(e,t,n,r,o){o||(j(null!=t,"missing value"),j("boolean"==typeof r,"missing or invalid endian"),j(null!=n,"missing offset"),j(n+1<e.length,"Trying to write beyond buffer length"),N(t,32767,-32768)),e.length<=n||x(e,0<=t?t:65535+t+1,n,r,o)}function M(e,t,n,r,o){o||(j(null!=t,"missing value"),j("boolean"==typeof r,"missing or invalid endian"),j(null!=n,"missing offset"),j(n+3<e.length,"Trying to write beyond buffer length"),N(t,2147483647,-2147483648)),e.length<=n||T(e,0<=t?t:4294967295+t+1,n,r,o)}function A(e,t,n,r,o){o||(j(null!=t,"missing value"),j("boolean"==typeof r,"missing or invalid endian"),j(null!=n,"missing offset"),j(n+3<e.length,"Trying to write beyond buffer length"),z(t,34028234663852886e22,-34028234663852886e22)),e.length<=n||d.write(e,t,n,r,23,4)}function S(e,t,n,r,o){o||(j(null!=t,"missing value"),j("boolean"==typeof r,"missing or invalid endian"),j(null!=n,"missing offset"),j(n+7<e.length,"Trying to write beyond buffer length"),z(t,17976931348623157e292,-17976931348623157e292)),e.length<=n||d.write(e,t,n,r,52,8)}n.Buffer=o,n.SlowBuffer=o,n.INSPECT_MAX_BYTES=50,o.poolSize=8192,o._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(n){return!1}}(),o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=L(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=k(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},o.concat=function(e,t){if(j(P(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new o(0);if(1===e.length)return e[0];if("number"!=typeof t)for(i=t=0;i<e.length;i++)t+=e[i].length;for(var n=new o(t),r=0,i=0;i<e.length;i++){var s=e[i];s.copy(n,r),r+=s.length}return n},o.prototype.write=function(e,t,n,r){isFinite(t)?isFinite(n)||(r=n,n=void 0):(c=r,r=t,t=n,n=c),t=Number(t)||0;var i,s,a,l,c=this.length-t;switch((!n||c<(n=Number(n)))&&(n=c),r=String(r||"utf8").toLowerCase()){case"hex":i=function(e,t,n,r){n=Number(n)||0;var i=e.length-n;(!r||i<(r=Number(r)))&&(r=i),j((i=t.length)%2==0,"Invalid hex string"),i/2<r&&(r=i/2);for(var s=0;s<r;s++){var a=parseInt(t.substr(2*s,2),16);j(!isNaN(a),"Invalid hex string"),e[n+s]=a}return o._charsWritten=2*s,s}(this,e,t,n);break;case"utf8":case"utf-8":s=this,a=t,l=n,i=o._charsWritten=D(L(e),s,a,l);break;case"ascii":case"binary":i=p(this,e,t,n);break;case"base64":s=this,a=t,l=n,i=o._charsWritten=D(k(e),s,a,l);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=m(this,e,t,n);break;default:throw new Error("Unknown encoding")}return i},o.prototype.toString=function(e,t,n){var r,o,i,s,a=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):a.length)===t)return"";switch(e){case"hex":r=function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var o="",i=t;i<n;i++)o+=R(e[i]);return o}(a,t,n);break;case"utf8":case"utf-8":r=function(e,t,n){var r="",o="";n=Math.min(e.length,n);for(var i=t;i<n;i++)e[i]<=127?(r+=U(o)+String.fromCharCode(e[i]),o=""):o+="%"+e[i].toString(16);return r+U(o)}(a,t,n);break;case"ascii":case"binary":r=f(a,t,n);break;case"base64":o=a,s=n,r=0===(i=t)&&s===o.length?h.fromByteArray(o):h.fromByteArray(o.slice(i,s));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=function(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(a,t,n);break;default:throw new Error("Unknown encoding")}return r},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.copy=function(e,t,n,r){if(t=t||0,(r=r||0===r?r:this.length)!==(n=n||0)&&0!==e.length&&0!==this.length){j(n<=r,"sourceEnd < sourceStart"),j(0<=t&&t<e.length,"targetStart out of bounds"),j(0<=n&&n<this.length,"sourceStart out of bounds"),j(0<=r&&r<=this.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length);var i=(r=e.length-t<r-n?e.length-t+n:r)-n;if(i<100||!o._useTypedArrays)for(var s=0;s<i;s++)e[s+t]=this[s+n];else e._set(this.subarray(n,n+i),t)}},o.prototype.slice=function(e,t){var n=this.length;if(e=C(e,n,0),t=C(t,n,n),o._useTypedArrays)return o._augment(this.subarray(e,t));for(var r=t-e,i=new o(r,void 0,!0),s=0;s<r;s++)i[s]=this[s+e];return i},o.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},o.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},o.prototype.readUInt8=function(e,t){if(t||(j(null!=e,"missing offset"),j(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},o.prototype.readUInt16LE=function(e,t){return g(this,e,!0,t)},o.prototype.readUInt16BE=function(e,t){return g(this,e,!1,t)},o.prototype.readUInt32LE=function(e,t){return v(this,e,!0,t)},o.prototype.readUInt32BE=function(e,t){return v(this,e,!1,t)},o.prototype.readInt8=function(e,t){if(t||(j(null!=e,"missing offset"),j(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},o.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},o.prototype.readInt32LE=function(e,t){return b(this,e,!0,t)},o.prototype.readInt32BE=function(e,t){return b(this,e,!1,t)},o.prototype.readFloatLE=function(e,t){return _(this,e,!0,t)},o.prototype.readFloatBE=function(e,t){return _(this,e,!1,t)},o.prototype.readDoubleLE=function(e,t){return w(this,e,!0,t)},o.prototype.readDoubleBE=function(e,t){return w(this,e,!1,t)},o.prototype.writeUInt8=function(e,t,n){n||(j(null!=e,"missing value"),j(null!=t,"missing offset"),j(t<this.length,"trying to write beyond buffer length"),F(e,255)),t>=this.length||(this[t]=e)},o.prototype.writeUInt16LE=function(e,t,n){x(this,e,t,!0,n)},o.prototype.writeUInt16BE=function(e,t,n){x(this,e,t,!1,n)},o.prototype.writeUInt32LE=function(e,t,n){T(this,e,t,!0,n)},o.prototype.writeUInt32BE=function(e,t,n){T(this,e,t,!1,n)},o.prototype.writeInt8=function(e,t,n){n||(j(null!=e,"missing value"),j(null!=t,"missing offset"),j(t<this.length,"Trying to write beyond buffer length"),N(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},o.prototype.writeInt16LE=function(e,t,n){E(this,e,t,!0,n)},o.prototype.writeInt16BE=function(e,t,n){E(this,e,t,!1,n)},o.prototype.writeInt32LE=function(e,t,n){M(this,e,t,!0,n)},o.prototype.writeInt32BE=function(e,t,n){M(this,e,t,!1,n)},o.prototype.writeFloatLE=function(e,t,n){A(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){A(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){S(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){S(this,e,t,!1,n)},o.prototype.fill=function(e,t,n){if(t=t||0,n=n||this.length,j("number"==typeof(e="string"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),"value is not a number"),j(t<=n,"end < start"),n!==t&&0!==this.length){j(0<=t&&t<this.length,"start out of bounds"),j(0<=n&&n<=this.length,"end out of bounds");for(var r=t;r<n;r++)this[r]=e}},o.prototype.inspect=function(){for(var e=[],t=this.length,r=0;r<t;r++)if(e[r]=R(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},o.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(o._useTypedArrays)return new o(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer};var O=o.prototype;function C(e,t,n){return"number"!=typeof e?n:t<=(e=~~e)?t:0<=e||0<=(e+=t)?e:0}function I(e){return(e=~~Math.ceil(+e))<0?0:e}function P(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function R(e){return e<16?"0"+e.toString(16):e.toString(16)}function L(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else for(var o=n,i=(55296<=r&&r<=57343&&n++,encodeURIComponent(e.slice(o,n+1)).substr(1).split("%")),s=0;s<i.length;s++)t.push(parseInt(i[s],16))}return t}function k(e){return h.toByteArray(e)}function D(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);o++)t[o+n]=e[o];return o}function U(e){try{return decodeURIComponent(e)}catch(t){return"ï¿½"}}function F(e,t){j("number"==typeof e,"cannot write a non-number as a number"),j(0<=e,"specified a negative value for writing an unsigned value"),j(e<=t,"value is larger than maximum value for type"),j(Math.floor(e)===e,"value has a fractional component")}function N(e,t,n){j("number"==typeof e,"cannot write a non-number as a number"),j(e<=t,"value larger than maximum allowed value"),j(n<=e,"value smaller than minimum allowed value"),j(Math.floor(e)===e,"value has a fractional component")}function z(e,t,n){j("number"==typeof e,"cannot write a non-number as a number"),j(e<=t,"value larger than maximum allowed value"),j(n<=e,"value smaller than minimum allowed value")}function j(e,t){if(!e)throw new Error(t||"Failed assertion")}o._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=O.get,e.set=O.set,e.write=O.write,e.toString=O.toString,e.toLocaleString=O.toString,e.toJSON=O.toJSON,e.copy=O.copy,e.slice=O.slice,e.readUInt8=O.readUInt8,e.readUInt16LE=O.readUInt16LE,e.readUInt16BE=O.readUInt16BE,e.readUInt32LE=O.readUInt32LE,e.readUInt32BE=O.readUInt32BE,e.readInt8=O.readInt8,e.readInt16LE=O.readInt16LE,e.readInt16BE=O.readInt16BE,e.readInt32LE=O.readInt32LE,e.readInt32BE=O.readInt32BE,e.readFloatLE=O.readFloatLE,e.readFloatBE=O.readFloatBE,e.readDoubleLE=O.readDoubleLE,e.readDoubleBE=O.readDoubleBE,e.writeUInt8=O.writeUInt8,e.writeUInt16LE=O.writeUInt16LE,e.writeUInt16BE=O.writeUInt16BE,e.writeUInt32LE=O.writeUInt32LE,e.writeUInt32BE=O.writeUInt32BE,e.writeInt8=O.writeInt8,e.writeInt16LE=O.writeInt16LE,e.writeInt16BE=O.writeInt16BE,e.writeInt32LE=O.writeInt32LE,e.writeInt32BE=O.writeInt32BE,e.writeFloatLE=O.writeFloatLE,e.writeFloatBE=O.writeFloatBE,e.writeDoubleLE=O.writeDoubleLE,e.writeDoubleBE=O.writeDoubleBE,e.fill=O.fill,e.inspect=O.inspect,e.toArrayBuffer=O.toArrayBuffer,e}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,t,n){(function(n,r,o,i,s,a,l,c,u){o=e("buffer").Buffer;var h=4,d=new o(h);d.fill(0),t.exports={hash:function(e,t,n,r){for(var i=t(function(e,t){e.length%h!=0&&(n=e.length+(h-e.length%h),e=o.concat([e,d],n));for(var n,r=[],i=t?e.readInt32BE:e.readInt32LE,s=0;s<e.length;s+=h)r.push(i.call(e,s));return r}(e=o.isBuffer(e)?e:new o(e),r),8*e.length),s=(t=r,new o(n)),a=t?s.writeInt32BE:s.writeInt32LE,l=0;l<i.length;l++)a.call(s,i[l],4*l,!0);return s}}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,t,n){(function(t,r,o,i,s,a,l,c,u){o=e("buffer").Buffer;var h=e("./sha"),d=e("./sha256"),p=e("./rng"),m={sha1:h,sha256:d,md5:e("./md5")},f=64,g=new o(f);function v(e,t){var n=m[e=e||"sha1"],r=[];return n||y("algorithm:",e,"is not yet supported"),{update:function(e){return o.isBuffer(e)||(e=new o(e)),r.push(e),e.length,this},digest:function(e){var i=o.concat(r);return i=t?function(e,t,n){o.isBuffer(t)||(t=new o(t)),o.isBuffer(n)||(n=new o(n)),t.length>f?t=e(t):t.length<f&&(t=o.concat([t,g],f));for(var r=new o(f),i=new o(f),s=0;s<f;s++)r[s]=54^t[s],i[s]=92^t[s];return n=e(o.concat([r,n])),e(o.concat([i,n]))}(n,t,i):n(i),r=null,e?i.toString(e):i}}}function y(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}g.fill(0),n.createHash=function(e){return v(e)},n.createHmac=v,n.randomBytes=function(e,t){if(!t||!t.call)return new o(p(e));try{t.call(this,void 0,new o(p(e)))}catch(n){t(n)}};var b,_=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],w=function(e){n[e]=function(){y("sorry,",e,"is not implemented yet")}};for(b in _)w(_[b])}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,t,n){(function(n,r,o,i,s,a,l,c,u){var h=e("./helpers");function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,s=0;s<e.length;s+=16){var a=n,l=r,c=o,u=i;n=m(n,r,o,i,e[s+0],7,-680876936),i=m(i,n,r,o,e[s+1],12,-389564586),o=m(o,i,n,r,e[s+2],17,606105819),r=m(r,o,i,n,e[s+3],22,-1044525330),n=m(n,r,o,i,e[s+4],7,-176418897),i=m(i,n,r,o,e[s+5],12,1200080426),o=m(o,i,n,r,e[s+6],17,-1473231341),r=m(r,o,i,n,e[s+7],22,-45705983),n=m(n,r,o,i,e[s+8],7,1770035416),i=m(i,n,r,o,e[s+9],12,-1958414417),o=m(o,i,n,r,e[s+10],17,-42063),r=m(r,o,i,n,e[s+11],22,-1990404162),n=m(n,r,o,i,e[s+12],7,1804603682),i=m(i,n,r,o,e[s+13],12,-40341101),o=m(o,i,n,r,e[s+14],17,-1502002290),n=f(n,r=m(r,o,i,n,e[s+15],22,1236535329),o,i,e[s+1],5,-165796510),i=f(i,n,r,o,e[s+6],9,-1069501632),o=f(o,i,n,r,e[s+11],14,643717713),r=f(r,o,i,n,e[s+0],20,-373897302),n=f(n,r,o,i,e[s+5],5,-701558691),i=f(i,n,r,o,e[s+10],9,38016083),o=f(o,i,n,r,e[s+15],14,-660478335),r=f(r,o,i,n,e[s+4],20,-405537848),n=f(n,r,o,i,e[s+9],5,568446438),i=f(i,n,r,o,e[s+14],9,-1019803690),o=f(o,i,n,r,e[s+3],14,-187363961),r=f(r,o,i,n,e[s+8],20,1163531501),n=f(n,r,o,i,e[s+13],5,-1444681467),i=f(i,n,r,o,e[s+2],9,-51403784),o=f(o,i,n,r,e[s+7],14,1735328473),n=g(n,r=f(r,o,i,n,e[s+12],20,-1926607734),o,i,e[s+5],4,-378558),i=g(i,n,r,o,e[s+8],11,-2022574463),o=g(o,i,n,r,e[s+11],16,1839030562),r=g(r,o,i,n,e[s+14],23,-35309556),n=g(n,r,o,i,e[s+1],4,-1530992060),i=g(i,n,r,o,e[s+4],11,1272893353),o=g(o,i,n,r,e[s+7],16,-155497632),r=g(r,o,i,n,e[s+10],23,-1094730640),n=g(n,r,o,i,e[s+13],4,681279174),i=g(i,n,r,o,e[s+0],11,-358537222),o=g(o,i,n,r,e[s+3],16,-722521979),r=g(r,o,i,n,e[s+6],23,76029189),n=g(n,r,o,i,e[s+9],4,-640364487),i=g(i,n,r,o,e[s+12],11,-421815835),o=g(o,i,n,r,e[s+15],16,530742520),n=v(n,r=g(r,o,i,n,e[s+2],23,-995338651),o,i,e[s+0],6,-198630844),i=v(i,n,r,o,e[s+7],10,1126891415),o=v(o,i,n,r,e[s+14],15,-1416354905),r=v(r,o,i,n,e[s+5],21,-57434055),n=v(n,r,o,i,e[s+12],6,1700485571),i=v(i,n,r,o,e[s+3],10,-1894986606),o=v(o,i,n,r,e[s+10],15,-1051523),r=v(r,o,i,n,e[s+1],21,-2054922799),n=v(n,r,o,i,e[s+8],6,1873313359),i=v(i,n,r,o,e[s+15],10,-30611744),o=v(o,i,n,r,e[s+6],15,-1560198380),r=v(r,o,i,n,e[s+13],21,1309151649),n=v(n,r,o,i,e[s+4],6,-145523070),i=v(i,n,r,o,e[s+11],10,-1120210379),o=v(o,i,n,r,e[s+2],15,718787259),r=v(r,o,i,n,e[s+9],21,-343485551),n=y(n,a),r=y(r,l),o=y(o,c),i=y(i,u)}return Array(n,r,o,i)}function p(e,t,n,r,o,i){return y((t=y(y(t,e),y(r,i)))<<o|t>>>32-o,n)}function m(e,t,n,r,o,i,s){return p(t&n|~t&r,e,t,o,i,s)}function f(e,t,n,r,o,i,s){return p(t&r|n&~r,e,t,o,i,s)}function g(e,t,n,r,o,i,s){return p(t^n^r,e,t,o,i,s)}function v(e,t,n,r,o,i,s){return p(n^(t|~r),e,t,o,i,s)}function y(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}t.exports=function(e){return h.hash(e,d,16)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,t,n){(function(e,n,r,o,i,s,a,l,c){t.exports=function(e){for(var t,n=new Array(e),r=0;r<e;r++)!(3&r)&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,t,n){(function(n,r,o,i,s,a,l,c,u){var h=e("./helpers");function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var n,r,o,i=Array(80),s=1732584193,a=-271733879,l=-1732584194,c=271733878,u=-1009589776,h=0;h<e.length;h+=16){for(var d=s,f=a,g=l,v=c,y=u,b=0;b<80;b++){i[b]=b<16?e[h+b]:m(i[b-3]^i[b-8]^i[b-14]^i[b-16],1);var _=p(p(m(s,5),(_=a,r=l,o=c,(n=b)<20?_&r|~_&o:!(n<40)&&n<60?_&r|_&o|r&o:_^r^o)),p(p(u,i[b]),(n=b)<20?1518500249:n<40?1859775393:n<60?-1894007588:-899497514));u=c,c=l,l=m(a,30),a=s,s=_}s=p(s,d),a=p(a,f),l=p(l,g),c=p(c,v),u=p(u,y)}return Array(s,a,l,c,u)}function p(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function m(e,t){return e<<t|e>>>32-t}t.exports=function(e){return h.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,t,n){(function(n,r,o,i,s,a,l,c,u){function h(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function d(e,t){var n,r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),o=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),i=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var s,a,l=0;l<e.length;l+=16){for(var c=o[0],u=o[1],d=o[2],p=o[3],g=o[4],v=o[5],y=o[6],b=o[7],_=0;_<64;_++)i[_]=_<16?e[_+l]:h(h(h((a=i[_-2],m(a,17)^m(a,19)^f(a,10)),i[_-7]),(a=i[_-15],m(a,7)^m(a,18)^f(a,3))),i[_-16]),n=h(h(h(h(b,m(a=g,6)^m(a,11)^m(a,25)),g&v^~g&y),r[_]),i[_]),s=h(m(s=c,2)^m(s,13)^m(s,22),c&u^c&d^u&d),b=y,y=v,v=g,g=h(p,n),p=d,d=u,u=c,c=h(n,s);o[0]=h(c,o[0]),o[1]=h(u,o[1]),o[2]=h(d,o[2]),o[3]=h(p,o[3]),o[4]=h(g,o[4]),o[5]=h(v,o[5]),o[6]=h(y,o[6]),o[7]=h(b,o[7])}return o}var p=e("./helpers"),m=function(e,t){return e>>>t|e<<32-t},f=function(e,t){return e>>>t};t.exports=function(e){return p.hash(e,d,32,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,t,n){(function(e,t,r,o,i,s,a,l,c){n.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?o-1:0,d=n?-1:1;for(o=e[t+h],h+=d,i=o&(1<<-u)-1,o>>=-u,u+=a;0<u;i=256*i+e[t+h],h+=d,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=r;0<u;s=256*s+e[t+h],h+=d,u-=8);if(0===i)i=1-c;else{if(i===l)return s?NaN:1/0*(o?-1:1);s+=Math.pow(2,r),i-=c}return(o?-1:1)*s*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var s,a,l=8*i-o-1,c=(1<<l)-1,u=c>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,p=r?1:-1;for(i=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-s))<1&&(s--,r*=2),2<=(t+=1<=s+u?h/r:h*Math.pow(2,1-u))*r&&(s++,r/=2),c<=s+u?(a=0,s=c):1<=s+u?(a=(t*r-1)*Math.pow(2,o),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,o),s=0));8<=o;e[n+d]=255&a,d+=p,a/=256,o-=8);for(s=s<<o|a,l+=o;0<l;e[n+d]=255&s,d+=p,s/=256,l-=8);e[n+d-p]|=128*i}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,t,n){(function(e,n,r,o,i,s,a,l,c){var u,h,d;function p(){}(e=t.exports={}).nextTick=(h=typeof window<"u"&&window.setImmediate,d=typeof window<"u"&&window.postMessage&&window.addEventListener,h?function(e){return window.setImmediate(e)}:d?(u=[],window.addEventListener("message",(function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<u.length&&u.shift()())}),!0),function(e){u.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1);const dh=ch(hh.exports);var ph=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],mh=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],fh=ph.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),gh=mh;gh=gh.slice().filter((function(e){return!/^(gl\_|texture)/.test(e)}));var vh=gh.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),yh=function(e){var t,n,r,o=0,i=0,s=Eh,a=[],l=[],c=1,u=0,h=0,d=!1,p=!1,m="";e=e||{};var f=wh,g=bh;"300 es"===e.version&&(f=Th,g=xh);var v={},y={};for(o=0;o<f.length;o++)v[f[o]]=!0;for(o=0;o<g.length;o++)y[g[o]]=!0;return function(e){return l=[],null!==e?function(e){o=0,e.toString&&(e=e.toString()),m+=e.replace(/\r\n/g,"\n"),r=m.length;for(var n;t=m[o],o<r;){switch(n=o,s){case Ah:o=E();break;case Sh:o=T();break;case Oh:o=x();break;case Ch:o=M();break;case Ih:o=O();break;case Fh:o=S();break;case Ph:o=C();break;case Mh:o=I();break;case Dh:o=w();break;case Eh:o=_()}if(n!==o)if("\n"===m[n])u=0,++c;else++u}return i+=o,m=m.slice(o),l}(e):(a.length&&b(a.join("")),s=Uh,b("(eof)"),l)};function b(e){e.length&&l.push({type:Nh[s],data:e,position:h,line:c,column:u})}function _(){return a=a.length?[]:a,"/"===n&&"*"===t?(h=i+o-1,s=Ah,n=t,o+1):"/"===n&&"/"===t?(h=i+o-1,s=Sh,n=t,o+1):"#"===t?(s=Oh,h=i+o,o):/\s/.test(t)?(s=Dh,h=i+o,o):(d=/\d/.test(t),p=/[^\w_]/.test(t),h=i+o,s=d?Ih:p?Ch:Mh,o)}function w(){return/[^\s]/g.test(t)?(b(a.join("")),s=Eh,o):(a.push(t),n=t,o+1)}function x(){return"\r"!==t&&"\n"!==t||"\\"===n?(a.push(t),n=t,o+1):(b(a.join("")),s=Eh,o)}function T(){return x()}function E(){return"/"===t&&"*"===n?(a.push(t),b(a.join("")),s=Eh,o+1):(a.push(t),n=t,o+1)}function M(){if("."===n&&/\d/.test(t))return s=Ph,o;if("/"===n&&"*"===t)return s=Ah,o;if("/"===n&&"/"===t)return s=Sh,o;if("."===t&&a.length){for(;A(a););return s=Ph,o}if(";"===t||")"===t||"("===t){if(a.length)for(;A(a););return b(t),s=Eh,o+1}var e=2===a.length&&"="!==t;if(/[\w_\d\s]/.test(t)||e){for(;A(a););return s=Eh,o}return a.push(t),n=t,o+1}function A(e){for(var t,n,r=0;;){if(t=_h.indexOf(e.slice(0,e.length+r).join("")),n=_h[t],-1===t){if(r--+e.length>0)continue;n=e.slice(0,1).join("")}return b(n),h+=n.length,(a=a.slice(n.length)).length}}function S(){return/[^a-fA-F0-9]/.test(t)?(b(a.join("")),s=Eh,o):(a.push(t),n=t,o+1)}function O(){return"."===t||/[eE]/.test(t)?(a.push(t),s=Ph,n=t,o+1):"x"===t&&1===a.length&&"0"===a[0]?(s=Fh,a.push(t),n=t,o+1):/[^\d]/.test(t)?(b(a.join("")),s=Eh,o):(a.push(t),n=t,o+1)}function C(){return"f"===t&&(a.push(t),n=t,o+=1),/[eE]/.test(t)||("-"===t||"+"===t)&&/[eE]/.test(n)?(a.push(t),n=t,o+1):/[^\d]/.test(t)?(b(a.join("")),s=Eh,o):(a.push(t),n=t,o+1)}function I(){if(/[^\d\w_]/.test(t)){var e=a.join("");return s=y[e]?kh:v[e]?Lh:Rh,b(a.join("")),s=Eh,o}return a.push(t),n=t,o+1}},bh=ph,_h=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],wh=mh,xh=fh,Th=vh,Eh=999,Mh=9999,Ah=0,Sh=1,Oh=2,Ch=3,Ih=4,Ph=5,Rh=6,Lh=7,kh=8,Dh=9,Uh=10,Fh=11,Nh=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];var zh=yh,jh=function(e,t){var n=zh(t),r=[];return r=r.concat(n(e)),r=r.concat(n(null)),r};const Bh=ch(jh);var Hh=function(e){for(var t=[],n=0;n<e.length;n++)"eof"!==e[n].type&&t.push(e[n].data);return t.join("")};const Vh=ch(Hh);var Yh=function(e){var t,n,r,o=null,i=null,s=0,a=0,l=0,c=0,u=0,h=[];for(t=0;t<e.length;t++)if("{"===(r=e[t]).data){if(s&&s++||(n=p(t,Xh(")"),Xh()))<0||(c=n,(n=p(n,Xh("("),Xh(")")))<0)||(u=n,(n=p(n,Gh))<0)||"ident"!==e[n].type||(i=e[n].data,(n=p(n,Gh))<0))continue;s=1,a=t,o=e[n].data,l=n;var d=p(n,Gh);switch(e[d]&&e[d].data){case"lowp":case"highp":case"mediump":l=d}}else if(s&&"}"===r.data){if(--s)continue;h.push({name:i,type:o,body:[a+1,t],args:[u,c+1],outer:[l,t+1]})}for(t=0;t<e.length;t++)if(";"===(r=e[t]).data){if((n=p(t,Xh(")"),Xh()))<0||(c=n,(n=p(n,Xh("("),Xh(")")))<0)||(u=n,(n=p(n,Gh))<0)||"ident"!==e[n].type||(i=e[n].data,(n=p(n,Gh))<0)||"operator"===e[n].type||"return"===e[n].data)continue;o=e[n].data,h.push({name:i,type:o,body:!1,args:[u,c+1],outer:[n,t+1]})}return h.sort((function(e,t){return e.outer[0]-t.outer[0]}));function p(t,n,r){for(var o=t-1;o>=0;o--){if(n(e[o]))return o;if(r&&r(e[o]))return-1}return-1}};function Xh(e){return function(t){return"operator"===t.type&&(!e||t.data===e)}}function Gh(e){return"whitespace"!==e.type}const Wh=ch(Yh);function Zh(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Kh(e,t,n){return(t=Zh(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qh(Object(n),!0).forEach((function(t){Kh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Jh(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zh(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ed(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function td(e,t){return(td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function nd(e){return nd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nd(e)}function rd(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=nd(e);if(t){var o=nd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ed(e)}(this,n)}}var od,id,sd,ad="csm_Position",ld="csm_PositionRaw",cd="csm_PointSize",ud="csm_FragColor",hd="csm_DiffuseColor",dd="csm_Normal",pd="csm_Roughness",md="csm_Metalness",fd="csm_Emissive",gd="csm_AO",vd="csm_Bump",yd="csm_DepthAlpha",bd=(Kh(od={},"".concat(dd),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(dd,";\n    #ifdef USE_TANGENT\n\t    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),Kh(od,"".concat(ad),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(ad,";\n  ")}),Kh(od,"".concat(ld),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(ld,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),Kh(od,"".concat(cd),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(cd,";\n    ")}),Kh(od,"".concat(hd),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(hd,";\n  ")}),Kh(od,"".concat(ud),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(ud,";\n  ")}),Kh(od,"".concat(fd),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(fd,";\n    ")}),Kh(od,"".concat(pd),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(pd,";\n    ")}),Kh(od,"".concat(md),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(md,";\n    ")}),Kh(od,"".concat(gd),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(gd,";\n    ")}),Kh(od,"".concat(vd),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(vd," - (dot(").concat(vd,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),Kh(od,"".concat(yd),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(yd," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(yd,";\n    ")}),od),_d=(Kh(id={},"".concat(ad),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(ad,", 1.0 );\n  ")}),Kh(id,"".concat(ld),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(ad,";\n  ")}),Kh(id,"".concat(hd),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(hd,";\n  ")}),Kh(id,"".concat(ud),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(ud,";\n  ")}),id),wd=(Kh(sd={},"".concat(ad),"*"),Kh(sd,"".concat(ld),"*"),Kh(sd,"".concat(dd),"*"),Kh(sd,"".concat(cd),["PointsMaterial"]),Kh(sd,"".concat(hd),"*"),Kh(sd,"".concat(ud),"*"),Kh(sd,"".concat(fd),["MeshStandardMaterial","MeshPhysicalMaterial"]),Kh(sd,"".concat(pd),["MeshStandardMaterial","MeshPhysicalMaterial"]),Kh(sd,"".concat(md),["MeshStandardMaterial","MeshPhysicalMaterial"]),Kh(sd,"".concat(gd),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),Kh(sd,"".concat(vd),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),Kh(sd,"".concat(yd),"*"),sd),xd=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"];function Td(e){var t=e.toString().trim();return 0===t.substring(t.indexOf("{")+1,t.lastIndexOf("}")).trim().length}function Ed(e){return e.replace(/\s/g,"")}var Md=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&td(e,t)}(n,pt);var t=rd(n);function n(e){var r,o,i=e.baseMaterial,s=e.fragmentShader,a=e.vertexShader,l=e.uniforms,c=e.patchMap,u=e.cacheKey,h=e.silent,d=$h(e,xd);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e){try{new e}catch(t){if(t.message.indexOf("is not a constructor")>=0)return!1}return!0}(i)?o=new i(d):(o=i,Object.assign(o,d)),"RawShaderMaterial"===o.type)throw new Error("CustomShaderMaterial does not support RawShaderMaterial");(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object.assign(e,t);var r=Object.getPrototypeOf(t);Object.entries(Object.getOwnPropertyDescriptors(r)).filter((function(e){var t="function"==typeof e[1].get,n="function"==typeof e[1].set,r="function"==typeof e[1].value,o="constructor"===e[0];return(t||n||r)&&!o})).forEach((function(t){if("function"!=typeof e[t[0]])Object.defineProperty(e,t[0],t[1]);else{n||console.warn("Function ".concat(t[0]," already exists on CSM, renaming to base_").concat(t[0]));var r="base_".concat(t[0]);e[r]=t[1].value.bind(e)}}))})(ed(r=t.call(this)),o,h),r.__csm={patchMap:c||{},fragmentShader:s||"",vertexShader:a||"",cacheKey:u,baseMaterial:i,instanceID:b.generateUUID(),type:o.type,isAlreadyExtended:!Td(o.onBeforeCompile),cacheHash:"",silent:h},r.uniforms=Qh(Qh({},r.uniforms||{}),l||{});var p=r.__csm,m=p.fragmentShader,f=p.vertexShader,g=r.uniforms;return r.__csm.cacheHash=r.getCacheHash(),r.generateMaterial(m,f,g),r}return Jh(n,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.uniforms=e.uniforms||this.uniforms,Object.assign(this.__csm,e);var t=this.__csm,n=t.fragmentShader,r=t.vertexShader,o=this.uniforms,i=this.getCacheHash();this.__csm.cacheHash=i,this.generateMaterial(n,r,o)}},{key:"clone",value:function(){var e={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},t=new this.constructor(e);return Object.assign(this,t),t}},{key:"getCacheHash",value:function(){var e=this.__csm,t=e.fragmentShader,n=e.vertexShader,r=this.uniforms,o=Object.values(r).reduce((function(e,t){var n=t.value;return e+JSON.stringify(n)}),""),i=Ed(t)+Ed(n)+o;return i.trim().length>0?dh(i):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(e,t,n){var r=this,o=this.parseShader(e),i=this.parseShader(t);this.uniforms=n||{},this.customProgramCacheKey=function(){return r.__csm.cacheHash};var s=function(e){try{if(o){var t=r.patchShader(o,e.fragmentShader,!0);e.fragmentShader=r.getMaterialDefine()+t}if(i){var n=r.patchShader(i,e.vertexShader);e.vertexShader="#define IS_VERTEX;\n"+n,e.vertexShader=r.getMaterialDefine()+e.vertexShader}e.uniforms=Qh(Qh({},e.uniforms),r.uniforms),r.uniforms=e.uniforms}catch(s){console.error(s)}};if(this.__csm.isAlreadyExtended){var a=this.onBeforeCompile;this.onBeforeCompile=function(e,t){a(e,t),s(e)}}else this.onBeforeCompile=s;this.needsUpdate=!0}},{key:"patchShader",value:function(e,t,n){var r=this,o=t,i=Qh(Qh({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(i).forEach((function(t){Object.keys(i[t]).forEach((function(n){var s=wd[t],a=r.__csm.type;if("*"===t||function(e,t){return new RegExp("\\b".concat(function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t),"\\b")).test(e)}(e.main,t)){if(!(!s||Array.isArray(s)&&s.includes(a)||"*"===s))throw new Error("CSM: ".concat(t," is not available in ").concat(a,". Shader cannot compile."));o=function(e,t,n){return e.split(t).join(n)}(o,n,i[t][n])}}))})),o=o.replace("void main() {","\n        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED\n          ".concat("\n    varying mat4 csm_internal_vModelViewMatrix;\n","\n          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1\n        #endif\n\n        ").concat(e.header,"\n        \n        void main() {\n          #ifndef CSM_IS_DEFAULTS_DEFINED\n            ").concat("\n\n#ifdef IS_VERTEX\n    // csm_Position & csm_PositionRaw\n    #ifdef IS_UNKNOWN\n        vec3 csm_Position = vec3(0.0);\n        vec4 csm_PositionRaw = vec4(0.0);\n        vec3 csm_Normal = vec3(0.0);\n    #else\n        vec3 csm_Position = position;\n        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n        vec3 csm_Normal = normal;\n    #endif\n\n    // csm_PointSize\n    #ifdef IS_POINTSMATERIAL\n        float csm_PointSize = size;\n    #endif\n#else\n    // csm_DiffuseColor & csm_FragColor\n    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL\n        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);\n        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    #else\n        #ifdef USE_MAP\n            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);\n\n            #ifdef DECODE_VIDEO_TEXTURE\n            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)\n            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);\n            #endif\n\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n        #else\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity);\n            vec4 csm_FragColor = vec4(diffuse, opacity);\n        #endif\n    #endif\n\n    // csm_Emissive, csm_Roughness, csm_Metalness\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL\n        vec3 csm_Emissive = emissive;\n        float csm_Roughness = roughness;\n        float csm_Metalness = metalness;\n    #endif\n\n    // csm_AO\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL\n        float csm_AO = 0.0;\n    #endif\n\n    // csm_Bump\n    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL \n        vec3 csm_Bump = vec3(0.0);\n    #endif\n\n    float csm_DepthAlpha = 1.0;\n#endif\n","\n            #define CSM_IS_DEFAULTS_DEFINED 1\n          #endif\n          \n          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED\n            ").concat(n?"\n    \n":"\n    csm_internal_vModelViewMatrix = modelViewMatrix;\n","\n            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1\n          #endif\n\n          // CSM_START\n      "));var s=this.__csm.isAlreadyExtended,a=o.includes("// CSM_END");return o=s&&a?function(e,t,n){var r=e.lastIndexOf(t);return-1===r?e:e.substring(0,r)+n+e.substring(r+t.length)}(o,"// CSM_END","\n          // CSM_END\n          ".concat(e.main,"\n          // CSM_END\n        ")):o.replace("// CSM_START","\n        // CSM_START\n        ".concat(e.main,"\n        // CSM_END\n          ")),o=e.defines+o}},{key:"parseShader",value:function(e){if(e){var t=e.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),n=Bh(t),r=Wh(n),o=r.map((function(e){return e.name})).indexOf("main");return{defines:"",header:Vh(n.slice(0,o>=0?r[o].outer[0]:void 0)),main:o>=0?this.getShaderFromIndex(n,r[o].body):""}}}},{key:"getMaterialDefine",value:function(){var e=this.__csm.type;return e?"#define IS_".concat(e.toUpperCase(),";\n"):"#define IS_UNKNOWN;\n"}},{key:"getPatchMapForMaterial",value:function(){return"ShaderMaterial"===this.__csm.type?_d:bd}},{key:"getShaderFromIndex",value:function(e,t){return Vh(e.slice(t[0],t[1]))}}]),n}();const Ad=["args"],Sd=Jt({__name:"index",props:{baseMaterial:{},vertexShader:{},fragmentShader:{},silent:{type:Boolean},uniforms:{}},setup(e,{expose:t}){const n=e,r=tn(null),{extend:o,invalidate:i}=wo();return o({CustomShaderMaterial:Md}),Bt(n,(()=>i())),t({instance:r}),(e,t)=>(rn(),on("TresCustomShaderMaterial",{ref_key:"customShaderMaterialClass",ref:r,args:[n]},null,8,Ad))}}),Od=["args"],Cd=["color"],Id=Jt({__name:"Box",props:{args:{default:()=>[1,1,1]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{invalidate:r}=wo(),{args:o,color:i}=Xt(n);Bt(o,(()=>r()));const s=tn();return t({instance:s}),(e,t)=>(rn(),on("TresMesh",vn({ref_key:"boxRef",ref:s},e.$attrs),[bn("TresBoxGeometry",{args:zt(o)},null,8,Od),fn(e.$slots,"default",{},(()=>[bn("TresMeshBasicMaterial",{color:zt(i)},null,8,Cd)]))],16))}}),Pd=new J,Rd=new z;class Ld extends kt{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new x([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new x([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Dt(t,6,1);return this.setAttribute("instanceStart",new K(n,3,0)),this.setAttribute("instanceEnd",new K(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Dt(t,6,1);return this.setAttribute("instanceColorStart",new K(n,3,0)),this.setAttribute("instanceColorEnd",new K(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Ut(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new J);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Pd.setFromBufferAttribute(t),this.boundingBox.union(Pd))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new te),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let o=0,i=e.count;o<i;o++)Rd.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(Rd)),Rd.fromBufferAttribute(t,o),r=Math.max(r,n.distanceToSquared(Rd));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}oe.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new N(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},ie.line={uniforms:H.merge([oe.common,oe.fog,oe.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n\t\t\t\tvec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n\t\t\t\tvec3 worldFwd = cross( worldDir, worldUp );\n\t\t\t\tworldPos = position.y < 0.5 ? start: end;\n\n\t\t\t\t// height offset\n\t\t\t\tfloat hw = linewidth * 0.5;\n\t\t\t\tworldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.xyz += worldFwd * hw;\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\tworldPos.xyz -= worldFwd * 2.0 * hw;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class kd extends B{constructor(e){super({type:"LineMaterial",uniforms:H.clone(ie.line.uniforms),vertexShader:ie.line.vertexShader,fragmentShader:ie.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){!0===e!==this.dashed&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(!0===e!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===e?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const Dd=new re,Ud=new z,Fd=new z,Nd=new re,zd=new re,jd=new re,Bd=new z,Hd=new q,Vd=new se,Yd=new z,Xd=new J,Gd=new te,Wd=new re;let Zd,Kd;function qd(e,t,n){return Wd.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),Wd.multiplyScalar(1/Wd.w),Wd.x=Kd/n.width,Wd.y=Kd/n.height,Wd.applyMatrix4(e.projectionMatrixInverse),Wd.multiplyScalar(1/Wd.w),Math.abs(Math.max(Wd.x,Wd.y))}class Qd extends E{constructor(e=new Ld,t=new kd({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let i=0,s=0,a=t.count;i<a;i++,s+=2)Ud.fromBufferAttribute(t,i),Fd.fromBufferAttribute(n,i),r[s]=0===s?0:r[s-1],r[s+1]=r[s]+Ud.distanceTo(Fd);const o=new Dt(r,2,1);return e.setAttribute("instanceDistanceStart",new K(o,1,0)),e.setAttribute("instanceDistanceEnd",new K(o,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;null===r&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const o=void 0!==e.params.Line2&&e.params.Line2.threshold||0;Zd=e.ray;const i=this.matrixWorld,s=this.geometry,a=this.material;let l,c;if(Kd=a.linewidth+o,null===s.boundingSphere&&s.computeBoundingSphere(),Gd.copy(s.boundingSphere).applyMatrix4(i),n)l=.5*Kd;else{l=qd(r,Math.max(r.near,Gd.distanceToPoint(Zd.origin)),a.resolution)}if(Gd.radius+=l,!1!==Zd.intersectsSphere(Gd)){if(null===s.boundingBox&&s.computeBoundingBox(),Xd.copy(s.boundingBox).applyMatrix4(i),n)c=.5*Kd;else{c=qd(r,Math.max(r.near,Xd.distanceToPoint(Zd.origin)),a.resolution)}Xd.expandByScalar(c),!1!==Zd.intersectsBox(Xd)&&(n?function(e,t){const n=e.matrixWorld,r=e.geometry,o=r.attributes.instanceStart,i=r.attributes.instanceEnd;for(let s=0,a=Math.min(r.instanceCount,o.count);s<a;s++){Vd.start.fromBufferAttribute(o,s),Vd.end.fromBufferAttribute(i,s),Vd.applyMatrix4(n);const r=new z,a=new z;Zd.distanceSqToSegment(Vd.start,Vd.end,a,r),a.distanceTo(r)<.5*Kd&&t.push({point:a,pointOnLine:r,distance:Zd.origin.distanceTo(a),object:e,face:null,faceIndex:s,uv:null,uv1:null})}}(this,t):function(e,t,n){const r=t.projectionMatrix,o=e.material.resolution,i=e.matrixWorld,s=e.geometry,a=s.attributes.instanceStart,l=s.attributes.instanceEnd,c=Math.min(s.instanceCount,a.count),u=-t.near;Zd.at(1,jd),jd.w=1,jd.applyMatrix4(t.matrixWorldInverse),jd.applyMatrix4(r),jd.multiplyScalar(1/jd.w),jd.x*=o.x/2,jd.y*=o.y/2,jd.z=0,Bd.copy(jd),Hd.multiplyMatrices(t.matrixWorldInverse,i);for(let h=0,d=c;h<d;h++){if(Nd.fromBufferAttribute(a,h),zd.fromBufferAttribute(l,h),Nd.w=1,zd.w=1,Nd.applyMatrix4(Hd),zd.applyMatrix4(Hd),Nd.z>u&&zd.z>u)continue;if(Nd.z>u){const e=Nd.z-zd.z,t=(Nd.z-u)/e;Nd.lerp(zd,t)}else if(zd.z>u){const e=zd.z-Nd.z,t=(zd.z-u)/e;zd.lerp(Nd,t)}Nd.applyMatrix4(r),zd.applyMatrix4(r),Nd.multiplyScalar(1/Nd.w),zd.multiplyScalar(1/zd.w),Nd.x*=o.x/2,Nd.y*=o.y/2,zd.x*=o.x/2,zd.y*=o.y/2,Vd.start.copy(Nd),Vd.start.z=0,Vd.end.copy(zd),Vd.end.z=0;const t=Vd.closestPointToPointParameter(Bd,!0);Vd.at(t,Yd);const s=b.lerp(Nd.z,zd.z,t),c=s>=-1&&s<=1,d=Bd.distanceTo(Yd)<.5*Kd;if(c&&d){Vd.start.fromBufferAttribute(a,h),Vd.end.fromBufferAttribute(l,h),Vd.start.applyMatrix4(i),Vd.end.applyMatrix4(i);const t=new z,r=new z;Zd.distanceSqToSegment(Vd.start,Vd.end,r,t),n.push({point:r,pointOnLine:t,distance:Zd.origin.distanceTo(r),object:e,face:null,faceIndex:h,uv:null,uv1:null})}}}(this,r,t))}}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(Dd),this.material.uniforms.resolution.value.set(Dd.z,Dd.w))}}class $d extends Ld{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setColors(n),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Jd extends Qd{constructor(e=new $d,t=new kd({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}const ep=["object"],tp=Jt({__name:"Line2",props:{points:{},vertexColors:{default:null},color:{default:"white"},lineWidth:{default:1},worldUnits:{type:Boolean,default:!1},alphaToCoverage:{type:Boolean,default:!1},dashed:{type:Boolean,default:!1},dashSize:{default:1},gapSize:{default:1},dashScale:{default:1},dashOffset:{default:0}},setup(e,{expose:t}){const n=e;const r=new kd,o=new $d,i=new Jd(o,r),{sizes:s,invalidate:a}=wo(),l=Kt((()=>Array.isArray(n.vertexColors)));function c(e,t){e.color=kr(t.color),e.linewidth=t.lineWidth,e.alphaToCoverage=t.alphaToCoverage,e.worldUnits=t.worldUnits,e.vertexColors=Array.isArray(t.vertexColors),e.dashed=t.dashed,e.dashScale=t.dashScale,e.dashSize=t.dashSize,e.dashOffset=t.dashOffset,e.gapSize=t.gapSize,e.needsUpdate=!0}function u(e,t,r){const o=t.map((e=>e instanceof z?[e.x,e.y,e.z]:e instanceof N?[e.x,e.y,0]:Array.isArray(e)&&2===e.length?[e[0],e[1],0]:e)).flat();e.setPositions(o.flat());const s=function(e,t){if(!e||0===e.length)return Array.from({length:t}).fill(kr(n.color));if(1===e.length)return Array.from({length:t}).fill(kr(e[0]));if(e.length===t)return e.map(kr);const r=t-1,o=e.map(kr);closed&&o.push(o[0].clone());const i=[o[0]],s=r/(o.length-1);for(let n=1;n<r;n++){const e=n%s/s,t=Math.floor(n/s);i.push(o[t].clone().lerp(o[t+1],e))}return i.push(o[o.length-1]),i}(r,t.length).map((e=>e.toArray())).flat();e.setColors(s),i.computeLineDistances()}c(r,n),u(o,n.points,n.vertexColors),i.computeLineDistances(),Bt((()=>[n.color,n.lineWidth,n.alphaToCoverage,n.worldUnits,l,n.dashed,n.dashScale,n.dashSize,n.dashOffset]),(()=>{c(r,n),a()})),Bt((()=>[n.points,n.vertexColors]),(()=>{u(o,n.points,n.vertexColors),a()})),Bt((()=>[s.height,s.width]),(()=>{r.resolution=new N(s.width.value,s.height.value),a()})),nn((()=>{o.dispose(),r.dispose()}));const h=tn();return t({instance:h}),(e,t)=>(rn(),on("primitive",{ref:h.value,object:zt(i)},null,8,ep))}}),np=["args"],rp=["color"],op=Jt({__name:"Cone",props:{args:{default:()=>[1,1,12,12,!1,0,2*Math.PI]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{args:r,color:o}=Xt(n),{invalidate:i}=wo();Bt(r,(()=>i()));const s=tn();return t({instance:s}),(e,t)=>(rn(),on("TresMesh",vn({ref_key:"coneRef",ref:s},e.$attrs),[bn("TresConeGeometry",{args:zt(r)},null,8,np),fn(e.$slots,"default",{},(()=>[bn("TresMeshBasicMaterial",{color:zt(o)},null,8,rp)]))],16))}}),ip=["rotation"],sp=["args"],ap=["color"],lp=Jt({__name:"Plane",props:{args:{default:()=>[1,1]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{args:r,color:o}=Xt(n),{invalidate:i}=wo();Bt(r,(()=>i()));const s=tn();return t({instance:s}),(e,t)=>(rn(),on("TresMesh",vn({ref_key:"planeRef",ref:s,rotation:[-Math.PI/2,0,0]},e.$attrs),[bn("TresPlaneGeometry",{args:zt(r)},null,8,sp),fn(e.$slots,"default",{},(()=>[bn("TresMeshBasicMaterial",{color:zt(o)},null,8,ap)]))],16,ip))}}),cp=["args"],up=["color"],hp=Jt({__name:"Sphere",props:{args:{default:()=>[2,32,16]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{args:r,color:o}=Xt(n),{invalidate:i}=wo();Bt(r,(()=>i()));const s=tn();return t({instance:s}),(e,t)=>(rn(),on("TresMesh",vn({ref_key:"sphereRef",ref:s},e.$attrs),[bn("TresSphereGeometry",{args:zt(r)},null,8,cp),fn(e.$slots,"default",{},(()=>[bn("TresMeshBasicMaterial",{color:zt(o)},null,8,up)]))],16))}});class dp extends F{constructor(){super(),Qo(this,"virtualScene",null),this.virtualScene=new d}add(...e){return this.virtualScene.add(...e),this}destructor(){this.virtualScene.traverse((e=>{e instanceof E&&(e.geometry.dispose(),e.material.dispose(),e.material.map&&e.material.map.dispose(),this.virtualScene.remove(e))})),this.virtualScene=null}}const pp=Jt({__name:"component",props:{background:{type:[Boolean,String],default:!1},blur:{default:0},files:{default:()=>[]},path:{default:""},preset:{default:void 0},resolution:{default:256},near:{default:1},far:{default:1e3},frames:{default:Number.POSITIVE_INFINITY}},async setup(e,{expose:t}){let n,r;const o=e,i=jt(null);t({texture:i});const{extend:s,renderer:a,scene:l}=wo();let c=null;const u=jt(null);let h=null;const d=jt(null),{onBeforeRender:p}=xo();let m=1;p((()=>{h&&d.value&&u.value&&(o.frames===Number.POSITIVE_INFINITY||m<o.frames)&&(h.update(a.value,Tn(d.value.virtualScene)),m++)}),-1);const f=([n,r]=dn((()=>async function(e,t){const{scene:n,invalidate:r}=wo(),{preset:o,blur:i,files:s=jt([]),path:a=jt(""),background:l}=Xt(e);Bt(e,(()=>{r()}));const c=jt(null),u=Kt((()=>Array.isArray(s.value))),h=Kt((()=>u.value?Ie:Fa));return Bt([s,a],(async([e,t])=>{if(e&&e.length>0&&(null==o||!o.value)){try{c.value=await so(h.value,u.value?[...zt(e)]:zt(e),(e=>{t&&e.setPath(zt(t))}))}catch(m){throw new Error("Failed to load environment map: ".concat(m))}c.value&&(c.value.mapping=u.value?Pe:Re)}}),{immediate:!0}),Bt(c,(e=>{n.value&&e&&(n.value.environment=e)}),{immediate:!0}),Bt([l,c],(([e,r])=>{if(n.value){const o=null!=t&&t.value?t.value.texture:r;o&&(n.value.background=e?o:null)}}),{immediate:!0}),Bt((()=>null==i?void 0:i.value),(e=>{n.value&&e&&(n.value.backgroundBlurriness=e)}),{immediate:!0}),Bt((()=>null==o?void 0:o.value),(async e=>{if(e&&e in cl){const t="https://raw.githubusercontent.com/Tresjs/assets/main/textures/hdr/",n=cl[e];try{c.value=await so(Fa,n,(e=>{t&&e.setPath(t)}))}catch(f){throw new Error("Failed to load environment map: ".concat(f))}c.value&&c.value&&(c.value.mapping=Re),r()}else if(e&&!(e in cl))throw new Error("Preset must be one of: ".concat(Object.keys(cl).join(", ")))}),{immediate:!0}),c}(o,u))),n=await n,r(),n),g=e=>{e?(l.value.environment=e.texture,o.background&&(l.value.background=e.texture)):(l.value.environment=f.value,o.background&&(l.value.background=f.value))};return Bt(f,(()=>{u.value&&g(u.value)}),{immediate:!0,deep:!0}),Bt((()=>en().default),(e=>{var t,n;if(e&&(c=e,Array.isArray(c)&&c.length>0&&"symbol"!=typeof(null==(t=c[0])?void 0:t.type)))return s({EnvSence:dp}),u.value=new ae(o.resolution),u.value.texture.type=le,h=new ce(o.near,o.far,u.value),void g(u.value);null==(n=u.value)||n.dispose(),u.value=null,g()}),{immediate:!0,deep:!0}),i.value=f.value,nn((()=>{var e,t;null==(e=d.value)||e.destructor(),null==(t=u.value)||t.dispose()})),(e,t)=>u.value?(rn(),on("TresEnvSence",{key:0,ref_key:"envSence",ref:d},[fn(e.$slots,"default")],512)):mn("",!0)}});Boolean,new y(16777215);const mp=["object"],fp=Jt({__name:"ContactShadows",props:{opacity:{default:1},blur:{default:1},color:{default:"#000000"},tint:{default:void 0},scale:{default:10},width:{default:1},height:{default:1},far:{default:10},smooth:{type:Boolean,default:!0},resolution:{default:512},frames:{default:Number.POSITIVE_INFINITY},depthWrite:{type:Boolean,default:!1}},setup(e,{expose:t}){const n=e;function r(e,t,n){n.blurPlane.visible=!0,n.blurPlane.material=n.horizontalBlurMaterial,n.horizontalBlurMaterial.uniforms.tDiffuse.value=n.renderTarget.texture,n.horizontalBlurMaterial.uniforms.h.value=e/256,t.setRenderTarget(n.renderTargetBlur),t.render(n.blurPlane,n.shadowCamera),n.blurPlane.material=n.verticalBlurMaterial,n.verticalBlurMaterial.uniforms.tDiffuse.value=n.renderTargetBlur.texture,n.verticalBlurMaterial.uniforms.v.value=e/256,t.setRenderTarget(n.renderTarget),t.render(n.blurPlane,n.shadowCamera),n.blurPlane.visible=!1}const{onBeforeRender:o}=xo(),i=function(e){var t;const n=new De,r=new Ue(e.resolution,e.resolution);r.texture.generateMipmaps=!1;const o=new Ue(e.resolution,e.resolution);o.texture.generateMipmaps=!1;const i=new ue(e.width,e.height).rotateX(Math.PI/2),s=new M({map:r.texture,opacity:e.opacity,transparent:!0,depthWrite:e.depthWrite,color:new y(null!=(t=e.color)?t:"black")}),a=new E(i,s);n.add(a),a.scale.y=-1;const l=new E(i);l.visible=!1,n.add(l);const c=new _e(-e.width/2,e.width/2,e.height/2,-e.height/2,0,.3);c.rotation.x=Math.PI/2,n.add(c);const u=new Fe,h=new B(oa);h.depthTest=!1;const d=new B(ia);return d.depthTest=!1,{renderTarget:r,renderTargetBlur:o,shadowCamera:c,depthMaterial:u,horizontalBlurMaterial:h,verticalBlurMaterial:d,shadowGroup:n,plane:a,blurPlane:l}}(n);let s=0;const a=()=>s=s>=n.frames?n.frames-1:s;return o((({renderer:e,scene:t,invalidate:o})=>{s<n.frames&&(s++,function(e,t,n,o){const{renderTarget:i,shadowCamera:s,depthMaterial:a}=o,l=t.background;t.background=null,t.overrideMaterial=a;const c=n.getClearAlpha();n.setClearAlpha(0),n.setRenderTarget(i),n.render(t,s),t.overrideMaterial=null,r(e.blur,n,o),e.smooth&&r(.4*e.blur,n,o),n.setRenderTarget(null),n.setClearAlpha(c),t.background=l}(n,t,e,i),o())})),Bt((()=>[n.opacity,n.depthWrite,n.blur,n.smooth]),(()=>{var e,t;i.plane.material.opacity=null!=(e=n.opacity)?e:1,i.plane.material.depthWrite=null!=(t=n.depthWrite)&&t,a()}),{immediate:!0}),Bt((()=>[n.color,n.tint]),(()=>{var e,t,r;e=n,(t=i).plane.material.color=new y(null!=(r=e.color)?r:"black"),t.depthMaterial.dispose(),t.depthMaterial=new Fe,t.depthMaterial.onBeforeCompile=function(t){const n=e.tint?new y(e.tint):new y("white"),{r:r,g:o,b:i}=n;t.fragmentShader="\n    ".concat(t.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( ".concat(r,", ").concat(o,", ").concat(i,", ( 1.0 - fragCoordZ ) * opacity);")),"\n    ")},a()}),{immediate:!0}),Bt((()=>[n.resolution]),(()=>{var e,t;e=n.resolution,(t=i).renderTarget.dispose(),t.renderTargetBlur.dispose(),t.renderTarget=new Ue(e,e),t.renderTarget.texture.generateMipmaps=!1,t.renderTargetBlur=new Ue(e,e),t.renderTargetBlur.texture.generateMipmaps=!1,t.plane.material.map=t.renderTarget.texture,a()})),Bt((()=>[n.width,n.height,n.scale,n.far]),(()=>{(function(e,t){const n=t.shadowCamera;n.left=-e.width/2,n.right=e.width/2,n.top=e.height/2,n.bottom=-e.height/2,n.far=e.far;const r=e.width*(Array.isArray(e.scale)?e.scale[0]:e.scale||1),o=e.height*(Array.isArray(e.scale)?e.scale[1]:e.scale||1);t.shadowGroup.scale.set(r,e.far,o)})(n,i),a()}),{immediate:!0}),nn((()=>{for(const e of Object.values(i))e&&"dispose"in e&&"function"==typeof e.dispose&&e.dispose()})),t({instance:i.shadowGroup}),(e,t)=>(rn(),on("primitive",{object:zt(i).shadowGroup},null,8,mp))}}),gp=["size","color","alpha-map","map","opacity","alpha-test","depth-write","transparent","size-attenuation"],vp=["position","velocity"],yp=Jt({__name:"Precipitation",props:{size:{default:.1},area:{default:()=>[10,10,20]},color:{default:16777215},map:{},alphaMap:{},alphaTest:{default:.01},opacity:{default:.8},count:{default:5e3},speed:{default:.1},randomness:{default:.5},depthWrite:{type:Boolean,default:!1},transparent:{type:Boolean,default:!0},sizeAttenuation:{type:Boolean,default:!0}},setup(e,{expose:t}){const n=e,{size:r,area:o,color:i,alphaMap:s,map:a,opacity:l,alphaTest:c,depthWrite:u,transparent:h,sizeAttenuation:d,count:p,speed:m,randomness:f}=Xt(n),g=tn();let v=[],y=[];const b=()=>{v=new Float32Array(3*p.value);for(let e=0;e<p.value;e++){const t=3*e;v[t]=(Math.random()-.5)*o.value[0],v[t+1]=(Math.random()-.5)*o.value[1],v[t+2]=(Math.random()-.5)*o.value[2]}},_=()=>{y=new Float32Array(2*p.value);for(let e=0;e<2*p.value;e+=2)y[e]=(Math.random()-.5)/5*m.value*f.value,y[e+1]=Math.random()/5*m.value};_(),b(),qt((()=>{_(),b()}));const{onBeforeRender:w}=xo();w((({invalidate:e})=>{var t,n;if(null!=(t=g.value)&&t.attributes.position.array&&null!=(n=g.value)&&n.attributes.position.count){const t=g.value.attributes.position.array;for(let e=0;e<g.value.attributes.position.count;e++){const n=y[2*e],r=y[2*e+1];t[3*e]+=n,t[3*e+1]-=r,(t[3*e]<=-o.value[0]/2||t[3*e]>=o.value[0]/2)&&(t[3*e]=-1*t[3*e]),(t[3*e+1]<=-o.value[1]/2||t[3*e+1]>=o.value[1]/2)&&(t[3*e+1]=-1*t[3*e+1])}g.value.attributes.position.needsUpdate=!0,e()}}));const x=tn();return t({instance:x}),(e,t)=>(rn(),on("TresPoints",{ref_key:"pointsRef",ref:x},[bn("TresPointsMaterial",{size:zt(r),color:zt(i),"alpha-map":zt(s),map:zt(a),opacity:zt(l),"alpha-test":zt(c),"depth-write":zt(u),transparent:zt(h),"size-attenuation":zt(d)},null,8,gp),bn("TresBufferGeometry",{ref_key:"geometryRef",ref:g,position:[zt(v),3],velocity:[zt(y)]},null,8,vp)],512))}}),bp=["object","material-uniforms-turbidity-value","material-uniforms-rayleigh-value","material-uniforms-mieCoefficient-value","material-uniforms-mieDirectionalG-value","material-uniforms-sunPosition-value","scale"],_p=Jt({__name:"Sky",props:{turbidity:{default:3.4},rayleigh:{default:3},mieCoefficient:{default:.005},mieDirectionalG:{default:.7},elevation:{default:.6},azimuth:{default:180},distance:{default:45e4}},setup(e,{expose:t}){const n=e,{invalidate:r}=wo();Bt(n,(()=>r()));const o=tn(),i=new Ls,s=Kt((()=>function(e,t){const n=b.degToRad(90-t),r=b.degToRad(e);return(new z).setFromSphericalCoords(1,n,r)}(n.azimuth,n.elevation)));return t({instance:o,sunPosition:s.value}),(e,t)=>(rn(),on("primitive",{ref_key:"skyRef",ref:o,object:zt(i),"material-uniforms-turbidity-value":n.turbidity,"material-uniforms-rayleigh-value":n.rayleigh,"material-uniforms-mieCoefficient-value":n.mieCoefficient,"material-uniforms-mieDirectionalG-value":n.mieDirectionalG,"material-uniforms-sunPosition-value":s.value,scale:n.distance},null,8,bp))}}),wp=["position","a-scale"],xp=["size","size-attenuation","transparent","alpha-test","alpha-map"],Tp=Jt({__name:"Stars",props:{size:{default:.1},sizeAttenuation:{type:Boolean,default:!0},transparent:{type:Boolean,default:!0},alphaTest:{default:.01},count:{default:5e3},depth:{default:50},radius:{default:100},alphaMap:{default:null}},setup(e,{expose:t}){const n=e,r=jt(),o=jt(),{radius:i,depth:s,count:a,size:l,sizeAttenuation:c,transparent:u,alphaMap:h,alphaTest:d}=Xt(n),{invalidate:p}=wo();Bt(n,(()=>{p()}));qt((()=>{(()=>{let e=i.value+s.value;const t=Kt((()=>s.value/a.value)),n=[],l=Array.from({length:a.value},(()=>4*(.5+.5*Math.random()))),c=e=>(new z).setFromSpherical(new ne(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)).toArray();for(let r=0;r<a.value;r++)e-=t.value*Math.random(),n.push(...c(e));r.value=new Float32Array(n),o.value=new Float32Array(l)})()}));const m=tn();return t({instance:m}),(e,t)=>(rn(),on("TresPoints",{ref_key:"starsRef",ref:m},[bn("TresBufferGeometry",{position:[r.value,3],"a-scale":[o.value,1]},null,8,wp),bn("TresPointsMaterial",{size:zt(l),"size-attenuation":zt(c),transparent:zt(u),"alpha-test":zt(d),"alpha-map":zt(h)},null,8,xp)],512))}});!function(){var e=function(){function t(e){return o.appendChild(e.dom),e}function n(e){for(var t=0;t<o.children.length;t++)o.children[t].style.display=t===e?"block":"none";r=e}var r=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",(function(e){e.preventDefault(),n(++r%o.children.length)}),!1);var i=(performance||Date).now(),s=i,a=0,l=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:o,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-i,200),e>s+1e3&&(l.update(1e3*a/(e-s),100),s=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:o,setMode:n}};e.Panel=function(e,t,n){var r=1/0,o=0,i=Math.round,s=i(window.devicePixelRatio||1),a=80*s,l=48*s,c=3*s,u=2*s,h=3*s,d=15*s,p=74*s,m=30*s,f=document.createElement("canvas");f.width=a,f.height=l,f.style.cssText="width:80px;height:48px";var g=f.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,c,u),g.fillRect(h,d,p,m),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,d,p,m),{dom:f,update:function(l,v){r=Math.min(r,l),o=Math.max(o,l),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=t,g.fillText(i(l)+" "+e+" ("+i(r)+"-"+i(o)+")",c,u),g.drawImage(f,h+s,d,p-s,m,h,d,p-s,m),g.fillRect(h+p-s,d,s,m),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+p-s,d,s,i((1-l/v)*m))}}}}();const Ep=new z(0,0,0),Mp=new z(0,0,0),Ap=new z(0,0,0);function Sp(e,t,n){const r=Ep.setFromMatrixPosition(e.matrixWorld);r.project(t);const o=n.width/2,i=n.height/2;return[(Number.isNaN(r.x)?0:r.x)*o+o,-r.y*i+i]}const Op=e=>Math.abs(e)<1e-10?0:e;function Cp(e,t,n=""){let r="matrix3d(";for(let o=0;16!==o;o++)r+=Op(t[o]*e.elements[o])+(15!==o?",":")");return n+r}const Ip=(e=>t=>Cp(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Pp=(e=>(e,t)=>Cp(e,(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1])(t),"translate(-50%,-50%)"))(),Rp=["geometry","material"],Lp=Jt({__name:"HTML",props:{geometry:{default:new ue},material:{},as:{default:"div"},transform:{type:Boolean,default:!1},portal:{},wrapperClass:{},eps:{default:1e-4},distanceFactor:{},fullscreen:{type:Boolean},center:{type:Boolean},pointerEvents:{default:"auto"},sprite:{type:Boolean,default:!1},zIndexRange:{default:()=>[16777271,0]},occlude:{type:[Object,null,Array,Boolean,String]}},emits:["onOcclude"],setup(e,{expose:t,emit:n}){const r=e,o=n,i=en(),s=_n(),c=jt(),u=jt(),{geometry:h,material:d,as:p,transform:m,portal:g,wrapperClass:v,eps:y,distanceFactor:b,fullscreen:_,center:w,pointerEvents:x,sprite:T,occlude:E,zIndexRange:M}=Xt(r),{renderer:A,scene:S,camera:O,raycaster:C,sizes:I}=wo(),P=Kt((()=>document.createElement(p.value))),R=jt([0,0]),L=jt(0),k=jt(),D=Kt((()=>m.value?{position:"absolute",top:0,left:0,width:"".concat(I.width.value,"px"),height:"".concat(I.height.value,"px"),transformStyle:"preserve-3d",pointerEvents:"none",zIndex:2,willChange:"transform"}:l(a(l(a({position:"absolute",transform:w.value?"translate3d(-50%,-50%,0)":"none"},_.value&&{top:-I.height.value/2,left:-I.width.value/2,width:"".concat(I.width.value,"px"),height:"".concat(I.height.value,"px")}),{zIndex:2}),Object.assign({},s.style)),{willChange:"transform"}))),U=Kt((()=>({position:"absolute",pointerEvents:x.value}))),F=jt(null),H=jt(!1),V=Kt((()=>(null==E?void 0:E.value)&&"blending"!==(null==E?void 0:E.value)||Array.isArray(null==E?void 0:E.value)&&(null==E?void 0:E.value.length)&&Ht(E.value[0])));Bt((()=>E),(({value:e})=>{"blending"===e?(P.value.style.zIndex="".concat(Math.floor(M.value[0]/2)),P.value.style.position="absolute",P.value.style.pointerEvents="none"):(P.value.style.zIndex=null,P.value.style.position=null,P.value.style.pointerEvents=null)})),Bt((()=>{var e;return[c.value,A.value,I.width.value,I.height.value,null==(e=i.default)?void 0:e.call(i)]}),(([e,t])=>{var n,r,o,a,l,c;if(e&&t){const h=(null==g?void 0:g.value)||t.domElement;if(null==(n=S.value)||n.updateMatrixWorld(),m.value)P.value.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=Sp(e,O.value,{width:I.width.value,height:I.height.value});P.value.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(t[0],"px,").concat(t[1],"px,0);transform-origin:0 0;")}h&&!P.value.parentNode&&(null==(r=h.parentNode)||r.appendChild(P.value)),m.value?k.value=wn("div",{id:"outer",style:D.value},[wn("div",{id:"inner",style:U.value},[wn("div",{key:null==(o=u.value)?void 0:o.uuid,id:null==S?void 0:S.value.uuid,class:s.class,style:s.style},null==(a=i.default)?void 0:a.call(i))])]):k.value=wn("div",{key:null==(l=u.value)?void 0:l.uuid,id:null==S?void 0:S.value.uuid,style:D.value},null==(c=i.default)?void 0:c.call(i)),xn(k.value,P.value)}})),qt((()=>{null!=v&&v.value&&(P.value.className=v.value)}));const Y=jt(!0),{onBeforeRender:X}=xo();X((({invalidate:e})=>{var t,n,r,i,a,l,d;if(e(),c.value&&O.value&&A.value){null==(t=O.value)||t.updateMatrixWorld(),c.value.updateWorldMatrix(!0,!1);const e=m.value?R.value:Sp(c.value,O.value,{width:I.width.value||0,height:I.height.value||0});if(m.value||Math.abs(L.value-O.value.zoom)>y.value||Math.abs(R.value[0]-e[0])>y.value||Math.abs(R.value[1]-e[1])>y.value){const t=function(e,t){const n=Ep.setFromMatrixPosition(e.matrixWorld),r=Mp.setFromMatrixPosition(t.matrixWorld),o=n.sub(r),i=t.getWorldDirection(Ap);return o.angleTo(i)>Math.PI/2}(c.value,O.value);let i=!1;V.value&&(Array.isArray(null==E?void 0:E.value)?i=null==E?void 0:E.value:"blending"!==(null==E?void 0:E.value)&&(i=[S.value]));const s=Y.value;if(i){const e=function(e,t,n,r){const o=Ep.setFromMatrixPosition(e.matrixWorld),i=o.clone();i.project(t),n.setFromCamera(new N(i.x,i.y),t);const s=n.intersectObjects(r,!0);if(s.length>0){const e=s[0].distance;return o.distanceTo(n.ray.origin)<e}return!0}(c.value,O.value,C.value,i);Y.value=e&&!t}else Y.value=!t;s!==Y.value&&(o("onOcclude",!Y.value),P.value.style.display=Y.value?"block":"none");const a=Math.floor(M.value[0]/2),l=null!=E&&E.value?V.value?[M.value[0],a]:[a-1,0]:M.value;if(P.value.style.zIndex="".concat(function(e,t,n){if(t instanceof f||t instanceof _e){const r=Ep.setFromMatrixPosition(e.matrixWorld),o=Mp.setFromMatrixPosition(t.matrixWorld),i=r.distanceTo(o),s=(n[1]-n[0])/(t.far-t.near),a=n[1]-s*t.far;return Math.round(s*i+a)}}(c.value,O.value,l)),P.value.style.willChange="transform",m.value){const[e,t]=[I.width.value/2,I.height.value/2],o=O.value.projectionMatrix.elements[5]*t,{isOrthographicCamera:i,top:s,left:a,bottom:l,right:u}=O.value,h=Ip(O.value.matrixWorldInverse),d=i?"scale(".concat(o,")translate(").concat(Op(-(u+a)/2),"px,").concat(Op((s+l)/2),"px)"):"translateZ(".concat(o,"px)");let p=c.value.matrixWorld;if(T.value&&(p=O.value.matrixWorldInverse.clone().transpose().copyPosition(p).scale(c.value.scale),p.elements[3]=p.elements[7]=p.elements[11]=0,p.elements[15]=1),P.value.style.width="".concat(I.width.value,"px"),P.value.style.height="".concat(I.height.value,"px"),P.value.style.perspective=i?"":"".concat(o,"px"),null!=(n=k.value)&&n.el&&null!=(r=k.value)&&r.children&&Array.isArray(k.value.children)){k.value.el.style.willChange="transform",k.value.el.style.transform="".concat(d).concat(h,"translate(").concat(e,"px,").concat(t,"px)");const n=k.value.children[0];n&&n.el&&(n.el.style.willChange="transform",n.el.style.transform=Pp(p,1/(((null==b?void 0:b.value)||10)/400)))}}else{const t=void 0===(null==b?void 0:b.value)?1:function(e,t){if(t instanceof _e)return t.zoom;if(t instanceof f){const n=Ep.setFromMatrixPosition(e.matrixWorld),r=Mp.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,i=n.distanceTo(r);return 1/(2*Math.tan(o/2)*i)}return 1}(c.value,O.value)*(null==b?void 0:b.value);P.value.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(t,")")}}R.value=e,L.value=O.value.zoom}if(!V.value&&u.value&&!H.value)if(m.value){if(null!=(i=k.value)&&i.el&&null!=(a=k.value)&&a.children){const e=(null==(l=k.value)?void 0:l.children)[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=O.value;if(t||h)s.scale&&(Array.isArray(s.scale)?s.scale instanceof z?u.value.scale.copy(s.scale.clone().divideScalar(1)):u.value.scale.set(1/s.scale[0],1/s.scale[1],1/s.scale[2]):u.value.scale.setScalar(1/s.scale));else{const t=((null==b?void 0:b.value)||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;u.value.scale.set(n,r,1)}H.value=!0}}}else{const e=P.value.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const t=1*e.clientWidth,n=1*e.clientHeight;u.value.scale.set(t,n,1),H.value=!0}F.value.lookAt(null==(d=O.value)?void 0:d.position)}}));const G=Kt((()=>({vertexShader:m.value?void 0:"#include <common>\n\nvoid main() {\n  vec2 center = vec2(0., 1.);\n  float rotation = 0.0;\n\n  \n  \n  float size = 0.03;\n\n  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n  bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n  if ( isPerspective ) scale *= - mvPosition.z;\n\n  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n  mvPosition.xy += rotatedPosition;\n\n  gl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"void main() {\n  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n}"}))),W=Kt((()=>{const e=G.value;return d.value||new B({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:j})}));return nn((()=>{W.value&&W.value.dispose(),P.value.remove()})),t({instance:c}),(e,t)=>(rn(),on("TresGroup",{ref_key:"groupRef",ref:c},[zt(E)&&!V.value?(rn(),on("TresMesh",{key:0,ref_key:"meshRef",ref:u,geometry:zt(h),material:W.value},null,8,Rp)):mn("",!0)],512))}});function kp(e){return"function"==typeof e?e():zt(e)}const Dp=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const Up=Dp?window:void 0;function Fp(e,t={}){var n,r;const{pointerTypes:o,preventDefault:i,stopPropagation:s,exact:c,onMove:u,onEnd:h,onStart:d,initialValue:p,axis:m="both",draggingElement:f=Up,handle:g=e}=t,{width:v}=Rn();let y=v.value;const b=jt(null!=(n=kp(p))?n:{x:0,y:0});Bt(v,(()=>{const e=v.value-y;b.value.x+=e,y=v.value}));const _=jt(),w=e=>!o||o.includes(e.pointerType),x=e=>{kp(i)&&e.preventDefault(),kp(s)&&e.stopPropagation()},T=t=>{if(!w(t)||kp(c)&&t.target!==kp(e))return;const n=kp(e).getBoundingClientRect(),r={x:t.clientX-n.left,y:t.clientY-n.top};!1!==(null==d?void 0:d(r,t))&&(_.value=r,x(t))},E=e=>{if(!w(e)||!_.value)return;let{x:t,y:n}=b.value;("x"===m||"both"===m)&&(t=e.clientX-_.value.x),("y"===m||"both"===m)&&(n=e.clientY-_.value.y),b.value={x:t,y:n},null==u||u(b.value,e),x(e)},M=e=>{w(e)&&_.value&&(_.value=void 0,null==h||h(b.value,e),x(e))};if(Dp){const e={capture:null==(r=t.capture)||r};Dn(g,"pointerdown",T,e),Dn(f,"pointermove",E,e),Dn(f,"pointerup",M,e)}return l(a({},function(e,t={}){if(!Ht(e))return Xt(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const r in e.value)n[r]=Gt((()=>({get:()=>e.value[r],set(n){var o;if(null==(o=kp(t.replaceRef))||o)if(Array.isArray(e.value)){const t=[...e.value];t[r]=n,e.value=t}else{const t=l(a({},e.value),{[r]:n});Object.setPrototypeOf(t,Object.getPrototypeOf(e.value)),e.value=t}else e.value[r]=n}})));return n}(b)),{position:b,isDragging:Kt((()=>!!_.value)),style:Kt((()=>"left:".concat(b.value.x,"px;top:").concat(b.value.y,"px;")))})}const Np=Jt({name:"UseDraggable",props:["storageKey","storageType","initialValue","exact","preventDefault","stopPropagation","pointerTypes","as","handle","axis","onStart","onMove","onEnd"],setup(e,{slots:t}){const n=jt(),r=Kt((()=>{var t;return null!=(t=e.handle)?t:n.value})),o=e.storageKey&&Ln(e.storageKey,kp(e.initialValue)||{x:0,y:0},kn?"session"===e.storageType?sessionStorage:localStorage:void 0),i=o||e.initialValue||{x:0,y:0},s=$t(Fp(n,l(a({},e),{handle:r,initialValue:i,onEnd:(t,n)=>{var r;null==(r=e.onEnd)||r.call(e,t,n),o&&(o.value.x=t.x,o.value.y=t.y)}})));return()=>{if(t.default)return un(e.as||"div",{ref:n,style:"touch-action:none;".concat(s.style)},t.default(s))}}}),zp=Symbol("CONTROLS_CONTEXT_KEY"),jp="default",Bp=$t({});const Hp=e=>"boolean"==typeof e?"boolean":"number"==typeof e?"number":"string"==typeof e&&/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^0x([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e)?"color":"string"==typeof e?"string":e.isVector3||e.isVector2||e.isEuler||e.value instanceof Array||e.value.isVector3||e.value.isVector2||e.value.isEuler||e.value.value instanceof Array?"vector":void 0!==e.min||void 0!==e.max||void 0!==e.step?"range":e.options&&Array.isArray(e.options)?"select":"unknown",Vp=(e,t,n,r)=>{const o={key:jt(e),label:jt(e),name:jt(e),type:jt(n),value:jt(t),visible:jt(!0),icon:jt(),uniqueKey:jt(e),[e]:jt(t)};return r&&(o.folder=jt(r)),o},Yp=(e,t,n)=>{const r={},o="string"==typeof e?e:null,i=o?t:e,s=o&&"fpsgraph"!==o?n:t,a=(null==s?void 0:s.uuid)||jp;if(Bp[a]||(Bp[a]=$t({})),"fpsgraph"===e){const e=Vp("fpsgraph",null,"fpsgraph",null);return Bp[a].fpsgraph=e,r.fpsgraph=e,Xt($t(r))}const l=Bp[a],c=En(i),u=c?Xt(i):{};for(const h in i){let e=i[h],t=h;if(c&&u[h]&&(e=u[h]),o&&(t="".concat(o).concat(h.charAt(0).toUpperCase()+h.slice(1))),"object"==typeof e&&!Ht(e)&&!Array.isArray(e)&&void 0!==e.value){const n=e,i=Ht(n.value)?n.value:jt(n.value),s=n.type||Hp(n),a=Vp(h,i,s,o);"select"===s&&(a.options=jt(n.options.map((e=>"object"==typeof e&&e.text&&e.value?e:{text:e,value:e})))),"range"===s&&(a.min=jt(n.min||0),a.max=jt(n.max||1),a.step=jt(n.step||.1)),a.label.value=n.label||h,a.icon.value=n.icon,a.visible.value=void 0===n.visible||n.visible,a.uniqueKey.value=t,l[t]=a,r[t]=a;continue}if(Ht(e)){const n=Vp(h,e,e.value.type||Hp(e.value),o);l[t]=n,r[t]=n;continue}if("object"==typeof e&&!Array.isArray(e)){const t=Xt(e);t[h]&&(e=t[h])}const n=Vp(h,e,e.type||Hp(e),o);l[t]=n,r[t]=n,n.uniqueKey.value=t}return Object.keys(r).length>1?Xt($t(r)):Object.values(r)[0]},Xp=["for","title"],Gp=Jt({__name:"ControlLabel",props:{label:{},control:{}},setup:e=>(e,t)=>(rn(),on("label",{for:e.control.uniqueKey,title:e.label,class:"tl-text-gray-500 tl-w-1/3 tl-truncate"},[e.control.icon?(rn(),on("i",{key:0,class:sn(e.control.icon)},null,2)):(rn(),on(hn,{key:1},[Pn(Sn(e.label),1)],64))],8,Xp))}),Wp={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},Zp=["id","value","min","max","step"],Kp=Jt({__name:"NumberControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function o(e){const{target:t}=e;r("change",t.valueAsNumber)}const i=Un(),s=jt(0),a=jt(!1),l=e=>{s.value=e.clientX,a.value=!0},c=()=>{a.value=!1};return Bt(i.x,(e=>{if(a.value){const t=e-s.value,o=(e=>Math.floor(Math.abs(e)/10))(t);t>0?r("change",n.control.value+1+o):t<0&&r("change",n.control.value-1+o),void 0!==n.control.min&&n.control.value<n.control.min&&r("change",n.control.min),void 0!==n.control.max&&n.control.value>n.control.max&&r("change",n.control.max),s.value=e}})),(e,t)=>(rn(),on("div",Wp,[wn(Gp,{label:e.label,control:e.control},null,8,["label","control"]),bn("input",{id:e.control.uniqueKey,value:e.control.value,class:sn(["tl-p-2 tl-w-1/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans",{"tl-cursor-ew-resize":a.value}]),type:"number",min:e.control.min,max:e.control.max,step:e.control.step,onInput:o,onMousedown:l,onMouseup:c},null,42,Zp)]))}}),qp={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2 tl-min-h-32px"},Qp=["id","value","aria-label"],$p=Jt({__name:"TextControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){const{target:t}=e;n("change",t.value)}return(e,t)=>(rn(),on("div",qp,[wn(Gp,{label:e.label,control:e.control},null,8,["label","control"]),bn("input",{id:e.control.uniqueKey,value:e.control.value,type:"text",tabindex:"0",class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 focus:tl-border-gray-200 tl-border-none tl-font-sans","aria-label":e.label,placeholder:"Enter value here...",onChange:r},null,40,Qp)]))}}),Jp={class:"tl-flex tl-px-4 tl-justify-start tl-gap-2 tl-items-center tl-mb-2 tl-min-h-32px"},em={class:"tl-text-gray-500 tl-w-1/3"},tm=["id","checked"],nm=["for"],rm=["aria-checked"],om={class:"i-ic:baseline-check tl-text-light"},im=Jt({__name:"BooleanControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function o(e){const{target:t}=e;r("change",t.checked)}function i(e){("Space"===e.code||"Enter"===e.code)&&(e.preventDefault(),r("change",!n.control.value))}return(e,t)=>(rn(),on("div",Jp,[bn("label",em,Sn(e.label),1),bn("input",{id:e.control.uniqueKey,checked:e.control.value,class:"tl-hidden",type:"checkbox",onInput:o},null,40,tm),bn("label",{for:e.control.uniqueKey,class:"tl-inline-flex tl-items-center tl-cursor-pointer"},[bn("span",{tabindex:"0",role:"checkbox","aria-checked":e.control.value.toString(),class:sn([{"tl-bg-dark-500":e.control.value,"tl-bg-gray-200":!e.control.value},"tl-w-4 tl-h-4 tl-flex tl-justify-center tl-items-center tl-rounded tl-border tl-border-gray-300 tl-mr-2 tl-transition-colors tl-duration-200"]),onKeydown:i},[On(bn("i",om,null,512),[[Cn,e.control.value]])],42,rm)],8,nm)]))}}),sm={class:"tl-px-4 tl-relative tl-flex tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},am=["value","min","max","step"],lm=["value","min","max","step"],cm=Jt({__name:"SliderControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function o(e){const{target:t}=e;r("change",t.valueAsNumber)}const i=Kt((()=>({backgroundImage:"linear-gradient(to right, #333 0% ".concat(100*(n.control.value-(n.control.min||0))/((n.control.max||100)-(n.control.min||0)),"%, #e2e2e2 0%)")}))),s=Un(),a=jt(0),l=jt(!1),c=e=>{a.value=e.clientX,l.value=!0},u=()=>{l.value=!1};return Bt(s.x,(e=>{if(l.value){const t=e-a.value,o=(e=>Math.floor(Math.abs(e)/10))(t);t>0?r("change",n.control.value+1+o):t<0&&r("change",n.control.value-1+o),void 0!==n.control.min&&n.control.value<n.control.min&&r("change",n.control.min),void 0!==n.control.max&&n.control.value>n.control.max&&r("change",n.control.max),a.value=e}})),(e,t)=>(rn(),on("div",sm,[wn(Gp,{label:e.label,control:e.control},null,8,["label","control"]),bn("input",{value:e.control.value,class:"tl-w-1/2 tl-h-0.75 tl-bg-dark-200 tl-rounded-full tl-appearance-none",style:an(i.value),type:"range",min:e.control.min,max:e.control.max,step:e.control.step,onInput:o},null,44,am),bn("input",{value:e.control.value,class:sn(["tl-p-2 tl-w-1/4 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans",{"tl-cursor-ew-resize":l.value}]),type:"number",min:e.control.min,max:e.control.max,step:e.control.step,onInput:o,onMousedown:c,onMouseup:u},null,42,lm)]))}}),um=(e,t)=>{const n=e.__vccOpts||e;for(const[r,o]of t)n[r]=o;return n},hm=um(cm,[["__scopeId","data-v-e775088a"]]),dm={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},pm={class:"tl-text-gray-500 tl-w-1/3"},mm=["id","value","aria-label"],fm=["id","aria-label","value"],gm=Jt({__name:"ColorControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){const{target:t}=e;n("change",t.value)}return(e,t)=>(rn(),on("div",dm,[bn("label",pm,Sn(e.label),1),bn("input",{id:e.control.uniqueKey,tabindex:"0",value:e.control.value,"aria-label":e.label,class:sn(["focus:tl-outline-none focus:tl-ring-2 focus:tl-ring-blue-600",{"important-tl-outline-gray-200":"#ffffff"===e.control.value}]),type:"color",onInput:r},null,42,mm),bn("input",{id:e.control.uniqueKey,tabindex:"0","aria-label":e.label,value:e.control.value,class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-border-none tl-font-sans",type:"text",onInput:r},null,40,fm)]))}});function vm(e){return e&&"number"==typeof e.x&&"number"==typeof e.y}function ym(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}const bm={class:"tl-relative tl-w-2/3 tl-flex tl-justify-between tl-gap-0.5"},_m={key:0,class:"tl-font-bold tl-px-1 tl-py-1 tl-text-0.65rem tl-text-gray-300"},wm=["id","step","value","onInput","onMousedown","onMouseup","onFocus"],xm=Jt({__name:"VectorControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t,o=Un(),{pressed:i}=Fn(),s=jt(0),a=jt(!1),l=jt(0),c=jt(null),u=jt(1),h=Nn("Shift"),d=Nn("Alt");Bt(h,(e=>{u.value=e?10:1})),Bt(d,(e=>{u.value=e?.1:1}));const p=()=>{c.value=null};Bt(i,(e=>{e||(a.value=!1)}));const m=Kt((()=>function(e){if("number"==typeof e)return[e,e,e];if(ym(e)){const{x:t,y:n,z:r}=e;return[t,n,r]}if(vm(e)){const{x:t,y:n}=e;return[t,n]}return e}(n.control.value))),f=jt(["x","y","z"]),g=Kt((()=>vm(n.control.value)||ym(n.control.value)));return Bt(o.x,(e=>{if(a.value){const t=e-s.value,o=(e=>Math.floor(Math.abs(e)/10))(t),{value:i}=n.control,a=g.value?f.value[l.value]:l.value;t>0?i[a]+=u.value+o:t<0&&(i[a]-=u.value+o),void 0!==n.control.min&&i<n.control.min&&(i[a]=n.control.min),void 0!==n.control.max&&i>n.control.max&&(i[a]=n.control.max),r("change",i),s.value=e}})),(e,t)=>(rn(),on("div",{class:"tl-flex tl-px-4 tl-justify-between tl-gap-1 tl-items-center tl-mb-2",onMouseup:t[0]||(t[0]=e=>{a.value=!1})},[wn(Gp,{label:e.label,control:e.control},null,8,["label","control"]),bn("div",bm,[(rn(!0),on(hn,null,An(m.value,((t,o)=>(rn(),on("div",{key:e.label+o,class:sn(["tl-flex tl-items-center tl-bg-gray-100 tl-rounded",{"tl-w-2/5":c.value===o,"tl-w-1/3":zt(ym)(e.control.value),"tl-w-1/2":zt(vm)(e.control.value)}])},[f.value[o]&&g.value?(rn(),on("span",_m,Sn(f.value[o]),1)):mn("",!0),bn("input",{id:"".concat(e.control.uniqueKey,"-").concat(f.value[o]),type:"number",step:u.value,class:sn(["tl-w-full tl-px-0 tl-p-1 tl-text-right tl-text-0.65rem tl-text-gray-400 tl-bg-transparent focus:tl-border-gray-200 tl-outline-none tl-border-none tl-font-sans tl-appearence-none",{"tl-cursor-ew-resize":a.value}]),value:m.value[o].toFixed(2),onInput:e=>function(e,t){const{value:o}=n.control,{target:i}=e;l.value=t,o[g.value?f.value[l.value]:l.value]=parseFloat(i.value),r("change",o)}(e,o),onMousedown:e=>((e,t)=>{l.value=t,s.value=e.clientX,a.value=!0})(e,o),onMouseup:e=>((e,t)=>{l.value=t,a.value=!1})(0,o),onFocus:e=>(e=>{c.value=e})(o),onBlur:p},null,42,wm)],2)))),128))])],32))}}),Tm={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},Em={class:"tl-text-gray-500 tl-w-1/3"},Mm={class:"tl-relative tl-w-2/3 tl-p-1 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans"},Am={class:"tl-absolute tl-bottom-0.5 tl-right-0.5 tl-font-sans tl-text-xs"},Sm=["points"],Om=Jt({__name:"FPSGraph",props:{label:{},control:{}},setup(e){const t=zn({every:100}),n=jt(""),r=jt([]),o=jt(80);let i=performance.now();return jn((({timestamp:e})=>{e-i>=100&&(i=e,r.value.push(t.value),r.value.length>o.value&&r.value.shift(),n.value=r.value.map(((e,t)=>"".concat(2*t,",").concat(59-58*e/120))).join(" "))})),(e,r)=>(rn(),on("div",Tm,[bn("label",Em,Sn(e.label),1),bn("div",Mm,[bn("div",Am,Sn(Math.round(zt(t)))+" FPS ",1),(rn(),on("svg",{width:160,height:40,xmlns:"http://www.w3.org/2000/svg",class:"tl-bg-gray-100"},[bn("polyline",{points:n.value,fill:"none",stroke:"lightgray","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},null,8,Sm)]))])]))}}),Cm={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2 tl-min-h-32px"},Im=["id","value"],Pm=["value"],Rm=Jt({__name:"SelectControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){n("change",e.target.value)}return(e,t)=>(rn(),on("div",Cm,[wn(Gp,{label:e.label,control:e.control},null,8,["label","control"]),bn("select",{id:e.control.uniqueKey,value:e.control.value,class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-left tl-text-xs tl-text-gray-400 tl-bg-gray-100 focus:tl-border-gray-200 tl-outline-none tl-border-none tl-font-sans",onChange:r},[(rn(!0),on(hn,null,An(e.control.options,(e=>(rn(),on("option",{key:e.value,value:e.value},Sn(e.text),9,Pm)))),128))],40,Im)]))}}),Lm=Jt({__name:"ButtonControl",props:{label:{},control:{}},setup(e){const t=e,n=Kt((()=>["leches-btn","leches-btn-".concat(t.control.value.variant||"primary"),"leches-btn-".concat(t.control.value.size||"sm")]));return(e,t)=>(rn(),on("button",{class:sn(n.value),onClick:t[0]||(t[0]=(...t)=>e.control.value.onClick&&e.control.value.onClick(...t))},[bn("i",{class:sn([e.control.value.icon,e.control.value.label?"mr-1":""])},null,2),Pn(" "+Sn(e.control.value.label),1)],2))}}),km=um(Lm,[["__scopeId","data-v-6a95ac59"]]),Dm=Jt({__name:"ControlInput",props:{control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){n("change",e)}return(e,t)=>e.control.visible?(rn(),on(hn,{key:0},["color"===e.control.type?(rn(),yn(gm,{key:0,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"select"===e.control.type?(rn(),yn(Rm,{key:1,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"vector"===e.control.type?(rn(),yn(xm,{key:2,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"boolean"===e.control.type?(rn(),yn(im,{key:3,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"fpsgraph"===e.control.type?(rn(),yn(Om,{key:4,label:e.control.label,control:e.control},null,8,["label","control"])):"number"===e.control.type?(rn(),yn(Kp,{key:5,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"range"===e.control.type?(rn(),yn(hm,{key:6,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"button"===e.control.type?(rn(),on("div",{key:7,class:sn(["tl-p-2","tl-block"===e.control.value.size?"tl-flex":"tl-inline-flex"])},[wn(km,{label:e.control.label,control:e.control},null,8,["label","control"])],2)):(rn(),yn($p,{key:8,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"]))],64)):mn("",!0)}}),Um={class:"tl-mb-4"},Fm=["aria-expanded","data-folder"],Nm={class:"tl-bg-white tl-rounded-b tl-pt-4",role:"menu"},zm=Jt({__name:"Folder",props:{controls:{},label:{}},setup(e){const t=jt(!1),n=()=>{t.value=!t.value};return(e,r)=>(rn(),on("div",Um,[bn("button",{class:"tl-flex tl-items-center tl-justify-between tl-w-full tl-py-2 tl-px-4 tl-bg-gray-100 tl-border-none tl-text-gray-400 tl-font-bold tl-text-xs tl-font-sans tl-cursor-pointer","aria-expanded":t.value,"aria-haspopup":"true",role:"button","data-folder":e.label,tabindex:"0",onClick:n},[bn("span",null,Sn(e.label),1),bn("i",{class:sn(t.value?"i-ic:baseline-keyboard-arrow-up":"i-ic:baseline-keyboard-arrow-down")},null,2)],8,Fm),wn(In,{name:"slide","enter-active-class":"tl-animate-fade-in tl-animate-duration-200 tl-animate-ease-in-out","leave-active-class":"tl-animate-fade-out tl-animate-duration-200 tl-animate-ease-in-out"},{default:Mn((()=>[On(bn("div",Nm,[(rn(!0),on(hn,null,An(e.controls,(e=>(rn(),yn(Dm,{key:e.label,control:e,role:"menuitem",onChange:t=>function(e,t){t.value=e}(t,e)},null,8,["control","onChange"])))),128))],512),[[Cn,t.value]])])),_:1})]))}}),jm={tabindex:"0",class:"tl-bg-white tl-shadow-xl tl-rounded tl-border-4 tl-border-solid tl-border-black"},Bm=[bn("i",{class:"tl-h-4 tl-w-4 tl-p-1.5 tl-flex tl-items-center tl-line-height-0 tl-rounded-full tl-bg-gray-100 tl-text-xs"},"ðŸ°",-1),bn("div",null,[bn("i",{class:"i-ic-baseline-drag-indicator"}),bn("i",{class:"i-ic-baseline-drag-indicator"}),bn("i",{class:"i-ic-baseline-drag-indicator"})],-1),bn("div",null,null,-1)],Hm=Jt({__name:"TresLeches",props:{uuid:{}},setup(e){const t=e,{uuid:n}=Xt(t),{width:r}=Rn(),o=jt(null),i=function(e=jp){return ln(zp,Bp),Bp[e]}(null==n?void 0:n.value);const s=Kt((()=>{const e={};for(const t in i){const n=i[t],r=n.folder||"default";e[r]||(e[r]=[]),e[r].push(n)}return e}));return(e,t)=>(rn(),yn(zt(Np),{id:zt(n),"initial-value":{x:zt(r)-280-40,y:10},class:sn(["tl-absolute tl-select-none tl-z-24 tl-w-280px tl-font-sans tl-text-xs",e.$attrs.class]),handle:o.value},{default:Mn((()=>[bn("div",jm,[bn("header",{ref_key:"handle",ref:o,class:"tl-relative tl-cursor-grabbing tl-p-4 tl-flex tl-justify-between tl-text-gray-200 tl-relative"},Bm,512),(rn(!0),on(hn,null,An(s.value,((e,t)=>(rn(),on(hn,{key:t},["default"!==t?(rn(),yn(zm,{key:0,label:t,controls:e},null,8,["label","controls"])):mn("",!0),"default"===t?(rn(!0),on(hn,{key:1},An(e,(e=>(rn(),yn(Dm,{key:e.label,control:e,onChange:t=>function(e,t){i[zt(e)].value=t,i[zt(e)][zt(e)]=t}(e.key,t)},null,8,["control","onChange"])))),128)):mn("",!0)],64)))),128))])])),_:1},8,["id","initial-value","class","handle"]))}});export{Oc as $,tp as B,Ha as C,Lp as D,yp as E,Hm as F,co as G,Ya as I,Sd as J,Ru as K,Ho as L,_p as M,so as N,Tp as P,lh as Q,Va as R,fp as T,Pr as U,bc as V,Ec as W,xc as X,wc as Y,Ko as Z,pp as _,Cc as a,Du as b,hc as c,hp as d,Yp as e,Zo as f,yc as j,Ac as l,Id as n,wo as p,uc as q,op as r,lp as u,ao as z};
