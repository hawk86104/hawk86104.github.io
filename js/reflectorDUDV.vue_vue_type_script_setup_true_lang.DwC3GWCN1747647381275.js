import{ch as e,ae as s,l as i,m as t}from"./three.xEBIAocQ1747647381275.js";import{b as r}from"./@tresjs.Bz18oYQt1747647381275.js";import{R as a,b as l}from"./all.three.Dcmci9NN1747647381275.js";import{q as o}from"./vite-plugin-qiankun.B06WoCqG1747647381275.js";import{d as n,a5 as u,a2 as _,w as c,G as f,o as p,I as v,u as m}from"./@vue.C_fjx3FT1747647381275.js";const d=["scale"],b=["object"],j=["object"],w=n({__name:"reflectorDUDV",props:{reflectivity:{default:.8},showGridHelper:{type:Boolean,default:!0},scale:{default:1},ignoreObjects:{default:[]},size:{default:[10,10]},mapUrl:{default:"./plugins/floor/image/waterdudv.jpg"}},async setup(n,{expose:w}){let h,U;const I=n,g=new a,B=new e(I.size[0]-.5,I.size[1]);B.visible=I.showGridHelper;let E=I.mapUrl;o.__POWERED_BY_QIANKUN__&&(E=o.__INJECTED_PUBLIC_PATH_BY_QIANKUN__+E,console.log("qiankunWindow.__INJECTED_PUBLIC_PATH_BY_QIANKUN__",o.__INJECTED_PUBLIC_PATH_BY_QIANKUN__),console.log("process.env.BASE_URL","./"));const{map:N}=([h,U]=u((()=>r({map:E}))),h=await h,U(),h);N.wrapS=s,N.wrapT=s,N.repeat.set(6,3);const T=new l({map:N,reflectivity:I.reflectivity});T.uniforms.tReflect={value:g.renderTarget.texture},T.uniforms.tReflectBlur=g.renderTargetUniform,T.uniforms.uMatrix=g.textureMatrixUniform;const y=new i(new t(I.size[0],I.size[1]),T);return y.rotation.x=-Math.PI/2,y.add(g),y.onBeforeRender=(e,s,i)=>{y.visible=!1,I.ignoreObjects.forEach((e=>{e.isMesh&&(e.visible=!1),e.value&&e.value.isMesh&&(e.value.visible=!1)})),g.update(e,s,i),I.ignoreObjects.forEach((e=>{e.isMesh&&(e.visible=!0),e.value&&e.value.isMesh&&(e.value.visible=!0)})),y.visible=!0},_((()=>{I.reflectivity&&(T.uniforms.uReflectivity.value=I.reflectivity)})),c((()=>I.showGridHelper),(e=>{B.visible=e})),w({reflector:g}),(e,s)=>(p(),f("TresGroup",{scale:I.scale},[v("primitive",{object:m(y),"position-y":-.01},null,8,b),v("primitive",{object:m(B)},null,8,j)],8,d))}});export{w as _};
