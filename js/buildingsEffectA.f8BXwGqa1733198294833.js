import{P as t}from"./tweakpane.yHWGBmom1733198294833.js";import{b as n,l as o}from"./pagesShow.vue_vue_type_script_setup_true_lang.U2W0FijZ1733198294833.js";import{e}from"./@tresjs.sklxXn0u1733198294833.js";import{z as r}from"./three-custom-shader-material.GYlVajj-1733198294833.js";import{_ as i,a0 as u,C as c,cd as s,m as a,a$ as l}from"./three.8iJMi2lU1733198294833.js";import{d as f,a3 as d,w as p,o as m,D as v,u as g,a6 as h,r as y,f as w,g as C,j as _,m as b}from"./@vue.-THQH3GC1733198294833.js";import"./@vueuse.N_fQXUYA1733198294833.js";const x=M;function I(){const t=["18nSEISc","computeBoundingSphere","while (true) {}","function *\\( *\\)","debu","error","exception","606542dwstKV","city","color","renderOrder","__csm","warn","topColor","setStyle","init","gradient","primitive","toString","console","chain","396663dFVTOd","Color","#ffffff","value","6BJEEYw","trace","uTime","623kQyFnJ","input","table","#e523ff",'{}.constructor("return this")( )',"info","material","2574270SypebM","isArray","#ffff00","return (function() ","opacity","1269424kFgkhh","gger","action","computeBoundingBox","bModel","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","length","call","dispose","508850GSTABk","boundingBox","clone","bulidingsColor","constructor","model","apply","uniforms","uColor","landColor","object","18106788fPSKiz","children","string","side","DoubleSide","114272tWtUag","bind","prototype","36UEknbY","stateObject","uOpacity","#112233","MeshBasicMaterial","33zQOsZY","land"];return(I=function(){return t})()}!function(t,n){const o=M,e=I();for(;;)try{if(686195===-parseInt(o(471))/1+parseInt(o(438))/2+parseInt(o(452))/3*(-parseInt(o(500))/4)+-parseInt(o(466))/5*(parseInt(o(456))/6)+parseInt(o(459))/7*(-parseInt(o(497))/8)+-parseInt(o(507))/9*(-parseInt(o(481))/10)+parseInt(o(505))/11*(parseInt(o(492))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(487)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function M(t,n){const o=I();return(M=function(t,n){return o[t-=438]})(t,n)}!function(){S(this,(function(){const t=M,n=new RegExp(t(510)),o=new RegExp(t(477),"i"),e=O(t(446));n[t(476)](e+t(451))&&o.test(e+t(460))?O():e("0")}))()}();const T=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[M(487)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();T(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(469)+t(463)+");")()}catch(o){n=window}return n}(),o=n[t(450)]=n[t(450)]||{},e=["log",t(443),t(464),t(512),t(513),t(461),t(457)];for(let r=0;r<e[t(478)];r++){const n=T.constructor[t(499)][t(498)](T),i=e[r],u=o[i]||n;n.__proto__=T.bind(T),n[t(449)]=u.toString[t(498)](u),o[i]=n}}))();const j=[x(491)],P=f({__name:x(475),props:{model:{},bulidingsColor:{default:x(462)},landColor:{default:x(503)},topColor:{default:x(468)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,o=t,s=o[n(486)][n(439)];o[n(486)][n(486)][n(493)][0][n(465)]=new(i[n(504)])({color:n(468)}),s[n(441)]=1001;const a=o.model[n(506)];(()=>{const t=n,{geometry:e}=s;e[t(474)](),e[t(508)]();const{max:u,min:a}=e[t(482)];if(s[t(465)][t(442)])return;const l=new r({baseMaterial:s.material,vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:u},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(453)])(o.bulidingsColor)},uOpacity:{value:o[t(470)]},uLightColor:{value:new(i[t(453)])(t(454))},uTopColor:{value:new c(o[t(444)])},uTime:{value:0},uGradient:{value:o[t(447)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(496)]});s[t(465)][t(480)](),s[t(465)]=l})();const{onLoop:l}=e();l((({delta:t})=>{const o=n;s[o(465)][o(488)][o(458)][o(455)]+=t})),d((()=>{const t=n;o[t(484)]&&s[t(465)][t(488)][t(489)][t(455)][t(445)](o[t(484)]),o.landColor&&((t,e)=>{const r=n;let i;"cu"===t||"land"===t&&(i=Array[r(467)](a[r(465)])?a[r(465)]:[a[r(465)]],i.forEach((t=>{const n=r;t[e][n(445)](o[n(490)]),t[n(495)]=u})))})(t(506),t(440)),o[t(470)]&&(s.material[t(488)][t(502)][t(455)]=o[t(470)])})),p(o,((t,o)=>{const e=n;s[e(465)].uniforms.uGradient[e(455)]=t[e(447)]}));const f=o.model[n(486)][n(483)]();return(t,o)=>{const e=n;return m(),v(e(448),{object:g(f)},null,8,j)}}});function O(t){function n(t){const o=M;if(typeof t===o(494))return function(t){}[o(485)](o(509)).apply("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(485)](o(511)+o(472))[o(479)](o(473)):function(){return!1}[o(485)]("debu"+o(472))[o(487)](o(501)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const F=k;!function(t,n){const o=k,e=E();for(;;)try{if(345030===parseInt(o(350))/1+parseInt(o(330))/2+parseInt(o(349))/3+-parseInt(o(351))/4*(parseInt(o(383))/5)+-parseInt(o(347))/6*(parseInt(o(381))/7)+-parseInt(o(354))/8*(-parseInt(o(334))/9)+-parseInt(o(371))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(370)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=k,n=new RegExp(t(367)),o=new RegExp(t(331),"i"),e=Z(t(364));n[t(374)](e+t(329))&&o.test(e+t(372))?Z():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();G(void 0,(function(){const t=k;let n;try{n=Function(t(368)+t(361)+");")()}catch(r){n=window}const o=n.console=n[t(365)]||{},e=["log",t(333),t(353),"error","exception","table","trace"];for(let i=0;i<e.length;i++){const n=G[t(335)][t(358)][t(384)](G),r=e[i],u=o[r]||n;n.__proto__=G[t(384)](G),n.toString=u[t(376)][t(384)](u),o[r]=n}}))();const A=[F(356)];function k(t,n){const o=E();return(k=function(t,n){return o[t-=329]})(t,n)}function E(){const t=["56718xndZvJ","renderOrder","1509885IWejGy","405155AFSPmj","129520CGJNre","string","info","1024qUdOKT","debu","object","uSrcColor","prototype","srcColor","call",'{}.constructor("return this")( )',"uGradual","counter","init","console","applyMatrix4","function *\\( *\\)","return (function() ","gradual","apply","5318460KXiiOw","input","width","test","geometry","toString","uScale","clone","uniforms","#000","105DIIJAf","bLine","50ijTims","bind","while (true) {}","chain","843978DbzvjX","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","builds","warn","846dJohSG","constructor","color","stateObject","scale","primitive","uColor","uTime","speed","value","linewidth","length","action"];return(E=function(){return t})()}const z=f({__name:F(382),props:{builds:{},color:{default:"#FFF"},srcColor:{default:F(380)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=F,o=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new c(o[n(336)])},uSrcColor:{value:new c(o[n(359)])},uScale:{value:o[n(338)]},uTime:{value:0},uGradual:{value:o[n(369)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let u=new s(o[n(332)][n(375)])[n(378)]();u=u[n(366)](o.builds.matrix);const f=new a(i);r=new l(u,f),r.material[n(344)]=o[n(373)],r[n(348)]=1e3,d((()=>{const t=n;o[t(336)]&&(i.uniforms[t(340)].value=new c(o[t(336)])),o[t(359)]&&(i.uniforms[t(357)][t(343)]=new c(o.srcColor)),o[t(338)]&&(i.uniforms[t(377)][t(343)]=o.scale),o[t(369)]&&(i[t(379)][t(362)][t(343)]=o[t(369)])}));const{onLoop:p}=e();return p((({delta:t})=>{const e=n;i[e(379)][e(341)][e(343)]+=t*o[e(342)],i.uniforms[e(341)][e(343)]%=1})),(t,o)=>{const e=n;return m(),v(e(339),{object:g(r)},null,8,A)}}});function Z(t){function n(t){const o=k;if(typeof t===o(352))return function(t){}[o(335)](o(385))[o(370)](o(363));1!==(""+t/t)[o(345)]||t%20==0?function(){return!0}[o(335)](o(355)+"gger")[o(360)](o(346)):function(){return!1}[o(335)](o(355)+"gger")[o(370)](o(337)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const R=J;!function(t,n){const o=J,e=U();for(;;)try{if(911407===parseInt(o(506))/1*(-parseInt(o(542))/2)+parseInt(o(525))/3+-parseInt(o(534))/4*(parseInt(o(538))/5)+-parseInt(o(533))/6+parseInt(o(539))/7+parseInt(o(544))/8*(parseInt(o(504))/9)+parseInt(o(535))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(543)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function J(t,n){const o=U();return(J=function(t,n){return o[t-=498]})(t,n)}!function(){D(this,(function(){const t=J,n=new RegExp(t(545)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=W(t(512));n[t(536)](e+"chain")&&o[t(536)](e+t(513))?W():e("0")}))()}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[J(543)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();K(void 0,(function(){const t=J;let n;try{n=Function(t(509)+t(520)+");")()}catch(r){n=window}const o=n.console=n[t(502)]||{},e=[t(499),"warn",t(528),t(498),t(510),t(537),t(546)];for(let i=0;i<e[t(541)];i++){const n=K[t(508)][t(540)][t(531)](K),r=e[i],u=o[r]||n;n.__proto__=K[t(531)](K),n[t(500)]=u.toString[t(531)](u),o[r]=n}}))();const L=f({__name:R(507),async setup(e){const r=R;let i,u;const c=([i,u]=h((()=>o())),i=await i,u(),i),s=y({color:r(501),srcColor:"#000",scale:2e3,gradual:6.6,speed:.3}),a=new t({title:r(515),expanded:!0});return a[r(518)](s,r(530),{label:r(521)}),a[r(518)](s,r(524),{label:r(505)}),a[r(518)](s,r(511),{label:"速度",min:.1,max:1,step:.1}),a[r(518)](s,r(514),{label:"最大扩散",min:10,max:2e3,step:10}),a.addBinding(s,"gradual",{label:r(532),min:1.1,max:10,step:.1}),(t,o)=>{const e=r;return m(),w(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[_(P,{model:g(c),bulidingsColor:e(522),landColor:e(548),topColor:e(549)},null,8,["model"]),_(z,b({builds:g(c)[e(517)]},s),null,16,[e(516)])])),_:1})}}});function U(){const t=['{}.constructor("return this")( )',"线原颜色","#000000","while (true) {}","color","3951849cFTiGb","gger","action","info","call","srcColor","bind","扩散系数","2014242POtHPU","24QwLIbk","8128140CUoQuK","test","table","493840uPUvlJ","9427754IRGkbS","prototype","length","842834pFvihd","apply","129256uhZUhY","function *\\( *\\)","trace","string","#112233","#999","error","log","toString","#FFF","console","debu","27RKsmfM","线扫颜色","4KdWkfV","buildingsEffectA","constructor","return (function() ","exception","speed","init","input","scale","效果参数","builds","city","addBinding","counter"];return(U=function(){return t})()}function W(t){function n(t){const o=J;if(typeof t===o(547))return function(t){}[o(508)](o(523))[o(543)](o(519));1!==(""+t/t)[o(541)]||t%20==0?function(){return!0}.constructor("debu"+o(526))[o(529)](o(527)):function(){return!1}.constructor(o(503)+o(526))[o(543)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{L as default};
