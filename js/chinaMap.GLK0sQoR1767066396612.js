import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{K as t}from"./@tresjs.B1f7s3pS1767066396612.js";import{l as r}from"./utils.DguR31dd1767066396612.js";import{m as o}from"./d3-geo.C51lZA-81767066396612.js";import{c as a,d as s,a as n}from"./three-mesh-bvh.BBErpT9w1767066396612.js";const{withAsyncContext:i}=await e("vue"),{renderList:l,Fragment:p,openBlock:c,createElementBlock:d,createElementVNode:m}=await e("vue"),u=["properties","renderOrder"],f=["args"],{watchEffect:h,ref:y}=await e("vue"),v=await e("three"),w={__name:"chinaMapMesh",async setup(e){let t,w;v.BufferGeometry.prototype.computeBoundsTree=a,v.BufferGeometry.prototype.disposeBoundsTree=s,v.Mesh.prototype.raycast=n;const b=o().center([104,37.5]).translate([0,0]),g=([t,w]=i(()=>r("./plugins/simpleGIS/json/china.json","features")),t=await t,w(),t),T={depth:10,bevelEnabled:!1},j=[];g.forEach(e=>{e.geometry.coordinates.forEach(t=>{t.forEach(t=>{const r=new v.Shape;for(let e=0;e<t.length;e++){const[o,a]=b(t[e]);0===e&&r.moveTo(o,-a),r.lineTo(o,-a)}j.push({shape:r,properties:e.properties})})})});const B=new v.LineBasicMaterial({color:"#3480C4",linewidth:1,linecap:"round"}),E=y();h(()=>{E.value&&E.value.children.forEach(e=>{e.geometry.computeBoundsTree();const t=[e.material,B];e.material=t})});let x=null;(()=>{const e=document.createElement("div");e.className="tooltip",e.style.border="1px solid white",e.style.position="absolute",e.style.color="white",e.style.padding="0px 6px",e.style.whiteSpace="no-wrap",e.style.visibility="hidden",document.body.appendChild(e),x=e})();const C=e=>{e.object.material[0].color.set(16711680),x.innerText=e.object.properties.name,x.style.visibility="visible"},M=e=>{e.eventObject.material[0].color.set(3010559),x.style.visibility="hidden"},_=e=>{x.style.left=`${e.clientX+6}px`,x.style.top=`${e.clientY+6}px`};return(e,t)=>(c(),d("TresGroup",{ref_key:"tgRef",ref:E},[(c(),d(p,null,l(j,(e,r)=>m("TresMesh",{key:`${r}`,properties:e.properties,renderOrder:r,onPointerenter:C,onPointerleave:M,onPointermove:_},[m("TresExtrudeGeometry",{args:[e.shape,T]},null,8,f),t[0]||(t[0]=m("TresMeshBasicMaterial",{color:"#2defff",transparent:!0,opacity:.6},null,-1))],40,u)),64))],512))}},{defineComponent:b}=await e("vue"),{createElementVNode:g,unref:T,normalizeProps:j,guardReactiveProps:B,createVNode:E,Suspense:x,withCtx:C,openBlock:M,createBlock:_,resolveComponent:k,mergeProps:P}=await e("vue"),G=b({__name:"chinaMap",setup(e){const r={clearColor:"#201919"},o={enableDamping:!0,dampingFactor:.05};return(e,a)=>{const s=k("TresCanvas");return M(),_(s,P(r,{"window-size":""}),{default:C(()=>[a[0]||(a[0]=g("TresPerspectiveCamera",{position:[0,0,166],fov:75,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),E(T(t),j(B(o)),null,16),(M(),_(x,null,{default:C(()=>[E(w)]),_:1}))]),_:1},16)}}});export{G as default};
