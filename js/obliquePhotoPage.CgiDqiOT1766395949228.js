import{F as e,_ as s,K as t}from"./@tresjs.DsQAOGDv1766395949228.js";import{P as i}from"./tweakpane.CqZAnw7f1766395949228.js";import{A as o}from"./3d-tiles-renderer.DhJHIjN91766395949228.js";import{a,b as r,i as l}from"./utils.OBSUWeCS1766395949228.js";import{d as n,a as p,w as u,G as m,o as d,I as j,u as c,r as g,g as f,b as h,e as v,h as b,m as R}from"./@vue.BxPWGdWw1766395949228.js";import{$ as _,a0 as w}from"./three.F31Lz30M1766395949228.js";import"./postprocessing.Rj820gp21766395949228.js";import"./@vueuse.D_OASVSl1766395949228.js";import"./@tweenjs.C9YEcV0Y1766395949228.js";import"./utils.hf8dfR7t1766395949228.js";import"./@fesjs.Bl8X3Cus1766395949228.js";import"./vue-router.DKbpfuaB1766395949228.js";import"./lodash-es.DWe8oqPO1766395949228.js";import"./pinia.00k7dVzH1766395949228.js";import"./@qlin.y-0Z8WnK1766395949228.js";import"./@babel.BPq7uOAK1766395949228.js";import"./@floating-ui.Bhq4ibgf1766395949228.js";import"./@juggle.Vc7cP4_P1766395949228.js";import"./shapeConfigurator.vue_vue_type_style_index_1_scoped_abbf0cc1_lang._TNQgLqd1766395949228.js";import"./object-hash.dpls2F2R1766395949228.js";import"./@amap.fjyZdsU91766395949228.js";import"./jszip.4nkwO7EE1766395949228.js";import"./Resource.DyrQXsrT1766395949228.js";import"./useTexture.CF9cs5am1766395949228.js";import"./three-custom-shader-material.VjTva5tI1766395949228.js";import"./three-mesh-bvh.aOksuETU1766395949228.js";import"./d3-geo.C51lZA-81766395949228.js";const T=["object"],x=n({__name:"obliquePhoto",props:{tilesUrl:{default:"./plugins/geokit/tiles/tileset.json"},isRotation:{type:Boolean,default:!1},isRranslation:{type:Boolean,default:!0}},setup(t,{expose:i}){const l=t,n=p(null),{camera:g,renderer:f,sizes:h}=e(),v=(e,s,t)=>{e.setCamera(s),e.setResolutionFromRenderer(s,t)},b=()=>{let e=new o(l.tilesUrl);return e.fetchOptions.mode="cors",e.addEventListener("load-tile-set",()=>{r(e,l.isRotation,l.isRranslation)}),e.addEventListener("dispose-model",({scene:e})=>{e.traverse(e=>{e.material&&e.material.dispose()})}),v(e,g.value,f),e};let R=b();u(()=>[l.isRotation,l.isRranslation],()=>{R.group&&a(R.group,l.isRotation,l.isRranslation)}),u(g,()=>{g.value&&v(R,g.value,f)},{immediate:!0});const{onBeforeRender:_}=s();return _(()=>{g.value&&h.width.value&&R.update&&(g.value.updateMatrixWorld(),R.update())}),u(()=>l.tilesUrl,e=>{e!==R.rootURL&&(R.dispose(),R=b())}),i({group:n,tilesGroup:R.group}),(e,s)=>(d(),m("TresGroup",{ref_key:"groupRef",ref:n},[j("primitive",{object:c(R).group},null,8,T)],512))}}),y=n({__name:"obliquePhotoPage",setup(e){const s={clearColor:"#201919",windowSize:!0,shadows:!0,toneMapping:w,toneMappingExposure:1,shadowMapType:_},o=g({tilesUrl:"https://opensource.cdn.icegl.cn/3Dtiles/simpleGIS/TilesetWithDiscreteLOD/tileset.json",isRotation:!0,isRranslation:!0}),a=p(o.tilesUrl),r=new i;r.addBinding(a,"value",{label:"tiles地址"});return r.addButton({title:"应用",label:"从url读取tiles"}).on("click",()=>{a.value!==o.tilesUrl&&(r.disabled=!0,l(a.value).then(e=>{e?o.tilesUrl=a.value:alert("这不是一个有效的3D Tiles地址"),r.disabled=!1}))}),r.addBinding(o,"isRotation",{label:"地心旋转"}),r.addBinding(o,"isRranslation",{label:"居中展示"}),(e,i)=>{const a=f("TresCanvas");return d(),h(a,R(s,{"window-size":""}),{default:v(()=>[i[0]||(i[0]=j("TresPerspectiveCamera",{position:[800,800,800],fov:60,near:1,far:2e4},null,-1)),b(c(t)),i[1]||(i[1]=j("TresAmbientLight",{intensity:1},null,-1)),i[2]||(i[2]=j("TresDirectionalLight",{position:[1,2,3],intensity:1.25},null,-1)),i[3]||(i[3]=j("TresAxesHelper",{args:[100]},null,-1)),b(x,R(o,{"rotation-x":o.isRotation?-Math.PI/2:0}),null,16,["rotation-x"])]),_:1},16)}}});export{y as default};
