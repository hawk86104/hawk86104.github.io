import{_ as t,C as n,ce as o,cf as e,cg as r,ch as i,m as u,bU as c,ak as s,am as a}from"./three.ewwqFbMB1726139596986.js";import{c as l,U as f,Y as p}from"./@tresjs.ml1V726H1726139596986.js";import{C as d}from"./three-custom-shader-material.UXiDE7Tt1726139596986.js";import"./object-hash.FoPRLmFN1726139596986.js";import"./@amap.Fadeb9eG1726139596986.js";import"./glsl-tokenizer.AMiuccS21726139596986.js";import{d as h,b as m,a3 as y,w as g,o as w,E as v,u as b,r as _,a4 as I,e as C,f as x,g as M,L as S,j as T,aj as A,ak as j,F as B,J as O,H as D,m as R}from"./@vue.JNsx1iN61726139596986.js";function L(t,n){const o=H();return(L=function(t,n){return o[t-=438]})(t,n)}function H(){const t=["function *\\( *\\)","8506078ZYXEvo","CITY_UNTRIANGULATED","action","console","name","init","log","gger","5392053iaadnF","ROADS","bind","stateObject","71966roVIHp","5594008GHtqii","8wbwAzp","counter","warn","prototype","traverse","debu","__proto__","while (true) {}","12JWclhU","34vWIhPt","12554729QivWGw","table","length","test","47670yohoee","20vDJOxR","trace","174470hZHywL","constructor","string","exception","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","apply","return (function() ","30fTDDMy","info"];return(H=function(){return t})()}!function(t,n){const o=L,e=H();for(;;)try{if(655564===-parseInt(o(465))/1*(-parseInt(o(454))/2)+parseInt(o(470))/3*(parseInt(o(456))/4)+parseInt(o(473))/5*(-parseInt(o(439))/6)+parseInt(o(442))/7+parseInt(o(455))/8+parseInt(o(450))/9*(-parseInt(o(471))/10)+parseInt(o(466))/11*(-parseInt(o(464))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(478)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=L,n=new RegExp(t(441)),o=new RegExp(t(477),"i"),e=z(t(447));n[t(469)](e+"chain")&&o.test(e+"input")?z():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(478)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();G(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(438)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(445)]=n[t(445)]||{},e=[t(448),t(458),t(440),"error",t(476),t(467),t(472)];for(let r=0;r<e[t(468)];r++){const n=G[t(474)][t(459)].bind(G),i=e[r],u=o[i]||n;n[t(462)]=G[t(452)](G),n.toString=u.toString[t(452)](u),o[i]=n}}))();const k=async()=>{const t=L,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(460)]((n=>{const i=t;n[i(446)]===i(443)&&(o=n),"LANDMASS"===n[i(446)]&&(e=n),n[i(446)]===i(451)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function z(t){function n(t){const o=L;if(typeof t===o(475))return function(t){}[o(474)](o(463)).apply(o(457));1!==(""+t/t)[o(468)]||t%20==0?function(){return!0}.constructor(o(461)+o(449)).call(o(444)):function(){return!1}[o(474)](o(461)+o(449))[o(478)](o(453)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function F(){const t=["3356394Xicuoj","bulidingsColor",'{}.constructor("return this")( )',"side","error","string","chain","boundingBox","info","primitive","test","apply","exception","prototype","uniforms","color","__proto__","gger","model","2317mvzaFD","warn","debu","DoubleSide","#ffff00","dispose","function *\\( *\\)","__csm","#112233","gradient","land","100712xNuCIq","1568514lDBElU","bind","call","5IzHooM","material","toString","1TAOcia","computeBoundingBox","5298xLrDsi","console","landColor","log","963gJPiDG","opacity","while (true) {}","66498542jHnvbZ","renderOrder","clone","setStyle","topColor","input","length","uColor","return (function() ","object","6226404QVfYLV","action","constructor","#ffffff","64530ZfSNKa","counter","Color","value"];return(F=function(){return t})()}const Z=U;!function(t,n){const o=U,e=F();for(;;)try{if(952823===parseInt(o(305))/1*(-parseInt(o(299))/2)+-parseInt(o(268))/3+parseInt(o(260))/4*(-parseInt(o(302))/5)+parseInt(o(307))/6*(-parseInt(o(287))/7)+-parseInt(o(298))/8*(parseInt(o(311))/9)+parseInt(o(264))/10+parseInt(o(314))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[U(279)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=U,n=new RegExp(t(293)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=Q("init");n[t(278)](e+t(274))&&o[t(278)](e+t(319))?Q():e("0")}))()}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();P(void 0,(function(){const t=U;let n;try{n=Function(t(322)+t(270)+");")()}catch(r){n=window}const o=n.console=n[t(308)]||{},e=[t(310),t(288),t(276),t(272),t(280),"table","trace"];for(let i=0;i<e[t(320)];i++){const n=P[t(262)][t(281)].bind(P),r=e[i],u=o[r]||n;n[t(284)]=P.bind(P),n[t(304)]=u[t(304)][t(300)](u),o[r]=n}}))();const W=[Z(259)];function U(t,n){const o=F();return(U=function(t,n){return o[t-=259]})(t,n)}const $=h({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:Z(295)},topColor:{default:Z(291)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=Z,r=o,i=m(0),u=r.model.city;u[e(315)]=1001;const c=r.model[e(297)];(()=>{const o=e,{geometry:c}=u;c[o(306)](),c.computeBoundingSphere();const{max:s,min:a}=c[o(275)];if(u.material[o(294)])return;const l=new d({baseMaterial:u[o(303)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(r[o(269)])},uOpacity:{value:r[o(312)]},uLightColor:{value:new(t[o(266)])(o(263))},uTopColor:{value:new(t[o(266)])(r[o(318)])},uTime:i,uGradient:{value:r[o(296)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(290)]});u[o(303)][o(292)](),u.material=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(267)]+=t})),y((()=>{const n=e;r[n(269)]&&u[n(303)][n(282)][n(321)].value[n(317)](r[n(269)]),r[n(309)]&&((n,o)=>{const i=e;let u;"cu"===n||"land"===n&&(u=Array.isArray(c[i(303)])?c[i(303)]:[c[i(303)]],u.forEach((n=>{const e=i;n[o].setStyle(r[e(309)]),n[e(271)]=t[e(290)]})))})(n(297),n(283)),r[n(312)]&&(u[n(303)][n(282)].uOpacity.value=r[n(312)])})),g(r,((t,n)=>{const o=e;u.material[o(282)].uGradient[o(267)]=t[o(296)]}));const a=r[e(286)].model[e(316)]();return(t,n)=>{const o=e;return w(),v(o(277),{object:b(a)},null,8,W)}}});function Q(t){function n(t){const o=U;if(typeof t===o(273))return function(t){}.constructor(o(313))[o(279)](o(265));1!==(""+t/t)[o(320)]||t%20==0?function(){return!0}.constructor(o(289)+"gger")[o(301)](o(261)):function(){return!1}[o(262)]("debu"+o(285))[o(279)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const Y=V;function V(t,n){const o=X();return(V=function(t,n){return o[t-=101]})(t,n)}function X(){const t=["geometry","__proto__","Wireframe","debu","opacity","renderOrder","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bind","error","applyMatrix4","input","set","linewidth","24fpZdJa","builds","table","width"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","innerHeight","261BdKgiy","while (true) {}","3vDeXcy","prototype","init","matrix","primitive","29265CuHQgj","uOpacity","call","stateObject","counter","24990069FbkDzD","constructor","3580064OSUQOi","log","style","32368AnxboL","apply","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","color","654VcoXPG","test","function *\\( *\\)","string","clone","buildingsLines","fromEdgesGeometry","Shader","value","1677714TnyJat","info","uniforms","uColor","100910JbBBpb","innerWidth","length","15187722tsVGqJ","material","1505SGGLDR","object","console","1aIqAWM","toString"];return(X=function(){return t})()}!function(t,n){const o=V,e=X();for(;;)try{if(719577===-parseInt(o(107))/1*(parseInt(o(158))/2)+-parseInt(o(130))/3*(-parseInt(o(142))/4)+parseInt(o(135))/5*(-parseInt(o(149))/6)+parseInt(o(104))/7*(-parseInt(o(145))/8)+-parseInt(o(128))/9*(parseInt(o(162))/10)+-parseInt(o(102))/11+-parseInt(o(122))/12*(-parseInt(o(140))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const N=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(146)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){N(this,(function(){const t=V,n=new RegExp(t(151)),o=new RegExp(t(115),"i"),e=nt(t(132));n[t(150)](e+"chain")&&o.test(e+t(119))?nt():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();q(void 0,(function(){const t=V,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n.console=n[t(106)]||{},e=[t(143),"warn",t(159),t(117),"exception",t(124),"trace"];for(let r=0;r<e[t(101)];r++){const n=q[t(141)][t(131)][t(116)](q),i=e[r],u=o[i]||n;n[t(110)]=q[t(116)](q),n[t(108)]=u.toString[t(116)](u),o[i]=n}}))();const K=[Y(105)],tt=h({__name:Y(154),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:Y(111)}},setup(t){const c=Y,s=t;let a=null,l=null;if(s[c(144)]===c(111)){const t=new o(s[c(123)][c(109)]);let n=(new e)[c(155)](t),u=new r({color:s[c(148)],linewidth:s.width,opacity:s[c(113)],transparent:!0,depthWrite:!0,depthTest:!0});u.resolution[c(120)](window[c(163)],window[c(127)]),a=new i(n,u),a[c(118)](s[c(123)][c(133)][c(153)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(148)])},uOpacity:{value:s.opacity}},vertexShader:c(147),fragmentShader:c(126)};const t=new o(s[c(123)][c(109)]),e=new u(l);a=new LineSegments(t,e),a[c(118)](s.builds[c(133)][c(153)]()),a[c(103)][c(121)]=s[c(125)],a[c(114)]=1e3}return y((()=>{const t=c;s[t(144)]===t(156)&&(s.color&&(l[t(160)][t(161)].value=new n(s.color)),s[t(113)]&&(l[t(160)][t(136)][t(157)]=s.opacity)),s[t(144)]===t(111)&&(s[t(148)]&&(a[t(103)][t(148)]=new n(s[t(148)])),s[t(113)]&&(a.material[t(113)]=s[t(113)])),s[t(125)]&&(a[t(103)][t(121)]=s.width)})),(t,n)=>{const o=c;return w(),v(o(134),{object:b(a)},null,8,K)}}});function nt(t){function n(t){const o=V;if(typeof t===o(152))return function(t){}[o(141)](o(129))[o(146)](o(139));1!==(""+t/t)[o(101)]||t%20==0?function(){return!0}.constructor(o(112)+"gger")[o(137)]("action"):function(){return!1}[o(141)]("debugger")[o(146)](o(138)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=ft;!function(t,n){const o=ft,e=it();for(;;)try{if(547874===-parseInt(o(251))/1*(parseInt(o(218))/2)+parseInt(o(230))/3+parseInt(o(244))/4*(parseInt(o(247))/5)+-parseInt(o(259))/6+-parseInt(o(253))/7+-parseInt(o(232))/8*(parseInt(o(223))/9)+parseInt(o(261))/10*(parseInt(o(249))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(258)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=ft,n=new RegExp(t(237)),o=new RegExp(t(260),"i"),e=pt(t(233));n[t(245)](e+"chain")&&o[t(245)](e+t(263))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[ft(258)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(){const t=["75UvvdFu","trace","546568BQTmiH","#000","66601kvnttQ","TresPerspectiveCamera","6802047uuZrYe","pagesShow","info","gger","length","apply","5216376QQJfXa","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","400ABCLUS","city","input","#ffffff","TresAmbientLight","bind","26mnnJul","return (function() ","autoRotate","__proto__","action","2215827YfhmDt","perspectiveCameraRef","warn","call","showAxesHelper","stateObject","prototype","2443416BUAkEh","ability","8JEarJv","init","builds","TresGridHelper",'{}.constructor("return this")( )',"function *\\( *\\)","error","counter","tcRef","debu","constructor","$slots","186404yabYaJ","test","toString"];return(it=function(){return t})()}rt(void 0,(function(){const t=ft,n=function(){const t=ft;let n;try{n=Function(t(219)+t(236)+");")()}catch(o){n=window}return n}(),o=n.console=n.console||{},e=["log",t(225),t(255),t(238),"exception","table",t(248)];for(let r=0;r<e[t(257)];r++){const n=rt[t(242)][t(229)][t(217)](rt),i=e[r],u=o[i]||n;n[t(221)]=rt[t(217)](rt),n.toString=u[t(246)][t(217)](u),o[i]=n}}))();const ut=S(ot(216),{color:ot(264)},null,-1),ct=S("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:ot(264)},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]},lt=h({__name:ot(254),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r.disableRender}),u=_({autoRotate:r[n(220)],enableDamping:!0});let l=null;r.showBuildings&&([o,e]=I((()=>k())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,R({ref_key:e(240),ref:d},i,{"window-size":""}),{default:M((()=>[S(e(252),{ref_key:e(224),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),T(b(p),A(j(u)),null,16),ut,ct,r.showBuildings&&b(l)?(w(),v(B,{key:0},[T($,{model:b(l)},null,8,["model"]),T(tt,{builds:b(l)[e(262)],color:e(250)},null,8,[e(234)])],64)):O("",!0),D(t[e(243)],e(231)),r[e(227)]?(w(),v("TresAxesHelper",st)):O("",!0),r.showGridHelper?(w(),v(e(235),at)):O("",!0)])),_:3},16)}}});function ft(t,n){const o=it();return(ft=function(t,n){return o[t-=216]})(t,n)}function pt(t){function n(t){const o=ft;if("string"==typeof t)return function(t){}.constructor("while (true) {}")[o(258)](o(239));1!==(""+t/t)[o(257)]||t%20==0?function(){return!0}.constructor("debu"+o(256))[o(226)](o(222)):function(){return!1}[o(242)](o(241)+o(256))[o(258)](o(228)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as _,tt as a,lt as b,k as l};
