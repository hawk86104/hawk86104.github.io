import{u as a}from"./volume.DscKWXHz1763540743861.js";import{r as e,a as l}from"./rawData.lQ4T1IdU1763540743861.js";import{P as s}from"./tweakpane.CqZAnw7f1763540743861.js";import{u as n}from"./colorList.DbCLsRg71763540743861.js";import{d as t,a as r,c as i,w as o,H as u,o as m,J as d,ac as v,ao as p}from"./@vue.Co_gxueH1763540743861.js";import{aE as c,aG as g,r as f,bK as h,au as x,af as b,U as T,aJ as y,a2 as B,a4 as w}from"./three.rXKzP9fQ1763540743861.js";const L=["scale"],j=["visible"],S=["args"],k=t({__name:"scene",setup(t){const k=n(),A=a(),F=A.volumeObj,U=r(1),G=r(F.yLength/F.xLength),z=r(F.zLength/F.xLength),M=i(()=>!(U.value<=.01&&U.value>=-.01)&&(!(G.value<=.01&&G.value>=-.01)&&!(z.value<=.01&&z.value>=-.01))),R=new c(F.data,F.xLength,F.yLength,F.zLength);R.format=g,R.type=(a=>{const e=a.data;let l;return e instanceof Uint8Array?l=T:e instanceof Uint16Array?l=y:e instanceof Uint32Array?l=B:e instanceof Float32Array?l=w:(console.warn("未知的数据类型"),l=T),l})(F),R.minFilter=f,R.magFilter=f,R.wrapS=h,R.wrapT=h,R.wrapR=h,R.needsUpdate=!0;const _={uniforms:{dataTexture:{value:R},colorTexture:{value:k.updateTransferFunction()},samplingRate:{value:1},threshold:{value:.5},alphaScale:{value:1},invertColor:{value:!0},composeType:{value:3}},vertexShader:l,fragmentShader:e,side:x,transparent:!0},C=r(!0),E=new s;return E.addBinding(U,"value",{label:"x轴缩放",min:-2,max:2,step:.01}),E.addBinding(G,"value",{label:"y轴缩放",min:-2,max:2,step:.01}),E.addBinding(z,"value",{label:"z轴缩放",min:-2,max:2,step:.01}),E.addBlade({view:"list",label:"模式",options:[{text:"maximumIntensity",value:1},{text:"thresholding",value:2},{text:"emissionAbsorption",value:3}],value:_.uniforms.composeType.value}).on("change",a=>{_.uniforms.composeType.value=a.value}),E.addBinding(_.uniforms.samplingRate,"value",{label:"体积采样率",min:0,max:4,step:.01}),E.addBinding(_.uniforms.threshold,"value",{label:"体绘制的阈值",min:0,max:1,step:.01}),E.addBinding(_.uniforms.alphaScale,"value",{label:"透明度",min:0,max:1,step:.01}),E.addBinding(_.uniforms.invertColor,"value",{label:"是否反色"}),E.addBinding(C,"value",{label:"显示边框"}),E.addButton({title:"清空体数据",label:"点击"}).on("click",()=>{A.volumeObj=null,E.dispose()}),o(()=>k.colorsStops,()=>{_.uniforms.colorTexture.value=k.updateTransferFunction()},{deep:!0,immediate:!0}),(a,e)=>(m(),u("TresGroup",{scale:[U.value,G.value,z.value]},[d("TresMesh",null,[d("TresBoxGeometry",{args:[1,1,1],visible:M.value},null,8,j),d("TresShaderMaterial",v(p(_)),null,16)]),d("TresLineSegments",null,[d("TresEdgesGeometry",{args:[new b(1,1,1)]},null,8,S),e[0]||(e[0]=d("TresLineBasicMaterial",{color:10066329},null,-1))])],8,L))}});export{k as _};
