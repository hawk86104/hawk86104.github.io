import{importShared as e,GLTFLoader as t}from"./3d-tiles-renderer.COLnOnaF1767661981680.js";import{DRACOLoader as r}from"./DRACOLoader.C-iiY89W1767661981680.js";import{HDRLoader as n}from"./HDRLoader.BwU9nHT81767661981680.js";const{Vector3:o,Vector4:a}=await e("three");function s(e,t,r){const n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;let o=e,a=n,s=Math.floor((o+a)/2);for(;t<r[s]||t>=r[s+1];)t<r[s]?a=s:o=s,s=Math.floor((o+a)/2);return s}function i(e,t){let r=1;for(let o=2;o<=e;++o)r*=o;let n=1;for(let o=2;o<=t;++o)n*=o;for(let o=2;o<=e-t;++o)n*=o;return r/n}function l(e,t,r,n,l){const c=function(e,t,r,n,o){const i=o<e?o:e,l=[],c=s(e,n,t),u=function(e,t,r,n,o){const a=[];for(let p=0;p<=r;++p)a[p]=0;const s=[];for(let p=0;p<=n;++p)s[p]=a.slice(0);const i=[];for(let p=0;p<=r;++p)i[p]=a.slice(0);i[0][0]=1;const l=a.slice(0),c=a.slice(0);for(let p=1;p<=r;++p){l[p]=t-o[e+1-p],c[p]=o[e+p]-t;let r=0;for(let e=0;e<p;++e){const t=c[e+1],n=l[p-e];i[p][e]=t+n;const o=i[e][p-1]/i[p][e];i[e][p]=r+t*o,r=n*o}i[p][p]=r}for(let p=0;p<=r;++p)s[0][p]=i[p][r];for(let p=0;p<=r;++p){let e=0,t=1;const o=[];for(let n=0;n<=r;++n)o[n]=a.slice(0);o[0][0]=1;for(let a=1;a<=n;++a){let n=0;const l=p-a,c=r-a;p>=a&&(o[t][0]=o[e][0]/i[c+1][l],n=o[t][0]*i[l][c]);const u=p-1<=c?a-1:r-p;for(let r=l>=-1?1:-l;r<=u;++r)o[t][r]=(o[e][r]-o[e][r-1])/i[c+1][l+r],n+=o[t][r]*i[l+r][c];p<=c&&(o[t][a]=-o[e][a-1]/i[c+1][p],n+=o[t][a]*i[p][c]),s[a][p]=n;const h=e;e=t,t=h}}let u=r;for(let p=1;p<=n;++p){for(let e=0;e<=r;++e)s[p][e]*=u;u*=r-p}return s}(c,n,e,i,t),p=[];for(let a=0;a<r.length;++a){const e=r[a].clone(),t=e.w;e.x*=t,e.y*=t,e.z*=t,p[a]=e}for(let a=0;a<=i;++a){const t=p[c-e].clone().multiplyScalar(u[a][0]);for(let r=1;r<=e;++r)t.add(p[c-e+r].clone().multiplyScalar(u[a][r]));l[a]=t}for(let s=i+1;s<=o+1;++s)l[s]=new a(0,0,0);return l}(e,t,r,n,l);return function(e){const t=e.length,r=[],n=[];for(let s=0;s<t;++s){const t=e[s];r[s]=new o(t.x,t.y,t.z),n[s]=t.w}const a=[];for(let o=0;o<t;++o){const e=r[o].clone();for(let t=1;t<=o;++t)e.sub(a[o-t].clone().multiplyScalar(i(o,t)*n[t]));a[o]=e.divideScalar(n[0])}return a}(c)}const{Curve:c,Vector3:u,Vector4:p}=await e("three");class h extends c{constructor(e,t,r,n,o){super();const a=t?t.length-1:0,s=r?r.length:0;this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=o||a;for(let i=0;i<s;++i){const e=r[i];this.controlPoints[i]=new p(e.x,e.y,e.z,e.w)}}getPoint(e,t=new u){const r=t,n=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=function(e,t,r,n){const o=s(e,n,t),i=function(e,t,r,n){const o=[],a=[],s=[];o[0]=1;for(let i=1;i<=r;++i){a[i]=t-n[e+1-i],s[i]=n[e+i]-t;let r=0;for(let e=0;e<i;++e){const t=s[e+1],n=a[i-e],l=o[e]/(t+n);o[e]=r+t*l,r=n*l}o[i]=r}return o}(o,n,e,t),l=new a(0,0,0,0);for(let a=0;a<=e;++a){const t=r[o-e+a],n=i[a],s=t.w*n;l.x+=t.x*s,l.y+=t.y*s,l.z+=t.z*s,l.w+=t.w*n}return l}(this.degree,this.knots,this.controlPoints,n);return 1!==o.w&&o.divideScalar(o.w),r.set(o.x,o.y,o.z)}getTangent(e,t=new u){const r=t,n=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=l(this.degree,this.knots,this.controlPoints,n,1);return r.copy(o[1]).normalize(),r}toJSON(){const e=super.toJSON();return e.degree=this.degree,e.knots=[...this.knots],e.controlPoints=this.controlPoints.map(e=>e.toArray()),e.startKnot=this.startKnot,e.endKnot=this.endKnot,e}fromJSON(e){return super.fromJSON(e),this.degree=e.degree,this.knots=[...e.knots],this.controlPoints=e.controlPoints.map(e=>new p(e[0],e[1],e[2],e[3])),this.startKnot=e.startKnot,this.endKnot=e.endKnot,this}}
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var d=Uint8Array,f=Uint16Array,m=Int32Array,g=new d([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),v=new d([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),y=new d([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),w=function(e,t){for(var r=new f(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var o=new m(r[30]);for(n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)o[a]=a-r[n]<<5|n;return{b:r,r:o}},I=w(g,2),x=I.b,b=I.r;x[28]=258,b[258]=28;for(var T=w(v,0).b,A=new f(32768),E=0;E<32768;++E){var L=(43690&E)>>1|(21845&E)<<1;L=(61680&(L=(52428&L)>>2|(13107&L)<<2))>>4|(3855&L)<<4,A[E]=((65280&L)>>8|(255&L)<<8)>>1}var D=function(e,t,r){for(var n=e.length,o=0,a=new f(t);o<n;++o)e[o]&&++a[e[o]-1];var s,i=new f(t);for(o=1;o<t;++o)i[o]=i[o-1]+a[o-1]<<1;if(r){s=new f(1<<t);var l=15-t;for(o=0;o<n;++o)if(e[o])for(var c=o<<4|e[o],u=t-e[o],p=i[e[o]-1]++<<u,h=p|(1<<u)-1;p<=h;++p)s[A[p]>>l]=c}else for(s=new f(n),o=0;o<n;++o)e[o]&&(s[o]=A[i[e[o]-1]++]>>15-e[o]);return s},N=new d(288);for(E=0;E<144;++E)N[E]=8;for(E=144;E<256;++E)N[E]=9;for(E=256;E<280;++E)N[E]=7;for(E=280;E<288;++E)N[E]=8;var k=new d(32);for(E=0;E<32;++E)k[E]=5;var F=D(N,9,1),P=D(k,5,1),S=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},R=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},M=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},C=function(e){return(e+7)/8|0},O=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],B=function(e,t,r){var n=new Error(t||O[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,B),!r)throw n;return n},U=function(e,t,r,n){var o=e.length;if(!o||t.f&&!t.l)return r||new d(0);var a=!r,s=a||2!=t.i,i=t.i;a&&(r=new d(3*o));var l=function(e){var t=r.length;if(e>t){var n=new d(Math.max(2*t,e));n.set(r),r=n}},c=t.f||0,u=t.p||0,p=t.b||0,h=t.l,f=t.d,m=t.m,w=t.n,I=8*o;do{if(!h){c=R(e,u,1);var b=R(e,u+1,3);if(u+=3,!b){var A=e[(W=C(u)+4)-4]|e[W-3]<<8,E=W+A;if(E>o){i&&B(0);break}s&&l(p+A),r.set(e.subarray(W,E),p),t.b=p+=A,t.p=u=8*E,t.f=c;continue}if(1==b)h=F,f=P,m=9,w=5;else if(2==b){var L=R(e,u,31)+257,N=R(e,u+10,15)+4,k=L+R(e,u+5,31)+1;u+=14;for(var O=new d(k),U=new d(19),V=0;V<N;++V)U[y[V]]=R(e,u+3*V,7);u+=3*N;var j=S(U),z=(1<<j)-1,G=D(U,j,1);for(V=0;V<k;){var W,X=G[R(e,u,z)];if(u+=15&X,(W=X>>4)<16)O[V++]=W;else{var H=0,_=0;for(16==W?(_=3+R(e,u,3),u+=2,H=O[V-1]):17==W?(_=3+R(e,u,7),u+=3):18==W&&(_=11+R(e,u,127),u+=7);_--;)O[V++]=H}}var K=O.subarray(0,L),$=O.subarray(L);m=S(K),w=S($),h=D(K,m,1),f=D($,w,1)}else B(1);if(u>I){i&&B(0);break}}s&&l(p+131072);for(var q=(1<<m)-1,Y=(1<<w)-1,Z=u;;Z=u){var J=(H=h[M(e,u)&q])>>4;if((u+=15&H)>I){i&&B(0);break}if(H||B(2),J<256)r[p++]=J;else{if(256==J){Z=u,h=null;break}var Q=J-254;if(J>264){var ee=g[V=J-257];Q=R(e,u,(1<<ee)-1)+x[V],u+=ee}var te=f[M(e,u)&Y],re=te>>4;te||B(3),u+=15&te;$=T[re];if(re>3){ee=v[re];$+=M(e,u)&(1<<ee)-1,u+=ee}if(u>I){i&&B(0);break}s&&l(p+131072);var ne=p+Q;if(p<$){var oe=0-$,ae=Math.min($,ne);for(oe+p<0&&B(3);p<ae;++p)r[p]=n[oe+p]}for(;p<ne;++p)r[p]=r[p-$]}}t.l=h,t.p=Z,t.b=p,t.f=c,h&&(c=1,t.m=m,t.d=f,t.n=w)}while(!c);return p!=r.length&&a?function(e,t,r){return(null==r||r>e.length)&&(r=e.length),new d(e.subarray(t,r))}(r,0,p):r.subarray(0,p)},V=new d(0);function j(e,t){return U(e.subarray(((8!=(15&(r=e)[0])||r[0]>>4>7||(r[0]<<8|r[1])%31)&&B(6,"invalid zlib data"),1==(r[1]>>5&1)&&B(6,"invalid zlib data: "+(32&r[1]?"need":"unexpected")+" dictionary"),2+(r[1]>>3&4)),-4),{i:2},t,t);var r}var z="undefined"!=typeof TextDecoder&&new TextDecoder;try{z.decode(V,{stream:!0})}catch(pt){}const{AmbientLight:G,AnimationClip:W,Bone:X,BufferGeometry:H,ClampToEdgeWrapping:_,Color:K,ColorManagement:$,DirectionalLight:q,EquirectangularReflectionMapping:Y,Euler:Z,FileLoader:J,Float32BufferAttribute:Q,Group:ee,Line:te,LineBasicMaterial:re,Loader:ne,LoaderUtils:oe,MathUtils:ae,Matrix3:se,Matrix4:ie,Mesh:le,MeshLambertMaterial:ce,MeshPhongMaterial:ue,NumberKeyframeTrack:pe,Object3D:he,PerspectiveCamera:de,PointLight:fe,PropertyBinding:me,Quaternion:ge,QuaternionKeyframeTrack:ve,RepeatWrapping:ye,SRGBColorSpace:we,ShapeUtils:Ie,Skeleton:xe,SkinnedMesh:be,SpotLight:Te,Texture:Ae,TextureLoader:Ee,Uint16BufferAttribute:Le,Vector2:De,Vector3:Ne,Vector4:ke,VectorKeyframeTrack:Fe}=await e("three");let Pe,Se,Re;class Me{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Se=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),r=this.parseMaterials(t),n=this.parseDeformers(),o=(new Ce).parse(n);return this.parseScene(n,o,r),Re}parseConnections(){const e=new Map;if("Connections"in Pe){Pe.Connections.connections.forEach(function(t){const r=t[0],n=t[1],o=t[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:n,relationship:o};e.get(r).parents.push(a),e.has(n)||e.set(n,{parents:[],children:[]});const s={ID:r,relationship:o};e.get(n).children.push(s)})}return e}parseImages(){const e={},t={};if("Video"in Pe.Objects){const r=Pe.Objects.Video;for(const n in r){const o=r[n];if(e[parseInt(n)]=o.RelativeFilename||o.Filename,"Content"in o){const e=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,a="string"==typeof o.Content&&""!==o.Content;if(e||a){const e=this.parseImage(r[n]);t[o.RelativeFilename||o.Filename]=e}}}}for(const r in e){const n=e[r];void 0!==t[n]?e[r]=t[n]:e[r]=e[r].split("\\").pop()}return e}parseImage(e){const t=e.Content,r=e.RelativeFilename||e.Filename,n=r.slice(r.lastIndexOf(".")+1).toLowerCase();let o;switch(n){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",r),o="image/tga";break;case"webp":o="image/webp";break;default:return void console.warn('FBXLoader: Image type "'+n+'" is not supported.')}if("string"==typeof t)return"data:"+o+";base64,"+t;{const e=new Uint8Array(t);return window.URL.createObjectURL(new Blob([e],{type:o}))}}parseTextures(e){const t=new Map;if("Texture"in Pe.Objects){const r=Pe.Objects.Texture;for(const n in r){const o=this.parseTexture(r[n],e);t.set(parseInt(n),o)}}return t}parseTexture(e,t){const r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;const n=e.WrapModeU,o=e.WrapModeV,a=void 0!==n?n.value:0,s=void 0!==o?o.value:0;if(r.wrapS=0===a?ye:_,r.wrapT=0===s?ye:_,"Scaling"in e){const t=e.Scaling.value;r.repeat.x=t[0],r.repeat.y=t[1]}if("Translation"in e){const t=e.Translation.value;r.offset.x=t[0],r.offset.y=t[1]}return r}loadTexture(e,t){const r=e.FileName.split(".").pop().toLowerCase();let n=this.manager.getHandler(`.${r}`);null===n&&(n=this.textureLoader);const o=n.path;o||n.setPath(this.textureLoader.path);const a=Se.get(e.id).children;let s;if(void 0!==a&&a.length>0&&void 0!==t[a[0].ID]&&(s=t[a[0].ID],0!==s.indexOf("blob:")&&0!==s.indexOf("data:")||n.setPath(void 0)),void 0===s)return console.warn("FBXLoader: Undefined filename, creating placeholder texture."),new Ae;const i=n.load(s);return n.setPath(o),i}parseMaterials(e){const t=new Map;if("Material"in Pe.Objects){const r=Pe.Objects.Material;for(const n in r){const o=this.parseMaterial(r[n],e);null!==o&&t.set(parseInt(n),o)}}return t}parseMaterial(e,t){const r=e.id,n=e.attrName;let o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!Se.has(r))return null;const a=this.parseParameters(e,t,r);let s;switch(o.toLowerCase()){case"phong":s=new ue;break;case"lambert":s=new ce;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),s=new ue}return s.setValues(a),s.name=n,s}parseParameters(e,t,r){const n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=$.colorSpaceToWorking((new K).fromArray(e.Diffuse.value),we):!e.DiffuseColor||"Color"!==e.DiffuseColor.type&&"ColorRGB"!==e.DiffuseColor.type||(n.color=$.colorSpaceToWorking((new K).fromArray(e.DiffuseColor.value),we)),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=$.colorSpaceToWorking((new K).fromArray(e.Emissive.value),we):!e.EmissiveColor||"Color"!==e.EmissiveColor.type&&"ColorRGB"!==e.EmissiveColor.type||(n.emissive=$.colorSpaceToWorking((new K).fromArray(e.EmissiveColor.value),we)),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),n.opacity=1-(e.TransparencyFactor?parseFloat(e.TransparencyFactor.value):0),1!==n.opacity&&0!==n.opacity||(n.opacity=e.Opacity?parseFloat(e.Opacity.value):null,null===n.opacity&&(n.opacity=1-(e.TransparentColor?parseFloat(e.TransparentColor.value[0]):0))),n.opacity<1&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=$.colorSpaceToWorking((new K).fromArray(e.Specular.value),we):e.SpecularColor&&"Color"===e.SpecularColor.type&&(n.specular=$.colorSpaceToWorking((new K).fromArray(e.SpecularColor.value),we));const o=this;return Se.get(r).children.forEach(function(e){const r=e.relationship;switch(r){case"Bump":n.bumpMap=o.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":n.aoMap=o.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=o.getTexture(t,e.ID),void 0!==n.map&&(n.map.colorSpace=we);break;case"DisplacementColor":n.displacementMap=o.getTexture(t,e.ID);break;case"EmissiveColor":n.emissiveMap=o.getTexture(t,e.ID),void 0!==n.emissiveMap&&(n.emissiveMap.colorSpace=we);break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=o.getTexture(t,e.ID);break;case"ReflectionColor":n.envMap=o.getTexture(t,e.ID),void 0!==n.envMap&&(n.envMap.mapping=Y,n.envMap.colorSpace=we);break;case"SpecularColor":n.specularMap=o.getTexture(t,e.ID),void 0!==n.specularMap&&(n.specularMap.colorSpace=we);break;case"TransparentColor":case"TransparencyFactor":n.alphaMap=o.getTexture(t,e.ID),n.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",r)}}),n}getTexture(e,t){return"LayeredTexture"in Pe.Objects&&t in Pe.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Se.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Pe.Objects){const r=Pe.Objects.Deformer;for(const n in r){const o=r[n],a=Se.get(parseInt(n));if("Skin"===o.attrType){const t=this.parseSkeleton(a,r);t.ID=n,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),t.geometryID=a.parents[0].ID,e[n]=t}else if("BlendShape"===o.attrType){const e={id:n};e.rawTargets=this.parseMorphTargets(a,r),e.id=n,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[n]=e}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const r=[];return e.children.forEach(function(e){const n=t[e.ID];if("Cluster"!==n.attrType)return;const o={ID:e.ID,indices:[],weights:[],transformLink:(new ie).fromArray(n.TransformLink.a)};"Indexes"in n&&(o.indices=n.Indexes.a,o.weights=n.Weights.a),r.push(o)}),{rawBones:r,bones:[]}}parseMorphTargets(e,t){const r=[];for(let n=0;n<e.children.length;n++){const o=e.children[n],a=t[o.ID],s={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;s.geoID=Se.get(parseInt(o.ID)).children.filter(function(e){return void 0===e.relationship})[0].ID,r.push(s)}return r}parseScene(e,t,r){Re=new ee;const n=this.parseModels(e.skeletons,t,r),o=Pe.Objects.Model,a=this;n.forEach(function(e){const t=o[e.ID];a.setLookAtProperties(e,t);Se.get(e.ID).parents.forEach(function(t){const r=n.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&Re.add(e)}),this.bindSkeleton(e.skeletons,t,n),this.addGlobalSceneSettings(),Re.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);const t=Ke(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}});const s=(new Oe).parse();1===Re.children.length&&Re.children[0].isGroup&&(Re.children[0].animations=s,Re=Re.children[0]),Re.animations=s}parseModels(e,t,r){const n=new Map,o=Pe.Objects.Model;for(const a in o){const s=parseInt(a),i=o[a],l=Se.get(s);let c=this.buildSkeleton(l,e,s,i.attrName);if(!c){switch(i.attrType){case"Camera":c=this.createCamera(l);break;case"Light":c=this.createLight(l);break;case"Mesh":c=this.createMesh(l,t,r);break;case"NurbsCurve":c=this.createCurve(l,t);break;case"LimbNode":case"Root":c=new X;break;default:c=new ee}c.name=i.attrName?me.sanitizeNodeName(i.attrName):"",c.userData.originalName=i.attrName,c.ID=s}this.getTransformData(c,i),n.set(s,c)}return n}buildSkeleton(e,t,r,n){let o=null;return e.parents.forEach(function(e){for(const a in t){const s=t[a];s.rawBones.forEach(function(t,a){if(t.ID===e.ID){const e=o;o=new X,o.matrixWorld.copy(t.transformLink),o.name=n?me.sanitizeNodeName(n):"",o.userData.originalName=n,o.ID=r,s.bones[a]=o,null!==e&&o.add(e)}})}}),o}createCamera(e){let t,r;if(e.children.forEach(function(e){const t=Pe.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new he;else{let e=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(e=1);let n=1;void 0!==r.NearPlane&&(n=r.NearPlane.value/1e3);let o=1e3;void 0!==r.FarPlane&&(o=r.FarPlane.value/1e3);let a=window.innerWidth,s=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(a=r.AspectWidth.value,s=r.AspectHeight.value);const i=a/s;let l=45;void 0!==r.FieldOfView&&(l=r.FieldOfView.value);const c=r.FocalLength?r.FocalLength.value:null;switch(e){case 0:t=new de(l,i,n,o),null!==c&&t.setFocalLength(c);break;case 1:console.warn("THREE.FBXLoader: Orthographic cameras not supported yet."),t=new he;break;default:console.warn("THREE.FBXLoader: Unknown camera type "+e+"."),t=new he}}return t}createLight(e){let t,r;if(e.children.forEach(function(e){const t=Pe.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new he;else{let e;e=void 0===r.LightType?0:r.LightType.value;let n=16777215;void 0!==r.Color&&(n=$.colorSpaceToWorking((new K).fromArray(r.Color.value),we));let o=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(o=0);let a=0;void 0!==r.FarAttenuationEnd&&(a=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value);const s=1;switch(e){case 0:t=new fe(n,o,a,s);break;case 1:t=new q(n,o);break;case 2:let e=Math.PI/3;void 0!==r.InnerAngle&&(e=ae.degToRad(r.InnerAngle.value));let i=0;void 0!==r.OuterAngle&&(i=ae.degToRad(r.OuterAngle.value),i=Math.max(i,1)),t=new Te(n,o,a,e,i,s);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),t=new fe(n,o)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,r){let n,o=null,a=null;const s=[];if(e.children.forEach(function(e){t.has(e.ID)&&(o=t.get(e.ID)),r.has(e.ID)&&s.push(r.get(e.ID))}),s.length>1?a=s:s.length>0?a=s[0]:(a=new ue({name:ne.DEFAULT_MATERIAL_NAME,color:13421772}),s.push(a)),"color"in o.attributes&&s.forEach(function(e){e.vertexColors=!0}),o.groups.length>0){let e=!1;for(let t=0,r=o.groups.length;t<r;t++){const r=o.groups[t];(r.materialIndex<0||r.materialIndex>=s.length)&&(r.materialIndex=s.length,e=!0)}if(e){const e=new ue;s.push(e)}}return o.FBX_Deformer?(n=new be(o,a),n.normalizeSkinWeights()):n=new le(o,a),n}createCurve(e,t){const r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),n=new re({name:ne.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new te(r,n)}getTransformData(e,t){const r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder=$e("RotationOrder"in t?t.RotationOrder.value:0),"Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r}setLookAtProperties(e,t){if("LookAtProperty"in t){Se.get(e.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){const r=Pe.Objects.Model[t.ID];if("Lcl_Translation"in r){const t=r.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(t),Re.add(e.target)):e.lookAt((new Ne).fromArray(t))}}})}}bindSkeleton(e,t,r){const n=this.parsePoseNodes();for(const o in e){const a=e[o];Se.get(parseInt(a.ID)).parents.forEach(function(e){if(t.has(e.ID)){const t=e.ID;Se.get(t).parents.forEach(function(e){if(r.has(e.ID)){r.get(e.ID).bind(new xe(a.bones),n[e.ID])}})}})}}parsePoseNodes(){const e={};if("Pose"in Pe.Objects){const t=Pe.Objects.Pose;for(const r in t)if("BindPose"===t[r].attrType&&t[r].NbPoseNodes>0){const n=t[r].PoseNode;Array.isArray(n)?n.forEach(function(t){e[t.Node]=(new ie).fromArray(t.Matrix.a)}):e[n.Node]=(new ie).fromArray(n.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in Pe){if("AmbientColor"in Pe.GlobalSettings){const e=Pe.GlobalSettings.AmbientColor.value,t=e[0],r=e[1],n=e[2];if(0!==t||0!==r||0!==n){const e=(new K).setRGB(t,r,n,we);Re.add(new G(e,1))}}"UnitScaleFactor"in Pe.GlobalSettings&&(Re.userData.unitScaleFactor=Pe.GlobalSettings.UnitScaleFactor.value)}}}class Ce{constructor(){this.negativeMaterialIndices=!1}parse(e){const t=new Map;if("Geometry"in Pe.Objects){const r=Pe.Objects.Geometry;for(const n in r){const o=Se.get(parseInt(n)),a=this.parseGeometry(o,r[n],e);t.set(parseInt(n),a)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),t}parseGeometry(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,r){const n=r.skeletons,o=[],a=e.parents.map(function(e){return Pe.Objects.Model[e.ID]});if(0===a.length)return;const s=e.children.reduce(function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e},null);e.children.forEach(function(e){void 0!==r.morphTargets[e.ID]&&o.push(r.morphTargets[e.ID])});const i=a[0],l={};"RotationOrder"in i&&(l.eulerOrder=$e(i.RotationOrder.value)),"InheritType"in i&&(l.inheritType=parseInt(i.InheritType.value)),"GeometricTranslation"in i&&(l.translation=i.GeometricTranslation.value),"GeometricRotation"in i&&(l.rotation=i.GeometricRotation.value),"GeometricScaling"in i&&(l.scale=i.GeometricScaling.value);const c=Ke(l);return this.genGeometry(t,s,o,c)}genGeometry(e,t,r,n){const o=new H;e.attrName&&(o.name=e.attrName);const a=this.parseGeoNode(e,t),s=this.genBuffers(a),i=new Q(s.vertex,3);if(i.applyMatrix4(n),o.setAttribute("position",i),s.colors.length>0&&o.setAttribute("color",new Q(s.colors,3)),t&&(o.setAttribute("skinIndex",new Le(s.weightsIndices,4)),o.setAttribute("skinWeight",new Q(s.vertexWeights,4)),o.FBX_Deformer=t),s.normal.length>0){const e=(new se).getNormalMatrix(n),t=new Q(s.normal,3);t.applyNormalMatrix(e),o.setAttribute("normal",t)}if(s.uvs.forEach(function(e,t){const r=0===t?"uv":`uv${t}`;o.setAttribute(r,new Q(s.uvs[t],2))}),a.material&&"AllSame"!==a.material.mappingType){let e=s.materialIndex[0],t=0;if(s.materialIndex.forEach(function(r,n){r!==e&&(o.addGroup(t,n-t,e),e=r,t=n)}),o.groups.length>0){const t=o.groups[o.groups.length-1],r=t.start+t.count;r!==s.materialIndex.length&&o.addGroup(r,s.materialIndex.length-r,e)}0===o.groups.length&&o.addGroup(0,s.materialIndex.length,s.materialIndex[0])}return this.addMorphTargets(o,e,r,n),o}parseGeoNode(e,t){const r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&e.LayerElementColor[0].Colors&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];let t=0;for(;e.LayerElementUV[t];)e.LayerElementUV[t].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[t])),t++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,o){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[o]})})})),r}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let r=0,n=0,o=!1,a=[],s=[],i=[],l=[],c=[],u=[];const p=this;return e.vertexIndices.forEach(function(h,d){let f,m=!1;h<0&&(h^=-1,m=!0);let g=[],v=[];if(a.push(3*h,3*h+1,3*h+2),e.color){const t=Xe(d,r,h,e.color);i.push(t[0],t[1],t[2])}if(e.skeleton){if(void 0!==e.weightTable[h]&&e.weightTable[h].forEach(function(e){v.push(e.weight),g.push(e.id)}),v.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const e=[0,0,0,0],t=[0,0,0,0];v.forEach(function(r,n){let o=r,a=g[n];t.forEach(function(t,r,n){if(o>t){n[r]=o,o=t;const s=e[r];e[r]=a,a=s}})}),g=e,v=t}for(;v.length<4;)v.push(0),g.push(0);for(let e=0;e<4;++e)c.push(v[e]),u.push(g[e])}if(e.normal){const t=Xe(d,r,h,e.normal);s.push(t[0],t[1],t[2])}e.material&&"AllSame"!==e.material.mappingType&&(f=Xe(d,r,h,e.material)[0],f<0&&(p.negativeMaterialIndices=!0,f=0)),e.uv&&e.uv.forEach(function(e,t){const n=Xe(d,r,h,e);void 0===l[t]&&(l[t]=[]),l[t].push(n[0]),l[t].push(n[1])}),n++,m&&(p.genFace(t,e,a,f,s,i,l,c,u,n),r++,n=0,a=[],s=[],i=[],l=[],c=[],u=[])}),t}getNormalNewell(e){const t=new Ne(0,0,0);for(let r=0;r<e.length;r++){const n=e[r],o=e[(r+1)%e.length];t.x+=(n.y-o.y)*(n.z+o.z),t.y+=(n.z-o.z)*(n.x+o.x),t.z+=(n.x-o.x)*(n.y+o.y)}return t.normalize(),t}getNormalTangentAndBitangent(e){const t=this.getNormalNewell(e),r=(Math.abs(t.z)>.5?new Ne(0,1,0):new Ne(0,0,1)).cross(t).normalize(),n=t.clone().cross(r).normalize();return{normal:t,tangent:r,bitangent:n}}flattenVertex(e,t,r){return new De(e.dot(t),e.dot(r))}genFace(e,t,r,n,o,a,s,i,l,c){let u;if(c>3){const e=[],n=t.baseVertexPositions||t.vertexPositions;for(let t=0;t<r.length;t+=3)e.push(new Ne(n[r[t]],n[r[t+1]],n[r[t+2]]));const{tangent:o,bitangent:a}=this.getNormalTangentAndBitangent(e),s=[];for(const t of e)s.push(this.flattenVertex(t,o,a));u=Ie.triangulateShape(s,[])}else u=[[0,1,2]];for(const[p,h,d]of u)e.vertex.push(t.vertexPositions[r[3*p]]),e.vertex.push(t.vertexPositions[r[3*p+1]]),e.vertex.push(t.vertexPositions[r[3*p+2]]),e.vertex.push(t.vertexPositions[r[3*h]]),e.vertex.push(t.vertexPositions[r[3*h+1]]),e.vertex.push(t.vertexPositions[r[3*h+2]]),e.vertex.push(t.vertexPositions[r[3*d]]),e.vertex.push(t.vertexPositions[r[3*d+1]]),e.vertex.push(t.vertexPositions[r[3*d+2]]),t.skeleton&&(e.vertexWeights.push(i[4*p]),e.vertexWeights.push(i[4*p+1]),e.vertexWeights.push(i[4*p+2]),e.vertexWeights.push(i[4*p+3]),e.vertexWeights.push(i[4*h]),e.vertexWeights.push(i[4*h+1]),e.vertexWeights.push(i[4*h+2]),e.vertexWeights.push(i[4*h+3]),e.vertexWeights.push(i[4*d]),e.vertexWeights.push(i[4*d+1]),e.vertexWeights.push(i[4*d+2]),e.vertexWeights.push(i[4*d+3]),e.weightsIndices.push(l[4*p]),e.weightsIndices.push(l[4*p+1]),e.weightsIndices.push(l[4*p+2]),e.weightsIndices.push(l[4*p+3]),e.weightsIndices.push(l[4*h]),e.weightsIndices.push(l[4*h+1]),e.weightsIndices.push(l[4*h+2]),e.weightsIndices.push(l[4*h+3]),e.weightsIndices.push(l[4*d]),e.weightsIndices.push(l[4*d+1]),e.weightsIndices.push(l[4*d+2]),e.weightsIndices.push(l[4*d+3])),t.color&&(e.colors.push(a[3*p]),e.colors.push(a[3*p+1]),e.colors.push(a[3*p+2]),e.colors.push(a[3*h]),e.colors.push(a[3*h+1]),e.colors.push(a[3*h+2]),e.colors.push(a[3*d]),e.colors.push(a[3*d+1]),e.colors.push(a[3*d+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(o[3*p]),e.normal.push(o[3*p+1]),e.normal.push(o[3*p+2]),e.normal.push(o[3*h]),e.normal.push(o[3*h+1]),e.normal.push(o[3*h+2]),e.normal.push(o[3*d]),e.normal.push(o[3*d+1]),e.normal.push(o[3*d+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(s[r][2*p]),e.uvs[r].push(s[r][2*p+1]),e.uvs[r].push(s[r][2*h]),e.uvs[r].push(s[r][2*h+1]),e.uvs[r].push(s[r][2*d]),e.uvs[r].push(s[r][2*d+1])})}addMorphTargets(e,t,r,n){if(0===r.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;r.forEach(function(r){r.rawTargets.forEach(function(r){const a=Pe.Objects.Geometry[r.geoID];void 0!==a&&o.genMorphGeometry(e,t,a,n,r.name)})})}genMorphGeometry(e,t,r,n,o){const a=void 0!==t.Vertices?t.Vertices.a:[],s=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],i=void 0!==r.Vertices?r.Vertices.a:[],l=void 0!==r.Indexes?r.Indexes.a:[],c=3*e.attributes.position.count,u=new Float32Array(c);for(let f=0;f<l.length;f++){const e=3*l[f];u[e]=i[3*f],u[e+1]=i[3*f+1],u[e+2]=i[3*f+2]}const p={vertexIndices:s,vertexPositions:u,baseVertexPositions:a},h=this.genBuffers(p),d=new Q(h.vertex,3);d.name=o||r.attrName,d.applyMatrix4(n),e.morphAttributes.position.push(d)}parseNormals(e){const t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a;let o=[];return"IndexToDirect"===r&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:o,mappingType:t,referenceType:r}}parseUVs(e){const t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a;let o=[];return"IndexToDirect"===r&&(o=e.UVIndex.a),{dataSize:2,buffer:n,indices:o,mappingType:t,referenceType:r}}parseVertexColors(e){const t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a;let o=[];"IndexToDirect"===r&&(o=e.ColorIndex.a);for(let a=0,s=new K;a<n.length;a+=4)s.fromArray(n,a),$.colorSpaceToWorking(s,we),s.toArray(n,a);return{dataSize:4,buffer:n,indices:o,mappingType:t,referenceType:r}}parseMaterialIndices(e){const t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};const n=e.Materials.a,o=[];for(let a=0;a<n.length;++a)o.push(a);return{dataSize:1,buffer:n,indices:o,mappingType:t,referenceType:r}}parseNurbsGeometry(e){const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new H;const r=t-1,n=e.KnotVector.a,o=[],a=e.Points.a;for(let c=0,u=a.length;c<u;c+=4)o.push((new ke).fromArray(a,c));let s,i;if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){s=r,i=n.length-1-s;for(let e=0;e<r;++e)o.push(o[e])}const l=new h(r,n,o,s,i).getPoints(12*o.length);return(new H).setFromPoints(l)}}class Oe{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const r in t){const n=t[r],o=this.addClip(n);e.push(o)}return e}parseClips(){if(void 0===Pe.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Pe.Objects.AnimationCurveNode,t=new Map;for(const r in e){const n=e[r];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){const e={id:n.id,attr:n.attrName,curves:{}};t.set(e.id,e)}}return t}parseAnimationCurves(e){const t=Pe.Objects.AnimationCurve;for(const r in t){const n={id:t[r].id,times:t[r].KeyTime.a.map(Ge),values:t[r].KeyValueFloat.a},o=Se.get(n.id);if(void 0!==o){const t=o.parents[0].ID,r=o.parents[0].relationship;r.match(/X/)?e.get(t).curves.x=n:r.match(/Y/)?e.get(t).curves.y=n:r.match(/Z/)?e.get(t).curves.z=n:r.match(/DeformPercent/)&&e.has(t)&&(e.get(t).curves.morph=n)}}}parseAnimationLayers(e){const t=Pe.Objects.AnimationLayer,r=new Map;for(const n in t){const t=[],o=Se.get(parseInt(n));if(void 0!==o){o.children.forEach(function(r,n){if(e.has(r.ID)){const o=e.get(r.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===t[n]){const e=Se.get(r.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID;if(void 0!==e){const o=Pe.Objects.Model[e.toString()];if(void 0===o)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",r);const a={modelName:o.attrName?me.sanitizeNodeName(o.attrName):"",ID:o.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Re.traverse(function(e){e.ID===o.id&&(a.transform=e.matrix,e.userData.transformData&&(a.eulerOrder=e.userData.transformData.eulerOrder))}),a.transform||(a.transform=new ie),"PreRotation"in o&&(a.preRotation=o.PreRotation.value),"PostRotation"in o&&(a.postRotation=o.PostRotation.value),t[n]=a}}t[n]&&(t[n][o.attr]=o)}else if(void 0!==o.curves.morph){if(void 0===t[n]){const e=Se.get(r.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID,o=Se.get(e).parents[0].ID,a=Se.get(o).parents[0].ID,s=Se.get(a).parents[0].ID,i=Pe.Objects.Model[s],l={modelName:i.attrName?me.sanitizeNodeName(i.attrName):"",morphName:Pe.Objects.Deformer[e].attrName};t[n]=l}t[n][o.attr]=o}}}),r.set(parseInt(n),t)}}return r}parseAnimStacks(e){const t=Pe.Objects.AnimationStack,r={};for(const n in t){const o=Se.get(parseInt(n)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(o[0].ID);r[n]={name:t[n].attrName,layer:a}}return r}addClip(e){let t=[];const r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new W(e.name,-1,t)}generateTracks(e){const t=[];let r=new Ne,n=new Ne;if(e.transform&&e.transform.decompose(r,new ge,n),r=r.toArray(),n=n.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const n=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==n&&t.push(n)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const r=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);void 0!==r&&t.push(r)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const r=this.generateVectorTrack(e.modelName,e.S.curves,n,"scale");void 0!==r&&t.push(r)}if(void 0!==e.DeformPercent){const r=this.generateMorphTrack(e);void 0!==r&&t.push(r)}return t}generateVectorTrack(e,t,r,n){const o=this.getTimesForAllAxes(t),a=this.getKeyframeTrackValues(o,t,r);return new Fe(e+"."+n,o,a)}generateRotationTrack(e,t,r,n,o){let a,s;if(void 0!==t.x&&void 0!==t.y&&void 0!==t.z){const e=this.interpolateRotations(t.x,t.y,t.z,o);a=e[0],s=e[1]}const i=$e(0);void 0!==r&&((r=r.map(ae.degToRad)).push(i),r=(new Z).fromArray(r),r=(new ge).setFromEuler(r)),void 0!==n&&((n=n.map(ae.degToRad)).push(i),n=(new Z).fromArray(n),n=(new ge).setFromEuler(n).invert());const l=new ge,c=new Z,u=[];if(!s||!a)return new ve(e+".quaternion",[0],[0]);for(let p=0;p<s.length;p+=3){if(c.set(s[p],s[p+1],s[p+2],o),l.setFromEuler(c),void 0!==r&&l.premultiply(r),void 0!==n&&l.multiply(n),p>2){(new ge).fromArray(u,(p-3)/3*4).dot(l)<0&&l.set(-l.x,-l.y,-l.z,-l.w)}l.toArray(u,p/3*4)}return new ve(e+".quaternion",a,u)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,r=t.values.map(function(e){return e/100}),n=Re.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new pe(e.modelName+".morphTargetInfluences["+n+"]",t.times,r)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}),t.length>1){let e=1,r=t[0];for(let n=1;n<t.length;n++){const o=t[n];o!==r&&(t[e]=o,r=o,e++)}t=t.slice(0,e)}return t}getKeyframeTrackValues(e,t,r){const n=r,o=[];let a=-1,s=-1,i=-1;return e.forEach(function(e){if(t.x&&(a=t.x.times.indexOf(e)),t.y&&(s=t.y.times.indexOf(e)),t.z&&(i=t.z.times.indexOf(e)),-1!==a){const e=t.x.values[a];o.push(e),n[0]=e}else o.push(n[0]);if(-1!==s){const e=t.y.values[s];o.push(e),n[1]=e}else o.push(n[1]);if(-1!==i){const e=t.z.values[i];o.push(e),n[2]=e}else o.push(n[2])}),o}interpolateRotations(e,t,r,n){const o=[],a=[];o.push(e.times[0]),a.push(ae.degToRad(e.values[0])),a.push(ae.degToRad(t.values[0])),a.push(ae.degToRad(r.values[0]));for(let s=1;s<e.values.length;s++){const i=[e.values[s-1],t.values[s-1],r.values[s-1]];if(isNaN(i[0])||isNaN(i[1])||isNaN(i[2]))continue;const l=i.map(ae.degToRad),c=[e.values[s],t.values[s],r.values[s]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const u=c.map(ae.degToRad),p=[c[0]-i[0],c[1]-i[1],c[2]-i[2]],h=[Math.abs(p[0]),Math.abs(p[1]),Math.abs(p[2])];if(h[0]>=180||h[1]>=180||h[2]>=180){const t=Math.max(...h)/180,r=new Z(...l,n),i=new Z(...u,n),c=(new ge).setFromEuler(r),p=(new ge).setFromEuler(i);c.dot(p)&&p.set(-p.x,-p.y,-p.z,-p.w);const d=e.times[s-1],f=e.times[s]-d,m=new ge,g=new Z;for(let e=0;e<1;e+=1/t)m.copy(c.clone().slerp(p.clone(),e)),o.push(d+e*f),g.setFromQuaternion(m,n),a.push(g.x),a.push(g.y),a.push(g.z)}else o.push(e.times[s]),a.push(ae.degToRad(e.values[s])),a.push(ae.degToRad(t.values[s])),a.push(ae.degToRad(r.values[s]))}return[o,a]}}class Be{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new je,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){const o=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(o||a)return;const s=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),i=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");s?t.parseNodeBegin(e,s):i?t.parseNodeProperty(e,i,r[++n]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}),this.allNodes}parseNodeBegin(e,t){const r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:r},a=this.parseNodeAttr(n),s=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,o):r in s?("PoseNode"===r?s.PoseNode.push(o):void 0!==s[r].id&&(s[r]={},s[r][s[r].id]=s[r]),""!==a.id&&(s[r][a.id]=o)):"number"==typeof a.id?(s[r]={},s[r][a.id]=o):"Properties70"!==r&&(s[r]="PoseNode"===r?[o]:o),"number"==typeof a.id&&(o.id=a.id),""!==a.name&&(o.attrName=a.name),""!==a.type&&(o.attrType=a.type),this.pushStack(o)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}}parseNodeProperty(e,t,r){let n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),o=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===o&&(o=r.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===n){const e=o.split(",").slice(1),t=parseInt(e[0]),r=parseInt(e[1]);let s=o.split(",").slice(3);s=s.map(function(e){return e.trim().replace(/^"/,"")}),n="connections",o=[t,r],function(e,t){for(let r=0,n=e.length,o=t.length;r<o;r++,n++)e[n]=t[r]}(o,s),void 0===a[n]&&(a[n]=[])}"Node"===n&&(a.id=o),n in a&&Array.isArray(a[n])?a[n].push(o):"a"!==n?a[n]=o:a.a=o,this.setCurrentProp(a,n),"a"===n&&","!==o.slice(-1)&&(a.a=qe(o))}else this.parseNodeSpecialProperty(e,n,o)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=qe(t.a))}parseNodeSpecialProperty(e,t,r){const n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=n[0],a=n[1],s=n[2],i=n[3];let l=n[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=qe(l)}this.getPrevNode()[o]={type:a,type2:s,flag:i,value:l},this.setCurrentProp(this.getPrevNode(),o)}}class Ue{parse(e){const t=new Ve(e);t.skip(23);const r=t.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);const n=new je;for(;!this.endOfContent(t);){const e=this.parseNode(t,r);null!==e&&n.add(e.name,e)}return n}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const r={},n=t>=7500?e.getUint64():e.getUint32(),o=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),s=e.getString(a);if(0===n)return null;const i=[];for(let p=0;p<o;p++)i.push(this.parseProperty(e));const l=i.length>0?i[0]:"",c=i.length>1?i[1]:"",u=i.length>2?i[2]:"";for(r.singleProperty=1===o&&e.getOffset()===n;n>e.getOffset();){const n=this.parseNode(e,t);null!==n&&this.parseSubNode(s,r,n)}return r.propertyList=i,"number"==typeof l&&(r.id=l),""!==c&&(r.attrName=c),""!==u&&(r.attrType=u),""!==s&&(r.name=s),r}parseSubNode(e,t,r){if(!0===r.singleProperty){const e=r.propertyList[0];Array.isArray(e)?(t[r.name]=r,r.a=e):t[r.name]=e}else if("Connections"===e&&"C"===r.name){const e=[];r.propertyList.forEach(function(t,r){0!==r&&e.push(t)}),void 0===t.connections&&(t.connections=[]),t.connections.push(e)}else if("Properties70"===r.name){Object.keys(r).forEach(function(e){t[e]=r[e]})}else if("Properties70"===e&&"P"===r.name){let e=r.propertyList[0],n=r.propertyList[1];const o=r.propertyList[2],a=r.propertyList[3];let s;0===e.indexOf("Lcl ")&&(e=e.replace("Lcl ","Lcl_")),0===n.indexOf("Lcl ")&&(n=n.replace("Lcl ","Lcl_")),s="Color"===n||"ColorRGB"===n||"Vector"===n||"Vector3D"===n||0===n.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[e]={type:n,type2:o,flag:a,value:s}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)}parseProperty(e){const t=e.getString(1);let r;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return r=e.getUint32(),e.getArrayBuffer(r);case"S":return r=e.getUint32(),e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const n=e.getUint32(),o=e.getUint32(),a=e.getUint32();if(0===o)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}const s=j(new Uint8Array(e.getArrayBuffer(a))),i=new Ve(s.buffer);switch(t){case"b":case"c":return i.getBooleanArray(n);case"d":return i.getFloat64Array(n);case"f":return i.getFloat32Array(n);case"i":return i.getInt32Array(n);case"l":return i.getInt64Array(n)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class Ve{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return!(1&~this.getUint8())}getBooleanArray(e){const t=[];for(let r=0;r<e;r++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let r=0;r<e;r++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let r=0;r<e;r++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let r=0;r<e;r++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let r=0;r<e;r++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){const t=this.offset;let r=new Uint8Array(this.dv.buffer,t,e);this.skip(e);const n=r.indexOf(0);return n>=0&&(r=new Uint8Array(this.dv.buffer,t,n)),this._textDecoder.decode(r)}}class je{add(e,t){this[e]=t}}function ze(e){const t=e.match(/FBXVersion: (\d+)/);if(t){return parseInt(t[1])}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Ge(e){return e/46186158e3}const We=[];function Xe(e,t,r,n){let o;switch(n.mappingType){case"ByPolygonVertex":o=e;break;case"ByPolygon":o=t;break;case"ByVertice":o=r;break;case"AllSame":o=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(o=n.indices[o]);const a=o*n.dataSize,s=a+n.dataSize;return function(e,t,r,n){for(let o=r,a=0;o<n;o++,a++)e[a]=t[o];return e}(We,n.buffer,a,s)}const He=new Z,_e=new Ne;function Ke(e){const t=new ie,r=new ie,n=new ie,o=new ie,a=new ie,s=new ie,i=new ie,l=new ie,c=new ie,u=new ie,p=new ie,h=new ie,d=e.inheritType?e.inheritType:0;e.translation&&t.setPosition(_e.fromArray(e.translation));const f=$e(0);if(e.preRotation){const t=e.preRotation.map(ae.degToRad);t.push(f),r.makeRotationFromEuler(He.fromArray(t))}if(e.rotation){const t=e.rotation.map(ae.degToRad);t.push(e.eulerOrder||f),n.makeRotationFromEuler(He.fromArray(t))}if(e.postRotation){const t=e.postRotation.map(ae.degToRad);t.push(f),o.makeRotationFromEuler(He.fromArray(t)),o.invert()}e.scale&&a.scale(_e.fromArray(e.scale)),e.scalingOffset&&i.setPosition(_e.fromArray(e.scalingOffset)),e.scalingPivot&&s.setPosition(_e.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(_e.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(_e.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(p.copy(e.parentMatrix),u.copy(e.parentMatrixWorld));const m=r.clone().multiply(n).multiply(o),g=new ie;g.extractRotation(u);const v=new ie;v.copyPosition(u);const y=v.clone().invert().multiply(u),w=g.clone().invert().multiply(y),I=a,x=new ie;if(0===d)x.copy(g).multiply(m).multiply(w).multiply(I);else if(1===d)x.copy(g).multiply(w).multiply(m).multiply(I);else{const e=(new ie).scale((new Ne).setFromMatrixScale(p)).clone().invert(),t=w.clone().multiply(e);x.copy(g).multiply(m).multiply(t).multiply(I)}const b=c.clone().invert(),T=s.clone().invert();let A=t.clone().multiply(l).multiply(c).multiply(r).multiply(n).multiply(o).multiply(b).multiply(i).multiply(s).multiply(a).multiply(T);const E=(new ie).copyPosition(A),L=u.clone().multiply(E);return h.copyPosition(L),A=h.clone().multiply(x),A.premultiply(u.invert()),A}function $e(e){const t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function qe(e){return e.split(",").map(function(e){return parseFloat(e)})}function Ye(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),(new TextDecoder).decode(new Uint8Array(e,t,r))}const{BufferAttribute:Ze,BufferGeometry:Je,Color:Qe,FileLoader:et,Float32BufferAttribute:tt,Loader:rt,Vector3:nt,SRGBColorSpace:ot}=await e("three");class at extends rt{constructor(e){super(e)}load(e,t,r,n){const o=this,a=new et(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(r){try{t(o.parse(r))}catch(pt){n?n(pt):console.error(pt),o.manager.itemError(e)}},r,n)}parse(e){function t(e,t,r){for(let n=0,o=e.length;n<o;n++)if(e[n]!==t.getUint8(r+n))return!1;return!0}const r=function(e){if("string"==typeof e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(e);return function(e){const r=new DataView(e);if(84+50*r.getUint32(80,!0)===r.byteLength)return!0;const n=[115,111,108,105,100];for(let o=0;o<5;o++)if(t(n,r,o))return!1;return!0}(r)?function(e){const t=new DataView(e),r=t.getUint32(80,!0);let n,o,a,s,i,l,c,u,p=!1;for(let g=0;g<70;g++)1129270351==t.getUint32(g,!1)&&82==t.getUint8(g+4)&&61==t.getUint8(g+5)&&(p=!0,s=new Float32Array(3*r*3),i=t.getUint8(g+6)/255,l=t.getUint8(g+7)/255,c=t.getUint8(g+8)/255,u=t.getUint8(g+9)/255);const h=new Je,d=new Float32Array(3*r*3),f=new Float32Array(3*r*3),m=new Qe;for(let g=0;g<r;g++){const e=84+50*g,r=t.getFloat32(e,!0),u=t.getFloat32(e+4,!0),h=t.getFloat32(e+8,!0);if(p){const r=t.getUint16(e+48,!0);32768&r?(n=i,o=l,a=c):(n=(31&r)/31,o=(r>>5&31)/31,a=(r>>10&31)/31)}for(let i=1;i<=3;i++){const l=e+12*i,c=3*g*3+3*(i-1);d[c]=t.getFloat32(l,!0),d[c+1]=t.getFloat32(l+4,!0),d[c+2]=t.getFloat32(l+8,!0),f[c]=r,f[c+1]=u,f[c+2]=h,p&&(m.setRGB(n,o,a,ot),s[c]=m.r,s[c+1]=m.g,s[c+2]=m.b)}}return h.setAttribute("position",new Ze(d,3)),h.setAttribute("normal",new Ze(f,3)),p&&(h.setAttribute("color",new Ze(s,3)),h.hasColors=!0,h.alpha=u),h}(r):function(e){const t=new Je,r=/solid([\s\S]*?)endsolid/g,n=/facet([\s\S]*?)endfacet/g,o=/solid\s(.+)/;let a=0;const s=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,i=new RegExp("vertex"+s+s+s,"g"),l=new RegExp("normal"+s+s+s,"g"),c=[],u=[],p=[],h=new nt;let d,f=0,m=0,g=0;for(;null!==(d=r.exec(e));){m=g;const e=d[0],r=null!==(d=o.exec(e))?d[1]:"";for(p.push(r);null!==(d=n.exec(e));){let e=0,t=0;const r=d[0];for(;null!==(d=l.exec(r));)h.x=parseFloat(d[1]),h.y=parseFloat(d[2]),h.z=parseFloat(d[3]),t++;for(;null!==(d=i.exec(r));)c.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3])),u.push(h.x,h.y,h.z),e++,g++;1!==t&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+a),3!==e&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+a),a++}const s=m,v=g-m;t.userData.groupNames=p,t.addGroup(s,v,f),f++}return t.setAttribute("position",new tt(c,3)),t.setAttribute("normal",new tt(u,3)),t}("string"!=typeof(n=e)?(new TextDecoder).decode(n):n);var n}}const st=await e("three"),{ref:it,reactive:lt}=await e("vue"),ct={GLTFLoader:t,TextureLoader:st.TextureLoader,STLLoader:at,RGBELoader:class extends n{constructor(e){console.warn("RGBELoader has been deprecated. Please use HDRLoader instead."),super(e)}},FBXLoader:class extends ne{constructor(e){super(e)}load(e,t,r,n){const o=this,a=""===o.path?oe.extractUrlBase(e):o.path,s=new J(this.manager);s.setPath(o.path),s.setResponseType("arraybuffer"),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,function(r){try{t(o.parse(r,a))}catch(pt){n?n(pt):console.error(pt),o.manager.itemError(e)}},r,n)}parse(e,t){if(function(e){const t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===Ye(e,0,t.length)}(e))Pe=(new Ue).parse(e);else{const t=Ye(e);if(!function(e){const t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let r=0;function n(t){const n=e[t-1];return e=e.slice(r+t),r++,n}for(let o=0;o<t.length;++o){if(n(1)===t[o])return!1}return!0}(t))throw new Error("THREE.FBXLoader: Unknown format.");if(ze(t)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+ze(t));Pe=(new Be).parse(t)}const r=new Ee(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new Me(r,this.manager).parse(Pe)}},FileLoader:st.FileLoader};const ut=new class{constructor({decoderPath:e="./draco/"}={}){this.hasAllFinished=it(!1),this.progress=it(0),this.lenth=0,this.curIndex=0,this.loaderMapping=ct,this.decoderPath=e,this.items={},this.reactiveItems=lt({}),this.loadingMap={}}loadResources(e){e.forEach(({functionName:e,url:t,resourceID:r})=>{this.loadItem(e,t,r)})}loadItem(e,t,n=""){if(!n){const e=t.match(/[^\\/]+$/);n=e?e[0]:t}if(void 0!==this.loadingMap[n])return this.loadingMap[n];if(this.items[n])return Promise.resolve(this.items[n]);const o=this.loaderMapping[e];if(!o)return console.error(`loader${e}`),Promise.reject(`loader${e}`);let a=null;"GLTFLoader"===e&&(a=e=>{const t=new r;t.setDecoderPath(this.decoderPath),t.preload(),e.setDRACOLoader(t)}),this.curIndex++,this.lenth++;const s=async function(e,t,r,n){const o=new e;return r&&r(o),await new Promise((e,r)=>{o.load(t,t=>{const r=t;r.scene&&Object.assign(r,function(e){const t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}(r.scene)),e(r)},n,e=>{console.log("[useLoader] - Failed to load resource",e),r(e)})})}(o,t,a).then(e=>(this.items[n]=e,this.reactiveItems[n]=e,this.curIndex--,this.progress.value=Math.floor((this.lenth-this.curIndex)/this.lenth*100),0===this.curIndex&&(this.hasAllFinished.value=!0),e));return this.loadingMap[n]=s,s}getItem(e){return this.items[e]}getReactiveItem(e){return()=>this.reactiveItems[e]}getResource(e,t,r){return this.loadItem(e,t,r)}};export{at as STLLoader,ut as instance,j as unzlibSync};
