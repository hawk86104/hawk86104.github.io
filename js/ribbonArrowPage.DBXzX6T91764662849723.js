import{P as e}from"./tweakpane.CqZAnw7f1764662849723.js";import{_ as a,K as t}from"./@tresjs.DeDzA3xI1764662849723.js";import"./OimoPhysicsBuffer.BRUc4SZh1764662849723.js";import{_ as r}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.5NC8Jng71764662849723.js";import"./shapeConfigurator.vue_vue_type_style_index_1_scoped_abbf0cc1_lang.DAtMGds81764662849723.js";import"./Resource.DK6sqbPG1764662849723.js";import"./PackedMipMapGenerator.CavgptWg1764662849723.js";import{w as o,G as n,o as i,I as l,u as s,d,r as p,g as c,b as u,e as m,h,m as f}from"./@vue.D9fSGD371764662849723.js";import{a6 as g,b as w,d as b,i as x,j as v,cG as y,r as P,aE as T,aG as W}from"./three.F31Lz30M1764662849723.js";import"./postprocessing.Ck-ZKH-d1764662849723.js";import"./@vueuse.CPu_THNO1764662849723.js";import"./oimophysics.CfVKSiAm1764662849723.js";import"./dither.glsl.tNAdkJUa1764662849723.js";import"./Reflector.Bmhpqb-R1764662849723.js";import"./vite-plugin-qiankun.B06WoCqG1764662849723.js";import"./utils.CNife3_q1764662849723.js";import"./object-hash.DLCcFMFk1764662849723.js";import"./@amap.fjyZdsU91764662849723.js";import"./jszip.BHpItYmK1764662849723.js";import"./three-stdlib.DIRJQAQ41764662849723.js";const j=["geometry"],M=["color","transparent","opacity","side"],B=["geometry"],S=["map","side"],_={__name:"ribbonArrow",props:{length:{default:20},width:{default:1},bendPosition:{default:.5},curvature:{default:.4},backgroundColor:{default:"#00aaff"},backgroundAlpha:{default:.25},segments:{default:240},arrowColor:{default:"#ffffff"},arrowWidth:{default:.3},arrowHeight:{default:.5},arrowSpacing:{default:.5},arrowOffset:{default:0},arrowLineWidth:{default:2},arrowStyle:{default:"chevron"},speed:{default:.5},pixelWorldScale:{default:.03}},setup(e){const t=e,r=()=>{const e=Math.max(1e-4,t.length),a=w.clamp(t.bendPosition,0,1),r=e*a,o=e-r,n=Math.min(r,o),i=t.curvature>0&&a>0&&a<1?Math.min(.9*n,.2*e*t.curvature):0,l=Math.max(0,r-i),s=i>0?Math.PI*i/2:0;return{fullLen:l+s+Math.max(0,o-i),L1val:r,radius:i,len1:l,arcLen:s}};let{fullLen:d,L1val:p,radius:c,len1:u,arcLen:m}=r();const h=e=>{if((e=w.clamp(e,0,d))<=u)return new b(e,0);if(e<=u+m&&c>0){const a=(e-u)/m,t=-Math.PI/2+a*(Math.PI/2),r=c;return new b(p-c+Math.cos(t)*c,r+Math.sin(t)*c)}return new b(p,c+(e-(u+m)))};let f=[],_=[],k=0;const C=()=>{f=[],_=[];const e=Math.max(8,Math.floor(t.segments));let a=h(0),r=0;f.push(a),_.push(0),k=0;for(let t=1;t<=e;t++){const o=h(d*(t/e));r+=o.clone().sub(a).length(),f.push(o),_.push(r),a=o}k=r};C();let A=null;const L=()=>{const e=2*f.length,a=new Float32Array(3*e),r=new Float32Array(3*e),o=new Float32Array(2*e),n=[],i=t.width/2;function l(e){return 0===e?f[1].clone().sub(f[0]).normalize():e===f.length-1?f[e].clone().sub(f[e-1]).normalize():f[e+1].clone().sub(f[e-1]).normalize()}for(let s=0;s<f.length;s++){const e=f[s],n=l(s),d=new b(-n.y,n.x).normalize(),p=e.x-d.x*i,c=e.y-d.y*i,u=e.x+d.x*i,m=e.y+d.y*i;a[3*(2*s+0)+0]=p,a[3*(2*s+0)+1]=c,a[3*(2*s+0)+2]=0,a[3*(2*s+1)+0]=u,a[3*(2*s+1)+1]=m,a[3*(2*s+1)+2]=0,r[3*(2*s+0)+0]=0,r[3*(2*s+0)+1]=0,r[3*(2*s+0)+2]=1,r[3*(2*s+1)+0]=0,r[3*(2*s+1)+1]=0,r[3*(2*s+1)+2]=1;const h=_[s]/(t.arrowWidth+t.arrowSpacing);o[2*(2*s+0)+0]=h,o[2*(2*s+0)+1]=0,o[2*(2*s+1)+0]=h,o[2*(2*s+1)+1]=1}for(let t=0;t<f.length-1;t++){const e=2*t,a=2*t+1,r=2*(t+1),o=2*(t+1)+1;n.push(e,r,a),n.push(a,r,o)}A&&A.dispose(),A=new x,A.setAttribute("position",new v(a,3)),A.setAttribute("normal",new v(r,3)),A.setAttribute("uv",new v(o,2)),A.setIndex(n),A.computeBoundingBox(),A.computeBoundingSphere()};L();let H=null;const G=()=>{H&&H.dispose(),H=(({arrowWidthPx:e,arrowHeightPx:a,spacingPx:r,style:o,color:n,lineWidth:i,offset:l})=>{const s=r,d=e+2*s,p=a+2*s,c=Math.max(1,window.devicePixelRatio||1),u=document.createElement("canvas");u.width=d*c,u.height=p*c,u.style.width=d+"px",u.style.height=p+"px";const m=u.getContext("2d");m.scale(c,c),m.clearRect(0,0,d,p),m.strokeStyle=n,m.fillStyle=n,m.lineWidth=i,m.lineJoin="round",m.lineCap="round";const h=s,f=e,g=a,w=h+f/2,b=s+g/2+l;"chevron"===o?(m.beginPath(),m.moveTo(h,b-g/2),m.lineTo(h+f,b),m.lineTo(h,b+g/2),m.stroke()):"double"===o?(m.beginPath(),m.moveTo(h,b-g/2),m.lineTo(h+.7*f,b),m.lineTo(h,b+g/2),m.stroke(),m.beginPath(),m.moveTo(h+.8*f,b-g/2),m.lineTo(h+1.5*f,b),m.lineTo(h+.8*f,b+g/2),m.stroke()):"triangle"===o?(m.beginPath(),m.moveTo(h,b-g/2),m.lineTo(h+f,b),m.lineTo(h,b+g/2),m.closePath(),m.fill()):"diamond"===o?(m.beginPath(),m.moveTo(w,b-g/2),m.lineTo(w+f/2,b),m.lineTo(w,b+g/2),m.lineTo(w-f/2,b),m.closePath(),m.fill()):(m.beginPath(),m.moveTo(h,b-g/2),m.lineTo(h+f,b),m.lineTo(h,b+g/2),m.stroke());const x=new y(u);return x.generateMipmaps=!1,x.minFilter=P,x.magFilter=P,x.wrapS=T,x.wrapT=W,x.repeat.set(k/(t.arrowWidth+t.arrowSpacing),1),x.needsUpdate=!0,x})({arrowWidthPx:t.arrowWidth/t.pixelWorldScale,arrowHeightPx:t.arrowHeight/t.pixelWorldScale,spacingPx:t.arrowSpacing/t.pixelWorldScale,style:t.arrowStyle,color:t.arrowColor,lineWidth:t.arrowLineWidth,offset:t.arrowOffset})};G(),o(()=>[t.length,t.width,t.bendPosition,t.curvature,t.segments,t.arrowColor,t.arrowWidth,t.arrowHeight,t.arrowSpacing,t.arrowOffset,t.arrowLineWidth,t.arrowStyle,t.pixelWorldScale],()=>{({fullLen:d,L1val:p,radius:c,len1:u,arcLen:m}=r()),C(),L(),G()});const{onBeforeRender:I}=a();return I(()=>{if(H){const e=.01*t.speed;H.offset.x=(H.offset.x-e)%1,H.offset.x>1&&(H.offset.x-=1),H.needsUpdate=!0}}),(a,t)=>(i(),n("TresGroup",null,[l("TresMesh",{geometry:s(A)},[l("TresMeshBasicMaterial",{color:e.backgroundColor,transparent:e.backgroundAlpha<1,opacity:e.backgroundAlpha,side:g,depthWrite:""},null,8,M)],8,j),l("TresMesh",{geometry:s(A)},[l("TresMeshBasicMaterial",{map:s(H),transparent:"",side:g,depthWrite:"",renderOrder:1},null,8,S)],8,B)]))}},k=d({__name:"ribbonArrowPage",setup(a){const o=new e({expanded:!0}),n=p({length:20,speed:1,width:1,bendPosition:.5,curvature:.4,backgroundColor:"#00aaff",backgroundAlpha:.25,segments:240,arrowColor:"#ffffff",arrowWidth:2,arrowHeight:2,arrowSpacing:2,arrowOffset:0,arrowLineWidth:18,arrowStyle:"chevron",pixelWorldScale:.03});return o.addBinding(n,"length",{label:"长度",min:1,max:60,step:1}),o.addBinding(n,"speed",{label:"速度",min:-5,max:5,step:.01}),o.addBinding(n,"width",{label:"宽度",min:.1,max:5,step:.1}),o.addBinding(n,"bendPosition",{label:"弯折位置",min:0,max:1,step:.01}),o.addBinding(n,"curvature",{label:"弯曲度",min:0,max:1,step:.01}),o.addBinding(n,"backgroundColor",{label:"背景颜色"}),o.addBinding(n,"backgroundAlpha",{label:"背景透明度",min:0,max:1,step:.01}),o.addBinding(n,"segments",{label:"分段数",min:10,max:500,step:1}),o.addBinding(n,"arrowColor",{label:"箭头颜色"}),o.addBinding(n,"arrowWidth",{label:"箭头高度",min:.1,max:10,step:.1}),o.addBinding(n,"arrowHeight",{label:"箭头宽度",min:.1,max:10,step:.1}),o.addBinding(n,"arrowSpacing",{label:"箭头间距",min:.1,max:10,step:.1}),o.addBinding(n,"arrowOffset",{label:"箭头垂直偏移",min:-5,max:5,step:.01}),o.addBinding(n,"arrowLineWidth",{label:"线条箭头粗细",min:1,max:50,step:1}),o.addBinding(n,"arrowStyle",{label:"箭头样式",options:{Chevron:"chevron",Double:"double",Triangle:"triangle",Diamond:"diamond"}}),o.addBinding(n,"pixelWorldScale",{label:"像素到世界单位比例",min:.001,max:.1,step:.001}),(e,a)=>{const o=c("TresCanvas");return i(),u(o,{clearColor:"#333","window-size":""},{default:m(()=>[a[0]||(a[0]=l("TresPerspectiveCamera",{position:[16,30,-30],fov:45,near:.1,far:1e4},null,-1)),h(s(t),{enableDamping:""}),h(s(_),f({position:[-2,3,0]},n,{"rotation-x":Math.PI/2}),null,16,["rotation-x"]),h(r,{reflectivity:1,showGridHelper:!1,scale:10})]),_:1})}}});export{k as default};
