import{$ as e,a0 as t,a1 as n,W as r,g as s,bo as i,bp as o,bq as a,br as l,aJ as c,i as u,ae as h,ao as d,o as p,y as m,bj as f,k as g,a2 as y,j as v,a3 as x,V as b,a4 as _,x as w,d as T,M as E,a5 as S,P as A,R as M,S as O,T as C,a6 as N,C as P,b as R,a7 as I,m as L,Q as k,ai as D,aj as z,z as U,a8 as F,ak as B,bs as V,b3 as j,bt as H,bu as Y,f as W,J as X,p as G,O as q,bv as Z,q as K,H as Q,a as J,B as $,bw as ee,D as te,bg as ne,bx as re,a9 as se,al as ie,t as oe,by as ae,bz as le,u as ce,E as ue,bA as he,b2 as de,bB as pe,am as me,be as fe,bC as ge,bD as ye,n as ve,Y as xe,bE as be,bF as _e,bG as we,a_ as Te,bf as Ee,r as Se,ar as Ae,at as Me,au as Oe,av as Ce,I as Ne,aw as Pe,ax as Re,ay as Ie,az as Le,aA as ke,aB as De,aC as ze,aD as Ue,aE as Fe,aF as Be,aG as Ve,h as je,aH as He,aI as Ye,an as We,aK as Xe,l as Ge,aL as qe,aM as Ze,aN as Ke,aO as Qe,aP as Je,bH as $e,aQ as et,aR as tt,aS as nt,aT as rt,aV as st,aW as it,aX as ot,aY as at,aZ as lt,ad as ct,bI as ut,bJ as ht,v as dt,bK as pt,bL as mt,aU as ft,bM as gt,bN as yt,bO as vt,bP as xt,bQ as bt,bR as _t,bS as wt}from"./three.DvmzhRS91761100244891.js";import{d as Tt,a4 as Et,a as St,t as At,G as Mt,q as Ot,w as Ct,a1 as Nt,V as Pt,o as Rt,N as It,u as Lt,J as kt,a5 as Dt,R as zt,a3 as Ut,p as Ft,E as Bt,F as Vt,r as jt,D as Ht,c as Yt,n as Wt,_ as Xt,H as Gt,I as qt,L as Zt,m as Kt,ac as Qt,ad as Jt,ae as $t,af as en,h as tn,a8 as nn,b as rn,k as sn,l as on,i as an,s as ln,ag as cn,e as un,W as hn,M as dn,O as pn,Q as mn,B as fn,v as gn,ah as yn}from"./@vue.CKlgtJke1761100244891.js";import{E as vn,R as xn,C as bn,N as _n,D as wn,B as Tn,G as En,O as Sn,a as An}from"./postprocessing.CYU4Fj-U1761100244891.js";import{c as Mn,p as On,t as Cn,u as Nn,a as Pn,b as Rn,d as In,e as Ln,f as kn,r as Dn,g as zn,h as Un,i as Fn,j as Bn,k as Vn,l as jn,m as Hn,n as Yn,o as Wn,q as Xn}from"./@vueuse.mZcBai3M1761100244891.js";const Gn={name:"@tresjs/core",type:"module",version:"5.1.0",packageManager:"pnpm@10.17.0",description:"Declarative ThreeJS using Vue Components",author:"Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",license:"MIT",repository:{type:"git",url:"git+https://github.com/Tresjs/tres.git",directory:"packages/core"},keywords:["vue","3d","threejs","three","threejs-vue"],sideEffects:!1,exports:{".":{types:"./dist/index.d.ts",import:"./dist/tres.js",default:"./dist/tres.js"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},module:"./dist/tres.js",types:"./dist/index.d.ts",files:["*.d.ts","dist"],publishConfig:{access:"public"},scripts:{build:"vite build",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix",typecheck:"vue-tsc --noEmit"},peerDependencies:{three:">=0.133",vue:">=3.4"},dependencies:{"@pmndrs/pointer-events":"^6.6.17","@vue/devtools-api":"^7.7.2","@vueuse/core":"catalog:",radashi:"^12.6.2"},devDependencies:{"@tresjs/eslint-config":"workspace:*","@types/three":"catalog:","@typescript-eslint/eslint-plugin":"catalog:","@typescript-eslint/parser":"catalog:","@vitejs/plugin-vue":"catalog:","@vitest/coverage-v8":"3.2.4","@vitest/ui":"catalog:","@vue/test-utils":"catalog:",eslint:"catalog:","eslint-plugin-vue":"catalog:",jsdom:"catalog:",kolorist:"catalog:",pathe:"catalog:","rollup-plugin-analyzer":"catalog:","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"catalog:",three:"catalog:",vite:"catalog:","vite-plugin-banner":"catalog:","vite-plugin-dts":"catalog:","vite-plugin-inspect":"^11.3.3",vitest:"catalog:",vue:"catalog:","vue-demi":"^0.14.10","vue-tsc":"catalog:"},nx:{implicitDependencies:["!@tresjs/core-*"]}};
/*! #__NO_SIDE_EFFECTS__ */function qn(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}const Zn=qn("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot");function Kn(e){var t;const n=(null==(t=e?.replace(/([A-Z])+/g,Qn))?void 0:t.split(/(?=[A-Z])|[\.\-\s_]/).map(e=>e.toLowerCase()))??[];return 0===n.length?"":1===n.length?n[0]:n.reduce((e,t)=>`${e}${t.charAt(0).toUpperCase()}${t.slice(1)}`)}function Qn(e){if(!e||0===e.length)return"";const t=e.toLowerCase();return t.substring(0,1).toUpperCase()+t.substring(1,t.length)}function Jn(e,t){if(Object.is(e,t))return!0;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(e instanceof RegExp&&t instanceof RegExp)return e.toString()===t.toString();if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const n=Reflect.ownKeys(e),r=Reflect.ownKeys(t);if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(!Reflect.has(t,n[s])||!Jn(e[n[s]],t[n[s]]))return!1;return!0}function $n(e){return"function"==typeof e}function er(e){return"number"==typeof e&&!Number.isNaN(e)}function tr(e){return function(e,t){return Object.prototype.toString.call(e)===t}(e,"[object Object]")}function nr(e){return"string"==typeof e}function rr(e){return typeof e>"u"}const sr=e=>t=>tr(t)&&e in t&&!!t[e],ir=sr("isObject3D"),or=sr("isMesh"),ar=sr("isCamera"),lr=sr("isOrthographicCamera"),cr=sr("isPerspectiveCamera"),ur=sr("isColor"),hr=e=>e instanceof x,dr=sr("isBufferGeometry"),pr=sr("isMaterial"),mr=sr("isLight"),fr=sr("isFog"),gr=sr("isScene"),yr=e=>null!==e&&"object"==typeof e&&"set"in e&&"function"==typeof e.set,vr=e=>ar(e)||lr(e)||cr(e),xr=sr("isPrimitive"),br=e=>(e=>ir(e)||dr(e)||pr(e)||fr(e))(e)&&"__tres"in e,_r="[TresJS ▲ ■ ●] ";function wr(...e){"string"==typeof e[0]?e[0]=_r+e[0]:e.unshift(_r),console.error(...e)}function Tr(...e){"string"==typeof e[0]?e[0]=_r+e[0]:e.unshift(_r),console.warn(...e)}function Er(e){var t;"map"in(t=e)&&!!t.map&&e.map.dispose(),e.dispose()}function Sr(e){if(e.parent&&e.removeFromParent?.(),delete e.__tres,[...e.children].forEach(e=>Sr(e)),!(e instanceof n)){const t=e;e&&e.dispose?.(),t.geometry&&t.geometry.dispose(),Array.isArray(t.material)?t.material.forEach(e=>Er(e)):t.material&&Er(t.material)}}function Ar(e,t){let n=e;if(t.includes("-")){const e=t.split("-");let r=e.shift();for(;n&&e.length;)r in n?(n=n[r],r=e.shift()):r=Mr(r,e.shift());return{target:n,key:Mr(r,...e)}}return{target:n,key:t}}function Mr(...e){return e.map((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1)).join("")}function Or(e,t,n){const r=e;return r.__tres={type:"unknown",root:n,memoizedProps:{},objects:[],parent:null,previousAttach:null,...t},r.__tres.attach||(pr(r)?r.__tres.attach="material":dr(r)?r.__tres.attach="geometry":fr(r)&&(r.__tres.attach="fog")),r}function Cr(e){const t=e?.__tres?.root;t?.renderer&&t.renderer.canBeInvalidated.value&&t.renderer.invalidate()}function Nr(e){if(xr(e)){const t=e;return t.object.__tres=t.__tres,t.object}return e}function Pr(e,t){const n=e.__tres?.parent||t.scene.value;e.__tres&&(e.__tres.parent=null),n&&n.__tres&&"objects"in n.__tres&&((e,t)=>{let n=0;for(let r=0;r<e.length;r++)t(e[r],r)&&(e[n]=e[r],n++);e.length=n})(n.__tres.objects,t=>t!==e),e.__tres?.attach?function(e,t,n){if(nr(n)){const{target:r,key:s}=Ar(e,n),i=t.__tres.previousAttach;void 0===i?delete r[s]:r[s]=i,"__tresDetach"in r&&r.__tresDetach()}else t.__tres?.previousAttach?.(e,t);delete t.__tres?.previousAttach}(n,e,e.__tres.attach):(e.parent?.remove?.(Nr(e)),e.parent=null)}function Rr(e,t){e.traverse?.(e=>{vr(e)&&t.camera.deregisterCamera(e)}),vr(e)&&t.camera.deregisterCamera(e),Cr(e)}function Ir(e,t,n){const r=new e(n?.manager),s=jt({loaded:0,total:0,percentage:0});n?.extensions&&n.extensions(r);const i=Nt(t),o=Nn(e=>new Promise((t,n)=>{const o=e||i||"";r.load(o,e=>{t(e)},e=>{s.loaded=e.loaded,s.total=e.total,s.percentage=s.loaded/s.total*100},e=>{n(e)})}),n?.initialValue??null,{...n?.asyncOptions,immediate:n?.asyncOptions?.immediate??!0}),a=Ct(()=>Nt(t),e=>{if(e){const t=o.state.value;t&&"object"==typeof t&&"scene"in t&&t.scene&&Sr(t.scene),o.execute(0,e)}});return Pt(()=>{a();const e=o.state.value;e&&"object"==typeof e&&"scene"in e&&e.scene&&Sr(e.scene)}),{...o,load:e=>{o.execute(0,e)},progress:s}}function Lr(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),or(e)&&(t.meshes[e.name]||(t.meshes[e.name]=e),(Array.isArray(e.material)?e.material:[e.material]).forEach(e=>{e.name&&!t.materials[e.name]&&(t.materials[e.name]=e)}))}),t}function kr(){const e=new Map,t=new Set;let n=0,r=!1;const s=n=>{e.delete(n),t.delete(n)};return{on:(t,i=0)=>{e.set(t,{priority:i,addI:n++});const o=()=>s(t);return Cn(o),r=!0,{off:o}},off:s,trigger:(...n)=>(r&&((()=>{const n=Array.from(e.entries()).sort((e,t)=>{const n=e[1].priority-t[1].priority;return 0===n?e[1].addI-t[1].addI:n});t.clear(),n.forEach(e=>t.add(e[0]))})(),r=!1),Promise.all(Array.from(t).map(e=>e(...n)))),dispose:()=>{e.clear(),t.clear()},get count(){return e.size}}}const Dr=St({}),zr=e=>Object.assign(Dr.value,e);function Ur({scene:e,canvas:t,options:n,contextParts:{sizes:s,camera:i}}){const o=$n(n.renderer)?n.renderer({sizes:s,scene:e,camera:i,canvas:t}):new r({...n,canvas:zn(t)}),a=St("manual"===Nt(n.renderMode)?0:1),l=Yt(()=>"on-demand"===Nt(n.renderMode)&&0===a.value),c=()=>e.value.traverse(e=>{e instanceof p&&e.material instanceof I&&(e.material.needsUpdate=!0)}),u=(e=1)=>{l.value&&(a.value=Math.min(60,a.value+e))},h=()=>{if("manual"!==Nt(n.renderMode))throw new Error("advance can only be called in manual render mode.");a.value=1},d=Yt(()=>"always"===Nt(n.renderMode)),m=Un();let f=!1;(e=>tr(e)&&"isRenderer"in e&&!!e.isRenderer)(o)&&(o.init(),m.trigger(o));const g=Un(),y=()=>{a.value=d.value?1:Math.max(0,a.value-1),g.trigger(o)};let v=t=>{i.activeCamera.value&&(o.render(e.value,i.activeCamera.value),t())};const x=(e=>{const t=new P,n={before:Un(),after:Un()},{pause:r,resume:s,isActive:i}=Pn(()=>{const r=()=>({delta:t.getDelta(),elapsed:t.elapsedTime});n.before.trigger(r()),e(),n.after.trigger(r())},{immediate:!1});return{start:()=>{t.start(),s()},stop:()=>{t.stop(),r()},isActive:i,onBeforeLoop:n.before.on,onLoop:n.after.on}})(()=>{a.value&&v(y)});m.on(x.start),Ct([s.width,s.height],()=>{o.setSize(s.width.value,s.height.value),!f&&o.domElement.width&&o.domElement.height&&(m.trigger(o),f=!0),"on-demand"===Nt(n.renderMode)&&u()},{immediate:!0});const{pixelRatio:b}=Fn();Ut(()=>{((e,t,n)=>{if(!$n(e.setPixelRatio))return;let r=0;if(n&&Array.isArray(n)&&n.length>=2){const[e,s]=n;r=R.clamp(t,e,s)}else r=er(n)?n:t;r!==e.getPixelRatio?.()&&e.setPixelRatio(r)})(o,b.value,Nt(n.dpr))}),"on-demand"===Nt(n.renderMode)&&u(),"manual"===Nt(n.renderMode)&&Bn(100,{callback:h});const _=Yt(()=>{const e=Nt(n.clearColor),t=Nt(n.clearAlpha),r="string"==typeof e&&9===e.length&&e.startsWith("#");return r&&void 0!==t&&Tr(`clearColor with alpha (e.g. ${e}) and clearAlpha cannot both be set, using clearColor as source of truth`),r?{alpha:Number.parseInt(e.slice(7,9),16)/255,color:e.slice(0,7)}:{alpha:t,color:e}});return Ut(()=>{const e=_.value;void 0===e.color||void 0===e.alpha||o.setClearColor(e.color,e.alpha)}),Ut(()=>{const e=n.toneMapping;e&&(o.toneMapping=e)}),Ut(()=>{const e=n.toneMappingExposure;e&&(o.toneMappingExposure=e)}),Ut(()=>{const e=n.outputColorSpace;e&&(o.outputColorSpace=e)}),Ut(()=>{const e=n.shadows;void 0!==e&&(o.shadowMap.enabled=e,c())}),Ut(()=>{const e=n.shadowMapType;void 0!==e&&(o.shadowMap.type=e,c())}),Pt(()=>{o.dispose(),"forceContextLoss"in o&&o.forceContextLoss()}),{loop:x,instance:o,advance:h,onReady:m.on,onRender:g.on,invalidate:u,canBeInvalidated:l,mode:Nt(n.renderMode),replaceRenderFunction:e=>{v=e}}}class Fr{nativeEvent;NONE=0;CAPTURING_PHASE=1;AT_TARGET=2;BUBBLING_PHASE=3;relatedTarget=null;get altKey(){return this.getFromNative("altKey",!1)}get button(){return this.getFromNative("button",0)}get buttons(){return this.getFromNative("buttons",0)}get clientX(){return this.getFromNative("clientX",0)}get clientY(){return this.getFromNative("clientY",0)}get ctrlKey(){return this.getFromNative("ctrlKey",!1)}get layerX(){return this.getFromNative("layerX",0)}get layerY(){return this.getFromNative("layerY",0)}get metaKey(){return this.getFromNative("metaKey",!1)}get movementX(){return this.getFromNative("movementX",0)}get movementY(){return this.getFromNative("movementY",0)}get offsetX(){return this.getFromNative("offsetX",0)}get offsetY(){return this.getFromNative("offsetY",0)}get pageX(){return this.getFromNative("pageX",0)}get pageY(){return this.getFromNative("pageY",0)}get screenX(){return this.getFromNative("screenX",0)}get screenY(){return this.getFromNative("screenY",0)}get shiftKey(){return this.getFromNative("shiftKey",!1)}get x(){return this.getFromNative("x",0)}get y(){return this.getFromNative("y",0)}get detail(){return this.getFromNative("detail",0)}get view(){return this.getFromNative("view",null)}get which(){return this.getFromNative("which",0)}get cancelBubble(){return this.getFromNative("cancelBubble",!1)}get composed(){return this.getFromNative("composed",!1)}get eventPhase(){return this.getFromNative("eventPhase",0)}get isTrusted(){return this.getFromNative("isTrusted",!1)}get returnValue(){return this.getFromNative("returnValue",!1)}get timeStamp(){return this.getFromNative("timeStamp",0)}get cancelable(){return this.getFromNative("cancelable",!1)}get defaultPrevented(){return this.getFromNative("defaultPrevented",!1)}constructor(e){this.nativeEvent=e}getFromNative(e,t){return e in this.nativeEvent?this.nativeEvent[e]:t}}const Br=new b;let Vr=class e extends Fr{type;bubbles;internalPointer;intersection;camera;currentObject;object;propagationState;get pointerId(){return this.internalPointer.id}get pointerType(){return this.internalPointer.type}get pointerState(){return this.internalPointer.state}get distance(){return this.intersection.distance}get distanceToRay(){return this.intersection.distanceToRay}get point(){return this.intersection.point}get index(){return this.intersection.index}get face(){return this.intersection.face}get faceIndex(){return this.intersection.faceIndex}get uv(){return this.intersection.uv}get uv1(){return this.intersection.uv1}get normal(){return this.intersection.normal}get instanceId(){return this.intersection.instanceId}get pointOnLine(){return this.intersection.pointOnLine}get batchId(){return this.intersection.batchId}get pointerPosition(){return this.intersection.pointerPosition}get pointerQuaternion(){return this.intersection.pointerQuaternion}get pointOnFace(){return this.intersection.pointOnFace}get localPoint(){return this.intersection.localPoint}get details(){return this.intersection.details}get target(){return this.object}get currentTarget(){return this.currentObject}get eventObject(){return this.currentObject}get srcElement(){return this.currentObject}_pointer;get pointer(){return null==this._pointer&&(Br.copy(this.intersection.point).project(this.camera),this._pointer=new T(Br.x,Br.y)),this._pointer}_ray;get ray(){if(null!=this._ray)return this._ray;switch(this.intersection.details.type){case"screen-ray":case"ray":case"sphere":return this._ray=new M(this.intersection.pointerPosition,new b(0,0,-1).applyQuaternion(this.intersection.pointerQuaternion));case"lines":return this._ray=new M(this.intersection.details.line.start,this.intersection.details.line.end.clone().sub(this.intersection.details.line.start).normalize())}}_intersections=[];get intersections(){return null==this._intersections&&(this._intersections=[{...this.intersection,eventObject:this.currentObject}]),this._intersections}_unprojectedPoint;get unprojectedPoint(){if(null==this._unprojectedPoint){const e=this.pointer;this._unprojectedPoint=new b(e.x,e.y,0).unproject(this.camera)}return this._unprojectedPoint}get stopped(){return this.propagationState.stoppedImmediate||this.propagationState.stopped}get stoppedImmediate(){return this.propagationState.stoppedImmediate}get delta(){throw new Error("not supported")}constructor(e,t,n,r,s,i,o=s.object,a=o,l={stopped:!t,stoppedImmediate:!1}){super(n),this.type=e,this.bubbles=t,this.internalPointer=r,this.intersection=s,this.camera=i,this.currentObject=o,this.object=a,this.propagationState=l}stopPropagation(){this.propagationState.stopped=!0}stopImmediatePropagation(){this.propagationState.stoppedImmediate=!0}retarget(t){return new e(this.type,this.bubbles,this.nativeEvent,this.internalPointer,this.intersection,this.camera,t,this.target,this.propagationState)}},jr=class e extends Vr{get deltaX(){return this.nativeEvent.deltaX}get deltaY(){return this.nativeEvent.deltaY}get deltaZ(){return this.nativeEvent.deltaZ}constructor(e,t,n,r,s,i){super("wheel",!0,e,t,n,r,s,i)}retarget(t){return new e(this.nativeEvent,this.internalPointer,this.intersection,this.camera,t,this.target)}};function Hr(e){Yr(e,e.currentObject)}function Yr(e,t){if(null==t)return;const n=function(e,t){if(null!=e._listeners&&t in e._listeners)return e._listeners[t];let n;if(e.isVoidObject&&"click"===t&&null!=e.parent?.__r3f&&(n=e.parent.__r3f.root.getState().onPointerMissed),null!=e.__r3f&&(n=e.__r3f.handlers[Wr[t]]),null!=n)return[n]}(t,e.type);if(null!=n&&n.length>0){const r=e.retarget(t),s=n.length;for(let e=0;e<s&&!r.stoppedImmediate;e++)n[e](r)}e.stopped||Yr(e,t.parent)}const Wr={click:"onClick",contextmenu:"onContextMenu",dblclick:"onDoubleClick",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",pointerup:"onPointerUp",wheel:"onWheel"},Xr=Object.keys(Wr);const Gr=new _(1e10),qr=new Map;function Zr(e){let t=qr.get(e);return null==t&&(t=new p(Gr),t.isVoidObject=!0,t.parent=e,t.pointerEventsOrder=-1/0,qr.set(e,t)),t}function Kr(e,t){return t?!e:e}function Qr(e,t,n,r=!1,s,i,o){const a=r||function(e,t){if(t.ancestorsHaveListeners||"pointer"===e&&t.ancestorsHavePointerListeners||"wheel"===e&&t.ancestorsHaveWheelListeners||null!=t.__r3f&&t.__r3f?.eventCount>0&&("wheel"===e&&null!=t.__r3f.handlers.onWheel||"pointer"===e&&Object.keys(t.__r3f.handlers).some(e=>"onWheel"!=e)))return!0;if(null==t._listeners)return!1;if("wheel"===e){const e=t._listeners.wheel;return null!=e&&e.length>0}const n=Object.entries(t._listeners),r=n.length;for(let s=0;s<r;s++){const e=n[s];if("wheel"!==e[0]&&Xr.includes(e[0])&&null!=e[1]&&e[1].length>0)return!0}return!1}(e,t),l=t.pointerEvents??s,c=l??t.defaultPointerEvents??"listener",u=t.pointerEventsType??i??"all",h=t.pointerEventsOrder??o??0,d=function(e,t,n){if("none"===t||"listener"===t&&!e)return!1;if("all"===n)return!0;if("function"==typeof n)return({id:e,type:t,state:r})=>n(e,t,r);let r,s;return"deny"in n?(s=!0,r=n.deny):(s=!1,r=n.allow),Array.isArray(r)?e=>Kr(r.includes(e.type),s):e=>Kr(r===e.type,s)}(a,c,u),p=n.length;if(1===p)(!0===d||"function"==typeof d&&d(n[0]))&&Jr(n[0],t,c,u,h);else if(!0===d)for(let g=0;g<p;g++)Jr(n[g],t,c,u,h);else if("function"==typeof d)for(let g=0;g<p;g++){const e=n[g];d(e)&&Jr(e,t,c,u,h)}if(0===t.children.length||!1===t.intersectChildren)return;const m=t.interactableDescendants??t.children,f=m.length;for(let g=0;g<f;g++)Qr(e,m[g],n,a,l,u,h)}function Jr({intersector:e,options:t},n,r,s,i){!1!==t.filter?.(n,r,s,i)&&e.executeIntersection(n,i)}function $r(e,t=0,n,r=0){return t!=r?r-t:e.distance-n.distance}const es=1e7;const ts=Symbol("buttonsDownTime"),ns=Symbol("buttonsClickTime");function rs(e){return globalThis.pointerEventspointerMap?.get(e)}globalThis.pointerEventspointerMap??=new Map,y.prototype.setPointerCapture=function(e){rs(e)?.setCapture(this)},y.prototype.releasePointerCapture=function(e){const t=rs(e);null==t||!t.hasCaptured(this)||t.setCapture(void 0)},y.prototype.hasPointerCapture=function(e){return rs(e)?.hasCaptured(this)??!1};let ss=class{id;type;state;intersector;getCamera;onMoveCommited;parentSetPointerCapture;parentReleasePointerCapture;options;prevIntersection;intersection;prevEnabled=!0;enabled=!0;wheelIntersection;pointerEntered=[];pointerEnteredHelper=[];pointerCapture;buttonsDownTime=new Map;buttonsDown=new Set;wasMoved=!1;onFirstMove=[];constructor(e,t,n,r,s,i,o,a,l={}){this.id=e,this.type=t,this.state=n,this.intersector=r,this.getCamera=s,this.onMoveCommited=i,this.parentSetPointerCapture=o,this.parentReleasePointerCapture=a,this.options=l,globalThis.pointerEventspointerMap?.set(e,this)}getPointerCapture(){return this.pointerCapture}hasCaptured(e){return this.pointerCapture?.object===e}setCapture(e){this.pointerCapture?.object!==e&&(null!=this.pointerCapture&&(this.parentReleasePointerCapture?.(),this.pointerCapture=void 0),null!=e&&null!=this.intersection&&(this.pointerCapture={object:e,intersection:this.intersection},this.parentSetPointerCapture?.()))}getButtonsDown(){return this.buttonsDown}getIntersection(){return this.intersection}getEnabled(){return this.enabled}setEnabled(e,t,n=!0){this.enabled!==e&&(!e&&null!=this.pointerCapture&&(this.parentReleasePointerCapture?.(),this.pointerCapture=void 0),this.enabled=e,n&&this.commit(t,!1))}computeIntersection(e,t,n){return null!=this.pointerCapture?this.intersector.intersectPointerCapture(this.pointerCapture,n):(this.intersector.startIntersection(n),Qr(e,t,[this]),this.intersector.finalizeIntersection(t))}setIntersection(e){this.intersection=e}commit(e,t){const n=this.getCamera(),r=this.prevEnabled?this.prevIntersection:void 0,s=this.enabled?this.intersection:void 0;null!=r&&r.object!=s?.object&&Hr(new Vr("pointerout",!0,e,this,r,n));const i=this.pointerEntered;this.pointerEntered=[],this.pointerEnteredHelper.length=0,is(s?.object,this.pointerEntered,i,this.pointerEnteredHelper);const o=i.length;for(let a=0;a<o;a++){const t=i[a];Hr(new Vr("pointerleave",!1,e,this,r,n,t))}null!=s&&r?.object!=s.object&&Hr(new Vr("pointerover",!0,e,this,s,n));for(let a=this.pointerEnteredHelper.length-1;a>=0;a--){const t=this.pointerEnteredHelper[a];Hr(new Vr("pointerenter",!1,e,this,s,n,t))}if(t&&null!=s&&Hr(new Vr("pointermove",!0,e,this,s,n)),this.prevIntersection=this.intersection,this.prevEnabled=this.enabled,!this.wasMoved&&this.intersector.isReady()){this.wasMoved=!0;const e=this.onFirstMove.length;for(let t=0;t<e;t++)this.onFirstMove[t](n);this.onFirstMove.length=0}this.onMoveCommited?.(this)}move(e,t){this.intersection=this.computeIntersection("pointer",e,t),this.commit(t,!0)}emitMove(e){null!=this.intersection&&Hr(new Vr("pointermove",!0,e,this,this.intersection,this.getCamera()))}down(e){if(this.buttonsDown.add(e.button),!this.enabled)return;if(!this.wasMoved)return void this.onFirstMove.push(this.down.bind(this,e));if(null==this.intersection)return;Hr(new Vr("pointerdown",!0,e,this,this.intersection,this.getCamera()));const{object:t}=this.intersection;t[ts]??=new Map,t[ts].set(e.button,e.timeStamp),this.buttonsDownTime.set(e.button,e.timeStamp)}up(e){if(this.buttonsDown.delete(e.button),!this.enabled)return;if(!this.wasMoved)return void this.onFirstMove.push(this.up.bind(this,e));if(null==this.intersection)return;const{clickThesholdMs:t,contextMenuButton:n=2,dblClickThresholdMs:r=500,clickThresholdMs:s=t??300}=this.options;this.pointerCapture=void 0;const i=function(e,t,n,r,s){if(null==t)return!1;const i=t.get(n);return!(null==i||r-i>s||i!=e.get(n))}(this.buttonsDownTime,this.intersection.object[ts],e.button,e.timeStamp,s),o=this.getCamera();if(i&&e.button===n&&Hr(new Vr("contextmenu",!0,e,this,this.intersection,o)),Hr(new Vr("pointerup",!0,e,this,this.intersection,o)),!i||e.button===n)return;Hr(new Vr("click",!0,e,this,this.intersection,o));const{object:a}=this.intersection,l=a[ns]??=new Map,c=l.get(e.button);null==c||e.timeStamp-c>r?l.set(e.button,e.timeStamp):(Hr(new Vr("dblclick",!0,e,this,this.intersection,o)),l.delete(e.button))}cancel(e){if(this.enabled){if(!this.wasMoved)return void this.onFirstMove.push(this.cancel.bind(this,e));null!=this.intersection&&Hr(new Vr("pointercancel",!0,e,this,this.intersection,this.getCamera()))}}wheel(e,t,n=!1){if(!this.enabled)return;if(!this.wasMoved&&n)return void this.onFirstMove.push(this.wheel.bind(this,e,t,n));n||(this.wheelIntersection=this.computeIntersection("wheel",e,t));const r=n?this.intersection:this.wheelIntersection;null!=r&&Hr(new jr(t,this,r,this.getCamera()))}emitWheel(e,t=!1){if(!this.enabled)return;if(!this.wasMoved&&t)return void this.onFirstMove.push(this.emitWheel.bind(this,e,t));const n=t?this.intersection:this.wheelIntersection;null!=n&&Hr(new jr(e,this,n,this.getCamera()))}exit(e){this.wasMoved&&(null!=this.pointerCapture&&(this.parentReleasePointerCapture?.(),this.pointerCapture=void 0),this.intersection=void 0,this.commit(e,!1)),this.onFirstMove.length=0,this.wasMoved=!1}};function is(e,t,n,r){if(null==e)return;const s=n.indexOf(e);-1!=s?n.splice(s,1):r.push(e),t.push(e),is(e.parent,t,n,r)}const os=new w,as=new w,ls=new T,cs=new T,us=new T,hs=new b,ds=new E,ps=new b;function ms(e,t,n){ps.copy(t).applyMatrix4(ds.copy(n.matrixWorld).invert());const r=n.geometry.attributes.uv;if(null==r||!(r instanceof v))return!1;let s;return function(e,t){const n=e.geometry.drawRange;if(null!=e.geometry.index){const r=e.geometry.index,s=Math.max(0,n.start),i=Math.min(r.count,n.start+n.count);for(let e=s;e<i;e+=3)t(r.getX(e),r.getX(e+1),r.getX(e+2));return}const r=e.geometry.attributes.position;if(null==r)return;const s=Math.max(0,n.start),i=Math.min(r.count,n.start+n.count);for(let o=s;o<i;o+=3)t(o,o+1,o+2)}(n,(e,t,i)=>{n.getVertexPosition(e,os.a),n.getVertexPosition(t,os.b),n.getVertexPosition(i,os.c);const o=os.closestPointToPoint(ps,hs).distanceTo(ps);null!=s&&o>=s||(s=o,as.copy(os),ls.fromBufferAttribute(r,e),cs.fromBufferAttribute(r,t),us.fromBufferAttribute(r,i))}),null!=s&&(as.closestPointToPoint(ps,hs),as.getInterpolation(hs,ls,cs,us,e),!0)}new E,new S,new b,new A,new M,new T,new b(0,0,0),new b(0,0,1);const fs=new E,gs=new b;new b(0,0,-1),new A;const ys=new T,vs=new b;class xs{prepareTransformation;options;raycaster=new L;cameraQuaternion=new k;fromPosition=new b;fromQuaternion=new k;coords=new T;viewPlane=new A;intersects=[];pointerEventsOrders=[];constructor(e,t){this.prepareTransformation=e,this.options=t}isReady(){return!0}intersectPointerCapture({intersection:e,object:t},n){const r=e.details;if("screen-ray"!=r.type)throw new Error(`unable to process a pointer capture of type "${e.details.type}" with a camera ray intersector`);if(!this.startIntersection(n))return e;this.viewPlane.constant-=r.distanceViewPlane;const s=this.raycaster.ray.intersectPlane(this.viewPlane,new b);if(null==s)return e;e.object.updateWorldMatrix(!0,!1),function(e,t,n){const r=t.normal??t.face?.normal;null!=r&&(e.setFromNormalAndCoplanarPoint(r,t.localPoint),e.applyMatrix4(n))}(this.viewPlane,e,e.object.matrixWorld);let i=e.uv;return e.object instanceof p&&ms(ys,s,e.object)&&(i=ys.clone()),{...e,details:{...r,direction:this.raycaster.ray.direction.clone(),screenPoint:this.coords.clone()},uv:i,object:t,point:s,pointOnFace:s,pointerPosition:this.raycaster.ray.origin.clone(),pointerQuaternion:this.cameraQuaternion.clone()}}startIntersection(e){const t=this.prepareTransformation(e,this.coords);return null!=t&&(t.updateWorldMatrix(!0,!1),t.matrixWorld.decompose(this.fromPosition,this.fromQuaternion,gs),this.raycaster.setFromCamera(this.coords,t),this.viewPlane.setFromNormalAndCoplanarPoint(t.getWorldDirection(vs),this.raycaster.ray.origin),!0)}executeIntersection(e,t){const n=this.intersects.length;e.raycast(this.raycaster,this.intersects),function(e,t,n){for(;n>0;)e.push(t),--n}(this.pointerEventsOrders,t,this.intersects.length-n)}finalizeIntersection(e){const t=this.fromPosition.clone(),n=this.cameraQuaternion.clone(),r=this.raycaster.ray.direction.clone(),s=function(e,t,{customSort:n=$r}={}){let r,s,i;const o=e.length;for(let a=0;a<o;a++){const o=e[a],l=t?.[a];(null==r||n(o,l,r,s)<0)&&(i=a,r=o,s=l)}return i}(this.intersects,this.pointerEventsOrders,this.options),i=null==s?void 0:this.intersects[s];return this.intersects.length=0,this.pointerEventsOrders.length=0,null==i?function(e,t,n,r,s,i=0){const o=t.direction.clone().multiplyScalar(es),a=es;return{distance:a+i,object:Zr(e),point:o,normal:t.origin.clone().sub(o).normalize(),details:n(o,a),pointerPosition:r,pointerQuaternion:s,pointOnFace:o,localPoint:o}}(e,this.raycaster.ray,(e,t)=>({type:"screen-ray",distanceViewPlane:t,screenPoint:this.coords.clone(),direction:r}),t,n):(i.object.updateWorldMatrix(!0,!1),fs.copy(i.object.matrixWorld).invert(),Object.assign(i,{details:{type:"screen-ray",distanceViewPlane:this.viewPlane.distanceToPoint(i.point),screenPoint:this.coords.clone(),direction:r},pointOnFace:i.point,pointerPosition:t,pointerQuaternion:n,localPoint:i.point.clone().applyMatrix4(fs)}))}}new b,new T,new E,new b,new A,new O,new b,new b,new b,new b(1e-4,1e-4,1e-4),new E;let bs=23412;function _s(e,t,n){if(!(t instanceof globalThis.MouseEvent))return n.set(0,0);const{width:r,height:s,top:i,left:o}=e.getBoundingClientRect(),a=t.clientX-o,l=t.clientY-i;return n.set(a/r*2-1,-l/s*2+1)}function ws(e,t,n,r){return function(e,t,n,r,s,i,o={}){const a=o?.forwardPointerCapture??!0,l=new Map,c=o.pointerTypePrefix??"forward-",u=(e,u)=>{let h=l.get(e.pointerId);return null!=h||(h=new ss(bs++,`${c}${e.pointerType}`,e.pointerState,new xs((e,n)=>(r(e,n),t()),o),t,void 0,a?s.bind(null,e.pointerId):void 0,a?i.bind(null,e.pointerId):void 0,o),"move"!=u&&"wheel"!=u&&(h.setIntersection(h.computeIntersection("pointer",n,e)),h.commit(e,!1)),l.set(e.pointerId,h)),h},h=new Map,d=new Map,p=[],m=[],f=(e,t,r)=>{switch(e){case"move":return void r.move(n,t);case"wheel":return void r.wheel(n,t);case"cancel":return void r.cancel(t);case"down":if(!Ts(t))return;return void r.down(t);case"up":if(!Ts(t))return;return void r.up(t);case"exit":return d.delete(r),h.delete(r),void r.exit(t)}},g=(e,t)=>{const n=u(t,e);"move"===e&&d.set(n,t),"wheel"===e&&h.set(n,t),o.batchEvents??1?m.push({type:e,event:t}):f(e,t,n)},y=g.bind(null,"move"),v=g.bind(null,"cancel"),x=g.bind(null,"down"),b=g.bind(null,"up"),_=g.bind(null,"wheel"),w=g.bind(null,"exit");return e.addEventListener("pointermove",y),e.addEventListener("pointercancel",v),e.addEventListener("pointerdown",x),e.addEventListener("pointerup",b),e.addEventListener("wheel",_),e.addEventListener("pointerleave",w),{destroy(){e.removeEventListener("pointermove",y),e.removeEventListener("pointercancel",v),e.removeEventListener("pointerdown",x),e.removeEventListener("pointerup",b),e.removeEventListener("wheel",_),e.removeEventListener("pointerleave",w),d.clear(),h.clear()},update(){const e=m.length;for(let t=0;t<e;t++){const{type:e,event:n}=m[t],r=u(n,e);"move"!==e||(p.push(r),d.get(r)==n)?"wheel"!==e||h.get(r)==n?f(e,n,r):r.emitWheel(n):r.emitMove(n)}if(m.length=0,o.intersectEveryFrame)for(const[t,r]of d.entries())p.includes(t)||t.move(n,r);p.length=0}}}(e,"function"==typeof t?t:()=>t,n,_s.bind(null,e),e.setPointerCapture.bind(e),t=>{e.hasPointerCapture(t)&&e.releasePointerCapture(t)},{pointerTypePrefix:"screen-",...r})}function Ts(e){return null!=e.button}const[Es,Ss]=Mn(({scene:e,canvas:t,windowSize:n,rendererOptions:r})=>{const s=At(e),i=function(e,t,n=10){const r=Nt(e)?Ln():kn(Yt(()=>Nt(t).parentElement)),s=Wt(Dn(r.width,n)),i=Wt(Dn(r.height,n)),o=Yt(()=>s.value/i.value);return{height:i,width:s,aspectRatio:o}}(n,t),o=(({sizes:e})=>{const t=St([]),n=Yt(()=>t.value[0]),r=e=>{const n=ar(e)?e:t.value.find(t=>t.uuid===e);if(!n)return;const r=t.value.filter(({uuid:e})=>e!==n.uuid);t.value=[n,...r]};return Ut(()=>{e.aspectRatio.value&&t.value.forEach(t=>{cr(t)&&(t.aspect=e.aspectRatio.value,t.updateProjectionMatrix())})}),{activeCamera:n,cameras:t,registerCamera:(e,n=!1)=>{t.value.some(({uuid:t})=>t===e.uuid)||(t.value.push(e),n&&r(e.uuid))},deregisterCamera:e=>{t.value=t.value.filter(({uuid:t})=>t!==e.uuid)},setActiveCamera:r}})({sizes:i}),a=Ur({scene:s,canvas:t,options:r,contextParts:{sizes:i,camera:o}}),l=function({canvas:e,contextParts:{scene:t,camera:n,renderer:r}}){const{update:s,destroy:i}=ws(Nt(e),()=>Nt(n.activeCamera),t.value),{off:o}=r.loop.onLoop(s);Pt(i),Pt(o);const a=Zr(t.value),l=Un();return a.addEventListener("click",l.trigger),{onPointerMissed:l.on}}({canvas:t,contextParts:{scene:s,camera:o,renderer:a}}),c={sizes:i,scene:s,camera:o,renderer:a,controls:St(null),extend:zr,events:l};return c.scene.value.__tres={root:c},c},{injectionKey:"useTres"}),As=()=>{const e=Ss();if(!e)throw new Error("useTresContext must be used together with useTresContextProvider.\n You probably tried to use it above or on the same level as a TresCanvas component.\n It should be used in child components of a TresCanvas instance.");return e};function Ms(){const{scene:e,renderer:t,camera:n,sizes:r,controls:s,extend:i,events:o}=As();return{scene:e,renderer:t.instance,camera:n.activeCamera,sizes:r,controls:s,extend:i,events:o,invalidate:t.invalidate,advance:t.advance}}const Os=()=>{const e=Ms(),{renderer:t}=As(),n=kr(),r=kr();t.loop.onBeforeLoop(t=>{n.trigger({...e,...t})}),t.loop.onLoop(t=>{r.trigger({...e,...t})});const s=t.replaceRenderFunction;return{stop:t.loop.stop,start:t.loop.start,isActive:t.loop.isActive,onBeforeRender:n.on,onRender:r.on,render:s}};const Cs=["onClick","onContextmenu","onPointermove","onPointerenter","onPointerleave","onPointerover","onPointerout","onDblclick","onPointerdown","onPointerup","onPointercancel","onLostpointercapture","onWheel"],Ns={onClick:"click",onContextmenu:"contextmenu",onPointermove:"pointermove",onPointerenter:"pointerenter",onPointerleave:"pointerleave",onPointerover:"pointerover",onPointerout:"pointerout",onDblclick:"dblclick",onPointerdown:"pointerdown",onPointerup:"pointerup",onPointercancel:"pointercancel",onLostpointercapture:"lostpointercapture",onWheel:"wheel"},Ps=e=>Cs.includes(e),Rs=e=>{const t=e.scene.value;function n(n,r){if(!n)return;r=r||t;const s=n.__tres?n:Or(n,{},e),i=r.__tres?r:Or(r,{},e);n=Nr(s),r=Nr(i),vr(n)&&e.camera?.registerCamera(n),s.__tres.attach?function(e,t,n){const r=/-\d+$/;if(nr(n)){if(r.test(n)){const t=n.replace(r,""),{target:s,key:i}=Ar(e,t);if(!Array.isArray(s[i])){const e=s[i],t=[];t.__tresDetach=()=>{t.every(e=>rr(e))&&(s[i]=e)},s[i]=t}}const{target:s,key:i}=Ar(e,n);t.__tres.previousAttach=s[i],s[i]=Nr(t)}else t.__tres.previousAttach=n(e,t)}(i,s,s.__tres.attach):ir(n)&&ir(i)&&(i.add(n),n.dispatchEvent({type:"added"})),s.__tres.parent=i,i.__tres.objects&&!i.__tres.objects.includes(s)&&i.__tres.objects.push(s)}function r(t,n){if(!t)return;n=rr(n)?"default":n;const s=t.__tres?.dispose;rr(s)||(n=null!==s&&s);const i=t.__tres?.primitive,o="default"===n?!i:!!n;if(t.__tres&&"objects"in t.__tres&&[...t.__tres.objects].forEach(e=>r(e,n)),o&&t.children&&[...t.children].forEach(e=>r(e,n)),Pr(t,e),Rr(t,e),o&&!gr(t))if($n(n))n(t);else if($n(t.dispose))try{t.dispose()}catch{}"__tres"in t&&delete t.__tres}function s(t,s,i,o){if(!t)return;let a=t;const l=s;if(t.__tres&&(t.__tres.memoizedProps[s]=o),"attach"===s){const s=t.__tres?.parent||t.parent;return r(t),Or(t,{attach:o},e),void(s&&n(t,s))}if("dispose"===s)return t.__tres||(t=Or(t,{},e)),void(t.__tres.dispose=o);Ps(s)&&$n(o)&&t.addEventListener(Ns[s],o);let c=Kn(l),u=a?.[c];if("args"===l){const e=t,n=i??[],r=o??[],s=t.__tres?.type||t.type;if(s&&n.length&&!Jn(n,r)){const t=new Dr.value[s](...o),n=Object.getOwnPropertyDescriptors(t);Object.entries(n).forEach(([n,r])=>{if((r.writable||r.set)&&n in e)try{e[n]=t[n]}catch(NT){console.warn(`Could not set property ${n} on ${s}:`,NT)}}),a=e}return}if("BufferGeometry"===a.type){if("args"===l)return;return void a.setAttribute(Kn(l),new v(...o))}if(l.includes("-")&&void 0===u){const e=Ar(a,l);if(u=e.target,a=e.target,c=e.key,u&&c)return u[c]=o,vr(t)&&t.updateProjectionMatrix(),void Cr(t)}let h=o;if(""===h&&(h=!0),$n(u))return Ps(s)||(Array.isArray(h)?t[c](...h):t[c](h)),void(c.startsWith("on")&&$n(h)&&(a[c]=h));hr(u)&&hr(h)?u.mask=h.mask:ur(u)&&(e=>nr(e)||er(e)||ur(e))(h)?u.set(h):(e=>yr(e)&&"copy"in e&&"function"==typeof e.copy)(u)&&(e=>!!e?.constructor)(h)&&u.constructor===h.constructor?u.copy(h):yr(u)&&Array.isArray(h)?"fromArray"in u&&"function"==typeof u.fromArray?u.fromArray(h):u.set(...h):yr(u)&&"number"==typeof h?"setScalar"in u&&"function"==typeof u.setScalar?u.setScalar(h):u.set(h):a[c]=h,vr(t)&&t.updateProjectionMatrix(),Cr(t)}function i(e){return e?.__tres?.parent||null}const o=()=>{};return{insert:n,remove:r,createElement:function(t,i,o,a){if(a||(a={}),a.args||(a.args=[]),Zn(t))return null;t.includes("-")&&(t=t.replace(/-([a-z])/g,(e,t)=>t.toUpperCase()).replace(/^[a-z]/,e=>e.toUpperCase()));let l,c=t.replace("Tres","");if("primitive"===t){(!tr(a.object)||Ht(a.object))&&wr("Tres primitives need an 'object' prop, whose value is an object or shallowRef<object>"),c=a.object.type;const t={};l=function(e,t={},n={}){let r=e;const s=e=>{r=e};let i=new Proxy({},{});return i=new Proxy({},{has:(e,n)=>n in t||n in r,get:(e,n,s)=>n in t?t[n](r):r[n],set:(e,t,o)=>(n[t]?n[t](o,r,i,s):r[t]=o,!0)}),i}(a.object,{object:e=>e,isPrimitive:()=>!0,__tres:()=>t},{object:(t,i,o,a)=>{!function(e,t,n,r,s){const i=[...t.__tres.objects],o=Nr(t);if(o===(e=Nr(e)))return!0;const a=Or(e,t.__tres??{},s),l=t.parent??t.__tres.parent??null,c={...t.__tres.memoizedProps};delete c.object;for(const u of i)Pr(u,s),Rr(u,s);o.__tres.objects=[],r.remove(t);for(const[u,h]of Object.entries(c))r.patchProp(a,u,a[u],h);n(e),r.insert(t,l);for(const u of i)r.insert(u,t)}(t,o,a,{patchProp:s,remove:r,insert:n},e)},__tres:e=>{Object.assign(t,e)}})}else{const e=Dr.value[c];e||wr(`${c} is not defined on the THREE namespace. Use extend to add it to the catalog.`),l=new e(...a.args)}return l?(vr(l)&&(a?.position||l.position.set(3,3,3),a?.lookAt||l.lookAt(0,0,0)),l=Or(l,{...br(l)?l.__tres:{},type:c,memoizedProps:a,primitive:"primitive"===t,attach:a.attach},e),l):null},patchProp:s,parentNode:i,createText:o,createComment:function(t){const n=Or(new y,{type:"Comment"},e);return n.name=t,n},setText:o,setElementText:o,nextSibling:function(e){const t=i(e)?.__tres?.objects||[],n=t.indexOf(e);return n<0||n>=t.length-1?null:t[n+1]},querySelector:o,setScopeId:o,cloneNode:o,insertStaticContent:o}},Is=["asset-load"];class Ls{subscribers=new Set;messageQueue=[];maxQueueSize=100;send(e,t){const n={type:e,data:t,timestamp:Date.now()};this.subscribers.size>0?this.subscribers.forEach(e=>e(n)):Is.includes(e)&&this.queueMessage(n)}queueMessage(e){this.messageQueue.push(e),this.messageQueue.length>this.maxQueueSize&&this.messageQueue.shift()}flushQueue(){0===this.messageQueue.length||0===this.subscribers.size||(this.messageQueue.forEach(e=>{this.subscribers.forEach(t=>t(e))}),this.messageQueue=[])}subscribe(e){return this.subscribers.add(e),this.flushQueue(),()=>{this.subscribers.delete(e)}}get hasSubscribers(){return this.subscribers.size>0}get queueSize(){return this.messageQueue.length}clearQueue(){this.messageQueue=[]}}var ks,Ds,zs=Object.create,Us=Object.defineProperty,Fs=Object.getOwnPropertyDescriptor,Bs=Object.getOwnPropertyNames,Vs=Object.getPrototypeOf,js=Object.prototype.hasOwnProperty,Hs=(ks={"../../node_modules/.pnpm/tsup@8.4.0_@microsoft+api-extractor@7.51.1_@types+node@22.13.14__jiti@2.4.2_postcss@8.5_96eb05a9d65343021e53791dd83f3773/node_modules/tsup/assets/esm_shims.js"(){}},function(){return ks&&(Ds=(0,ks[Bs(ks)[0]])(ks=0)),Ds}),Ys=((e,t)=>function(){return t||(0,e[Bs(e)[0]])((t={exports:{}}).exports,t),t.exports})({"../../node_modules/.pnpm/rfdc@1.4.1/node_modules/rfdc/index.js"(e,t){function n(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}Hs(),t.exports=function(e){if((e=e||{}).circles)return function(e){const t=[],r=[],s=new Map;if(s.set(Date,e=>new Date(e)),s.set(Map,(e,t)=>new Map(o(Array.from(e),t))),s.set(Set,(e,t)=>new Set(o(Array.from(e),t))),e.constructorHandlers)for(const n of e.constructorHandlers)s.set(n[0],n[1]);let i=null;return e.proto?l:a;function o(e,o){const a=Object.keys(e),l=new Array(a.length);for(let c=0;c<a.length;c++){const u=a[c],h=e[u];if("object"!=typeof h||null===h)l[u]=h;else if(h.constructor!==Object&&(i=s.get(h.constructor)))l[u]=i(h,o);else if(ArrayBuffer.isView(h))l[u]=n(h);else{const e=t.indexOf(h);l[u]=-1!==e?r[e]:o(h)}}return l}function a(e){if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return o(e,a);if(e.constructor!==Object&&(i=s.get(e.constructor)))return i(e,a);const l={};t.push(e),r.push(l);for(const o in e){if(!1===Object.hasOwnProperty.call(e,o))continue;const c=e[o];if("object"!=typeof c||null===c)l[o]=c;else if(c.constructor!==Object&&(i=s.get(c.constructor)))l[o]=i(c,a);else if(ArrayBuffer.isView(c))l[o]=n(c);else{const e=t.indexOf(c);l[o]=-1!==e?r[e]:a(c)}}return t.pop(),r.pop(),l}function l(e){if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return o(e,l);if(e.constructor!==Object&&(i=s.get(e.constructor)))return i(e,l);const a={};t.push(e),r.push(a);for(const o in e){const c=e[o];if("object"!=typeof c||null===c)a[o]=c;else if(c.constructor!==Object&&(i=s.get(c.constructor)))a[o]=i(c,l);else if(ArrayBuffer.isView(c))a[o]=n(c);else{const e=t.indexOf(c);a[o]=-1!==e?r[e]:l(c)}}return t.pop(),r.pop(),a}}(e);const t=new Map;if(t.set(Date,e=>new Date(e)),t.set(Map,(e,t)=>new Map(s(Array.from(e),t))),t.set(Set,(e,t)=>new Set(s(Array.from(e),t))),e.constructorHandlers)for(const n of e.constructorHandlers)t.set(n[0],n[1]);let r=null;return e.proto?function e(i){if("object"!=typeof i||null===i)return i;if(Array.isArray(i))return s(i,e);if(i.constructor!==Object&&(r=t.get(i.constructor)))return r(i,e);const o={};for(const s in i){const a=i[s];"object"!=typeof a||null===a?o[s]=a:a.constructor!==Object&&(r=t.get(a.constructor))?o[s]=r(a,e):ArrayBuffer.isView(a)?o[s]=n(a):o[s]=e(a)}return o}:function e(i){if("object"!=typeof i||null===i)return i;if(Array.isArray(i))return s(i,e);if(i.constructor!==Object&&(r=t.get(i.constructor)))return r(i,e);const o={};for(const s in i){if(!1===Object.hasOwnProperty.call(i,s))continue;const a=i[s];"object"!=typeof a||null===a?o[s]=a:a.constructor!==Object&&(r=t.get(a.constructor))?o[s]=r(a,e):ArrayBuffer.isView(a)?o[s]=n(a):o[s]=e(a)}return o};function s(e,s){const i=Object.keys(e),o=new Array(i.length);for(let a=0;a<i.length;a++){const l=i[a],c=e[l];"object"!=typeof c||null===c?o[l]=c:c.constructor!==Object&&(r=t.get(c.constructor))?o[l]=r(c,s):ArrayBuffer.isView(c)?o[l]=n(c):o[l]=s(c)}return o}}}});Hs(),Hs(),Hs();var Ws,Xs=typeof navigator<"u",Gs=typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof global<"u"?global:{};typeof Gs.chrome<"u"&&Gs.chrome.devtools,Xs&&(Gs.self,Gs.top),typeof navigator<"u"&&(null==(Ws=navigator.userAgent)||Ws.toLowerCase().includes("electron")),Hs();var qs=((e,t,n)=>(n=null!=e?zs(Vs(e)):{},((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of Bs(t))!js.call(e,s)&&s!==n&&Us(e,s,{get:()=>t[s],enumerable:!(r=Fs(t,s))||r.enumerable});return e})(Us(n,"default",{value:e,enumerable:!0}),e)))(Ys()),Zs=/(?:^|[-_/])(\w)/g;function Ks(e,t){return t?t.toUpperCase():""}var Qs=(0,qs.default)({circles:!0});const Js={trailing:!0};function $s(e,t=25,n={}){if(n={...Js,...n},!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let r,s,i,o,a=[];const l=(t,r)=>(i=async function(e,t,n){return await e.apply(t,n)}(e,t,r),i.finally(()=>{if(i=null,n.trailing&&o&&!s){const e=l(t,o);return o=null,e}}),i);return function(...e){return i?(n.trailing&&(o=e),i):new Promise(i=>{const o=!s&&n.leading;clearTimeout(s),s=setTimeout(()=>{s=null;const t=n.leading?r:l(this,e);for(const e of a)e(t);a=[]},t),o?(r=l(this,e),i(r)):a.push(i)})}}function ei(e,t={},n){for(const r in e){const s=e[r],i=n?`${n}:${r}`:r;"object"==typeof s&&null!==s?ei(s,t,i):"function"==typeof s&&(t[i]=s)}return t}const ti={run:e=>e()},ni=typeof console.createTask<"u"?console.createTask:()=>ti;function ri(e,t){const n=t.shift(),r=ni(n);return e.reduce((e,n)=>e.then(()=>r.run(()=>n(...t))),Promise.resolve())}function si(e,t){const n=t.shift(),r=ni(n);return Promise.all(e.map(e=>r.run(()=>e(...t))))}function ii(e,t){for(const n of[...e])n(t)}class oi{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,t,n={}){if(!e||"function"!=typeof t)return()=>{};const r=e;let s;for(;this._deprecatedHooks[e];)s=this._deprecatedHooks[e],e=s.to;if(s&&!n.allowDeprecated){let e=s.message;e||(e=`${r} hook has been deprecated`+(s.to?`, please use ${s.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(e)||(console.warn(e),this._deprecatedMessages.add(e))}if(!t.name)try{Object.defineProperty(t,"name",{get:()=>"_"+e.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(t),()=>{t&&(this.removeHook(e,t),t=void 0)}}hookOnce(e,t){let n,r=(...e)=>("function"==typeof n&&n(),n=void 0,r=void 0,t(...e));return n=this.hook(e,r),n}removeHook(e,t){if(this._hooks[e]){const n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1),0===this._hooks[e].length&&delete this._hooks[e]}}deprecateHook(e,t){this._deprecatedHooks[e]="string"==typeof t?{to:t}:t;const n=this._hooks[e]||[];delete this._hooks[e];for(const r of n)this.hook(e,r)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const t in e)this.deprecateHook(t,e[t])}addHooks(e){const t=ei(e),n=Object.keys(t).map(e=>this.hook(e,t[e]));return()=>{for(const e of n.splice(0,n.length))e()}}removeHooks(e){const t=ei(e);for(const n in t)this.removeHook(n,t[n])}removeAllHooks(){for(const e in this._hooks)delete this._hooks[e]}callHook(e,...t){return t.unshift(e),this.callHookWith(ri,e,...t)}callHookParallel(e,...t){return t.unshift(e),this.callHookWith(si,e,...t)}callHookWith(e,t,...n){const r=this._before||this._after?{name:t,args:n,context:{}}:void 0;this._before&&ii(this._before,r);const s=e(t in this._hooks?[...this._hooks[t]]:[],n);return s instanceof Promise?s.finally(()=>{this._after&&r&&ii(this._after,r)}):(this._after&&r&&ii(this._after,r),s)}beforeEach(e){return this._before=this._before||[],this._before.push(e),()=>{if(void 0!==this._before){const t=this._before.indexOf(e);-1!==t&&this._before.splice(t,1)}}}afterEach(e){return this._after=this._after||[],this._after.push(e),()=>{if(void 0!==this._after){const t=this._after.indexOf(e);-1!==t&&this._after.splice(t,1)}}}}function ai(){return new oi}var li,ci=Object.create,ui=Object.defineProperty,hi=Object.getOwnPropertyDescriptor,di=Object.getOwnPropertyNames,pi=Object.getPrototypeOf,mi=Object.prototype.hasOwnProperty,fi=(e,t)=>function(){return t||(0,e[di(e)[0]])((t={exports:{}}).exports,t),t.exports},gi=((e,t)=>function(){return e&&(t=(0,e[di(e)[0]])(e=0)),t})({"../../node_modules/.pnpm/tsup@8.4.0_@microsoft+api-extractor@7.51.1_@types+node@22.13.14__jiti@2.4.2_postcss@8.5_96eb05a9d65343021e53791dd83f3773/node_modules/tsup/assets/esm_shims.js"(){}}),yi=fi({"../../node_modules/.pnpm/speakingurl@14.0.1/node_modules/speakingurl/lib/speakingurl.js"(e,t){gi(),function(e){var n={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"Ae","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"Oe","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"Ue","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"ae","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"oe","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"ue","ű":"u","ý":"y","þ":"th","ÿ":"y","ẞ":"SS","ا":"a","أ":"a","إ":"i","آ":"aa","ؤ":"u","ئ":"e","ء":"a","ب":"b","ت":"t","ث":"th","ج":"j","ح":"h","خ":"kh","د":"d","ذ":"th","ر":"r","ز":"z","س":"s","ش":"sh","ص":"s","ض":"dh","ط":"t","ظ":"z","ع":"a","غ":"gh","ف":"f","ق":"q","ك":"k","ل":"l","م":"m","ن":"n","ه":"h","و":"w","ي":"y","ى":"a","ة":"h","ﻻ":"la","ﻷ":"laa","ﻹ":"lai","ﻵ":"laa","گ":"g","چ":"ch","پ":"p","ژ":"zh","ک":"k","ی":"y","َ":"a","ً":"an","ِ":"e","ٍ":"en","ُ":"u","ٌ":"on","ْ":"","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","က":"k","ခ":"kh","ဂ":"g","ဃ":"ga","င":"ng","စ":"s","ဆ":"sa","ဇ":"z","စျ":"za","ည":"ny","ဋ":"t","ဌ":"ta","ဍ":"d","ဎ":"da","ဏ":"na","တ":"t","ထ":"ta","ဒ":"d","ဓ":"da","န":"n","ပ":"p","ဖ":"pa","ဗ":"b","ဘ":"ba","မ":"m","ယ":"y","ရ":"ya","လ":"l","ဝ":"w","သ":"th","ဟ":"h","ဠ":"la","အ":"a","ြ":"y","ျ":"ya","ွ":"w","ြွ":"yw","ျွ":"ywa","ှ":"h","ဧ":"e","၏":"-e","ဣ":"i","ဤ":"-i","ဉ":"u","ဦ":"-u","ဩ":"aw","သြော":"aw","ဪ":"aw","၀":"0","၁":"1","၂":"2","၃":"3","၄":"4","၅":"5","၆":"6","၇":"7","၈":"8","၉":"9","္":"","့":"","း":"","č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z","ހ":"h","ށ":"sh","ނ":"n","ރ":"r","ބ":"b","ޅ":"lh","ކ":"k","އ":"a","ވ":"v","މ":"m","ފ":"f","ދ":"dh","ތ":"th","ލ":"l","ގ":"g","ޏ":"gn","ސ":"s","ޑ":"d","ޒ":"z","ޓ":"t","ޔ":"y","ޕ":"p","ޖ":"j","ޗ":"ch","ޘ":"tt","ޙ":"hh","ޚ":"kh","ޛ":"th","ޜ":"z","ޝ":"sh","ޞ":"s","ޟ":"d","ޠ":"t","ޡ":"z","ޢ":"a","ޣ":"gh","ޤ":"q","ޥ":"w","ަ":"a","ާ":"aa","ި":"i","ީ":"ee","ު":"u","ޫ":"oo","ެ":"e","ޭ":"ey","ޮ":"o","ޯ":"oa","ް":"","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"p","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","α":"a","β":"v","γ":"g","δ":"d","ε":"e","ζ":"z","η":"i","θ":"th","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"ks","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"o","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"i","ώ":"o","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"I","Θ":"TH","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"KS","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"O","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"I","Ώ":"O","Ϊ":"I","Ϋ":"Y","ā":"a","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","ū":"u","Ā":"A","Ē":"E","Ģ":"G","Ī":"I","Ķ":"k","Ļ":"L","Ņ":"N","Ū":"U","Ќ":"Kj","ќ":"kj","Љ":"Lj","љ":"lj","Њ":"Nj","њ":"nj","Тс":"Ts","тс":"ts","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"E","Ł":"L","Ń":"N","Ś":"S","Ź":"Z","Ż":"Z","Є":"Ye","І":"I","Ї":"Yi","Ґ":"G","є":"ye","і":"i","ї":"yi","ґ":"g","ă":"a","Ă":"A","ș":"s","Ș":"S","ț":"t","Ț":"T","ţ":"t","Ţ":"T","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"i","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"kh","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"I","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"Kh","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","ђ":"dj","ј":"j","ћ":"c","џ":"dz","Ђ":"Dj","Ј":"j","Ћ":"C","Џ":"Dz","ľ":"l","ĺ":"l","ŕ":"r","Ľ":"L","Ĺ":"L","Ŕ":"R","ş":"s","Ş":"S","ı":"i","İ":"I","ğ":"g","Ğ":"G","ả":"a","Ả":"A","ẳ":"a","Ẳ":"A","ẩ":"a","Ẩ":"A","đ":"d","Đ":"D","ẹ":"e","Ẹ":"E","ẽ":"e","Ẽ":"E","ẻ":"e","Ẻ":"E","ế":"e","Ế":"E","ề":"e","Ề":"E","ệ":"e","Ệ":"E","ễ":"e","Ễ":"E","ể":"e","Ể":"E","ỏ":"o","ọ":"o","Ọ":"o","ố":"o","Ố":"O","ồ":"o","Ồ":"O","ổ":"o","Ổ":"O","ộ":"o","Ộ":"O","ỗ":"o","Ỗ":"O","ơ":"o","Ơ":"O","ớ":"o","Ớ":"O","ờ":"o","Ờ":"O","ợ":"o","Ợ":"O","ỡ":"o","Ỡ":"O","Ở":"o","ở":"o","ị":"i","Ị":"I","ĩ":"i","Ĩ":"I","ỉ":"i","Ỉ":"i","ủ":"u","Ủ":"U","ụ":"u","Ụ":"U","ũ":"u","Ũ":"U","ư":"u","Ư":"U","ứ":"u","Ứ":"U","ừ":"u","Ừ":"U","ự":"u","Ự":"U","ữ":"u","Ữ":"U","ử":"u","Ử":"ư","ỷ":"y","Ỷ":"y","ỳ":"y","Ỳ":"Y","ỵ":"y","Ỵ":"Y","ỹ":"y","Ỹ":"Y","ạ":"a","Ạ":"A","ấ":"a","Ấ":"A","ầ":"a","Ầ":"A","ậ":"a","Ậ":"A","ẫ":"a","Ẫ":"A","ắ":"a","Ắ":"A","ằ":"a","Ằ":"A","ặ":"a","Ặ":"A","ẵ":"a","Ẵ":"A","⓪":"0","①":"1","②":"2","③":"3","④":"4","⑤":"5","⑥":"6","⑦":"7","⑧":"8","⑨":"9","⑩":"10","⑪":"11","⑫":"12","⑬":"13","⑭":"14","⑮":"15","⑯":"16","⑰":"17","⑱":"18","⑲":"18","⑳":"18","⓵":"1","⓶":"2","⓷":"3","⓸":"4","⓹":"5","⓺":"6","⓻":"7","⓼":"8","⓽":"9","⓾":"10","⓿":"0","⓫":"11","⓬":"12","⓭":"13","⓮":"14","⓯":"15","⓰":"16","⓱":"17","⓲":"18","⓳":"19","⓴":"20","Ⓐ":"A","Ⓑ":"B","Ⓒ":"C","Ⓓ":"D","Ⓔ":"E","Ⓕ":"F","Ⓖ":"G","Ⓗ":"H","Ⓘ":"I","Ⓙ":"J","Ⓚ":"K","Ⓛ":"L","Ⓜ":"M","Ⓝ":"N","Ⓞ":"O","Ⓟ":"P","Ⓠ":"Q","Ⓡ":"R","Ⓢ":"S","Ⓣ":"T","Ⓤ":"U","Ⓥ":"V","Ⓦ":"W","Ⓧ":"X","Ⓨ":"Y","Ⓩ":"Z","ⓐ":"a","ⓑ":"b","ⓒ":"c","ⓓ":"d","ⓔ":"e","ⓕ":"f","ⓖ":"g","ⓗ":"h","ⓘ":"i","ⓙ":"j","ⓚ":"k","ⓛ":"l","ⓜ":"m","ⓝ":"n","ⓞ":"o","ⓟ":"p","ⓠ":"q","ⓡ":"r","ⓢ":"s","ⓣ":"t","ⓤ":"u","ⓦ":"v","ⓥ":"w","ⓧ":"x","ⓨ":"y","ⓩ":"z","“":'"',"”":'"',"‘":"'","’":"'","∂":"d","ƒ":"f","™":"(TM)","©":"(C)","œ":"oe","Œ":"OE","®":"(R)","†":"+","℠":"(SM)","…":"...","˚":"o","º":"o","ª":"a","•":"*","၊":",","။":".",$:"USD","€":"EUR","₢":"BRN","₣":"FRF","£":"GBP","₤":"ITL","₦":"NGN","₧":"ESP","₩":"KRW","₪":"ILS","₫":"VND","₭":"LAK","₮":"MNT","₯":"GRD","₱":"ARS","₲":"PYG","₳":"ARA","₴":"UAH","₵":"GHS","¢":"cent","¥":"CNY","元":"CNY","円":"YEN","﷼":"IRR","₠":"EWE","฿":"THB","₨":"INR","₹":"INR","₰":"PF","₺":"TRY","؋":"AFN","₼":"AZN","лв":"BGN","៛":"KHR","₡":"CRC","₸":"KZT","ден":"MKD","zł":"PLN","₽":"RUB","₾":"GEL"},r=["်","ް"],s={"ာ":"a","ါ":"a","ေ":"e","ဲ":"e","ိ":"i","ီ":"i","ို":"o","ု":"u","ူ":"u","ေါင်":"aung","ော":"aw","ော်":"aw","ေါ":"aw","ေါ်":"aw","်":"်","က်":"et","ိုက်":"aik","ောက်":"auk","င်":"in","ိုင်":"aing","ောင်":"aung","စ်":"it","ည်":"i","တ်":"at","ိတ်":"eik","ုတ်":"ok","ွတ်":"ut","ေတ်":"it","ဒ်":"d","ိုဒ်":"ok","ုဒ်":"ait","န်":"an","ာန်":"an","ိန်":"ein","ုန်":"on","ွန်":"un","ပ်":"at","ိပ်":"eik","ုပ်":"ok","ွပ်":"ut","န်ုပ်":"nub","မ်":"an","ိမ်":"ein","ုမ်":"on","ွမ်":"un","ယ်":"e","ိုလ်":"ol","ဉ်":"in","ံ":"an","ိံ":"ein","ုံ":"on","ައް":"ah","ަށް":"ah"},i={en:{},az:{"ç":"c","ə":"e","ğ":"g","ı":"i","ö":"o","ş":"s","ü":"u","Ç":"C","Ə":"E","Ğ":"G","İ":"I","Ö":"O","Ş":"S","Ü":"U"},cs:{"č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z"},fi:{"ä":"a","Ä":"A","ö":"o","Ö":"O"},hu:{"ä":"a","Ä":"A","ö":"o","Ö":"O","ü":"u","Ü":"U","ű":"u","Ű":"U"},lt:{"ą":"a","č":"c","ę":"e","ė":"e","į":"i","š":"s","ų":"u","ū":"u","ž":"z","Ą":"A","Č":"C","Ę":"E","Ė":"E","Į":"I","Š":"S","Ų":"U","Ū":"U"},lv:{"ā":"a","č":"c","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","š":"s","ū":"u","ž":"z","Ā":"A","Č":"C","Ē":"E","Ģ":"G","Ī":"i","Ķ":"k","Ļ":"L","Ņ":"N","Š":"S","Ū":"u","Ž":"Z"},pl:{"ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"e","Ł":"L","Ń":"N","Ó":"O","Ś":"S","Ź":"Z","Ż":"Z"},sv:{"ä":"a","Ä":"A","ö":"o","Ö":"O"},sk:{"ä":"a","Ä":"A"},sr:{"љ":"lj","њ":"nj","Љ":"Lj","Њ":"Nj","đ":"dj","Đ":"Dj"},tr:{"Ü":"U","Ö":"O","ü":"u","ö":"o"}},o={ar:{"∆":"delta","∞":"la-nihaya","♥":"hob","&":"wa","|":"aw","<":"aqal-men",">":"akbar-men","∑":"majmou","¤":"omla"},az:{},ca:{"∆":"delta","∞":"infinit","♥":"amor","&":"i","|":"o","<":"menys que",">":"mes que","∑":"suma dels","¤":"moneda"},cs:{"∆":"delta","∞":"nekonecno","♥":"laska","&":"a","|":"nebo","<":"mensi nez",">":"vetsi nez","∑":"soucet","¤":"mena"},de:{"∆":"delta","∞":"unendlich","♥":"Liebe","&":"und","|":"oder","<":"kleiner als",">":"groesser als","∑":"Summe von","¤":"Waehrung"},dv:{"∆":"delta","∞":"kolunulaa","♥":"loabi","&":"aai","|":"noonee","<":"ah vure kuda",">":"ah vure bodu","∑":"jumula","¤":"faisaa"},en:{"∆":"delta","∞":"infinity","♥":"love","&":"and","|":"or","<":"less than",">":"greater than","∑":"sum","¤":"currency"},es:{"∆":"delta","∞":"infinito","♥":"amor","&":"y","|":"u","<":"menos que",">":"mas que","∑":"suma de los","¤":"moneda"},fa:{"∆":"delta","∞":"bi-nahayat","♥":"eshgh","&":"va","|":"ya","<":"kamtar-az",">":"bishtar-az","∑":"majmooe","¤":"vahed"},fi:{"∆":"delta","∞":"aarettomyys","♥":"rakkaus","&":"ja","|":"tai","<":"pienempi kuin",">":"suurempi kuin","∑":"summa","¤":"valuutta"},fr:{"∆":"delta","∞":"infiniment","♥":"Amour","&":"et","|":"ou","<":"moins que",">":"superieure a","∑":"somme des","¤":"monnaie"},ge:{"∆":"delta","∞":"usasruloba","♥":"siqvaruli","&":"da","|":"an","<":"naklebi",">":"meti","∑":"jami","¤":"valuta"},gr:{},hu:{"∆":"delta","∞":"vegtelen","♥":"szerelem","&":"es","|":"vagy","<":"kisebb mint",">":"nagyobb mint","∑":"szumma","¤":"penznem"},it:{"∆":"delta","∞":"infinito","♥":"amore","&":"e","|":"o","<":"minore di",">":"maggiore di","∑":"somma","¤":"moneta"},lt:{"∆":"delta","∞":"begalybe","♥":"meile","&":"ir","|":"ar","<":"maziau nei",">":"daugiau nei","∑":"suma","¤":"valiuta"},lv:{"∆":"delta","∞":"bezgaliba","♥":"milestiba","&":"un","|":"vai","<":"mazak neka",">":"lielaks neka","∑":"summa","¤":"valuta"},my:{"∆":"kwahkhyaet","∞":"asaonasme","♥":"akhyait","&":"nhin","|":"tho","<":"ngethaw",">":"kyithaw","∑":"paungld","¤":"ngwekye"},mk:{},nl:{"∆":"delta","∞":"oneindig","♥":"liefde","&":"en","|":"of","<":"kleiner dan",">":"groter dan","∑":"som","¤":"valuta"},pl:{"∆":"delta","∞":"nieskonczonosc","♥":"milosc","&":"i","|":"lub","<":"mniejsze niz",">":"wieksze niz","∑":"suma","¤":"waluta"},pt:{"∆":"delta","∞":"infinito","♥":"amor","&":"e","|":"ou","<":"menor que",">":"maior que","∑":"soma","¤":"moeda"},ro:{"∆":"delta","∞":"infinit","♥":"dragoste","&":"si","|":"sau","<":"mai mic ca",">":"mai mare ca","∑":"suma","¤":"valuta"},ru:{"∆":"delta","∞":"beskonechno","♥":"lubov","&":"i","|":"ili","<":"menshe",">":"bolshe","∑":"summa","¤":"valjuta"},sk:{"∆":"delta","∞":"nekonecno","♥":"laska","&":"a","|":"alebo","<":"menej ako",">":"viac ako","∑":"sucet","¤":"mena"},sr:{},tr:{"∆":"delta","∞":"sonsuzluk","♥":"ask","&":"ve","|":"veya","<":"kucuktur",">":"buyuktur","∑":"toplam","¤":"para birimi"},uk:{"∆":"delta","∞":"bezkinechnist","♥":"lubov","&":"i","|":"abo","<":"menshe",">":"bilshe","∑":"suma","¤":"valjuta"},vn:{"∆":"delta","∞":"vo cuc","♥":"yeu","&":"va","|":"hoac","<":"nho hon",">":"lon hon","∑":"tong","¤":"tien te"}},a=[";","?",":","@","&","=","+","$",",","/"].join(""),l=[";","?",":","@","&","=","+","$",","].join(""),c=[".","!","~","*","'","(",")"].join(""),u=function(e,t){var u,h,m,f,g,y,v,x,b,_,w,T,E,S,A="-",M="",O="",C=!0,N={},P="";if("string"!=typeof e)return"";if("string"==typeof t&&(A=t),v=o.en,x=i.en,"object"==typeof t)for(w in u=t.maintainCase||!1,N=t.custom&&"object"==typeof t.custom?t.custom:N,m=+t.truncate>1&&t.truncate||!1,f=t.uric||!1,g=t.uricNoSlash||!1,y=t.mark||!1,C=!(!1===t.symbols||!1===t.lang),A=t.separator||A,f&&(P+=a),g&&(P+=l),y&&(P+=c),v=t.lang&&o[t.lang]&&C?o[t.lang]:C?o.en:{},x=t.lang&&i[t.lang]?i[t.lang]:!1===t.lang||!0===t.lang?{}:i.en,t.titleCase&&"number"==typeof t.titleCase.length&&Array.prototype.toString.call(t.titleCase)?(t.titleCase.forEach(function(e){N[e+""]=e+""}),h=!0):h=!!t.titleCase,t.custom&&"number"==typeof t.custom.length&&Array.prototype.toString.call(t.custom)&&t.custom.forEach(function(e){N[e+""]=e+""}),Object.keys(N).forEach(function(t){var n;n=t.length>1?new RegExp("\\b"+d(t)+"\\b","gi"):new RegExp(d(t),"gi"),e=e.replace(n,N[t])}),N)P+=w;for(P=d(P+=A),E=!1,S=!1,_=0,T=(e=e.replace(/(^\s+|\s+$)/g,"")).length;_<T;_++)w=e[_],p(w,N)?E=!1:x[w]?(w=E&&x[w].match(/[A-Za-z0-9]/)?" "+x[w]:x[w],E=!1):w in n?(_+1<T&&r.indexOf(e[_+1])>=0?(O+=w,w=""):!0===S?(w=s[O]+n[w],O=""):w=E&&n[w].match(/[A-Za-z0-9]/)?" "+n[w]:n[w],E=!1,S=!1):w in s?(O+=w,w="",_===T-1&&(w=s[O]),S=!0):!v[w]||f&&-1!==a.indexOf(w)||g&&-1!==l.indexOf(w)?(!0===S?(w=s[O]+w,O="",S=!1):E&&(/[A-Za-z0-9]/.test(w)||M.substr(-1).match(/A-Za-z0-9]/))&&(w=" "+w),E=!1):(w=E||M.substr(-1).match(/[A-Za-z0-9]/)?A+v[w]:v[w],w+=void 0!==e[_+1]&&e[_+1].match(/[A-Za-z0-9]/)?A:"",E=!0),M+=w.replace(new RegExp("[^\\w\\s"+P+"_-]","g"),A);return h&&(M=M.replace(/(\w)(\S*)/g,function(e,t,n){var r=t.toUpperCase()+(null!==n?n:"");return Object.keys(N).indexOf(r.toLowerCase())<0?r:r.toLowerCase()})),M=M.replace(/\s+/g,A).replace(new RegExp("\\"+A+"+","g"),A).replace(new RegExp("(^\\"+A+"+|\\"+A+"+$)","g"),""),m&&M.length>m&&(b=M.charAt(m)===A,M=M.slice(0,m),b||(M=M.slice(0,M.lastIndexOf(A)))),!u&&!h&&(M=M.toLowerCase()),M},h=function(e){return function(t){return u(t,e)}},d=function(e){return e.replace(/[-\\^$*+?.()|[\]{}\/]/g,"\\$&")},p=function(e,t){for(var n in t)if(t[n]===e)return!0};if(typeof t<"u"&&t.exports)t.exports=u,t.exports.createSlug=h;else if(typeof define<"u"&&define.amd)define([],function(){return u});else try{if(e.getSlug||e.createSlug)throw"speakingurl: globals exists /(getSlug|createSlug)/";e.getSlug=u,e.createSlug=h}catch{}}(e)}}),vi=fi({"../../node_modules/.pnpm/speakingurl@14.0.1/node_modules/speakingurl/index.js"(e,t){gi(),t.exports=yi()}});function xi(e){const t=e.__file;if(t)return function(e){return e&&`${e}`.replace(Zs,Ks)}(function(e,t){let n=e.replace(/^[a-z]:/i,"").replace(/\\/g,"/");n.endsWith(`index${t}`)&&(n=n.replace(`/index${t}`,t));const r=n.lastIndexOf("/"),s=n.substring(r+1);{const e=s.lastIndexOf(t);return s.substring(0,e)}}(t,".vue"))}function bi(e,t){return e.type.__VUE_DEVTOOLS_COMPONENT_GUSSED_NAME__=t,t}function _i(e){return e.__VUE_DEVTOOLS_NEXT_APP_RECORD__?e.__VUE_DEVTOOLS_NEXT_APP_RECORD__:e.root?e.appContext.app.__VUE_DEVTOOLS_NEXT_APP_RECORD__:void 0}function wi(e){var t,n;const r=null==(t=e.subTree)?void 0:t.type,s=_i(e);return!!s&&(null==(n=s?.types)?void 0:n.Fragment)===r}function Ti(e){var t,n,r;const s=function(e){var t;const n=e.name||e._componentTag||e.__VUE_DEVTOOLS_COMPONENT_GUSSED_NAME__||e.__name;return"index"===n&&null!=(t=e.__file)&&t.endsWith("index.vue")?"":n}(e?.type||{});if(s)return s;if(e?.root===e)return"Root";for(const i in null==(n=null==(t=e.parent)?void 0:t.type)?void 0:n.components)if(e.parent.type.components[i]===e?.type)return bi(e,i);for(const i in null==(r=e.appContext)?void 0:r.components)if(e.appContext.components[i]===e?.type)return bi(e,i);return xi(e?.type||{})||"Anonymous Component"}function Ei(e,t){return t=t||`${e.id}:root`,e.instanceMap.get(t)||e.instanceMap.get(":root")}function Si(e){return li||(li=document.createRange()),li.selectNode(e),li.getBoundingClientRect()}function Ai(e,t){return(!e.top||t.top<e.top)&&(e.top=t.top),(!e.bottom||t.bottom>e.bottom)&&(e.bottom=t.bottom),(!e.left||t.left<e.left)&&(e.left=t.left),(!e.right||t.right>e.right)&&(e.right=t.right),e}gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi();var Mi={top:0,left:0,right:0,bottom:0,width:0,height:0};function Oi(e){const t=e.subTree.el;return typeof window>"u"?Mi:wi(e)?function(e){const t=function(){const e={top:0,bottom:0,left:0,right:0,get width(){return e.right-e.left},get height(){return e.bottom-e.top}};return e}();if(!e.children)return t;for(let n=0,r=e.children.length;n<r;n++){const r=e.children[n];let s;if(r.component)s=Oi(r.component);else if(r.el){const e=r.el;1===e.nodeType||e.getBoundingClientRect?s=e.getBoundingClientRect():3===e.nodeType&&e.data.trim()&&(s=Si(e))}s&&Ai(t,s)}return t}(e.subTree):1===t?.nodeType?t?.getBoundingClientRect():e.subTree.component?Oi(e.subTree.component):Mi}function Ci(e){return wi(e)?function(e){if(!e.children)return[];const t=[];return e.children.forEach(e=>{e.component?t.push(...Ci(e.component)):e?.el&&t.push(e.el)}),t}(e.subTree):e.subTree?[e.subTree.el]:[]}gi();var Ni="__vue-devtools-component-inspector__",Pi="__vue-devtools-component-inspector__card__",Ri="__vue-devtools-component-inspector__name__",Ii="__vue-devtools-component-inspector__indicator__",Li={display:"block",zIndex:2147483640,position:"fixed",backgroundColor:"#42b88325",border:"1px solid #42b88350",borderRadius:"5px",transition:"all 0.1s ease-in",pointerEvents:"none"},ki={fontFamily:"Arial, Helvetica, sans-serif",padding:"5px 8px",borderRadius:"4px",textAlign:"left",position:"absolute",left:0,color:"#e9e9e9",fontSize:"14px",fontWeight:600,lineHeight:"24px",backgroundColor:"#42b883",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},Di={display:"inline-block",fontWeight:400,fontStyle:"normal",fontSize:"12px",opacity:.7};function zi(){return document.getElementById(Ni)}function Ui(e){return{left:Math.round(100*e.left)/100+"px",top:Math.round(100*e.top)/100+"px",width:Math.round(100*e.width)/100+"px",height:Math.round(100*e.height)/100+"px"}}function Fi(e){var t;const n=document.createElement("div");n.id=null!=(t=e.elementId)?t:Ni,Object.assign(n.style,{...Li,...Ui(e.bounds),...e.style});const r=document.createElement("span");r.id=Pi,Object.assign(r.style,{...ki,top:e.bounds.top<35?0:"-35px"});const s=document.createElement("span");s.id=Ri,s.innerHTML=`&lt;${e.name}&gt;&nbsp;&nbsp;`;const i=document.createElement("i");return i.id=Ii,i.innerHTML=`${Math.round(100*e.bounds.width)/100} x ${Math.round(100*e.bounds.height)/100}`,Object.assign(i.style,Di),r.appendChild(s),r.appendChild(i),n.appendChild(r),document.body.appendChild(n),n}function Bi(e){const t=zi(),n=document.getElementById(Pi),r=document.getElementById(Ri),s=document.getElementById(Ii);t&&(Object.assign(t.style,{...Li,...Ui(e.bounds)}),Object.assign(n.style,{top:e.bounds.top<35?0:"-35px"}),r.innerHTML=`&lt;${e.name}&gt;&nbsp;&nbsp;`,s.innerHTML=`${Math.round(100*e.bounds.width)/100} x ${Math.round(100*e.bounds.height)/100}`)}function Vi(){const e=zi();e&&(e.style.display="none")}var ji=null;function Hi(e){const t=e.target;if(t){const e=t.__vueParentComponent;if(e&&(ji=e,e.vnode.el)){const t=Oi(e),n=Ti(e);zi()?Bi({bounds:t,name:n}):Fi({bounds:t,name:n})}}}var Yi,Wi=null;function Xi(){return window.addEventListener("mouseover",Hi),new Promise(e=>{function t(n){n.preventDefault(),n.stopPropagation(),function(e,t){if(e.preventDefault(),e.stopPropagation(),ji){const e=function(e){var t,n,r;return`${null!=(r=null==(n=null==(t=e?.appContext)?void 0:t.app)?void 0:n.__VUE_DEVTOOLS_NEXT_APP_RECORD_ID__)?r:0}:${e===e?.root?"root":e.uid}`}(ji);t(e)}}(n,n=>{window.removeEventListener("click",t,!0),Wi=null,window.removeEventListener("mouseover",Hi);const r=zi();r&&(r.style.display="none"),e(JSON.stringify({id:n}))})}Wi=t,window.addEventListener("click",t,!0)})}function Gi(){return new Promise(e=>{function t(){(function(){const e=Gs.__VUE_INSPECTOR__,t=e.openInEditor;e.openInEditor=async(...n)=>{e.disable(),t(...n)}})(),e(Gs.__VUE_INSPECTOR__)}Gs.__VUE_INSPECTOR__?t():function(e){let t=0;const n=setInterval(()=>{Gs.__VUE_INSPECTOR__&&(clearInterval(n),t+=30,e()),t>=5e3&&clearInterval(n)},30)}(()=>{t()})})}function qi(e){return function(e){return!(!e||!e.__v_isReadonly)}(e)?qi(e.__v_raw):!(!e||!e.__v_isReactive)}function Zi(e){return!(!e||!0!==e.__v_isRef)}function Ki(e){const t=e&&e.__v_raw;return t?Ki(t):e}gi(),null!=(Yi=Gs).__VUE_DEVTOOLS_COMPONENT_INSPECTOR_ENABLED__||(Yi.__VUE_DEVTOOLS_COMPONENT_INSPECTOR_ENABLED__=!0),gi(),gi();var Qi=class{constructor(){this.refEditor=new Ji}set(e,t,n,r){const s=Array.isArray(t)?t:t.split(".");for(;s.length>1;){const t=s.shift();e=e instanceof Map?e.get(t):e instanceof Set?Array.from(e.values())[t]:e[t],this.refEditor.isRef(e)&&(e=this.refEditor.get(e))}const i=s[0],o=this.refEditor.get(e)[i];r?r(e,i,n):this.refEditor.isRef(o)?this.refEditor.set(o,n):e[i]=n}get(e,t){const n=Array.isArray(t)?t:t.split(".");for(let r=0;r<n.length;r++)if(e=e instanceof Map?e.get(n[r]):e[n[r]],this.refEditor.isRef(e)&&(e=this.refEditor.get(e)),!e)return;return e}has(e,t,n=!1){if(typeof e>"u")return!1;const r=Array.isArray(t)?t.slice():t.split("."),s=n?2:1;for(;e&&r.length>s;){e=e[r.shift()],this.refEditor.isRef(e)&&(e=this.refEditor.get(e))}return null!=e&&Object.prototype.hasOwnProperty.call(e,r[0])}createDefaultSetCallback(e){return(t,n,r)=>{if((e.remove||e.newKey)&&(Array.isArray(t)?t.splice(n,1):Ki(t)instanceof Map?t.delete(n):Ki(t)instanceof Set?t.delete(Array.from(t.values())[n]):Reflect.deleteProperty(t,n)),!e.remove){const s=t[e.newKey||n];this.refEditor.isRef(s)?this.refEditor.set(s,r):Ki(t)instanceof Map?t.set(e.newKey||n,r):Ki(t)instanceof Set?t.add(r):t[e.newKey||n]=r}}}},Ji=class{set(e,t){if(Zi(e))e.value=t;else{if(e instanceof Set&&Array.isArray(t))return e.clear(),void t.forEach(t=>e.add(t));const n=Object.keys(t);if(e instanceof Map){const r=new Set(e.keys());return n.forEach(n=>{e.set(n,Reflect.get(t,n)),r.delete(n)}),void r.forEach(t=>e.delete(t))}const r=new Set(Object.keys(e));n.forEach(n=>{Reflect.set(e,n,Reflect.get(t,n)),r.delete(n)}),r.forEach(t=>Reflect.deleteProperty(e,t))}}get(e){return Zi(e)?e.value:e}isRef(e){return Zi(e)||qi(e)}};gi(),gi(),gi();var $i;function eo(){if(!Xs||typeof localStorage>"u"||null===localStorage)return{recordingState:!1,mouseEventEnabled:!1,keyboardEventEnabled:!1,componentEventEnabled:!1,performanceEventEnabled:!1,selected:""};const e=localStorage.getItem("__VUE_DEVTOOLS_KIT_TIMELINE_LAYERS_STATE__");return e?JSON.parse(e):{recordingState:!1,mouseEventEnabled:!1,keyboardEventEnabled:!1,componentEventEnabled:!1,performanceEventEnabled:!1,selected:""}}gi(),gi(),gi(),null!=($i=Gs).__VUE_DEVTOOLS_KIT_TIMELINE_LAYERS||($i.__VUE_DEVTOOLS_KIT_TIMELINE_LAYERS=[]);var to,no=new Proxy(Gs.__VUE_DEVTOOLS_KIT_TIMELINE_LAYERS,{get:(e,t,n)=>Reflect.get(e,t,n)});null!=(to=Gs).__VUE_DEVTOOLS_KIT_INSPECTOR__||(to.__VUE_DEVTOOLS_KIT_INSPECTOR__=[]);var ro,so,io,oo,ao,lo=new Proxy(Gs.__VUE_DEVTOOLS_KIT_INSPECTOR__,{get:(e,t,n)=>Reflect.get(e,t,n)}),co=$s(()=>{Qo.hooks.callHook("sendInspectorToClient",uo())});function uo(){return lo.filter(e=>e.descriptor.app===yo.value.app).filter(e=>"components"!==e.descriptor.id).map(e=>{var t;const n=e.descriptor,r=e.options;return{id:r.id,label:r.label,logo:n.logo,icon:`custom-ic-baseline-${null==(t=r?.icon)?void 0:t.replace(/_/g,"-")}`,packageName:n.packageName,homepage:n.homepage,pluginId:n.id}})}function ho(e,t){return lo.find(n=>n.options.id===e&&(!t||n.descriptor.app===t))}null!=(ro=Gs).__VUE_DEVTOOLS_KIT_APP_RECORDS__||(ro.__VUE_DEVTOOLS_KIT_APP_RECORDS__=[]),null!=(so=Gs).__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD__||(so.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD__={}),null!=(io=Gs).__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD_ID__||(io.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD_ID__=""),null!=(oo=Gs).__VUE_DEVTOOLS_KIT_CUSTOM_TABS__||(oo.__VUE_DEVTOOLS_KIT_CUSTOM_TABS__=[]),null!=(ao=Gs).__VUE_DEVTOOLS_KIT_CUSTOM_COMMANDS__||(ao.__VUE_DEVTOOLS_KIT_CUSTOM_COMMANDS__=[]);var po,mo="__VUE_DEVTOOLS_KIT_GLOBAL_STATE__";null!=(po=Gs)[mo]||(po[mo]={connected:!1,clientConnected:!1,vitePluginDetected:!0,appRecords:[],activeAppRecordId:"",tabs:[],commands:[],highPerfModeEnabled:!0,devtoolsClientDetected:{},perfUniqueGroupId:0,timelineLayersState:eo()});var fo=$s(e=>{Qo.hooks.callHook("devtoolsStateUpdated",{state:e})});$s((e,t)=>{Qo.hooks.callHook("devtoolsConnectedUpdated",{state:e,oldState:t})});var go=new Proxy(Gs.__VUE_DEVTOOLS_KIT_APP_RECORDS__,{get:(e,t,n)=>"value"===t?Gs.__VUE_DEVTOOLS_KIT_APP_RECORDS__:Gs.__VUE_DEVTOOLS_KIT_APP_RECORDS__[t]}),yo=new Proxy(Gs.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD__,{get:(e,t,n)=>"value"===t?Gs.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD__:"id"===t?Gs.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD_ID__:Gs.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD__[t]});function vo(){fo({...Gs[mo],appRecords:go.value,activeAppRecordId:yo.id,tabs:Gs.__VUE_DEVTOOLS_KIT_CUSTOM_TABS__,commands:Gs.__VUE_DEVTOOLS_KIT_CUSTOM_COMMANDS__})}var xo,bo=new Proxy(Gs[mo],{get:(e,t)=>"appRecords"===t?go:"activeAppRecordId"===t?yo.id:"tabs"===t?Gs.__VUE_DEVTOOLS_KIT_CUSTOM_TABS__:"commands"===t?Gs.__VUE_DEVTOOLS_KIT_CUSTOM_COMMANDS__:Gs[mo][t],deleteProperty:(e,t)=>(delete e[t],!0),set:(e,t,n)=>(Gs[mo],e[t]=n,Gs[mo][t]=n,!0)});function _o(e={}){var t,n,r;const{file:s,host:i,baseUrl:o=window.location.origin,line:a=0,column:l=0}=e;if(s)if("chrome-extension"===i){const e=s.replace(/\\/g,"\\\\"),r=null!=(n=null==(t=window.VUE_DEVTOOLS_CONFIG)?void 0:t.openInEditorHost)?n:"/";fetch(`${r}__open-in-editor?file=${encodeURI(s)}`).then(t=>{if(!t.ok){const t=`Opening component ${e} failed`;console.log(`%c${t}`,"color:red")}})}else if(bo.vitePluginDetected){const e=null!=(r=Gs.__VUE_DEVTOOLS_OPEN_IN_EDITOR_BASE_URL__)?r:o;Gs.__VUE_INSPECTOR__.openInEditor(e,s,a,l)}}gi(),gi(),gi(),gi(),gi(),null!=(xo=Gs).__VUE_DEVTOOLS_KIT_PLUGIN_BUFFER__||(xo.__VUE_DEVTOOLS_KIT_PLUGIN_BUFFER__=[]);var wo=new Proxy(Gs.__VUE_DEVTOOLS_KIT_PLUGIN_BUFFER__,{get:(e,t,n)=>Reflect.get(e,t,n)});function To(e){const t={};return Object.keys(e).forEach(n=>{t[n]=e[n].defaultValue}),t}function Eo(e){return`__VUE_DEVTOOLS_NEXT_PLUGIN_SETTINGS__${e}__`}function So(e){var t,n,r;const s=null!=(n=null==(t=wo.find(t=>{var n;return t[0].id===e&&!(null==(n=t[0])||!n.settings)}))?void 0:t[0])?n:null;return null!=(r=s?.settings)?r:null}function Ao(e,t){var n,r,s;const i=Eo(e);if(i){const e=localStorage.getItem(i);if(e)return JSON.parse(e)}if(e){const t=null!=(r=null==(n=wo.find(t=>t[0].id===e))?void 0:n[0])?r:null;return To(null!=(s=t?.settings)?s:{})}return To(t)}gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi();var Mo,Oo,Co=null!=(Oo=(Mo=Gs).__VUE_DEVTOOLS_HOOK)?Oo:Mo.__VUE_DEVTOOLS_HOOK=ai(),No={vueAppInit(e){Co.hook("app:init",e)},vueAppUnmount(e){Co.hook("app:unmount",e)},vueAppConnected(e){Co.hook("app:connected",e)},componentAdded:e=>Co.hook("component:added",e),componentEmit:e=>Co.hook("component:emit",e),componentUpdated:e=>Co.hook("component:updated",e),componentRemoved:e=>Co.hook("component:removed",e),setupDevtoolsPlugin(e){Co.hook("devtools-plugin:setup",e)},perfStart:e=>Co.hook("perf:start",e),perfEnd:e=>Co.hook("perf:end",e)},Po={on:No,setupDevToolsPlugin:(e,t)=>Co.callHook("devtools-plugin:setup",e,t)},Ro=class{constructor({plugin:e,ctx:t}){this.hooks=t.hooks,this.plugin=e}get on(){return{visitComponentTree:e=>{this.hooks.hook("visitComponentTree",e)},inspectComponent:e=>{this.hooks.hook("inspectComponent",e)},editComponentState:e=>{this.hooks.hook("editComponentState",e)},getInspectorTree:e=>{this.hooks.hook("getInspectorTree",e)},getInspectorState:e=>{this.hooks.hook("getInspectorState",e)},editInspectorState:e=>{this.hooks.hook("editInspectorState",e)},inspectTimelineEvent:e=>{this.hooks.hook("inspectTimelineEvent",e)},timelineCleared:e=>{this.hooks.hook("timelineCleared",e)},setPluginSettings:e=>{this.hooks.hook("setPluginSettings",e)}}}notifyComponentUpdate(e){var t;if(bo.highPerfModeEnabled)return;const n=uo().find(e=>e.packageName===this.plugin.descriptor.packageName);if(n?.id){if(e){const n=[e.appContext.app,e.uid,null==(t=e.parent)?void 0:t.uid,e];Co.callHook("component:updated",...n)}else Co.callHook("component:updated");this.hooks.callHook("sendInspectorState",{inspectorId:n.id,plugin:this.plugin})}}addInspector(e){this.hooks.callHook("addInspector",{inspector:e,plugin:this.plugin}),this.plugin.descriptor.settings&&function(e,t){const n=Eo(e);localStorage.getItem(n)||localStorage.setItem(n,JSON.stringify(To(t)))}(e.id,this.plugin.descriptor.settings)}sendInspectorTree(e){bo.highPerfModeEnabled||this.hooks.callHook("sendInspectorTree",{inspectorId:e,plugin:this.plugin})}sendInspectorState(e){bo.highPerfModeEnabled||this.hooks.callHook("sendInspectorState",{inspectorId:e,plugin:this.plugin})}selectInspectorNode(e,t){this.hooks.callHook("customInspectorSelectNode",{inspectorId:e,nodeId:t,plugin:this.plugin})}visitComponentTree(e){return this.hooks.callHook("visitComponentTree",e)}now(){return bo.highPerfModeEnabled?0:Date.now()}addTimelineLayer(e){this.hooks.callHook("timelineLayerAdded",{options:e,plugin:this.plugin})}addTimelineEvent(e){bo.highPerfModeEnabled||this.hooks.callHook("timelineEventAdded",{options:e,plugin:this.plugin})}getSettings(e){return Ao(e??this.plugin.descriptor.id,this.plugin.descriptor.settings)}getComponentInstances(e){return this.hooks.callHook("getComponentInstances",{app:e})}getComponentBounds(e){return this.hooks.callHook("getComponentBounds",{instance:e})}getComponentName(e){return this.hooks.callHook("getComponentName",{instance:e})}highlightElement(e){const t=e.__VUE_DEVTOOLS_NEXT_UID__;return this.hooks.callHook("componentHighlight",{uid:t})}unhighlightElement(){return this.hooks.callHook("componentUnhighlight")}};gi(),gi(),gi(),gi();var Io="__vue_devtool_undefined__",Lo="__vue_devtool_infinity__",ko="__vue_devtool_negative_infinity__",Do="__vue_devtool_nan__";gi(),gi();var zo,Uo={[Io]:"undefined",[Do]:"NaN",[Lo]:"Infinity",[ko]:"-Infinity"};function Fo(e,t){Gs.__VUE_DEVTOOLS_KIT__REGISTERED_PLUGIN_APPS__.has(e)||bo.highPerfModeEnabled&&!t?.inspectingComponent||(Gs.__VUE_DEVTOOLS_KIT__REGISTERED_PLUGIN_APPS__.add(e),wo.forEach(t=>{!function(e,t){const[n,r]=e;if(n.app!==t)return;const s=new Ro({plugin:{setupFn:r,descriptor:n},ctx:Qo});"vuex"===n.packageName&&s.on.editInspectorState(e=>{s.sendInspectorState(e.inspectorId)}),r(s)}(t,e)}))}Object.entries(Uo).reduce((e,[t,n])=>(e[n]=t,e),{}),gi(),gi(),gi(),gi(),gi(),null!=(zo=Gs).__VUE_DEVTOOLS_KIT__REGISTERED_PLUGIN_APPS__||(zo.__VUE_DEVTOOLS_KIT__REGISTERED_PLUGIN_APPS__=new Set),gi(),gi();var Bo,Vo,jo,Ho="__VUE_DEVTOOLS_ROUTER__",Yo="__VUE_DEVTOOLS_ROUTER_INFO__";function Wo(e){return e.map(e=>{let{path:t,name:n,children:r,meta:s}=e;return r?.length&&(r=Wo(r)),{path:t,name:n,children:r,meta:s}})}function Xo(e,t){function n(){var t;const n=null==(t=e.app)?void 0:t.config.globalProperties.$router,r=function(e){if(e){const{fullPath:t,hash:n,href:r,path:s,name:i,matched:o,params:a,query:l}=e;return{fullPath:t,hash:n,href:r,path:s,name:i,params:a,query:l,matched:Wo(o)}}return e}(n?.currentRoute.value),s=Wo(function(e){const t=new Map;return(e?.getRoutes()||[]).filter(e=>!t.has(e.path)&&t.set(e.path,1))}(n)),i=console.warn;console.warn=()=>{},Gs[Yo]={currentRoute:r?Qs(r):{},routes:Qs(s)},Gs[Ho]=n,console.warn=i}n(),Po.on.componentUpdated($s(()=>{var r;(null==(r=t.value)?void 0:r.app)===e.app&&(n(),!bo.highPerfModeEnabled&&Qo.hooks.callHook("routerInfoUpdated",{state:Gs[Yo]}))},200))}null!=(Bo=Gs)[Yo]||(Bo[Yo]={currentRoute:null,routes:[]}),null!=(Vo=Gs)[Ho]||(Vo[Ho]={}),new Proxy(Gs[Yo],{get:(e,t)=>Gs[Yo][t]}),new Proxy(Gs[Ho],{get(e,t){if("value"===t)return Gs[Ho]}}),gi(),null!=(jo=Gs).__VUE_DEVTOOLS_ENV__||(jo.__VUE_DEVTOOLS_ENV__={vitePluginDetected:!1});var Go,qo=function(){const e=ai();e.hook("addInspector",({inspector:e,plugin:t})=>{!function(e,t){var n,r;lo.push({options:e,descriptor:t,treeFilterPlaceholder:null!=(n=e.treeFilterPlaceholder)?n:"Search tree...",stateFilterPlaceholder:null!=(r=e.stateFilterPlaceholder)?r:"Search state...",treeFilter:"",selectedNodeId:"",appRecord:_i(t.app)}),co()}(e,t.descriptor)});const t=$s(async({inspectorId:t,plugin:n})=>{var r;if(!t||null==(r=n?.descriptor)||!r.app||bo.highPerfModeEnabled)return;const s=ho(t,n.descriptor.app),i={app:n.descriptor.app,inspectorId:t,filter:s?.treeFilter||"",rootNodes:[]};await new Promise(t=>{e.callHookWith(async e=>{await Promise.all(e.map(e=>e(i))),t()},"getInspectorTree")}),e.callHookWith(async e=>{await Promise.all(e.map(e=>e({inspectorId:t,rootNodes:i.rootNodes})))},"sendInspectorTreeToClient")},120);e.hook("sendInspectorTree",t);const n=$s(async({inspectorId:t,plugin:n})=>{var r;if(!t||null==(r=n?.descriptor)||!r.app||bo.highPerfModeEnabled)return;const s=ho(t,n.descriptor.app),i={app:n.descriptor.app,inspectorId:t,nodeId:s?.selectedNodeId||"",state:null},o={currentTab:`custom-inspector:${t}`};i.nodeId&&await new Promise(t=>{e.callHookWith(async e=>{await Promise.all(e.map(e=>e(i,o))),t()},"getInspectorState")}),e.callHookWith(async e=>{await Promise.all(e.map(e=>e({inspectorId:t,nodeId:i.nodeId,state:i.state})))},"sendInspectorStateToClient")},120);return e.hook("sendInspectorState",n),e.hook("customInspectorSelectNode",({inspectorId:e,nodeId:t,plugin:n})=>{const r=ho(e,n.descriptor.app);r&&(r.selectedNodeId=t)}),e.hook("timelineLayerAdded",({options:e,plugin:t})=>{!function(e,t){bo.timelineLayersState[t.id]=!1,no.push({...e,descriptorId:t.id,appRecord:_i(t.app)})}(e,t.descriptor)}),e.hook("timelineEventAdded",({options:t,plugin:n})=>{var r;bo.highPerfModeEnabled||(null==(r=bo.timelineLayersState)||!r[n.descriptor.id])&&!["performance","component-event","keyboard","mouse"].includes(t.layerId)||e.callHookWith(async e=>{await Promise.all(e.map(e=>e(t)))},"sendTimelineEventToClient")}),e.hook("getComponentInstances",async({app:e})=>{const t=e.__VUE_DEVTOOLS_NEXT_APP_RECORD__;if(!t)return null;const n=t.id.toString();return[...t.instanceMap].filter(([e])=>e.split(":")[0]===n).map(([,e])=>e)}),e.hook("getComponentBounds",async({instance:e})=>Oi(e)),e.hook("getComponentName",({instance:e})=>Ti(e)),e.hook("componentHighlight",({uid:e})=>{const t=yo.value.instanceMap.get(e);t&&function(e){const t=Oi(e);if(!t.width&&!t.height)return;const n=Ti(e);zi()?Bi({bounds:t,name:n}):Fi({bounds:t,name:n})}(t)}),e.hook("componentUnhighlight",()=>{Vi()}),e}();null!=(Go=Gs).__VUE_DEVTOOLS_KIT_CONTEXT__||(Go.__VUE_DEVTOOLS_KIT_CONTEXT__={hooks:qo,get state(){return{...bo,activeAppRecordId:yo.id,activeAppRecord:yo.value,appRecords:go.value}},api:function(e){return{async getInspectorTree(t){const n={...t,app:yo.value.app,rootNodes:[]};return await new Promise(t=>{e.callHookWith(async e=>{await Promise.all(e.map(e=>e(n))),t()},"getInspectorTree")}),n.rootNodes},async getInspectorState(t){const n={...t,app:yo.value.app,state:null},r={currentTab:`custom-inspector:${t.inspectorId}`};return await new Promise(t=>{e.callHookWith(async e=>{await Promise.all(e.map(e=>e(n,r))),t()},"getInspectorState")}),n.state},editInspectorState(t){const n=new Qi,r={...t,app:yo.value.app,set:(e,r=t.path,s=t.state.value,i)=>{n.set(e,r,s,i||n.createDefaultSetCallback(t.state))}};e.callHookWith(e=>{e.forEach(e=>e(r))},"editInspectorState")},sendInspectorState(t){const n=ho(t);e.callHook("sendInspectorState",{inspectorId:t,plugin:{descriptor:n.descriptor,setupFn:()=>({})}})},inspectComponentInspector:()=>Xi(),cancelInspectComponentInspector:()=>(Vi(),window.removeEventListener("mouseover",Hi),window.removeEventListener("click",Wi,!0),void(Wi=null)),getComponentRenderCode(e){const t=Ei(yo.value,e);if(t)return"function"!=typeof t?.type?t.render.toString():t.type.toString()},scrollToComponent:e=>function(e){const t=Ei(yo.value,e.id);if(t){const[n]=Ci(t);if("function"==typeof n.scrollIntoView)n.scrollIntoView({behavior:"smooth"});else{const e=Oi(t),n=document.createElement("div"),r={...Ui(e),position:"absolute"};Object.assign(n.style,r),document.body.appendChild(n),n.scrollIntoView({behavior:"smooth"}),setTimeout(()=>{document.body.removeChild(n)},2e3)}setTimeout(()=>{const n=Oi(t);if(n.width||n.height){const r=Ti(t),s=zi();s?Bi({...e,name:r,bounds:n}):Fi({...e,name:r,bounds:n}),setTimeout(()=>{s&&(s.style.display="none")},1500)}},1200)}}({id:e}),openInEditor:_o,getVueInspector:Gi,toggleApp(e,t){const n=go.value.find(t=>t.id===e);n&&(function(e){Gs.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD_ID__=e,vo()}(e),function(e){Gs.__VUE_DEVTOOLS_KIT_ACTIVE_APP_RECORD__=e,vo()}(n),Xo(n,yo),co(),Fo(n.app,t))},inspectDOM(e){const t=Ei(yo.value,e);if(t){const[e]=Ci(t);e&&(Gs.__VUE_DEVTOOLS_INSPECT_DOM_TARGET__=e)}},updatePluginSettings(e,t,n){!function(e,t,n){const r=Eo(e),s=localStorage.getItem(r),i=JSON.parse(s||"{}"),o={...i,[t]:n};localStorage.setItem(r,JSON.stringify(o)),Qo.hooks.callHookWith(r=>{r.forEach(r=>r({pluginId:e,key:t,oldValue:i[t],newValue:n,settings:o}))},"setPluginSettings")}(e,t,n)},getPluginSettings:e=>({options:So(e),values:Ao(e)})}}(qo)});var Zo,Ko,Qo=Gs.__VUE_DEVTOOLS_KIT_CONTEXT__;gi(),((e,t,n)=>{n=null!=e?ci(pi(e)):{},((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of di(t))!mi.call(e,s)&&s!==n&&ui(e,s,{get:()=>t[s],enumerable:!(r=hi(t,s))||r.enumerable})})(ui(n,"default",{value:e,enumerable:!0}),e)})(vi()),null!=(Zo=Gs).__VUE_DEVTOOLS_NEXT_APP_RECORD_INFO__||(Zo.__VUE_DEVTOOLS_NEXT_APP_RECORD_INFO__={id:0,appIds:new Set}),gi(),gi(),gi(),gi(),gi(),null!=(Ko=Gs).__VUE_DEVTOOLS_UPDATE_CLIENT_DETECTED__||(Ko.__VUE_DEVTOOLS_UPDATE_CLIENT_DETECTED__=function(e){bo.devtoolsClientDetected={...bo.devtoolsClientDetected,...e},function(e){bo.highPerfModeEnabled=e??!bo.highPerfModeEnabled,!e&&yo.value&&Fo(yo.value.app)}(!Object.values(bo.devtoolsClientDetected).some(Boolean))}),gi(),gi(),gi(),gi(),gi(),gi(),gi();var Jo=class{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,t){this.keyToValue.set(e,t),this.valueToKey.set(t,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}},$o=class{constructor(e){this.generateIdentifier=e,this.kv=new Jo}register(e,t){this.kv.getByValue(e)||(t||(t=this.generateIdentifier(e)),this.kv.set(t,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}},ea=class extends $o{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,t){"object"==typeof t?(t.allowProps&&this.classToAllowedProps.set(e,t.allowProps),super.register(e,t.identifier)):super.register(e,t)}getAllowedProps(e){return this.classToAllowedProps.get(e)}};function ta(e,t){const n=function(e){if("values"in Object)return Object.values(e);const t=[];for(const n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}(e);if("find"in n)return n.find(t);const r=n;for(let s=0;s<r.length;s++){const e=r[s];if(t(e))return e}}function na(e,t){Object.entries(e).forEach(([e,n])=>t(n,e))}function ra(e,t){return-1!==e.indexOf(t)}function sa(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(t(r))return r}}gi(),gi();var ia=class{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return ta(this.transfomers,t=>t.isApplicable(e))}findByName(e){return this.transfomers[e]}};gi(),gi();var oa=e=>typeof e>"u",aa=e=>"object"==typeof e&&null!==e&&e!==Object.prototype&&(null===Object.getPrototypeOf(e)||Object.getPrototypeOf(e)===Object.prototype),la=e=>aa(e)&&0===Object.keys(e).length,ca=e=>Array.isArray(e),ua=e=>e instanceof Map,ha=e=>e instanceof Set,da=e=>"Symbol"===(e=>Object.prototype.toString.call(e).slice(8,-1))(e),pa=e=>"number"==typeof e&&isNaN(e),ma=e=>(e=>"boolean"==typeof e)(e)||(e=>null===e)(e)||oa(e)||(e=>"number"==typeof e&&!isNaN(e))(e)||(e=>"string"==typeof e)(e)||da(e);gi();var fa=e=>e.replace(/\./g,"\\."),ga=e=>e.map(String).map(fa).join("."),ya=e=>{const t=[];let n="";for(let s=0;s<e.length;s++){let r=e.charAt(s);"\\"!==r||"."!==e.charAt(s+1)?"."!==r?n+=r:(t.push(n),n=""):(n+=".",s++)}const r=n;return t.push(r),t};function va(e,t,n,r){return{isApplicable:e,annotation:t,transform:n,untransform:r}}gi();var xa=[va(oa,"undefined",()=>null,()=>{}),va(e=>"bigint"==typeof e,"bigint",e=>e.toString(),e=>typeof BigInt<"u"?BigInt(e):(console.error("Please add a BigInt polyfill."),e)),va(e=>e instanceof Date&&!isNaN(e.valueOf()),"Date",e=>e.toISOString(),e=>new Date(e)),va(e=>e instanceof Error,"Error",(e,t)=>{const n={name:e.name,message:e.message};return t.allowedErrorProps.forEach(t=>{n[t]=e[t]}),n},(e,t)=>{const n=new Error(e.message);return n.name=e.name,n.stack=e.stack,t.allowedErrorProps.forEach(t=>{n[t]=e[t]}),n}),va(e=>e instanceof RegExp,"regexp",e=>""+e,e=>{const t=e.slice(1,e.lastIndexOf("/")),n=e.slice(e.lastIndexOf("/")+1);return new RegExp(t,n)}),va(ha,"set",e=>[...e.values()],e=>new Set(e)),va(ua,"map",e=>[...e.entries()],e=>new Map(e)),va(e=>pa(e)||(e=>e===1/0||e===-1/0)(e),"number",e=>pa(e)?"NaN":e>0?"Infinity":"-Infinity",Number),va(e=>0===e&&1/e==-1/0,"number",()=>"-0",Number),va(e=>e instanceof URL,"URL",e=>e.toString(),e=>new URL(e))];function ba(e,t,n,r){return{isApplicable:e,annotation:t,transform:n,untransform:r}}var _a=ba((e,t)=>!!da(e)&&!!t.symbolRegistry.getIdentifier(e),(e,t)=>["symbol",t.symbolRegistry.getIdentifier(e)],e=>e.description,(e,t,n)=>{const r=n.symbolRegistry.getValue(t[1]);if(!r)throw new Error("Trying to deserialize unknown symbol");return r}),wa=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((e,t)=>(e[t.name]=t,e),{}),Ta=ba(e=>ArrayBuffer.isView(e)&&!(e instanceof DataView),e=>["typed-array",e.constructor.name],e=>[...e],(e,t)=>{const n=wa[t[1]];if(!n)throw new Error("Trying to deserialize unknown typed array");return new n(e)});function Ea(e,t){return!!e?.constructor&&!!t.classRegistry.getIdentifier(e.constructor)}var Sa=ba(Ea,(e,t)=>["class",t.classRegistry.getIdentifier(e.constructor)],(e,t)=>{const n=t.classRegistry.getAllowedProps(e.constructor);if(!n)return{...e};const r={};return n.forEach(t=>{r[t]=e[t]}),r},(e,t,n)=>{const r=n.classRegistry.getValue(t[1]);if(!r)throw new Error(`Trying to deserialize unknown class '${t[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(r.prototype),e)}),Aa=ba((e,t)=>!!t.customTransformerRegistry.findApplicable(e),(e,t)=>["custom",t.customTransformerRegistry.findApplicable(e).name],(e,t)=>t.customTransformerRegistry.findApplicable(e).serialize(e),(e,t,n)=>{const r=n.customTransformerRegistry.findByName(t[1]);if(!r)throw new Error("Trying to deserialize unknown custom value");return r.deserialize(e)}),Ma=[Sa,_a,Aa,Ta],Oa=(e,t)=>{const n=sa(Ma,n=>n.isApplicable(e,t));if(n)return{value:n.transform(e,t),type:n.annotation(e,t)};const r=sa(xa,n=>n.isApplicable(e,t));return r?{value:r.transform(e,t),type:r.annotation}:void 0},Ca={};xa.forEach(e=>{Ca[e.annotation]=e});gi();var Na=(e,t)=>{if(t>e.size)throw new Error("index out of bounds");const n=e.keys();for(;t>0;)n.next(),t--;return n.next().value};function Pa(e){if(ra(e,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(ra(e,"prototype"))throw new Error("prototype is not allowed as a property");if(ra(e,"constructor"))throw new Error("constructor is not allowed as a property")}var Ra=(e,t,n)=>{if(Pa(t),0===t.length)return n(e);let r=e;for(let i=0;i<t.length-1;i++){const e=t[i];if(ca(r)){r=r[+e]}else if(aa(r))r=r[e];else if(ha(r)){r=Na(r,+e)}else if(ua(r)){if(i===t.length-2)break;const n=+e,s=0==+t[++i]?"key":"value",o=Na(r,n);switch(s){case"key":r=o;break;case"value":r=r.get(o)}}}const s=t[t.length-1];if(ca(r)?r[+s]=n(r[+s]):aa(r)&&(r[s]=n(r[s])),ha(r)){const e=Na(r,+s),t=n(e);e!==t&&(r.delete(e),r.add(t))}if(ua(r)){const e=+t[t.length-2],i=Na(r,e);switch(0==+s?"key":"value"){case"key":{const e=n(i);r.set(e,r.get(i)),e!==i&&r.delete(i);break}case"value":r.set(i,n(r.get(i)))}}return e};function Ia(e,t,n=[]){if(!e)return;if(!ca(e))return void na(e,(e,r)=>Ia(e,t,[...n,...ya(r)]));const[r,s]=e;s&&na(s,(e,r)=>{Ia(e,t,[...n,...ya(r)])}),t(r,n)}function La(e,t,n){return Ia(t,(t,r)=>{e=Ra(e,r,e=>((e,t,n)=>{if(!ca(t)){const r=Ca[t];if(!r)throw new Error("Unknown transformation: "+t);return r.untransform(e,n)}switch(t[0]){case"symbol":return _a.untransform(e,t,n);case"class":return Sa.untransform(e,t,n);case"custom":return Aa.untransform(e,t,n);case"typed-array":return Ta.untransform(e,t,n);default:throw new Error("Unknown transformation: "+t)}})(e,t,n))}),e}function ka(e,t){function n(t,n){const r=((e,t)=>{Pa(t);for(let n=0;n<t.length;n++){const r=t[n];if(ha(e))e=Na(e,+r);else if(ua(e)){const s=+r,i=0==+t[++n]?"key":"value",o=Na(e,s);switch(i){case"key":e=o;break;case"value":e=e.get(o)}}else e=e[r]}return e})(e,ya(n));t.map(ya).forEach(t=>{e=Ra(e,t,()=>r)})}if(ca(t)){const[r,s]=t;r.forEach(t=>{e=Ra(e,ya(t),()=>e)}),s&&na(s,n)}else na(t,n);return e}var Da=(e,t,n,r,s=[],i=[],o=new Map)=>{var a;const l=ma(e);if(!l){!function(e,t,n){const r=n.get(e);r?r.push(t):n.set(e,[t])}(e,s,t);const n=o.get(e);if(n)return r?{transformedValue:null}:n}if(!((e,t)=>aa(e)||ca(e)||ua(e)||ha(e)||Ea(e,t))(e,n)){const t=Oa(e,n),r=t?{transformedValue:t.value,annotations:[t.type]}:{transformedValue:e};return l||o.set(e,r),r}if(ra(i,e))return{transformedValue:null};const c=Oa(e,n),u=null!=(a=c?.value)?a:e,h=ca(u)?[]:{},d={};na(u,(a,l)=>{if("__proto__"===l||"constructor"===l||"prototype"===l)throw new Error(`Detected property ${l}. This is a prototype pollution risk, please remove it from your object.`);const c=Da(a,t,n,r,[...s,l],[...i,e],o);h[l]=c.transformedValue,ca(c.annotations)?d[l]=c.annotations:aa(c.annotations)&&na(c.annotations,(e,t)=>{d[fa(l)+"."+t]=e})});const p=la(d)?{transformedValue:h,annotations:c?[c.type]:void 0}:{transformedValue:h,annotations:c?[c.type,d]:d};return l||o.set(e,p),p};function za(e){return Object.prototype.toString.call(e).slice(8,-1)}function Ua(e){return"Array"===za(e)}function Fa(e,t={}){if(Ua(e))return e.map(e=>Fa(e,t));if(!function(e){if("Object"!==za(e))return!1;const t=Object.getPrototypeOf(e);return!!t&&t.constructor===Object&&t===Object.prototype}(e))return e;return[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)].reduce((n,r)=>{if(Ua(t.props)&&!t.props.includes(r))return n;return function(e,t,n,r,s){const i={}.propertyIsEnumerable.call(r,t)?"enumerable":"nonenumerable";"enumerable"===i&&(e[t]=n),s&&"nonenumerable"===i&&Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!0,configurable:!0})}(n,r,Fa(e[r],t),e,t.nonenumerable),n},{})}gi(),gi();var Ba,Va,ja,Ha,Ya,Wa,Xa=class{constructor({dedupe:e=!1}={}){this.classRegistry=new ea,this.symbolRegistry=new $o(e=>{var t;return null!=(t=e.description)?t:""}),this.customTransformerRegistry=new ia,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const t=new Map,n=Da(e,t,this,this.dedupe),r={json:n.transformedValue};n.annotations&&(r.meta={...r.meta,values:n.annotations});const s=function(e,t){const n={};let r;return e.forEach(e=>{if(e.length<=1)return;t||(e=e.map(e=>e.map(String)).sort((e,t)=>e.length-t.length));const[s,...i]=e;0===s.length?r=i.map(ga):n[ga(s)]=i.map(ga)}),r?la(n)?[r]:[r,n]:la(n)?void 0:n}(t,this.dedupe);return s&&(r.meta={...r.meta,referentialEqualities:s}),r}deserialize(e){const{json:t,meta:n}=e;let r=Fa(t);return n?.values&&(r=La(r,n.values,this)),n?.referentialEqualities&&(r=ka(r,n.referentialEqualities)),r}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e))}registerClass(e,t){this.classRegistry.register(e,t)}registerSymbol(e,t){this.symbolRegistry.register(e,t)}registerCustom(e,t){this.customTransformerRegistry.register({name:t,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}};function Ga(e,t){throw new Error(e+t)}function qa(e){let t=0;return e.traverse(e=>{if(or(e)&&"HightlightMesh"!==e.type){const n=e.geometry,r=3*n.attributes.position.count*Float32Array.BYTES_PER_ELEMENT,s=n.index?n.index.count*Uint32Array.BYTES_PER_ELEMENT:0,i=n.attributes.normal?3*n.attributes.normal.count*Float32Array.BYTES_PER_ELEMENT:0,o=n.attributes.uv?2*n.attributes.uv.count*Float32Array.BYTES_PER_ELEMENT:0;t+=r+s+i+o}}),t}function Za(e,t,n){e.push(t),e.length>n&&e.shift()}function Ka(e){return(e/1024).toFixed(2)}function Qa(e){if(!e)return;typeof window<"u"&&!window.__TRES__DEVTOOLS__&&(window.__TRES__DEVTOOLS__=new Ls);const t={maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},n=Rn({every:100}),{isSupported:r,memory:s}=In({interval:100});let i=performance.now(),o=0;const{pause:a}=Pn(({delta:a})=>{window.__TRES__DEVTOOLS__&&((({timestamp:o})=>{e.scene.value&&(t.memory.allocatedMem=qa(e.scene.value)),o-i>=100&&(i=o,Za(t.fps.accumulator,n.value,160),t.fps.value=n.value,r.value&&s.value?.usedJSHeapSize&&(Za(t.memory.accumulator,s.value.usedJSHeapSize/1024/1024,160),t.memory.accumulator.length>0&&(t.memory.currentMem=t.memory.accumulator.reduce((e,t)=>e+t,0)/t.memory.accumulator.length)))})({timestamp:performance.now()}),o+=a,o>=1&&(window.__TRES__DEVTOOLS__.send("context",e),window.__TRES__DEVTOOLS__.send("performance",t),o=0))},{immediate:!0});Pt(()=>{a()})}Xa.defaultInstance=new Xa,Xa.serialize=Xa.defaultInstance.serialize.bind(Xa.defaultInstance),Xa.deserialize=Xa.defaultInstance.deserialize.bind(Xa.defaultInstance),Xa.stringify=Xa.defaultInstance.stringify.bind(Xa.defaultInstance),Xa.parse=Xa.defaultInstance.parse.bind(Xa.defaultInstance),Xa.registerClass=Xa.defaultInstance.registerClass.bind(Xa.defaultInstance),Xa.registerSymbol=Xa.defaultInstance.registerSymbol.bind(Xa.defaultInstance),Xa.registerCustom=Xa.defaultInstance.registerCustom.bind(Xa.defaultInstance),Xa.allowErrorProps=Xa.defaultInstance.allowErrorProps.bind(Xa.defaultInstance),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),gi(),null!=(Ba=Gs).__VUE_DEVTOOLS_KIT_MESSAGE_CHANNELS__||(Ba.__VUE_DEVTOOLS_KIT_MESSAGE_CHANNELS__=[]),null!=(Va=Gs).__VUE_DEVTOOLS_KIT_RPC_CLIENT__||(Va.__VUE_DEVTOOLS_KIT_RPC_CLIENT__=null),null!=(ja=Gs).__VUE_DEVTOOLS_KIT_RPC_SERVER__||(ja.__VUE_DEVTOOLS_KIT_RPC_SERVER__=null),null!=(Ha=Gs).__VUE_DEVTOOLS_KIT_VITE_RPC_CLIENT__||(Ha.__VUE_DEVTOOLS_KIT_VITE_RPC_CLIENT__=null),null!=(Ya=Gs).__VUE_DEVTOOLS_KIT_VITE_RPC_SERVER__||(Ya.__VUE_DEVTOOLS_KIT_VITE_RPC_SERVER__=null),null!=(Wa=Gs).__VUE_DEVTOOLS_KIT_BROADCAST_RPC_SERVER__||(Wa.__VUE_DEVTOOLS_KIT_BROADCAST_RPC_SERVER__=null),gi(),gi(),gi(),gi(),gi(),gi(),gi();const Ja=(e,t)=>{if(e.uuid===t)return e;for(const n of e.children){const e=Ja(n,t);if(e)return e}};class $a extends p{type="HightlightMesh";createTime;constructor(...e){super(...e),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,t=1+.07*Math.sin(2.5*e);this.scale.set(t,t,t)}}const el=e=>{const t={id:`scene-${e.uuid}`,label:e.type,children:[],tags:[]};""!==e.name&&t.tags.push({label:e.name,textColor:5750629,backgroundColor:15793395});const n=qa(e);return n>0&&t.tags.push({label:`${Ka(n)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),e.type.includes("Light")&&(mr(e)&&t.tags.push({label:`${e.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),t.tags.push({label:`#${new g(e.color).getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),e.type.includes("Camera")&&(t.tags.push({label:`${e.fov}°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),t.tags.push({label:`x: ${Math.round(e.position.x)} y: ${Math.round(e.position.y)} z: ${Math.round(e.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),t};function tl(e,t,n=""){e.children.forEach(e=>{if("HightlightMesh"===e.type||n&&!e.type.includes(n)&&!e.name.includes(n))return;const r=el(e);t.children.push(r),tl(e,r,n)})}function nl(e,t,n=new WeakSet,r=0,s=4,i,o=""){if(r>=s||!e||n.has(e))return;const a=0===r?e?.scene?.value?.uuid||Math.random().toString(36).slice(2,11):i;n.add(e),Object.entries(e).forEach(([e,i])=>{if(e.startsWith("_")||"function"==typeof i)return;const l=o?`${o}.${e}`:e,c=function(e,t,n=""){return{id:`context-${t}-${n?`${n}.${e}`:e}`,label:e,children:[],tags:[]}}(e,a,o);"scene"!==e&&(Ht(i)?(c.tags.push({label:`Ref<${typeof i.value}>`,textColor:4372611,backgroundColor:15793395}),i.value&&"object"==typeof i.value?nl(i.value,c,n,r+1,s,a,l):c.label=`${e}: ${JSON.stringify(i.value)}`):i&&"object"==typeof i&&!Array.isArray(i)?Object.keys(i).length>0?n.has(i)?c.tags.push({label:"Circular",textColor:16711680,backgroundColor:16773360}):nl(i,c,n,r+1,s,a,l):c.label=`${e}: {}`:Array.isArray(i)?(c.label=`${e}: Array(${i.length})`,c.tags.push({label:`length: ${i.length}`,textColor:9738662,backgroundColor:16316922})):c.label=`${e}: ${JSON.stringify(i)}`,t.children.push(c))})}const rl=e=>t=>{if(t.inspectorId===il){const n=el(e.scene.value);tl(e.scene.value,n,t.filter);const r={id:"context-root",label:"Context",children:[],tags:[]};nl(e,r),t.rootNodes=[n,r]}},sl=e=>t=>{if(t.inspectorId===il&&t.nodeId.includes("scene")){const n=t.nodeId.match(/^scene-(.+)$/),r=n?n[1]:null;if(!r)return;((e,t,n,r)=>{const s=Ja(e,t);if(!s)return void console.warn("Object with UUID not found in the scene.");let i=s;for(let a=0;a<n.length-1;a++){if(void 0===i[n[a]])return void console.warn(`Property path is not valid: ${n.join(".")}`);i=i[n[a]]}const o=n[n.length-1];void 0!==i[o]?i[o]=r:console.warn(`Property path is not valid: ${n.join(".")}`)})(e.scene.value,r,t.path,t.state.value)}},il="tres:inspector";function ol(e,t){const n={id:"dev.esm.tres",label:"TresJS 🪐",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://docs.tresjs.org",app:e};Qa(t),function(e,t){Po.setupDevToolsPlugin(e,t)}(n,e=>{"function"!=typeof e.now&&function(e,t){const n=`▲ ■ ●${e}`;Ga(n,t)}("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),e.addInspector({id:il,label:"TresJS 🪐",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{e.sendInspectorTree(il)},1e3),setInterval(()=>{e.notifyComponentUpdate()},5e3),e.on.getInspectorTree(rl(t)),e.on.getInspectorState(((e,{highlightMesh:t,prevInstance:n})=>r=>{if(r.inspectorId!==il)return;const s=new m({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:N});if(r.nodeId.includes("scene")){const i=r.nodeId.match(/^scene-(.+)$/),o=i?i[1]:null;if(!o)return;const[a]=e.scene.value.getObjectsByProperty("uuid",o);if(!a)return;if(n&&t&&t.parent&&n.remove(t),or(a)){const e=new $a(a.geometry.clone(),s);a.add(e),t=e,n=a}if(r.state={object:Object.entries(a).map(([e,t])=>"children"===e?{key:e,value:t.filter(e=>"HightlightMesh"!==e.type)}:{key:e,value:t,editable:!0}).filter(({key:e})=>"parent"!==e)},gr(a)){const t={...r.state,state:[{key:"Scene Info",value:{objects:a.children.length,memory:qa(a),calls:e.renderer.instance.info.render.calls,triangles:e.renderer.instance.info.render.triangles,points:e.renderer.instance.info.render.points,lines:e.renderer.instance.info.render.lines}}]};"programs"in e.renderer.instance.info&&t.state.push({key:"Programs",value:e.renderer.instance.info.programs?.map(e=>({...e,programName:e.name}))}),r.state=t}}else if(r.nodeId.includes("context")){const t=r.nodeId.match(/^context-([^-]+(?:-[^-]+)*)-(.+)$/),n=t?t[2]:"context";if(!n||"context"===n)return void(r.state={object:Object.entries(e).filter(([e])=>!e.startsWith("_")&&"parent"!==e).map(([e,t])=>({key:e,value:Ht(t)?t.value:t,editable:!1}))});const s=n.split(".");let i=e;for(const e of s){if(!i||"object"!=typeof i)break;i=Ht(i[e])?i[e].value:i[e]}void 0!==i&&(r.state={object:Object.entries(i).filter(([e])=>!e.startsWith("_")&&"parent"!==e).map(([e,t])=>Ht(t)?{key:e,value:t.value,editable:!1}:"function"==typeof t?{key:e,value:"ƒ()",editable:!1}:t&&"object"==typeof t?{key:e,value:Array.isArray(t)?`Array(${t.length})`:"Object",editable:!1}:{key:e,value:t,editable:!1})})}})(t,{highlightMesh:null,prevInstance:null})),e.on.editInspectorState(sl(t))})}const al=["data-scene","data-tres"],ll=Tt({__name:"TresCanvas",props:{camera:{},windowSize:{type:Boolean,default:void 0},enableProvideBridge:{type:Boolean,default:!0},antialias:{type:Boolean,default:!0},stencil:{type:Boolean,default:void 0},depth:{type:Boolean,default:void 0},precision:{},logarithmicDepthBuffer:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0},clearColor:{default:"#000000"},clearAlpha:{default:1},shadows:{type:Boolean,default:void 0},toneMapping:{default:t},shadowMapType:{default:e},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},dpr:{},renderer:{}},emits:["ready","pointermissed","render","beforeLoop","loop","click","contextmenu","pointermove","pointerenter","pointerleave","pointerover","pointerout","dblclick","pointerdown","pointerup","pointercancel","lostpointercapture","wheel"],setup(e,{expose:t,emit:i}){const o=e,a=i,l=Et(),c=St(),u=At(new n),h=Ft();zr(C);const d=(e,t=!1)=>{const n=((e,t=!1)=>Tt({setup(){const n=Ft()?.appContext;n&&(n.app=h?.appContext.app);const r={};return h?.parent&&o.enableProvideBridge&&(function e(t){t&&(t.parent&&e(t.parent),t.provides&&Object.assign(r,t.provides))}(h.parent),Reflect.ownKeys(r).forEach(e=>{Bt(e,r[e])})),Bt("useTres",e),Bt("extend",zr),typeof window<"u"&&n?.app&&ol(n?.app,e),()=>zt(Vt,null,t?[]:l.default())}}))(e,t),{render:r}=Dt(Rs(e));r(zt(n),u.value)},p=(e,t=!1)=>{Sr(e.scene.value),t&&(e.renderer.instance.dispose(),e.renderer.instance instanceof r&&(e.renderer.instance.renderLists.dispose(),e.renderer.instance.forceContextLoss())),u.value.__tres={root:e}},m=At(null);t({context:m,dispose:()=>p(m.value,!0)});return Ot(()=>{const e=c;m.value=Es({scene:u.value,canvas:e,windowSize:o.windowSize??!1,rendererOptions:o});const{camera:t,renderer:n}=m.value,{registerCamera:r,cameras:i,activeCamera:l,deregisterCamera:h}=t;d(m.value);m.value.events.onPointerMissed(e=>{a("pointermissed",e)}),Ct(()=>o.camera,(e,t)=>{e&&r(Nt(e),!0),t&&(Nt(t).removeFromParent(),h(Nt(t)))},{immediate:!0}),l.value||(()=>{const e=new s(45,window.innerWidth/window.innerHeight,.1,1e3);e.position.set(3,3,3),e.lookAt(0,0,0),r(e);const t=Ut(()=>{i.value.length>=2&&(e.removeFromParent(),h(e),t?.())})})(),n.onRender(()=>{m.value&&a("render",m.value)}),n.loop.onLoop(e=>{m.value&&a("loop",{...m.value,...e})}),n.loop.onBeforeLoop(e=>{m.value&&a("beforeLoop",{...m.value,...e})}),n.onReady(()=>{a("ready",m.value)})}),Ot(async()=>{await On(3e3),m.value&&(!m.value.sizes.width||!m.value.sizes.height.value)&&console.warn("TresCanvas: The canvas has no area, so nothing can be rendered. Set it manually on the parent element or use the prop windowSize.")}),Pt(()=>{p(m.value),d(m.value,!0)}),(t,n)=>(Rt(),Mt("canvas",{ref_key:"canvasRef",ref:c,"data-scene":u.value.uuid,class:kt(t.$attrs.class),"data-tres":`tresjs ${Lt(Gn).version}`,style:It({display:"block",width:"100%",height:"100%",position:e.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...t.$attrs.style})},null,14,al))}});function cl(e){return e instanceof g?e:Array.isArray(e)?new g(...e):new g(e)}let ul,hl,dl=class extends c{constructor(e,t){const n=new u;n.setAttribute("position",new h([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();super(n,new d({fog:!1})),this.light=e,this.color=t,this.type="RectAreaLightHelper";const r=new u;r.setAttribute("position",new h([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new p(r,new m({side:f,fog:!1})))}updateMatrixWorld(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);const e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this.children[0].matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}};const pl={DirectionalLight:l,PointLight:a,SpotLight:o,HemisphereLight:i,RectAreaLight:dl},ml={mounted:e=>{mr(e)?(ul=pl[e.type],e.parent?.add(new ul(e,1,e.color.getHex()))):Tr(`${e.type} is not a light`)},updated:e=>{hl=e.parent.children.find(e=>e instanceof ul),!(hl instanceof dl)&&hl.update()},unmounted:e=>{e.isLight?(hl=e.parent.children.find(e=>e instanceof ul),hl&&hl.dispose&&hl.dispose(),e.parent&&e.parent.remove(hl)):Tr(`${e.type} is not a light`)}},fl={install(e){e.component("TresCanvas",ll)}};const gl=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const yl=Object.prototype.toString,vl=()=>{};function xl(e){return Array.isArray(e)?e:[e]}function bl(e,t,n){return Ct(e,(e,n,r)=>{e&&t(e,n,r)},{...n,once:!1})}const _l=gl?window:void 0;function wl(...e){const t=[],n=()=>{t.forEach(e=>e()),t.length=0},r=Yt(()=>{const t=xl(Nt(e[0])).filter(e=>null!=e);return t.every(e=>"string"!=typeof e)?t:void 0}),s=function(e,t,n){return Ct(e,t,{...n,immediate:!0})}(()=>{var t,n;return[null!=(n=null==(t=r.value)?void 0:t.map(e=>function(e){var t;const n=Nt(e);return null!=(t=n?.$el)?t:n}(e)))?n:[_l].filter(e=>null!=e),xl(Nt(r.value?e[1]:e[0])),xl(Lt(r.value?e[2]:e[1])),Nt(r.value?e[3]:e[2])]},([e,r,s,i])=>{if(n(),!e?.length||!r?.length||!s?.length)return;const o=(e=>"[object Object]"===yl.call(e))(i)?{...i}:i;t.push(...e.flatMap(e=>r.flatMap(t=>s.map(n=>((e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)))(e,t,n,o)))))},{flush:"post"});return function(e){!!sn()&&on(e)}(n),()=>{s(),n()}}const Tl={ctrl:"control",command:"meta",cmd:"meta",option:"alt",up:"arrowup",down:"arrowdown",left:"arrowleft",right:"arrowright"};function El(e,t,n,r){const s=class extends K{key="";constructor(r={}){const s=Object.entries(e);super({uniforms:s.reduce((e,[t,n])=>({...e,...ne.clone({[t]:{value:n}})}),{}),vertexShader:t,fragmentShader:n}),s.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})),Object.assign(this,r)}};return s.key=R.generateUUID(),s}function Sl(e){return Ir(F,e,{initialValue:new U})}El({color:new g("white"),scale:new T(1,1),imageBounds:new T(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n    varying vec2 vUv;\n    varying vec2 vPos;\n    void main() {\n      gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n      vUv = uv;\n      vPos = position.xy;\n    }\n  ","\n    // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n    varying vec2 vUv;\n    varying vec2 vPos;\n    uniform vec2 scale;\n    uniform vec2 imageBounds;\n    uniform float resolution;\n    uniform vec3 color;\n    uniform sampler2D map;\n    uniform float radius;\n    uniform float zoom;\n    uniform float grayscale;\n    uniform float opacity;\n    const vec3 luma = vec3(.299, 0.587, 0.114);\n    vec4 toGrayscale(vec4 color, float intensity) {\n      return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n    }\n    vec2 aspect(vec2 size) {\n      return size / min(size.x, size.y);\n    }\n    \n    const float PI = 3.14159265;\n      \n    // from https://iquilezles.org/articles/distfunctions\n    float udRoundBox( vec2 p, vec2 b, float r ) {\n      return length(max(abs(p)-b+r,0.0))-r;\n    }\n  \n    void main() {\n      vec2 s = aspect(scale);\n      vec2 i = aspect(imageBounds);\n      float rs = s.x / s.y;\n      float ri = i.x / i.y;\n      vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n      vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n      vec2 uv = vUv * s / new + offset;\n      vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n  \n      vec2 res = vec2(scale * resolution);\n      vec2 halfRes = 0.5 * res;\n      float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n        vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n      gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n      \n      #include <tonemapping_fragment>\n      #include <colorspace_fragment>\n    }\n  "),function(){const e=new u,t=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),n=new Ie(t,5);e.setIndex([0,1,2,0,2,3]),e.setAttribute("position",new et(n,3,0,!1)),e.setAttribute("uv",new et(n,2,3,!1))}(),R.clamp,R.lerp;const Al=Tt({__name:"Levioso",props:{speed:{default:1},rotationFactor:{default:1},floatFactor:{default:1},range:{default:()=>[-.1,.1]}},setup(e,{expose:t}){const n=e,r=At();t({instance:r});{const e=1e4*Math.random(),{onBeforeRender:t}=Os();let s=e;t(({delta:e})=>{if(!r.value)return;s+=e*n.speed;const t=.25*s,i=r.value;i.rotation.x=.125*Math.cos(t)*n.rotationFactor,i.rotation.y=.125*Math.sin(t)*n.rotationFactor,i.rotation.z=.05*Math.sin(t)*n.rotationFactor,i.position.y=R.mapLinear(Math.sin(t),-1,1,n.range[0],n.range[1])*n.floatFactor})}return(e,t)=>(Rt(),Mt("TresGroup",Kt(e.$attrs,{ref_key:"groupRef",ref:r}),[Zt(e.$slots,"default")],16))}}),Ml=parseInt(Te.replace(/\D+/g,""));function Ol(e,t){if(t===it)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===ot||t===at){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const r=n.count-2,s=[];if(n)if(t===ot)for(let e=1;e<=r;e++)s.push(n.getX(0)),s.push(n.getX(e)),s.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(s.push(n.getX(e)),s.push(n.getX(e+1)),s.push(n.getX(e+2))):(s.push(n.getX(e+2)),s.push(n.getX(e+1)),s.push(n.getX(e)));s.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=e.clone();return i.setIndex(s),i.clearGroups(),i}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}var Cl=Uint8Array,Nl=Uint16Array,Pl=Uint32Array,Rl=new Cl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Il=new Cl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ll=function(e,t){for(var n=new Nl(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var s=new Pl(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)s[i]=i-n[r]<<5|r;return[n,s]},kl=Ll(Rl,2),Dl=kl[0],zl=kl[1];Dl[28]=258,zl[258]=28,Ll(Il,0);for(var Ul=new Nl(32768),Fl=0;Fl<32768;++Fl){var Bl=(43690&Fl)>>>1|(21845&Fl)<<1;Bl=(61680&(Bl=(52428&Bl)>>>2|(13107&Bl)<<2))>>>4|(3855&Bl)<<4,Ul[Fl]=((65280&Bl)>>>8|(255&Bl)<<8)>>>1}var Vl=new Cl(288);for(Fl=0;Fl<144;++Fl)Vl[Fl]=8;for(Fl=144;Fl<256;++Fl)Vl[Fl]=9;for(Fl=256;Fl<280;++Fl)Vl[Fl]=7;for(Fl=280;Fl<288;++Fl)Vl[Fl]=8;var jl=new Cl(32);for(Fl=0;Fl<32;++Fl)jl[Fl]=5;var Hl=new Cl(0),Yl=typeof TextDecoder<"u"&&new TextDecoder;try{Yl.decode(Hl,{stream:!0})}catch{}var Wl=Object.defineProperty,Xl=(e,t,n)=>(((e,t,n)=>{t in e?Wl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n),n);const Gl=(()=>{const e=class extends p{constructor(t,n={}){super(t),this.isReflector=!0,this.type="Reflector",this.camera=new s;const r=this,i=void 0!==n.color?new g(n.color):new g(8355711),o=n.textureWidth||512,a=n.textureHeight||512,l=n.clipBias||0,c=n.shader||e.ReflectorShader,u=void 0!==n.multisample?n.multisample:4,h=new A,d=new b,p=new b,m=new b,f=new E,y=new b(0,0,-1),v=new Q,x=new b,_=new b,w=new Q,T=new E,S=this.camera,M=new X(o,a,{samples:u,type:j}),O=new K({uniforms:ne.clone(c.uniforms),fragmentShader:c.fragmentShader,vertexShader:c.vertexShader});O.uniforms.tDiffuse.value=M.texture,O.uniforms.color.value=i,O.uniforms.textureMatrix.value=T,this.material=O,this.onBeforeRender=function(e,t,n){if(p.setFromMatrixPosition(r.matrixWorld),m.setFromMatrixPosition(n.matrixWorld),f.extractRotation(r.matrixWorld),d.set(0,0,1),d.applyMatrix4(f),x.subVectors(p,m),x.dot(d)>0)return;x.reflect(d).negate(),x.add(p),f.extractRotation(n.matrixWorld),y.set(0,0,-1),y.applyMatrix4(f),y.add(m),_.subVectors(p,y),_.reflect(d).negate(),_.add(p),S.position.copy(x),S.up.set(0,1,0),S.up.applyMatrix4(f),S.up.reflect(d),S.lookAt(_),S.far=n.far,S.updateMatrixWorld(),S.projectionMatrix.copy(n.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(S.projectionMatrix),T.multiply(S.matrixWorldInverse),T.multiply(r.matrixWorld),h.setFromNormalAndCoplanarPoint(d,p),h.applyMatrix4(S.matrixWorldInverse),v.set(h.normal.x,h.normal.y,h.normal.z,h.constant);const s=S.projectionMatrix;w.x=(Math.sign(v.x)+s.elements[8])/s.elements[0],w.y=(Math.sign(v.y)+s.elements[9])/s.elements[5],w.z=-1,w.w=(1+s.elements[10])/s.elements[14],v.multiplyScalar(2/v.dot(w)),s.elements[2]=v.x,s.elements[6]=v.y,s.elements[10]=v.z+1-l,s.elements[14]=v.w,r.visible=!1;const i=e.getRenderTarget(),o=e.xr.enabled,a=e.shadowMap.autoUpdate,c=e.toneMapping;let u=!1;u="outputColorSpace"in e?"srgb"===e.outputColorSpace:3001===e.outputEncoding,e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,"outputColorSpace"in e?e.outputColorSpace="srgb-linear":e.outputEncoding=3e3,e.toneMapping=ct,e.setRenderTarget(M),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,S),e.xr.enabled=o,e.shadowMap.autoUpdate=a,e.toneMapping=c,"outputColorSpace"in e?e.outputColorSpace=u?"srgb":"srgb-linear":e.outputEncoding=u?3001:3e3,e.setRenderTarget(i);const g=n.viewport;void 0!==g&&e.state.viewport(g),r.visible=!0},this.getRenderTarget=function(){return M},this.dispose=function(){M.dispose(),r.material.dispose()}}};let t=e;return Xl(t,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}",fragmentShader:`\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <${Ml>=154?"colorspace_fragment":"encodings_fragment"}>\n\n\t\t}`}),t})();var ql=Object.defineProperty,Zl=(e,t,n)=>(((e,t,n)=>{t in e?ql(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const Kl=(()=>{const e={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new b},up:{value:new b(0,1,0)}},vertexShader:"\n      uniform vec3 sunPosition;\n      uniform float rayleigh;\n      uniform float turbidity;\n      uniform float mieCoefficient;\n      uniform vec3 up;\n\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      // constants for atmospheric scattering\n      const float e = 2.71828182845904523536028747135266249775724709369995957;\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      // wavelength of used primaries, according to preetham\n      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n      // mie stuff\n      // K coefficient for the primaries\n      const float v = 4.0;\n      const vec3 K = vec3( 0.686, 0.678, 0.666 );\n      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n      // earth shadow hack\n      // cutoffAngle = pi / 1.95;\n      const float cutoffAngle = 1.6110731556870734;\n      const float steepness = 1.5;\n      const float EE = 1000.0;\n\n      float sunIntensity( float zenithAngleCos ) {\n        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n      }\n\n      vec3 totalMie( float T ) {\n        float c = ( 0.2 * T ) * 10E-18;\n        return 0.434 * c * MieConst;\n      }\n\n      void main() {\n\n        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        gl_Position.z = gl_Position.w; // set z to camera.far\n\n        vSunDirection = normalize( sunPosition );\n\n        vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n      // extinction (absorbtion + out scattering)\n      // rayleigh coefficients\n        vBetaR = totalRayleigh * rayleighCoefficient;\n\n      // mie coefficients\n        vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n      }\n    ",fragmentShader:`\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      uniform float mieDirectionalG;\n      uniform vec3 up;\n\n      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n      // constants for atmospheric scattering\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      const float n = 1.0003; // refractive index of air\n      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n      // optical length at zenith for molecules\n      const float rayleighZenithLength = 8.4E3;\n      const float mieZenithLength = 1.25E3;\n      // 66 arc seconds -> degrees, and the cosine of that\n      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n      // 3.0 / ( 16.0 * pi )\n      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n      // 1.0 / ( 4.0 * pi )\n      const float ONE_OVER_FOURPI = 0.07957747154594767;\n\n      float rayleighPhase( float cosTheta ) {\n        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n      }\n\n      float hgPhase( float cosTheta, float g ) {\n        float g2 = pow( g, 2.0 );\n        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n      }\n\n      void main() {\n\n        vec3 direction = normalize( vWorldPosition - cameraPos );\n\n      // optical length\n      // cutoff angle at 90 to avoid singularity in next formula.\n        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n        float sR = rayleighZenithLength * inverse;\n        float sM = mieZenithLength * inverse;\n\n      // combined extinction factor\n        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n      // in scattering\n        float cosTheta = dot( direction, vSunDirection );\n\n        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n        vec3 betaRTheta = vBetaR * rPhase;\n\n        float mPhase = hgPhase( cosTheta, mieDirectionalG );\n        vec3 betaMTheta = vBetaM * mPhase;\n\n        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n      // nightsky\n        float theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]\n        float phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]\n        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n        vec3 L0 = vec3( 0.1 ) * Fex;\n\n      // composition + solar disc\n        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n        gl_FragColor = vec4( retColor, 1.0 );\n\n      #include <tonemapping_fragment>\n      #include <${Ml>=154?"colorspace_fragment":"encodings_fragment"}>\n\n      }\n    `},t=new K({name:"SkyShader",fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:ne.clone(e.uniforms),side:f,depthWrite:!1});class n extends p{constructor(){super(new B(1,1,1),t)}}return Zl(n,"SkyShader",e),Zl(n,"material",t),n})();var Ql=Object.defineProperty,Jl=(e,t,n)=>(((e,t,n)=>{t in e?Ql(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n),n);let $l=class{constructor(){Jl(this,"_listeners")}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}};var ec=Object.defineProperty,tc=(e,t,n)=>(((e,t,n)=>{t in e?ec(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class nc extends y{constructor(e,t){super(),tc(this,"isTransformControls",!0),tc(this,"visible",!1),tc(this,"domElement"),tc(this,"raycaster",new L),tc(this,"gizmo"),tc(this,"plane"),tc(this,"tempVector",new b),tc(this,"tempVector2",new b),tc(this,"tempQuaternion",new k),tc(this,"unit",{X:new b(1,0,0),Y:new b(0,1,0),Z:new b(0,0,1)}),tc(this,"pointStart",new b),tc(this,"pointEnd",new b),tc(this,"offset",new b),tc(this,"rotationAxis",new b),tc(this,"startNorm",new b),tc(this,"endNorm",new b),tc(this,"rotationAngle",0),tc(this,"cameraPosition",new b),tc(this,"cameraQuaternion",new k),tc(this,"cameraScale",new b),tc(this,"parentPosition",new b),tc(this,"parentQuaternion",new k),tc(this,"parentQuaternionInv",new k),tc(this,"parentScale",new b),tc(this,"worldPositionStart",new b),tc(this,"worldQuaternionStart",new k),tc(this,"worldScaleStart",new b),tc(this,"worldPosition",new b),tc(this,"worldQuaternion",new k),tc(this,"worldQuaternionInv",new k),tc(this,"worldScale",new b),tc(this,"eye",new b),tc(this,"positionStart",new b),tc(this,"quaternionStart",new k),tc(this,"scaleStart",new b),tc(this,"camera"),tc(this,"object"),tc(this,"enabled",!0),tc(this,"axis",null),tc(this,"mode","translate"),tc(this,"translationSnap",null),tc(this,"rotationSnap",null),tc(this,"scaleSnap",null),tc(this,"space","world"),tc(this,"size",1),tc(this,"dragging",!1),tc(this,"showX",!0),tc(this,"showY",!0),tc(this,"showZ",!0),tc(this,"changeEvent",{type:"change"}),tc(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),tc(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),tc(this,"objectChangeEvent",{type:"objectChange"}),tc(this,"intersectObjectWithRay",(e,t,n)=>{const r=t.intersectObject(e,!0);for(let s=0;s<r.length;s++)if(r[s].object.visible||n)return r[s];return!1}),tc(this,"attach",e=>(this.object=e,this.visible=!0,this)),tc(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),tc(this,"reset",()=>this.enabled?(this.dragging&&void 0!==this.object&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),tc(this,"updateMatrixWorld",()=>{void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),tc(this,"pointerHover",e=>{if(void 0===this.object||!0===this.dragging)return;this.raycaster.setFromCamera(e,this.camera);const t=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);this.axis=t?t.object.name:null}),tc(this,"pointerDown",e=>{if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){this.raycaster.setFromCamera(e,this.camera);const t=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(t){let e=this.space;if("scale"===this.mode?e="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(e="world"),"local"===e&&"rotate"===this.mode){const e=this.rotationSnap;"X"===this.axis&&e&&(this.object.rotation.x=Math.round(this.object.rotation.x/e)*e),"Y"===this.axis&&e&&(this.object.rotation.y=Math.round(this.object.rotation.y/e)*e),"Z"===this.axis&&e&&(this.object.rotation.z=Math.round(this.object.rotation.z/e)*e)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),tc(this,"pointerMove",e=>{const t=this.axis,n=this.mode,r=this.object;let s=this.space;if("scale"===n?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;this.raycaster.setFromCamera(e,this.camera);const i=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(i){if(this.pointEnd.copy(i.point).sub(this.worldPositionStart),"translate"===n)this.offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this.offset.applyQuaternion(this.worldQuaternionInv),-1===t.indexOf("X")&&(this.offset.x=0),-1===t.indexOf("Y")&&(this.offset.y=0),-1===t.indexOf("Z")&&(this.offset.z=0),"local"===s&&"XYZ"!==t?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),r.position.copy(this.offset).add(this.positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this.quaternionStart)),"world"===s&&(r.parent&&r.position.add(this.tempVector.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(this.tempVector.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),this.tempVector2.set(e,e,e)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),-1===t.search("X")&&(this.tempVector2.x=1),-1===t.search("Y")&&(this.tempVector2.y=1),-1===t.search("Z")&&(this.tempVector2.z=1);r.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(-1!==t.search("X")&&(this.object.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this.offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(this.unit[t]),this.tempVector.copy(this.unit[t]),"local"===s&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this.quaternionStart),r.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),r.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),tc(this,"pointerUp",e=>{0===e.button&&(this.dragging&&null!==this.axis&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),tc(this,"getPointer",e=>{var t;if(this.domElement&&null!=(t=this.domElement.ownerDocument)&&t.pointerLockElement)return{x:0,y:0,button:e.button};{const t=e.changedTouches?e.changedTouches[0]:e,n=this.domElement.getBoundingClientRect();return{x:(t.clientX-n.left)/n.width*2-1,y:-(t.clientY-n.top)/n.height*2+1,button:e.button}}}),tc(this,"onPointerHover",e=>{if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(e))}}),tc(this,"onPointerDown",e=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(e)),this.pointerDown(this.getPointer(e)))}),tc(this,"onPointerMove",e=>{this.enabled&&this.pointerMove(this.getPointer(e))}),tc(this,"onPointerUp",e=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(e)))}),tc(this,"getMode",()=>this.mode),tc(this,"setMode",e=>{this.mode=e}),tc(this,"setTranslationSnap",e=>{this.translationSnap=e}),tc(this,"setRotationSnap",e=>{this.rotationSnap=e}),tc(this,"setScaleSnap",e=>{this.scaleSnap=e}),tc(this,"setSize",e=>{this.size=e}),tc(this,"setSpace",e=>{this.space=e}),tc(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),tc(this,"connect",e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),tc(this,"dispose",()=>{var e,t,n,r,s,i;null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointermove",this.onPointerHover),null==(r=null==(n=this.domElement)?void 0:n.ownerDocument)||r.removeEventListener("pointermove",this.onPointerMove),null==(i=null==(s=this.domElement)?void 0:s.ownerDocument)||i.removeEventListener("pointerup",this.onPointerUp),this.traverse(e=>{const t=e;t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new rc,this.add(this.gizmo),this.plane=new sc,this.add(this.plane);const n=(e,t)=>{let n=t;Object.defineProperty(this,e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),this[e]=t,this.plane[e]=t,this.gizmo[e]=t};n("camera",this.camera),n("object",this.object),n("enabled",this.enabled),n("axis",this.axis),n("mode",this.mode),n("translationSnap",this.translationSnap),n("rotationSnap",this.rotationSnap),n("scaleSnap",this.scaleSnap),n("space",this.space),n("size",this.size),n("dragging",this.dragging),n("showX",this.showX),n("showY",this.showY),n("showZ",this.showZ),n("worldPosition",this.worldPosition),n("worldPositionStart",this.worldPositionStart),n("worldQuaternion",this.worldQuaternion),n("worldQuaternionStart",this.worldQuaternionStart),n("cameraPosition",this.cameraPosition),n("cameraQuaternion",this.cameraQuaternion),n("pointStart",this.pointStart),n("pointEnd",this.pointEnd),n("rotationAxis",this.rotationAxis),n("rotationAngle",this.rotationAngle),n("eye",this.eye),void 0!==t&&this.connect(t)}}class rc extends y{constructor(){super(),tc(this,"isTransformControlsGizmo",!0),tc(this,"type","TransformControlsGizmo"),tc(this,"tempVector",new b(0,0,0)),tc(this,"tempEuler",new ue),tc(this,"alignVector",new b(0,1,0)),tc(this,"zeroVector",new b(0,0,0)),tc(this,"lookAtMatrix",new E),tc(this,"tempQuaternion",new k),tc(this,"tempQuaternion2",new k),tc(this,"identityQuaternion",new k),tc(this,"unitX",new b(1,0,0)),tc(this,"unitY",new b(0,1,0)),tc(this,"unitZ",new b(0,0,1)),tc(this,"gizmo"),tc(this,"picker"),tc(this,"helper"),tc(this,"rotationAxis",new b),tc(this,"cameraPosition",new b),tc(this,"worldPositionStart",new b),tc(this,"worldQuaternionStart",new k),tc(this,"worldPosition",new b),tc(this,"worldQuaternion",new k),tc(this,"eye",new b),tc(this,"camera",null),tc(this,"enabled",!0),tc(this,"axis",null),tc(this,"mode","translate"),tc(this,"space","world"),tc(this,"size",1),tc(this,"dragging",!1),tc(this,"showX",!0),tc(this,"showY",!0),tc(this,"showZ",!0),tc(this,"updateMatrixWorld",()=>{let e=this.space;"scale"===this.mode&&(e="local");const t="local"===e?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let n=[];n=n.concat(this.picker[this.mode].children),n=n.concat(this.gizmo[this.mode].children),n=n.concat(this.helper[this.mode].children);for(let r=0;r<n.length;r++){const e=n[r];let s;e.visible=!0,e.rotation.set(0,0,0),e.position.copy(this.worldPosition),(s=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),e.scale.set(1,1,1).multiplyScalar(s*this.size/7),"helper"!==e.tag)?(e.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?(("X"===e.name||"XYZX"===e.name)&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),("Y"===e.name||"XYZY"===e.name)&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),("Z"===e.name||"XYZZ"===e.name)&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.99&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XY"===e.name&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"YZ"===e.name&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),"XZ"===e.name&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))<.2&&(e.scale.set(1e-10,1e-10,1e-10),e.visible=!1),-1!==e.name.search("X")&&(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.x*=-1:"bwd"===e.tag&&(e.visible=!1)),-1!==e.name.search("Y")&&(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.y*=-1:"bwd"===e.tag&&(e.visible=!1)),-1!==e.name.search("Z")&&(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye)<0?"fwd"===e.tag?e.visible=!1:e.scale.z*=-1:"bwd"===e.tag&&(e.visible=!1))):"rotate"===this.mode&&(this.tempQuaternion2.copy(t),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(t).invert()),-1!==e.name.search("E")&&e.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),"X"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion)),"Y"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion)),"Z"===e.name&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),e.quaternion.copy(this.tempQuaternion))),e.visible=e.visible&&(-1===e.name.indexOf("X")||this.showX),e.visible=e.visible&&(-1===e.name.indexOf("Y")||this.showY),e.visible=e.visible&&(-1===e.name.indexOf("Z")||this.showZ),e.visible=e.visible&&(-1===e.name.indexOf("E")||this.showX&&this.showY&&this.showZ),e.material.tempOpacity=e.material.tempOpacity||e.material.opacity,e.material.tempColor=e.material.tempColor||e.material.color.clone(),e.material.color.copy(e.material.tempColor),e.material.opacity=e.material.tempOpacity,this.enabled?this.axis&&(e.name===this.axis||this.axis.split("").some(function(t){return e.name===t})?(e.material.opacity=1,e.material.color.lerp(new g(1,1,1),.5)):(e.material.opacity*=.25,e.material.color.lerp(new g(1,1,1),.5))):(e.material.opacity*=.5,e.material.color.lerp(new g(1,1,1),.5))):(e.visible=!1,"AXIS"===e.name?(e.position.copy(this.worldPositionStart),e.visible=!!this.axis,"X"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Y"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"Z"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),e.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.9&&(e.visible=!1)),"XYZE"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),e.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),e.quaternion.multiply(this.tempQuaternion),e.visible=this.dragging),"E"===this.axis&&(e.visible=!1)):"START"===e.name?(e.position.copy(this.worldPositionStart),e.visible=this.dragging):"END"===e.name?(e.position.copy(this.worldPosition),e.visible=this.dragging):"DELTA"===e.name?(e.position.copy(this.worldPositionStart),e.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),e.scale.copy(this.tempVector),e.visible=this.dragging):(e.quaternion.copy(t),this.dragging?e.position.copy(this.worldPositionStart):e.position.copy(this.worldPosition),this.axis&&(e.visible=-1!==this.axis.search(e.name))))}super.updateMatrixWorld()});const e=new m({depthTest:!1,depthWrite:!1,transparent:!0,side:N,fog:!1,toneMapped:!1}),t=new d({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;const r=e.clone();r.opacity=.33;const s=e.clone();s.color.set(16711680);const i=e.clone();i.color.set(65280);const o=e.clone();o.color.set(255);const a=e.clone();a.opacity=.25;const l=a.clone();l.color.set(16776960);const f=a.clone();f.color.set(65535);const v=a.clone();v.color.set(16711935),e.clone().color.set(16776960);const x=t.clone();x.color.set(16711680);const w=t.clone();w.color.set(65280);const T=t.clone();T.color.set(255);const S=t.clone();S.color.set(65535);const A=t.clone();A.color.set(16711935);const M=t.clone();M.color.set(16776960);const O=t.clone();O.color.set(7895160);const C=M.clone();C.opacity=.25;const P=new fe(0,.05,.2,12,1,!1),R=new B(.125,.125,.125),I=new u;I.setAttribute("position",new h([0,0,0,1,0,0],3));const L=(e,t)=>{const n=new u,r=[];for(let s=0;s<=64*t;++s)r.push(0,Math.cos(s/32*Math.PI)*e,Math.sin(s/32*Math.PI)*e);return n.setAttribute("position",new h(r,3)),n},D={X:[[new p(P,s),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new p(P,s),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new c(I,x)]],Y:[[new p(P,i),[0,1,0],null,null,"fwd"],[new p(P,i),[0,1,0],[Math.PI,0,0],null,"bwd"],[new c(I,w),null,[0,0,Math.PI/2]]],Z:[[new p(P,o),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new p(P,o),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new c(I,T),null,[0,-Math.PI/2,0]]],XYZ:[[new p(new ge(.1,0),a.clone()),[0,0,0],[0,0,0]]],XY:[[new p(new G(.295,.295),l.clone()),[.15,.15,0]],[new c(I,M),[.18,.3,0],null,[.125,1,1]],[new c(I,M),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new p(new G(.295,.295),f.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new c(I,S),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new c(I,S),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new p(new G(.295,.295),v.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new c(I,A),[.18,0,.3],null,[.125,1,1]],[new c(I,A),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},z={X:[[new p(new fe(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new p(new fe(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new p(new fe(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new p(new ge(.2,0),n)]],XY:[[new p(new G(.4,.4),n),[.2,.2,0]]],YZ:[[new p(new G(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new p(new G(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},U={START:[[new p(new ge(.01,2),r),null,null,null,"helper"]],END:[[new p(new ge(.01,2),r),null,null,null,"helper"]],DELTA:[[new c((()=>{const e=new u;return e.setAttribute("position",new h([0,0,0,1,1,1],3)),e})(),r),null,null,null,"helper"]],X:[[new c(I,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new c(I,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new c(I,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},F={X:[[new c(L(1,.5),x)],[new p(new ge(.04,0),s),[0,0,.99],null,[1,3,1]]],Y:[[new c(L(1,.5),w),null,[0,0,-Math.PI/2]],[new p(new ge(.04,0),i),[0,0,.99],null,[3,1,1]]],Z:[[new c(L(1,.5),T),null,[0,Math.PI/2,0]],[new p(new ge(.04,0),o),[.99,0,0],null,[1,3,1]]],E:[[new c(L(1.25,1),C),null,[0,Math.PI/2,0]],[new p(new fe(.03,0,.15,4,1,!1),C),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new p(new fe(.03,0,.15,4,1,!1),C),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new p(new fe(.03,0,.15,4,1,!1),C),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new p(new fe(.03,0,.15,4,1,!1),C),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new c(L(1,1),O),null,[0,Math.PI/2,0]]]},V={AXIS:[[new c(I,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},j={X:[[new p(new ye(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new p(new ye(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new p(new ye(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new p(new ye(1.25,.1,2,24),n)]],XYZE:[[new p(new _(.7,10,8),n)]]},H={X:[[new p(R,s),[.8,0,0],[0,0,-Math.PI/2]],[new c(I,x),null,null,[.8,1,1]]],Y:[[new p(R,i),[0,.8,0]],[new c(I,w),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new p(R,o),[0,0,.8],[Math.PI/2,0,0]],[new c(I,T),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new p(R,l),[.85,.85,0],null,[2,2,.2]],[new c(I,M),[.855,.98,0],null,[.125,1,1]],[new c(I,M),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new p(R,f),[0,.85,.85],null,[.2,2,2]],[new c(I,S),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new c(I,S),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new p(R,v),[.85,0,.85],null,[2,.2,2]],[new c(I,A),[.855,0,.98],null,[.125,1,1]],[new c(I,A),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new p(new B(.125,.125,.125),a.clone()),[1.1,0,0]]],XYZY:[[new p(new B(.125,.125,.125),a.clone()),[0,1.1,0]]],XYZZ:[[new p(new B(.125,.125,.125),a.clone()),[0,0,1.1]]]},Y={X:[[new p(new fe(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new p(new fe(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new p(new fe(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new p(R,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new p(R,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new p(R,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new p(new B(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new p(new B(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new p(new B(.2,.2,.2),n),[0,0,1.1]]]},W={X:[[new c(I,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new c(I,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new c(I,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},X=e=>{const t=new y;for(let n in e)for(let r=e[n].length;r--;){const s=e[n][r][0].clone(),i=e[n][r][1],o=e[n][r][2],a=e[n][r][3],l=e[n][r][4];s.name=n,s.tag=l,i&&s.position.set(i[0],i[1],i[2]),o&&s.rotation.set(o[0],o[1],o[2]),a&&s.scale.set(a[0],a[1],a[2]),s.updateMatrix();const c=s.geometry.clone();c.applyMatrix4(s.matrix),s.geometry=c,s.renderOrder=1/0,s.position.set(0,0,0),s.rotation.set(0,0,0),s.scale.set(1,1,1),t.add(s)}return t};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=X(D)),this.add(this.gizmo.rotate=X(F)),this.add(this.gizmo.scale=X(H)),this.add(this.picker.translate=X(z)),this.add(this.picker.rotate=X(j)),this.add(this.picker.scale=X(Y)),this.add(this.helper.translate=X(U)),this.add(this.helper.rotate=X(V)),this.add(this.helper.scale=X(W)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class sc extends p{constructor(){super(new G(1e5,1e5,2,2),new m({visible:!1,wireframe:!0,side:N,transparent:!0,opacity:.1,toneMapped:!1})),tc(this,"isTransformControlsPlane",!0),tc(this,"type","TransformControlsPlane"),tc(this,"unitX",new b(1,0,0)),tc(this,"unitY",new b(0,1,0)),tc(this,"unitZ",new b(0,0,1)),tc(this,"tempVector",new b),tc(this,"dirVector",new b),tc(this,"alignVector",new b),tc(this,"tempMatrix",new E),tc(this,"identityQuaternion",new k),tc(this,"cameraQuaternion",new k),tc(this,"worldPosition",new b),tc(this,"worldQuaternion",new k),tc(this,"eye",new b),tc(this,"axis",null),tc(this,"mode","translate"),tc(this,"space","world"),tc(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(e="local"),this.unitX.set(1,0,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0)}break;default:this.dirVector.set(0,0,0)}0===this.dirVector.length()?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}var ic=Object.defineProperty,oc=(e,t,n)=>(((e,t,n)=>{t in e?ic(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const ac=new ue(0,0,0,"YXZ"),lc=new b,cc={type:"change"},uc={type:"lock"},hc={type:"unlock"},dc=Math.PI/2;class pc extends $l{constructor(e,t){super(),oc(this,"camera"),oc(this,"domElement"),oc(this,"isLocked"),oc(this,"minPolarAngle"),oc(this,"maxPolarAngle"),oc(this,"pointerSpeed"),oc(this,"onMouseMove",e=>{!this.domElement||!1===this.isLocked||(ac.setFromQuaternion(this.camera.quaternion),ac.y-=.002*e.movementX*this.pointerSpeed,ac.x-=.002*e.movementY*this.pointerSpeed,ac.x=Math.max(dc-this.maxPolarAngle,Math.min(dc-this.minPolarAngle,ac.x)),this.camera.quaternion.setFromEuler(ac),this.dispatchEvent(cc))}),oc(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(uc),this.isLocked=!0):(this.dispatchEvent(hc),this.isLocked=!1))}),oc(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),oc(this,"connect",e=>{this.domElement=e||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),oc(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),oc(this,"dispose",()=>{this.disconnect()}),oc(this,"getObject",()=>this.camera),oc(this,"direction",new b(0,0,-1)),oc(this,"getDirection",e=>e.copy(this.direction).applyQuaternion(this.camera.quaternion)),oc(this,"moveForward",e=>{lc.setFromMatrixColumn(this.camera.matrix,0),lc.crossVectors(this.camera.up,lc),this.camera.position.addScaledVector(lc,e)}),oc(this,"moveRight",e=>{lc.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(lc,e)}),oc(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),oc(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}}var mc=Object.defineProperty,fc=(e,t,n)=>(((e,t,n)=>{t in e?mc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const gc=new M,yc=new A,vc=Math.cos(Math.PI/180*70),xc=(e,t)=>(e%t+t)%t;class bc extends $l{constructor(e,t){super(),fc(this,"object"),fc(this,"domElement"),fc(this,"enabled",!0),fc(this,"target",new b),fc(this,"minDistance",0),fc(this,"maxDistance",1/0),fc(this,"minZoom",0),fc(this,"maxZoom",1/0),fc(this,"minPolarAngle",0),fc(this,"maxPolarAngle",Math.PI),fc(this,"minAzimuthAngle",-1/0),fc(this,"maxAzimuthAngle",1/0),fc(this,"enableDamping",!1),fc(this,"dampingFactor",.05),fc(this,"enableZoom",!0),fc(this,"zoomSpeed",1),fc(this,"enableRotate",!0),fc(this,"rotateSpeed",1),fc(this,"enablePan",!0),fc(this,"panSpeed",1),fc(this,"screenSpacePanning",!0),fc(this,"keyPanSpeed",7),fc(this,"zoomToCursor",!1),fc(this,"autoRotate",!1),fc(this,"autoRotateSpeed",2),fc(this,"reverseOrbit",!1),fc(this,"reverseHorizontalOrbit",!1),fc(this,"reverseVerticalOrbit",!1),fc(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),fc(this,"mouseButtons",{LEFT:D.ROTATE,MIDDLE:D.DOLLY,RIGHT:D.PAN}),fc(this,"touches",{ONE:z.ROTATE,TWO:z.DOLLY_PAN}),fc(this,"target0"),fc(this,"position0"),fc(this,"zoom0"),fc(this,"_domElementKeyEvents",null),fc(this,"getPolarAngle"),fc(this,"getAzimuthalAngle"),fc(this,"setPolarAngle"),fc(this,"setAzimuthalAngle"),fc(this,"getDistance"),fc(this,"getZoomScale"),fc(this,"listenToKeyEvents"),fc(this,"stopListenToKeyEvents"),fc(this,"saveState"),fc(this,"reset"),fc(this,"update"),fc(this,"connect"),fc(this,"dispose"),fc(this,"dollyIn"),fc(this,"dollyOut"),fc(this,"getScale"),fc(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=e=>{let t=xc(e,2*Math.PI),r=u.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let s=Math.abs(t-r);2*Math.PI-s<s&&(t<r?t+=2*Math.PI:r+=2*Math.PI),h.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=xc(e,2*Math.PI),r=u.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let s=Math.abs(t-r);2*Math.PI-s<s&&(t<r?t+=2*Math.PI:r+=2*Math.PI),h.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",se),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",se),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=a.NONE},this.update=(()=>{const t=new b,i=new b(0,1,0),o=(new k).setFromUnitVectors(e.up,i),m=o.clone().invert(),f=new b,g=new k,y=2*Math.PI;return function(){const v=n.object.position;o.setFromUnitVectors(e.up,i),m.copy(o).invert(),t.copy(v).sub(n.target),t.applyQuaternion(o),u.setFromVector3(t),n.autoRotate&&l===a.NONE&&P(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(u.theta+=h.theta*n.dampingFactor,u.phi+=h.phi*n.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let x=n.minAzimuthAngle,_=n.maxAzimuthAngle;isFinite(x)&&isFinite(_)&&(x<-Math.PI?x+=y:x>Math.PI&&(x-=y),_<-Math.PI?_+=y:_>Math.PI&&(_-=y),u.theta=x<=_?Math.max(x,Math.min(_,u.theta)):u.theta>(x+_)/2?Math.max(x,u.theta):Math.min(_,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(p,n.dampingFactor):n.target.add(p),n.zoomToCursor&&M||n.object.isOrthographicCamera?u.radius=H(u.radius):u.radius=H(u.radius*d),t.setFromSpherical(u),t.applyQuaternion(m),v.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(h.theta*=1-n.dampingFactor,h.phi*=1-n.dampingFactor,p.multiplyScalar(1-n.dampingFactor)):(h.set(0,0,0),p.set(0,0,0));let w=!1;if(n.zoomToCursor&&M){let r=null;if(n.object instanceof s&&n.object.isPerspectiveCamera){const e=t.length();r=H(e*d);const s=e-r;n.object.position.addScaledVector(S,s),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new b(A.x,A.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/d)),n.object.updateProjectionMatrix(),w=!0;const s=new b(A.x,A.y,0);s.unproject(n.object),n.object.position.sub(s).add(e),n.object.updateMatrixWorld(),r=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==r&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(r).add(n.object.position):(gc.origin.copy(n.object.position),gc.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(gc.direction))<vc?e.lookAt(n.target):(yc.setFromNormalAndCoplanarPoint(n.object.up,n.target),gc.intersectPlane(yc,n.target))))}else n.object instanceof q&&n.object.isOrthographicCamera&&(w=1!==d,w&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/d)),n.object.updateProjectionMatrix()));return d=1,M=!1,!!(w||f.distanceToSquared(n.object.position)>c||8*(1-g.dot(n.object.quaternion))>c)&&(n.dispatchEvent(r),f.copy(n.object.position),g.copy(n.object.quaternion),w=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",ie),n.domElement.addEventListener("pointerdown",ee),n.domElement.addEventListener("pointercancel",ne),n.domElement.addEventListener("wheel",re)},this.dispose=()=>{var e,t,r,s,i,o;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",ie),null==(t=n.domElement)||t.removeEventListener("pointerdown",ee),null==(r=n.domElement)||r.removeEventListener("pointercancel",ne),null==(s=n.domElement)||s.removeEventListener("wheel",re),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",te),null==(o=n.domElement)||o.ownerDocument.removeEventListener("pointerup",ne),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",se)};const n=this,r={type:"change"},i={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new J,h=new J;let d=1;const p=new b,m=new T,f=new T,g=new T,y=new T,v=new T,x=new T,_=new T,w=new T,E=new T,S=new b,A=new T;let M=!1;const O=[],C={};function N(){return Math.pow(.95,n.zoomSpeed)}function P(e){n.reverseOrbit||n.reverseHorizontalOrbit?h.theta+=e:h.theta-=e}function R(e){n.reverseOrbit||n.reverseVerticalOrbit?h.phi+=e:h.phi-=e}const I=(()=>{const e=new b;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),p.add(e)}})(),L=(()=>{const e=new b;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),p.add(e)}})(),U=(()=>{const e=new b;return function(t,r){const i=n.domElement;if(i&&n.object instanceof s&&n.object.isPerspectiveCamera){const s=n.object.position;e.copy(s).sub(n.target);let o=e.length();o*=Math.tan(n.object.fov/2*Math.PI/180),I(2*t*o/i.clientHeight,n.object.matrix),L(2*r*o/i.clientHeight,n.object.matrix)}else i&&n.object instanceof q&&n.object.isOrthographicCamera?(I(t*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),L(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function F(e){n.object instanceof s&&n.object.isPerspectiveCamera||n.object instanceof q&&n.object.isOrthographicCamera?d=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function B(e){F(d/e)}function V(e){F(d*e)}function j(e){if(!n.zoomToCursor||!n.domElement)return;M=!0;const t=n.domElement.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top,i=t.width,o=t.height;A.x=r/i*2-1,A.y=-s/o*2+1,S.set(A.x,A.y,1).unproject(n.object).sub(n.object.position).normalize()}function H(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function Y(e){m.set(e.clientX,e.clientY)}function W(e){y.set(e.clientX,e.clientY)}function X(){if(1==O.length)m.set(O[0].pageX,O[0].pageY);else{const e=.5*(O[0].pageX+O[1].pageX),t=.5*(O[0].pageY+O[1].pageY);m.set(e,t)}}function G(){if(1==O.length)y.set(O[0].pageX,O[0].pageY);else{const e=.5*(O[0].pageX+O[1].pageX),t=.5*(O[0].pageY+O[1].pageY);y.set(e,t)}}function Z(){const e=O[0].pageX-O[1].pageX,t=O[0].pageY-O[1].pageY,n=Math.sqrt(e*e+t*t);_.set(0,n)}function K(e){if(1==O.length)f.set(e.pageX,e.pageY);else{const t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);f.set(n,r)}g.subVectors(f,m).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(P(2*Math.PI*g.x/t.clientHeight),R(2*Math.PI*g.y/t.clientHeight)),m.copy(f)}function Q(e){if(1==O.length)v.set(e.pageX,e.pageY);else{const t=ae(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);v.set(n,r)}x.subVectors(v,y).multiplyScalar(n.panSpeed),U(x.x,x.y),y.copy(v)}function $(e){const t=ae(e),r=e.pageX-t.x,s=e.pageY-t.y,i=Math.sqrt(r*r+s*s);w.set(0,i),E.set(0,Math.pow(w.y/_.y,n.zoomSpeed)),B(E.y),_.copy(w)}function ee(e){var t,r;!1!==n.enabled&&(0===O.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",te),null==(r=n.domElement)||r.ownerDocument.addEventListener("pointerup",ne)),function(e){O.push(e)}(e),"touch"===e.pointerType?function(e){switch(oe(e),O.length){case 1:switch(n.touches.ONE){case z.ROTATE:if(!1===n.enableRotate)return;X(),l=a.TOUCH_ROTATE;break;case z.PAN:if(!1===n.enablePan)return;G(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(n.touches.TWO){case z.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&Z(),n.enablePan&&G(),l=a.TOUCH_DOLLY_PAN;break;case z.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&Z(),n.enableRotate&&X(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case D.DOLLY:if(!1===n.enableZoom)return;(function(e){j(e),_.set(e.clientX,e.clientY)})(e),l=a.DOLLY;break;case D.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;W(e),l=a.PAN}else{if(!1===n.enableRotate)return;Y(e),l=a.ROTATE}break;case D.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;Y(e),l=a.ROTATE}else{if(!1===n.enablePan)return;W(e),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&n.dispatchEvent(i)}(e))}function te(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(oe(e),l){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;K(e),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;Q(e),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function(e){n.enableZoom&&$(e),n.enablePan&&Q(e)})(e),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function(e){n.enableZoom&&$(e),n.enableRotate&&K(e)})(e),n.update();break;default:l=a.NONE}}(e):function(e){if(!1!==n.enabled)switch(l){case a.ROTATE:if(!1===n.enableRotate)return;!function(e){f.set(e.clientX,e.clientY),g.subVectors(f,m).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(P(2*Math.PI*g.x/t.clientHeight),R(2*Math.PI*g.y/t.clientHeight)),m.copy(f),n.update()}(e);break;case a.DOLLY:if(!1===n.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),E.subVectors(w,_),E.y>0?B(N()):E.y<0&&V(N()),_.copy(w),n.update()}(e);break;case a.PAN:if(!1===n.enablePan)return;!function(e){v.set(e.clientX,e.clientY),x.subVectors(v,y).multiplyScalar(n.panSpeed),U(x.x,x.y),y.copy(v),n.update()}(e)}}(e))}function ne(e){var t,r,s;(function(e){delete C[e.pointerId];for(let t=0;t<O.length;t++)if(O[t].pointerId==e.pointerId)return void O.splice(t,1)})(e),0===O.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",te),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointerup",ne)),n.dispatchEvent(o),l=a.NONE}function re(e){!1===n.enabled||!1===n.enableZoom||l!==a.NONE&&l!==a.ROTATE||(e.preventDefault(),n.dispatchEvent(i),function(e){j(e),e.deltaY<0?V(N()):e.deltaY>0&&B(N()),n.update()}(e),n.dispatchEvent(o))}function se(e){!1===n.enabled||!1===n.enablePan||function(e){let t=!1;switch(e.code){case n.keys.UP:U(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:U(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:U(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:U(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function ie(e){!1!==n.enabled&&e.preventDefault()}function oe(e){let t=C[e.pointerId];void 0===t&&(t=new T,C[e.pointerId]=t),t.set(e.pageX,e.pageY)}function ae(e){const t=e.pointerId===O[0].pointerId?O[1]:O[0];return C[t.pointerId]}this.dollyIn=(e=N())=>{V(e),n.update()},this.dollyOut=(e=N())=>{B(e),n.update()},this.getScale=()=>d,this.setScale=e=>{F(e),n.update()},this.getZoomScale=()=>N(),void 0!==t&&this.connect(t),this.update()}}class _c extends bc{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=D.PAN,this.mouseButtons.RIGHT=D.ROTATE,this.touches.ONE=z.PAN,this.touches.TWO=z.DOLLY_ROTATE}}function wc(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}const Tc="srgb",Ec="srgb-linear";class Sc extends ie{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new Pc(e)}),this.register(function(e){return new Rc(e)}),this.register(function(e){return new Vc(e)}),this.register(function(e){return new jc(e)}),this.register(function(e){return new Hc(e)}),this.register(function(e){return new Lc(e)}),this.register(function(e){return new kc(e)}),this.register(function(e){return new Dc(e)}),this.register(function(e){return new zc(e)}),this.register(function(e){return new Nc(e)}),this.register(function(e){return new Uc(e)}),this.register(function(e){return new Ic(e)}),this.register(function(e){return new Bc(e)}),this.register(function(e){return new Fc(e)}),this.register(function(e){return new Oc(e)}),this.register(function(e){return new Yc(e)}),this.register(function(e){return new Wc(e)})}load(e,t,n,r){const s=this;let i;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){const t=me.extractUrlBase(e);i=me.resolveURL(t,this.path)}else i=me.extractUrlBase(e);this.manager.itemStart(e);const o=function(t){r?r(t):console.error(t),s.manager.itemError(e),s.manager.itemEnd(e)},a=new oe(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){try{s.parse(n,i,function(n){t(n),s.manager.itemEnd(e)},o)}catch(r){o(r)}},n,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const i={},o={};if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(wc(new Uint8Array(e.slice(0,4)))===Xc){try{i[Mc.KHR_BINARY_GLTF]=new Zc(e)}catch(l){return void(r&&r(l))}s=JSON.parse(i[Mc.KHR_BINARY_GLTF].content)}else s=JSON.parse(wc(new Uint8Array(e)));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const a=new _u(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});a.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](a);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[e.name]=e,i[e.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const e=s.extensionsUsed[c],t=s.extensionsRequired||[];switch(e){case Mc.KHR_MATERIALS_UNLIT:i[e]=new Cc;break;case Mc.KHR_DRACO_MESH_COMPRESSION:i[e]=new Kc(s,this.dracoLoader);break;case Mc.KHR_TEXTURE_TRANSFORM:i[e]=new Qc;break;case Mc.KHR_MESH_QUANTIZATION:i[e]=new Jc;break;default:t.indexOf(e)>=0&&void 0===o[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}a.setExtensions(i),a.setPlugins(o),a.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function Ac(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Mc={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Oc{constructor(e){this.parser=e,this.name=Mc.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,i=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let o;const a=new g(16777215);void 0!==i.color&&a.setRGB(i.color[0],i.color[1],i.color[2],Ec);const l=void 0!==i.range?i.range:0;switch(i.type){case"directional":o=new Ce(a),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new Oe(a),o.distance=l;break;case"spot":o=new Me(a),o.distance=l,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,o.angle=i.spot.outerConeAngle,o.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return o.position.set(0,0,0),o.decay=2,fu(o,i),void 0!==i.intensity&&(o.intensity=i.intensity),o.name=t.createUniqueName(i.name||"light_"+e),r=Promise.resolve(o),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],s=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(e){return n._getNodeRef(t.cache,s,e)})}}class Cc{constructor(){this.name=Mc.KHR_MATERIALS_UNLIT}getMaterialType(){return m}extendParams(e,t,n){const r=[];e.color=new g(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const t=s.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],Ec),e.opacity=t[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,Tc))}return Promise.all(r)}}class Nc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class Pc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];if(void 0!==i.clearcoatFactor&&(t.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){const e=i.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new T(e,e)}return Promise.all(s)}}class Rc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.dispersion=void 0!==r.dispersion?r.dispersion:0,Promise.resolve()}}class Ic{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(s)}}class Lc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new g(0,0,0),t.sheenRoughness=0,t.sheen=1;const i=r.extensions[this.name];if(void 0!==i.sheenColorFactor){const e=i.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],Ec)}return void 0!==i.sheenRoughnessFactor&&(t.sheenRoughness=i.sheenRoughnessFactor),void 0!==i.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",i.sheenColorTexture,Tc)),void 0!==i.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(s)}}class kc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(s)}}class Dc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];t.thickness=void 0!==i.thicknessFactor?i.thicknessFactor:0,void 0!==i.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",i.thicknessTexture)),t.attenuationDistance=i.attenuationDistance||1/0;const o=i.attenuationColor||[1,1,1];return t.attenuationColor=(new g).setRGB(o[0],o[1],o[2],Ec),Promise.all(s)}}class zc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class Uc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];t.specularIntensity=void 0!==i.specularFactor?i.specularFactor:1,void 0!==i.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",i.specularTexture));const o=i.specularColorFactor||[1,1,1];return t.specularColor=(new g).setRGB(o[0],o[1],o[2],Ec),void 0!==i.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",i.specularColorTexture,Tc)),Promise.all(s)}}class Fc{constructor(e){this.parser=e,this.name=Mc.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&s.push(n.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(s)}}class Bc{constructor(e){this.parser=e,this.name=Mc.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?Ae:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],i=r.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&s.push(n.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(s)}}class Vc{constructor(e){this.parser=e,this.name=Mc.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,i)}}class jc{constructor(e){this.parser=e,this.name=Mc.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const i=s.extensions[t],o=r.images[i.source];let a=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then(function(s){if(s)return n.loadTextureImage(e,i.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Hc{constructor(e){this.parser=e,this.name=Mc.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const i=s.extensions[t],o=r.images[i.source];let a=n.textureLoader;if(o.uri){const e=n.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then(function(s){if(s)return n.loadTextureImage(e,i.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class Yc{constructor(e){this.name=Mc.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(t){const n=e.byteOffset||0,r=e.byteLength||0,i=e.count,o=e.byteStride,a=new Uint8Array(t,n,r);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(i,o,a,e.mode,e.filter).then(function(e){return e.buffer}):s.ready.then(function(){const t=new ArrayBuffer(i*o);return s.decodeGltfBuffer(new Uint8Array(t),i,o,a,e.mode,e.filter),t})})}return null}}class Wc{constructor(e){this.name=Mc.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const a of r.primitives)if(a.mode!==nu.TRIANGLES&&a.mode!==nu.TRIANGLE_STRIP&&a.mode!==nu.TRIANGLE_FAN&&void 0!==a.mode)return null;const s=n.extensions[this.name].attributes,i=[],o={};for(const a in s)i.push(this.parser.getDependency("accessor",s[a]).then(e=>(o[a]=e,o[a])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{const t=e.pop(),n=t.isGroup?t.children:[t],r=e[0].count,s=[];for(const i of n){const e=new E,t=new b,n=new k,a=new b(1,1,1),l=new Ne(i.geometry,i.material,r);for(let s=0;s<r;s++)o.TRANSLATION&&t.fromBufferAttribute(o.TRANSLATION,s),o.ROTATION&&n.fromBufferAttribute(o.ROTATION,s),o.SCALE&&a.fromBufferAttribute(o.SCALE,s),l.setMatrixAt(s,e.compose(t,n,a));for(const r in o)if("_COLOR_0"===r){const e=o[r];l.instanceColor=new Pe(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&i.geometry.setAttribute(r,o[r]);y.prototype.copy.call(l,i),this.parser.assignFinalMaterial(l),s.push(l)}return t.isGroup?(t.clear(),t.add(...s),t):s[0]}))}}const Xc="glTF",Gc=1313821514,qc=5130562;class Zc{constructor(e){this.name=Mc.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:wc(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Xc)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const t=r.getUint32(s,!0);s+=4;const n=r.getUint32(s,!0);if(s+=4,n===Gc){const n=new Uint8Array(e,12+s,t);this.content=wc(n)}else if(n===qc){const n=12+s;this.body=e.slice(n,n+t)}s+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Kc{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Mc.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,o={},a={},l={};for(const c in i){const e=au[c]||c.toLowerCase();o[e]=i[c]}for(const c in e.attributes){const t=au[c]||c.toLowerCase();if(void 0!==i[c]){const r=n.accessors[e.attributes[c]],s=ru[r.componentType];l[t]=s.name,a[t]=!0===r.normalized}}return t.getDependency("bufferView",s).then(function(e){return new Promise(function(t,n){r.decodeDracoFile(e,function(e){for(const t in e.attributes){const n=e.attributes[t],r=a[t];void 0!==r&&(n.normalized=r)}t(e)},o,l,Ec,n)})})}}class Qc{constructor(){this.name=Mc.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Jc{constructor(){this.name=Mc.KHR_MESH_QUANTIZATION}}class $c extends lt{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let i=0;i!==r;i++)t[i]=n[s+i];return t}interpolate_(e,t,n,r){const s=this.resultBuffer,i=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=r-t,u=(n-t)/c,h=u*u,d=h*u,p=e*l,m=p-l,f=-2*d+3*h,g=d-h,y=1-f,v=g-h+u;for(let x=0;x!==o;x++){const e=i[m+x+o],t=i[m+x+a]*c,n=i[p+x+o],r=i[p+x]*c;s[x]=y*e+v*t+f*n+g*r}return s}}const eu=new k;class tu extends $c{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return eu.fromArray(s).normalize().toArray(s),s}}const nu={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},ru={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},su={9728:Ue,9729:Se,9984:ze,9985:De,9986:ke,9987:Le},iu={33071:Ve,33648:Be,10497:Fe},ou={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},au={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Ml>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},lu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},cu={CUBICSPLINE:void 0,LINEAR:Je,STEP:Qe},uu="OPAQUE",hu="MASK",du="BLEND";function pu(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new ce({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:st})),e.DefaultMaterial}function mu(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function fu(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function gu(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function yu(e){let t;const n=e.extensions&&e.extensions[Mc.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+vu(n.attributes):e.indices+":"+vu(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,s=e.targets.length;r<s;r++)t+=":"+vu(e.targets[r]);return t}function vu(e){let t="";const n=Object.keys(e).sort();for(let r=0,s=n.length;r<s;r++)t+=n[r]+":"+e[n[r]]+";";return t}function xu(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const bu=new E;class _u{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Ac,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||r&&s<98?this.textureLoader=new F(this.options.manager):this.textureLoader=new Re(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new oe(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(t){const i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};return mu(s,i,r),fu(i,r),Promise.all(n._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){for(const e of i.scenes)e.updateMatrixWorld();e(i)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const t=e[r];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[r,i]of e.children.entries())s(i,t.children[r])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":r=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map(function(t,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Mc.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(e,s){n.load(me.resolveURL(t.uri,r.path),e,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const e=ou[r.type],t=ru[r.componentType],n=!0===r.normalized,s=new t(r.count*e);return Promise.resolve(new v(s,e,n))}const s=[];return void 0!==r.bufferView?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(e){const s=e[0],i=ou[r.type],o=ru[r.componentType],a=o.BYTES_PER_ELEMENT,l=a*i,c=r.byteOffset||0,u=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;let d,p;if(u&&u!==l){const e=Math.floor(c/u),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let l=t.cache.get(n);l||(d=new o(s,e*u,r.count*u/a),l=new Ie(d,u/a),t.cache.add(n,l)),p=new et(l,i,c%u/a,h)}else d=null===s?new o(r.count*i):new o(s,c,r.count*i),p=new v(d,i,h);if(void 0!==r.sparse){const t=ou.SCALAR,n=ru[r.sparse.indices.componentType],a=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,c=new n(e[1],a,r.sparse.count*t),u=new o(e[2],l,r.sparse.count*i);null!==s&&(p=new v(p.array.slice(),p.itemSize,p.normalized));for(let e=0,r=c.length;e<r;e++){const t=c[e];if(p.setX(t,u[e*i]),i>=2&&p.setY(t,u[e*i+1]),i>=3&&p.setZ(t,u[e*i+2]),i>=4&&p.setW(t,u[e*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p})}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,s=t.images[r];let i=this.textureLoader;if(s.uri){const e=n.manager.getHandler(s.uri);null!==e&&(i=e)}return this.loadTextureImage(e,r,i)}loadTextureImage(e,t,n){const r=this,s=this.json,i=s.textures[e],o=s.images[t],a=(o.uri||o.bufferView)+":"+i.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(t,n).then(function(t){t.flipY=!1,t.name=i.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);const n=(s.samplers||{})[i.sampler]||{};return t.magFilter=su[n.magFilter]||Se,t.minFilter=su[n.minFilter]||Le,t.wrapS=iu[n.wrapS]||Fe,t.wrapT=iu[n.wrapT]||Fe,r.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[a]=l,l}loadImageSource(e,t){const n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());const s=n.images[e],i=self.URL||self.webkitURL;let o=s.uri||"",a=!1;if(void 0!==s.bufferView)o=this.getDependency("bufferView",s.bufferView).then(function(e){a=!0;const t=new Blob([e],{type:s.mimeType});return o=i.createObjectURL(t),o});else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(o).then(function(e){return new Promise(function(n,s){let i=n;!0===t.isImageBitmapLoader&&(i=function(e){const t=new U(e);t.needsUpdate=!0,n(t)}),t.load(me.resolveURL(e,r.path),i,void 0,s)})}).then(function(e){return!0===a&&i.revokeObjectURL(o),fu(e,s),e.userData.mimeType=s.mimeType||((t=s.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e;var t}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=l,l}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(i){if(!i)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((i=i.clone()).channel=n.texCoord),s.extensions[Mc.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[Mc.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=s.associations.get(i);i=s.extensions[Mc.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),s.associations.set(i,t)}}return void 0!==r&&("number"==typeof r&&(r=3001===r?Tc:Ec),"colorSpace"in i?i.colorSpace=r:i.encoding=r===Tc?3001:3e3),e[t]=i,i})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,i=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new je,I.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new d,I.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(r||s||i){let e="ClonedMaterial:"+n.uuid+":";r&&(e+="derivative-tangents:"),s&&(e+="vertex-colors:"),i&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),s&&(t.vertexColors=!0),i&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return ce}loadMaterial(e){const t=this,n=this.json,r=this.extensions,s=n.materials[e];let i;const o={},a=[];if((s.extensions||{})[Mc.KHR_MATERIALS_UNLIT]){const e=r[Mc.KHR_MATERIALS_UNLIT];i=e.getMaterialType(),a.push(e.extendParams(o,s,t))}else{const n=s.pbrMetallicRoughness||{};if(o.color=new g(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],Ec),o.opacity=e[3]}void 0!==n.baseColorTexture&&a.push(t.assignTexture(o,"map",n.baseColorTexture,Tc)),o.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,o.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(a.push(t.assignTexture(o,"metalnessMap",n.metallicRoughnessTexture)),a.push(t.assignTexture(o,"roughnessMap",n.metallicRoughnessTexture))),i=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),a.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)})))}!0===s.doubleSided&&(o.side=N);const l=s.alphaMode||uu;if(l===du?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,l===hu&&(o.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&i!==m&&(a.push(t.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new T(1,1),void 0!==s.normalTexture.scale)){const e=s.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==s.occlusionTexture&&i!==m&&(a.push(t.assignTexture(o,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(o.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&i!==m){const e=s.emissiveFactor;o.emissive=(new g).setRGB(e[0],e[1],e[2],Ec)}return void 0!==s.emissiveTexture&&i!==m&&a.push(t.assignTexture(o,"emissiveMap",s.emissiveTexture,Tc)),Promise.all(a).then(function(){const n=new i(o);return s.name&&(n.name=s.name),fu(n,s),t.associations.set(n,{materials:e}),s.extensions&&mu(r,n,s),n})}createUniqueName(e){const t=He.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(e){return n[Mc.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(n){return wu(n,e,t)})}const i=[];for(let o=0,a=e.length;o<a;o++){const n=e[o],a=yu(n),l=r[a];if(l)i.push(l.promise);else{let e;e=n.extensions&&n.extensions[Mc.KHR_DRACO_MESH_COMPRESSION]?s(n):wu(new u,n,t),r[a]={primitive:n,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){const t=this,n=this.json,r=this.extensions,s=n.meshes[e],i=s.primitives,o=[];for(let a=0,l=i.length;a<l;a++){const e=void 0===i[a].material?pu(this.cache):this.getDependency("material",i[a].material);o.push(e)}return o.push(t.loadGeometries(i)),Promise.all(o).then(function(n){const o=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let h=0,d=a.length;h<d;h++){const n=a[h],u=i[h];let d;const m=o[h];if(u.mode===nu.TRIANGLES||u.mode===nu.TRIANGLE_STRIP||u.mode===nu.TRIANGLE_FAN||void 0===u.mode)d=!0===s.isSkinnedMesh?new Ye(n,m):new p(n,m),!0===d.isSkinnedMesh&&d.normalizeSkinWeights(),u.mode===nu.TRIANGLE_STRIP?d.geometry=Ol(d.geometry,at):u.mode===nu.TRIANGLE_FAN&&(d.geometry=Ol(d.geometry,ot));else if(u.mode===nu.LINES)d=new We(n,m);else if(u.mode===nu.LINE_STRIP)d=new c(n,m);else if(u.mode===nu.LINE_LOOP)d=new Xe(n,m);else{if(u.mode!==nu.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);d=new Ge(n,m)}Object.keys(d.geometry.morphAttributes).length>0&&gu(d,s),d.name=t.createUniqueName(s.name||"mesh_"+e),fu(d,s),u.extensions&&mu(r,d,u),t.assignFinalMaterial(d),l.push(d)}for(let r=0,s=l.length;r<s;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return s.extensions&&mu(r,l[0],s),l[0];const u=new W;s.extensions&&mu(r,u,s),t.associations.set(u,{meshes:e});for(let e=0,t=l.length;e<t;e++)u.add(l[e]);return u})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new s(R.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new q(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),fu(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(e){const n=e.pop(),r=e,s=[],i=[];for(let o=0,a=r.length;o<a;o++){const e=r[o];if(e){s.push(e);const t=new E;null!==n&&t.fromArray(n.array,16*o),i.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new qe(s,i)})}loadAnimation(e){const t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,i=[],o=[],a=[],l=[],c=[];for(let u=0,h=r.channels.length;u<h;u++){const e=r.channels[u],t=r.samplers[e.sampler],n=e.target,s=n.node,h=void 0!==r.parameters?r.parameters[t.input]:t.input,d=void 0!==r.parameters?r.parameters[t.output]:t.output;void 0!==n.node&&(i.push(this.getDependency("node",s)),o.push(this.getDependency("accessor",h)),a.push(this.getDependency("accessor",d)),l.push(t),c.push(n))}return Promise.all([Promise.all(i),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(e){const t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],l=[];for(let s=0,c=t.length;s<c;s++){const e=t[s],c=r[s],u=i[s],h=o[s],d=a[s];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const p=n._createAnimationTracks(e,c,u,h,d);if(p)for(let t=0;t<p.length;t++)l.push(p[t])}return new Ze(s,void 0,l)})}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]}),t})}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),s=[],i=n.children||[];for(let a=0,l=i.length;a<l;a++)s.push(t.getDependency("node",i[a]));const o=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(s),o]).then(function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(r,bu)});for(let s=0,i=n.length;s<i;s++)t.add(n[s]);return t})}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=t.nodes[e],i=s.name?r.createUniqueName(s.name):"",o=[],a=r._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return a&&o.push(a),void 0!==s.camera&&o.push(r.getDependency("camera",s.camera).then(function(e){return r._getNodeRef(r.cameraCache,s.camera,e)})),r._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(t){let o;if(o=!0===s.isBone?new Ke:t.length>1?new W:1===t.length?t[0]:new y,o!==t[0])for(let e=0,n=t.length;e<n;e++)o.add(t[e]);if(s.name&&(o.userData.name=s.name,o.name=i),fu(o,s),s.extensions&&mu(n,o,s),void 0!==s.matrix){const e=new E;e.fromArray(s.matrix),o.applyMatrix4(e)}else void 0!==s.translation&&o.position.fromArray(s.translation),void 0!==s.rotation&&o.quaternion.fromArray(s.rotation),void 0!==s.scale&&o.scale.fromArray(s.scale);return r.associations.has(o)||r.associations.set(o,{}),r.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,s=new W;n.name&&(s.name=r.createUniqueName(n.name)),fu(s,n),n.extensions&&mu(t,s,n);const i=n.nodes||[],o=[];for(let a=0,l=i.length;a<l;a++)o.push(r.getDependency("node",i[a]));return Promise.all(o).then(function(e){for(let t=0,n=e.length;t<n;t++)s.add(e[t]);return r.associations=(e=>{const t=new Map;for(const[n,s]of r.associations)(n instanceof I||n instanceof U)&&t.set(n,s);return e.traverse(e=>{const n=r.associations.get(e);null!=n&&t.set(e,n)}),t})(s),s})}_createAnimationTracks(e,t,n,r,s){const i=[],o=e.name?e.name:e.uuid,a=[];let l;switch(lu[s.path]===lu.weights?e.traverse(function(e){e.morphTargetInfluences&&a.push(e.name?e.name:e.uuid)}):a.push(o),lu[s.path]){case lu.weights:l=nt;break;case lu.rotation:l=rt;break;case lu.position:case lu.scale:l=tt;break;default:if(1===n.itemSize)l=nt;else l=tt}const c=void 0!==r.interpolation?cu[r.interpolation]:Je,u=this._getArrayFromAccessor(n);for(let h=0,d=a.length;h<d;h++){const e=new l(a[h]+"."+lu[s.path],t.array,u,c);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(e),i.push(e)}return i}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=xu(t.constructor),n=new Float32Array(t.length);for(let r=0,s=t.length;r<s;r++)n[r]=t[r]*e;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof rt?tu:$c)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function wu(e,t,n){const r=t.attributes,s=[];function i(t,r){return n.getDependency("accessor",t).then(function(t){e.setAttribute(r,t)})}for(const o in r){const t=au[o]||o.toLowerCase();t in e.attributes||s.push(i(r[o],t))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});s.push(r)}return fu(e,t),function(e,t,n){const r=t.attributes,s=new $;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,i=e.max;if(void 0===t||void 0===i)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(s.set(new b(t[0],t[1],t[2]),new b(i[0],i[1],i[2])),e.normalized){const t=xu(ru[e.componentType]);s.min.multiplyScalar(t),s.max.multiplyScalar(t)}}const i=t.targets;if(void 0!==i){const e=new b,t=new b;for(let r=0,s=i.length;r<s;r++){const s=i[r];if(void 0!==s.POSITION){const r=n.json.accessors[s.POSITION],i=r.min,o=r.max;if(void 0!==i&&void 0!==o){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(o[2]))),r.normalized){const e=xu(ru[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(e)}e.boundingBox=s;const o=new O;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=o}(e,t,n),Promise.all(s).then(function(){return void 0!==t.targets?function(e,t,n){let r=!1,s=!1,i=!1;for(let c=0,u=t.length;c<u;c++){const e=t[c];if(void 0!==e.POSITION&&(r=!0),void 0!==e.NORMAL&&(s=!0),void 0!==e.COLOR_0&&(i=!0),r&&s&&i)break}if(!r&&!s&&!i)return Promise.resolve(e);const o=[],a=[],l=[];for(let c=0,u=t.length;c<u;c++){const u=t[c];if(r){const t=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):e.attributes.position;o.push(t)}if(s){const t=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):e.attributes.normal;a.push(t)}if(i){const t=void 0!==u.COLOR_0?n.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(t){const n=t[0],o=t[1],a=t[2];return r&&(e.morphAttributes.position=n),s&&(e.morphAttributes.normal=o),i&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e})}(e,t.targets,n):e})}class Tu extends ae{constructor(e,t={}){const{bevelEnabled:n=!1,bevelSize:r=8,bevelThickness:s=10,font:i,height:o=50,size:a=100,lineHeight:l=1,letterSpacing:c=0,...u}=t;if(void 0===i)super();else{super(i.generateShapes(e,a,{lineHeight:l,letterSpacing:c}),{...u,bevelEnabled:n,bevelSize:r,bevelThickness:s,depth:o})}this.type="TextGeometry"}}const Eu={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},Su={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "};var Au=Object.defineProperty,Mu=(e,t,n)=>(((e,t,n)=>{t in e?Au(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);class Ou extends ie{constructor(e){super(e)}load(e,t,n,r){const s=new oe(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,e=>{if("string"!=typeof e)throw new Error("unsupported data type");const n=JSON.parse(e),r=this.parse(n);t&&t(r)},n,r)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new Cu(e)}}class Cu{constructor(e){Mu(this,"data"),Mu(this,"isFont",!0),Mu(this,"type","Font"),this.data=e}generateShapes(e,t=100,n){const r=[],s={letterSpacing:0,lineHeight:1,...n},i=function(e,t,n,r){const s=Array.from(e),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[];let l=0,c=0;for(let u=0;u<s.length;u++){const e=s[u];if("\n"===e)l=0,c-=o*r.lineHeight;else{const t=Nu(e,i,l,c,n);t&&(l+=t.offsetX+r.letterSpacing,a.push(t.path))}}return a}(e,t,this.data,s);for(let o=0,a=i.length;o<a;o++)Array.prototype.push.apply(r,i[o].toShapes(!1));return r}}function Nu(e,t,n,r,s){const i=s.glyphs[e]||s.glyphs["?"];if(!i)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+s.familyName+".");const o=new $e;let a,l,c,u,h,d,p,m;if(i.o){const e=i._cachedOutline||(i._cachedOutline=i.o.split(" "));for(let s=0,i=e.length;s<i;)switch(e[s++]){case"m":a=parseInt(e[s++])*t+n,l=parseInt(e[s++])*t+r,o.moveTo(a,l);break;case"l":a=parseInt(e[s++])*t+n,l=parseInt(e[s++])*t+r,o.lineTo(a,l);break;case"q":c=parseInt(e[s++])*t+n,u=parseInt(e[s++])*t+r,h=parseInt(e[s++])*t+n,d=parseInt(e[s++])*t+r,o.quadraticCurveTo(h,d,c,u);break;case"b":c=parseInt(e[s++])*t+n,u=parseInt(e[s++])*t+r,h=parseInt(e[s++])*t+n,d=parseInt(e[s++])*t+r,p=parseInt(e[s++])*t+n,m=parseInt(e[s++])*t+r,o.bezierCurveTo(h,d,p,m,c,u)}}return{offsetX:i.ha*t,path:o}}class Pu extends he{constructor(e){super(e),this.type=j}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},n=function(e,t,n){t=t||1024;let r=e.pos,s=-1,i=0,o="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(s=a.indexOf("\n"))&&i<t&&r<e.byteLength;)o+=a,i+=a.length,r+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<s&&(e.pos+=i+s+1,o+a.slice(0,s))},r=function(e,t,n,r){const s=e[t+3],i=Math.pow(2,s-128)/255;n[r+0]=e[t+0]*i,n[r+1]=e[t+1]*i,n[r+2]=e[t+2]*i,n[r+3]=1},s=function(e,t,n,r){const s=e[t+3],i=Math.pow(2,s-128)/255;n[r+0]=Ee.toHalfFloat(Math.min(e[t+0]*i,65504)),n[r+1]=Ee.toHalfFloat(Math.min(e[t+1]*i,65504)),n[r+2]=Ee.toHalfFloat(Math.min(e[t+2]*i,65504)),n[r+3]=Ee.toHalfFloat(1)},i=new Uint8Array(e);i.pos=0;const o=function(e){const r=/^#\?(\S+)/,s=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let c,u;for((e.pos>=e.byteLength||!(c=n(e)))&&t(1,"no header found"),(u=c.match(r))||t(3,"bad initial token"),l.valid|=1,l.programtype=u[1],l.string+=c+"\n";c=n(e),!1!==c;)if(l.string+=c+"\n","#"!==c.charAt(0)){if((u=c.match(s))&&(l.gamma=parseFloat(u[1])),(u=c.match(i))&&(l.exposure=parseFloat(u[1])),(u=c.match(o))&&(l.valid|=2,l.format=u[1]),(u=c.match(a))&&(l.valid|=4,l.height=parseInt(u[1],10),l.width=parseInt(u[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=c+"\n";return 2&l.valid||t(3,"missing format specifier"),4&l.valid||t(3,"missing image size specifier"),l}(i),a=o.width,l=o.height,c=function(e,n,r){const s=n;if(s<8||s>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);s!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const i=new Uint8Array(4*n*r);i.length||t(4,"unable to allocate buffer space");let o=0,a=0;const l=4*s,c=new Uint8Array(4),u=new Uint8Array(l);let h=r;for(;h>0&&a<e.byteLength;){a+4>e.byteLength&&t(1),c[0]=e[a++],c[1]=e[a++],c[2]=e[a++],c[3]=e[a++],(2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=s)&&t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&a<e.byteLength;){n=e[a++];const s=n>128;if(s&&(n-=128),(0===n||r+n>l)&&t(3,"bad scanline data"),s){const t=e[a++];for(let e=0;e<n;e++)u[r++]=t}else u.set(e.subarray(a,a+n),r),r+=n,a+=n}const d=s;for(let e=0;e<d;e++){let t=0;i[o]=u[e+t],t+=s,i[o+1]=u[e+t],t+=s,i[o+2]=u[e+t],t+=s,i[o+3]=u[e+t],o+=4}h--}return i}(i.subarray(i.pos),a,l);let u,h,d;switch(this.type){case de:d=c.length/4;const e=new Float32Array(4*d);for(let n=0;n<d;n++)r(c,4*n,e,4*n);u=e,h=de;break;case j:d=c.length/4;const t=new Uint16Array(4*d);for(let n=0;n<d;n++)s(c,4*n,t,4*n);u=t,h=j;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:a,height:l,data:u,header:o.string,gamma:o.gamma,exposure:o.exposure,type:h}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function(e,n){switch(e.type){case de:case j:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=Se,e.magFilter=Se,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)},n,r)}}const Ru=(()=>{class e extends ie{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,t,n,r){const s=this,i=new oe(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(e,function(n){try{t(s.parse(n))}catch(i){r?r(i):console.error(i),s.manager.itemError(e)}},n,r)}parse(e){const t=this;function n(e,t,n,s,i,o,a,l){if(0==t||0==n)return void e.lineTo(l.x,l.y);s=s*Math.PI/180,t=Math.abs(t),n=Math.abs(n);const c=(a.x-l.x)/2,u=(a.y-l.y)/2,h=Math.cos(s)*c+Math.sin(s)*u,d=-Math.sin(s)*c+Math.cos(s)*u;let p=t*t,m=n*n;const f=h*h,g=d*d,y=f/p+g/m;if(y>1){const e=Math.sqrt(y);p=(t*=e)*t,m=(n*=e)*n}const v=p*g+m*f,x=(p*m-v)/v;let b=Math.sqrt(Math.max(0,x));i===o&&(b=-b);const _=b*t*d/n,w=-b*n*h/t,T=Math.cos(s)*_-Math.sin(s)*w+(a.x+l.x)/2,E=Math.sin(s)*_+Math.cos(s)*w+(a.y+l.y)/2,S=r(1,0,(h-_)/t,(d-w)/n),A=r((h-_)/t,(d-w)/n,(-h-_)/t,(-d-w)/n)%(2*Math.PI);e.currentPath.absellipse(T,E,t,n,S,S+A,0===o,s)}function r(e,t,n,r){const s=e*n+t*r,i=Math.sqrt(e*e+t*t)*Math.sqrt(n*n+r*r);let o=Math.acos(Math.max(-1,Math.min(1,s/i)));return e*r-t*n<0&&(o=-o),o}function s(e,t){t=Object.assign({},t);let n={};if(e.hasAttribute("class")){const t=e.getAttribute("class").split(/\s/).filter(Boolean).map(e=>e.trim());for(let e=0;e<t.length;e++)n=Object.assign(n,f["."+t[e]])}function r(r,s,i){void 0===i&&(i=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(r)&&(t[s]=i(e.getAttribute(r))),n[r]&&(t[s]=i(n[r])),e.style&&""!==e.style[r]&&(t[s]=i(e.style[r]))}function s(e){return Math.max(0,Math.min(1,c(e)))}function i(e){return Math.max(0,c(e))}return e.hasAttribute("id")&&(n=Object.assign(n,f["#"+e.getAttribute("id")])),r("fill","fill"),r("fill-opacity","fillOpacity",s),r("fill-rule","fillRule"),r("opacity","opacity",s),r("stroke","stroke"),r("stroke-opacity","strokeOpacity",s),r("stroke-width","strokeWidth",i),r("stroke-linejoin","strokeLineJoin"),r("stroke-linecap","strokeLineCap"),r("stroke-miterlimit","strokeMiterLimit",i),r("visibility","visibility"),t}function i(e,t){return e-(t-e)}function o(e,t,n){if("string"!=typeof e)throw new TypeError("Invalid input: "+typeof e);const r={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/};let s=0,i=!0,o="",a="";const l=[];function c(e,t,n){const r=new SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw r.partial=n,r}function u(){""!==o&&(""===a?l.push(Number(o)):l.push(Number(o)*Math.pow(10,Number(a)))),o="",a=""}let h;const d=e.length;for(let p=0;p<d;p++)if(h=e[p],Array.isArray(t)&&t.includes(l.length%n)&&r.FLAGS.test(h))s=1,o=h,u();else{if(0===s){if(r.WHITESPACE.test(h))continue;if(r.DIGIT.test(h)||r.SIGN.test(h)){s=1,o=h;continue}if(r.POINT.test(h)){s=2,o=h;continue}r.COMMA.test(h)&&(i&&c(h,p,l),i=!0)}if(1===s){if(r.DIGIT.test(h)){o+=h;continue}if(r.POINT.test(h)){o+=h,s=2;continue}if(r.EXP.test(h)){s=3;continue}r.SIGN.test(h)&&1===o.length&&r.SIGN.test(o[0])&&c(h,p,l)}if(2===s){if(r.DIGIT.test(h)){o+=h;continue}if(r.EXP.test(h)){s=3;continue}r.POINT.test(h)&&"."===o[o.length-1]&&c(h,p,l)}if(3===s){if(r.DIGIT.test(h)){a+=h;continue}if(r.SIGN.test(h)){if(""===a){a+=h;continue}1===a.length&&r.SIGN.test(a)&&c(h,p,l)}}r.WHITESPACE.test(h)?(u(),s=0,i=!1):r.COMMA.test(h)?(u(),s=0,i=!0):r.SIGN.test(h)?(u(),s=1,o=h):r.POINT.test(h)?(u(),s=2,o=h):c(h,p,l)}return u(),l}const a=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function c(e){let n,r="px";if("string"==typeof e||e instanceof String)for(let t=0,s=a.length;t<s;t++){const n=a[t];if(e.endsWith(n)){r=n,e=e.substring(0,e.length-n.length);break}}return"px"===r&&"px"!==t.defaultUnit?n=l.in[t.defaultUnit]/t.defaultDPI:(n=l[r][t.defaultUnit],n<0&&(n=l[r].in*t.defaultDPI)),n*parseFloat(e)}function u(e){const t=e.elements;return t[0]*t[4]-t[1]*t[3]<0}function h(e){const t=e.elements,n=t[0]*t[3]+t[1]*t[4];if(0===n)return!1;const r=d(e),s=p(e);return Math.abs(n/(r*s))>Number.EPSILON}function d(e){const t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function p(e){const t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}const m=[],f={},g=[],y=new ve,v=new ve,x=new ve,_=new ve,w=new T,E=new b,S=new ve,A=(new DOMParser).parseFromString(e,"image/svg+xml");return function e(t,r){if(1!==t.nodeType)return;const a=function(e){if(!(e.hasAttribute("transform")||"use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))))return null;const t=function(e){const t=new ve,n=y;if("use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))){const n=c(e.getAttribute("x")),r=c(e.getAttribute("y"));t.translate(n,r)}if(e.hasAttribute("transform")){const r=e.getAttribute("transform").split(")");for(let e=r.length-1;e>=0;e--){const s=r[e].trim();if(""===s)continue;const i=s.indexOf("("),a=s.length;if(i>0&&i<a){const e=s.slice(0,i),t=o(s.slice(i+1));switch(n.identity(),e){case"translate":if(t.length>=1){const e=t[0];let r=0;t.length>=2&&(r=t[1]),n.translate(e,r)}break;case"rotate":if(t.length>=1){let e=0,r=0,s=0;e=t[0]*Math.PI/180,t.length>=3&&(r=t[1],s=t[2]),v.makeTranslation(-r,-s),x.makeRotation(e),_.multiplyMatrices(x,v),v.makeTranslation(r,s),n.multiplyMatrices(v,_)}break;case"scale":if(t.length>=1){const e=t[0];let r=e;t.length>=2&&(r=t[1]),n.scale(e,r)}break;case"skewX":1===t.length&&n.set(1,Math.tan(t[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===t.length&&n.set(1,0,0,Math.tan(t[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===t.length&&n.set(t[0],t[2],t[4],t[1],t[3],t[5],0,0,1)}}t.premultiply(n)}}return t}(e);return g.length>0&&t.premultiply(g[g.length-1]),S.copy(t),g.push(t),t}(t);let l=!1,A=null;switch(t.nodeName){case"svg":case"g":r=s(t,r);break;case"style":!function(e){if(e.sheet&&e.sheet.cssRules&&e.sheet.cssRules.length)for(let t=0;t<e.sheet.cssRules.length;t++){const n=e.sheet.cssRules[t];if(1!==n.type)continue;const r=n.selectorText.split(/,/gm).filter(Boolean).map(e=>e.trim());for(let e=0;e<r.length;e++){const t=Object.fromEntries(Object.entries(n.style).filter(([,e])=>""!==e));f[r[e]]=Object.assign(f[r[e]]||{},t)}}}(t);break;case"path":r=s(t,r),t.hasAttribute("d")&&(A=function(e){const t=new $e,r=new T,s=new T,a=new T;let l=!0,c=!1;const u=e.getAttribute("d");if(""===u||"none"===u)return null;const h=u.match(/[a-df-z][^a-df-z]*/gi);for(let d=0,p=h.length;d<p;d++){const e=h[d],u=e.charAt(0),p=e.slice(1).trim();let m;switch(!0===l&&(c=!0,l=!1),u){case"M":m=o(p);for(let e=0,n=m.length;e<n;e+=2)r.x=m[e+0],r.y=m[e+1],s.x=r.x,s.y=r.y,0===e?t.moveTo(r.x,r.y):t.lineTo(r.x,r.y),0===e&&a.copy(r);break;case"H":m=o(p);for(let e=0,n=m.length;e<n;e++)r.x=m[e],s.x=r.x,s.y=r.y,t.lineTo(r.x,r.y),0===e&&!0===c&&a.copy(r);break;case"V":m=o(p);for(let e=0,n=m.length;e<n;e++)r.y=m[e],s.x=r.x,s.y=r.y,t.lineTo(r.x,r.y),0===e&&!0===c&&a.copy(r);break;case"L":m=o(p);for(let e=0,n=m.length;e<n;e+=2)r.x=m[e+0],r.y=m[e+1],s.x=r.x,s.y=r.y,t.lineTo(r.x,r.y),0===e&&!0===c&&a.copy(r);break;case"C":m=o(p);for(let e=0,n=m.length;e<n;e+=6)t.bezierCurveTo(m[e+0],m[e+1],m[e+2],m[e+3],m[e+4],m[e+5]),s.x=m[e+2],s.y=m[e+3],r.x=m[e+4],r.y=m[e+5],0===e&&!0===c&&a.copy(r);break;case"S":m=o(p);for(let e=0,n=m.length;e<n;e+=4)t.bezierCurveTo(i(r.x,s.x),i(r.y,s.y),m[e+0],m[e+1],m[e+2],m[e+3]),s.x=m[e+0],s.y=m[e+1],r.x=m[e+2],r.y=m[e+3],0===e&&!0===c&&a.copy(r);break;case"Q":m=o(p);for(let e=0,n=m.length;e<n;e+=4)t.quadraticCurveTo(m[e+0],m[e+1],m[e+2],m[e+3]),s.x=m[e+0],s.y=m[e+1],r.x=m[e+2],r.y=m[e+3],0===e&&!0===c&&a.copy(r);break;case"T":m=o(p);for(let e=0,n=m.length;e<n;e+=2){const n=i(r.x,s.x),o=i(r.y,s.y);t.quadraticCurveTo(n,o,m[e+0],m[e+1]),s.x=n,s.y=o,r.x=m[e+0],r.y=m[e+1],0===e&&!0===c&&a.copy(r)}break;case"A":m=o(p,[3,4],7);for(let e=0,i=m.length;e<i;e+=7){if(m[e+5]==r.x&&m[e+6]==r.y)continue;const i=r.clone();r.x=m[e+5],r.y=m[e+6],s.x=r.x,s.y=r.y,n(t,m[e],m[e+1],m[e+2],m[e+3],m[e+4],i,r),0===e&&!0===c&&a.copy(r)}break;case"m":m=o(p);for(let e=0,n=m.length;e<n;e+=2)r.x+=m[e+0],r.y+=m[e+1],s.x=r.x,s.y=r.y,0===e?t.moveTo(r.x,r.y):t.lineTo(r.x,r.y),0===e&&a.copy(r);break;case"h":m=o(p);for(let e=0,n=m.length;e<n;e++)r.x+=m[e],s.x=r.x,s.y=r.y,t.lineTo(r.x,r.y),0===e&&!0===c&&a.copy(r);break;case"v":m=o(p);for(let e=0,n=m.length;e<n;e++)r.y+=m[e],s.x=r.x,s.y=r.y,t.lineTo(r.x,r.y),0===e&&!0===c&&a.copy(r);break;case"l":m=o(p);for(let e=0,n=m.length;e<n;e+=2)r.x+=m[e+0],r.y+=m[e+1],s.x=r.x,s.y=r.y,t.lineTo(r.x,r.y),0===e&&!0===c&&a.copy(r);break;case"c":m=o(p);for(let e=0,n=m.length;e<n;e+=6)t.bezierCurveTo(r.x+m[e+0],r.y+m[e+1],r.x+m[e+2],r.y+m[e+3],r.x+m[e+4],r.y+m[e+5]),s.x=r.x+m[e+2],s.y=r.y+m[e+3],r.x+=m[e+4],r.y+=m[e+5],0===e&&!0===c&&a.copy(r);break;case"s":m=o(p);for(let e=0,n=m.length;e<n;e+=4)t.bezierCurveTo(i(r.x,s.x),i(r.y,s.y),r.x+m[e+0],r.y+m[e+1],r.x+m[e+2],r.y+m[e+3]),s.x=r.x+m[e+0],s.y=r.y+m[e+1],r.x+=m[e+2],r.y+=m[e+3],0===e&&!0===c&&a.copy(r);break;case"q":m=o(p);for(let e=0,n=m.length;e<n;e+=4)t.quadraticCurveTo(r.x+m[e+0],r.y+m[e+1],r.x+m[e+2],r.y+m[e+3]),s.x=r.x+m[e+0],s.y=r.y+m[e+1],r.x+=m[e+2],r.y+=m[e+3],0===e&&!0===c&&a.copy(r);break;case"t":m=o(p);for(let e=0,n=m.length;e<n;e+=2){const n=i(r.x,s.x),o=i(r.y,s.y);t.quadraticCurveTo(n,o,r.x+m[e+0],r.y+m[e+1]),s.x=n,s.y=o,r.x=r.x+m[e+0],r.y=r.y+m[e+1],0===e&&!0===c&&a.copy(r)}break;case"a":m=o(p,[3,4],7);for(let e=0,i=m.length;e<i;e+=7){if(0==m[e+5]&&0==m[e+6])continue;const i=r.clone();r.x+=m[e+5],r.y+=m[e+6],s.x=r.x,s.y=r.y,n(t,m[e],m[e+1],m[e+2],m[e+3],m[e+4],i,r),0===e&&!0===c&&a.copy(r)}break;case"Z":case"z":t.currentPath.autoClose=!0,t.currentPath.curves.length>0&&(r.copy(a),t.currentPath.currentPoint.copy(r),l=!0);break;default:console.warn(e)}c=!1}return t}(t));break;case"rect":r=s(t,r),A=function(e){const t=c(e.getAttribute("x")||0),n=c(e.getAttribute("y")||0),r=c(e.getAttribute("rx")||e.getAttribute("ry")||0),s=c(e.getAttribute("ry")||e.getAttribute("rx")||0),i=c(e.getAttribute("width")),o=c(e.getAttribute("height")),a=.448084975506,l=new $e;return l.moveTo(t+r,n),l.lineTo(t+i-r,n),(0!==r||0!==s)&&l.bezierCurveTo(t+i-r*a,n,t+i,n+s*a,t+i,n+s),l.lineTo(t+i,n+o-s),(0!==r||0!==s)&&l.bezierCurveTo(t+i,n+o-s*a,t+i-r*a,n+o,t+i-r,n+o),l.lineTo(t+r,n+o),(0!==r||0!==s)&&l.bezierCurveTo(t+r*a,n+o,t,n+o-s*a,t,n+o-s),l.lineTo(t,n+s),(0!==r||0!==s)&&l.bezierCurveTo(t,n+s*a,t+r*a,n,t+r,n),l}(t);break;case"polygon":r=s(t,r),A=function(e){function t(e,t,n){const i=c(t),o=c(n);0===s?r.moveTo(i,o):r.lineTo(i,o),s++}const n=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,r=new $e;let s=0;return e.getAttribute("points").replace(n,t),r.currentPath.autoClose=!0,r}(t);break;case"polyline":r=s(t,r),A=function(e){function t(e,t,n){const i=c(t),o=c(n);0===s?r.moveTo(i,o):r.lineTo(i,o),s++}const n=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,r=new $e;let s=0;return e.getAttribute("points").replace(n,t),r.currentPath.autoClose=!1,r}(t);break;case"circle":r=s(t,r),A=function(e){const t=c(e.getAttribute("cx")||0),n=c(e.getAttribute("cy")||0),r=c(e.getAttribute("r")||0),s=new we;s.absarc(t,n,r,0,2*Math.PI);const i=new $e;return i.subPaths.push(s),i}(t);break;case"ellipse":r=s(t,r),A=function(e){const t=c(e.getAttribute("cx")||0),n=c(e.getAttribute("cy")||0),r=c(e.getAttribute("rx")||0),s=c(e.getAttribute("ry")||0),i=new we;i.absellipse(t,n,r,s,0,2*Math.PI);const o=new $e;return o.subPaths.push(i),o}(t);break;case"line":r=s(t,r),A=function(e){const t=c(e.getAttribute("x1")||0),n=c(e.getAttribute("y1")||0),r=c(e.getAttribute("x2")||0),s=c(e.getAttribute("y2")||0),i=new $e;return i.moveTo(t,n),i.lineTo(r,s),i.currentPath.autoClose=!1,i}(t);break;case"defs":l=!0;break;case"use":r=s(t,r);const a=(t.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),u=t.viewportElement.getElementById(a);u?e(u,r):console.warn("SVGLoader: 'use node' references non-existent node id: "+a)}A&&(void 0!==r.fill&&"none"!==r.fill&&A.color.setStyle(r.fill,"srgb"),function(e,t){function n(e){E.set(e.x,e.y,1).applyMatrix3(t),e.set(E.x,E.y)}function r(e){const n=e.xRadius,r=e.yRadius,s=Math.cos(e.aRotation),i=Math.sin(e.aRotation),o=new b(n*s,n*i,0),a=new b(-r*i,r*s,0),l=o.applyMatrix3(t),c=a.applyMatrix3(t),h=y.set(l.x,c.x,0,l.y,c.y,0,0,0,1),d=v.copy(h).invert(),p=x.copy(d).transpose().multiply(d).elements,m=function(e,t,n){let r,s,i,o,a;const l=e+n,c=e-n,u=Math.sqrt(c*c+4*t*t);return l>0?(r=.5*(l+u),a=1/r,s=e*a*n-t*a*t):l<0?s=.5*(l-u):(r=.5*u,s=-.5*u),i=c>0?c+u:c-u,Math.abs(i)>2*Math.abs(t)?(a=-2*t/i,o=1/Math.sqrt(1+a*a),i=a*o):0===Math.abs(t)?(i=1,o=0):(a=-.5*i/t,i=1/Math.sqrt(1+a*a),o=a*i),c>0&&(a=i,i=-o,o=a),{rt1:r,rt2:s,cs:i,sn:o}}(p[0],p[1],p[4]),f=Math.sqrt(m.rt1),g=Math.sqrt(m.rt2);if(e.xRadius=1/f,e.yRadius=1/g,e.aRotation=Math.atan2(m.sn,m.cs),!((e.aEndAngle-e.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const n=v.set(f,0,0,0,g,0,0,0,1),r=x.set(m.cs,m.sn,0,-m.sn,m.cs,0,0,0,1),s=n.multiply(r).multiply(h),i=e=>{const{x:t,y:n}=new b(Math.cos(e),Math.sin(e),0).applyMatrix3(s);return Math.atan2(n,t)};e.aStartAngle=i(e.aStartAngle),e.aEndAngle=i(e.aEndAngle),u(t)&&(e.aClockwise=!e.aClockwise)}}function s(e){const n=d(t),r=p(t);e.xRadius*=n,e.yRadius*=r;const s=n>Number.EPSILON?Math.atan2(t.elements[1],t.elements[0]):Math.atan2(-t.elements[3],t.elements[4]);e.aRotation+=s,u(t)&&(e.aStartAngle*=-1,e.aEndAngle*=-1,e.aClockwise=!e.aClockwise)}const i=e.subPaths;for(let o=0,a=i.length;o<a;o++){const e=i[o].curves;for(let i=0;i<e.length;i++){const o=e[i];o.isLineCurve?(n(o.v1),n(o.v2)):o.isCubicBezierCurve?(n(o.v0),n(o.v1),n(o.v2),n(o.v3)):o.isQuadraticBezierCurve?(n(o.v0),n(o.v1),n(o.v2)):o.isEllipseCurve&&(w.set(o.aX,o.aY),n(w),o.aX=w.x,o.aY=w.y,h(t)?r(o):s(o))}}}(A,S),m.push(A),A.userData={node:t,style:r});const M=t.childNodes;for(let n=0;n<M.length;n++){const t=M[n];l&&"style"!==t.nodeName&&"defs"!==t.nodeName||e(t,r)}a&&(g.pop(),g.length>0?S.copy(g[g.length-1]):S.identity())}(A.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:m,xml:A.documentElement}}static createShapes(e){const t=0,n=1,r=2,s=3,i=4,o=5,a=6,l={loc:t,t:0};function c(e,n,s,i){const o=e.x,a=n.x,c=s.x,h=i.x,d=e.y,p=n.y,m=s.y,f=i.y,g=(h-c)*(d-m)-(f-m)*(o-c),y=(f-m)*(a-o)-(h-c)*(p-d),v=g/y,x=((a-o)*(d-m)-(p-d)*(o-c))/y;if(0===y&&0!==g||v<=0||v>=1||x<0||x>1)return null;if(0===g&&0===y){for(let c=0;c<2;c++){if(u(0===c?s:i,e,n),l.loc==t){const e=0===c?s:i;return{x:e.x,y:e.y,t:l.t}}if(l.loc==r){return{x:+(o+l.t*(a-o)).toPrecision(10),y:+(d+l.t*(p-d)).toPrecision(10),t:l.t}}}return null}for(let r=0;r<2;r++)if(u(0===r?s:i,e,n),l.loc==t){const e=0===r?s:i;return{x:e.x,y:e.y,t:l.t}}return{x:+(o+v*(a-o)).toPrecision(10),y:+(d+v*(p-d)).toPrecision(10),t:v}}function u(e,c,u){const h=u.x-c.x,d=u.y-c.y,p=e.x-c.x,m=e.y-c.y,f=h*m-p*d;if(e.x===c.x&&e.y===c.y)return l.loc=t,void(l.t=0);if(e.x===u.x&&e.y===u.y)return l.loc=n,void(l.t=1);if(f<-Number.EPSILON)return void(l.loc=s);if(f>Number.EPSILON)return void(l.loc=i);if(h*p<0||d*m<0)return void(l.loc=o);if(Math.sqrt(h*h+d*d)<Math.sqrt(p*p+m*m))return void(l.loc=a);let g;g=0!==h?p/h:m/d,l.loc=r,l.t=g}function h(e,t,n){const r=new T;t.getCenter(r);const s=[];return n.forEach(t=>{t.boundingBox.containsPoint(r)&&function(e,t){const n=[],r=[];for(let s=1;s<e.length;s++){const i=e[s-1],o=e[s];for(let e=1;e<t.length;e++){const s=c(i,o,t[e-1],t[e]);null!==s&&void 0===n.find(e=>e.t<=s.t+Number.EPSILON&&e.t>=s.t-Number.EPSILON)&&(n.push(s),r.push(new T(s.x,s.y)))}}return r}(e,t.points).forEach(e=>{s.push({identifier:t.identifier,isCW:t.isCW,point:e})})}),s.sort((e,t)=>e.point.x-t.point.x),s}let d=999999999,p=-999999999,m=e.subPaths.map(e=>{const t=e.getPoints();let n=-999999999,r=999999999,s=-999999999,i=999999999;for(let o=0;o<t.length;o++){const e=t[o];e.y>n&&(n=e.y),e.y<r&&(r=e.y),e.x>s&&(s=e.x),e.x<i&&(i=e.x)}return p<=s&&(p=s+1),d>=i&&(d=i-1),{curves:e.curves,points:t,isCW:be.isClockWise(t),identifier:-1,boundingBox:new xe(new T(i,r),new T(s,n))}});m=m.filter(e=>e.points.length>1);for(let y=0;y<m.length;y++)m[y].identifier=y;const f=m.map(t=>function(e,t,n,r,s){(null==s||""===s)&&(s="nonzero");const i=new T;e.boundingBox.getCenter(i);const o=h([new T(n,i.y),new T(r,i.y)],e.boundingBox,t);o.sort((e,t)=>e.point.x-t.point.x);const a=[],l=[];o.forEach(t=>{t.identifier===e.identifier?a.push(t):l.push(t)});const c=a[0].point.x,u=[];let d=0;for(;d<l.length&&l[d].point.x<c;)u.length>0&&u[u.length-1]===l[d].identifier?u.pop():u.push(l[d].identifier),d++;if(u.push(e.identifier),"evenodd"===s){const t=u.length%2==0,n=u[u.length-2];return{identifier:e.identifier,isHole:t,for:n}}if("nonzero"===s){let n=!0,r=null,s=null;for(let e=0;e<u.length;e++){const i=u[e];n?(s=t[i].isCW,n=!1,r=i):s!==t[i].isCW&&(s=t[i].isCW,n=!0)}return{identifier:e.identifier,isHole:n,for:r}}console.warn('fill-rule: "'+s+'" is currently not implemented.')}(t,m,d,p,e.userData?e.userData.style.fillRule:void 0)),g=[];return m.forEach(e=>{if(!f[e.identifier].isHole){const t=new _e;t.curves=e.curves,f.filter(t=>t.isHole&&t.for===e.identifier).forEach(e=>{const n=m[e.identifier],r=new we;r.curves=n.curves,t.holes.push(r)}),g.push(t)}}),g}static getStrokeStyle(e,t,n,r,s){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:n=void 0!==n?n:"miter",strokeLineCap:r=void 0!==r?r:"butt",strokeMiterLimit:s=void 0!==s?s:4}}static pointsToStroke(t,n,r,s){const i=[],o=[],a=[];if(0===e.pointsToStrokeWithBuffers(t,n,r,s,i,o,a))return null;const l=new u;return l.setAttribute("position",new h(i,3)),l.setAttribute("normal",new h(o,3)),l.setAttribute("uv",new h(a,2)),l}static pointsToStrokeWithBuffers(e,t,n,r,s,i,o,a){const l=new T,c=new T,u=new T,h=new T,d=new T,p=new T,m=new T,f=new T,g=new T,y=new T,v=new T,x=new T,b=new T,_=new T,w=new T,E=new T,S=new T;n=void 0!==n?n:12,r=void 0!==r?r:.001,a=void 0!==a?a:0,e=function(e){let t=!1;for(let s=1,i=e.length-1;s<i;s++)if(e[s].distanceTo(e[s+1])<r){t=!0;break}if(!t)return e;const n=[];n.push(e[0]);for(let s=1,i=e.length-1;s<i;s++)e[s].distanceTo(e[s+1])>=r&&n.push(e[s]);return n.push(e[e.length-1]),n}(e);const A=e.length;if(A<2)return 0;const M=e[0].equals(e[A-1]);let O,C,N=e[0];const P=t.strokeWidth/2,R=1/(A-1);let I,L,k,D,z=0,U=!1,F=0,B=3*a,V=2*a;j(e[0],e[1],l).multiplyScalar(P),f.copy(e[0]).sub(l),g.copy(e[0]).add(l),y.copy(f),v.copy(g);for(let T=1;T<A;T++){O=e[T],C=T===A-1?M?e[1]:void 0:e[T+1];const n=l;if(j(N,O,n),u.copy(n).multiplyScalar(P),x.copy(O).sub(u),b.copy(O).add(u),I=z+R,L=!1,void 0!==C){j(O,C,c),u.copy(c).multiplyScalar(P),_.copy(O).sub(u),w.copy(O).add(u),k=!0,u.subVectors(C,N),n.dot(u)<0&&(k=!1),1===T&&(U=k),u.subVectors(C,O),u.normalize();const e=Math.abs(n.dot(u));if(e>Number.EPSILON){const n=P/e;u.multiplyScalar(-n),h.subVectors(O,N),d.copy(h).setLength(n).add(u),E.copy(d).negate();const r=d.length(),s=h.length();h.divideScalar(s),p.subVectors(C,O);const i=p.length();switch(p.divideScalar(i),h.dot(E)<s&&p.dot(E)<i&&(L=!0),S.copy(d).add(O),E.add(O),D=!1,L?k?(w.copy(E),b.copy(E)):(_.copy(E),x.copy(E)):W(),t.strokeLineJoin){case"bevel":X(k,L,I);break;case"round":G(k,L),k?Y(O,x,_,I,0):Y(O,w,b,I,1);break;default:const e=P*t.strokeMiterLimit/r;if(e<1){if("miter-clip"!==t.strokeLineJoin){X(k,L,I);break}G(k,L),k?(p.subVectors(S,x).multiplyScalar(e).add(x),m.subVectors(S,_).multiplyScalar(e).add(_),H(x,I,0),H(p,I,0),H(O,I,.5),H(O,I,.5),H(p,I,0),H(m,I,0),H(O,I,.5),H(m,I,0),H(_,I,0)):(p.subVectors(S,b).multiplyScalar(e).add(b),m.subVectors(S,w).multiplyScalar(e).add(w),H(b,I,1),H(p,I,1),H(O,I,.5),H(O,I,.5),H(p,I,1),H(m,I,1),H(O,I,.5),H(m,I,1),H(w,I,1))}else L?(k?(H(g,z,1),H(f,z,0),H(S,I,0),H(g,z,1),H(S,I,0),H(E,I,1)):(H(g,z,1),H(f,z,0),H(S,I,1),H(f,z,0),H(E,I,0),H(S,I,1)),k?_.copy(S):w.copy(S)):k?(H(x,I,0),H(S,I,0),H(O,I,.5),H(O,I,.5),H(S,I,0),H(_,I,0)):(H(b,I,1),H(S,I,1),H(O,I,.5),H(O,I,.5),H(S,I,1),H(w,I,1)),D=!0}}else W()}else W();!M&&T===A-1&&q(e[0],y,v,k,!0,z),z=I,N=O,f.copy(_),g.copy(w)}if(M){if(L&&s){let e=S,t=E;U!==k&&(e=E,t=S),k?(D||U)&&(t.toArray(s,0),t.toArray(s,9),D&&e.toArray(s,3)):(D||!U)&&(t.toArray(s,3),t.toArray(s,9),D&&e.toArray(s,0))}}else q(O,x,b,k,!1,I);return F;function j(e,t,n){return n.subVectors(t,e),n.set(-n.y,n.x).normalize()}function H(e,t,n){s&&(s[B]=e.x,s[B+1]=e.y,s[B+2]=0,i&&(i[B]=0,i[B+1]=0,i[B+2]=1),B+=3,o&&(o[V]=t,o[V+1]=n,V+=2)),F+=3}function Y(e,t,r,s,i){l.copy(t).sub(e).normalize(),c.copy(r).sub(e).normalize();let o=Math.PI;const a=l.dot(c);Math.abs(a)<1&&(o=Math.abs(Math.acos(a))),o/=n,u.copy(t);for(let l=0,c=n-1;l<c;l++)h.copy(u).rotateAround(e,o),H(u,s,i),H(h,s,i),H(e,s,.5),u.copy(h);H(h,s,i),H(r,s,i),H(e,s,.5)}function W(){H(g,z,1),H(f,z,0),H(x,I,0),H(g,z,1),H(x,I,0),H(b,I,1)}function X(e,t,n){t?e?(H(g,z,1),H(f,z,0),H(x,I,0),H(g,z,1),H(x,I,0),H(E,I,1),H(x,n,0),H(_,n,0),H(E,n,.5)):(H(g,z,1),H(f,z,0),H(b,I,1),H(f,z,0),H(E,I,0),H(b,I,1),H(b,n,1),H(E,n,0),H(w,n,1)):e?(H(x,n,0),H(_,n,0),H(O,n,.5)):(H(b,n,1),H(w,n,0),H(O,n,.5))}function G(e,t){t&&(e?(H(g,z,1),H(f,z,0),H(x,I,0),H(g,z,1),H(x,I,0),H(E,I,1),H(x,z,0),H(O,I,.5),H(E,I,1),H(O,I,.5),H(_,z,0),H(E,I,1)):(H(g,z,1),H(f,z,0),H(b,I,1),H(f,z,0),H(E,I,0),H(b,I,1),H(b,z,1),H(E,I,0),H(O,I,.5),H(O,I,.5),H(E,I,0),H(w,z,1)))}function q(e,n,r,i,a,d){switch(t.strokeLineCap){case"round":a?Y(e,r,n,d,.5):Y(e,n,r,d,.5);break;case"square":if(a)l.subVectors(n,e),c.set(l.y,-l.x),u.addVectors(l,c).add(e),h.subVectors(c,l).add(e),i?(u.toArray(s,3),h.toArray(s,0),h.toArray(s,9)):(u.toArray(s,3),1===o[7]?h.toArray(s,9):u.toArray(s,9),h.toArray(s,0));else{l.subVectors(r,e),c.set(l.y,-l.x),u.addVectors(l,c).add(e),h.subVectors(c,l).add(e);const t=s.length;i?(u.toArray(s,t-3),h.toArray(s,t-6),h.toArray(s,t-12)):(h.toArray(s,t-6),u.toArray(s,t-3),h.toArray(s,t-12))}}}}}return e})(),Iu=new WeakMap;class Lu extends ie{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const s=new oe(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(r)},n,r)}decodeDracoFile(e,t,n,r){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const a in t.attributeTypes){const e=t.attributeTypes[a];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[a]=e.name)}const n=JSON.stringify(t);if(Iu.has(e)){const t=Iu.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,i=e.byteLength,o=this._getWorker(s,i).then(n=>(r=n,new Promise((n,i)=>{r._callbacks[s]={resolve:n,reject:i},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return o.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Iu.set(e,{key:n,promise:o}),o}_createGeometry(e){const t=new u;e.index&&t.setIndex(new v(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],s=r.name,i=r.array,o=r.itemSize;t.setAttribute(s,new v(i,o))}return t}_loadLibrary(e,t){const n=new oe(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((t,r)=>{n.load(e,t,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=ku.toString(),s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function ku(){let e,t;function n(e,t,n,r,s,i){const o=i.num_components(),a=n.num_points()*o,l=a*s.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,s),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,i,c,l,u);const h=new s(e.HEAPF32.buffer,u,a).slice();return e._free(u),{name:r,array:h,itemSize:o}}onmessage=function(r){const s=r.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":const r=s.buffer,i=s.taskConfig;t.then(e=>{const t=e.draco,o=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(r),r.byteLength);try{const e=function(e,t,r,s){const i=s.attributeIDs,o=s.attributeTypes;let a,l;const c=t.GetEncodedGeometryType(r);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,l=t.DecodeBufferToMesh(r,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,l=t.DecodeBufferToPointCloud(r,a)}if(!l.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const u={index:null,attributes:[]};for(const h in i){const r=self[o[h]];let l,c;if(s.useUniqueIDs)c=i[h],l=t.GetAttributeByUniqueId(a,c);else{if(c=t.GetAttributeId(a,e[i[h]]),-1===c)continue;l=t.GetAttribute(a,c)}u.attributes.push(n(e,t,a,h,r,l))}return c===e.TRIANGULAR_MESH&&(u.index=function(e,t,n){const r=3*n.num_faces(),s=4*r,i=e._malloc(s);t.GetTrianglesUInt32Array(n,s,i);const o=new Uint32Array(e.HEAPF32.buffer,i,r).slice();return e._free(i),{array:o,itemSize:1}}(e,t,a)),e.destroy(a),u}(t,o,a,i),r=e.attributes.map(e=>e.array.buffer);e.index&&r.push(e.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:e},r)}catch(Bw){console.error(Bw),self.postMessage({type:"error",id:s.id,error:Bw.message})}finally{t.destroy(a),t.destroy(o)}})}}}El({screenspace:!1,color:new g("black"),opacity:1,thickness:.05,size:new T(1,1)},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   uniform float thickness;\n   uniform bool screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n       #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n     #include <morphtarget_vertex>\n     #include <skinning_vertex>\n     #include <project_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }","uniform vec3 color;\n   uniform float opacity;\n   void main(){\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <colorspace_fragment>\n   }");Gl.ReflectorShader;const Du=["args","center"],zu=Tt({__name:"Text3D",props:{font:{},text:{},size:{default:.5},height:{default:.2},curveSegments:{default:5},bevelEnabled:{type:Boolean,default:!0},bevelThickness:{default:.05},bevelSize:{default:.02},bevelOffset:{default:0},bevelSegments:{default:4},center:{type:Boolean,default:!1},needUpdates:{type:Boolean,default:!1}},async setup(e,{expose:t}){let n,r;const s=e,{center:i,font:o,text:a,needUpdates:l,size:c,height:u,curveSegments:h,bevelEnabled:d,bevelThickness:p,bevelSize:m,bevelOffset:f,bevelSegments:g}=Xt(s),{extend:y,invalidate:v}=Ms();Ct(s,()=>{v()}),y({TextGeometry:Tu});const x=new Ou,b=Et(),_=Yt(()=>a?.value?a.value:b.default?b.default()[0].children?.trim():l.value?"":"TresJS"),w=At();t({instance:w});const T=([n,r]=Qt(()=>new Promise((e,t)=>{try{"string"==typeof o.value?x.load(o.value,t=>{e(t)}):e(o.value)}catch(Xw){t(console.error("cientos",Xw))}})),n=await n,r(),n),E=Yt(()=>({font:T,size:Nt(c),height:Nt(u),curveSegments:Nt(h),bevelEnabled:Nt(d),bevelThickness:Nt(p),bevelSize:Nt(m),bevelOffset:Nt(f),bevelSegments:Nt(g)}));return Ut(()=>{w.value&&l.value&&(w.value.geometry.dispose(),w.value.geometry=new Tu(_.value,E.value),i.value&&w.value.geometry.center())}),(e,t)=>Lt(o)?(Rt(),Mt("TresMesh",{key:0,ref_key:"text3DRef",ref:w},[_.value?(Rt(),Mt("TresTextGeometry",{key:0,args:[_.value,E.value],center:Lt(i)},null,8,Du)):Gt("",!0),Zt(e.$slots,"default")],512)):Gt("",!0)}});function Uu(e,t,n){const r=St(t),s=Yt(()=>new Y(r.value)),i=$t({}),o=()=>{const t=Lt(e);t&&t.length>0&&(Object.keys(i).forEach(e=>delete i[e]),t.forEach(e=>{const t=s.value.clipAction(e,r.value);i[e.name]=t}))};Ct(e,o,{deep:!0,immediate:!0}),Ct(r,e=>{e&&(s.value.uncacheRoot(r.value),o())});{const{onBeforeRender:e}=Os();e(({delta:e})=>{s.value.update(e)})}return{actions:i,mixer:s}}new b,new b,new b;const Fu={sunset:"venice/venice_sunset_1k.hdr",studio:"studio/poly_haven_studio_1k.hdr",city:"city/canary_wharf_1k.hdr",umbrellas:"outdoor/outdoor_umbrellas_1k.hdr",night:"outdoor/satara_night_1k.hdr",forest:"outood/mossy_forest_1k.hdr",snow:"outdoor/snowy_forest_path_01_1k.hdr",dawn:"kiara/kiara_1_dawn_1k.hdr",hangar:"indoor/small_hangar_01_1k.hdr",urban:"indoor/abandoned_games_room_02_1k.hdr",modern:"city/modern_buildings_2_1k.hdr",shangai:"city/shanghai_bund_1k.hdr"};function Bu(e){return e instanceof ue?e:Array.isArray(e)?new ue(e[0],e[1],e[2]):"number"==typeof e?new ue(e,e,e):e instanceof b||"object"==typeof e&&"x"in e&&"y"in e&&"z"in e?new ue(e.x,e.y,e.z):null}function Vu(e){e.traverse(e=>{e instanceof p&&e.material&&(e.material.needsUpdate=!0)})}async function ju(e,t){const{scene:n,invalidate:r}=Ms(),{preset:s,blur:i,files:o=St([]),path:a=St(""),background:l,backgroundIntensity:c=St(1),environmentIntensity:u=St(1),backgroundRotation:h=St([0,0,0]),environmentRotation:d=St([0,0,0]),syncMaterials:p=St(!1)}=Xt(e);Ct(e,()=>{r()});const m=St(null),f=Yt(()=>Array.isArray(o.value)),g=new re,y=new Pu;return Ct([o,a],async([e,t])=>{if(e&&0!==e.length&&!s?.value)try{const n=await(async(e,t)=>new Promise((n,r)=>{f.value?(t&&g.setPath(t),g.load(e,e=>{e.mapping=pe,n(e)},void 0,e=>r(e))):(t&&y.setPath(t),y.load(e[0],e=>{e.mapping=se,n(e)},void 0,e=>r(e)))}))(f.value?[...Lt(e)]:[Lt(e)],Lt(t));m.value=n}catch(n){throw new Error(`Failed to load environment map: ${n}`)}},{immediate:!0}),Ct(m,e=>{n.value&&e&&(n.value.environment=e)},{immediate:!0}),Ct([l,m],([e,r])=>{if(n.value){const s=t?.value?t.value.texture:r;s&&(n.value.background=e?s:null)}},{immediate:!0}),Ct(()=>i?.value,e=>{n.value&&e&&(n.value.backgroundBlurriness=e)},{immediate:!0}),Ct(()=>c?.value,e=>{n.value&&(n.value.backgroundIntensity=e??1)},{immediate:!0}),Ct(()=>u?.value,e=>{n.value&&(n.value.environmentIntensity=e??1)},{immediate:!0}),Ct(()=>h?.value,e=>{if(n.value){const t=Bu(e);t&&(n.value.backgroundRotation=t)}},{immediate:!0}),Ct(()=>d?.value,e=>{if(n.value&&!p?.value){const t=Bu(e);t&&(n.value.environmentRotation=t,Vu(n.value))}},{immediate:!0}),Ct(()=>s?.value,async e=>{if(e&&e in Fu){const n="https://raw.githubusercontent.com/Tresjs/assets/main/textures/hdr/",s=Fu[e];try{y.setPath(n);const e=await new Promise((e,t)=>{y.load(s,t=>{t.mapping=se,e(t)},void 0,e=>t(e))});m.value=e,r()}catch(t){throw new Error(`Failed to load environment map: ${t}`)}m.value&&(m.value.mapping=se),r()}else if(e&&!(e in Fu))throw new Error(`Preset must be one of: ${Object.keys(Fu).join(", ")}`)},{immediate:!0}),Ct([p,h],([e,t])=>{if(e&&n.value){const e=Bu(t);e&&(n.value.environmentRotation=e,Vu(n.value))}},{immediate:!0}),m
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */}const Hu=1,Yu=2,Wu=4,Xu=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),Gu=0,qu=1,Zu=-1;function Ku(e){return e.isPerspectiveCamera}function Qu(e){return e.isOrthographicCamera}const Ju=2*Math.PI,$u=Math.PI/2,eh=1e-5,th=Math.PI/180;function nh(e,t,n){return Math.max(t,Math.min(n,e))}function rh(e,t=eh){return Math.abs(e)<t}function sh(e,t,n=eh){return rh(e-t,n)}function ih(e,t){return Math.round(e/t)*t}function oh(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function ah(e){return Math.abs(e)<Number.MAX_VALUE?e:e*(1/0)}function lh(e,t,n,r,s=1/0,i){const o=2/(r=Math.max(1e-4,r)),a=o*i,l=1/(1+a+.48*a*a+.235*a*a*a);let c=e-t;const u=t,h=s*r;c=nh(c,-h,h),t=e-c;const d=(n.value+o*c)*i;n.value=(n.value-o*d)*l;let p=t+(c+d)*l;return u-e>0==p>u&&(p=u,n.value=(p-u)/i),p}function ch(e,t,n,r,s=1/0,i,o){const a=2/(r=Math.max(1e-4,r)),l=a*i,c=1/(1+l+.48*l*l+.235*l*l*l);let u=t.x,h=t.y,d=t.z,p=e.x-u,m=e.y-h,f=e.z-d;const g=u,y=h,v=d,x=s*r,b=p*p+m*m+f*f;if(b>x*x){const e=Math.sqrt(b);p=p/e*x,m=m/e*x,f=f/e*x}u=e.x-p,h=e.y-m,d=e.z-f;const _=(n.x+a*p)*i,w=(n.y+a*m)*i,T=(n.z+a*f)*i;n.x=(n.x-a*_)*c,n.y=(n.y-a*w)*c,n.z=(n.z-a*T)*c,o.x=u+(p+_)*c,o.y=h+(m+w)*c,o.z=d+(f+T)*c;const E=g-e.x,S=y-e.y,A=v-e.z;return E*(o.x-g)+S*(o.y-y)+A*(o.z-v)>0&&(o.x=g,o.y=y,o.z=v,n.x=(o.x-g)/i,n.y=(o.y-y)/i,n.z=(o.z-v)/i),o}function uh(e,t){t.set(0,0),e.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=e.length,t.y/=e.length}function hh(e,t){return!!Qu(e)&&(console.warn(`${t} is not supported in OrthographicCamera`),!0)}let dh=class{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}removeAllEventListeners(e){e?Array.isArray(this._listeners[e])&&(this._listeners[e].length=0):this._listeners={}}dispatchEvent(e){const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e)}}};var ph;const mh=1/8,fh=/Mac/.test(null===(ph=globalThis?.navigator)||void 0===ph?void 0:ph.platform);let gh,yh,vh,xh,bh,_h,wh,Th,Eh,Sh,Ah,Mh,Oh,Ch,Nh,Ph,Rh,Ih,Lh,kh,Dh,zh,Uh;class Fh extends dh{static install(e){gh=e.THREE,yh=Object.freeze(new gh.Vector3(0,0,0)),vh=Object.freeze(new gh.Vector3(0,1,0)),xh=Object.freeze(new gh.Vector3(0,0,1)),bh=new gh.Vector2,_h=new gh.Vector3,wh=new gh.Vector3,Th=new gh.Vector3,Eh=new gh.Vector3,Sh=new gh.Vector3,Ah=new gh.Vector3,Mh=new gh.Vector3,Oh=new gh.Vector3,Ch=new gh.Vector3,Nh=new gh.Spherical,Ph=new gh.Spherical,Rh=new gh.Box3,Ih=new gh.Box3,Lh=new gh.Sphere,kh=new gh.Quaternion,Dh=new gh.Quaternion,zh=new gh.Matrix4,Uh=new gh.Raycaster}static get ACTION(){return Xu}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Xu.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Gu,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new gh.Vector3,this._focalOffsetVelocity=new gh.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,n,r)=>{let s,i;if(Ku(this._camera)){const n=_h.copy(this._camera.position).sub(this._target),r=this._camera.getEffectiveFOV()*th,o=n.length()*Math.tan(.5*r);s=this.truckSpeed*e*o/this._elementRect.height,i=this.truckSpeed*t*o/this._elementRect.height}else{if(!Qu(this._camera))return;{const n=this._camera;s=this.truckSpeed*e*(n.right-n.left)/n.zoom/this._elementRect.width,i=this.truckSpeed*t*(n.top-n.bottom)/n.zoom/this._elementRect.height}}r?(n?this.setFocalOffset(this._focalOffsetEnd.x+s,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(s,0,!0),this.forward(-i,!0)):n?this.setFocalOffset(this._focalOffsetEnd.x+s,this._focalOffsetEnd.y+i,this._focalOffsetEnd.z,!0):this.truck(s,i,!0)},this._rotateInternal=(e,t)=>{const n=Ju*this.azimuthRotateSpeed*e/this._elementRect.height,r=Ju*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(n,r,!0)},this._dollyInternal=(e,t,n)=>{const r=Math.pow(.95,-e*this.dollySpeed),s=this._sphericalEnd.radius,i=this._sphericalEnd.radius*r,o=nh(i,this.minDistance,this.maxDistance),a=o-i;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(i,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(a,!0),this._dollyToNoClamp(o,!0)):this._dollyToNoClamp(o,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?i:o)-s,this._dollyControlCoord.set(t,n)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,n)=>{const r=Math.pow(.95,e*this.dollySpeed),s=this._zoom,i=this._zoom*r;this.zoomTo(i,!0),this.dollyToCursor&&(this._changedZoom+=i-s,this._dollyControlCoord.set(t,n))},typeof gh>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=(new gh.Quaternion).setFromUnitVectors(this._camera.up,vh),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Xu.NONE,this._target=new gh.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new gh.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new gh.Spherical).setFromVector3(_h.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new gh.Vector3,new gh.Vector3,new gh.Vector3,new gh.Vector3],this._updateNearPlaneCorners(),this._boundary=new gh.Box3(new gh.Vector3(-1/0,-1/0,-1/0),new gh.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new gh.Vector2,this.mouseButtons={left:Xu.ROTATE,middle:Xu.DOLLY,right:Xu.TRUCK,wheel:Ku(this._camera)?Xu.DOLLY:Qu(this._camera)?Xu.ZOOM:Xu.NONE},this.touches={one:Xu.TOUCH_ROTATE,two:Ku(this._camera)?Xu.TOUCH_DOLLY_TRUCK:Qu(this._camera)?Xu.TOUCH_ZOOM_TRUCK:Xu.NONE,three:Xu.TOUCH_TRUCK};const n=new gh.Vector2,r=new gh.Vector2,s=new gh.Vector2,i=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}const t="mouse"!==e.pointerType?null:(e.buttons&Hu)===Hu?Hu:(e.buttons&Wu)===Wu?Wu:(e.buttons&Yu)===Yu?Yu:null;if(null!==t){const e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&Hu)===Hu&&this._lockedPointer)return;const n={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(n),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",a),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",a),this._isDragging=!0,h(e)},o=e=>{e.cancelable&&e.preventDefault();const t=e.pointerId,n=this._lockedPointer||this._findPointerById(t);if(n){if(n.clientX=e.clientX,n.clientY=e.clientY,n.deltaX=e.movementX,n.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&Hu)===Hu)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&Wu)===Wu&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&Yu)===Yu&&(this._state=this._state|this.mouseButtons.right);d()}},a=e=>{const t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=Xu.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=Xu.NONE;p()}};let l=-1;const c=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Xu.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Xu.ROTATE||this.mouseButtons.wheel===Xu.TRUCK){const e=performance.now();l-e<1e3&&this._getClientRect(this._elementRect),l=e}const t=fh?-1:-3,n=1===e.deltaMode||e.ctrlKey?e.deltaY/t:e.deltaY/(10*t),r=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?(e.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Xu.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case Xu.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1,!1),this._isUserControllingTruck=!0;break;case Xu.SCREEN_PAN:this._truckInternal(e.deltaX,e.deltaY,!1,!0),this._isUserControllingTruck=!0;break;case Xu.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0,!1),this._isUserControllingOffset=!0;break;case Xu.DOLLY:this._dollyInternal(-n,r,s),this._isUserControllingDolly=!0;break;case Xu.ZOOM:this._zoomInternal(-n,r,s),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},u=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===Fh.ACTION.NONE){const t=e instanceof PointerEvent?e.pointerId:0,n=this._findPointerById(t);return n&&this._disposePointer(n),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),void this._domElement.ownerDocument.removeEventListener("pointerup",a)}e.preventDefault()}},h=e=>{if(this._enabled){if(uh(this._activePointers,bh),this._getClientRect(this._elementRect),n.copy(bh),r.copy(bh),this._activePointers.length>=2){const e=bh.x-this._activePointers[1].clientX,t=bh.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t);s.set(0,n);const i=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),o=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);r.set(i,o)}if(this._state=0,e)if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else!this._lockedPointer&&(e.buttons&Hu)===Hu&&(this._state=this._state|this.mouseButtons.left),(e.buttons&Wu)===Wu&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&Yu)===Yu&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&Xu.ROTATE)===Xu.ROTATE||(this._state&Xu.TOUCH_ROTATE)===Xu.TOUCH_ROTATE||(this._state&Xu.TOUCH_DOLLY_ROTATE)===Xu.TOUCH_DOLLY_ROTATE||(this._state&Xu.TOUCH_ZOOM_ROTATE)===Xu.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Xu.TRUCK)===Xu.TRUCK||(this._state&Xu.SCREEN_PAN)===Xu.SCREEN_PAN||(this._state&Xu.TOUCH_TRUCK)===Xu.TOUCH_TRUCK||(this._state&Xu.TOUCH_SCREEN_PAN)===Xu.TOUCH_SCREEN_PAN||(this._state&Xu.TOUCH_DOLLY_TRUCK)===Xu.TOUCH_DOLLY_TRUCK||(this._state&Xu.TOUCH_DOLLY_SCREEN_PAN)===Xu.TOUCH_DOLLY_SCREEN_PAN||(this._state&Xu.TOUCH_ZOOM_TRUCK)===Xu.TOUCH_ZOOM_TRUCK||(this._state&Xu.TOUCH_ZOOM_SCREEN_PAN)===Xu.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Xu.DOLLY)===Xu.DOLLY||(this._state&Xu.TOUCH_DOLLY)===Xu.TOUCH_DOLLY||(this._state&Xu.TOUCH_DOLLY_TRUCK)===Xu.TOUCH_DOLLY_TRUCK||(this._state&Xu.TOUCH_DOLLY_SCREEN_PAN)===Xu.TOUCH_DOLLY_SCREEN_PAN||(this._state&Xu.TOUCH_DOLLY_OFFSET)===Xu.TOUCH_DOLLY_OFFSET||(this._state&Xu.TOUCH_DOLLY_ROTATE)===Xu.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Xu.ZOOM)===Xu.ZOOM||(this._state&Xu.TOUCH_ZOOM)===Xu.TOUCH_ZOOM||(this._state&Xu.TOUCH_ZOOM_TRUCK)===Xu.TOUCH_ZOOM_TRUCK||(this._state&Xu.TOUCH_ZOOM_SCREEN_PAN)===Xu.TOUCH_ZOOM_SCREEN_PAN||(this._state&Xu.TOUCH_ZOOM_OFFSET)===Xu.TOUCH_ZOOM_OFFSET||(this._state&Xu.TOUCH_ZOOM_ROTATE)===Xu.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Xu.OFFSET)===Xu.OFFSET||(this._state&Xu.TOUCH_OFFSET)===Xu.TOUCH_OFFSET||(this._state&Xu.TOUCH_DOLLY_OFFSET)===Xu.TOUCH_DOLLY_OFFSET||(this._state&Xu.TOUCH_ZOOM_OFFSET)===Xu.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},d=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,uh(this._activePointers,bh);const e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:r.x-bh.x,i=e?-e.deltaY:r.y-bh.y;if(r.copy(bh),((this._state&Xu.ROTATE)===Xu.ROTATE||(this._state&Xu.TOUCH_ROTATE)===Xu.TOUCH_ROTATE||(this._state&Xu.TOUCH_DOLLY_ROTATE)===Xu.TOUCH_DOLLY_ROTATE||(this._state&Xu.TOUCH_ZOOM_ROTATE)===Xu.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,i),this._isUserControllingRotate=!0),(this._state&Xu.DOLLY)===Xu.DOLLY||(this._state&Xu.ZOOM)===Xu.ZOOM){const e=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,r=this.dollyDragInverted?-1:1;(this._state&Xu.DOLLY)===Xu.DOLLY?(this._dollyInternal(r*i*mh,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(r*i*mh,e,t),this._isUserControllingZoom=!0)}if((this._state&Xu.TOUCH_DOLLY)===Xu.TOUCH_DOLLY||(this._state&Xu.TOUCH_ZOOM)===Xu.TOUCH_ZOOM||(this._state&Xu.TOUCH_DOLLY_TRUCK)===Xu.TOUCH_DOLLY_TRUCK||(this._state&Xu.TOUCH_ZOOM_TRUCK)===Xu.TOUCH_ZOOM_TRUCK||(this._state&Xu.TOUCH_DOLLY_SCREEN_PAN)===Xu.TOUCH_DOLLY_SCREEN_PAN||(this._state&Xu.TOUCH_ZOOM_SCREEN_PAN)===Xu.TOUCH_ZOOM_SCREEN_PAN||(this._state&Xu.TOUCH_DOLLY_OFFSET)===Xu.TOUCH_DOLLY_OFFSET||(this._state&Xu.TOUCH_ZOOM_OFFSET)===Xu.TOUCH_ZOOM_OFFSET||(this._state&Xu.TOUCH_DOLLY_ROTATE)===Xu.TOUCH_DOLLY_ROTATE||(this._state&Xu.TOUCH_ZOOM_ROTATE)===Xu.TOUCH_ZOOM_ROTATE){const e=bh.x-this._activePointers[1].clientX,t=bh.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t),i=s.y-n;s.set(0,n);const o=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Xu.TOUCH_DOLLY)===Xu.TOUCH_DOLLY||(this._state&Xu.TOUCH_DOLLY_ROTATE)===Xu.TOUCH_DOLLY_ROTATE||(this._state&Xu.TOUCH_DOLLY_TRUCK)===Xu.TOUCH_DOLLY_TRUCK||(this._state&Xu.TOUCH_DOLLY_SCREEN_PAN)===Xu.TOUCH_DOLLY_SCREEN_PAN||(this._state&Xu.TOUCH_DOLLY_OFFSET)===Xu.TOUCH_DOLLY_OFFSET?(this._dollyInternal(i*mh,o,a),this._isUserControllingDolly=!0):(this._zoomInternal(i*mh,o,a),this._isUserControllingZoom=!0)}((this._state&Xu.TRUCK)===Xu.TRUCK||(this._state&Xu.TOUCH_TRUCK)===Xu.TOUCH_TRUCK||(this._state&Xu.TOUCH_DOLLY_TRUCK)===Xu.TOUCH_DOLLY_TRUCK||(this._state&Xu.TOUCH_ZOOM_TRUCK)===Xu.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,i,!1,!1),this._isUserControllingTruck=!0),((this._state&Xu.SCREEN_PAN)===Xu.SCREEN_PAN||(this._state&Xu.TOUCH_SCREEN_PAN)===Xu.TOUCH_SCREEN_PAN||(this._state&Xu.TOUCH_DOLLY_SCREEN_PAN)===Xu.TOUCH_DOLLY_SCREEN_PAN||(this._state&Xu.TOUCH_ZOOM_SCREEN_PAN)===Xu.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(t,i,!1,!0),this._isUserControllingTruck=!0),((this._state&Xu.OFFSET)===Xu.OFFSET||(this._state&Xu.TOUCH_OFFSET)===Xu.TOUCH_OFFSET||(this._state&Xu.TOUCH_DOLLY_OFFSET)===Xu.TOUCH_DOLLY_OFFSET||(this._state&Xu.TOUCH_ZOOM_OFFSET)===Xu.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,i,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},p=()=>{uh(this._activePointers,bh),r.copy(bh),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",a),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",a),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",m),this._domElement.ownerDocument.addEventListener("pointerlockerror",f),this._domElement.ownerDocument.addEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",a),h())},this.unlockPointer=()=>{var e,t,n;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",m),null===(n=this._domElement)||void 0===n||n.ownerDocument.removeEventListener("pointerlockerror",f),this.cancel()};const m=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},f=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",i),this._domElement.addEventListener("pointercancel",a),this._domElement.addEventListener("wheel",c,{passive:!1}),this._domElement.addEventListener("contextmenu",u)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",i),this._domElement.removeEventListener("pointercancel",a),this._domElement.removeEventListener("wheel",c,{passive:!1}),this._domElement.removeEventListener("contextmenu",u),this._domElement.ownerDocument.removeEventListener("pointermove",o,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",a),this._domElement.ownerDocument.removeEventListener("pointerlockchange",m),this._domElement.ownerDocument.removeEventListener("pointerlockerror",f))},this.cancel=()=>{this._state!==Xu.NONE&&(this._state=Xu.NONE,this._activePointers.length=0,p())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=nh(e.width,0,1),this._interactiveArea.height=nh(e.height,0,1),this._interactiveArea.x=nh(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=nh(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const r=nh(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=nh(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const i=!n||sh(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&sh(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(i)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Gu,this._changedDolly=0,this._dollyToNoClamp(nh(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const t=this._collisionTest(),r=sh(t,this._spherical.radius);if(!(n>e)&&r)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||sh(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Eh).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||sh(this._target.x,this._targetEnd.x,this.restThreshold)&&sh(this._target.y,this._targetEnd.y,this.restThreshold)&&sh(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=nh(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||sh(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),Sh.setFromMatrixColumn(this._camera.matrix,0),Ah.setFromMatrixColumn(this._camera.matrix,1),Sh.multiplyScalar(e),Ah.multiplyScalar(-t);const r=_h.copy(Sh).add(Ah),s=wh.copy(this._targetEnd).add(r);return this.moveTo(s.x,s.y,s.z,n)}forward(e,t=!1){_h.setFromMatrixColumn(this._camera.matrix,0),_h.crossVectors(this._camera.up,_h),_h.multiplyScalar(e);const n=wh.copy(this._targetEnd).add(_h);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return _h.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+_h.x,this._targetEnd.y+_h.y,this._targetEnd.z+_h.z,t)}moveTo(e,t,n,r=!1){this._isUserControllingTruck=!1;const s=_h.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const i=!r||sh(this._target.x,this._targetEnd.x,this.restThreshold)&&sh(this._target.y,this._targetEnd.y,this.restThreshold)&&sh(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}lookInDirectionOf(e,t,n,r=!1){const s=_h.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(s.x,s.y,s.z,r)}fitToBox(e,t,{cover:n=!1,paddingLeft:r=0,paddingRight:s=0,paddingBottom:i=0,paddingTop:o=0}={}){const a=[],l=e.isBox3?Rh.copy(e):Rh.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=ih(this._sphericalEnd.theta,$u),u=ih(this._sphericalEnd.phi,$u);a.push(this.rotateTo(c,u,t));const h=_h.setFromSpherical(this._sphericalEnd).normalize(),d=kh.setFromUnitVectors(h,xh),p=sh(Math.abs(h.y),1);p&&d.multiply(Dh.setFromAxisAngle(vh,c)),d.multiply(this._yAxisUpSpaceInverse);const m=Ih.makeEmpty();wh.copy(l.min).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.min).setX(l.max.x).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.min).setY(l.max.y).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.max).setZ(l.min.z).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.min).setZ(l.max.z).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.max).setY(l.min.y).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.max).setX(l.min.x).applyQuaternion(d),m.expandByPoint(wh),wh.copy(l.max).applyQuaternion(d),m.expandByPoint(wh),m.min.x-=r,m.min.y-=i,m.max.x+=s,m.max.y+=o,d.setFromUnitVectors(xh,h),p&&d.premultiply(Dh.invert()),d.premultiply(this._yAxisUpSpace);const f=m.getSize(_h),g=m.getCenter(wh).applyQuaternion(d);if(Ku(this._camera)){const e=this.getDistanceToFitBox(f.x,f.y,f.z,n);a.push(this.moveTo(g.x,g.y,g.z,t)),a.push(this.dollyTo(e,t)),a.push(this.setFocalOffset(0,0,0,t))}else if(Qu(this._camera)){const e=this._camera,r=e.right-e.left,s=e.top-e.bottom,i=n?Math.max(r/f.x,s/f.y):Math.min(r/f.x,s/f.y);a.push(this.moveTo(g.x,g.y,g.z,t)),a.push(this.zoomTo(i,t)),a.push(this.setFocalOffset(0,0,0,t))}return Promise.all(a)}fitToSphere(e,t){const n=[],r="isObject3D"in e?Fh.createBoundingSphere(e,Lh):Lh.copy(e);if(n.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),Ku(this._camera)){const e=this.getDistanceToFitSphere(r.radius);n.push(this.dollyTo(e,t))}else if(Qu(this._camera)){const e=this._camera.right-this._camera.left,s=this._camera.top-this._camera.bottom,i=2*r.radius,o=Math.min(e/i,s/i);n.push(this.zoomTo(o,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,r,s,i,o=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Gu,this._changedDolly=0;const a=wh.set(r,s,i),l=_h.set(e,t,n);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(l.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const c=!o||sh(this._target.x,this._targetEnd.x,this.restThreshold)&&sh(this._target.y,this._targetEnd.y,this.restThreshold)&&sh(this._target.z,this._targetEnd.z,this.restThreshold)&&sh(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&sh(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&sh(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,n,r,s,i,o,a,l,c,u,h,d,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Gu,this._changedDolly=0;const m=_h.set(r,s,i),f=wh.set(e,t,n);Nh.setFromVector3(f.sub(m).applyQuaternion(this._yAxisUpSpace));const g=Th.set(c,u,h),y=wh.set(o,a,l);Ph.setFromVector3(y.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(m.lerp(g,d));const v=Ph.theta-Nh.theta,x=Ph.phi-Nh.phi,b=Ph.radius-Nh.radius;this._sphericalEnd.set(Nh.radius+b*d,Nh.phi+x*d,Nh.theta+v*d),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const _=!p||sh(this._target.x,this._targetEnd.x,this.restThreshold)&&sh(this._target.y,this._targetEnd.y,this.restThreshold)&&sh(this._target.z,this._targetEnd.z,this.restThreshold)&&sh(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&sh(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&sh(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(_)}setPosition(e,t,n,r=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n,r=!1){const s=this.getPosition(_h),i=this.setLookAt(s.x,s.y,s.z,e,t,n,r);return this._sphericalEnd.phi=nh(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),i}setFocalOffset(e,t,n,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const s=!r||sh(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&sh(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&sh(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),Sh.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Ah.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Mh.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=_h.set(e,t,n),s=r.distanceTo(this._camera.position),i=r.sub(this._camera.position);Sh.multiplyScalar(i.x),Ah.multiplyScalar(i.y),Mh.multiplyScalar(i.z),_h.copy(Sh).add(Ah).add(Mh),_h.z=_h.z+s,this.dollyTo(s,!1),this.setFocalOffset(-_h.x,_h.y,-_h.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){null!==e?(this._viewport=this._viewport||new gh.Vector4,"number"==typeof e?this._viewport.set(e,t,n,r):this._viewport.copy(e)):this._viewport=null}getDistanceToFitBox(e,t,n,r=!1){if(hh(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/t,i=this._camera.getEffectiveFOV()*th,o=this._camera.aspect;return.5*((r?s>o:s<o)?t:e/o)/Math.tan(.5*i)+.5*n}getDistanceToFitSphere(e){if(hh(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*th,n=2*Math.atan(Math.tan(.5*t)*this._camera.aspect),r=1<this._camera.aspect?t:n;return e/Math.sin(.5*r)}getTarget(e,t=!0){return(e&&e.isVector3?e:new gh.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new gh.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new gh.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new gh.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Ju,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Ju),this._spherical.theta+=Ju*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Ju)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!sh(this._camera.up.x,this._cameraUp0.x)||!sh(this._camera.up.y,this._cameraUp0.y)||!sh(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const e=this.getPosition(_h);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,vh),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=_h.subVectors(this._target,this._camera.position).normalize(),t=wh.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(_h);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,s=Oh.subVectors(this._targetEnd,this._target),i=Ch.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(rh(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=lh(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(rh(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=lh(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(rh(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=lh(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(rh(s.x)&&rh(s.y)&&rh(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;ch(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(rh(i.x)&&rh(i.y)&&rh(i.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;ch(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(rh(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=lh(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor)if(Ku(this._camera)&&0!==this._changedDolly){const e=this._spherical.radius-this._lastDistance,t=this._camera,n=this._getCameraDirection(Eh),r=_h.copy(n).cross(t.up).normalize();0===r.lengthSq()&&(r.x=1);const s=wh.crossVectors(r,n),i=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*th*.5),o=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=Th.copy(this._targetEnd).add(r.multiplyScalar(this._dollyControlCoord.x*i*t.aspect)).add(s.multiplyScalar(this._dollyControlCoord.y*i)),l=_h.copy(this._targetEnd).lerp(a,o),c=this._lastDollyDirection===qu&&this._spherical.radius<=this.minDistance,u=this._lastDollyDirection===Zu&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||u)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;const t=wh.copy(n).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);const h=wh.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedDolly-=e,rh(this._changedDolly)&&(this._changedDolly=0)}else if(Qu(this._camera)&&0!==this._changedZoom){const e=this._zoom-this._lastZoom,t=this._camera,n=_h.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),r=wh.set(0,0,-1).applyQuaternion(t.quaternion),s=Th.copy(n).add(r.multiplyScalar(-n.dot(t.up))),i=-(this._zoom-e-this._zoom)/this._zoom,o=this._getCameraDirection(Eh),a=this._targetEnd.dot(o),l=_h.copy(this._targetEnd).lerp(s,i),c=l.dot(o),u=o.multiplyScalar(c-a);l.sub(u),this._boundary.clampPoint(l,l);const h=wh.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedZoom-=e,rh(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!rh(this._focalOffset.x)||!rh(this._focalOffset.y)||!rh(this._focalOffset.z))&&(Sh.setFromMatrixColumn(this._camera.matrix,0),Ah.setFromMatrixColumn(this._camera.matrix,1),Mh.setFromMatrixColumn(this._camera.matrix,2),Sh.multiplyScalar(this._focalOffset.x),Ah.multiplyScalar(-this._focalOffset.y),Mh.multiplyScalar(this._focalOffset.z),_h.copy(Sh).add(Ah).add(Mh),this._camera.position.add(_h),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),_h.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),rh(t,this.restThreshold)&&rh(n,this.restThreshold)&&rh(r,this.restThreshold)&&rh(s.x,this.restThreshold)&&rh(s.y,this.restThreshold)&&rh(s.z,this.restThreshold)&&rh(i.x,this.restThreshold)&&rh(i.y,this.restThreshold)&&rh(i.z,this.restThreshold)&&rh(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:oh(this.maxDistance),minZoom:this.minZoom,maxZoom:oh(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:oh(this.maxPolarAngle),minAzimuthAngle:oh(this.minAzimuthAngle),maxAzimuthAngle:oh(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:_h.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=ah(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=ah(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=ah(n.maxPolarAngle),this.minAzimuthAngle=ah(n.minAzimuthAngle),this.maxAzimuthAngle=ah(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),Nh.setFromVector3(_h.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Nh.theta,Nh.phi,t),this.dollyTo(Nh.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){this._domElement?console.warn("camera-controls is already connected."):(e.setAttribute("data-camera-controls-version","2.10.1"),this._addAllEventListeners(e),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(0===r)return e;const s=wh.copy(t).add(e),i=this._boundary.clampPoint(s,Th).sub(s),o=i.lengthSq();if(0===o)return e.add(t);if(o===r)return e;if(0===n)return e.add(t).add(i);{const r=1+n*o/t.dot(i);return e.add(wh.copy(t).multiplyScalar(r)).add(i.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(Ku(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*th,r=Math.tan(.5*n)*t,s=r*e.aspect;this._nearPlaneCorners[0].set(-s,-r,0),this._nearPlaneCorners[1].set(s,-r,0),this._nearPlaneCorners[2].set(s,r,0),this._nearPlaneCorners[3].set(-s,r,0)}else if(Qu(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,s=e.top*t,i=e.bottom*t;this._nearPlaneCorners[0].set(n,s,0),this._nearPlaneCorners[1].set(r,s,0),this._nearPlaneCorners[2].set(r,i,0),this._nearPlaneCorners[3].set(n,i,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||hh(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(Eh);zh.lookAt(yh,t,this._camera.up);for(let n=0;n<4;n++){const r=wh.copy(this._nearPlaneCorners[n]);r.applyMatrix4(zh);const s=Th.addVectors(this._target,r);Uh.set(s,t),Uh.far=this._spherical.radius+1;const i=Uh.intersectObjects(this.colliderMeshes);0!==i.length&&i[0].distance<e&&(e=i[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{const t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new gh.Sphere){const n=t,r=n.center;Rh.makeEmpty(),e.traverseVisible(e=>{e.isMesh&&Rh.expandByObject(e)}),Rh.getCenter(r);let s=0;return e.traverseVisible(e=>{if(!e.isMesh)return;const t=e;if(!t.geometry)return;const n=t.geometry.clone();n.applyMatrix4(t.matrixWorld);const i=n.attributes.position;for(let o=0,a=i.count;o<a;o++)_h.fromBufferAttribute(i,o),s=Math.max(s,r.distanceToSquared(_h))}),n.radius=Math.sqrt(s),n}}const Bh=e=>!(!e||!e.isPerspectiveCamera),Vh=e=>!(!e||!e.isOrthographicCamera),jh=["min-polar-angle","max-polar-angle","min-azimuth-angle","max-azimuth-angle","distance","min-distance","max-distance","infinity-dolly","min-zoom","max-zoom","smooth-time","dragging-smooth-time","max-speed","azimuth-rotate-speed","polar-rotate-speed","dolly-speed","dolly-drag-inverted","truck-speed","dolly-to-cursor","drag-to-offset","vertical-drag-to-forward","boundary-friction","rest-threshold","collider-meshes","args","mouse-buttons","touches"],Hh=(e,t)=>({left:Fh.ACTION.ROTATE,middle:Fh.ACTION.DOLLY,right:Fh.ACTION.TRUCK,wheel:Bh(e)?Fh.ACTION.DOLLY:Vh(e)?Fh.ACTION.ZOOM:Fh.ACTION.NONE,...t}),Yh=(e,t)=>({one:Fh.ACTION.TOUCH_ROTATE,two:Bh(e)?Fh.ACTION.TOUCH_DOLLY_TRUCK:Vh(e)?Fh.ACTION.TOUCH_ZOOM_TRUCK:Fh.ACTION.NONE,three:Fh.ACTION.TOUCH_TRUCK,...t}),Wh=Tt({__name:"CameraControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},minPolarAngle:{default:0},maxPolarAngle:{default:Math.PI},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},distance:{default:()=>Ms().camera.value.position.z},minDistance:{default:Number.EPSILON},maxDistance:{default:Number.POSITIVE_INFINITY},infinityDolly:{type:Boolean,default:!1},minZoom:{default:.01},maxZoom:{default:Number.POSITIVE_INFINITY},smoothTime:{default:.25},draggingSmoothTime:{default:.125},maxSpeed:{default:Number.POSITIVE_INFINITY},azimuthRotateSpeed:{default:1},polarRotateSpeed:{default:1},dollySpeed:{default:1},dollyDragInverted:{type:Boolean,default:!1},truckSpeed:{default:2},dollyToCursor:{type:Boolean,default:!1},dragToOffset:{type:Boolean,default:!1},verticalDragToForward:{type:Boolean,default:!1},boundaryFriction:{default:0},restThreshold:{default:.01},colliderMeshes:{default:()=>[]},mouseButtons:{default:()=>Hh(Ms().camera.value)},touches:{default:()=>Yh(Ms().camera.value)}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,s=n,{makeDefault:i,minPolarAngle:o,maxPolarAngle:a,minAzimuthAngle:l,maxAzimuthAngle:c,distance:u,minDistance:h,maxDistance:d,infinityDolly:p,minZoom:m,maxZoom:f,smoothTime:g,draggingSmoothTime:y,maxSpeed:v,azimuthRotateSpeed:x,polarRotateSpeed:_,dollySpeed:w,dollyDragInverted:S,truckSpeed:A,dollyToCursor:M,dragToOffset:C,verticalDragToForward:N,boundaryFriction:P,restThreshold:I,colliderMeshes:D}=Xt(r),z={Box3:$,MathUtils:{clamp:R.clamp},Matrix4:E,Quaternion:k,Raycaster:L,Sphere:O,Spherical:J,Vector2:T,Vector3:b,Vector4:Q};Fh.install({THREE:z});const{camera:U,renderer:F,extend:B,controls:V,invalidate:j}=Ms();Ct(r,()=>{j()});const H=Yt(()=>Hh(r.camera||U.value,r.mouseButtons)),Y=Yt(()=>Yh(r.camera||U.value,r.touches)),W=At(null);B({CameraControls:Fh}),Ut(()=>{wl(W.value,"update",()=>{s("change",W.value),j()}),wl(W.value,"controlend",()=>s("end",W.value)),wl(W.value,"controlstart",()=>s("start",W.value)),W.value&&i.value?V.value=W.value:V.value=null});const{onBeforeRender:X}=Os();return X(({delta:e})=>{W.value?.enabled&&W.value?.update(e)}),Pt(()=>{W.value&&W.value.disconnect()}),t({instance:W}),(t,n)=>(e.camera||Lt(U))&&(e.domElement||Lt(F).domElement)?(Rt(),Mt("TresCameraControls",{key:0,ref_key:"controlsRef",ref:W,"min-polar-angle":Lt(o),"max-polar-angle":Lt(a),"min-azimuth-angle":Lt(l),"max-azimuth-angle":Lt(c),distance:Lt(u),"min-distance":Lt(h),"max-distance":Lt(d),"infinity-dolly":Lt(p),"min-zoom":Lt(m),"max-zoom":Lt(f),"smooth-time":Lt(g),"dragging-smooth-time":Lt(y),"max-speed":Lt(v),"azimuth-rotate-speed":Lt(x),"polar-rotate-speed":Lt(_),"dolly-speed":Lt(w),"dolly-drag-inverted":Lt(S),"truck-speed":Lt(A),"dolly-to-cursor":Lt(M),"drag-to-offset":Lt(C),"vertical-drag-to-forward":Lt(N),"boundary-friction":Lt(P),"rest-threshold":Lt(I),"collider-meshes":Lt(D),args:[e.camera||Lt(U),e.domElement||Lt(F).domElement],"mouse-buttons":H.value,touches:Y.value},null,8,jh)):Gt("",!0)}}),Xh=Tt({__name:"KeyboardControls",props:{makeDefault:{type:Boolean,default:!0},camera:{},domElement:{},moveSpeed:{default:.2},selector:{}},emits:["isLock","change"],setup(e,{expose:t,emit:n}){const r=e,s=n,{moveSpeed:i}=Xt(r),{camera:o,controls:a,renderer:l,invalidate:c}=Ms();Ct(r,()=>{c()});const u=St(0),h=St(0),{KeyW:d,KeyA:p,KeyS:m,KeyD:f,Up:g,Down:y,Left:v,Right:x}=function(e={}){const{reactive:t=!1,target:n=_l,aliasMap:r=Tl,passive:s=!0,onEventFired:i=vl}=e,o=jt(new Set),a={toJSON:()=>({}),current:o},l=t?jt(a):a,c=new Set,u=new Set,h=new Set;function d(e,n){e in l&&(t?l[e]=n:l[e].value=n)}function p(){o.clear();for(const e of h)d(e,!1)}function m(e,t){var n,r;const s=null==(n=e.key)?void 0:n.toLowerCase(),i=[null==(r=e.code)?void 0:r.toLowerCase(),s].filter(Boolean);s&&(t?o.add(s):o.delete(s));for(const o of i)h.add(o),d(o,t);if("shift"!==s||t)"function"==typeof e.getModifierState&&e.getModifierState("Shift")&&t&&[...o,...i].forEach(e=>u.add(e));else{const e=Array.from(u),t=e.indexOf("shift");e.forEach((e,n)=>{n>=t&&(o.delete(e),d(e,!1))}),u.clear()}"meta"!==s||t?"function"==typeof e.getModifierState&&e.getModifierState("Meta")&&t&&[...o,...i].forEach(e=>c.add(e)):(c.forEach(e=>{o.delete(e),d(e,!1)}),c.clear())}wl(n,"keydown",e=>(m(e,!0),i(e)),{passive:s}),wl(n,"keyup",e=>(m(e,!1),i(e)),{passive:s}),wl("blur",p,{passive:s}),wl("focus",p,{passive:s});const f=new Proxy(l,{get(e,n,s){if("string"!=typeof n)return Reflect.get(e,n,s);if((n=n.toLowerCase())in r&&(n=r[n]),!(n in l))if(/[+_-]/.test(n)){const e=n.split(/[+_-]/g).map(e=>e.trim());l[n]=Yt(()=>e.map(e=>Nt(f[e])).every(Boolean))}else l[n]=At(!1);const i=Reflect.get(e,n,s);return t?Nt(i):i}});return f}();Ut(()=>{p.value||v.value?u.value=-i.value:f.value||x.value?u.value=i.value:u.value=0,d.value||g.value?h.value=i.value:m.value||y.value?h.value=-i.value:h.value=0}),t({instance:a});const _=e=>s("isLock",e),w=e=>s("change",e),T=new b,E=new b,S=new k,{onBeforeRender:A}=Os();return A(({delta:e})=>{a.value instanceof pc&&a.value?.isLocked&&(((e,t)=>{if(!o.value?.position&&!T)return;const n=o.value,r=.001*e;n?.translateZ(-t),S.set(E.x*r,E.y*r,E.z*r,1).normalize(),n?.quaternion.multiply(S),(u.value||h.value)&&s("change",a.value)})(e,h.value),a.value.moveRight(u.value))}),(t,n)=>Lt(l)?(Rt(),rn(Lt(Jh),{key:0,selector:e.selector,"make-default":e.makeDefault,camera:e.camera||Lt(o),"dom-element":e.domElement||Lt(l).domElement,onIsLock:_,onChange:w},null,8,["selector","make-default","camera","dom-element"])):Gt("",!0)}}),Gh=["args","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","enable-zoom","zoom-speed","enable-rotate","rotate-speed"],qh=Tt({__name:"MapControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,{autoRotate:s,autoRotateSpeed:i,enableDamping:o,dampingFactor:a,enablePan:l,keyPanSpeed:c,maxAzimuthAngle:u,minAzimuthAngle:h,maxPolarAngle:d,minPolarAngle:p,minDistance:m,maxDistance:f,minZoom:g,maxZoom:y,enableZoom:v,zoomSpeed:x,enableRotate:b,rotateSpeed:_}=Xt(r),{camera:w,renderer:T,extend:E,controls:S,invalidate:A}=Ms();Ct(r,()=>{A()});const M=At(null);E({MapControls:_c}),Ct(S,e=>{e&&r.makeDefault?S.value=e:S.value=null});const{onBeforeRender:O}=Os();return O(()=>{M.value&&(o.value||s.value)&&M.value.update()}),Pt(()=>{M.value&&M.value.dispose()}),t({instance:M}),(t,n)=>(e.camera||Lt(w))&&(e.domElement||Lt(T).domElement)?(Rt(),Mt("TresMapControls",{key:0,ref_key:"controlsRef",ref:M,args:[e.camera||Lt(w),e.domElement||Lt(T).domElement],"auto-rotate":Lt(s),"auto-rotate-speed":Lt(i),"enable-damping":Lt(o),"damping-factor":Lt(a),"enable-pan":Lt(l),"key-pan-speed":Lt(c),keys:e.keys,"max-azimuth-angle":Lt(u),"min-azimuth-angle":Lt(h),"max-polar-angle":Lt(d),"min-polar-angle":Lt(p),"min-distance":Lt(m),"max-distance":Lt(f),"min-zoom":Lt(g),"max-zoom":Lt(y),"enable-zoom":Lt(v),"zoom-speed":Lt(x),"enable-rotate":Lt(b),"rotate-speed":Lt(_)},null,8,Gh)):Gt("",!0)}}),Zh=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","mouse-buttons","args"],Kh=Tt({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:z.ROTATE,TWO:z.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1},mouseButtons:{default:()=>({LEFT:D.ROTATE,MIDDLE:D.DOLLY,RIGHT:D.PAN})}},emits:["change","start","end"],setup(e,{expose:t,emit:n}){const r=e,s=n,{makeDefault:i,autoRotate:o,autoRotateSpeed:a,enableDamping:l,dampingFactor:c,enablePan:u,keyPanSpeed:h,maxAzimuthAngle:d,minAzimuthAngle:p,maxPolarAngle:m,minPolarAngle:f,minDistance:g,maxDistance:y,minZoom:v,maxZoom:x,enableZoom:b,zoomSpeed:_,enableRotate:w,touches:T,rotateSpeed:E,target:S,mouseButtons:A}=Xt(r),{camera:M,renderer:O,extend:C,controls:N,invalidate:P}=Ms(),R=At(null);C({OrbitControls:bc}),Ct(R,e=>{wl(R.value,"change",()=>{s("change",R.value),P()}),wl(R.value,"start",()=>s("start",R.value)),wl(R.value,"end",()=>s("end",R.value)),e&&i.value?N.value=e:N.value=null});const{onBeforeRender:I}=Os();return I(()=>{R.value&&(l.value||o.value)&&(R.value.update(),o.value)}),Pt(()=>{R.value&&R.value.dispose()}),t({instance:R}),(t,n)=>(e.camera||Lt(M))&&(e.domElement||Lt(O).domElement)?(Rt(),Mt("TresOrbitControls",{ref_key:"controlsRef",ref:R,key:(e.camera||Lt(M))?.uuid,target:Lt(S),"auto-rotate":Lt(o),"auto-rotate-speed":Lt(a),"enable-damping":Lt(l),"damping-factor":Lt(c),"enable-pan":Lt(u),"key-pan-speed":Lt(h),keys:e.keys,"max-azimuth-angle":Lt(d),"min-azimuth-angle":Lt(p),"max-polar-angle":Lt(m),"min-polar-angle":Lt(f),"min-distance":Lt(g),"max-distance":Lt(y),"min-zoom":Lt(v),"max-zoom":Lt(x),touches:Lt(T),"enable-zoom":Lt(b),"zoom-speed":Lt(_),"enable-rotate":Lt(w),"rotate-speed":Lt(E),"mouse-buttons":Lt(A),args:[e.camera||Lt(M),e.domElement||Lt(O).domElement]},null,8,Zh)):Gt("",!0)}}),Qh=["args"],Jh=Tt({__name:"PointerLockControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},selector:{}},emits:["isLock","change"],setup(e,{expose:t,emit:n}){const r=e,s=n,{camera:i,renderer:o,extend:a,controls:l,invalidate:c}=Ms();Ct(r,()=>{c()});const u=At(null);let h;a({PointerLockControls:pc});const d=e=>{s("isLock",e)};return Ct(u,e=>{e&&r.makeDefault?l.value=e:l.value=null,h=document.getElementById(r.selector||"")||o.domElement,wl(h,"click",()=>{u.value&&(u.value.lock(),u.value.addEventListener("lock",()=>d(!0)),u.value.addEventListener("unlock",()=>d(!1)),c())})}),Pt(()=>{const e=u.value;e&&(e.removeEventListener("lock",()=>d(!0)),e.removeEventListener("unlock",()=>d(!1)),e.dispose())}),t({instance:l}),(t,n)=>(e.camera||Lt(i))&&(e.domElement||Lt(o).domElement)?(Rt(),Mt("TresPointerLockControls",{key:0,ref_key:"controlsRef",ref:u,args:[e.camera||Lt(i),e.domElement||Lt(o).domElement]},null,8,Qh)):Gt("",!0)}}),$h=["object","args","mode","enabled","axis","translation-snap","rotation-snap","scale-snap","space","size","show-x","show-y","show-z"],ed=Tt({__name:"TransformControls",props:{object:{},camera:{},mode:{default:"translate"},enabled:{type:Boolean,default:!0},axis:{default:"XYZ"},translationSnap:{},rotationSnap:{},scaleSnap:{},space:{default:"world"},size:{default:1},showX:{type:Boolean,default:!0},showY:{type:Boolean,default:!0},showZ:{type:Boolean,default:!0}},emits:["dragging","change","mouseDown","mouseUp","objectChange"],setup(e,{expose:t,emit:n}){const r=e,s=n,{object:i,mode:o,enabled:a,axis:l,translationSnap:c,rotationSnap:u,scaleSnap:h,space:d,size:p,showX:m,showY:f,showZ:g}=Xt(r),y=At(null),{controls:v,camera:x,renderer:b,extend:_,invalidate:w}=Ms();Ct([i,o,a,l,c,u,h,d,p,m,f,g],()=>{w()}),_({TransformControls:nc});const T=()=>{w(),s("change")},E=e=>{v.value&&(v.value.enabled=!e.value),w(),s("dragging",e.value)},S=()=>{w(),s("mouseDown")},A=()=>{w(),s("mouseUp")},M=()=>{w(),s("objectChange")};return Ct(y,e=>{e&&(wl(y.value,"change",T),wl(y.value,"dragging-changed",E),wl(y.value,"mouseDown",S),wl(y.value,"mouseUp",A),wl(y.value,"objectChange",M))}),Pt(()=>{y.value&&y.value.dispose()}),t({instance:y}),(t,n)=>(e.camera||Lt(x))&&Lt(b).domElement?(Rt(),Mt("TresTransformControls",{ref_key:"controlsRef",ref:y,key:(e.camera||Lt(x))?.uuid,object:Lt(i),args:[e.camera||Lt(x),Lt(b).domElement],mode:Lt(o),enabled:Lt(a),axis:Lt(l),"translation-snap":Lt(c),"rotation-snap":Lt(u),"scale-snap":Lt(h),space:Lt(d),size:Lt(p),"show-x":Lt(m),"show-y":Lt(f),"show-z":Lt(g),visible:!0},null,8,$h)):Gt("",!0)}});function td(e,t={}){const{skipStrokes:n=!1,skipFills:r=!1,fillMaterial:s={},strokeMaterial:i={},depth:o="renderOrder"}=t,a=Yt(()=>{const t="string"==typeof e?e:e.value;return t.startsWith("<svg")?encodeURI(`data:image/svg+xml;utf8,${t}`):t}),l=Ir(Ru,a,{}),c=Yt(()=>{if(!l.state.value?.paths)return[];const e=[],t=l.state.value.paths,[a,c]="number"==typeof o?[!0,o]:[{flat:!1,renderOrder:!1,offsetZ:!0}[o],{flat:0,renderOrder:0,offsetZ:.025}[o]];let u=0;for(const o of t){const t=o.userData?.style??{};if(!r&&void 0!==t.fill&&"none"!==t.fill){const n={color:t.fill,opacity:t.fillOpacity,transparent:!0,side:N,depthWrite:a,...s};for(const t of Ru.createShapes(o)){const r=new ee(t);r.scale(1,-1,1),c&&r.translate(0,0,u*c),e.push({geometry:r,material:n,isStroke:!1}),u++}}if(!n&&void 0!==t.stroke&&"none"!==t.stroke){const n={color:t.stroke,opacity:t.strokeOpacity,transparent:!0,side:N,depthWrite:a,...i};for(const r of o.subPaths){const s=r.getPoints().map(e=>new T(e.x,-e.y)),i=Ru.pointsToStroke(s,t);c&&i.translate(0,0,u*c),e.push({geometry:i,material:n,isStroke:!0}),u++}}}return e});return{...l,layers:c,dispose:()=>{c.value.forEach(e=>e.geometry.dispose())}}}function nd(e,t){const n={};if(t?.draco){const e=new Lu;e.setDecoderPath(t.decoderPath||"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),n.extensions=t=>{t instanceof Sc&&t.setDRACOLoader(e)}}const r=Ir(Sc,e,n);t?.traverse&&Ct(r.state,e=>{e.scene.traverse(e=>t.traverse?.(e))});const s=Yt(()=>r.state.value?.scene?Lr(r.state.value?.scene).nodes:{}),i=Yt(()=>r.state.value?.scene?Lr(r.state.value?.scene).materials:{});return{...r,nodes:s,materials:i}}const rd=["object"],sd=Tt({__name:"component",props:{path:{},draco:{type:Boolean,default:!1},castShadow:{type:Boolean,default:!1},receiveShadow:{type:Boolean,default:!1},decoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.4.1/"}},setup(e,{expose:t}){const n=e,{state:r,isLoading:s}=nd(n.path,{draco:n.draco,decoderPath:n.decoderPath});return t({instance:r}),Ut(()=>{r.value?.scene&&(n.castShadow||n.receiveShadow)&&r.value.scene.traverse(e=>{e instanceof p&&(e.castShadow=n.castShadow,e.receiveShadow=n.receiveShadow)})}),(e,t)=>!Lt(s)&&Lt(r)?.scene?(Rt(),Mt("primitive",Kt({key:0,object:Lt(r)?.scene},e.$attrs),null,16,rd)):Gt("",!0)}}),id=Tt({__name:"component",props:{path:{},manager:{}},emits:["loaded","error"],setup(e,{emit:t}){const n=e,r=t,{state:s,isLoading:i,error:o}=Sl(n.path);return bl(o,e=>{e&&r("error",e)}),bl(s,e=>{e&&r("loaded",e)}),(e,t)=>Zt(e.$slots,"default",{state:Lt(s),isLoading:Lt(i),error:Lt(o)})}});let od=0;function ad(){const e=St(!1),t=St(0),n=St([]);return new Promise(r=>{te.onStart=()=>{e.value=!1},te.onLoad=()=>{e.value=!0},te.onProgress=(r,s,i)=>{s===i&&(od=i,e.value=!0,n.value.push(r)),t.value=Math.round((s-od)/(i-od)*100||100)},te.onError=t=>{wr("Error loading assets",new Error(t)),e.value=!0},r({items:n,hasFinishLoading:e,progress:t})})}async function ld(e,t){if(!e)return wr("Error no path provided");const{unsuspend:n,start:r,crossOrigin:s,muted:i,loop:o,...a}={unsuspend:"loadedmetadata",crossOrigin:"Anonymous",muted:!0,loop:!0,start:!0,playsInline:!0,...t};try{const t=await new Promise((t,r)=>{const l=Object.assign(document.createElement("video"),{src:"string"==typeof e&&e||void 0,crossOrigin:s,loop:o,muted:i,autoplay:!0,...a}),c=new le(l);return l.addEventListener(n,()=>t(c)),l.addEventListener("error",()=>r(new Error("Error loading video"))),c});return r&&t.image&&t.image.play(),t}catch{wr("Error loading resource")}}function cd(e){const t=St(null),n=Lt(e).map(e=>{try{return Ir(F,e,{initialValue:new U})}catch(n){return t.value=n,St(null)}});return{textures:Yt(()=>n.map(e=>e&&"state"in e?e.state.value:null).filter(Boolean)),isLoading:Yt(()=>n.some(e=>!(!e||!("isLoading"in e))&&e.isLoading.value)),error:Yt(()=>{const e=[];return n.forEach(t=>{if(t&&"error"in t&&t.error){const n=t.error;n instanceof Error?e.push(n):"object"==typeof n&&null!==n&&"message"in n&&e.push(new Error(String(n.message)))}}),t.value&&e.push(t.value),e.length>0?e:null})}}function ud(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function hd(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dd,pd={exports:{}};var md=(dd||(dd=1,pd.exports=function e(t,n,r){function s(o,a){if(!n[o]){if(!t[o]){if(!a&&hd)return hd(o);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}a=n[o]={exports:{}},t[o][0].call(a.exports,function(e){return s(t[o][1][e]||e)},a,a.exports,e,t,n,r)}return n[o].exports}for(var i=hd,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,n){(function(r,s,i,o,a,l,c,u,h){var d=e("crypto");function p(e,t){var n;return void 0===(n="passthrough"!==(t=g(e,t)).algorithm?d.createHash(t.algorithm):new x).write&&(n.write=n.update,n.end=n.update),v(t,n).dispatch(e),n.update||n.end(""),n.digest?n.digest("buffer"===t.encoding?void 0:t.encoding):(e=n.read(),"buffer"!==t.encoding?e.toString(t.encoding):e)}(n=t.exports=p).sha1=function(e){return p(e)},n.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},n.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},n.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=d.getHashes?d.getHashes().slice():["sha1","md5"],f=(m.push("passthrough"),["buffer","hex","binary","base64"]);function g(e,t){var n={};if(n.algorithm=(t=t||{}).algorithm||"sha1",n.encoding=t.encoding||"hex",n.excludeValues=!!t.excludeValues,n.algorithm=n.algorithm.toLowerCase(),n.encoding=n.encoding.toLowerCase(),n.ignoreUnknown=!0===t.ignoreUnknown,n.respectType=!1!==t.respectType,n.respectFunctionNames=!1!==t.respectFunctionNames,n.respectFunctionProperties=!1!==t.respectFunctionProperties,n.unorderedArrays=!0===t.unorderedArrays,n.unorderedSets=!1!==t.unorderedSets,n.unorderedObjects=!1!==t.unorderedObjects,n.replacer=t.replacer||void 0,n.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var r=0;r<m.length;++r)m[r].toLowerCase()===n.algorithm.toLowerCase()&&(n.algorithm=m[r]);if(-1===m.indexOf(n.algorithm))throw new Error('Algorithm "'+n.algorithm+'"  not supported. supported values: '+m.join(", "));if(-1===f.indexOf(n.encoding)&&"passthrough"!==n.algorithm)throw new Error('Encoding "'+n.encoding+'"  not supported. supported values: '+f.join(", "));return n}function y(e){if("function"==typeof e)return null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function v(e,t,n){function r(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")}return n=n||[],{dispatch:function(t){return this["_"+(null===(t=e.replacer?e.replacer(t):t)?"null":typeof t)](t)},_object:function(t){var s,o=Object.prototype.toString.call(t),a=/\[object (.*)\]/i.exec(o);if(a=(a=a?a[1]:"unknown:["+o+"]").toLowerCase(),0<=(o=n.indexOf(t)))return this.dispatch("[CIRCULAR:"+o+"]");if(n.push(t),void 0!==i&&i.isBuffer&&i.isBuffer(t))return r("buffer:"),r(t);if("object"===a||"function"===a||"asyncfunction"===a)return o=Object.keys(t),e.unorderedObjects&&(o=o.sort()),!1===e.respectType||y(t)||o.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(o=o.filter(function(t){return!e.excludeKeys(t)})),r("object:"+o.length+":"),s=this,o.forEach(function(n){s.dispatch(n),r(":"),e.excludeValues||s.dispatch(t[n]),r(",")});if(!this["_"+a]){if(e.ignoreUnknown)return r("["+a+"]");throw new Error('Unknown object type "'+a+'"')}this["_"+a](t)},_array:function(t,s){s=void 0!==s?s:!1!==e.unorderedArrays;var i=this;if(r("array:"+t.length+":"),!s||t.length<=1)return t.forEach(function(e){return i.dispatch(e)});var o=[];return s=t.map(function(t){var r=new x,s=n.slice();return v(e,r,s).dispatch(t),o=o.concat(s.slice(n.length)),r.read().toString()}),n=n.concat(o),s.sort(),this._array(s,!1)},_date:function(e){return r("date:"+e.toJSON())},_symbol:function(e){return r("symbol:"+e.toString())},_error:function(e){return r("error:"+e.toString())},_boolean:function(e){return r("bool:"+e.toString())},_string:function(e){r("string:"+e.length+":"),r(e.toString())},_function:function(t){r("fn:"),y(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return r("number:"+e.toString())},_xml:function(e){return r("xml:"+e.toString())},_null:function(){return r("Null")},_undefined:function(){return r("Undefined")},_regexp:function(e){return r("regex:"+e.toString())},_uint8array:function(e){return r("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return r("int8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return r("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return r("int16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return r("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return r("int32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return r("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return r("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return r("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return r("url:"+e.toString())},_map:function(t){return r("map:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_set:function(t){return r("set:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_file:function(e){return r("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(e.ignoreUnknown)return r("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return r("domwindow")},_bigint:function(e){return r("bigint:"+e.toString())},_process:function(){return r("process")},_timer:function(){return r("timer")},_pipe:function(){return r("pipe")},_tcp:function(){return r("tcp")},_udp:function(){return r("udp")},_tty:function(){return r("tty")},_statwatcher:function(){return r("statwatcher")},_securecontext:function(){return r("securecontext")},_connection:function(){return r("connection")},_zlib:function(){return r("zlib")},_context:function(){return r("context")},_nodescript:function(){return r("nodescript")},_httpparser:function(){return r("httpparser")},_dataview:function(){return r("dataview")},_signal:function(){return r("signal")},_fsevent:function(){return r("fsevent")},_tlswrap:function(){return r("tlswrap")}}}function x(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}n.writeToStream=function(e,t,n){return void 0===n&&(n=t,t={}),v(t=g(e,t),n).dispatch(e)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,t,n){(function(e,t,r,s,i,o,a,l,c){!function(e){var t=typeof Uint8Array<"u"?Uint8Array:Array,n=43,r=47,s=48,i=97,o=65,a=45,l=95;function c(e){return(e=e.charCodeAt(0))===n||e===a?62:e===r||e===l?63:e<s?-1:e<s+10?e-s+26+26:e<o+26?e-o:e<i+26?e-i+26:void 0}e.toByteArray=function(e){var n,r;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var s=e.length,i=(s="="===e.charAt(s-2)?2:"="===e.charAt(s-1)?1:0,new t(3*e.length/4-s)),o=0<s?e.length-4:e.length,a=0;function l(e){i[a++]=e}for(n=0;n<o;n+=4,0)l((16711680&(r=c(e.charAt(n))<<18|c(e.charAt(n+1))<<12|c(e.charAt(n+2))<<6|c(e.charAt(n+3))))>>16),l((65280&r)>>8),l(255&r);return 2==s?l(255&(r=c(e.charAt(n))<<2|c(e.charAt(n+1))>>4)):1==s&&(l((r=c(e.charAt(n))<<10|c(e.charAt(n+1))<<4|c(e.charAt(n+2))>>2)>>8&255),l(255&r)),i},e.fromByteArray=function(e){var t,n,r,s,i=e.length%3,o="";function a(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,r=e.length-i;t<r;t+=3)o+=a((s=n=(e[t]<<16)+(e[t+1]<<8)+e[t+2])>>18&63)+a(s>>12&63)+a(s>>6&63)+a(63&s);switch(i){case 1:o=(o+=a((n=e[e.length-1])>>2))+a(n<<4&63)+"==";break;case 2:o=(o=(o+=a((n=(e[e.length-2]<<8)+e[e.length-1])>>10))+a(n>>4&63))+a(n<<2&63)+"="}return o}}(void 0===n?this.base64js={}:n)}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,t,n){(function(t,r,s,i,o,a,l,c,u){var h=e("base64-js"),d=e("ieee754");function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);var r,i,o,a,l=typeof e;if("base64"===t&&"string"==l)for(e=(a=e).trim?a.trim():a.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if("number"==l)r=N(e);else if("string"==l)r=s.byteLength(e,t);else{if("object"!=l)throw new Error("First argument needs to be a number, array or string.");r=N(e.length)}if(s._useTypedArrays?i=s._augment(new Uint8Array(r)):((i=this).length=r,i._isBuffer=!0),s._useTypedArrays&&"number"==typeof e.byteLength)i._set(e);else if(P(a=e)||s.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length)for(o=0;o<r;o++)s.isBuffer(e)?i[o]=e.readUInt8(o):i[o]=e[o];else if("string"==l)i.write(e,0,t);else if("number"==l&&!s._useTypedArrays&&!n)for(o=0;o<r;o++)i[o]=0;return i}function p(e,t,n,r){return s._charsWritten=k(function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function m(e,t,n,r){return s._charsWritten=k(function(e){for(var t,n,r=[],s=0;s<e.length;s++)t=(n=e.charCodeAt(s))>>8,n%=256,r.push(n),r.push(t);return r}(t),e,n,r)}function f(e,t,n){var r="";n=Math.min(e.length,n);for(var s=t;s<n;s++)r+=String.fromCharCode(e[s]);return r}function g(e,t,n,r){var s;if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!((r=e.length)<=t))return n?(s=e[t],t+1<r&&(s|=e[t+1]<<8)):(s=e[t]<<8,t+1<r&&(s|=e[t+1])),s}function y(e,t,n,r){var s;if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!((r=e.length)<=t))return n?(t+2<r&&(s=e[t+2]<<16),t+1<r&&(s|=e[t+1]<<8),s|=e[t],t+3<r&&(s+=e[t+3]<<24>>>0)):(t+1<r&&(s=e[t+1]<<16),t+2<r&&(s|=e[t+2]<<8),t+3<r&&(s|=e[t+3]),s+=e[t]<<24>>>0),s}function v(e,t,n,r){if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+1<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 32768&(r=g(e,t,n,!0))?-1*(65535-r+1):r}function x(e,t,n,r){if(r||(B("boolean"==typeof n,"missing or invalid endian"),B(null!=t,"missing offset"),B(t+3<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 2147483648&(r=y(e,t,n,!0))?-1*(4294967295-r+1):r}function b(e,t,n,r){return r||(B("boolean"==typeof n,"missing or invalid endian"),B(t+3<e.length,"Trying to read beyond buffer length")),d.read(e,t,n,23,4)}function _(e,t,n,r){return r||(B("boolean"==typeof n,"missing or invalid endian"),B(t+7<e.length,"Trying to read beyond buffer length")),d.read(e,t,n,52,8)}function w(e,t,n,r,s){if(s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+1<e.length,"trying to write beyond buffer length"),z(t,65535)),!((s=e.length)<=n))for(var i=0,o=Math.min(s-n,2);i<o;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function T(e,t,n,r,s){if(s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"trying to write beyond buffer length"),z(t,4294967295)),!((s=e.length)<=n))for(var i=0,o=Math.min(s-n,4);i<o;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function E(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+1<e.length,"Trying to write beyond buffer length"),U(t,32767,-32768)),e.length<=n||w(e,0<=t?t:65535+t+1,n,r,s)}function S(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"Trying to write beyond buffer length"),U(t,2147483647,-2147483648)),e.length<=n||T(e,0<=t?t:4294967295+t+1,n,r,s)}function A(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+3<e.length,"Trying to write beyond buffer length"),F(t,34028234663852886e22,-34028234663852886e22)),e.length<=n||d.write(e,t,n,r,23,4)}function M(e,t,n,r,s){s||(B(null!=t,"missing value"),B("boolean"==typeof r,"missing or invalid endian"),B(null!=n,"missing offset"),B(n+7<e.length,"Trying to write beyond buffer length"),F(t,17976931348623157e292,-17976931348623157e292)),e.length<=n||d.write(e,t,n,r,52,8)}n.Buffer=s,n.SlowBuffer=s,n.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch{return!1}}(),s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=I(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=L(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},s.concat=function(e,t){if(B(P(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new s(0);if(1===e.length)return e[0];if("number"!=typeof t)for(i=t=0;i<e.length;i++)t+=e[i].length;for(var n=new s(t),r=0,i=0;i<e.length;i++){var o=e[i];o.copy(n,r),r+=o.length}return n},s.prototype.write=function(e,t,n,r){isFinite(t)?isFinite(n)||(r=n,n=void 0):(c=r,r=t,t=n,n=c),t=Number(t)||0;var i,o,a,l,c=this.length-t;switch((!n||c<(n=Number(n)))&&(n=c),r=String(r||"utf8").toLowerCase()){case"hex":i=function(e,t,n,r){n=Number(n)||0;var i=e.length-n;(!r||i<(r=Number(r)))&&(r=i),B((i=t.length)%2==0,"Invalid hex string"),i/2<r&&(r=i/2);for(var o=0;o<r;o++){var a=parseInt(t.substr(2*o,2),16);B(!isNaN(a),"Invalid hex string"),e[n+o]=a}return s._charsWritten=2*o,o}(this,e,t,n);break;case"utf8":case"utf-8":o=this,a=t,l=n,i=s._charsWritten=k(I(e),o,a,l);break;case"ascii":case"binary":i=p(this,e,t,n);break;case"base64":o=this,a=t,l=n,i=s._charsWritten=k(L(e),o,a,l);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=m(this,e,t,n);break;default:throw new Error("Unknown encoding")}return i},s.prototype.toString=function(e,t,n){var r,s,i,o,a=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(n=void 0!==n?Number(n):a.length)===t)return"";switch(e){case"hex":r=function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var s="",i=t;i<n;i++)s+=R(e[i]);return s}(a,t,n);break;case"utf8":case"utf-8":r=function(e,t,n){var r="",s="";n=Math.min(e.length,n);for(var i=t;i<n;i++)e[i]<=127?(r+=D(s)+String.fromCharCode(e[i]),s=""):s+="%"+e[i].toString(16);return r+D(s)}(a,t,n);break;case"ascii":case"binary":r=f(a,t,n);break;case"base64":s=a,o=n,r=0===(i=t)&&o===s.length?h.fromByteArray(s):h.fromByteArray(s.slice(i,o));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=function(e,t,n){for(var r=e.slice(t,n),s="",i=0;i<r.length;i+=2)s+=String.fromCharCode(r[i]+256*r[i+1]);return s}(a,t,n);break;default:throw new Error("Unknown encoding")}return r},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(e,t,n,r){if(t=t||0,(r=r||0===r?r:this.length)!==(n=n||0)&&0!==e.length&&0!==this.length){B(n<=r,"sourceEnd < sourceStart"),B(0<=t&&t<e.length,"targetStart out of bounds"),B(0<=n&&n<this.length,"sourceStart out of bounds"),B(0<=r&&r<=this.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length);var i=(r=e.length-t<r-n?e.length-t+n:r)-n;if(i<100||!s._useTypedArrays)for(var o=0;o<i;o++)e[o+t]=this[o+n];else e._set(this.subarray(n,n+i),t)}},s.prototype.slice=function(e,t){var n=this.length;if(e=C(e,n,0),t=C(t,n,n),s._useTypedArrays)return s._augment(this.subarray(e,t));for(var r=t-e,i=new s(r,void 0,!0),o=0;o<r;o++)i[o]=this[o+e];return i},s.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},s.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},s.prototype.readUInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},s.prototype.readUInt16LE=function(e,t){return g(this,e,!0,t)},s.prototype.readUInt16BE=function(e,t){return g(this,e,!1,t)},s.prototype.readUInt32LE=function(e,t){return y(this,e,!0,t)},s.prototype.readUInt32BE=function(e,t){return y(this,e,!1,t)},s.prototype.readInt8=function(e,t){if(t||(B(null!=e,"missing offset"),B(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){return v(this,e,!0,t)},s.prototype.readInt16BE=function(e,t){return v(this,e,!1,t)},s.prototype.readInt32LE=function(e,t){return x(this,e,!0,t)},s.prototype.readInt32BE=function(e,t){return x(this,e,!1,t)},s.prototype.readFloatLE=function(e,t){return b(this,e,!0,t)},s.prototype.readFloatBE=function(e,t){return b(this,e,!1,t)},s.prototype.readDoubleLE=function(e,t){return _(this,e,!0,t)},s.prototype.readDoubleBE=function(e,t){return _(this,e,!1,t)},s.prototype.writeUInt8=function(e,t,n){n||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"trying to write beyond buffer length"),z(e,255)),t>=this.length||(this[t]=e)},s.prototype.writeUInt16LE=function(e,t,n){w(this,e,t,!0,n)},s.prototype.writeUInt16BE=function(e,t,n){w(this,e,t,!1,n)},s.prototype.writeUInt32LE=function(e,t,n){T(this,e,t,!0,n)},s.prototype.writeUInt32BE=function(e,t,n){T(this,e,t,!1,n)},s.prototype.writeInt8=function(e,t,n){n||(B(null!=e,"missing value"),B(null!=t,"missing offset"),B(t<this.length,"Trying to write beyond buffer length"),U(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},s.prototype.writeInt16LE=function(e,t,n){E(this,e,t,!0,n)},s.prototype.writeInt16BE=function(e,t,n){E(this,e,t,!1,n)},s.prototype.writeInt32LE=function(e,t,n){S(this,e,t,!0,n)},s.prototype.writeInt32BE=function(e,t,n){S(this,e,t,!1,n)},s.prototype.writeFloatLE=function(e,t,n){A(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){A(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){M(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){M(this,e,t,!1,n)},s.prototype.fill=function(e,t,n){if(t=t||0,n=n||this.length,B("number"==typeof(e="string"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),"value is not a number"),B(t<=n,"end < start"),n!==t&&0!==this.length){B(0<=t&&t<this.length,"start out of bounds"),B(0<=n&&n<=this.length,"end out of bounds");for(var r=t;r<n;r++)this[r]=e}},s.prototype.inspect=function(){for(var e=[],t=this.length,r=0;r<t;r++)if(e[r]=R(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer};var O=s.prototype;function C(e,t,n){return"number"!=typeof e?n:t<=(e=~~e)?t:0<=e||0<=(e+=t)?e:0}function N(e){return(e=~~Math.ceil(+e))<0?0:e}function P(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function R(e){return e<16?"0"+e.toString(16):e.toString(16)}function I(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else for(var s=n,i=(55296<=r&&r<=57343&&n++,encodeURIComponent(e.slice(s,n+1)).substr(1).split("%")),o=0;o<i.length;o++)t.push(parseInt(i[o],16))}return t}function L(e){return h.toByteArray(e)}function k(e,t,n,r){for(var s=0;s<r&&!(s+n>=t.length||s>=e.length);s++)t[s+n]=e[s];return s}function D(e){try{return decodeURIComponent(e)}catch{return"�"}}function z(e,t){B("number"==typeof e,"cannot write a non-number as a number"),B(0<=e,"specified a negative value for writing an unsigned value"),B(e<=t,"value is larger than maximum value for type"),B(Math.floor(e)===e,"value has a fractional component")}function U(e,t,n){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(n<=e,"value smaller than minimum allowed value"),B(Math.floor(e)===e,"value has a fractional component")}function F(e,t,n){B("number"==typeof e,"cannot write a non-number as a number"),B(e<=t,"value larger than maximum allowed value"),B(n<=e,"value smaller than minimum allowed value")}function B(e,t){if(!e)throw new Error(t||"Failed assertion")}s._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=O.get,e.set=O.set,e.write=O.write,e.toString=O.toString,e.toLocaleString=O.toString,e.toJSON=O.toJSON,e.copy=O.copy,e.slice=O.slice,e.readUInt8=O.readUInt8,e.readUInt16LE=O.readUInt16LE,e.readUInt16BE=O.readUInt16BE,e.readUInt32LE=O.readUInt32LE,e.readUInt32BE=O.readUInt32BE,e.readInt8=O.readInt8,e.readInt16LE=O.readInt16LE,e.readInt16BE=O.readInt16BE,e.readInt32LE=O.readInt32LE,e.readInt32BE=O.readInt32BE,e.readFloatLE=O.readFloatLE,e.readFloatBE=O.readFloatBE,e.readDoubleLE=O.readDoubleLE,e.readDoubleBE=O.readDoubleBE,e.writeUInt8=O.writeUInt8,e.writeUInt16LE=O.writeUInt16LE,e.writeUInt16BE=O.writeUInt16BE,e.writeUInt32LE=O.writeUInt32LE,e.writeUInt32BE=O.writeUInt32BE,e.writeInt8=O.writeInt8,e.writeInt16LE=O.writeInt16LE,e.writeInt16BE=O.writeInt16BE,e.writeInt32LE=O.writeInt32LE,e.writeInt32BE=O.writeInt32BE,e.writeFloatLE=O.writeFloatLE,e.writeFloatBE=O.writeFloatBE,e.writeDoubleLE=O.writeDoubleLE,e.writeDoubleBE=O.writeDoubleBE,e.fill=O.fill,e.inspect=O.inspect,e.toArrayBuffer=O.toArrayBuffer,e}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,t,n){(function(n,r,s,i,o,a,l,c,u){s=e("buffer").Buffer;var h=4,d=new s(h);d.fill(0),t.exports={hash:function(e,t,n,r){for(var i=t(function(e,t){e.length%h!=0&&(n=e.length+(h-e.length%h),e=s.concat([e,d],n));for(var n,r=[],i=t?e.readInt32BE:e.readInt32LE,o=0;o<e.length;o+=h)r.push(i.call(e,o));return r}(e=s.isBuffer(e)?e:new s(e),r),8*e.length),o=(t=r,new s(n)),a=t?o.writeInt32BE:o.writeInt32LE,l=0;l<i.length;l++)a.call(o,i[l],4*l,!0);return o}}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,t,n){(function(t,r,s,i,o,a,l,c,u){s=e("buffer").Buffer;var h=e("./sha"),d=e("./sha256"),p=e("./rng"),m={sha1:h,sha256:d,md5:e("./md5")},f=64,g=new s(f);function y(e,t){var n=m[e=e||"sha1"],r=[];return n||v("algorithm:",e,"is not yet supported"),{update:function(e){return s.isBuffer(e)||(e=new s(e)),r.push(e),e.length,this},digest:function(e){var i=s.concat(r);return i=t?function(e,t,n){s.isBuffer(t)||(t=new s(t)),s.isBuffer(n)||(n=new s(n)),t.length>f?t=e(t):t.length<f&&(t=s.concat([t,g],f));for(var r=new s(f),i=new s(f),o=0;o<f;o++)r[o]=54^t[o],i[o]=92^t[o];return n=e(s.concat([r,n])),e(s.concat([i,n]))}(n,t,i):n(i),r=null,e?i.toString(e):i}}}function v(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}g.fill(0),n.createHash=function(e){return y(e)},n.createHmac=y,n.randomBytes=function(e,t){if(!t||!t.call)return new s(p(e));try{t.call(this,void 0,new s(p(e)))}catch(n){t(n)}};var x,b=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],_=function(e){n[e]=function(){v("sorry,",e,"is not implemented yet")}};for(x in b)_(b[x])}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,t,n){(function(n,r,s,i,o,a,l,c,u){var h=e("./helpers");function d(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,s=-1732584194,i=271733878,o=0;o<e.length;o+=16){var a=n,l=r,c=s,u=i;n=m(n,r,s,i,e[o+0],7,-680876936),i=m(i,n,r,s,e[o+1],12,-389564586),s=m(s,i,n,r,e[o+2],17,606105819),r=m(r,s,i,n,e[o+3],22,-1044525330),n=m(n,r,s,i,e[o+4],7,-176418897),i=m(i,n,r,s,e[o+5],12,1200080426),s=m(s,i,n,r,e[o+6],17,-1473231341),r=m(r,s,i,n,e[o+7],22,-45705983),n=m(n,r,s,i,e[o+8],7,1770035416),i=m(i,n,r,s,e[o+9],12,-1958414417),s=m(s,i,n,r,e[o+10],17,-42063),r=m(r,s,i,n,e[o+11],22,-1990404162),n=m(n,r,s,i,e[o+12],7,1804603682),i=m(i,n,r,s,e[o+13],12,-40341101),s=m(s,i,n,r,e[o+14],17,-1502002290),n=f(n,r=m(r,s,i,n,e[o+15],22,1236535329),s,i,e[o+1],5,-165796510),i=f(i,n,r,s,e[o+6],9,-1069501632),s=f(s,i,n,r,e[o+11],14,643717713),r=f(r,s,i,n,e[o+0],20,-373897302),n=f(n,r,s,i,e[o+5],5,-701558691),i=f(i,n,r,s,e[o+10],9,38016083),s=f(s,i,n,r,e[o+15],14,-660478335),r=f(r,s,i,n,e[o+4],20,-405537848),n=f(n,r,s,i,e[o+9],5,568446438),i=f(i,n,r,s,e[o+14],9,-1019803690),s=f(s,i,n,r,e[o+3],14,-187363961),r=f(r,s,i,n,e[o+8],20,1163531501),n=f(n,r,s,i,e[o+13],5,-1444681467),i=f(i,n,r,s,e[o+2],9,-51403784),s=f(s,i,n,r,e[o+7],14,1735328473),n=g(n,r=f(r,s,i,n,e[o+12],20,-1926607734),s,i,e[o+5],4,-378558),i=g(i,n,r,s,e[o+8],11,-2022574463),s=g(s,i,n,r,e[o+11],16,1839030562),r=g(r,s,i,n,e[o+14],23,-35309556),n=g(n,r,s,i,e[o+1],4,-1530992060),i=g(i,n,r,s,e[o+4],11,1272893353),s=g(s,i,n,r,e[o+7],16,-155497632),r=g(r,s,i,n,e[o+10],23,-1094730640),n=g(n,r,s,i,e[o+13],4,681279174),i=g(i,n,r,s,e[o+0],11,-358537222),s=g(s,i,n,r,e[o+3],16,-722521979),r=g(r,s,i,n,e[o+6],23,76029189),n=g(n,r,s,i,e[o+9],4,-640364487),i=g(i,n,r,s,e[o+12],11,-421815835),s=g(s,i,n,r,e[o+15],16,530742520),n=y(n,r=g(r,s,i,n,e[o+2],23,-995338651),s,i,e[o+0],6,-198630844),i=y(i,n,r,s,e[o+7],10,1126891415),s=y(s,i,n,r,e[o+14],15,-1416354905),r=y(r,s,i,n,e[o+5],21,-57434055),n=y(n,r,s,i,e[o+12],6,1700485571),i=y(i,n,r,s,e[o+3],10,-1894986606),s=y(s,i,n,r,e[o+10],15,-1051523),r=y(r,s,i,n,e[o+1],21,-2054922799),n=y(n,r,s,i,e[o+8],6,1873313359),i=y(i,n,r,s,e[o+15],10,-30611744),s=y(s,i,n,r,e[o+6],15,-1560198380),r=y(r,s,i,n,e[o+13],21,1309151649),n=y(n,r,s,i,e[o+4],6,-145523070),i=y(i,n,r,s,e[o+11],10,-1120210379),s=y(s,i,n,r,e[o+2],15,718787259),r=y(r,s,i,n,e[o+9],21,-343485551),n=v(n,a),r=v(r,l),s=v(s,c),i=v(i,u)}return Array(n,r,s,i)}function p(e,t,n,r,s,i){return v((t=v(v(t,e),v(r,i)))<<s|t>>>32-s,n)}function m(e,t,n,r,s,i,o){return p(t&n|~t&r,e,t,s,i,o)}function f(e,t,n,r,s,i,o){return p(t&r|n&~r,e,t,s,i,o)}function g(e,t,n,r,s,i,o){return p(t^n^r,e,t,s,i,o)}function y(e,t,n,r,s,i,o){return p(n^(t|~r),e,t,s,i,o)}function v(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}t.exports=function(e){return h.hash(e,d,16)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,t,n){(function(e,n,r,s,i,o,a,l,c){t.exports=function(e){for(var t,n=new Array(e),r=0;r<e;r++)!(3&r)&&(t=4294967296*Math.random()),n[r]=t>>>((3&r)<<3)&255;return n}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,t,n){(function(n,r,s,i,o,a,l,c,u){var h=e("./helpers");function d(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var n,r,s,i=Array(80),o=1732584193,a=-271733879,l=-1732584194,c=271733878,u=-1009589776,h=0;h<e.length;h+=16){for(var d=o,f=a,g=l,y=c,v=u,x=0;x<80;x++){i[x]=x<16?e[h+x]:m(i[x-3]^i[x-8]^i[x-14]^i[x-16],1);var b=p(p(m(o,5),(b=a,r=l,s=c,(n=x)<20?b&r|~b&s:!(n<40)&&n<60?b&r|b&s|r&s:b^r^s)),p(p(u,i[x]),(n=x)<20?1518500249:n<40?1859775393:n<60?-1894007588:-899497514));u=c,c=l,l=m(a,30),a=o,o=b}o=p(o,d),a=p(a,f),l=p(l,g),c=p(c,y),u=p(u,v)}return Array(o,a,l,c,u)}function p(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function m(e,t){return e<<t|e>>>32-t}t.exports=function(e){return h.hash(e,d,20,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,t,n){(function(n,r,s,i,o,a,l,c,u){function h(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function d(e,t){var n,r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),s=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),i=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var o,a,l=0;l<e.length;l+=16){for(var c=s[0],u=s[1],d=s[2],p=s[3],g=s[4],y=s[5],v=s[6],x=s[7],b=0;b<64;b++)i[b]=b<16?e[b+l]:h(h(h((a=i[b-2],m(a,17)^m(a,19)^f(a,10)),i[b-7]),(a=i[b-15],m(a,7)^m(a,18)^f(a,3))),i[b-16]),n=h(h(h(h(x,m(a=g,6)^m(a,11)^m(a,25)),g&y^~g&v),r[b]),i[b]),o=h(m(o=c,2)^m(o,13)^m(o,22),c&u^c&d^u&d),x=v,v=y,y=g,g=h(p,n),p=d,d=u,u=c,c=h(n,o);s[0]=h(c,s[0]),s[1]=h(u,s[1]),s[2]=h(d,s[2]),s[3]=h(p,s[3]),s[4]=h(g,s[4]),s[5]=h(y,s[5]),s[6]=h(v,s[6]),s[7]=h(x,s[7])}return s}var p=e("./helpers"),m=function(e,t){return e>>>t|e<<32-t},f=function(e,t){return e>>>t};t.exports=function(e){return p.hash(e,d,32,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,t,n){(function(e,t,r,s,i,o,a,l,c){n.read=function(e,t,n,r,s){var i,o,a=8*s-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?s-1:0,d=n?-1:1;for(s=e[t+h],h+=d,i=s&(1<<-u)-1,s>>=-u,u+=a;0<u;i=256*i+e[t+h],h+=d,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=r;0<u;o=256*o+e[t+h],h+=d,u-=8);if(0===i)i=1-c;else{if(i===l)return o?NaN:1/0*(s?-1:1);o+=Math.pow(2,r),i-=c}return(s?-1:1)*o*Math.pow(2,i-r)},n.write=function(e,t,n,r,s,i){var o,a,l=8*i-s-1,c=(1<<l)-1,u=c>>1,h=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,p=r?1:-1;for(i=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-o))<1&&(o--,r*=2),2<=(t+=1<=o+u?h/r:h*Math.pow(2,1-u))*r&&(o++,r/=2),c<=o+u?(a=0,o=c):1<=o+u?(a=(t*r-1)*Math.pow(2,s),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,s),o=0));8<=s;e[n+d]=255&a,d+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;0<l;e[n+d]=255&o,d+=p,o/=256,l-=8);e[n+d-p]|=128*i}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,t,n){(function(e,n,r,s,i,o,a,l,c){var u,h,d;function p(){}(e=t.exports={}).nextTick=(h=typeof window<"u"&&window.setImmediate,d=typeof window<"u"&&window.postMessage&&window.addEventListener,h?function(e){return window.setImmediate(e)}:d?(u=[],window.addEventListener("message",function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<u.length&&u.shift()())},!0),function(e){u.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)),pd.exports);const fd=ud(md);var gd,yd,vd,xd,bd,_d,wd,Td,Ed,Sd,Ad,Md,Od,Cd;function Nd(){return yd||(yd=1,gd=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]),gd}function Pd(){return _d||(_d=1,bd=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]),bd}function Rd(){if(Md)return Ad;Md=1,Ad=function(b){var _,w,T,E=0,S=0,A=i,M=[],O=[],C=1,N=0,P=0,R=!1,I=!1,L="",k=n,D=e;"300 es"===(b=b||{}).version&&(k=s,D=r);var z={},U={};for(E=0;E<k.length;E++)z[k[E]]=!0;for(E=0;E<D.length;E++)U[D[E]]=!0;return function(e){return O=[],null!==e?function(e){E=0,e.toString&&(e=e.toString()),L+=e.replace(/\r\n/g,"\n"),T=L.length;for(var t;_=L[E],E<T;){switch(t=E,A){case a:E=Y();break;case l:E=H();break;case c:E=j();break;case u:E=W();break;case h:E=q();break;case v:E=G();break;case d:E=Z();break;case o:E=K();break;case g:E=V();break;case i:E=B()}if(t!==E)if("\n"===L[t])N=0,++C;else++N}return S+=E,L=L.slice(E),O}(e):(M.length&&F(M.join("")),A=y,F("(eof)"),O)};function F(e){e.length&&O.push({type:x[A],data:e,position:P,line:C,column:N})}function B(){return M=M.length?[]:M,"/"===w&&"*"===_?(P=S+E-1,A=a,w=_,E+1):"/"===w&&"/"===_?(P=S+E-1,A=l,w=_,E+1):"#"===_?(A=c,P=S+E,E):/\s/.test(_)?(A=g,P=S+E,E):(R=/\d/.test(_),I=/[^\w_]/.test(_),P=S+E,A=R?h:I?u:o,E)}function V(){return/[^\s]/g.test(_)?(F(M.join("")),A=i,E):(M.push(_),w=_,E+1)}function j(){return"\r"!==_&&"\n"!==_||"\\"===w?(M.push(_),w=_,E+1):(F(M.join("")),A=i,E)}function H(){return j()}function Y(){return"/"===_&&"*"===w?(M.push(_),F(M.join("")),A=i,E+1):(M.push(_),w=_,E+1)}function W(){if("."===w&&/\d/.test(_))return A=d,E;if("/"===w&&"*"===_)return A=a,E;if("/"===w&&"/"===_)return A=l,E;if("."===_&&M.length){for(;X(M););return A=d,E}if(";"===_||")"===_||"("===_){if(M.length)for(;X(M););return F(_),A=i,E+1}var e=2===M.length&&"="!==_;if(/[\w_\d\s]/.test(_)||e){for(;X(M););return A=i,E}return M.push(_),w=_,E+1}function X(e){for(var n,r,s=0;;){if(n=t.indexOf(e.slice(0,e.length+s).join("")),r=t[n],-1===n){if(s--+e.length>0)continue;r=e.slice(0,1).join("")}return F(r),P+=r.length,(M=M.slice(r.length)).length}}function G(){return/[^a-fA-F0-9]/.test(_)?(F(M.join("")),A=i,E):(M.push(_),w=_,E+1)}function q(){return"."===_||/[eE]/.test(_)?(M.push(_),A=d,w=_,E+1):"x"===_&&1===M.length&&"0"===M[0]?(A=v,M.push(_),w=_,E+1):/[^\d]/.test(_)?(F(M.join("")),A=i,E):(M.push(_),w=_,E+1)}function Z(){return"f"===_&&(M.push(_),w=_,E+=1),/[eE]/.test(_)||("-"===_||"+"===_)&&/[eE]/.test(w)?(M.push(_),w=_,E+1):/[^\d]/.test(_)?(F(M.join("")),A=i,E):(M.push(_),w=_,E+1)}function K(){if(/[^\d\w_]/.test(_)){var e=M.join("");return A=U[e]?f:z[e]?m:p,F(M.join("")),A=i,E}return M.push(_),w=_,E+1}};var e=Nd(),t=(xd||(xd=1,vd=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]),vd),n=Pd(),r=function(){if(Td)return wd;Td=1;var e=Nd();return wd=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])}(),s=function(){if(Sd)return Ed;Sd=1;var e=Pd();return e=e.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),Ed=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])}(),i=999,o=9999,a=0,l=1,c=2,u=3,h=4,d=5,p=6,m=7,f=8,g=9,y=10,v=11,x=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];return Ad}var Id=function(){if(Cd)return Od;Cd=1;var e=Rd();return Od=function(t,n){var r=e(n),s=[];return s=s.concat(r(t)),s=s.concat(r(null))},Od}();const Ld=ud(Id);var kd,Dd;var zd=(Dd||(Dd=1,kd=function(e){for(var t=[],n=0;n<e.length;n++)"eof"!==e[n].type&&t.push(e[n].data);return t.join("")}),kd);const Ud=ud(zd);var Fd,Bd;var Vd=function(){if(Bd)return Fd;function e(e){return function(t){return"operator"===t.type&&(!e||t.data===e)}}function t(e){return"whitespace"!==e.type}return Bd=1,Fd=function(n){var r,s,i,o=null,a=null,l=0,c=0,u=0,h=0,d=0,p=[];for(r=0;r<n.length;r++)if("{"===(i=n[r]).data){if(l&&l++||(s=f(r,e(")"),e()))<0||(h=s,(s=f(s,e("("),e(")")))<0)||(d=s,(s=f(s,t))<0)||"ident"!==n[s].type||(a=n[s].data,(s=f(s,t))<0))continue;l=1,c=r,o=n[s].data,u=s;var m=f(s,t);switch(n[m]&&n[m].data){case"lowp":case"highp":case"mediump":u=m}}else if(l&&"}"===i.data){if(--l)continue;p.push({name:a,type:o,body:[c+1,r],args:[d,h+1],outer:[u,r+1]})}for(r=0;r<n.length;r++)if(";"===(i=n[r]).data){if((s=f(r,e(")"),e()))<0||(h=s,(s=f(s,e("("),e(")")))<0)||(d=s,(s=f(s,t))<0)||"ident"!==n[s].type||(a=n[s].data,(s=f(s,t))<0)||"operator"===n[s].type||"return"===n[s].data)continue;o=n[s].data,p.push({name:a,type:o,body:!1,args:[d,h+1],outer:[s,r+1]})}return p.sort(function(e,t){return e.outer[0]-t.outer[0]});function f(e,t,r){for(var s=e-1;s>=0;s--){if(t(n[s]))return s;if(r&&r(n[s]))return-1}return-1}},Fd}();const jd=ud(Vd);function Hd(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Yd(e,t,n){return(t=Hd(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wd(Object(n),!0).forEach(function(t){Yd(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wd(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Gd(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function qd(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hd(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kd(e,t){return(Kd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Qd(e){return Qd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qd(e)}function Jd(e){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Qd(e);if(t){var s=Qd(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zd(e)}(this,n)}}var $d,ep,tp,np="csm_Position",rp="csm_PositionRaw",sp="csm_PointSize",ip="csm_FragColor",op="csm_DiffuseColor",ap="csm_Normal",lp="csm_Roughness",cp="csm_Metalness",up="csm_Emissive",hp="csm_AO",dp="csm_Bump",pp="csm_DepthAlpha",mp=(Yd($d={},"".concat(ap),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(ap,";\n    #ifdef USE_TANGENT\n\t    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),Yd($d,"".concat(np),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(np,";\n  ")}),Yd($d,"".concat(rp),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(rp,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),Yd($d,"".concat(sp),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(sp,";\n    ")}),Yd($d,"".concat(op),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(op,";\n  ")}),Yd($d,"".concat(ip),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(ip,";\n  ")}),Yd($d,"".concat(up),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(up,";\n    ")}),Yd($d,"".concat(lp),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(lp,";\n    ")}),Yd($d,"".concat(cp),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(cp,";\n    ")}),Yd($d,"".concat(hp),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(hp,";\n    ")}),Yd($d,"".concat(dp),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(dp," - (dot(").concat(dp,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),Yd($d,"".concat(pp),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(pp," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(pp,";\n    ")}),$d),fp=(Yd(ep={},"".concat(np),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(np,", 1.0 );\n  ")}),Yd(ep,"".concat(rp),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(np,";\n  ")}),Yd(ep,"".concat(op),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(op,";\n  ")}),Yd(ep,"".concat(ip),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(ip,";\n  ")}),ep),gp=(Yd(tp={},"".concat(np),"*"),Yd(tp,"".concat(rp),"*"),Yd(tp,"".concat(ap),"*"),Yd(tp,"".concat(sp),["PointsMaterial"]),Yd(tp,"".concat(op),"*"),Yd(tp,"".concat(ip),"*"),Yd(tp,"".concat(up),["MeshStandardMaterial","MeshPhysicalMaterial"]),Yd(tp,"".concat(lp),["MeshStandardMaterial","MeshPhysicalMaterial"]),Yd(tp,"".concat(cp),["MeshStandardMaterial","MeshPhysicalMaterial"]),Yd(tp,"".concat(hp),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),Yd(tp,"".concat(dp),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),Yd(tp,"".concat(pp),"*"),tp),yp=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"];function vp(e){var t=e.toString().trim();return 0===t.substring(t.indexOf("{")+1,t.lastIndexOf("}")).trim().length}function xp(e){return e.replace(/\s/g,"")}var bp=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kd(e,t)}(t,I);var e=Jd(t);function t(n){var r,s,i=n.baseMaterial,o=n.fragmentShader,a=n.vertexShader,l=n.uniforms,c=n.patchMap,u=n.cacheKey,h=n.silent,d=Gd(n,yp);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(t){try{new t}catch(e){if(e.message.indexOf("is not a constructor")>=0)return!1}return!0}(i)?s=new i(d):(s=i,Object.assign(s,d)),"RawShaderMaterial"===s.type)throw new Error("CustomShaderMaterial does not support RawShaderMaterial");(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object.assign(e,t);var r=Object.getPrototypeOf(t);Object.entries(Object.getOwnPropertyDescriptors(r)).filter(function(e){var t="function"==typeof e[1].get,n="function"==typeof e[1].set,r="function"==typeof e[1].value,s="constructor"===e[0];return(t||n||r)&&!s}).forEach(function(t){if("function"!=typeof e[t[0]])Object.defineProperty(e,t[0],t[1]);else{n||console.warn("Function ".concat(t[0]," already exists on CSM, renaming to base_").concat(t[0]));var r="base_".concat(t[0]);e[r]=t[1].value.bind(e)}})})(Zd(r=e.call(this)),s,h),r.__csm={patchMap:c||{},fragmentShader:o||"",vertexShader:a||"",cacheKey:u,baseMaterial:i,instanceID:R.generateUUID(),type:s.type,isAlreadyExtended:!vp(s.onBeforeCompile),cacheHash:"",silent:h},r.uniforms=Xd(Xd({},r.uniforms||{}),l||{});var p=r.__csm,m=p.fragmentShader,f=p.vertexShader,g=r.uniforms;return r.__csm.cacheHash=r.getCacheHash(),r.generateMaterial(m,f,g),r}return qd(t,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.uniforms=e.uniforms||this.uniforms,Object.assign(this.__csm,e);var t=this.__csm,n=t.fragmentShader,r=t.vertexShader,s=this.uniforms,i=this.getCacheHash();this.__csm.cacheHash=i,this.generateMaterial(n,r,s)}},{key:"clone",value:function(){var e={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},t=new this.constructor(e);return Object.assign(this,t),t}},{key:"getCacheHash",value:function(){var e=this.__csm,t=e.fragmentShader,n=e.vertexShader,r=this.uniforms,s=Object.values(r).reduce(function(e,t){var n=t.value;return e+JSON.stringify(n)},""),i=xp(t)+xp(n)+s;return i.trim().length>0?fd(i):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(e,t,n){var r=this,s=this.parseShader(e),i=this.parseShader(t);this.uniforms=n||{},this.customProgramCacheKey=function(){return r.__csm.cacheHash};var o=function(e){try{if(s){var t=r.patchShader(s,e.fragmentShader,!0);e.fragmentShader=r.getMaterialDefine()+t}if(i){var n=r.patchShader(i,e.vertexShader);e.vertexShader="#define IS_VERTEX;\n"+n,e.vertexShader=r.getMaterialDefine()+e.vertexShader}e.uniforms=Xd(Xd({},e.uniforms),r.uniforms),r.uniforms=e.uniforms}catch(o){console.error(o)}};if(this.__csm.isAlreadyExtended){var a=this.onBeforeCompile;this.onBeforeCompile=function(e,t){a(e,t),o(e)}}else this.onBeforeCompile=o;this.needsUpdate=!0}},{key:"patchShader",value:function(e,t,n){var r=this,s=t,i=Xd(Xd({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(i).forEach(function(t){Object.keys(i[t]).forEach(function(n){var o=gp[t],a=r.__csm.type;if("*"===t||function(e,t){return new RegExp("\\b".concat(function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t),"\\b")).test(e)}(e.main,t)){if(!(!o||Array.isArray(o)&&o.includes(a)||"*"===o))throw new Error("CSM: ".concat(t," is not available in ").concat(a,". Shader cannot compile."));s=function(e,t,n){return e.split(t).join(n)}(s,n,i[t][n])}})}),s=s.replace("void main() {","\n        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED\n          ".concat("\n    varying mat4 csm_internal_vModelViewMatrix;\n","\n          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1\n        #endif\n\n        ").concat(e.header,"\n        \n        void main() {\n          #ifndef CSM_IS_DEFAULTS_DEFINED\n            ").concat("\n\n#ifdef IS_VERTEX\n    // csm_Position & csm_PositionRaw\n    #ifdef IS_UNKNOWN\n        vec3 csm_Position = vec3(0.0);\n        vec4 csm_PositionRaw = vec4(0.0);\n        vec3 csm_Normal = vec3(0.0);\n    #else\n        vec3 csm_Position = position;\n        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n        vec3 csm_Normal = normal;\n    #endif\n\n    // csm_PointSize\n    #ifdef IS_POINTSMATERIAL\n        float csm_PointSize = size;\n    #endif\n#else\n    // csm_DiffuseColor & csm_FragColor\n    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL\n        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);\n        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    #else\n        #ifdef USE_MAP\n            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);\n\n            #ifdef DECODE_VIDEO_TEXTURE\n            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)\n            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);\n            #endif\n\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n        #else\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity);\n            vec4 csm_FragColor = vec4(diffuse, opacity);\n        #endif\n    #endif\n\n    // csm_Emissive, csm_Roughness, csm_Metalness\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL\n        vec3 csm_Emissive = emissive;\n        float csm_Roughness = roughness;\n        float csm_Metalness = metalness;\n    #endif\n\n    // csm_AO\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL\n        float csm_AO = 0.0;\n    #endif\n\n    // csm_Bump\n    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL \n        vec3 csm_Bump = vec3(0.0);\n    #endif\n\n    float csm_DepthAlpha = 1.0;\n#endif\n","\n            #define CSM_IS_DEFAULTS_DEFINED 1\n          #endif\n          \n          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED\n            ").concat(n?"\n    \n":"\n    csm_internal_vModelViewMatrix = modelViewMatrix;\n","\n            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1\n          #endif\n\n          // CSM_START\n      "));var o=this.__csm.isAlreadyExtended,a=s.includes("// CSM_END");return s=o&&a?function(e,t,n){var r=e.lastIndexOf(t);return-1===r?e:e.substring(0,r)+n+e.substring(r+t.length)}(s,"// CSM_END","\n          // CSM_END\n          ".concat(e.main,"\n          // CSM_END\n        ")):s.replace("// CSM_START","\n        // CSM_START\n        ".concat(e.main,"\n        // CSM_END\n          ")),s=e.defines+s}},{key:"parseShader",value:function(e){if(e){var t=e.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),n=Ld(t),r=jd(n),s=r.map(function(e){return e.name}).indexOf("main");return{defines:"",header:Ud(n.slice(0,s>=0?r[s].outer[0]:void 0)),main:s>=0?this.getShaderFromIndex(n,r[s].body):""}}}},{key:"getMaterialDefine",value:function(){var e=this.__csm.type;return e?"#define IS_".concat(e.toUpperCase(),";\n"):"#define IS_UNKNOWN;\n"}},{key:"getPatchMapForMaterial",value:function(){return"ShaderMaterial"===this.__csm.type?fp:mp}},{key:"getShaderFromIndex",value:function(e,t){return Ud(e.slice(t[0],t[1]))}}]),t}();const _p=["args"],wp=Tt({__name:"index",props:{baseMaterial:{type:Function},vertexShader:{},fragmentShader:{},silent:{type:Boolean},uniforms:{}},setup(e,{expose:t}){const n=e,r=At(null),{extend:s,invalidate:i}=Ms();return s({CustomShaderMaterial:bp}),Ct(n,()=>{i()}),t({instance:r}),(e,t)=>(Rt(),Mt("TresCustomShaderMaterial",{ref_key:"customShaderMaterialClass",ref:r,args:[n]},null,8,_p))}});class Tp extends ce{isMeshPhysicalMaterial;clearcoatMap;clearcoatRoughness;clearcoatRoughnessMap;clearcoatNormalScale;clearcoatNormalMap;ior;transmissionMap;thickness;thicknessMap;attenuationDistance;attenuationColor;specularIntensity;specularIntensityMap;specularColor;specularColorMap;_clearcoat;_transmission;constructor(e={}){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new T(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get(){return R.clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.roughness=0,this.transmissionMap=null,this.thickness=.5,this.thicknessMap=null,this.attenuationDistance=Number.POSITIVE_INFINITY,this.attenuationColor=new g(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new g(1,1,1),this.specularColorMap=null,this._clearcoat=.5,this._transmission=1,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const Ep=Tt({__name:"index",setup(e,{expose:t}){const n=At(),{extend:r}=As();return r({MeshGlassMaterial:Tp}),t({instance:n}),(e,t)=>(Rt(),Mt("TresMeshGlassMaterial",{ref_key:"MeshGlassMaterialClass",ref:n},null,512))}}),Sp=1001,Ap=1003,Mp=1006,Op="srgb",Cp="srgb-linear",Np="linear",Pp="srgb",Rp=35044,Ip=2e3,Lp=2001;
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */class kp{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const r=n[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}}const Dp=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let zp=1234567;const Up=Math.PI/180,Fp=180/Math.PI;function Bp(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Dp[255&e]+Dp[e>>8&255]+Dp[e>>16&255]+Dp[e>>24&255]+"-"+Dp[255&t]+Dp[t>>8&255]+"-"+Dp[t>>16&15|64]+Dp[t>>24&255]+"-"+Dp[63&n|128]+Dp[n>>8&255]+"-"+Dp[n>>16&255]+Dp[n>>24&255]+Dp[255&r]+Dp[r>>8&255]+Dp[r>>16&255]+Dp[r>>24&255]).toLowerCase()}function Vp(e,t,n){return Math.max(t,Math.min(n,e))}function jp(e,t){return(e%t+t)%t}function Hp(e,t,n){return(1-n)*e+n*t}function Yp(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Wp(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const Xp={DEG2RAD:Up,RAD2DEG:Fp,generateUUID:Bp,clamp:Vp,euclideanModulo:jp,mapLinear:function(e,t,n,r,s){return r+(e-t)*(s-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Hp,damp:function(e,t,n,r){return Hp(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(jp(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(zp=e);let t=zp+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Up},radToDeg:function(e){return e*Fp},isPowerOfTwo:function(e){return!(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,s){const i=Math.cos,o=Math.sin,a=i(n/2),l=o(n/2),c=i((t+r)/2),u=o((t+r)/2),h=i((t-r)/2),d=o((t-r)/2),p=i((r-t)/2),m=o((r-t)/2);switch(s){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*m,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*m,a*c);break;case"ZYZ":e.set(l*m,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}},normalize:Wp,denormalize:Yp};let Gp=class e{constructor(t=0,n=0){e.prototype.isVector2=!0,this.x=t,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Vp(this.x,e.x,t.x),this.y=Vp(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Vp(this.x,e,t),this.y=Vp(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Vp(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Vp(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,i=this.y-e.y;return this.x=s*n-i*r+e.x,this.y=s*r+i*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};class qp{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,i,o){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=s[i+0],d=s[i+1],p=s[i+2],m=s[i+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=m);if(u!==m||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*m,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const s=Math.sqrt(r),i=Math.atan2(s,t*n);e=Math.sin(e*i)/s,o=Math.sin(o*i)/s}const s=o*n;if(a=a*e+h*s,l=l*e+d*s,c=c*e+p*s,u=u*e+m*s,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,s,i){const o=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=s[i],h=s[i+1],d=s[i+2],p=s[i+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,i=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(r/2),u=o(s/2),h=a(n/2),d=a(r/2),p=a(s/2);switch(i){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],i=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(s-l)*e,this._z=(i-r)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(r+i)/e,this._z=(s+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(s-l)/e,this._x=(r+i)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(i-r)/e,this._x=(s+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Vp(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,i=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+i*o+r*l-s*a,this._y=r*c+i*a+s*o-n*l,this._z=s*c+i*l+n*a-r*o,this._w=i*c-n*o-r*a-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,i=this._w;let o=i*e._w+n*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=i,this._x=n,this._y=r,this._z=s,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*i+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*s+t*this._z,this.normalize(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=i*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=s*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}let Zp=class e{constructor(t=0,n=0,r=0){e.prototype.isVector3=!0,this.x=t,this.y=n,this.z=r}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Qp.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Qp.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,i=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*i,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*i,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*i,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,i=e.y,o=e.z,a=e.w,l=2*(i*r-o*n),c=2*(o*t-s*r),u=2*(s*n-i*t);return this.x=t+a*l+i*u-o*c,this.y=n+a*c+o*l-s*u,this.z=r+a*u+s*c-i*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Vp(this.x,e.x,t.x),this.y=Vp(this.y,e.y,t.y),this.z=Vp(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Vp(this.x,e,t),this.y=Vp(this.y,e,t),this.z=Vp(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Vp(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,i=t.x,o=t.y,a=t.z;return this.x=r*a-s*o,this.y=s*i-n*a,this.z=n*o-r*i,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Kp.copy(this).projectOnVector(e),this.sub(Kp)}reflect(e){return this.sub(Kp.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Vp(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const Kp=new Zp,Qp=new qp;class Jp{constructor(e,t,n,r,s,i,o,a,l){Jp.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,s,i,o,a,l)}set(e,t,n,r,s,i,o,a,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=s,c[5]=a,c[6]=n,c[7]=i,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,i=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],m=r[0],f=r[3],g=r[6],y=r[1],v=r[4],x=r[7],b=r[2],_=r[5],w=r[8];return s[0]=i*m+o*y+a*b,s[3]=i*f+o*v+a*_,s[6]=i*g+o*x+a*w,s[1]=l*m+c*y+u*b,s[4]=l*f+c*v+u*_,s[7]=l*g+c*x+u*w,s[2]=h*m+d*y+p*b,s[5]=h*f+d*v+p*_,s[8]=h*g+d*x+p*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],i=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*i*c-t*o*l-n*s*c+n*o*a+r*s*l-r*i*a}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],i=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*i-o*l,h=o*a-c*s,d=l*s-i*a,p=t*u+n*h+r*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=u*m,e[1]=(r*l-c*n)*m,e[2]=(o*n-r*i)*m,e[3]=h*m,e[4]=(c*t-r*a)*m,e[5]=(r*s-o*t)*m,e[6]=d*m,e[7]=(n*a-l*t)*m,e[8]=(i*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,i,o){const a=Math.cos(s),l=Math.sin(s);return this.set(n*a,n*l,-n*(a*i+l*o)+i+e,-r*l,r*a,-r*(-l*i+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply($p.makeScale(e,t)),this}rotate(e){return this.premultiply($p.makeRotation(-e)),this}translate(e,t){return this.premultiply($p.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const $p=new Jp;function em(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const tm={};function nm(e){e in tm||(tm[e]=!0,console.warn(e))}const rm=(new Jp).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),sm=(new Jp).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function im(){const e={enabled:!0,workingColorSpace:Cp,spaces:{},convert:function(e,t,n){return!1===this.enabled||t===n||!t||!n||(this.spaces[t].transfer===Pp&&(e.r=am(e.r),e.g=am(e.g),e.b=am(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===Pp&&(e.r=lm(e.r),e.g=lm(e.g),e.b=lm(e.b))),e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return""===e?Np:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return nm("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return nm("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[Cp]:{primaries:t,whitePoint:r,transfer:Np,toXYZ:rm,fromXYZ:sm,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Op},outputColorSpaceConfig:{drawingBufferColorSpace:Op}},[Op]:{primaries:t,whitePoint:r,transfer:Pp,toXYZ:rm,fromXYZ:sm,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Op}}}),e}const om=im();function am(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function lm(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let cm;class um{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{void 0===cm&&(cm=em("canvas")),cm.width=e.width,cm.height=e.height;const t=cm.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),n=cm}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=em("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let e=0;e<s.length;e++)s[e]=255*am(s[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*am(t[e]/255)):t[e]=am(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let hm=0;class dm{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:hm++}),this.uuid=Bp(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(pm(r[t].image)):e.push(pm(r[t]))}else e=pm(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function pm(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?um.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let mm=0;const fm=new Zp;class gm extends kp{constructor(e=gm.DEFAULT_IMAGE,t=gm.DEFAULT_MAPPING,n=Sp,r=Sp,s=Mp,i=1008,o=1023,a=1009,l=gm.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mm++}),this.uuid=Bp(),this.name="",this.source=new dm(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=i,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Gp(0,0),this.repeat=new Gp(1,1),this.center=new Gp(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jp,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(fm).x}get height(){return this.source.getSize(fm).y}get depth(){return this.source.getSize(fm).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n:console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case Sp:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case Sp:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}gm.DEFAULT_IMAGE=null,gm.DEFAULT_MAPPING=300,gm.DEFAULT_ANISOTROPY=1;let ym=class e{constructor(t=0,n=0,r=0,s=1){e.prototype.isVector4=!0,this.x=t,this.y=n,this.z=r,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r+i[12]*s,this.y=i[1]*t+i[5]*n+i[9]*r+i[13]*s,this.z=i[2]*t+i[6]*n+i[10]*r+i[14]*s,this.w=i[3]*t+i[7]*n+i[11]*r+i[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const i=e.elements,o=i[0],a=i[4],l=i[8],c=i[1],u=i[5],h=i[9],d=i[2],p=i[6],m=i[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(o+u+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const e=(o+1)/2,i=(u+1)/2,f=(m+1)/2,g=(a+c)/4,y=(l+d)/4,v=(h+p)/4;return e>i&&e>f?e<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(e),r=g/n,s=y/n):i>f?i<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(i),n=g/r,s=v/r):f<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(f),n=y/s,r=v/s),this.set(n,r,s,t),this}let f=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(f)<.001&&(f=1),this.x=(p-h)/f,this.y=(l-d)/f,this.z=(c-a)/f,this.w=Math.acos((o+u+m-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Vp(this.x,e.x,t.x),this.y=Vp(this.y,e.y,t.y),this.z=Vp(this.z,e.z,t.z),this.w=Vp(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Vp(this.x,e,t),this.y=Vp(this.y,e,t),this.z=Vp(this.z,e,t),this.w=Vp(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Vp(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};class vm extends kp{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Mp,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new ym(0,0,e,t),this.scissorTest=!1,this.viewport=new ym(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new gm(r);this.textures=[];const i=n.count;for(let o=0;o<i;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Mp,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isArrayTexture=this.textures[r].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new dm(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class xm{constructor(e=new Zp(1/0,1/0,1/0),t=new Zp(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(_m.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(_m.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=_m.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,_m):_m.fromBufferAttribute(r,t),_m.applyMatrix4(e.matrixWorld),this.expandByPoint(_m);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),wm.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),wm.copy(n.boundingBox)),wm.applyMatrix4(e.matrixWorld),this.union(wm)}const r=e.children;for(let s=0,i=r.length;s<i;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,_m),_m.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Cm),Nm.subVectors(this.max,Cm),Tm.subVectors(e.a,Cm),Em.subVectors(e.b,Cm),Sm.subVectors(e.c,Cm),Am.subVectors(Em,Tm),Mm.subVectors(Sm,Em),Om.subVectors(Tm,Sm);let t=[0,-Am.z,Am.y,0,-Mm.z,Mm.y,0,-Om.z,Om.y,Am.z,0,-Am.x,Mm.z,0,-Mm.x,Om.z,0,-Om.x,-Am.y,Am.x,0,-Mm.y,Mm.x,0,-Om.y,Om.x,0];return!(!Im(t,Tm,Em,Sm,Nm)||(t=[1,0,0,0,1,0,0,0,1],!Im(t,Tm,Em,Sm,Nm)))&&(Pm.crossVectors(Am,Mm),t=[Pm.x,Pm.y,Pm.z],Im(t,Tm,Em,Sm,Nm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_m).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(_m).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(bm[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),bm[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),bm[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),bm[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),bm[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),bm[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),bm[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),bm[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(bm)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const bm=[new Zp,new Zp,new Zp,new Zp,new Zp,new Zp,new Zp,new Zp],_m=new Zp,wm=new xm,Tm=new Zp,Em=new Zp,Sm=new Zp,Am=new Zp,Mm=new Zp,Om=new Zp,Cm=new Zp,Nm=new Zp,Pm=new Zp,Rm=new Zp;function Im(e,t,n,r,s){for(let i=0,o=e.length-3;i<=o;i+=3){Rm.fromArray(e,i);const o=s.x*Math.abs(Rm.x)+s.y*Math.abs(Rm.y)+s.z*Math.abs(Rm.z),a=t.dot(Rm),l=n.dot(Rm),c=r.dot(Rm);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Lm=new xm,km=new Zp,Dm=new Zp;class zm{constructor(e=new Zp,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Lm.setFromPoints(e).getCenter(n);let r=0;for(let s=0,i=e.length;s<i;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;km.subVectors(e,this.center);const t=km.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(km,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Dm.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(km.copy(e.center).add(Dm)),this.expandByPoint(km.copy(e.center).sub(Dm))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}let Um=class e{constructor(t,n,r,s,i,o,a,l,c,u,h,d,p,m,f,g){e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,n,r,s,i,o,a,l,c,u,h,d,p,m,f,g)}set(e,t,n,r,s,i,o,a,l,c,u,h,d,p,m,f){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=s,g[5]=i,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=m,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new e).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Fm.setFromMatrixColumn(e,0).length(),s=1/Fm.setFromMatrixColumn(e,1).length(),i=1/Fm.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,i=Math.cos(n),o=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(s),u=Math.sin(s);if("XYZ"===e.order){const e=i*c,n=i*u,r=o*c,s=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+r*l,t[5]=e-s*l,t[9]=-o*a,t[2]=s-e*l,t[6]=r+n*l,t[10]=i*a}else if("YXZ"===e.order){const e=a*c,n=a*u,r=l*c,s=l*u;t[0]=e+s*o,t[4]=r*o-n,t[8]=i*l,t[1]=i*u,t[5]=i*c,t[9]=-o,t[2]=n*o-r,t[6]=s+e*o,t[10]=i*a}else if("ZXY"===e.order){const e=a*c,n=a*u,r=l*c,s=l*u;t[0]=e-s*o,t[4]=-i*u,t[8]=r+n*o,t[1]=n+r*o,t[5]=i*c,t[9]=s-e*o,t[2]=-i*l,t[6]=o,t[10]=i*a}else if("ZYX"===e.order){const e=i*c,n=i*u,r=o*c,s=o*u;t[0]=a*c,t[4]=r*l-n,t[8]=e*l+s,t[1]=a*u,t[5]=s*l+e,t[9]=n*l-r,t[2]=-l,t[6]=o*a,t[10]=i*a}else if("YZX"===e.order){const e=i*a,n=i*l,r=o*a,s=o*l;t[0]=a*c,t[4]=s-e*u,t[8]=r*u+n,t[1]=u,t[5]=i*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-s*u}else if("XZY"===e.order){const e=i*a,n=i*l,r=o*a,s=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+s,t[5]=i*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=o*c,t[10]=s*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Vm,e,jm)}lookAt(e,t,n){const r=this.elements;return Wm.subVectors(e,t),0===Wm.lengthSq()&&(Wm.z=1),Wm.normalize(),Hm.crossVectors(n,Wm),0===Hm.lengthSq()&&(1===Math.abs(n.z)?Wm.x+=1e-4:Wm.z+=1e-4,Wm.normalize(),Hm.crossVectors(n,Wm)),Hm.normalize(),Ym.crossVectors(Wm,Hm),r[0]=Hm.x,r[4]=Ym.x,r[8]=Wm.x,r[1]=Hm.y,r[5]=Ym.y,r[9]=Wm.y,r[2]=Hm.z,r[6]=Ym.z,r[10]=Wm.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,i=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],m=n[6],f=n[10],g=n[14],y=n[3],v=n[7],x=n[11],b=n[15],_=r[0],w=r[4],T=r[8],E=r[12],S=r[1],A=r[5],M=r[9],O=r[13],C=r[2],N=r[6],P=r[10],R=r[14],I=r[3],L=r[7],k=r[11],D=r[15];return s[0]=i*_+o*S+a*C+l*I,s[4]=i*w+o*A+a*N+l*L,s[8]=i*T+o*M+a*P+l*k,s[12]=i*E+o*O+a*R+l*D,s[1]=c*_+u*S+h*C+d*I,s[5]=c*w+u*A+h*N+d*L,s[9]=c*T+u*M+h*P+d*k,s[13]=c*E+u*O+h*R+d*D,s[2]=p*_+m*S+f*C+g*I,s[6]=p*w+m*A+f*N+g*L,s[10]=p*T+m*M+f*P+g*k,s[14]=p*E+m*O+f*R+g*D,s[3]=y*_+v*S+x*C+b*I,s[7]=y*w+v*A+x*N+b*L,s[11]=y*T+v*M+x*P+b*k,s[15]=y*E+v*O+x*R+b*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],i=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+s*a*u-r*l*u-s*o*h+n*l*h+r*o*d-n*a*d)+e[7]*(+t*a*d-t*l*h+s*i*h-r*i*d+r*l*c-s*a*c)+e[11]*(+t*l*u-t*o*d-s*i*u+n*i*d+s*o*c-n*l*c)+e[15]*(-r*o*c-t*a*u+t*o*h+r*i*u-n*i*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],i=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],m=e[13],f=e[14],g=e[15],y=u*f*l-m*h*l+m*a*d-o*f*d-u*a*g+o*h*g,v=p*h*l-c*f*l-p*a*d+i*f*d+c*a*g-i*h*g,x=c*m*l-p*u*l+p*o*d-i*m*d-c*o*g+i*u*g,b=p*u*a-c*m*a-p*o*h+i*m*h+c*o*f-i*u*f,_=t*y+n*v+r*x+s*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return e[0]=y*w,e[1]=(m*h*s-u*f*s-m*r*d+n*f*d+u*r*g-n*h*g)*w,e[2]=(o*f*s-m*a*s+m*r*l-n*f*l-o*r*g+n*a*g)*w,e[3]=(u*a*s-o*h*s-u*r*l+n*h*l+o*r*d-n*a*d)*w,e[4]=v*w,e[5]=(c*f*s-p*h*s+p*r*d-t*f*d-c*r*g+t*h*g)*w,e[6]=(p*a*s-i*f*s-p*r*l+t*f*l+i*r*g-t*a*g)*w,e[7]=(i*h*s-c*a*s+c*r*l-t*h*l-i*r*d+t*a*d)*w,e[8]=x*w,e[9]=(p*u*s-c*m*s-p*n*d+t*m*d+c*n*g-t*u*g)*w,e[10]=(i*m*s-p*o*s+p*n*l-t*m*l-i*n*g+t*o*g)*w,e[11]=(c*o*s-i*u*s-c*n*l+t*u*l+i*n*d-t*o*d)*w,e[12]=b*w,e[13]=(c*m*r-p*u*r+p*n*h-t*m*h-c*n*f+t*u*f)*w,e[14]=(p*o*r-i*m*r-p*n*a+t*m*a+i*n*f-t*o*f)*w,e[15]=(i*u*r-c*o*r+c*n*a-t*u*a-i*n*h+t*o*h)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,i=e.x,o=e.y,a=e.z,l=s*i,c=s*o;return this.set(l*i+n,l*o-r*a,l*a+r*o,0,l*o+r*a,c*o+n,c*a-r*i,0,l*a-r*o,c*a+r*i,s*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,i){return this.set(1,n,s,0,e,1,i,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,i=t._y,o=t._z,a=t._w,l=s+s,c=i+i,u=o+o,h=s*l,d=s*c,p=s*u,m=i*c,f=i*u,g=o*u,y=a*l,v=a*c,x=a*u,b=n.x,_=n.y,w=n.z;return r[0]=(1-(m+g))*b,r[1]=(d+x)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(d-x)*_,r[5]=(1-(h+g))*_,r[6]=(f+y)*_,r[7]=0,r[8]=(p+v)*w,r[9]=(f-y)*w,r[10]=(1-(h+m))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Fm.set(r[0],r[1],r[2]).length();const i=Fm.set(r[4],r[5],r[6]).length(),o=Fm.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Bm.copy(this);const a=1/s,l=1/i,c=1/o;return Bm.elements[0]*=a,Bm.elements[1]*=a,Bm.elements[2]*=a,Bm.elements[4]*=l,Bm.elements[5]*=l,Bm.elements[6]*=l,Bm.elements[8]*=c,Bm.elements[9]*=c,Bm.elements[10]*=c,t.setFromRotationMatrix(Bm),n.x=s,n.y=i,n.z=o,this}makePerspective(e,t,n,r,s,i,o=Ip,a=!1){const l=this.elements,c=2*s/(t-e),u=2*s/(n-r),h=(t+e)/(t-e),d=(n+r)/(n-r);let p,m;if(a)p=s/(i-s),m=i*s/(i-s);else if(o===Ip)p=-(i+s)/(i-s),m=-2*i*s/(i-s);else{if(o!==Lp)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-i/(i-s),m=-i*s/(i-s)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,s,i,o=Ip,a=!1){const l=this.elements,c=2/(t-e),u=2/(n-r),h=-(t+e)/(t-e),d=-(n+r)/(n-r);let p,m;if(a)p=1/(i-s),m=i/(i-s);else if(o===Ip)p=-2/(i-s),m=-(i+s)/(i-s);else{if(o!==Lp)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=-1/(i-s),m=-s/(i-s)}return l[0]=c,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=u,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=p,l[14]=m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}};const Fm=new Zp,Bm=new Um,Vm=new Zp(0,0,0),jm=new Zp(1,1,1),Hm=new Zp,Ym=new Zp,Wm=new Zp,Xm=new Um,Gm=new qp;class qm{constructor(e=0,t=0,n=0,r=qm.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],i=r[4],o=r[8],a=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Vp(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-i,s)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Vp(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(Vp(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-i,l)):(this._y=0,this._z=Math.atan2(a,s));break;case"ZYX":this._y=Math.asin(-Vp(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,s)):(this._x=0,this._z=Math.atan2(-i,l));break;case"YZX":this._z=Math.asin(Vp(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Vp(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Xm.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Xm,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Gm.setFromEuler(this),this.setFromQuaternion(Gm,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}qm.DEFAULT_ORDER="XYZ";class Zm{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let Km=0;const Qm=new Zp,Jm=new qp,$m=new Um,ef=new Zp,tf=new Zp,nf=new Zp,rf=new qp,sf=new Zp(1,0,0),of=new Zp(0,1,0),af=new Zp(0,0,1),lf={type:"added"},cf={type:"removed"},uf={type:"childadded",child:null},hf={type:"childremoved",child:null};class df extends kp{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Km++}),this.uuid=Bp(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=df.DEFAULT_UP.clone();const e=new Zp,t=new qm,n=new qp,r=new Zp(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Um},normalMatrix:{value:new Jp}}),this.matrix=new Um,this.matrixWorld=new Um,this.matrixAutoUpdate=df.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=df.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Zm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Jm.setFromAxisAngle(e,t),this.quaternion.multiply(Jm),this}rotateOnWorldAxis(e,t){return Jm.setFromAxisAngle(e,t),this.quaternion.premultiply(Jm),this}rotateX(e){return this.rotateOnAxis(sf,e)}rotateY(e){return this.rotateOnAxis(of,e)}rotateZ(e){return this.rotateOnAxis(af,e)}translateOnAxis(e,t){return Qm.copy(e).applyQuaternion(this.quaternion),this.position.add(Qm.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(sf,e)}translateY(e){return this.translateOnAxis(of,e)}translateZ(e){return this.translateOnAxis(af,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4($m.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ef.copy(e):ef.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),tf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$m.lookAt(tf,ef,this.up):$m.lookAt(ef,tf,this.up),this.quaternion.setFromRotationMatrix($m),r&&($m.extractRotation(r.matrixWorld),Jm.setFromRotationMatrix($m),this.quaternion.premultiply(Jm.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(lf),uf.child=e,this.dispatchEvent(uf),uf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(cf),hf.child=e,this.dispatchEvent(hf),hf.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),$m.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),$m.multiply(e.parent.matrixWorld)),e.applyMatrix4($m),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(lf),uf.child=e,this.dispatchEvent(uf),uf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,i=r.length;s<i;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tf,e,nf),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tf,rf,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};function s(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(e=>({...e,boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(e=>({...e})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];s(e.shapes,r)}else s(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(s(e.materials,this.material[n]));r.material=t}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(s(e.animations,n))}}if(t){const t=i(e.geometries),r=i(e.materials),s=i(e.textures),o=i(e.images),a=i(e.shapes),l=i(e.skeletons),c=i(e.animations),u=i(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),s.length>0&&(n.textures=s),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function i(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}df.DEFAULT_UP=new Zp(0,1,0),df.DEFAULT_MATRIX_AUTO_UPDATE=!0,df.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const pf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},mf={h:0,s:0,l:0},ff={h:0,s:0,l:0};function gf(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}let yf=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Op){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,om.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=om.workingColorSpace){return this.r=e,this.g=t,this.b=n,om.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=om.workingColorSpace){if(e=jp(e,1),t=Vp(t,0,1),n=Vp(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,s=2*n-r;this.r=gf(s,r,e+1/3),this.g=gf(s,r,e),this.b=gf(s,r,e-1/3)}return om.colorSpaceToWorking(this,r),this}setStyle(e,t=Op){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],s=n.length;if(3===s)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===s)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Op){const n=pf[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=am(e.r),this.g=am(e.g),this.b=am(e.b),this}copyLinearToSRGB(e){return this.r=lm(e.r),this.g=lm(e.g),this.b=lm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Op){return om.workingToColorSpace(vf.copy(this),e),65536*Math.round(Vp(255*vf.r,0,255))+256*Math.round(Vp(255*vf.g,0,255))+Math.round(Vp(255*vf.b,0,255))}getHexString(e=Op){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=om.workingColorSpace){om.workingToColorSpace(vf.copy(this),t);const n=vf.r,r=vf.g,s=vf.b,i=Math.max(n,r,s),o=Math.min(n,r,s);let a,l;const c=(o+i)/2;if(o===i)a=0,l=0;else{const e=i-o;switch(l=c<=.5?e/(i+o):e/(2-i-o),i){case n:a=(r-s)/e+(r<s?6:0);break;case r:a=(s-n)/e+2;break;case s:a=(n-r)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e,t=om.workingColorSpace){return om.workingToColorSpace(vf.copy(this),t),e.r=vf.r,e.g=vf.g,e.b=vf.b,e}getStyle(e=Op){om.workingToColorSpace(vf.copy(this),e);const t=vf.r,n=vf.g,r=vf.b;return e!==Op?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(mf),this.setHSL(mf.h+e,mf.s+t,mf.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(mf),e.getHSL(ff);const n=Hp(mf.h,ff.h,t),r=Hp(mf.s,ff.s,t),s=Hp(mf.l,ff.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const vf=new yf;yf.NAMES=pf;const xf=new Zp,bf=new Gp;let _f=0;class wf{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:_f++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Rp,this.updateRanges=[],this.gpuType=1015,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)bf.fromBufferAttribute(this,t),bf.applyMatrix3(e),this.setXY(t,bf.x,bf.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)xf.fromBufferAttribute(this,t),xf.applyMatrix3(e),this.setXYZ(t,xf.x,xf.y,xf.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)xf.fromBufferAttribute(this,t),xf.applyMatrix4(e),this.setXYZ(t,xf.x,xf.y,xf.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)xf.fromBufferAttribute(this,t),xf.applyNormalMatrix(e),this.setXYZ(t,xf.x,xf.y,xf.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)xf.fromBufferAttribute(this,t),xf.transformDirection(e),this.setXYZ(t,xf.x,xf.y,xf.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Yp(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Wp(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Yp(t,this.array)),t}setX(e,t){return this.normalized&&(t=Wp(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Yp(t,this.array)),t}setY(e,t){return this.normalized&&(t=Wp(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Yp(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Wp(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Yp(t,this.array)),t}setW(e,t){return this.normalized&&(t=Wp(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Wp(t,this.array),n=Wp(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Wp(t,this.array),n=Wp(n,this.array),r=Wp(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Wp(t,this.array),n=Wp(n,this.array),r=Wp(r,this.array),s=Wp(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Rp&&(e.usage=this.usage),e}}class Tf extends gm{constructor(e=[],t=301,n,r,s,i,o,a,l,c){super(e,t,n,r,s,i,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Ef{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Rp,this.updateRanges=[],this.version=0,this.uuid=Bp()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Bp()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Bp()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Sf=new Zp;class Af{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Sf.fromBufferAttribute(this,t),Sf.applyMatrix4(e),this.setXYZ(t,Sf.x,Sf.y,Sf.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Sf.fromBufferAttribute(this,t),Sf.applyNormalMatrix(e),this.setXYZ(t,Sf.x,Sf.y,Sf.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Sf.fromBufferAttribute(this,t),Sf.transformDirection(e),this.setXYZ(t,Sf.x,Sf.y,Sf.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Yp(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Wp(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Wp(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Wp(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Wp(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Wp(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Yp(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Yp(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Yp(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Yp(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wp(t,this.array),n=Wp(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wp(t,this.array),n=Wp(n,this.array),r=Wp(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Wp(t,this.array),n=Wp(n,this.array),r=Wp(r,this.array),s=Wp(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new wf(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Af(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const Mf=new Zp,Of=new Zp,Cf=new Jp;class Nf extends gm{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ap,this.minFilter=Ap,this.generateMipmaps=!1,this.needsUpdate=!0}}class Pf extends gm{constructor(e,t,n=1014,r,s,i,o=Ap,a=Ap,l,c=1026,u=1){if(1026!==c&&1027!==c)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},r,s,i,o,a,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new dm(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class Rf{constructor(e,t,n,r){Rf.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}function If(e,t=0){let n=3735928559^t,r=1103547991^t;if(e instanceof Array)for(let s,i=0;i<e.length;i++)s=e[i],n=Math.imul(n^s,2654435761),r=Math.imul(r^s,1597334677);else for(let s,i=0;i<e.length;i++)s=e.charCodeAt(i),n=Math.imul(n^s,2654435761),r=Math.imul(r^s,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"180"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="180");const Lf=(...e)=>If(e);function*kf(e,t=!1){for(const n of Object.getOwnPropertyNames(e)){if(!0===n.startsWith("_"))continue;const r=e[n];if(!0===Array.isArray(r))for(let e=0;e<r.length;e++){const s=r[e];s&&(!0===s.isNode||t&&"function"==typeof s.toJSON)&&(yield{property:n,index:e,childNode:s})}else if(r&&!0===r.isNode)yield{property:n,childNode:r};else if(r&&Object.getPrototypeOf(r)===Object.prototype)for(const e in r){if(!0===e.startsWith("_"))continue;const s=r[e];s&&(!0===s.isNode||t&&"function"==typeof s.toJSON)&&(yield{property:n,index:e,childNode:s})}}}function Df(e){if(null==e)return null;const t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix2?"mat2":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function zf(e,...t){const n=e?e.slice(-4):void 0;return 1===t.length&&("vec2"===n?t=[t[0],t[0]]:"vec3"===n?t=[t[0],t[0],t[0]]:"vec4"===n&&(t=[t[0],t[0],t[0],t[0]])),"color"===e?new yf(...t):"vec2"===n?new Gp(...t):"vec3"===n?new Zp(...t):"vec4"===n?new ym(...t):"mat2"===n?new Rf(...t):"mat3"===n?new Jp(...t):"mat4"===n?new Um(...t):"bool"===e?t[0]||!1:"float"===e||"int"===e||"uint"===e?t[0]||0:"string"===e?t[0]||"":"ArrayBuffer"===e?function(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0)).buffer}(t[0]):null}const Uf="vertex",Ff="none",Bf="frame",Vf="render",jf="object",Hf=["x","y","z","w"],Yf={analyze:"setup",generate:"analyze"};let Wf=0,Xf=class extends kp{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Ff,this.updateBeforeType=Ff,this.updateAfterType=Ff,this.uuid=Xp.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:Wf++})}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,Bf)}onRenderUpdate(e){return this.onUpdate(e,Vf)}onObjectUpdate(e){return this.onUpdate(e,jf)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of kf(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return(!0===(e=e||this.version!==this._cacheKeyVersion)||null===this._cacheKey)&&(this._cacheKey=Lf(function(e,t=!1){const n=[];!0===e.isNode&&n.push(e.id);for(const{property:r,childNode:s}of kf(e))n.push(If(r.slice(0,-4)),s.getCacheKey(t));return If(n)}(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let n=0;for(const r of this.getChildren())t["node"+n++]=r;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(!0===this.parents){const n=e.getDataFromNode(this,"any");n.stages=n.stages||{},n.stages[e.shaderStage]=n.stages[e.shaderStage]||[],n.stages[e.shaderStage].push(t)}if(1===n){const t=e.getNodeProperties(this);for(const n of Object.values(t))n&&!0===n.isNode&&n.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&!0===n.isNode)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);const r=e.getDataFromNode(this);r.buildStages=r.buildStages||{},r.buildStages[e.buildStage]=!0;const s=Yf[e.buildStage];if(s&&!0!==r.buildStages[s]){const t=e.getBuildStage();e.setBuildStage(s),this.build(e),e.setBuildStage(t)}e.addNode(this),e.addChain(this);let i=null;const o=e.getBuildStage();if("setup"===o){this.updateReference(e);const t=e.getNodeProperties(this);if(!0!==t.initialized){t.initialized=!0,t.outputNode=this.setup(e)||t.outputNode||null;for(const n of Object.values(t))if(n&&!0===n.isNode){if(!0===n.parents){const t=e.getNodeProperties(n);t.parents=t.parents||[],t.parents.push(this)}n.build(e)}}i=t.outputNode}else if("analyze"===o)this.analyze(e,t);else if("generate"===o){if(1===this.generate.length){const n=this.getNodeType(e),r=e.getDataFromNode(this);i=r.snippet,void 0===i?void 0===r.generated?(r.generated=!0,i=this.generate(e)||"",r.snippet=i):(console.warn("THREE.Node: Recursion detected.",this),i="/* Recursion detected. */"):void 0!==r.flowCodes&&void 0!==e.context.nodeBlock&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),i=e.format(i,n,t)}else i=this.generate(e,t)||"";""===i&&null!==t&&"void"!==t&&"OutputType"!==t&&(console.error(`THREE.TSL: Invalid generated code, expected a "${t}".`),i=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),i}getSerializeChildren(){return kf(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:s,childNode:i}of t)void 0!==s?(void 0===n[r]&&(n[r]=Number.isInteger(s)?[]:{}),n[r][s]=i.toJSON(e.meta).uuid):n[r]=i.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(void 0!==e.inputNodes){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const s of e.inputNodes[n])r.push(t[s]);this[n]=r}else if("object"==typeof e.inputNodes[n]){const r={};for(const s in e.inputNodes[n]){const i=e.inputNodes[n][s];r[s]=t[i]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=void 0===e||"string"==typeof e;r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];function i(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(void 0===s&&(s={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},!0!==r&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta),r){const t=i(e.textures),n=i(e.images),r=i(e.nodes);t.length>0&&(s.textures=t),n.length>0&&(s.images=n),r.length>0&&(s.nodes=r)}return s}};class Gf extends Xf{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.indexNode.getNodeType(e);return`${this.node.build(e)}[ ${this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint")} ]`}}class qf extends Xf{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))(null===n||e.getTypeLength(t)===e.getTypeLength(r))&&(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),s=n.build(e,r);return e.format(s,r,t)}}class Zf extends Xf{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){const n=e.getVectorType(this.getNodeType(e,t)),r=e.getDataFromNode(this);if(void 0!==r.propertyName)return e.format(r.propertyName,n,t);if("void"!==n&&"void"!==t&&this.hasDependencies(e)){const s=super.build(e,n),i=e.getVarFromNode(this,null,n),o=e.getPropertyName(i);return e.addLineFlowCode(`${o} = ${s}`,this),r.snippet=s,r.propertyName=o,e.format(r.propertyName,n,t)}}return super.build(e,t)}}class Kf extends Zf{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),r=e.getTypeLength(n),s=this.nodes,i=e.getComponentType(n),o=[];let a=0;for(const c of s){if(a>=r){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let t,s=c.getNodeType(e),l=e.getTypeLength(s);if(a+l>r&&(console.error(`THREE.TSL: Length of '${n}()' data exceeds maximum length of output type.`),l=r-a,s=e.getTypeFromLength(l)),a+=l,t=c.build(e,s),e.getComponentType(s)!==i){const n=e.getTypeFromLength(l,i);t=e.format(t,s,n)}o.push(t)}const l=`${e.getType(n)}( ${o.join(", ")} )`;return e.format(l,n,t)}}const Qf=Hf.join("");class Jf extends Xf{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Hf.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let s=null;if(r>1){let i=null;this.getVectorLength()>=r&&(i=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const o=n.build(e,i);s=this.components.length===r&&this.components===Qf.slice(0,this.components.length)?e.format(o,i,t):e.format(`${o}.${this.components}`,this.getNodeType(e),t)}else s=n.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class $f extends Zf{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,s=this.getNodeType(e),i=e.getComponentType(r.getNodeType(e)),o=e.getTypeFromLength(n.length,i),a=r.build(e,o),l=t.build(e,s),c=e.getTypeLength(s),u=[];for(let h=0;h<c;h++){const e=Hf[h];e===n[0]?(u.push(a),h+=n.length-1):u.push(l+"."+e)}return`${e.getType(s)}( ${u.join(", ")} )`}}class eg extends Zf{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),s=n.build(e),i=e.getVarFromNode(this),o=e.getPropertyName(i);e.addLineFlowCode(o+" = "+s,this);const a=e.getTypeLength(r),l=[];let c=0;for(let u=0;u<a;u++){const e=Hf[u];e===t[c]?(l.push("1.0 - "+o+"."+e),c++):l.push(o+"."+e)}return`${e.getType(r)}( ${l.join(", ")} )`}}class tg extends Xf{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return null===this.nodeType?Df(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Df(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?zf(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const ng=/float|u?int/;class rg extends tg{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return ng.test(n)&&ng.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class sg extends Xf{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return(!this.structNode.isMemberNode||!1!==this.structNode.hasMember(e))&&"void"!==this.structNode.getMemberType(e,this.property)}getNodeType(e){return!1===this.hasMember(e)?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(!1===this.hasMember(e))return"float";const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}generate(e){if(!1===this.hasMember(e)){console.warn(`THREE.TSL: Member "${this.property}" does not exist in struct.`);const t=this.getNodeType(e);return e.generateConst(t)}return this.structNode.build(e)+"."+this.property}}const ig=new Map;function og(e,t){if(ig.has(e))console.warn(`THREE.TSL: Redefinition of method chaining '${e}'.`);else{if("function"!=typeof t)throw new Error(`THREE.TSL: Node element ${e} is not a function`);ig.set(e,t),"assign"!==e&&(Xf.prototype[e]=function(...e){return this.isStackNode?this.add(t(...e)):t(this,...e)},Xf.prototype[e+"Assign"]=function(...e){return this.isStackNode?this.assign(e[0],t(...e)):this.assign(t(this,...e))})}}const ag=e=>(e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"))(e).split("").sort().join("");Xf.prototype.assign=function(...e){if(!0!==this.isStackNode)return console.error("THREE.TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{const t=ig.get("assign");return this.add(t(...e))}},Xf.prototype.toVarIntent=function(){return this},Xf.prototype.get=function(e){return new sg(this,e)};const lg={};function cg(e,t,n){lg[e]=lg[t]=lg[n]={get(){this._cache=this._cache||{};let t=this._cache[e];return void 0===t&&(t=new Jf(this,e),this._cache[e]=t),t},set(t){this[e].assign(Ig(t))}};const r=e.toUpperCase(),s=t.toUpperCase(),i=n.toUpperCase();Xf.prototype["set"+r]=Xf.prototype["set"+s]=Xf.prototype["set"+i]=function(t){const n=ag(e);return new $f(this,n,Ig(t))},Xf.prototype["flip"+r]=Xf.prototype["flip"+s]=Xf.prototype["flip"+i]=function(){const t=ag(e);return new eg(this,t)}}const ug=["x","y","z","w"],hg=["r","g","b","a"],dg=["s","t","p","q"];for(let ME=0;ME<4;ME++){let e=ug[ME],t=hg[ME],n=dg[ME];cg(e,t,n);for(let r=0;r<4;r++){e=ug[ME]+ug[r],t=hg[ME]+hg[r],n=dg[ME]+dg[r],cg(e,t,n);for(let s=0;s<4;s++){e=ug[ME]+ug[r]+ug[s],t=hg[ME]+hg[r]+hg[s],n=dg[ME]+dg[r]+dg[s],cg(e,t,n);for(let i=0;i<4;i++)e=ug[ME]+ug[r]+ug[s]+ug[i],t=hg[ME]+hg[r]+hg[s]+hg[i],n=dg[ME]+dg[r]+dg[s]+dg[i],cg(e,t,n)}}}for(let ME=0;ME<32;ME++)lg[ME]={get(){this._cache=this._cache||{};let e=this._cache[ME];return void 0===e&&(e=new Gf(this,new rg(ME,"uint")),this._cache[ME]=e),e},set(e){this[ME].assign(Ig(e))}};Object.defineProperties(Xf.prototype,lg);const pg=new WeakMap,mg=function(e,t=null){for(const n in e)e[n]=Ig(e[n],t);return e},fg=function(e,t=null){const n=e.length;for(let r=0;r<n;r++)e[r]=Ig(e[r],t);return e},gg=function(e,t=null,n=null,r=null){function s(e){return null!==r?(e=Ig(Object.assign(e,r)),!0===r.intent&&(e=e.toVarIntent())):e=Ig(e),e}let i,o,a,l=t;function c(t){let n;return n=l?/[a-z]/i.test(l)?l+"()":l:e.type,void 0!==o&&t.length<o?(console.error(`THREE.TSL: "${n}" parameter length is less than minimum required.`),t.concat(new Array(o-t.length).fill(0))):void 0!==a&&t.length>a?(console.error(`THREE.TSL: "${n}" parameter length exceeds limit.`),t.slice(0,a)):t}return null===t?i=(...t)=>s(new e(...Dg(c(t)))):null!==n?(n=Ig(n),i=(...r)=>s(new e(t,...Dg(c(r)),n))):i=(...n)=>s(new e(t,...Dg(c(n)))),i.setParameterLength=(...e)=>(1===e.length?o=a=e[0]:2===e.length&&([o,a]=e),i),i.setName=e=>(l=e,i),i},yg=function(e,...t){return Ig(new e(...Dg(t)))};class vg extends Xf{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:n}=this,r=e.getNodeProperties(t),s=e.getClosestSubBuild(t.subBuilds)||"",i=s||"default";if(r[i])return r[i];const o=e.subBuildFn;e.subBuildFn=s;let a=null;if(t.layout){let r=pg.get(e.constructor);void 0===r&&(r=new WeakMap,pg.set(e.constructor,r));let s=r.get(t);void 0===s&&(s=Ig(e.buildFunctionNode(t)),r.set(t,s)),e.addInclude(s);const i=n?function(e){let t;return kg(e),t=e[0]&&(e[0].isNode||Object.getPrototypeOf(e[0])!==Object.prototype)?[...e]:e[0],t}(n):null;a=Ig(s.call(i))}else{const r=new Proxy(e,{get:(e,t,n)=>{let r;return r=Symbol.iterator===t?function*(){yield}:Reflect.get(e,t,n),r}}),s=n?function(e){let t=0;return kg(e),new Proxy(e,{get:(n,r,s)=>{let i;if("length"===r)return i=e.length,i;if(Symbol.iterator===r)i=function*(){for(const t of e)yield Ig(t)};else{if(e.length>0)if(Object.getPrototypeOf(e[0])===Object.prototype){const n=e[0];i=void 0===n[r]?n[t++]:Reflect.get(n,r,s)}else e[0]instanceof Xf&&(i=void 0===e[r]?e[t++]:Reflect.get(e,r,s));else i=Reflect.get(n,r,s);i=Ig(i)}return i}})}(n):null,i=Array.isArray(n)?n.length>0:null!==n,o=t.jsFunc,l=i||o.length>1?o(s,r):o(r);a=Ig(l)}return e.subBuildFn=o,t.once&&(r[i]=a),a}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getSubBuildOutput(this);return t[n]=t[n]||this.setupOutput(e),t[n].subBuild=e.getClosestSubBuild(this),t[n]}build(e,t=null){let n=null;const r=e.getBuildStage(),s=e.getNodeProperties(this),i=e.getSubBuildOutput(this),o=this.getOutputNode(e);if("setup"===r){const t=e.getSubBuildProperty("initialized",this);if(!0!==s[t]&&(s[t]=!0,s[i]=this.getOutputNode(e),s[i].build(e),this.shaderNode.subBuilds))for(const n of e.chaining){const t=e.getDataFromNode(n,"any");t.subBuilds=t.subBuilds||new Set;for(const e of this.shaderNode.subBuilds)t.subBuilds.add(e)}n=s[i]}else"analyze"===r?o.build(e,t):"generate"===r&&(n=o.build(e,t)||"");return n}}class xg extends Xf{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return Ig(new vg(this,e))}setup(){return this.call()}}const bg=[!1,!0],_g=[0,1,2,3],wg=[-1,-2],Tg=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],Eg=new Map;for(const ME of bg)Eg.set(ME,new rg(ME));const Sg=new Map;for(const ME of _g)Sg.set(ME,new rg(ME,"uint"));const Ag=new Map([...Sg].map(e=>new rg(e.value,"int")));for(const ME of wg)Ag.set(ME,new rg(ME,"int"));const Mg=new Map([...Ag].map(e=>new rg(e.value)));for(const ME of Tg)Mg.set(ME,new rg(ME));for(const ME of Tg)Mg.set(-ME,new rg(-ME));const Og={bool:Eg,uint:Sg,ints:Ag,float:Mg},Cg=new Map([...Eg,...Mg]),Ng=(e,t)=>Cg.has(e)?Cg.get(e):!0===e.isNode?e:new rg(e,t),Pg=function(e,t=null){return(...n)=>{for(const t of n)if(void 0===t)return console.error(`THREE.TSL: Invalid parameter for the type "${e}".`),Ig(new rg(0,e));if((0===n.length||!["bool","float","int","uint"].includes(e)&&n.every(e=>{const t=typeof e;return"object"!==t&&"function"!==t}))&&(n=[zf(e,...n)]),1===n.length&&null!==t&&t.has(n[0]))return Lg(t.get(n[0]));if(1===n.length){const t=Ng(n[0],e);return t.nodeType===e?Lg(t):Lg(new qf(t,e))}const r=n.map(e=>Ng(e));return Lg(new Kf(r,e))}};function Rg(e,t){return new xg(e,t)}const Ig=(e,t=null)=>function(e,t=null){const n=Df(e);return"node"===n?e:null===t&&("float"===n||"boolean"===n)||n&&"shader"!==n&&"string"!==n?Ig(Ng(e,t)):"shader"===n?e.isFn?e:jg(e):e}(e,t),Lg=(e,t=null)=>Ig(e,t).toVarIntent(),kg=(e,t=null)=>new mg(e,t),Dg=(e,t=null)=>new fg(e,t),zg=(e,t=null,n=null,r=null)=>new gg(e,t,n,r),Ug=(e,...t)=>new yg(e,...t),Fg=(e,t=null,n=null,r={})=>new gg(e,t,n,{intent:!0,...r});let Bg=0;class Vg extends Xf{constructor(e,t=null){super();let n=null;null!==t&&("object"==typeof t?n=t.return:("string"==typeof t?n=t:console.error("THREE.TSL: Invalid layout type."),t=null)),this.shaderNode=new Rg(e,n),null!==t&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if("object"!=typeof e.inputs){const n={name:"fn"+Bg++,type:t,inputs:[]};for(const t in e)"return"!==t&&n.inputs.push({name:t,type:e[t]});e=n}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return"void"===this.shaderNode.nodeType&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return console.error('THREE.TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(t)}}function jg(e,t=null){const n=new Vg(e,t);return new Proxy(()=>{},{apply:(e,t,r)=>n.call(...r),get:(e,t,r)=>Reflect.get(n,t,r),set:(e,t,r,s)=>Reflect.set(n,t,r,s)})}const Hg=(...e)=>null.If(...e);function Yg(e){return e}og("toStack",Yg);const Wg=new Pg("color"),Xg=new Pg("float",Og.float),Gg=new Pg("int",Og.ints),qg=new Pg("uint",Og.uint),Zg=new Pg("bool",Og.bool),Kg=new Pg("vec2"),Qg=new Pg("ivec2"),Jg=new Pg("uvec2"),$g=new Pg("bvec2"),ey=new Pg("vec3"),ty=new Pg("ivec3"),ny=new Pg("uvec3"),ry=new Pg("bvec3"),sy=new Pg("vec4"),iy=new Pg("ivec4"),oy=new Pg("uvec4"),ay=new Pg("bvec4"),ly=new Pg("mat2"),cy=new Pg("mat3"),uy=new Pg("mat4");og("toColor",Wg),og("toFloat",Xg),og("toInt",Gg),og("toUint",qg),og("toBool",Zg),og("toVec2",Kg),og("toIVec2",Qg),og("toUVec2",Jg),og("toBVec2",$g),og("toVec3",ey),og("toIVec3",ty),og("toUVec3",ny),og("toBVec3",ry),og("toVec4",sy),og("toIVec4",iy),og("toUVec4",oy),og("toBVec4",ay),og("toMat2",ly),og("toMat3",cy),og("toMat4",uy);og("element",zg(Gf).setParameterLength(2)),og("convert",(e,t)=>Ig(new qf(Ig(e),t))),og("append",e=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),e));class hy extends Xf{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const dy=(e,t)=>Ig(new hy(e,t)),py=Ug(hy,"vec4","DiffuseColor"),my=Ug(hy,"vec4","Output");class fy extends Xf{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const gy=e=>new fy(e),yy=(e,t=0)=>new fy(e,!0,t),vy=yy("render"),xy=gy("object");class by extends tg{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=xy}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(t=>{const n=e(t,this);void 0!==n&&(this.value=n)},t)}getInputType(e){let t=super.getInputType(e);return"bool"===t&&(t="uint"),t}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);void 0===s&&(e.setHashNode(this,r),s=this);const i=s.getInputType(e),o=e.getUniformFromNode(s,i,e.shaderStage,this.name||e.context.nodeName),a=e.getPropertyName(o);void 0!==e.context.nodeName&&delete e.context.nodeName;let l=a;if("bool"===n){const t=e.getDataFromNode(this);let r=t.propertyName;if(void 0===r){const s=e.getVarFromNode(this,null,"bool");r=e.getPropertyName(s),t.propertyName=r,l=e.format(a,i,n),e.addLineFlowCode(`${r} = ${l}`,this)}l=r}return e.format(l,n,t)}}const _y=(e,t)=>{const n=(e=>null!=e?e.nodeType||e.convertTo||("string"==typeof e?e:null):null)(t||e);return n===e&&(e=zf(n)),e=e&&!0===e.isNode?e.node&&e.node.value||e.value:e,Ig(new by(e,n))};class wy extends Zf{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return null===this.nodeType&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}og("toArray",(e,t)=>((...e)=>{let t;if(1===e.length){const n=e[0];t=new wy(null,n.length,n)}else{const n=e[0],r=e[1];t=new wy(n,r)}return Ig(t)})(Array(t).fill(e)));class Ty extends Zf{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return Hf.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,r=t.getScope();e.getNodeProperties(r).assign=!0;const s=e.getNodeProperties(this);s.sourceNode=n,s.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:r}=e.getNodeProperties(this),s=this.needsSplitAssign(e),i=n.build(e),o=n.getNodeType(e),a=r.build(e,o),l=r.getNodeType(e),c=e.getDataFromNode(this);let u;if(!0===c.initialized)"void"!==t&&(u=i);else if(s){const r=e.getVarFromNode(this,null,o),s=e.getPropertyName(r);e.addLineFlowCode(`${s} = ${a}`,this);const l=n.node,c=l.node.context({assign:!0}).build(e);for(let t=0;t<l.components.length;t++){const n=l.components[t];e.addLineFlowCode(`${c}.${n} = ${s}[ ${t} ]`,this)}"void"!==t&&(u=i)}else u=`${i} = ${a}`,("void"===t||"void"===l)&&(e.addLineFlowCode(u,this),"void"!==t&&(u=i));return c.initialized=!0,e.format(u,o,t)}}og("assign",zg(Ty).setParameterLength(2));class Ey extends Zf{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),s=this.parameters,i=(t,n)=>{const r=n.type;let s;return s="pointer"===r?"&"+t.build(e):t.build(e,r),s};if(Array.isArray(s)){if(s.length>r.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=r.length;else if(s.length<r.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<r.length;)s.push(Xg(0));for(let e=0;e<s.length;e++)t.push(i(s[e],r[e]))}else for(const o of r){const e=s[o.name];void 0!==e?t.push(i(e,o)):(console.error(`THREE.TSL: Input '${o.name}' not found in 'Fn()'.`),t.push(i(Xg(0),o)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}og("call",(e,...t)=>(t=t.length>1||t[0]&&!0===t[0].isNode?Dg(t):kg(t[0]),Ig(new Ey(Ig(e),t))));const Sy={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class Ay extends Zf{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let s=new Ay(e,t,n);for(let t=0;t<r.length-1;t++)s=new Ay(e,s,r[t]);t=s,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(Sy[this.op],t)}getNodeType(e,t=null){const n=this.op,r=this.aNode,s=this.bNode,i=r.getNodeType(e),o=s?s.getNodeType(e):null;if("void"===i||"void"===o)return t||"void";if("%"===n)return i;if("~"===n||"&"===n||"|"===n||"^"===n||">>"===n||"<<"===n)return e.getIntegerType(i);if("!"===n||"&&"===n||"||"===n||"^^"===n)return"bool";if("=="===n||"!="===n||"<"===n||">"===n||"<="===n||">="===n){const t=Math.max(e.getTypeLength(i),e.getTypeLength(o));return t>1?`bvec${t}`:"bool"}if(e.isMatrix(i)){if("float"===o)return i;if(e.isVector(o))return e.getVectorFromMatrix(i);if(e.isMatrix(o))return i}else if(e.isMatrix(o)){if("float"===i)return o;if(e.isVector(i))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(i)?o:i}generate(e,t){const n=this.op,{aNode:r,bNode:s}=this,i=this.getNodeType(e,t);let o=null,a=null;"void"!==i?(o=r.getNodeType(e),a=s?s.getNodeType(e):null,"<"===n||">"===n||"<="===n||">="===n||"=="===n||"!="===n?e.isVector(o)?a=o:e.isVector(a)?o=a:o!==a&&(o=a="float"):">>"===n||"<<"===n?(o=i,a=e.changeComponentType(a,"uint")):"%"===n?(o=i,a=e.isInteger(o)&&e.isInteger(a)?a:o):e.isMatrix(o)?"float"===a?a="float":e.isVector(a)?a=e.getVectorFromMatrix(o):e.isMatrix(a)||(o=a=i):o=e.isMatrix(a)?"float"===o?"float":e.isVector(o)?e.getVectorFromMatrix(a):a=i:a=i):o=a=i;const l=r.build(e,o),c=s?s.build(e,a):null,u=e.getFunctionOperator(n);if("void"!==t){const r=e.renderer.coordinateSystem===Ip;if("=="===n||"!="===n||"<"===n||">"===n||"<="===n||">="===n)return r&&e.isVector(o)?e.format(`${this.getOperatorMethod(e,t)}( ${l}, ${c} )`,i,t):e.format(`( ${l} ${n} ${c} )`,i,t);if("%"===n)return e.isInteger(a)?e.format(`( ${l} % ${c} )`,i,t):e.format(`${this.getOperatorMethod(e,i)}( ${l}, ${c} )`,i,t);if("!"===n||"~"===n)return e.format(`(${n}${l})`,o,t);if(u)return e.format(`${u}( ${l}, ${c} )`,i,t);if(e.isMatrix(o)&&"float"===a)return e.format(`( ${c} ${n} ${l} )`,i,t);if("float"===o&&e.isMatrix(a))return e.format(`${l} ${n} ${c}`,i,t);{let s=`( ${l} ${n} ${c} )`;return!r&&"bool"===i&&e.isVector(o)&&e.isVector(a)&&(s=`all${s}`),e.format(s,i,t)}}if("void"!==o)return u?e.format(`${u}( ${l}, ${c} )`,i,t):e.isMatrix(o)&&"float"===a?e.format(`${c} ${n} ${l}`,i,t):e.format(`${l} ${n} ${c}`,i,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const My=Fg(Ay,"+").setParameterLength(2,1/0).setName("add"),Oy=Fg(Ay,"-").setParameterLength(2,1/0).setName("sub"),Cy=Fg(Ay,"*").setParameterLength(2,1/0).setName("mul"),Ny=Fg(Ay,"/").setParameterLength(2,1/0).setName("div"),Py=Fg(Ay,"%").setParameterLength(2).setName("mod"),Ry=Fg(Ay,"==").setParameterLength(2).setName("equal"),Iy=Fg(Ay,"!=").setParameterLength(2).setName("notEqual"),Ly=Fg(Ay,"<").setParameterLength(2).setName("lessThan"),ky=Fg(Ay,">").setParameterLength(2).setName("greaterThan"),Dy=Fg(Ay,"<=").setParameterLength(2).setName("lessThanEqual"),zy=Fg(Ay,">=").setParameterLength(2).setName("greaterThanEqual"),Uy=Fg(Ay,"&&").setParameterLength(2,1/0).setName("and"),Fy=Fg(Ay,"||").setParameterLength(2,1/0).setName("or"),By=Fg(Ay,"!").setParameterLength(1).setName("not"),Vy=Fg(Ay,"^^").setParameterLength(2).setName("xor"),jy=Fg(Ay,"&").setParameterLength(2).setName("bitAnd"),Hy=Fg(Ay,"~").setParameterLength(2).setName("bitNot"),Yy=Fg(Ay,"|").setParameterLength(2).setName("bitOr"),Wy=Fg(Ay,"^").setParameterLength(2).setName("bitXor"),Xy=Fg(Ay,"<<").setParameterLength(2).setName("shiftLeft"),Gy=Fg(Ay,">>").setParameterLength(2).setName("shiftRight"),qy=jg(([e])=>(e.addAssign(1),e)),Zy=jg(([e])=>(e.subAssign(1),e)),Ky=jg(([e])=>{const t=Gg(e).toConst();return e.addAssign(1),t}),Qy=jg(([e])=>{const t=Gg(e).toConst();return e.subAssign(1),t});og("add",My),og("sub",Oy),og("mul",Cy),og("div",Ny),og("mod",Py),og("equal",Ry),og("notEqual",Iy),og("lessThan",Ly),og("greaterThan",ky),og("lessThanEqual",Dy),og("greaterThanEqual",zy),og("and",Uy),og("or",Fy),og("not",By),og("xor",Vy),og("bitAnd",jy),og("bitNot",Hy),og("bitOr",Yy),og("bitXor",Wy),og("shiftLeft",Xy),og("shiftRight",Gy),og("incrementBefore",qy),og("decrementBefore",Zy),og("increment",Ky),og("decrement",Qy);og("modInt",(e,t)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),Py(Gg(e),Gg(t))));class Jy extends Zf{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){if(super(),(e===Jy.MAX||e===Jy.MIN)&&arguments.length>3){let s=new Jy(e,t,n);for(let t=2;t<arguments.length-1;t++)s=new Jy(e,s,arguments[t]);t=s,n=arguments[arguments.length-1],r=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=r,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),i=e.isMatrix(n)?0:e.getTypeLength(n),o=e.isMatrix(r)?0:e.getTypeLength(r);return s>i&&s>o?t:i>o?n:o>s?r:t}getNodeType(e){const t=this.method;return t===Jy.LENGTH||t===Jy.DISTANCE||t===Jy.DOT?"float":t===Jy.CROSS?"vec3":t===Jy.ALL||t===Jy.ANY?"bool":t===Jy.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:r}=this;let s=null;if(r===Jy.ONE_MINUS)s=Oy(1,t);else if(r===Jy.RECIPROCAL)s=Ny(1,t);else if(r===Jy.DIFFERENCE)s=bv(Oy(t,n));else if(r===Jy.TRANSFORM_DIRECTION){let r=t,i=n;e.isMatrix(r.getNodeType(e))?i=sy(ey(i),0):r=sy(ey(r),0);const o=Cy(r,i).xyz;s=dv(o)}return null!==s?s:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let n=this.method;const r=this.getNodeType(e),s=this.getInputType(e),i=this.aNode,o=this.bNode,a=this.cNode,l=e.renderer.coordinateSystem;if(n===Jy.NEGATE)return e.format("( - "+i.build(e,s)+" )",r,t);{const c=[];return n===Jy.CROSS?c.push(i.build(e,r),o.build(e,r)):l===Ip&&n===Jy.STEP?c.push(i.build(e,1===e.getTypeLength(i.getNodeType(e))?"float":s),o.build(e,s)):l!==Ip||n!==Jy.MIN&&n!==Jy.MAX?n===Jy.REFRACT?c.push(i.build(e,s),o.build(e,s),a.build(e,"float")):n===Jy.MIX?c.push(i.build(e,s),o.build(e,s),a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":s)):(l===Lp&&n===Jy.ATAN&&null!==o&&(n="atan2"),"fragment"!==e.shaderStage&&(n===Jy.DFDX||n===Jy.DFDY)&&(console.warn(`THREE.TSL: '${n}' is not supported in the ${e.shaderStage} stage.`),n="/*"+n+"*/"),c.push(i.build(e,s)),null!==o&&c.push(o.build(e,s)),null!==a&&c.push(a.build(e,s))):c.push(i.build(e,s),o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":s)),e.format(`${e.getMethod(n,r)}( ${c.join(", ")} )`,r,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Jy.ALL="all",Jy.ANY="any",Jy.RADIANS="radians",Jy.DEGREES="degrees",Jy.EXP="exp",Jy.EXP2="exp2",Jy.LOG="log",Jy.LOG2="log2",Jy.SQRT="sqrt",Jy.INVERSE_SQRT="inversesqrt",Jy.FLOOR="floor",Jy.CEIL="ceil",Jy.NORMALIZE="normalize",Jy.FRACT="fract",Jy.SIN="sin",Jy.COS="cos",Jy.TAN="tan",Jy.ASIN="asin",Jy.ACOS="acos",Jy.ATAN="atan",Jy.ABS="abs",Jy.SIGN="sign",Jy.LENGTH="length",Jy.NEGATE="negate",Jy.ONE_MINUS="oneMinus",Jy.DFDX="dFdx",Jy.DFDY="dFdy",Jy.ROUND="round",Jy.RECIPROCAL="reciprocal",Jy.TRUNC="trunc",Jy.FWIDTH="fwidth",Jy.TRANSPOSE="transpose",Jy.DETERMINANT="determinant",Jy.INVERSE="inverse",Jy.EQUALS="equals",Jy.MIN="min",Jy.MAX="max",Jy.STEP="step",Jy.REFLECT="reflect",Jy.DISTANCE="distance",Jy.DIFFERENCE="difference",Jy.DOT="dot",Jy.CROSS="cross",Jy.POW="pow",Jy.TRANSFORM_DIRECTION="transformDirection",Jy.MIX="mix",Jy.CLAMP="clamp",Jy.REFRACT="refract",Jy.SMOOTHSTEP="smoothstep",Jy.FACEFORWARD="faceforward";const $y=Xg(Math.PI),ev=Fg(Jy,Jy.ALL).setParameterLength(1),tv=Fg(Jy,Jy.ANY).setParameterLength(1),nv=Fg(Jy,Jy.RADIANS).setParameterLength(1),rv=Fg(Jy,Jy.DEGREES).setParameterLength(1),sv=Fg(Jy,Jy.EXP).setParameterLength(1),iv=Fg(Jy,Jy.EXP2).setParameterLength(1),ov=Fg(Jy,Jy.LOG).setParameterLength(1),av=Fg(Jy,Jy.LOG2).setParameterLength(1),lv=Fg(Jy,Jy.SQRT).setParameterLength(1),cv=Fg(Jy,Jy.INVERSE_SQRT).setParameterLength(1),uv=Fg(Jy,Jy.FLOOR).setParameterLength(1),hv=Fg(Jy,Jy.CEIL).setParameterLength(1),dv=Fg(Jy,Jy.NORMALIZE).setParameterLength(1),pv=Fg(Jy,Jy.FRACT).setParameterLength(1),mv=Fg(Jy,Jy.SIN).setParameterLength(1),fv=Fg(Jy,Jy.COS).setParameterLength(1),gv=Fg(Jy,Jy.TAN).setParameterLength(1),yv=Fg(Jy,Jy.ASIN).setParameterLength(1),vv=Fg(Jy,Jy.ACOS).setParameterLength(1),xv=Fg(Jy,Jy.ATAN).setParameterLength(1,2),bv=Fg(Jy,Jy.ABS).setParameterLength(1),_v=Fg(Jy,Jy.SIGN).setParameterLength(1),wv=Fg(Jy,Jy.LENGTH).setParameterLength(1),Tv=Fg(Jy,Jy.NEGATE).setParameterLength(1),Ev=Fg(Jy,Jy.ONE_MINUS).setParameterLength(1),Sv=Fg(Jy,Jy.DFDX).setParameterLength(1),Av=Fg(Jy,Jy.DFDY).setParameterLength(1),Mv=Fg(Jy,Jy.ROUND).setParameterLength(1),Ov=Fg(Jy,Jy.RECIPROCAL).setParameterLength(1),Cv=Fg(Jy,Jy.TRUNC).setParameterLength(1),Nv=Fg(Jy,Jy.FWIDTH).setParameterLength(1),Pv=Fg(Jy,Jy.TRANSPOSE).setParameterLength(1),Rv=Fg(Jy,Jy.DETERMINANT).setParameterLength(1),Iv=Fg(Jy,Jy.INVERSE).setParameterLength(1),Lv=Fg(Jy,Jy.MIN).setParameterLength(2,1/0),kv=Fg(Jy,Jy.MAX).setParameterLength(2,1/0),Dv=Fg(Jy,Jy.STEP).setParameterLength(2),zv=Fg(Jy,Jy.REFLECT).setParameterLength(2),Uv=Fg(Jy,Jy.DISTANCE).setParameterLength(2),Fv=Fg(Jy,Jy.DIFFERENCE).setParameterLength(2),Bv=Fg(Jy,Jy.DOT).setParameterLength(2),Vv=Fg(Jy,Jy.CROSS).setParameterLength(2),jv=Fg(Jy,Jy.POW).setParameterLength(2),Hv=Fg(Jy,Jy.TRANSFORM_DIRECTION).setParameterLength(2),Yv=e=>Bv(e,e),Wv=Fg(Jy,Jy.MIX).setParameterLength(3),Xv=(e,t=0,n=1)=>Ig(new Jy(Jy.CLAMP,Ig(e),Ig(t),Ig(n))),Gv=Fg(Jy,Jy.REFRACT).setParameterLength(3),qv=Fg(Jy,Jy.SMOOTHSTEP).setParameterLength(3),Zv=Fg(Jy,Jy.FACEFORWARD).setParameterLength(3),Kv=jg(([e])=>{const t=Bv(e.xy,Kg(12.9898,78.233)),n=Py(t,$y);return pv(mv(n).mul(43758.5453))});og("all",ev),og("any",tv),og("equals",(e,t)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),Ry(e,t))),og("radians",nv),og("degrees",rv),og("exp",sv),og("exp2",iv),og("log",ov),og("log2",av),og("sqrt",lv),og("inverseSqrt",cv),og("floor",uv),og("ceil",hv),og("normalize",dv),og("fract",pv),og("sin",mv),og("cos",fv),og("tan",gv),og("asin",yv),og("acos",vv),og("atan",xv),og("abs",bv),og("sign",_v),og("length",wv),og("lengthSq",Yv),og("negate",Tv),og("oneMinus",Ev),og("dFdx",Sv),og("dFdy",Av),og("round",Mv),og("reciprocal",Ov),og("trunc",Cv),og("fwidth",Nv),og("atan2",(e,t)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),xv(e,t))),og("min",Lv),og("max",kv),og("step",(e,t)=>Dv(t,e)),og("reflect",zv),og("distance",Uv),og("dot",Bv),og("cross",Vv),og("pow",jv),og("pow2",e=>Cy(e,e)),og("pow3",e=>Cy(e,e,e)),og("pow4",e=>Cy(e,e,e,e)),og("transformDirection",Hv),og("mix",(e,t,n)=>Wv(t,n,e)),og("clamp",Xv),og("refract",Gv),og("smoothstep",(e,t,n)=>qv(t,n,e)),og("faceForward",Zv),og("difference",Fv),og("saturate",e=>Xv(e)),og("cbrt",e=>Cy(_v(e),jv(bv(e),1/3))),og("transpose",Pv),og("determinant",Rv),og("inverse",Iv),og("rand",Kv);class Qv extends Xf{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(void 0===t)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const r=t.getNodeType(e);if(null!==n){const t=n.getNodeType(e);if(e.getTypeLength(t)>e.getTypeLength(r))return t}return r}setup(e){const t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,s=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=s,null!==r&&(e.getDataFromNode(r).parentNodeBlock=s);const i=e.context.uniformFlow,o=e.getNodeProperties(this);o.condNode=t,o.ifNode=i?n:n.context({nodeBlock:n}),o.elseNode=r?i?r:r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(void 0!==r.nodeProperty)return r.nodeProperty;const{condNode:s,ifNode:i,elseNode:o}=e.getNodeProperties(this),a=e.currentFunctionNode,l="void"!==t,c=l?dy(n).build(e):"";r.nodeProperty=c;const u=s.build(e,"bool");if(e.context.uniformFlow&&null!==o){const r=i.build(e,n),s=o.build(e,n),a=e.getTernary(u,r,s);return e.format(a,n,t)}e.addFlowCode(`\n${e.tab}if ( ${u} ) {\n\n`).addFlowTab();let h=i.build(e,n);if(h&&(l?h=c+" = "+h+";":(h="return "+h+";",null===a&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),h="// "+h))),e.removeFlowTab().addFlowCode(e.tab+"\t"+h+"\n\n"+e.tab+"}"),null!==o){e.addFlowCode(" else {\n\n").addFlowTab();let t=o.build(e,n);t&&(l?t=c+" = "+t+";":(t="return "+t+";",null===a&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),t="// "+t))),e.removeFlowTab().addFlowCode(e.tab+"\t"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(c,n,t)}}const Jv=zg(Qv).setParameterLength(2,3);og("select",Jv);class $v extends Xf{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value}),this.node.build(e),e.setContext(t)}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(n),r}}const ex=zg($v).setParameterLength(1,2),tx=(e,t)=>ex(e,{nodeName:t});og("context",ex),og("label",function(e,t){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),tx(e,t)}),og("uniformFlow",e=>ex(e,{uniformFlow:!0})),og("setName",tx);class nx extends Xf{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}build(...e){return!0===this.intent&&!0!==e[0].getNodeProperties(this).assign?this.node.build(...e):super.build(...e)}generate(e){const{node:t,name:n,readOnly:r}=this,{renderer:s}=e,i=!0===s.backend.isWebGPUBackend;let o=!1,a=!1;r&&(o=e.isDeterministic(t),a=i?r:o);const l=e.getVectorType(this.getNodeType(e)),c=t.build(e,l),u=e.getVarFromNode(this,n,l,void 0,a),h=e.getPropertyName(u);let d=h;if(a)if(i)d=o?`const ${h}`:`let ${h}`;else{const n=t.getArrayCount(e);d=`const ${e.getVar(u.type,h,n)}`}return e.addLineFlowCode(`${d} = ${c}`,this),h}}const rx=zg(nx);og("toVar",(e,t=null)=>rx(e,t).toStack()),og("toConst",(e,t=null)=>rx(e,t,!0).toStack()),og("toVarIntent",e=>e);class sx extends Xf{static get type(){return"SubBuild"}constructor(e,t,n=null){super(n),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(null!==this.nodeType)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const n=this.node.build(e,...t);return e.removeSubBuild(),n}}class ix extends Xf{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(void 0===n){const r=this.name,s=this.getNodeType(e),i=this.interpolationType,o=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,r,s,i,o),t.node=((e,t,n=null)=>Ig(new sx(Ig(e),t,n)))(this.node,"VERTEX")}return n.needsInterpolation||(n.needsInterpolation="fragment"===e.shaderStage),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(Uf,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(Uf,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),n=e.getNodeProperties(this),r=this.setupVarying(e);if(void 0===n[t]){const s=this.getNodeType(e),i=e.getPropertyName(r,Uf);e.flowNodeFromShaderStage(Uf,n.node,s,i),n[t]=i}return e.getPropertyName(r)}}const ox=zg(ix).setParameterLength(1,2);og("toVarying",ox),og("toVertexStage",e=>ox(e)),og("varying",(...e)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),ox(...e))),og("vertexStage",(...e)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),ox(...e)));const ax=jg(([e])=>{const t=e.mul(.9478672986).add(.0521327014).pow(2.4),n=e.mul(.0773993808),r=e.lessThanEqual(.04045);return Wv(t,n,r)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),lx=jg(([e])=>{const t=e.pow(.41666).mul(1.055).sub(.055),n=e.mul(12.92),r=e.lessThanEqual(.0031308);return Wv(t,n,r)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),cx="WorkingColorSpace";class ux extends Zf{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===cx?om.workingColorSpace:"OutputColorSpace"===t?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return!1===om.enabled||n===r||!n||!r||(om.getTransfer(n)===Pp&&(s=sy(ax(s.rgb),s.a)),om.getPrimaries(n)!==om.getPrimaries(r)&&(s=sy(cy(om._getMatrix(new Jp,n,r)).mul(s.rgb),s.a)),om.getTransfer(r)===Pp&&(s=sy(lx(s.rgb),s.a))),s}}const hx=(e,t)=>Ig(new ux(Ig(e),t,cx));og("workingToColorSpace",(e,t)=>Ig(new ux(Ig(e),cx,t))),og("colorSpaceToWorking",hx);let dx=class extends Gf{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class px extends Xf{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=jf}setGroup(e){return this.group=e,this}element(e){return Ig(new dx(this,Ig(e)))}setNodeType(e){const t=_y(null,e);null!==this.group&&t.setGroup(this.group),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}class mx extends px{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(vy)}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}const fx=(e,t,n=null)=>Ig(new mx(e,t,n));class gx extends Zf{static get type(){return"ToneMappingNode"}constructor(e,t=yx,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return Lf(this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(0===n)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(n);return null!==s?r=sy(s(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const yx=fx("toneMappingExposure","float");og("toneMapping",(e,t,n)=>((e,t,n)=>Ig(new gx(e,Ig(t),Ig(n))))(t,n,e));class vx extends tg{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=Rp,this.instanced=!1,this.attribute=null,this.global=!0,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(0===this.bufferStride&&0===this.bufferOffset){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;const t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),s=this.bufferStride||r,i=this.bufferOffset,o=!0===n.isInterleavedBuffer?n:new Ef(n,s),a=new Af(o,r,i);o.setUsage(this.usage),this.attribute=a,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let s=null;return"vertex"===e.shaderStage||"compute"===e.shaderStage?(this.name=r,s=r):s=ox(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}og("toAttribute",e=>((e,t=null,n=0,r=0)=>Ig(new vx(e,t,n,r)))(e.value));class xx extends Xf{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=jf,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){e.getNodeProperties(this).outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if("compute"===n){const t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t,this)}else{const n=e.getNodeProperties(this).outputComputeNode;if(n)return n.build(e,t)}}}const bx=(e,t=[64])=>{(0===t.length||t.length>3)&&console.error("THREE.TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let n=0;n<t.length;n++){const e=t[n];("number"!=typeof e||e<=0||!Number.isInteger(e))&&console.error(`THREE.TSL: compute() workgroupSize element at index [ ${n} ] must be a positive integer`)}for(;t.length<3;)t.push(1);return Ig(new xx(Ig(e),t))};og("compute",(e,t,n)=>bx(e,n).setCount(t)),og("computeKernel",bx);class _x extends Xf{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const r=this.node.getNodeType(e);return e.setCache(t),r}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(n),s}}og("cache",(e,t)=>Ig(new _x(Ig(e),t)));class wx extends Xf{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}og("bypass",zg(wx).setParameterLength(2));class Tx extends Xf{static get type(){return"RemapNode"}constructor(e,t,n,r=Xg(0),s=Xg(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:s,doClamp:i}=this;let o=e.sub(t).div(n.sub(t));return!0===i&&(o=o.clamp()),o.mul(s.sub(r)).add(r)}}const Ex=zg(Tx,null,null,{doClamp:!1}).setParameterLength(3,5),Sx=zg(Tx).setParameterLength(3,5);og("remap",Ex),og("remapClamp",Sx);class Ax extends Xf{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if("void"!==n)return e.format(r,n,t);e.addLineFlowCode(r,this)}}const Mx=zg(Ax).setParameterLength(1,2);og("discard",e=>(e?Jv(e,Mx("discard")):Mx("discard")).toStack());class Ox extends Zf{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setup({context:e}){let t=this.colorNode||e.color;const n=(null!==this.toneMapping?this.toneMapping:e.toneMapping)||0,r=(null!==this.outputColorSpace?this.outputColorSpace:e.outputColorSpace)||"";return 0!==n&&(t=t.toneMapping(n)),""!==r&&r!==om.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}og("renderOutput",(e,t=null,n=null)=>Ig(new Ox(Ig(e),t,n)));class Cx extends Zf{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),r="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(r.length);let i="";return i+="// #"+r+"#\n",i+=e.flow.code.replace(/^\t/gm,"")+"\n",i+="/* ... */ "+n+" /* ... */\n",i+="// #"+s+"#\n",null!==t?t(e,i):console.log(i),n}}og("debug",(e,t=null)=>Ig(new Cx(Ig(e),t)).toStack());class Nx extends Xf{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(null===t){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){const r=e.geometry.getAttribute(t),s=e.getTypeFromAttribute(r),i=e.getAttribute(t,s);return"vertex"===e.shaderStage?e.format(i.name,s,n):ox(this).build(e,n)}return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Px=(e,t=null)=>Ig(new Nx(e,t)),Rx=(e=0)=>Px("uv"+(e>0?e:""),"vec2");class Ix extends Xf{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=null===this.levelNode?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const Lx=zg(Ix).setParameterLength(1,2);class kx extends by{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Bf}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&void 0!==n.width){const{width:e,height:t}=n;this.value=Math.log2(Math.max(e,t))}}}const Dx=zg(kx).setParameterLength(1),zx=new gm;class Ux extends by{static get type(){return"TextureNode"}constructor(e=zx,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Ff,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(null===t)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":1014===this.value.type?"uvec4":1013===this.value.type?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Rx(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return null===this._matrixUniform&&(this._matrixUniform=_y(this.value.matrix)),this._matrixUniform.mul(ey(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?jf:Ff,this}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.image instanceof ImageBitmap&&!0===n.flipY||!0===n.isRenderTargetTexture||!0===n.isFramebufferTexture||!0===n.isDepthTexture)&&(t=this.sampler?t.flipY():t.setY(Gg(Lx(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||!0!==n.isTexture)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let r=this.uvNode;(null===r||!0===e.context.forceUVContext)&&e.context.getUV&&(r=e.context.getUV(this,e)),r||(r=this.getDefaultUV()),!0===this.updateMatrix&&(r=this.getTransformedUV(r)),r=this.setupUV(e,r);let s=this.levelNode;null===s&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=r,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,n,r,s,i,o,a,l){const c=this.value;let u;return u=r?e.generateTextureLevel(c,t,n,r,i,l):s?e.generateTextureBias(c,t,n,s,i,l):a?e.generateTextureGrad(c,t,n,a,i,l):o?e.generateTextureCompare(c,t,n,o,i,l):!1===this.sampler?e.generateTextureLoad(c,t,n,i,l):e.generateTexture(c,t,n,i,l),u}generate(e,t){const n=this.value,r=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const i=e.getDataFromNode(this);let o=i.propertyName;if(void 0===o){const{uvNode:t,levelNode:n,biasNode:a,compareNode:l,depthNode:c,gradNode:u,offsetNode:h}=r,d=this.generateUV(e,t),p=n?n.build(e,"float"):null,m=a?a.build(e,"float"):null,f=c?c.build(e,"int"):null,g=l?l.build(e,"float"):null,y=u?[u[0].build(e,"vec2"),u[1].build(e,"vec2")]:null,v=h?this.generateOffset(e,h):null,x=e.getVarFromNode(this);o=e.getPropertyName(x);const b=this.generateSnippet(e,s,d,p,m,f,g,y,v);e.addLineFlowCode(`${o} = ${b}`,this),i.snippet=b,i.propertyName=o}let a=o;const l=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(a=hx(Mx(a,l),n.colorSpace).setup(e).build(e,l)),e.format(a,l,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=Ig(e),t.referenceNode=this.getBase(),Ig(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=Ig(e).mul(Dx(t)),t.referenceNode=this.getBase();const n=t.value;return!1===t.generateMipmaps&&(n&&!1===n.generateMipmaps||n.minFilter===Ap||n.magFilter===Ap)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),Ig(t)}level(e){const t=this.clone();return t.levelNode=Ig(e),t.referenceNode=this.getBase(),Ig(t)}size(e){return Lx(this,e)}bias(e){const t=this.clone();return t.biasNode=Ig(e),t.referenceNode=this.getBase(),Ig(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=Ig(e),t.referenceNode=this.getBase(),Ig(t)}grad(e,t){const n=this.clone();return n.gradNode=[Ig(e),Ig(t)],n.referenceNode=this.getBase(),Ig(n)}depth(e){const t=this.clone();return t.depthNode=Ig(e),t.referenceNode=this.getBase(),Ig(t)}offset(e){const t=this.clone();return t.offsetNode=Ig(e),t.referenceNode=this.getBase(),Ig(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const Fx=zg(Ux).setParameterLength(1,4).setName("texture");class Bx extends by{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}class Vx extends Gf{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),r=this.node.getPaddedType();return e.format(t,r,n)}}class jx extends Bx{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=null===t?Df(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=Vf,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return"mat2"===e?t="mat2":!0===/mat/.test(e)?t="mat4":"i"===e.charAt(0)?t="ivec4":"u"===e.charAt(0)&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if("float"===n||"int"===n||"uint"===n)for(let r=0;r<e.length;r++){t[4*r]=e[r]}else if("color"===n)for(let r=0;r<e.length;r++){const n=4*r,s=e[r];t[n]=s.r,t[n+1]=s.g,t[n+2]=s.b||0}else if("mat2"===n)for(let r=0;r<e.length;r++){const n=4*r,s=e[r];t[n]=s.elements[0],t[n+1]=s.elements[1],t[n+2]=s.elements[2],t[n+3]=s.elements[3]}else if("mat3"===n)for(let r=0;r<e.length;r++){const n=16*r,s=e[r];t[n]=s.elements[0],t[n+1]=s.elements[1],t[n+2]=s.elements[2],t[n+4]=s.elements[3],t[n+5]=s.elements[4],t[n+6]=s.elements[5],t[n+8]=s.elements[6],t[n+9]=s.elements[7],t[n+10]=s.elements[8],t[n+15]=1}else if("mat4"===n)for(let r=0;r<e.length;r++){const n=16*r,s=e[r];for(let e=0;e<s.elements.length;e++)t[n+e]=s.elements[e]}else for(let r=0;r<e.length;r++){const n=4*r,s=e[r];t[n]=s.x,t[n+1]=s.y,t[n+2]=s.z||0,t[n+3]=s.w||0}}setup(e){const t=this.array.length,n=this.elementType;let r=Float32Array;const s=this.paddedType,i=e.getTypeLength(s);return"i"===n.charAt(0)&&(r=Int32Array),"u"===n.charAt(0)&&(r=Uint32Array),this.value=new r(t*i),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return Ig(new Vx(this,Ig(e)))}}const Hx=(e,t)=>Ig(new jx(e,t));const Yx=zg(class extends Xf{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}).setParameterLength(1);let Wx,Xx,Gx=class e extends Xf{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===e.DPR?"float":this.scope===e.VIEWPORT?"vec4":"vec2"}getUpdateType(){let t=Ff;return(this.scope===e.SIZE||this.scope===e.VIEWPORT||this.scope===e.DPR)&&(t=Vf),this.updateType=t,t}update({renderer:t}){const n=t.getRenderTarget();this.scope===e.VIEWPORT?null!==n?Xx.copy(n.viewport):(t.getViewport(Xx),Xx.multiplyScalar(t.getPixelRatio())):this.scope===e.DPR?this._output.value=t.getPixelRatio():null!==n?(Wx.width=n.width,Wx.height=n.height):t.getDrawingBufferSize(Wx)}setup(){const t=this.scope;let n=null;return n=t===e.SIZE?_y(Wx||(Wx=new Gp)):t===e.VIEWPORT?_y(Xx||(Xx=new ym)):t===e.DPR?_y(1):Kg(Kx.div(Zx)),this._output=n,n}generate(t){if(this.scope===e.COORDINATE){let e=t.getFragCoord();if(t.isFlipY()){const n=t.getNodeProperties(Zx).outputNode.build(t);e=`${t.getType("vec2")}( ${e}.x, ${n}.y - ${e}.y )`}return e}return super.generate(t)}};Gx.COORDINATE="coordinate",Gx.VIEWPORT="viewport",Gx.SIZE="size",Gx.UV="uv",Gx.DPR="dpr";const qx=Ug(Gx,Gx.UV),Zx=Ug(Gx,Gx.SIZE),Kx=Ug(Gx,Gx.COORDINATE),Qx=Ug(Gx,Gx.VIEWPORT);Qx.zw,Qx.xy;const Jx=_y(0,"uint").setName("u_cameraIndex").setGroup(yy("cameraIndex")).toVarying("v_cameraIndex"),$x=_y("float").setName("cameraNear").setGroup(vy).onRenderUpdate(({camera:e})=>e.near),eb=_y("float").setName("cameraFar").setGroup(vy).onRenderUpdate(({camera:e})=>e.far),tb=jg(({camera:e})=>{let t;if(e.isArrayCamera&&e.cameras.length>0){const n=[];for(const t of e.cameras)n.push(t.matrixWorldInverse);t=Hx(n).setGroup(vy).setName("cameraViewMatrices").element(e.isMultiViewCamera?Yx("gl_ViewID_OVR"):Jx).toConst("cameraViewMatrix")}else t=_y("mat4").setName("cameraViewMatrix").setGroup(vy).onRenderUpdate(({camera:e})=>e.matrixWorldInverse);return t}).once()(),nb=new zm;let rb=class e extends Xf{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=jf,this.uniformNode=new by(null)}getNodeType(){const t=this.scope;return t===e.WORLD_MATRIX?"mat4":t===e.POSITION||t===e.VIEW_POSITION||t===e.DIRECTION||t===e.SCALE?"vec3":t===e.RADIUS?"float":void 0}update(t){const n=this.object3d,r=this.uniformNode,s=this.scope;if(s===e.WORLD_MATRIX)r.value=n.matrixWorld;else if(s===e.POSITION)r.value=r.value||new Zp,r.value.setFromMatrixPosition(n.matrixWorld);else if(s===e.SCALE)r.value=r.value||new Zp,r.value.setFromMatrixScale(n.matrixWorld);else if(s===e.DIRECTION)r.value=r.value||new Zp,n.getWorldDirection(r.value);else if(s===e.VIEW_POSITION){const e=t.camera;r.value=r.value||new Zp,r.value.setFromMatrixPosition(n.matrixWorld),r.value.applyMatrix4(e.matrixWorldInverse)}else if(s===e.RADIUS){const e=t.object.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),nb.copy(e.boundingSphere).applyMatrix4(n.matrixWorld),r.value=nb.radius}}generate(t){const n=this.scope;return n===e.WORLD_MATRIX?this.uniformNode.nodeType="mat4":n===e.POSITION||n===e.VIEW_POSITION||n===e.DIRECTION||n===e.SCALE?this.uniformNode.nodeType="vec3":n===e.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(t)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}};rb.WORLD_MATRIX="worldMatrix",rb.POSITION="position",rb.SCALE="scale",rb.VIEW_POSITION="viewPosition",rb.DIRECTION="direction",rb.RADIUS="radius";class sb extends rb{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const ib=Ug(sb,sb.WORLD_MATRIX),ob=_y(new Jp).onObjectUpdate(({object:e},t)=>t.value.getNormalMatrix(e.matrixWorld)),ab=jg(e=>e.renderer.overrideNodes.modelViewMatrix||lb).once()().toVar("modelViewMatrix"),lb=tb.mul(ib),cb=jg(e=>e.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),ub=cb.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class hb extends Xf{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if("fragment"!==e.shaderStage)return"true";const{material:t}=e;return 1===t.side?"false":e.getFrontFacing()}}const db=Xg(Ug(hb)).mul(2).sub(1),pb=jg(([e],{material:t})=>{const n=t.side;return 1===n?e=e.mul(-1):2===n&&(e=e.mul(db)),e}),mb=Px("normal","vec3"),fb=jg(e=>!1===e.geometry.hasAttribute("normal")?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),ey(0,1,0)):mb,"vec3").once()().toVar("normalLocal"),gb=cb.dFdx().cross(cb.dFdy()).normalize().toVar("normalFlat"),yb=jg(e=>{let t;return t=!0===e.material.flatShading?gb:_b(fb).toVarying("v_normalViewGeometry").normalize(),t},"vec3").once()().toVar("normalViewGeometry"),vb=jg(({subBuildFn:e,material:t,context:n})=>{let r;return"NORMAL"===e||"VERTEX"===e?(r=yb,!0!==t.flatShading&&(r=pb(r))):r=n.setupNormal().context({getUV:null}),r},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),xb=vb.transformDirection(tb).toVar("normalWorld"),bb=jg(({subBuildFn:e,context:t})=>{let n;return n="NORMAL"===e||"VERTEX"===e?vb:t.setupClearcoatNormal().context({getUV:null}),n},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),_b=jg(([e],t)=>{const n=t.renderer.overrideNodes.modelNormalViewMatrix;if(null!==n)return n.transformDirection(e);const r=ob.mul(e);return tb.transformDirection(r)});jg(()=>(console.warn('THREE.TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),vb)).once(["NORMAL","VERTEX"])(),jg(()=>(console.warn('THREE.TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),xb)).once(["NORMAL","VERTEX"])(),jg(()=>(console.warn('THREE.TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),bb)).once(["NORMAL","VERTEX"])();const wb=new qm,Tb=new Um,Eb=_y(0).onReference(({material:e})=>e).onObjectUpdate(({material:e})=>e.refractionRatio),Sb=_y(new Um).onReference(function(e){return e.material}).onObjectUpdate(function({material:e,scene:t}){const n=null!==t.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation;return n?(wb.copy(n),Tb.makeRotationFromEuler(wb)):Tb.identity(),Tb}),Ab=ub.negate().reflect(vb),Mb=ub.negate().refract(vb,Eb),Ob=Ab.transformDirection(tb).toVar("reflectVector"),Cb=Mb.transformDirection(tb).toVar("reflectVector"),Nb=new Tf;class Pb extends Ux{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return 301===e.mapping?Ob:302===e.mapping?Cb:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),ey(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return(e.renderer.coordinateSystem===Lp||!n.isRenderTargetTexture)&&(t=ey(t.x.negate(),t.yz)),Sb.mul(t)}generateUV(e,t){return t.build(e,"vec3")}}const Rb=zg(Pb).setParameterLength(1,4).setName("cubeTexture");class Ib extends Gf{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class Lb extends Xf{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=jf}element(e){return Ig(new Ib(this,Ig(e)))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return console.warn('THREE.TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;t=null!==this.count?((e,t,n)=>Ig(new Bx(e,t,n)))(null,e,this.count):Array.isArray(this.getValueFromReference())?Hx(null,e):"texture"===e?((e=zx,t=null,n=null,r=null)=>{let s;return e&&!0===e.isTextureNode?(s=Ig(e.clone()),s.referenceNode=e.getBase(),null!==t&&(s.uvNode=Ig(t)),null!==n&&(s.levelNode=Ig(n)),null!==r&&(s.biasNode=Ig(r))):s=Fx(e,t,n,r),s})(null):"cubeTexture"===e?((e=Nb,t=null,n=null,r=null)=>{let s;return e&&!0===e.isCubeTextureNode?(s=Ig(e.clone()),s.referenceNode=e,null!==t&&(s.uvNode=Ig(t)),null!==n&&(s.levelNode=Ig(n)),null!==r&&(s.biasNode=Ig(r))):s=Rb(e,t,n,r),s})(null):_y(null,e),null!==this.group&&t.setGroup(this.group),null!==this.name&&t.setName(this.name),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let r=1;r<t.length;r++)n=n[t[r]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const kb=(e,t,n)=>Ig(new Lb(e,t,n));class Db extends Lb{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}const zb=Rx(),Ub=cb.dFdx(),Fb=cb.dFdy(),Bb=zb.dFdx(),Vb=zb.dFdy(),jb=vb,Hb=Fb.cross(jb),Yb=jb.cross(Ub),Wb=Hb.mul(Bb.x).add(Yb.mul(Vb.x)),Xb=Hb.mul(Bb.y).add(Yb.mul(Vb.y)),Gb=Wb.dot(Wb).max(Xb.dot(Xb)),qb=Gb.equal(0).select(0,Gb.inverseSqrt()),Zb=Wb.mul(qb).toVar("tangentViewFrame"),Kb=Xb.mul(qb).toVar("bitangentViewFrame"),Qb=jg(e=>(!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),Px("tangent","vec4")))(),Jb=Qb.xyz.toVar("tangentLocal"),$b=jg(({subBuildFn:e,geometry:t,material:n})=>{let r;return r="VERTEX"===e||t.hasAttribute("tangent")?ab.mul(sy(Jb,0)).xyz.toVarying("v_tangentView").normalize():Zb,!0!==n.flatShading&&(r=pb(r)),r},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),e_=jg(([e,t],{subBuildFn:n,material:r})=>{let s=e.mul(Qb.w).xyz;return"NORMAL"===n&&!0!==r.flatShading&&(s=s.toVarying(t)),s}).once(["NORMAL"]),t_=jg(({subBuildFn:e,geometry:t,material:n})=>{let r;return r="VERTEX"===e||t.hasAttribute("tangent")?e_(vb.cross($b),"v_bitangentView").normalize():Kb,!0!==n.flatShading&&(r=pb(r)),r},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),n_=cy($b,t_,vb).toVar("TBNViewMatrix");class r_ extends Zf{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=0}setup({material:e}){const{normalMapType:t,scaleNode:n}=this;let r=this.node.mul(2).sub(1);if(null!==n){let t=n;!0===e.flatShading&&(t=pb(t)),r=ey(r.xy.mul(t),r.z)}let s=null;return 1===t?s=_b(r):0===t?s=n_.mul(r).normalize():(console.error(`THREE.NodeMaterial: Unsupported normal map type: ${t}`),s=vb),s}}const s_=zg(r_).setParameterLength(1,2),i_=jg(({textureNode:e,bumpScale:t})=>{const n=t=>e.cache().context({getUV:e=>t(e.uvNode||Rx()),forceUVContext:!0}),r=Xg(n(e=>e));return Kg(Xg(n(e=>e.add(e.dFdx()))).sub(r),Xg(n(e=>e.add(e.dFdy()))).sub(r)).mul(t)}),o_=jg(e=>{const{surf_pos:t,surf_norm:n,dHdxy:r}=e,s=t.dFdx().normalize(),i=n,o=t.dFdy().normalize().cross(i),a=i.cross(s),l=s.dot(o).mul(db),c=l.sign().mul(r.x.mul(o).add(r.y.mul(a)));return l.abs().mul(n).sub(c).normalize()});class a_ extends Zf{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=null!==this.scaleNode?this.scaleNode:1,t=i_({textureNode:this.textureNode,bumpScale:e});return o_({surf_pos:cb,surf_norm:vb,dHdxy:t})}}const l_=zg(a_).setParameterLength(1,2),c_=new Map;class u_ extends Xf{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=c_.get(e);return void 0===n&&(n=((e,t,n=null)=>Ig(new Db(e,t,n)))(e,t),c_.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===u_.COLOR){const e=void 0!==t.color?this.getColor(n):ey();r=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(n===u_.OPACITY){const e=this.getFloat(n);r=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(n===u_.SPECULAR_STRENGTH)r=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:Xg(1);else if(n===u_.SPECULAR_INTENSITY){const e=this.getFloat(n);r=t.specularIntensityMap&&!0===t.specularIntensityMap.isTexture?e.mul(this.getTexture(n).a):e}else if(n===u_.SPECULAR_COLOR){const e=this.getColor(n);r=t.specularColorMap&&!0===t.specularColorMap.isTexture?e.mul(this.getTexture(n).rgb):e}else if(n===u_.ROUGHNESS){const e=this.getFloat(n);r=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(n).g):e}else if(n===u_.METALNESS){const e=this.getFloat(n);r=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(n).b):e}else if(n===u_.EMISSIVE){const e=this.getFloat("emissiveIntensity"),s=this.getColor(n).mul(e);r=t.emissiveMap&&!0===t.emissiveMap.isTexture?s.mul(this.getTexture(n)):s}else if(n===u_.NORMAL)t.normalMap?(r=s_(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):r=t.bumpMap?l_(this.getTexture("bump").r,this.getFloat("bumpScale")):vb;else if(n===u_.CLEARCOAT){const e=this.getFloat(n);r=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===u_.CLEARCOAT_ROUGHNESS){const e=this.getFloat(n);r=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===u_.CLEARCOAT_NORMAL)r=t.clearcoatNormalMap?s_(this.getTexture(n),this.getCache(n+"Scale","vec2")):vb;else if(n===u_.SHEEN){const e=this.getColor("sheenColor").mul(this.getFloat("sheen"));r=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(n===u_.SHEEN_ROUGHNESS){const e=this.getFloat(n);r=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(n).a):e,r=r.clamp(.07,1)}else if(n===u_.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){const e=this.getTexture(n);r=ly(h_.x,h_.y,h_.y.negate(),h_.x).mul(e.rg.mul(2).sub(Kg(1)).normalize().mul(e.b))}else r=h_;else if(n===u_.IRIDESCENCE_THICKNESS){const e=kb("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const s=kb("0","float",t.iridescenceThicknessRange);r=e.sub(s).mul(this.getTexture(n).g).add(s)}else r=e}else if(n===u_.TRANSMISSION){const e=this.getFloat(n);r=t.transmissionMap?e.mul(this.getTexture(n).r):e}else if(n===u_.THICKNESS){const e=this.getFloat(n);r=t.thicknessMap?e.mul(this.getTexture(n).g):e}else if(n===u_.IOR)r=this.getFloat(n);else if(n===u_.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===u_.AO)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===u_.LINE_DASH_OFFSET)r=t.dashOffset?this.getFloat(n):Xg(0);else{const t=this.getNodeType(e);r=this.getCache(n,t)}return r}}u_.ALPHA_TEST="alphaTest",u_.COLOR="color",u_.OPACITY="opacity",u_.SHININESS="shininess",u_.SPECULAR="specular",u_.SPECULAR_STRENGTH="specularStrength",u_.SPECULAR_INTENSITY="specularIntensity",u_.SPECULAR_COLOR="specularColor",u_.REFLECTIVITY="reflectivity",u_.ROUGHNESS="roughness",u_.METALNESS="metalness",u_.NORMAL="normal",u_.CLEARCOAT="clearcoat",u_.CLEARCOAT_ROUGHNESS="clearcoatRoughness",u_.CLEARCOAT_NORMAL="clearcoatNormal",u_.EMISSIVE="emissive",u_.ROTATION="rotation",u_.SHEEN="sheen",u_.SHEEN_ROUGHNESS="sheenRoughness",u_.ANISOTROPY="anisotropy",u_.IRIDESCENCE="iridescence",u_.IRIDESCENCE_IOR="iridescenceIOR",u_.IRIDESCENCE_THICKNESS="iridescenceThickness",u_.IOR="ior",u_.TRANSMISSION="transmission",u_.THICKNESS="thickness",u_.ATTENUATION_DISTANCE="attenuationDistance",u_.ATTENUATION_COLOR="attenuationColor",u_.LINE_SCALE="scale",u_.LINE_DASH_SIZE="dashSize",u_.LINE_GAP_SIZE="gapSize",u_.LINE_WIDTH="linewidth",u_.LINE_DASH_OFFSET="dashOffset",u_.POINT_SIZE="size",u_.DISPERSION="dispersion",u_.LIGHT_MAP="light",u_.AO="ao";const h_=_y(new Gp).onReference(function(e){return e.material}).onRenderUpdate(function({material:e}){this.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation))});let d_=class e extends Xf{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(t){const n=this.getNodeType(t),r=this.scope;let s,i;if(r===e.VERTEX)s=t.getVertexIndex();else if(r===e.INSTANCE)s=t.getInstanceIndex();else if(r===e.DRAW)s=t.getDrawIndex();else if(r===e.INVOCATION_LOCAL)s=t.getInvocationLocalIndex();else if(r===e.INVOCATION_SUBGROUP)s=t.getInvocationSubgroupIndex();else{if(r!==e.SUBGROUP)throw new Error("THREE.IndexNode: Unknown scope: "+r);s=t.getSubgroupIndex()}return i="vertex"===t.shaderStage||"compute"===t.shaderStage?s:ox(this).build(t,n),i}};d_.VERTEX="vertex",d_.INSTANCE="instance",d_.SUBGROUP="subgroup",d_.INVOCATION_LOCAL="invocationLocal",d_.INVOCATION_SUBGROUP="invocationSubgroup",d_.DRAW="draw";class p_ extends Xf{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;const n={};for(let i=0,o=this.params.length-1;i<o;i++){const e=this.params[i],t=!0!==e.isNode&&e.name||this.getVarName(i),r=!0!==e.isNode&&e.type||"int";n[t]=Mx(t,r)}const r=e.addStack();t.returnsNode=this.params[this.params.length-1](n,e),t.stackNode=r;const s=this.params[0];return!0!==s.isNode&&"function"==typeof s.update&&(t.updateNode=jg(this.params[0].update)(n)),e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let o=0,a=n.length-1;o<a;o++){const r=n[o];let s,i=!1,a=null,l=null,c=null,u=null,h=null,d=null;if(r.isNode?"bool"===r.getNodeType(e)?(i=!0,u="bool",l=r.build(e,u)):(u="int",c=this.getVarName(o),a="0",l=r.build(e,u),h="<"):(u=r.type||"int",c=r.name||this.getVarName(o),a=r.start,l=r.end,h=r.condition,d=r.update,"number"==typeof a?a=e.generateConst(u,a):a&&a.isNode&&(a=a.build(e,u)),"number"==typeof l?l=e.generateConst(u,l):l&&l.isNode&&(l=l.build(e,u)),void 0!==a&&void 0===l?(a+=" - 1",l="0",h=">="):void 0!==l&&void 0===a&&(a="0",h="<"),void 0===h&&(h=Number(a)>Number(l)?">=":"<")),i)s=`while ( ${l} )`;else{const n={start:a,end:l},r=n.start,i=n.end;let o;const p=()=>h.includes("<")?"+=":"-=";if(null!=d)switch(typeof d){case"function":o=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":o=c+" "+p()+" "+e.generateConst(u,d);break;case"string":o=c+" "+d;break;default:d.isNode?o=c+" "+p()+" "+d.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),o="break /* invalid update */")}else d="int"===u||"uint"===u?h.includes("<")?"++":"--":p()+" 1.",o=c+" "+d;s=`for ( ${e.getVar(u,c)+" = "+r}; ${c+" "+h+" "+i}; ${o} )`}e.addFlowCode((0===o?"\n":"")+e.tab+s+" {\n\n").addFlowTab()}const s=r.build(e,"void"),i=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+s);for(let o=0,a=this.params.length-1;o<a;o++)e.addFlowCode((0===o?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),i}}const m_=(...e)=>Ig(new p_(Dg(e,"int"))).toStack(),f_=new Gp;class g_ extends Ux{static get type(){return"ViewportTextureNode"}constructor(e=qx,t=null,n=null){let r=null;null===n?(r=new Nf,r.minFilter=1008,n=r):r=n,super(n,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=r,this.isOutputTextureNode=!0,this.updateBeforeType=Bf,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,n;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,n=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,n=this._cacheTextures),null===e)return t;if(!1===n.has(e)){const r=t.clone();n.set(e,r)}return n.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,n=t.getRenderTarget();null===n?t.getDrawingBufferSize(f_):f_.set(n.width,n.height);const r=this.getTextureForReference(n);(r.image.width!==f_.width||r.image.height!==f_.height)&&(r.image.width=f_.width,r.image.height=f_.height,r.needsUpdate=!0);const s=r.generateMipmaps;r.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(r),r.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}let y_=null;class v_ extends g_{static get type(){return"ViewportDepthTextureNode"}constructor(e=qx,t=null){null===y_&&(y_=new Pf),super(e,t,y_)}getTextureForReference(){return y_}}const x_=zg(v_).setParameterLength(0,2);class b_ extends Xf{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===b_.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===b_.DEPTH_BASE)null!==n&&(r=E_().assign(n));else if(t===b_.DEPTH)r=e.isPerspectiveCamera?w_(cb.z,$x,eb):__(cb.z,$x,eb);else if(t===b_.LINEAR_DEPTH)if(null!==n)if(e.isPerspectiveCamera){const e=T_(n,$x,eb);r=__(e,$x,eb)}else r=n;else r=__(cb.z,$x,eb);return r}}b_.DEPTH_BASE="depthBase",b_.DEPTH="depth",b_.LINEAR_DEPTH="linearDepth";const __=(e,t,n)=>e.add(t).div(t.sub(n)),w_=(e,t,n)=>t.add(e).mul(n).div(n.sub(t).mul(e)),T_=(e,t,n)=>t.mul(n).div(n.sub(t).mul(e).sub(n)),E_=zg(b_,b_.DEPTH_BASE),S_=Ug(b_,b_.DEPTH);x_(),S_.assign=e=>E_(e);class A_ extends Xf{static get type(){return"ClippingNode"}constructor(e=A_.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:r}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===A_.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,r):this.scope===A_.HARDWARE?this.setupHardwareClipping(r,e):this.setupDefault(n,r)}setupAlphaToCoverage(e,t){return jg(()=>{const n=Xg().toVar("distanceToPlane"),r=Xg().toVar("distanceToGradient"),s=Xg(1).toVar("clipOpacity"),i=t.length;if(!1===this.hardwareClipping&&i>0){const e=Hx(t).setGroup(vy);m_(i,({i:t})=>{const i=e.element(t);n.assign(cb.dot(i.xyz).negate().add(i.w)),r.assign(n.fwidth().div(2)),s.mulAssign(qv(r.negate(),r,n))})}const o=e.length;if(o>0){const t=Hx(e).setGroup(vy),i=Xg(1).toVar("intersectionClipOpacity");m_(o,({i:e})=>{const s=t.element(e);n.assign(cb.dot(s.xyz).negate().add(s.w)),r.assign(n.fwidth().div(2)),i.mulAssign(qv(r.negate(),r,n).oneMinus())}),s.mulAssign(i.oneMinus())}py.a.mulAssign(s),py.a.equal(0).discard()})()}setupDefault(e,t){return jg(()=>{const n=t.length;if(!1===this.hardwareClipping&&n>0){const e=Hx(t).setGroup(vy);m_(n,({i:t})=>{const n=e.element(t);cb.dot(n.xyz).greaterThan(n.w).discard()})}const r=e.length;if(r>0){const t=Hx(e).setGroup(vy),n=Zg(!0).toVar("clipped");m_(r,({i:e})=>{const r=t.element(e);n.assign(cb.dot(r.xyz).greaterThan(r.w).and(n))}),n.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),jg(()=>{const r=Hx(e).setGroup(vy),s=Yx(t.getClipDistance());m_(n,({i:e})=>{const t=r.element(e),n=cb.dot(t.xyz).sub(t.w).negate();s.element(e).assign(n)})})()}}A_.ALPHA_TO_COVERAGE="alphaToCoverage",A_.DEFAULT="default",A_.HARDWARE="hardware",ey(.04),Xg(1);const M_=jg(([e,t])=>{const n=e.toVar();n.assign(Cy(2,n).sub(1));const r=ey(n,1).toVar();return Hg(t.equal(0),()=>{r.assign(r.zyx)}).ElseIf(t.equal(1),()=>{r.assign(r.xzy),r.xz.mulAssign(-1)}).ElseIf(t.equal(2),()=>{r.x.mulAssign(-1)}).ElseIf(t.equal(3),()=>{r.assign(r.zyx),r.xz.mulAssign(-1)}).ElseIf(t.equal(4),()=>{r.assign(r.xzy),r.xy.mulAssign(-1)}).ElseIf(t.equal(5),()=>{r.z.mulAssign(-1)}),r}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),O_=M_(Rx(),Px("faceIndex")).normalize();O_.x,O_.y,O_.z,dy("vec3"),dy("vec3"),dy("vec3"),new class{constructor(e=new Zp(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Mf.subVectors(n,t).cross(Of.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Mf),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Cf.getNormalMatrix(e),r=this.coplanarPoint(Mf).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}},new Zp,new Zp,new Zp,new Um,new Zp(0,0,-1),new ym,new Zp,new Zp,new ym,new Gp;const C_=new vm;qx.flipX(),C_.depthTexture=new Pf(1,1);class N_ extends Xf{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===N_.OBJECT?this.updateType=jf:e===N_.MATERIAL&&(this.updateType=Vf)}update(e){this.callback(e)}}N_.OBJECT="object",N_.MATERIAL="material";const P_=new qm,R_=new Um;class I_ extends Xf{static get type(){return"SceneNode"}constructor(e=I_.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=null!==this.scene?this.scene:e.scene;let r;return t===I_.BACKGROUND_BLURRINESS?r=kb("backgroundBlurriness","float",n):t===I_.BACKGROUND_INTENSITY?r=kb("backgroundIntensity","float",n):t===I_.BACKGROUND_ROTATION?r=_y("mat4").setName("backgroundRotation").setGroup(vy).onRenderUpdate(()=>{const e=n.background;return null!==e&&e.isTexture&&300!==e.mapping?(P_.copy(n.backgroundRotation),P_.x*=-1,P_.y*=-1,P_.z*=-1,R_.makeRotationFromEuler(P_)):R_.identity(),R_}):console.error("THREE.SceneNode: Unknown scope:",t),r}}I_.BACKGROUND_BLURRINESS="backgroundBlurriness",I_.BACKGROUND_INTENSITY="backgroundIntensity",I_.BACKGROUND_ROTATION="backgroundRotation",jg(({texture:e,uv:t})=>{const n=ey().toVar();return Hg(t.x.lessThan(1e-4),()=>{n.assign(ey(1,0,0))}).ElseIf(t.y.lessThan(1e-4),()=>{n.assign(ey(0,1,0))}).ElseIf(t.z.lessThan(1e-4),()=>{n.assign(ey(0,0,1))}).ElseIf(t.x.greaterThan(.9999),()=>{n.assign(ey(-1,0,0))}).ElseIf(t.y.greaterThan(.9999),()=>{n.assign(ey(0,-1,0))}).ElseIf(t.z.greaterThan(.9999),()=>{n.assign(ey(0,0,-1))}).Else(()=>{const r=e.sample(t.add(ey(-.01,0,0))).r.sub(e.sample(t.add(ey(.01,0,0))).r),s=e.sample(t.add(ey(0,-.01,0))).r.sub(e.sample(t.add(ey(0,.01,0))).r),i=e.sample(t.add(ey(0,0,-.01))).r.sub(e.sample(t.add(ey(0,0,.01))).r);n.assign(ey(r,s,i))}),n.normalize()});const L_=new Gp;class k_ extends Ux{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class D_ extends k_{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}class z_ extends Zf{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new Pf;s.isRenderTargetTexture=!0,s.name="depth";const i=new vm(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:1016,...r});i.texture.name="output",i.depthTexture=s,this.renderTarget=i,this._textures={output:i.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=_y(0),this._cameraFar=_y(0),this._mrt=null,this._layers=null,this._resolution=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=Bf,this.global=!0}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return void 0===t&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(void 0!==t){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return void 0===t&&(t=Ig(new D_(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),t=Ig(new D_(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(void 0===t){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=T_(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(void 0===t){const n=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=__(s,n,r)}return t}async compileAsync(e){const t=e.getRenderTarget(),n=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(n)}setup({renderer:e}){return this.renderTarget.samples=void 0===this.options.samples?e.samples:this.options.samples,this.renderTarget.texture.type=e.getColorBufferType(),this.scope===z_.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let r,s;const i=t.getOutputRenderTarget();i&&!0===i.isXRRenderTarget?(s=1,r=t.xr.getCamera(),t.xr.updateCamera(r),L_.set(i.width,i.height)):(r=this.camera,s=t.getPixelRatio(),t.getSize(L_)),this._pixelRatio=s,this.setSize(L_.width,L_.height);const o=t.getRenderTarget(),a=t.getMRT(),l=r.layers.mask;this._cameraNear.value=r.near,this._cameraFar.value=r.far,null!==this._layers&&(r.layers.mask=this._layers.mask);for(const c in this._previousTextures)this.toggleTexture(c);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,r),t.setRenderTarget(o),t.setMRT(a),r.layers.mask=l}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio*this._resolution,r=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(n,r),null!==this._scissor&&this.renderTarget.scissor.copy(this._scissor),null!==this._viewport&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,n,r){null===e?this._scissor=null:(null===this._scissor&&(this._scissor=new ym),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,n,r),this._scissor.multiplyScalar(this._pixelRatio*this._resolution).floor())}setViewport(e,t,n,r){null===e?this._viewport=null:(null===this._viewport&&(this._viewport=new ym),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,n,r),this._viewport.multiplyScalar(this._pixelRatio*this._resolution).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}z_.COLOR="color",z_.DEPTH="depth",ey(1.6605,-.1246,-.0182),ey(-.5876,1.1329,-.1006),ey(-.0728,-.0083,1.1187),ey(.6274,.0691,.0164),ey(.3293,.9195,.088),ey(.0433,.0113,.8956);class U_ extends Xf{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}function F_(e){let t;const n=e.context.getViewZ;return void 0!==n&&(t=n(this)),(t||cb.z).negate()}jg(([e,t],n)=>{const r=F_(n);return qv(e,t,r)}),jg(([e],t)=>{const n=F_(t);return e.mul(e,n,n).negate().exp().oneMinus()}),jg(([e,t])=>sy(t.toFloat().mix(my.rgb,e.toVec3()),my.a));zg(class extends Xf{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;!0===n.backend.isWebGLBackend?e.addFlowCode(`\t// ${t}Barrier \n`):e.addLineFlowCode(`${t}Barrier()`,this)}});class B_ extends Xf{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,r=this.method,s=this.getNodeType(e),i=this.getInputType(e),o=this.pointerNode,a=this.valueNode,l=[];l.push(`&${o.build(e,i)}`),null!==a&&l.push(a.build(e,i));const c=`${e.getMethod(r,s)}( ${l.join(", ")} )`;if(!n||1!==n.length||!0!==n[0].isStackNode)return void 0===t.constNode&&(t.constNode=Mx(c,s).toConst()),t.constNode.build(e);e.addLineFlowCode(c,this)}}B_.ATOMIC_LOAD="atomicLoad",B_.ATOMIC_STORE="atomicStore",B_.ATOMIC_ADD="atomicAdd",B_.ATOMIC_SUB="atomicSub",B_.ATOMIC_MAX="atomicMax",B_.ATOMIC_MIN="atomicMin",B_.ATOMIC_AND="atomicAnd",B_.ATOMIC_OR="atomicOr",B_.ATOMIC_XOR="atomicXor",zg(B_);let V_=class e extends Zf{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=n}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,n=this.bNode?this.bNode.getNodeType(e):null;return(e.isMatrix(t)?0:e.getTypeLength(t))>(e.isMatrix(n)?0:e.getTypeLength(n))?t:n}getNodeType(t){const n=this.method;return n===e.SUBGROUP_ELECT?"bool":n===e.SUBGROUP_BALLOT?"uvec4":this.getInputType(t)}generate(t,n){const r=this.method,s=this.getNodeType(t),i=this.getInputType(t),o=this.aNode,a=this.bNode,l=[];if(r===e.SUBGROUP_BROADCAST||r===e.SUBGROUP_SHUFFLE||r===e.QUAD_BROADCAST){const e=a.getNodeType(t);l.push(o.build(t,s),a.build(t,"float"===e?"int":s))}else r===e.SUBGROUP_SHUFFLE_XOR||r===e.SUBGROUP_SHUFFLE_DOWN||r===e.SUBGROUP_SHUFFLE_UP?l.push(o.build(t,s),a.build(t,"uint")):(null!==o&&l.push(o.build(t,i)),null!==a&&l.push(a.build(t,i)));const c=0===l.length?"()":`( ${l.join(", ")} )`;return t.format(`${t.getMethod(r,s)}${c}`,s,n)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}};V_.SUBGROUP_ELECT="subgroupElect",V_.SUBGROUP_BALLOT="subgroupBallot",V_.SUBGROUP_ADD="subgroupAdd",V_.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd",V_.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd",V_.SUBGROUP_MUL="subgroupMul",V_.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul",V_.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul",V_.SUBGROUP_AND="subgroupAnd",V_.SUBGROUP_OR="subgroupOr",V_.SUBGROUP_XOR="subgroupXor",V_.SUBGROUP_MIN="subgroupMin",V_.SUBGROUP_MAX="subgroupMax",V_.SUBGROUP_ALL="subgroupAll",V_.SUBGROUP_ANY="subgroupAny",V_.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst",V_.QUAD_SWAP_X="quadSwapX",V_.QUAD_SWAP_Y="quadSwapY",V_.QUAD_SWAP_DIAGONAL="quadSwapDiagonal",V_.SUBGROUP_BROADCAST="subgroupBroadcast",V_.SUBGROUP_SHUFFLE="subgroupShuffle",V_.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor",V_.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp",V_.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown",V_.QUAD_BROADCAST="quadBroadcast",jg(([e=Rx()],{renderer:t,material:n})=>{const r=Yv(e.mul(2).sub(1));let s;if(n.alphaToCoverage&&t.samples>1){const e=Xg(r.fwidth()).toVar();s=qv(e.oneMinus(),e.add(1),r).oneMinus()}else s=Jv(r.greaterThan(1),0,1);return s});const j_=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4};j_&&j_.VERTEX,j_&&j_.FRAGMENT,j_&&j_.COMPUTE,new U_("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),new U_("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),new U_("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),new U_("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),new U_("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),new U_("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),new U_("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),new U_("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),new U_("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),new U_("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),new U_("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),new U_("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),new U_("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {\n\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n");const H_=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&H_.set(Float16Array,["float16"]);class Y_ extends ce{_time;_factor;constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms||(e.uniforms={}),e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader=`\n        uniform float time;\n        uniform float factor;\n        ${e.vertexShader}\n      `,e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n          float c = cos( theta );\n          float s = sin( theta );\n          mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n          vec3 transformed = vec3( position ) * m;\n          vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const W_=["factor"],X_=Tt({__name:"index",props:{speed:{default:1},factor:{default:1}},setup(e,{expose:t}){const n=e,r=At(),{extend:s,invalidate:i}=Ms();s({MeshWobbleMaterial:Y_}),Ct(n,()=>{i()});const{onBeforeRender:o}=Os();return o(({elapsed:e})=>{r.value&&(r.value.time=e*n?.speed,i())}),t({instance:r}),(t,n)=>(Rt(),Mt("TresMeshWobbleMaterial",Kt({ref_key:"materialRef",ref:r,factor:e.factor},t.$attrs),null,16,W_))}});const G_=new b(0,0,0),q_=new b(0,0,0),Z_=new b(0,0,0);function K_(e,t,n){const r=G_.setFromMatrixPosition(e.matrixWorld);r.project(t);const s=n.width/2,i=n.height/2;return[(Number.isNaN(r.x)?0:r.x)*s+s,-r.y*i+i,r.z]}const Q_=e=>Math.abs(e)<1e-10?0:e;function J_(e,t,n=""){let r="matrix3d(";for(let s=0;16!==s;s++)r+=Q_(t[s]*e.elements[s])+(15!==s?",":")");return n+r}const $_=(e=>t=>J_(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),ew=(()=>(e,t)=>J_(e,(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1])(t),"translate(-50%,-50%)"))(),tw=["geometry","material"],nw=Tt({__name:"HTML",props:{geometry:{default:new G},material:{},as:{default:"div"},transform:{type:Boolean,default:!1},portal:{},wrapperClass:{},eps:{default:1e-4},distanceFactor:{},fullscreen:{type:Boolean},center:{type:Boolean},pointerEvents:{default:"auto"},sprite:{type:Boolean,default:!1},zIndexRange:{default:()=>[16777271,0]},occlude:{type:[Object,null,Array,Boolean,String]}},emits:["onOcclude"],setup(e,{expose:t,emit:n}){const r=e,i=n,o=Et(),a=en(),l=St(),c=St(),{geometry:u,material:h,as:d,transform:p,portal:m,wrapperClass:f,eps:g,distanceFactor:y,fullscreen:v,center:x,pointerEvents:_,sprite:w,occlude:E,zIndexRange:S}=Xt(r),{renderer:A,scene:M,camera:O,sizes:C}=As(),P=Yt(()=>document.createElement(d.value)),R=St([0,0,0]),I=St(0),k=St(),D=St(new L),z=Yt(()=>p.value?{position:"absolute",top:0,left:0,width:`${C.width.value}px`,height:`${C.height.value}px`,transformStyle:"preserve-3d",pointerEvents:"none",zIndex:2}:{position:"absolute",transform:x.value?"translate3d(-50%,-50%,0)":"none",...v.value&&{top:-C.height.value/2,left:-C.width.value/2,width:`${C.width.value}px`,height:`${C.height.value}px`},zIndex:2,...Object.assign({},a.style)}),U=Yt(()=>({position:"absolute",pointerEvents:_.value})),F=St(null),B=St(!1),V=Yt(()=>E?.value&&"blending"!==E?.value||Array.isArray(E?.value)&&E?.value.length&&Ht(E.value[0]));Ct(()=>E,({value:e})=>{"blending"===e?(P.value.style.zIndex=`${Math.floor(S.value[0]/2)}`,P.value.style.position="absolute",P.value.style.pointerEvents="none"):(P.value.style.zIndex=null,P.value.style.position=null,P.value.style.pointerEvents=null)}),Ct(()=>[l.value,A.instance,C.width.value,C.height.value,o.default?.()],([e,t])=>{if(e&&t){const n=m?.value||t.domElement;if(M.value?.updateMatrixWorld(),p.value)P.value.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const t=K_(e,O.activeCamera.value,{width:C.width.value,height:C.height.value});P.value.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${t[0]}px,${t[1]}px,0);transform-origin:0 0;`}n&&!P.value.parentNode&&n.parentNode?.appendChild(P.value),p.value?k.value=tn("div",{id:"outer",style:z.value},[tn("div",{id:"inner",style:U.value},[tn("div",{key:c.value?.uuid,id:M?.value.uuid,class:a.class,style:a.style},o.default?.())])]):k.value=tn("div",{key:c.value?.uuid,id:M?.value.uuid,style:z.value},o.default?.()),nn(k.value,P.value)}}),Ut(()=>{f?.value&&(P.value.className=f.value)});const j=St(!0),{onBeforeRender:H}=Os();H(()=>{if(l.value&&O.activeCamera.value&&A.instance){O.activeCamera.value?.updateMatrixWorld(),l.value.updateWorldMatrix(!0,!1);const e=p.value?R.value:K_(l.value,O.activeCamera.value,{width:C.width.value||0,height:C.height.value||0});if(p.value||Math.abs(I.value-O.activeCamera.value.zoom)>g.value||Math.abs(R.value[0]-e[0])>g.value||Math.abs(R.value[1]-e[1])>g.value||Math.abs(R.value[2]-e[2])>g.value){const t=function(e,t){const n=G_.setFromMatrixPosition(e.matrixWorld),r=q_.setFromMatrixPosition(t.matrixWorld),s=n.sub(r),i=t.getWorldDirection(Z_);return s.angleTo(i)>Math.PI/2}(l.value,O.activeCamera.value);let n=!1;V.value&&(Array.isArray(E?.value)?n=E?.value:"blending"!==E?.value&&(n=[M.value]));const r=j.value;if(n){const e=function(e,t,n,r){const s=G_.setFromMatrixPosition(e.matrixWorld),i=s.clone();i.project(t),n.setFromCamera(new T(i.x,i.y),t);const o=n.intersectObjects(r,!0);if(o.length>0){const e=o[0].distance;return s.distanceTo(n.ray.origin)<e}return!0}(l.value,O.activeCamera.value,D.value,n);j.value=e&&!t}else j.value=!t;r!==j.value&&(i("onOcclude",!j.value),P.value.style.display=j.value?"block":"none");const o=Math.floor(S.value[0]/2),a=E?.value?V.value?[S.value[0],o]:[o-1,0]:S.value;if(P.value.style.zIndex=`${function(e,t,n){if(t instanceof s||t instanceof q){const r=G_.setFromMatrixPosition(e.matrixWorld),s=q_.setFromMatrixPosition(t.matrixWorld),i=r.distanceTo(s),o=(n[1]-n[0])/(t.far-t.near),a=n[1]-o*t.far;return Math.round(o*i+a)}}(l.value,O.activeCamera.value,a)}`,p.value){const[e,t]=[C.width.value/2,C.height.value/2],n=O.activeCamera.value.projectionMatrix.elements[5]*t,{isOrthographicCamera:r,top:s,left:i,bottom:o,right:a}=O.activeCamera.value,c=$_(O.activeCamera.value.matrixWorldInverse),u=r?`scale(${n})translate(${Q_(-(a+i)/2)}px,${Q_((s+o)/2)}px)`:`translateZ(${n}px)`;let h=l.value.matrixWorld;if(w.value&&(h=O.activeCamera.value.matrixWorldInverse.clone().transpose().copyPosition(h).scale(l.value.scale),h.elements[3]=h.elements[7]=h.elements[11]=0,h.elements[15]=1),P.value.style.width=`${C.width.value}px`,P.value.style.height=`${C.height.value}px`,P.value.style.perspective=r?"":`${n}px`,k.value?.el&&k.value?.children&&Array.isArray(k.value.children)){k.value.el.style.transform=`${u}${c}translate(${e}px,${t}px)`;const n=k.value.children[0];n&&n.el&&(n.el.style.transform=ew(h,1/((y?.value||10)/400)))}}else{const t=void 0===y?.value?1:function(e,t){if(t instanceof q)return t.zoom;if(t instanceof s){const n=G_.setFromMatrixPosition(e.matrixWorld),r=q_.setFromMatrixPosition(t.matrixWorld),s=t.fov*Math.PI/180,i=n.distanceTo(r);return 1/(2*Math.tan(s/2)*i)}return 1}(l.value,O.activeCamera.value)*y?.value;P.value.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}}R.value=e,I.value=O.activeCamera.value.zoom}if(!V.value&&c.value&&!B.value)if(p.value){if(k.value?.el&&k.value?.children){const e=(k.value?.children)[0];if(e?.clientWidth&&e?.clientHeight){const{isOrthographicCamera:t}=O.activeCamera.value;if(t||u)a.scale&&(Array.isArray(a.scale)?a.scale instanceof b?c.value.scale.copy(a.scale.clone().divideScalar(1)):c.value.scale.set(1/a.scale[0],1/a.scale[1],1/a.scale[2]):c.value.scale.setScalar(1/a.scale));else{const t=(y?.value||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;c.value.scale.set(n,r,1)}B.value=!0}}}else{const e=P.value.children[0];if(e?.clientWidth&&e?.clientHeight){const t=1*e.clientWidth,n=1*e.clientHeight;c.value.scale.set(t,n,1),B.value=!0}F.value.lookAt(O.activeCamera.value?.position)}});const Y=Yt(()=>({vertexShader:p.value?void 0:"#include <common>\n\nvoid main() {\n  vec2 center = vec2(0., 1.);\n  float rotation = 0.0;\n\n  \n  \n  float size = 0.03;\n\n  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n  bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n  if ( isPerspective ) scale *= - mvPosition.z;\n\n  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n  mvPosition.xy += rotatedPosition;\n\n  gl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"void main() {\n  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n}"})),W=Yt(()=>{const e=Y.value;return h.value||new K({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:N})});return Pt(()=>{W.value&&W.value.dispose(),P.value.remove()}),t({instance:l}),(e,t)=>(Rt(),Mt("TresGroup",{ref_key:"groupRef",ref:l},[Lt(E)&&!V.value?(Rt(),Mt("TresMesh",{key:0,ref_key:"meshRef",ref:c,geometry:Lt(u),material:W.value},null,8,tw)):Gt("",!0)],512))}});var rw,sw={exports:{}};rw||(rw=1,sw.exports=function(){var e=function(){function t(e){return s.appendChild(e.dom),e}function n(e){for(var t=0;t<s.children.length;t++)s.children[t].style.display=t===e?"block":"none";r=e}var r=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(e){e.preventDefault(),n(++r%s.children.length)},!1);var i=(performance||Date).now(),o=i,a=0,l=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:s,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-i,200),e>o+1e3&&(l.update(1e3*a/(e-o),100),o=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:s,setMode:n}};return e.Panel=function(e,t,n){var r=1/0,s=0,i=Math.round,o=i(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,u=2*o,h=3*o,d=15*o,p=74*o,m=30*o,f=document.createElement("canvas");f.width=a,f.height=l,f.style.cssText="width:80px;height:48px";var g=f.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,c,u),g.fillRect(h,d,p,m),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h,d,p,m),{dom:f,update:function(l,y){r=Math.min(r,l),s=Math.max(s,l),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=t,g.fillText(i(l)+" "+e+" ("+i(r)+"-"+i(s)+")",c,u),g.drawImage(f,h+o,d,p-o,m,h,d,p-o,m),g.fillRect(h+p-o,d,o,m),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(h+p-o,d,o,i((1-l/y)*m))}}},e}());const iw=["args"],ow=["color"],aw=Tt({__name:"Box",props:{args:{default:()=>[1,1,1]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{invalidate:r}=Ms(),{args:s,color:i}=Xt(n);Ct(s,()=>{r()});const o=At();return t({instance:o}),(e,t)=>(Rt(),Mt("TresMesh",Kt({ref_key:"boxRef",ref:o},e.$attrs),[qt("TresBoxGeometry",{args:Lt(s)},null,8,iw),Zt(e.$slots,"default",{},()=>[qt("TresMeshBasicMaterial",{color:Lt(i)},null,8,ow)])],16))}}),lw=["args"],cw=["color"],uw=Tt({__name:"Cone",props:{args:{default:()=>[1,1,12,12,!1,0,2*Math.PI]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{invalidate:r}=Ms(),{args:s,color:i}=Xt(n);Ct(s,()=>{r()});const o=At();return t({instance:o}),(e,t)=>(Rt(),Mt("TresMesh",Kt({ref_key:"coneRef",ref:o},e.$attrs),[qt("TresConeGeometry",{args:Lt(s)},null,8,lw),Zt(e.$slots,"default",{},()=>[qt("TresMeshBasicMaterial",{color:Lt(i)},null,8,cw)])],16))}}),hw=["rotation"],dw=["args"],pw=["color"],mw=Tt({__name:"Plane",props:{args:{default:()=>[1,1]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{invalidate:r}=Ms(),{args:s,color:i}=Xt(n);Ct(s,()=>{r()});const o=At();return t({instance:o}),(e,t)=>(Rt(),Mt("TresMesh",Kt({ref_key:"planeRef",ref:o,rotation:[-Math.PI/2,0,0]},e.$attrs),[qt("TresPlaneGeometry",{args:Lt(s)},null,8,dw),Zt(e.$slots,"default",{},()=>[qt("TresMeshBasicMaterial",{color:Lt(i)},null,8,pw)])],16,hw))}}),fw=["args"],gw=["color"],yw=Tt({__name:"Sphere",props:{args:{default:()=>[2,32,16]},color:{default:"#ffffff"}},setup(e,{expose:t}){const n=e,{invalidate:r}=Ms(),{args:s,color:i}=Xt(n);Ct(s,()=>{r()});const o=At();return t({instance:o}),(e,t)=>(Rt(),Mt("TresMesh",Kt({ref_key:"sphereRef",ref:o},e.$attrs),[qt("TresSphereGeometry",{args:Lt(s)},null,8,fw),Zt(e.$slots,"default",{},()=>[qt("TresMeshBasicMaterial",{color:Lt(i)},null,8,gw)])],16))}});new g;const vw=["receive-shadow","rotation"],xw=["args"],bw=Tt({__name:"Backdrop",props:{floor:{default:.25},segments:{default:20},receiveShadow:{type:Boolean,default:!1}},setup(e,{expose:t}){const n=e,r=e=>0===e?0:2**(10*e-10),{floor:s,segments:i,receiveShadow:o}=Xt(n),a=St(null);Ct([i,s,a],([e,t,n])=>{if(!n||null===e)return;let s=0;const i=e/e/2,o=n.attributes.position;for(let a=0;a<e+1;a++)for(let n=0;n<e+1;n++)o.setXYZ(s++,a/e-i+(0===a?-t:0),n/e-i,r(a/e));o.needsUpdate=!0,n.computeVertexNormals()});const l=At();return t({instance:l}),(e,t)=>(Rt(),Mt("TresGroup",Kt({ref_key:"backdropRef",ref:l},e.$attrs),[qt("TresMesh",{"receive-shadow":Lt(o),rotation:[-Math.PI/2,0,Math.PI/2]},[qt("TresPlaneGeometry",{ref_key:"planeRef",ref:a,args:[1,1,Lt(i),Lt(i)]},null,8,xw),Zt(e.$slots,"default",{},()=>[t[0]||(t[0]=qt("TresMeshStandardMaterial",{color:8421504,side:2},null,-1))])],8,vw)],16))}}),_w=["object"],ww=Tt({__name:"ContactShadows",props:{opacity:{default:1},blur:{default:1},color:{default:"#000000"},tint:{default:void 0},scale:{default:10},width:{default:1},height:{default:1},far:{default:10},smooth:{type:Boolean,default:!0},resolution:{default:512},frames:{default:Number.POSITIVE_INFINITY},depthWrite:{type:Boolean,default:!1}},setup(e,{expose:t}){const n=e;function r(e,t,n){n.blurPlane.visible=!0,n.blurPlane.material=n.horizontalBlurMaterial,n.horizontalBlurMaterial.uniforms.tDiffuse.value=n.renderTarget.texture,n.horizontalBlurMaterial.uniforms.h.value=e/256,t.setRenderTarget(n.renderTargetBlur),t.render(n.blurPlane,n.shadowCamera),n.blurPlane.material=n.verticalBlurMaterial,n.verticalBlurMaterial.uniforms.tDiffuse.value=n.renderTargetBlur.texture,n.verticalBlurMaterial.uniforms.v.value=e/256,t.setRenderTarget(n.renderTarget),t.render(n.blurPlane,n.shadowCamera),n.blurPlane.visible=!1}const{onBeforeRender:s}=Os(),i=function(e){const t=new W,n=new X(e.resolution,e.resolution);n.texture.generateMipmaps=!1;const r=new X(e.resolution,e.resolution);r.texture.generateMipmaps=!1;const s=new G(e.width,e.height).rotateX(Math.PI/2),i=new m({map:n.texture,opacity:e.opacity,transparent:!0,depthWrite:e.depthWrite,color:new g(e.color??"black")}),o=new p(s,i);t.add(o),o.scale.y=-1;const a=new p(s);a.visible=!1,t.add(a);const l=new q(-e.width/2,e.width/2,e.height/2,-e.height/2,0,.3);l.rotation.x=Math.PI/2,t.add(l);const c=new Z,u=new K(Eu);u.depthTest=!1;const h=new K(Su);return h.depthTest=!1,{renderTarget:n,renderTargetBlur:r,shadowCamera:l,depthMaterial:c,horizontalBlurMaterial:u,verticalBlurMaterial:h,shadowGroup:t,plane:o,blurPlane:a}}(n);let o=0;const a=()=>o=o>=n.frames?n.frames-1:o;return s(({renderer:e,scene:t})=>{o<n.frames&&(o++,function(e,t,n,s){const{renderTarget:i,shadowCamera:o,depthMaterial:a}=s,l=t.background;t.background=null,t.overrideMaterial=a;const c=n.getClearAlpha();n.setClearAlpha(0),n.setRenderTarget(i),n.render(t,o),t.overrideMaterial=null,r(e.blur,n,s),e.smooth&&r(.4*e.blur,n,s),n.setRenderTarget(null),n.setClearAlpha(c),t.background=l}(n,Nt(t),e,i))}),Ct(()=>[n.opacity,n.depthWrite,n.blur,n.smooth],()=>{i.plane.material.opacity=n.opacity??1,i.plane.material.depthWrite=n.depthWrite??!1,a()},{immediate:!0}),Ct(()=>[n.color,n.tint],()=>{(function(e,t){t.plane.material.color=new g(e.color??"black"),t.depthMaterial.dispose(),t.depthMaterial=new Z,t.depthMaterial.onBeforeCompile=function(t){const n=e.tint?new g(e.tint):new g("white"),{r:r,g:s,b:i}=n,o=t.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );",`gl_FragColor = vec4( ${r}, ${s}, ${i}, ( 1.0 - fragCoordZ ) * opacity);`);t.fragmentShader=o}})(n,i),a()},{immediate:!0}),Ct(()=>[n.resolution],()=>{(function(e,t){t.renderTarget.dispose(),t.renderTargetBlur.dispose(),t.renderTarget=new X(e,e),t.renderTarget.texture.generateMipmaps=!1,t.renderTargetBlur=new X(e,e),t.renderTargetBlur.texture.generateMipmaps=!1,t.plane.material.map=t.renderTarget.texture})(n.resolution,i),a()}),Ct(()=>[n.width,n.height,n.scale,n.far],()=>{(function(e,t){const n=t.shadowCamera;n.left=-e.width/2,n.right=e.width/2,n.top=e.height/2,n.bottom=-e.height/2,n.far=e.far;const r=e.width*(Array.isArray(e.scale)?e.scale[0]:e.scale||1),s=e.height*(Array.isArray(e.scale)?e.scale[1]:e.scale||1);t.shadowGroup.scale.set(r,e.far,s)})(n,i),a()},{immediate:!0}),Pt(()=>{for(const e of Object.values(i))e&&"dispose"in e&&"function"==typeof e.dispose&&e.dispose()}),t({instance:i.shadowGroup}),(e,t)=>(Rt(),Mt("primitive",{object:Lt(i).shadowGroup},null,8,_w))}}),Tw=["size","color","alpha-map","map","opacity","alpha-test","depth-write","transparent","size-attenuation"],Ew=["position","velocity"],Sw=Tt({__name:"Precipitation",props:{size:{default:.1},area:{default:()=>[10,10,20]},color:{default:16777215},map:{},alphaMap:{},alphaTest:{default:.01},opacity:{default:.8},count:{default:5e3},speed:{default:.1},randomness:{default:.5},depthWrite:{type:Boolean,default:!1},transparent:{type:Boolean,default:!0},sizeAttenuation:{type:Boolean,default:!0}},setup(e,{expose:t}){const n=e,{size:r,area:s,color:i,alphaMap:o,map:a,opacity:l,alphaTest:c,depthWrite:u,transparent:h,sizeAttenuation:d,count:p,speed:m,randomness:f}=Xt(n),g=At();let y=[],v=[];const x=()=>{y=new Float32Array(3*p.value);for(let e=0;e<p.value;e++){const t=3*e;y[t]=(Math.random()-.5)*s.value[0],y[t+1]=(Math.random()-.5)*s.value[1],y[t+2]=(Math.random()-.5)*s.value[2]}},b=()=>{v=new Float32Array(2*p.value);for(let e=0;e<2*p.value;e+=2)v[e]=(Math.random()-.5)/5*m.value*f.value,v[e+1]=Math.random()/5*m.value};b(),x(),Ct(m,()=>{b()}),Ut(()=>{m.value||x()});const _=At(null),w=At(null);Ut(async()=>{if("string"==typeof o.value){const{state:e}=Sl(o.value);_.value=e.value}else _.value=o.value??null;if("string"==typeof a.value){const{state:e}=Sl(a.value);w.value=e.value}else w.value=a.value??null});const{onBeforeRender:T}=Os();T(()=>{if(g.value?.attributes.position.array&&g.value?.attributes.position.count){const e=g.value.attributes.position.array;for(let t=0;t<g.value.attributes.position.count;t++){const n=v[2*t],r=v[2*t+1];e[3*t]+=n,e[3*t+1]-=r,(e[3*t]<=-s.value[0]/2||e[3*t]>=s.value[0]/2)&&(e[3*t]=-1*e[3*t]),(e[3*t+1]<=-s.value[1]/2||e[3*t+1]>=s.value[1]/2)&&(e[3*t+1]=-1*e[3*t+1])}g.value.attributes.position.needsUpdate=!0}});const E=At();return t({instance:E}),(e,t)=>(Rt(),Mt("TresPoints",{ref_key:"pointsRef",ref:E},[qt("TresPointsMaterial",{size:Lt(r),color:Lt(i),"alpha-map":_.value,map:w.value,opacity:Lt(l),"alpha-test":Lt(c),"depth-write":Lt(u),transparent:Lt(h),"size-attenuation":Lt(d)},null,8,Tw),qt("TresBufferGeometry",{ref_key:"geometryRef",ref:g,position:[Lt(y),3],velocity:[Lt(v)]},null,8,Ew)],512))}}),Aw=["object","material-uniforms-turbidity-value","material-uniforms-rayleigh-value","material-uniforms-mieCoefficient-value","material-uniforms-mieDirectionalG-value","material-uniforms-sunPosition-value","scale"],Mw=Tt({__name:"Sky",props:{turbidity:{default:3.4},rayleigh:{default:3},mieCoefficient:{default:.005},mieDirectionalG:{default:.7},elevation:{default:.6},azimuth:{default:180},distance:{default:45e4}},setup(e,{expose:t}){const n=e,{invalidate:r}=Ms();Ct(n,()=>{r()});const s=new Kl,i=Yt(()=>function(e,t){const n=R.degToRad(90-t),r=R.degToRad(e);return(new b).setFromSphericalCoords(1,n,r)}(n.azimuth,n.elevation));return t({instance:s,sunPosition:i.value}),(e,t)=>(Rt(),Mt("primitive",{object:Lt(s),"material-uniforms-turbidity-value":n.turbidity,"material-uniforms-rayleigh-value":n.rayleigh,"material-uniforms-mieCoefficient-value":n.mieCoefficient,"material-uniforms-mieDirectionalG-value":n.mieDirectionalG,"material-uniforms-sunPosition-value":i.value,scale:n.distance},null,8,Aw))}}),Ow=["position","a-scale"],Cw=["size","size-attenuation","transparent","alpha-test","alpha-map"],Nw=Tt({__name:"Stars",props:{size:{default:.1},sizeAttenuation:{type:Boolean,default:!0},transparent:{type:Boolean,default:!0},alphaTest:{default:.01},count:{default:5e3},depth:{default:50},radius:{default:100},alphaMap:{default:null}},setup(e,{expose:t}){const n=e,r=St(),s=St(),{radius:i,depth:o,count:a,size:l,sizeAttenuation:c,transparent:u,alphaMap:h,alphaTest:d}=Xt(n),{invalidate:p}=Ms();Ct(n,()=>{p()});Ut(()=>{(()=>{let e=i.value+o.value;const t=Yt(()=>o.value/a.value),n=[],l=Array.from({length:a.value},()=>4*(.5+.5*Math.random())),c=e=>(new b).setFromSpherical(new J(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)).toArray();for(let r=0;r<a.value;r++)e-=t.value*Math.random(),n.push(...c(e));r.value=new Float32Array(n),s.value=new Float32Array(l)})()});const m=At();return t({instance:m}),(e,t)=>(Rt(),Mt("TresPoints",{ref_key:"starsRef",ref:m},[qt("TresBufferGeometry",{position:[r.value,3],"a-scale":[s.value,1]},null,8,Ow),qt("TresPointsMaterial",{size:Lt(l),"size-attenuation":Lt(c),transparent:Lt(u),"alpha-test":Lt(d),"alpha-map":Lt(h)},null,8,Cw)],512))}});class Pw extends y{virtualScene=null;constructor(){super(),this.virtualScene=new n}add(...e){for(const t of e)this.virtualScene.add(t);return this}dispose(){this.virtualScene.traverse(e=>{e instanceof p&&(e.geometry.dispose(),e.material.dispose(),e.material.map&&e.material.map.dispose(),this.virtualScene.remove(e))}),this.virtualScene=null}}const Rw=Tt({__name:"component",props:{background:{type:[Boolean,String],default:!1},blur:{default:0},files:{default:()=>[]},path:{default:""},preset:{default:void 0},resolution:{default:256},near:{default:1},far:{default:1e3},frames:{default:Number.POSITIVE_INFINITY},backgroundIntensity:{default:1},backgroundRotation:{},environmentIntensity:{default:1},environmentRotation:{},syncMaterials:{type:Boolean}},async setup(e,{expose:t}){let n,r;const s=e,i=St(null);t({texture:i});const{extend:o,renderer:a,scene:l}=As();o({EnvironmentScene:Pw});let c=null;const u=St(null);let h=null;const d=St(null),g=([n,r]=Qt(()=>ju(s,u)),n=await n,r(),n),{onBeforeRender:y}=Os();let v=1;y(()=>{if(h&&d.value&&u.value&&(s.frames===Number.POSITIVE_INFINITY||v<s.frames)){const e=a.instance.autoClear;a.instance.autoClear=!0;const t=Jt(d.value).virtualScene;h.update(a.instance,t),a.instance.autoClear=e,v++}},-1),Ct([g,d],([e,t])=>{if(e&&t?.virtualScene){const n=Jt(t).virtualScene;let r=n.children.find(e=>e instanceof p&&e.userData.isEnvironment);r||(r=new p(new B(1,1,1),new m({side:f})),r.userData.isEnvironment=!0,n.add(r)),n.background=e,n.backgroundBlurriness=s.blur}},{immediate:!0});const x=e=>{e&&c?.length?(l.value.environment=e.texture,s.background&&(l.value.background=e.texture)):g.value&&(l.value.environment=g.value,s.background&&(l.value.background=g.value))};return Ct(g,()=>{u.value&&x(u.value)},{immediate:!0,deep:!0}),Ct(()=>Et().default,e=>{if(e&&(c=e(),Array.isArray(c)&&c.length>0))return o({EnvironmentScene:Pw}),u.value=new V(s.resolution),u.value.texture.type=j,h=new H(s.near,s.far,u.value),void x(u.value);u.value?.dispose(),u.value=null,x()},{immediate:!0,deep:!0}),i.value=g.value,Pt(()=>{d.value?.dispose(),u.value?.dispose()}),(e,t)=>u.value?(Rt(),Mt("TresEnvironmentScene",{key:0,ref_key:"environmentScene",ref:d},[Zt(e.$slots,"default")],512)):Gt("",!0)}});Boolean,new g(16777215);let Iw=class{static isWebGL2Available(){try{const e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch{return!1}}static isColorSpaceAvailable(e){try{const t=document.createElement("canvas"),n=window.WebGL2RenderingContext&&t.getContext("webgl2");return n.drawingBufferColorSpace=e,n.drawingBufferColorSpace===e}catch{return!1}}static getWebGL2ErrorMessage(){return this._getErrorMessage(2)}static _getErrorMessage(e){const t={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext};let n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>';const r=document.createElement("div");return r.id="webglmessage",r.style.fontFamily="monospace",r.style.fontSize="13px",r.style.fontWeight="normal",r.style.textAlign="center",r.style.background="#fff",r.style.color="#000",r.style.padding="1.5em",r.style.width="400px",r.style.margin="5em auto 0",n=t[e]?n.replace("$0","graphics card"):n.replace("$0","browser"),n=n.replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),r.innerHTML=n,r}};const Lw=Symbol("effectComposerPmndrs"),kw=Tt({__name:"EffectComposerPmndrs",props:{enabled:{type:Boolean,default:!0},depthBuffer:{type:Boolean,default:void 0},disableNormalPass:{type:Boolean,default:!1},stencilBuffer:{type:Boolean,default:void 0},resolutionScale:{},autoClear:{type:Boolean,default:!0},multisampling:{default:0},frameBufferType:{default:j}},emits:["render"],setup(e,{expose:t,emit:n}){const r=e,s=n,{scene:i,camera:o,renderer:a,sizes:l}=As(),c=At(null);let u=null,h=null;Bt(Lw,c),t({composer:c});const d=Yt(()=>{const e=new vn,t={depthBuffer:void 0!==r.depthBuffer?r.depthBuffer:e.inputBuffer.depthBuffer,stencilBuffer:void 0!==r.stencilBuffer?r.stencilBuffer:e.inputBuffer.stencilBuffer,multisampling:Iw.isWebGL2Available()?void 0!==r.multisampling?r.multisampling:e.multisampling:0,frameBufferType:void 0!==r.frameBufferType?r.frameBufferType:j};return e.dispose(),t}),p=()=>{!a.instance&&!i.value&&!o.activeCamera.value||(c.value?.dispose(),c.value=new vn(a.instance,d.value),c.value.addPass(new xn(i.value,o.activeCamera.value)),r.disableNormalPass||c.value&&(h=new _n(i.value,o.activeCamera.value),h.enabled=!1,c.value.addPass(h),void 0!==r.resolutionScale&&Iw.isWebGL2Available()&&(u=new wn({normalBuffer:h.texture,resolutionScale:r.resolutionScale}),u.enabled=!1,c.value.addPass(u))))};return Ct([i,o.activeCamera,()=>r.disableNormalPass],()=>{!l.width.value||!l.height.value||p()}),Ct(()=>[l.width.value,l.height.value],([e,t])=>{!e&&!t||(c.value?c.value.setSize(e,t):p())},{immediate:!0}),a.replaceRenderFunction(e=>{if(r.enabled&&a.instance&&c.value&&l.width.value&&l.height.value){const t=a.instance.autoClear;a.instance.autoClear=r.autoClear,r.stencilBuffer&&!r.autoClear&&a.instance.clearStencil(),c.value.render(),s("render",c.value),a.instance.autoClear=t,e()}}),Pt(()=>{c.value?.dispose()}),(e,t)=>Zt(e.$slots,"default")}}),Dw=(e,t,n)=>{const r=an(Lw),s=At(null),i=At(null),{scene:o,camera:a,invalidate:l}=Ms();Ct(t,()=>l());const c=()=>{s.value&&r?.value?.removePass(s.value),i.value?.dispose(),s.value?.dispose()},u=t=>{!a.value||!r?.value||!o.value||(i.value=e(),s.value=new An(a.value,i.value),r.value.addPass(s.value,t))};n&&Ct(()=>n.map(e=>t[e]),()=>{if(!r?.value)return;const e=r.value?.passes.findIndex(e=>e===s.value);~e&&(c(),u(e))}),Ut(()=>{!a.value||!i?.value||(i.value.mainCamera=a.value)});const h=Ut(()=>{!a.value||!r?.value||!o.value||(ln(()=>h()),!i.value&&u())});return Pt(()=>{c()}),{pass:s,effect:i}},zw=/([^[.\]])+/g,Uw=(e,t,n)=>{const r=Array.isArray(t)?t:t.match(zw);r&&r.reduce((e,t,s)=>(void 0===e[t]&&(e[t]={}),s===r.length-1&&(e[t]=n),e[t]),e)},Fw=(e,t,n,r,s={})=>Ct(e,s=>{if(t.value)if(void 0===s){const e=r();Uw(t.value,n,((e,t)=>t?(Array.isArray(t)?t:t.match(zw))?.reduce((e,t)=>e&&e[t],e):void 0)(e,n)),e.dispose?.()}else Uw(t.value,n,e())},s),Bw=(e,t,n)=>e.map(([e,r])=>Fw(e,t,r,n)),Vw=Tt({__name:"BloomPmndrs",props:{blendFunction:{},intensity:{},kernelSize:{},luminanceThreshold:{},luminanceSmoothing:{},mipmapBlur:{type:Boolean,default:void 0}},setup(e,{expose:t}){const n=e,{pass:r,effect:s}=Dw(()=>new Tn(n),n,["mipmapBlur"]);return t({pass:r,effect:s}),Bw([[()=>n.blendFunction,"blendMode.blendFunction"],[()=>n.intensity,"intensity"],[()=>n.kernelSize,"kernelSize"],[()=>n.luminanceSmoothing,"luminanceMaterial.smoothing"],[()=>n.luminanceThreshold,"luminanceMaterial.threshold"]],s,()=>new Tn),()=>{}}}),jw=Tt({__name:"OutlinePmndrs",props:{outlinedObjects:{},blur:{type:Boolean,default:void 0},xRay:{type:Boolean,default:void 0},kernelSize:{},pulseSpeed:{},resolutionX:{},resolutionY:{},edgeStrength:{},patternScale:{},multisampling:{},blendFunction:{},patternTexture:{},resolutionScale:{},hiddenEdgeColor:{},visibleEdgeColor:{}},setup(e,{expose:t}){const n=e,r=e=>void 0!==e?cl(e).getHex():void 0,{camera:s,scene:i}=Ms(),{pass:o,effect:a}=Dw(()=>new Sn(i.value,s.value,{blur:n.blur,xRay:n.xRay,kernelSize:n.kernelSize,pulseSpeed:n.pulseSpeed,resolutionX:n.resolutionX,resolutionY:n.resolutionY,patternScale:n.patternScale,edgeStrength:n.edgeStrength,blendFunction:n.blendFunction,multisampling:n.multisampling,patternTexture:n.patternTexture,resolutionScale:n.resolutionScale,hiddenEdgeColor:r(n.hiddenEdgeColor),visibleEdgeColor:r(n.visibleEdgeColor)}),n);t({pass:o,effect:a}),Ct([()=>n.outlinedObjects,a],()=>{a.value?.selection.set(n.outlinedObjects||[])},{immediate:!0});const l=Yt(()=>({hiddenEdgeColor:n.hiddenEdgeColor?cl(n.hiddenEdgeColor):void 0,visibleEdgeColor:n.visibleEdgeColor?cl(n.visibleEdgeColor):void 0}));return Bw([[()=>n.blendFunction,"blendMode.blendFunction"],[()=>n.blur,"blur"],[()=>n.xRay,"xRay"],[()=>n.pulseSpeed,"pulseSpeed"],[()=>n.kernelSize,"kernelSize"],[()=>n.edgeStrength,"edgeStrength"],[()=>n.patternScale,"patternScale"],[()=>n.multisampling,"multisampling"],[()=>n.resolutionX,"resolution.width"],[()=>n.resolutionY,"resolution.height"],[()=>n.patternTexture,"patternTexture"],[()=>n.resolutionScale,"resolution.scale"],[()=>l.value.hiddenEdgeColor,"hiddenEdgeColor"],[()=>l.value.visibleEdgeColor,"visibleEdgeColor"]],a,()=>new Sn),()=>{}}}),Hw=Tt({__name:"ChromaticAberrationPmndrs",props:{blendFunction:{},offset:{},radialModulation:{type:Boolean,default:void 0},modulationOffset:{}},setup(e,{expose:t}){const n=e,r=new bn,{pass:s,effect:i}=Dw(()=>new bn({...n,radialModulation:n.radialModulation??r.radialModulation,modulationOffset:n.modulationOffset??r.modulationOffset}),n);return r.dispose(),t({pass:s,effect:i}),Bw([[()=>n.blendFunction,"blendMode.blendFunction"],[()=>n.offset,"offset"],[()=>n.radialModulation,"radialModulation"],[()=>n.modulationOffset,"modulationOffset"]],i,()=>new bn),()=>{}}}),Yw=Tt({__name:"GridPmndrs",props:{blendFunction:{},scale:{},lineWidth:{}},setup(e,{expose:t}){const n=e,{pass:r,effect:s}=Dw(()=>new En(n),n);return t({pass:r,effect:s}),Bw([[()=>n.blendFunction,"blendMode.blendFunction"],[()=>n.scale,"scale"],[()=>n.lineWidth,"lineWidth"]],s,()=>new En),()=>{}}}),Ww={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class Xw{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Gw=new q(-1,1,1,-1,0,1);const qw=new class extends u{constructor(){super(),this.setAttribute("position",new h([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new h([0,2,0,0,2,0],2))}};class Zw{constructor(e){this._mesh=new p(qw,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Gw)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Kw extends Xw{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof K?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=ne.clone(e.uniforms),this.material=new K({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new Zw(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}let Qw=class extends Xw{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;let i,o;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(i=0,o=1):(i=1,o=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,i,4294967295),s.buffers.stencil.setClear(o),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}};class Jw extends Xw{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class $w{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const n=e.getSize(new T);this._width=n.width,this._height=n.height,(t=new X(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:j})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Kw(Ww),this.copyPass.material.blending=ut,this.clock=new P}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const t=this.passes[r];if(!1!==t.enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),t.needsSwap){if(n){const t=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Qw&&(t instanceof Qw?n=!0:t instanceof Jw&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new T);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class eT extends Xw{constructor(e,t,n=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new g}render(e,t,n){const r=e.autoClear;let s,i;e.autoClear=!1,null!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(s),null!==this.overrideMaterial&&(this.scene.overrideMaterial=i),e.autoClear=r}}const tT=Symbol("effectComposerThree"),nT=Tt({__name:"EffectComposer",props:{enabled:{type:Boolean,default:!0},withoutRenderPass:{type:Boolean}},setup(e,{expose:t}){const n=e,r=At(null);Bt(tT,r),t({composer:r});const{renderer:s,sizes:i,scene:o,camera:a}=As();Ut(()=>{r.value?.dispose(),r.value=new $w(s.instance)}),Ut(()=>{const{width:e,height:t}=i;t.value&&e.value&&r.value?.setSize(e.value,t.value)});const{pixelRatio:l}=Fn();return Ut(()=>{r.value?.setPixelRatio(l.value)}),n.withoutRenderPass||Ut(()=>{a.activeCamera.value&&o.value&&r.value&&r.value.addPass(new eT(o.value,a.activeCamera.value))}),s.replaceRenderFunction(e=>{r.value&&n.enabled&&(r.value.render(),e())}),Pt(()=>{r.value?.dispose()}),(e,t)=>Zt(e.$slots,"default")}}),rT=(e,t,n)=>{if(!t&&n)throw new Error("passDependencies is required when dependencyFieldsTriggeringRecreation is provided");const r=an(tT),s=At(e()),{sizes:i,invalidate:o}=Ms();t&&Ct(t,()=>o());const a=()=>{r?.value?.removePass(s.value),s.value.dispose()},l=Ut(()=>{!r?.value||!i.height.value||!i.width.value||(r.value.addPass(s.value),ln(()=>l()))});return n&&Ct(()=>n.map(e=>t?.[e]),()=>{if(!r?.value)return;const t=r.value.passes.findIndex(e=>e===s.value);~t&&(a(),s.value=e(),r.value.insertPass(s.value,t))}),Pt(()=>{a()}),{pass:s}},sT={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tfloat disp = texture2D(tDisp, p*seed*seed).r;\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=disp*seed_x*(seed/5.);\n\t\t\t\tp.y+=disp*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"};let iT=class extends Xw{constructor(e=64){super(),this.uniforms=ne.clone(sT.uniforms),this.material=new K({uniforms:this.uniforms,vertexShader:sT.vertexShader,fragmentShader:sT.fragmentShader}),this.goWild=!1,this._heightMap=this._generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this._fsQuad=new Zw(this.material),this._curF=0,this._randX=0,this._generateTrigger()}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this._curF%this._randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=R.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=R.randFloat(-1,1),this.uniforms.seed_y.value=R.randFloat(-1,1),this.uniforms.distortion_x.value=R.randFloat(0,1),this.uniforms.distortion_y.value=R.randFloat(0,1),this._curF=0,this._generateTrigger()):this._curF%this._randX<this._randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=R.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=R.randFloat(0,1),this.uniforms.distortion_y.value=R.randFloat(0,1),this.uniforms.seed_x.value=R.randFloat(-.3,.3),this.uniforms.seed_y.value=R.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this._curF++,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this._fsQuad.render(e))}dispose(){this.material.dispose(),this.heightMap.dispose(),this._fsQuad.dispose()}_generateTrigger(){this._randX=R.randInt(120,240)}_generateHeightmap(e){const t=new Float32Array(e*e),n=e*e;for(let s=0;s<n;s++){const e=R.randFloat(0,1);t[s]=e}const r=new dt(t,e,e,pt,de);return r.needsUpdate=!0,r}};const oT=Tt({__name:"Glitch",props:{dtSize:{},goWild:{type:Boolean}},setup(e,{expose:t}){const n=e,{pass:r}=rT(()=>new iT(n.dtSize),n,["dtSize"]),{invalidate:s}=Ms();t({pass:r});const{onBeforeRender:i}=Os();return i(()=>s()),Bw([[()=>n.goWild,"goWild"]],r,()=>new iT),()=>{}}}),aT={name:"OutputShader",uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:"\n\t\tprecision highp float;\n\n\t\tuniform mat4 modelViewMatrix;\n\t\tuniform mat4 projectionMatrix;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\t#include <tonemapping_pars_fragment>\n\t\t#include <colorspace_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t// tone mapping\n\n\t\t\t#ifdef LINEAR_TONE_MAPPING\n\n\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( AGX_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\n\t\t\t#endif\n\n\t\t\t// color space\n\n\t\t\t#ifdef SRGB_TRANSFER\n\n\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\n\t\t\t#endif\n\n\t\t}"};class lT extends Xw{constructor(){super(),this.uniforms=ne.clone(aT.uniforms),this.material=new mt({name:aT.name,uniforms:this.uniforms,vertexShader:aT.vertexShader,fragmentShader:aT.fragmentShader}),this._fsQuad=new Zw(this.material),this._outputColorSpace=null,this._toneMapping=null}render(e,n,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.toneMappingExposure.value=e.toneMappingExposure,(this._outputColorSpace!==e.outputColorSpace||this._toneMapping!==e.toneMapping)&&(this._outputColorSpace=e.outputColorSpace,this._toneMapping=e.toneMapping,this.material.defines={},ft.getTransfer(this._outputColorSpace)===gt&&(this.material.defines.SRGB_TRANSFER=""),this._toneMapping===yt?this.material.defines.LINEAR_TONE_MAPPING="":this._toneMapping===vt?this.material.defines.REINHARD_TONE_MAPPING="":this._toneMapping===xt?this.material.defines.CINEON_TONE_MAPPING="":this._toneMapping===t?this.material.defines.ACES_FILMIC_TONE_MAPPING="":this._toneMapping===bt?this.material.defines.AGX_TONE_MAPPING="":this._toneMapping===_t?this.material.defines.NEUTRAL_TONE_MAPPING="":this._toneMapping===wt&&(this.material.defines.CUSTOM_TONE_MAPPING=""),this.material.needsUpdate=!0),!0===this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}const cT=Tt({__name:"Output",setup(e,{expose:t}){const{pass:n}=rT(()=>new lT);return t({pass:n}),()=>{}}}),uT={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new T(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAAEdgeDetectionVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\n\t\tvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n\t\t\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n\t\t\t// Calculate color deltas:\n\t\t\tvec4 delta;\n\t\t\tvec3 C = texture2D( colorTex, texcoord ).rgb;\n\n\t\t\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n\t\t\tvec3 t = abs( C - Cleft );\n\t\t\tdelta.x = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n\t\t\tt = abs( C - Ctop );\n\t\t\tdelta.y = max( max( t.r, t.g ), t.b );\n\n\t\t\t// We do the usual threshold:\n\t\t\tvec2 edges = step( threshold, delta.xy );\n\n\t\t\t// Then discard if there is no edge:\n\t\t\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n\t\t\t\tdiscard;\n\n\t\t\t// Calculate right and bottom deltas:\n\t\t\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n\t\t\tt = abs( C - Cright );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n\t\t\tt = abs( C - Cbottom );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the maximum delta in the direct neighborhood:\n\t\t\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n\t\t\t// Calculate left-left and top-top deltas:\n\t\t\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n\t\t\tt = abs( C - Cleftleft );\n\t\t\tdelta.z = max( max( t.r, t.g ), t.b );\n\n\t\t\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n\t\t\tt = abs( C - Ctoptop );\n\t\t\tdelta.w = max( max( t.r, t.g ), t.b );\n\n\t\t\t// Calculate the final maximum delta:\n\t\t\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n\t\t\t// Local contrast adaptation in action:\n\t\t\tedges.xy *= step( 0.5 * maxDelta, delta.xy );\n\n\t\t\treturn vec4( edges, 0.0, 0.0 );\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );\n\n\t\t}"},hT={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new T(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 3 ];\n\t\tvarying vec2 vPixcoord;\n\n\t\tvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n\t\t\tvPixcoord = texcoord / resolution;\n\n\t\t\t// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components\n\n\t\t\t// And these for the searches, they indicate the ends of the loops:\n\t\t\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAABlendingWeightCalculationVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\t#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tArea;\n\t\tuniform sampler2D tSearch;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[3];\n\t\tvarying vec2 vPixcoord;\n\n\t\t#if __VERSION__ == 100\n\t\tvec2 round( vec2 x ) {\n\t\t\treturn sign( x ) * floor( abs( x ) + 0.5 );\n\t\t}\n\t\t#endif\n\n\t\tfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n\t\t\t// Not required if searchTex accesses are set to point:\n\t\t\t// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);\n\t\t\t// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +\n\t\t\t//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\n\t\t\te.r = bias + e.r * scale;\n\t\t\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;\n\t\t}\n\n\t\tfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\t/**\n\t\t\t\t* @PSEUDO_GATHER4\n\t\t\t\t* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to\n\t\t\t\t* sample between edge, thus fetching four edges in a row.\n\t\t\t\t* Sampling with different offsets in each direction allows to disambiguate\n\t\t\t\t* which edges are active from the four fetched ones.\n\t\t\t\t*/\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\t// We correct the previous (-0.25, -0.125) offset we applied:\n\t\t\ttexcoord.x += 0.25 * resolution.x;\n\n\t\t\t// The searches are bias by 1, so adjust the coords accordingly:\n\t\t\ttexcoord.x += resolution.x;\n\n\t\t\t// Disambiguate the length added by the last step:\n\t\t\ttexcoord.x += 2.0 * resolution.x; // Undo last step\n\t\t\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 0.0, 1.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;\n\t\t\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.x -= 0.25 * resolution.x;\n\t\t\ttexcoord.x -= resolution.x;\n\t\t\ttexcoord.x -= 2.0 * resolution.x;\n\t\t\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\n\t\t\treturn texcoord.x;\n\t\t}\n\n\t\tfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n\t\t\tvec2 e = vec2( 1.0, 0.0 );\n\n\t\t\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n\t\t\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;\n\t\t\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign\n\t\t\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n\t\t\t}\n\n\t\t\ttexcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign\n\t\t\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign\n\n\t\t\treturn texcoord.y;\n\t\t}\n\n\t\tvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n\t\t\t// Rounding prevents precision errors of bilinear filtering:\n\t\t\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\n\t\t\t// We do a scale and bias for mapping to texel space:\n\t\t\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\n\t\t\t// Move to proper place, according to the subpixel offset:\n\t\t\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\n\t\t\treturn texture2D( areaTex, texcoord, 0.0 ).rg;\n\t\t}\n\n\t\tvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n\t\t\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\t\t\tvec2 e = texture2D( edgesTex, texcoord ).rg;\n\n\t\t\tif ( e.g > 0.0 ) { // Edge at north\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the left:\n\t\t\t\tvec2 coords;\n\t\t\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n\t\t\t\tcoords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)\n\t\t\t\td.x = coords.x;\n\n\t\t\t\t// Now fetch the left crossing edges, two at a time using bilinear\n\t\t\t\t// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to\n\t\t\t\t// discern what value each edge has:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\n\t\t\t\t// Find the distance to the right:\n\t\t\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n\t\t\t\td.y = coords.x;\n\n\t\t\t\t// We want the distances to be in pixel units (doing this here allow to\n\t\t\t\t// better interleave arithmetic and memory accesses):\n\t\t\t\td = d / resolution.x - pixcoord.x;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the right crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\n\t\t\t\t// Ok, we know how this pattern looks like, now it is time for getting\n\t\t\t\t// the actual area:\n\t\t\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n\t\t\t}\n\n\t\t\tif ( e.r > 0.0 ) { // Edge at west\n\t\t\t\tvec2 d;\n\n\t\t\t\t// Find the distance to the top:\n\t\t\t\tvec2 coords;\n\n\t\t\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n\t\t\t\tcoords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;\n\t\t\t\td.x = coords.y;\n\n\t\t\t\t// Fetch the top crossing edges:\n\t\t\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\n\t\t\t\t// Find the distance to the bottom:\n\t\t\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n\t\t\t\td.y = coords.y;\n\n\t\t\t\t// We want the distances to be in pixel units:\n\t\t\t\td = d / resolution.y - pixcoord.y;\n\n\t\t\t\t// SMAAArea below needs a sqrt, as the areas texture is compressed\n\t\t\t\t// quadratically:\n\t\t\t\tvec2 sqrt_d = sqrt( abs( d ) );\n\n\t\t\t\t// Fetch the bottom crossing edges:\n\t\t\t\tcoords.y -= 1.0 * resolution.y; // WebGL port note: Added\n\t\t\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\n\t\t\t\t// Get the area for this direction:\n\t\t\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n\t\t\t}\n\n\t\t\treturn weights;\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );\n\n\t\t}"},dT={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new T(1/1024,1/512)}},vertexShader:"\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n\t\t\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component\n\t\t\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tSMAANeighborhoodBlendingVS( vUv );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tColor;\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec4 vOffset[ 2 ];\n\n\t\tvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n\t\t\t// Fetch the blending weights for current pixel:\n\t\t\tvec4 a;\n\t\t\ta.xz = texture2D( blendTex, texcoord ).xz;\n\t\t\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n\t\t\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\n\t\t\t// Is there any blending weight with a value greater than 0.0?\n\t\t\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n\t\t\t\treturn texture2D( colorTex, texcoord, 0.0 );\n\t\t\t} else {\n\t\t\t\t// Up to 4 lines can be crossing a pixel (one through each edge). We\n\t\t\t\t// favor blending by choosing the line with the maximum weight for each\n\t\t\t\t// direction:\n\t\t\t\tvec2 offset;\n\t\t\t\toffset.x = a.a > a.b ? a.a : -a.b; // left vs. right\n\t\t\t\toffset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs\n\n\t\t\t\t// Then we go in the direction that has the maximum weight:\n\t\t\t\tif ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical\n\t\t\t\t\toffset.y = 0.0;\n\t\t\t\t} else {\n\t\t\t\t\toffset.x = 0.0;\n\t\t\t\t}\n\n\t\t\t\t// Fetch the opposite color and lerp by hand:\n\t\t\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\ttexcoord += sign( offset ) * resolution;\n\t\t\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n\t\t\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\n\t\t\t\t// WebGL port note: Added gamma correction\n\t\t\t\tC.xyz = pow(C.xyz, vec3(2.2));\n\t\t\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));\n\t\t\t\tvec4 mixed = mix(C, Cop, s);\n\t\t\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));\n\n\t\t\t\treturn mixed;\n\t\t\t}\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );\n\n\t\t}"};class pT extends Xw{constructor(){super(),this._edgesRT=new X(1,1,{depthBuffer:!1,type:j}),this._edgesRT.texture.name="SMAAPass.edges",this._weightsRT=new X(1,1,{depthBuffer:!1,type:j}),this._weightsRT.texture.name="SMAAPass.weights";const e=this,t=new Image;t.src=this._getAreaTexture(),t.onload=function(){e._areaTexture.needsUpdate=!0},this._areaTexture=new U,this._areaTexture.name="SMAAPass.area",this._areaTexture.image=t,this._areaTexture.minFilter=Se,this._areaTexture.generateMipmaps=!1,this._areaTexture.flipY=!1;const n=new Image;n.src=this._getSearchTexture(),n.onload=function(){e._searchTexture.needsUpdate=!0},this._searchTexture=new U,this._searchTexture.name="SMAAPass.search",this._searchTexture.image=n,this._searchTexture.magFilter=Ue,this._searchTexture.minFilter=Ue,this._searchTexture.generateMipmaps=!1,this._searchTexture.flipY=!1,this._uniformsEdges=ne.clone(uT.uniforms),this._materialEdges=new K({defines:Object.assign({},uT.defines),uniforms:this._uniformsEdges,vertexShader:uT.vertexShader,fragmentShader:uT.fragmentShader}),this._uniformsWeights=ne.clone(hT.uniforms),this._uniformsWeights.tDiffuse.value=this._edgesRT.texture,this._uniformsWeights.tArea.value=this._areaTexture,this._uniformsWeights.tSearch.value=this._searchTexture,this._materialWeights=new K({defines:Object.assign({},hT.defines),uniforms:this._uniformsWeights,vertexShader:hT.vertexShader,fragmentShader:hT.fragmentShader}),this._uniformsBlend=ne.clone(dT.uniforms),this._uniformsBlend.tDiffuse.value=this._weightsRT.texture,this._materialBlend=new K({uniforms:this._uniformsBlend,vertexShader:dT.vertexShader,fragmentShader:dT.fragmentShader}),this._fsQuad=new Zw(null)}render(e,t,n){this._uniformsEdges.tDiffuse.value=n.texture,this._fsQuad.material=this._materialEdges,e.setRenderTarget(this._edgesRT),this.clear&&e.clear(),this._fsQuad.render(e),this._fsQuad.material=this._materialWeights,e.setRenderTarget(this._weightsRT),this.clear&&e.clear(),this._fsQuad.render(e),this._uniformsBlend.tColor.value=n.texture,this._fsQuad.material=this._materialBlend,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this._fsQuad.render(e))}setSize(e,t){this._edgesRT.setSize(e,t),this._weightsRT.setSize(e,t),this._materialEdges.uniforms.resolution.value.set(1/e,1/t),this._materialWeights.uniforms.resolution.value.set(1/e,1/t),this._materialBlend.uniforms.resolution.value.set(1/e,1/t)}dispose(){this._edgesRT.dispose(),this._weightsRT.dispose(),this._areaTexture.dispose(),this._searchTexture.dispose(),this._materialEdges.dispose(),this._materialWeights.dispose(),this._materialBlend.dispose(),this._fsQuad.dispose()}_getAreaTexture(){return"data:image/png;base64,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"}_getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}}const mT=Tt({__name:"SMAA",props:{width:{},height:{}},setup(e,{expose:t}){const n=e,{sizes:r}=As(),{pixelRatio:s}=Fn(),i=Yt(()=>n.width??r.width.value*s.value),o=Yt(()=>n.height??r.height.value*s.value),{pass:a}=rT(()=>new pT,n);return t({pass:a}),Ut(()=>{a.value.setSize(i.value,o.value)}),()=>{}}}),fT={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new g(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat v = luminance( texel.xyz );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};let gT=class e extends Xw{constructor(e,t=1,n,r){super(),this.strength=t,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new T(e.x,e.y):new T(256,256),this.clearColor=new g(0,0,0),this.needsSwap=!1,this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2);this.renderTargetBright=new X(s,i,{type:j}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let l=0;l<this.nMips;l++){const e=new X(s,i,{type:j});e.texture.name="UnrealBloomPass.h"+l,e.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(e);const t=new X(s,i,{type:j});t.texture.name="UnrealBloomPass.v"+l,t.texture.generateMipmaps=!1,this.renderTargetsVertical.push(t),s=Math.round(s/2),i=Math.round(i/2)}const o=fT;this.highPassUniforms=ne.clone(o.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new K({uniforms:this.highPassUniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}),this.separableBlurMaterials=[];const a=[3,5,7,9,11];s=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2);for(let l=0;l<this.nMips;l++)this.separableBlurMaterials.push(this._getSeparableBlurMaterial(a[l])),this.separableBlurMaterials[l].uniforms.invSize.value=new T(1/s,1/i),s=Math.round(s/2),i=Math.round(i/2);this.compositeMaterial=this._getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new b(1,1,1),new b(1,1,1),new b(1,1,1),new b(1,1,1),new b(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.copyUniforms=ne.clone(Ww.uniforms),this.blendMaterial=new K({uniforms:this.copyUniforms,vertexShader:Ww.vertexShader,fragmentShader:Ww.fragmentShader,blending:ht,depthTest:!1,depthWrite:!1,transparent:!0}),this._oldClearColor=new g,this._oldClearAlpha=1,this._basic=new m,this._fsQuad=new Zw(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this._basic.dispose(),this._fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(n,r),this.renderTargetsVertical[s].setSize(n,r),this.separableBlurMaterials[s].uniforms.invSize.value=new T(1/n,1/r),n=Math.round(n/2),r=Math.round(r/2)}render(t,n,r,s,i){t.getClearColor(this._oldClearColor),this._oldClearAlpha=t.getClearAlpha();const o=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),i&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this._fsQuad.material=this._basic,this._basic.map=r.texture,t.setRenderTarget(null),t.clear(),this._fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this._fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this._fsQuad.render(t);let a=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this._fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[l].uniforms.direction.value=e.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[l]),t.clear(),this._fsQuad.render(t),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=e.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[l]),t.clear(),this._fsQuad.render(t),a=this.renderTargetsVertical[l];this._fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this._fsQuad.render(t),this._fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this._fsQuad.render(t)):(t.setRenderTarget(r),this._fsQuad.render(t)),t.setClearColor(this._oldClearColor,this._oldClearAlpha),t.autoClear=o}_getSeparableBlurMaterial(e){const t=[];for(let n=0;n<e;n++)t.push(.39894*Math.exp(-.5*n*n/(e*e))/e);return new K({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new T(.5,.5)},direction:{value:new T(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 invSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float gaussianCoefficients[KERNEL_RADIUS];\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tfloat weightSum = gaussianCoefficients[0];\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianCoefficients[i];\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}_getCompositeMaterial(e){return new K({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}};gT.BlurDirectionX=new T(1,0),gT.BlurDirectionY=new T(0,1);const yT=Tt({__name:"UnrealBloom",props:{radius:{default:0},strength:{default:1},threshold:{default:0}},setup(e,{expose:t}){const n=e,{sizes:r}=As(),{pass:s}=rT(()=>new gT(new T(r.width.value,r.height.value),n.radius,n.strength,n.threshold),n);return t({pass:s}),Ut(()=>{s.value.radius=n.radius??s.value.getCompositeMaterial().uniforms.bloomRadius?.value??.1}),Ut(()=>{s.value.strength=n.strength??s.value.getCompositeMaterial().uniforms.bloomStrength?.value??1}),Ut(()=>{s.value.threshold=n.threshold??fT.uniforms.luminosityThreshold?.value??1}),()=>{}}}),vT=typeof window<"u"&&typeof document<"u";function xT(e,t={}){if(!Ht(e))return Xt(e);const n=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const r in e.value)n[r]=yn(()=>({get:()=>e.value[r],set(n){var s;if(null==(s=Nt(t.replaceRef))||s)if(Array.isArray(e.value)){const t=[...e.value];t[r]=n,e.value=t}else{const t={...e.value,[r]:n};Object.setPrototypeOf(t,Object.getPrototypeOf(e.value)),e.value=t}else e.value[r]=n}}));return n}typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const bT=Nt,_T=vT?window:void 0;const wT=Tt({name:"UseDraggable",props:["storageKey","storageType","initialValue","exact","preventDefault","stopPropagation","pointerTypes","as","handle","axis","onStart","onMove","onEnd"],setup(e,{slots:t}){const n=St(),r=Yt(()=>e.handle??n.value),s=e.storageKey&&Vn(e.storageKey,bT(e.initialValue)||{x:0,y:0},jn?"session"===e.storageType?sessionStorage:localStorage:void 0),i=s||e.initialValue||{x:0,y:0},o=jt(function(e,t={}){const{pointerTypes:n,preventDefault:r,stopPropagation:s,exact:i,onMove:o,onEnd:a,onStart:l,initialValue:c,axis:u="both",draggingElement:h=_T,handle:d=e}=t,{width:p}=Ln();let m=p.value;const f=St(bT(c)??{x:0,y:0});Ct(p,()=>{const e=p.value-m;f.value.x+=e,m=p.value});const g=St(),y=e=>!n||n.includes(e.pointerType),v=e=>{bT(r)&&e.preventDefault(),bT(s)&&e.stopPropagation()},x=t=>{if(!y(t)||bT(i)&&t.target!==bT(e))return;const n=bT(e).getBoundingClientRect(),r={x:t.clientX-n.left,y:t.clientY-n.top};!1!==(null==l?void 0:l(r,t))&&(g.value=r,v(t))},b=e=>{if(!y(e)||!g.value)return;let{x:t,y:n}=f.value;("x"===u||"both"===u)&&(t=e.clientX-g.value.x),("y"===u||"both"===u)&&(n=e.clientY-g.value.y),f.value={x:t,y:n},null==o||o(f.value,e),v(e)},_=e=>{y(e)&&g.value&&(g.value=void 0,null==a||a(f.value,e),v(e))};if(vT){const e={capture:t.capture??!0};Xn(d,"pointerdown",x,e),Xn(h,"pointermove",b,e),Xn(h,"pointerup",_,e)}return{...xT(f),position:f,isDragging:Yt(()=>!!g.value),style:Yt(()=>`left:${f.value.x}px;top:${f.value.y}px;`)}}(n,{...e,handle:r,initialValue:i,onEnd:(t,n)=>{var r;null==(r=e.onEnd)||r.call(e,t,n),s&&(s.value.x=t.x,s.value.y=t.y)}}));return()=>{if(t.default)return zt(e.as||"div",{ref:n,style:`touch-action:none;${o.style}`},t.default(o))}}}),TT=Symbol("CONTROLS_CONTEXT_KEY"),ET="default",ST=jt({});const AT=e=>"boolean"==typeof e?"boolean":"number"==typeof e?"number":"string"==typeof e&&/^#(?:[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^0x(?:[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e)?"color":"string"==typeof e?"string":e.isVector3||e.isVector2||e.isEuler||Array.isArray(e.value)||e.value.isVector3||e.value.isVector2||e.value.isEuler||Array.isArray(e.value.value)?"vector":void 0!==e.min||void 0!==e.max||void 0!==e.step?"range":e.options&&Array.isArray(e.options)?"select":"unknown",MT=(e,t,n,r)=>{const s={key:St(e),label:St(e),name:St(e),type:St(n),value:St(t),visible:St(!0),icon:St(),uniqueKey:St(e),[e]:St(t)};return r&&(s.folder=St(r)),s},OT=(e,t,n)=>{const r={},s="string"==typeof e?e:null,i=s?t:e,o=ET;if(ST[o]||(ST[o]=jt({})),"fpsgraph"===e){const e=MT("fpsgraph",null,"fpsgraph",null);return ST[o].fpsgraph=e,r.fpsgraph=e,Xt(jt(r))}const a=ST[o],l=cn(i),c=l?Xt(i):{};for(const u in i){let e=i[u],t=u;if(l&&c[u]&&(e=c[u]),s&&(t=`${s}${u.charAt(0).toUpperCase()+u.slice(1)}`),"object"==typeof e&&!Ht(e)&&!Array.isArray(e)&&void 0!==e.value){const n=e,i=Ht(n.value)?n.value:St(n.value),o=n.type||AT(n),l=MT(u,i,o,s);"select"===o&&(l.options=St(n.options.map(e=>"object"==typeof e&&e.text&&e.value?e:{text:e,value:e}))),"range"===o&&(l.min=St(n.min||0),l.max=St(n.max||1),l.step=St(n.step||.1)),l.label.value=n.label||u,l.icon.value=n.icon,l.visible.value=void 0===n.visible||n.visible,l.uniqueKey.value=t,a[t]=l,r[t]=l;continue}if(Ht(e)){const n=MT(u,e,e.value.type||AT(e.value),s);a[t]=n,r[t]=n;continue}if("object"==typeof e&&!Array.isArray(e)){const t=Xt(e);t[u]&&(e=t[u])}const n=MT(u,e,e.type||AT(e),s);a[t]=n,r[t]=n,n.uniqueKey.value=t}return Object.keys(r).length>1?Xt(jt(r)):Object.values(r)[0]},CT=["for","title"],NT=Tt({__name:"ControlLabel",props:{label:{},control:{}},setup:e=>(e,t)=>(Rt(),Mt("label",{for:e.control.uniqueKey,title:e.label,class:"tl-text-gray-500 tl-w-1/3 tl-truncate"},[e.control.icon?(Rt(),Mt("i",{key:0,class:kt(e.control.icon)},null,2)):(Rt(),Mt(Vt,{key:1},[gn(dn(e.label),1)],64))],8,CT))}),PT={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},RT=["id","value","min","max","step"],IT=Tt({__name:"NumberControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function s(e){const{target:t}=e;r("change",t.valueAsNumber)}const i=Hn(),o=St(0),a=St(!1),l=e=>{o.value=e.clientX,a.value=!0},c=()=>{a.value=!1};return Ct(i.x,e=>{if(a.value){const t=e-o.value,s=(e=>Math.floor(Math.abs(e)/10))(t);t>0?r("change",n.control.value+1+s):t<0&&r("change",n.control.value-1+s),void 0!==n.control.min&&n.control.value<n.control.min&&r("change",n.control.min),void 0!==n.control.max&&n.control.value>n.control.max&&r("change",n.control.max),o.value=e}}),(e,t)=>(Rt(),Mt("div",PT,[tn(NT,{label:e.label,control:e.control},null,8,["label","control"]),qt("input",{id:e.control.uniqueKey,value:e.control.value,class:kt(["tl-p-2 tl-w-1/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans",{"tl-cursor-ew-resize":a.value}]),type:"number",min:e.control.min,max:e.control.max,step:e.control.step,onInput:s,onMousedown:l,onMouseup:c},null,42,RT)]))}}),LT={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2 tl-min-h-32px"},kT=["id","value","aria-label"],DT=Tt({__name:"TextControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){const{target:t}=e;n("change",t.value)}return(e,t)=>(Rt(),Mt("div",LT,[tn(NT,{label:e.label,control:e.control},null,8,["label","control"]),qt("input",{id:e.control.uniqueKey,value:e.control.value,type:"text",tabindex:"0",class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 focus:tl-border-gray-200 tl-border-none tl-font-sans","aria-label":e.label,placeholder:"Enter value here...",onChange:r},null,40,kT)]))}}),zT={class:"tl-flex tl-px-4 tl-justify-start tl-gap-2 tl-items-center tl-mb-2 tl-min-h-32px"},UT={class:"tl-text-gray-500 tl-w-1/3"},FT=["id","checked"],BT=["for"],VT=["aria-checked"],jT={class:"i-ic:baseline-check tl-text-light"},HT=Tt({__name:"BooleanControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function s(e){const{target:t}=e;r("change",t.checked)}function i(e){("Space"===e.code||"Enter"===e.code)&&(e.preventDefault(),r("change",!n.control.value))}return(e,t)=>(Rt(),Mt("div",zT,[qt("label",UT,dn(e.label),1),qt("input",{id:e.control.uniqueKey,checked:e.control.value,class:"tl-hidden",type:"checkbox",onInput:s},null,40,FT),qt("label",{for:e.control.uniqueKey,class:"tl-inline-flex tl-items-center tl-cursor-pointer"},[qt("span",{tabindex:"0",role:"checkbox","aria-checked":e.control.value.toString(),class:kt([{"tl-bg-dark-500":e.control.value,"tl-bg-gray-200":!e.control.value},"tl-w-4 tl-h-4 tl-flex tl-justify-center tl-items-center tl-rounded tl-border tl-border-gray-300 tl-mr-2 tl-transition-colors tl-duration-200"]),onKeydown:i},[pn(qt("i",jT,null,512),[[mn,e.control.value]])],42,VT)],8,BT)]))}}),YT={class:"tl-px-4 tl-relative tl-flex tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},WT=["value","min","max","step"],XT=["value","min","max","step"],GT=Tt({__name:"SliderControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t;function s(e){const{target:t}=e;r("change",t.valueAsNumber)}const i=Yt(()=>({backgroundImage:`linear-gradient(to right, #333 0% ${100*(n.control.value-(n.control.min||0))/((n.control.max||100)-(n.control.min||0))}%, #e2e2e2 0%)`})),o=Hn(),a=St(0),l=St(!1),c=e=>{a.value=e.clientX,l.value=!0},u=()=>{l.value=!1};return Ct(o.x,e=>{if(l.value){const t=e-a.value,s=(e=>Math.floor(Math.abs(e)/10))(t);t>0?r("change",n.control.value+1+s):t<0&&r("change",n.control.value-1+s),void 0!==n.control.min&&n.control.value<n.control.min&&r("change",n.control.min),void 0!==n.control.max&&n.control.value>n.control.max&&r("change",n.control.max),a.value=e}}),(e,t)=>(Rt(),Mt("div",YT,[tn(NT,{label:e.label,control:e.control},null,8,["label","control"]),qt("input",{value:e.control.value,class:"tl-w-1/2 tl-h-0.75 tl-bg-dark-200 tl-rounded-full tl-appearance-none",style:It(i.value),type:"range",min:e.control.min,max:e.control.max,step:e.control.step,onInput:s},null,44,WT),qt("input",{value:e.control.value,class:kt(["tl-p-2 tl-w-1/4 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans",{"tl-cursor-ew-resize":l.value}]),type:"number",min:e.control.min,max:e.control.max,step:e.control.step,onInput:s,onMousedown:c,onMouseup:u},null,42,XT)]))}}),qT=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n},ZT=qT(GT,[["__scopeId","data-v-207d19a7"]]),KT={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},QT={class:"tl-text-gray-500 tl-w-1/3"},JT=["id","value","aria-label"],$T=["id","aria-label","value"],eE=Tt({__name:"ColorControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){const{target:t}=e;n("change",t.value)}return(e,t)=>(Rt(),Mt("div",KT,[qt("label",QT,dn(e.label),1),qt("input",{id:e.control.uniqueKey,tabindex:"0",value:e.control.value,"aria-label":e.label,class:kt(["focus:tl-outline-none focus:tl-ring-2 focus:tl-ring-blue-600",{"important-tl-outline-gray-200":"#ffffff"===e.control.value}]),type:"color",onInput:r},null,42,JT),qt("input",{id:e.control.uniqueKey,tabindex:"0","aria-label":e.label,value:e.control.value,class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-border-none tl-font-sans",type:"text",onInput:r},null,40,$T)]))}});function tE(e){return e&&"number"==typeof e.x&&"number"==typeof e.y}function nE(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}const rE={class:"tl-relative tl-w-2/3 tl-flex tl-justify-between tl-gap-0.5"},sE={key:0,class:"tl-font-bold tl-px-1 tl-py-1 tl-text-0.65rem tl-text-gray-300"},iE=["id","step","value","onInput","onMousedown","onMouseup","onFocus"],oE=Tt({__name:"VectorControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=e,r=t,s=Hn(),{pressed:i}=Yn(),o=St(0),a=St(!1),l=St(0),c=St(null),u=St(1),h=Wn("Shift"),d=Wn("Alt");Ct(h,e=>{u.value=e?10:1}),Ct(d,e=>{u.value=e?.1:1});const p=()=>{c.value=null};Ct(i,e=>{e||(a.value=!1)});const m=Yt(()=>function(e){if("number"==typeof e)return[e,e,e];if(nE(e)){const{x:t,y:n,z:r}=e;return[t,n,r]}if(tE(e)){const{x:t,y:n}=e;return[t,n]}return e}(n.control.value)),f=St(["x","y","z"]),g=Yt(()=>tE(n.control.value)||nE(n.control.value));return Ct(s.x,e=>{if(a.value){const t=e-o.value,s=(e=>Math.floor(Math.abs(e)/10))(t),{value:i}=n.control,a=g.value?f.value[l.value]:l.value;t>0?i[a]+=u.value+s:t<0&&(i[a]-=u.value+s),void 0!==n.control.min&&i<n.control.min&&(i[a]=n.control.min),void 0!==n.control.max&&i>n.control.max&&(i[a]=n.control.max),r("change",i),o.value=e}}),(e,t)=>(Rt(),Mt("div",{class:"tl-flex tl-px-4 tl-justify-between tl-gap-1 tl-items-center tl-mb-2",onMouseup:t[0]||(t[0]=e=>{a.value=!1})},[tn(NT,{label:e.label,control:e.control},null,8,["label","control"]),qt("div",rE,[(Rt(!0),Mt(Vt,null,hn(m.value,(t,s)=>(Rt(),Mt("div",{key:e.label+s,class:kt(["tl-flex tl-items-center tl-bg-gray-100 tl-rounded",{"tl-w-2/5":c.value===s,"tl-w-1/3":Lt(nE)(e.control.value),"tl-w-1/2":Lt(tE)(e.control.value)}])},[f.value[s]&&g.value?(Rt(),Mt("span",sE,dn(f.value[s]),1)):Gt("",!0),qt("input",{id:`${e.control.uniqueKey}-${f.value[s]}`,type:"number",step:u.value,class:kt(["tl-w-full tl-px-0 tl-p-1 tl-text-right tl-text-0.65rem tl-text-gray-400 tl-bg-transparent focus:tl-border-gray-200 tl-outline-none tl-border-none tl-font-sans tl-appearence-none",{"tl-cursor-ew-resize":a.value}]),value:m.value[s].toFixed(2),onInput:e=>function(e,t){const{value:s}=n.control,{target:i}=e;l.value=t,s[g.value?f.value[l.value]:l.value]=Number.parseFloat(i.value),r("change",s)}(e,s),onMousedown:e=>((e,t)=>{l.value=t,o.value=e.clientX,a.value=!0})(e,s),onMouseup:e=>((e,t)=>{l.value=t,a.value=!1})(0,s),onFocus:e=>(e=>{c.value=e})(s),onBlur:p},null,42,iE)],2))),128))])],32))}}),aE={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2"},lE={class:"tl-text-gray-500 tl-w-1/3"},cE={class:"tl-relative tl-w-2/3 tl-p-1 tl-rounded tl-text-right tl-text-xs tl-text-gray-400 tl-bg-gray-100 tl-focus:border-gray-200 tl-outline-none tl-border-none tl-font-sans"},uE={class:"tl-absolute tl-bottom-0.5 tl-right-0.5 tl-font-sans tl-text-xs"},hE=["points"],dE=Tt({__name:"FPSGraph",props:{label:{},control:{}},setup(e){const t=Rn({every:100}),n=St(""),r=St([]),s=St(80);let i=performance.now();return Pn(({timestamp:e})=>{e-i>=100&&(i=e,r.value.push(t.value),r.value.length>s.value&&r.value.shift(),n.value=r.value.map((e,t)=>`${2*t},${59-58*e/120}`).join(" "))}),(e,r)=>(Rt(),Mt("div",aE,[qt("label",lE,dn(e.label),1),qt("div",cE,[qt("div",uE,dn(Math.round(Lt(t)))+" FPS ",1),(Rt(),Mt("svg",{width:160,height:40,xmlns:"http://www.w3.org/2000/svg",class:"tl-bg-gray-100"},[qt("polyline",{points:n.value,fill:"none",stroke:"lightgray","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},null,8,hE)]))])]))}}),pE={class:"tl-flex tl-px-4 tl-justify-between tl-gap-4 tl-items-center tl-mb-2 tl-min-h-32px"},mE=["id","value"],fE=["value"],gE=Tt({__name:"SelectControl",props:{label:{},control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){n("change",e.target.value)}return(e,t)=>(Rt(),Mt("div",pE,[tn(NT,{label:e.label,control:e.control},null,8,["label","control"]),qt("select",{id:e.control.uniqueKey,value:e.control.value,class:"tl-p-2 tl-w-2/3 tl-rounded tl-text-left tl-text-xs tl-text-gray-400 tl-bg-gray-100 focus:tl-border-gray-200 tl-outline-none tl-border-none tl-font-sans",onChange:r},[(Rt(!0),Mt(Vt,null,hn(e.control.options,e=>(Rt(),Mt("option",{key:e.value,value:e.value},dn(e.text),9,fE))),128))],40,mE)]))}}),yE=Tt({__name:"ButtonControl",props:{label:{},control:{}},setup(e){const t=e,n=Yt(()=>["leches-btn",`leches-btn-${t.control.value.variant||"primary"}`,`leches-btn-${t.control.value.size||"sm"}`]);return(e,t)=>(Rt(),Mt("button",{class:kt(n.value),onClick:t[0]||(t[0]=(...t)=>e.control.value.onClick&&e.control.value.onClick(...t))},[qt("i",{class:kt([e.control.value.icon,e.control.value.label?"mr-1":""])},null,2),gn(" "+dn(e.control.value.label),1)],2))}}),vE=qT(yE,[["__scopeId","data-v-926dfadc"]]),xE={key:0},bE=Tt({__name:"ControlInput",props:{control:{}},emits:["change"],setup(e,{emit:t}){const n=t;function r(e){n("change",e)}return(e,t)=>e.control.visible?(Rt(),Mt("div",xE,["color"===e.control.type?(Rt(),rn(eE,{key:0,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"select"===e.control.type?(Rt(),rn(gE,{key:1,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"vector"===e.control.type?(Rt(),rn(oE,{key:2,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"boolean"===e.control.type?(Rt(),rn(HT,{key:3,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"fpsgraph"===e.control.type?(Rt(),rn(dE,{key:4,label:e.control.label,control:e.control},null,8,["label","control"])):"number"===e.control.type?(Rt(),rn(IT,{key:5,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"range"===e.control.type?(Rt(),rn(ZT,{key:6,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"])):"button"===e.control.type?(Rt(),Mt("div",{key:7,class:kt(["tl-p-2","tl-block"===e.control.value.size?"tl-flex":"tl-inline-flex"])},[tn(vE,{label:e.control.label,control:e.control},null,8,["label","control"])],2)):(Rt(),rn(DT,{key:8,label:e.control.label,control:e.control,onChange:r},null,8,["label","control"]))])):Gt("",!0)}}),_E={class:"tl-mb-4"},wE=["aria-expanded","data-folder"],TE={class:"tl-bg-white tl-rounded-b tl-pt-4",role:"menu"},EE=Tt({__name:"Folder",props:{controls:{},label:{}},setup(e){const t=St(!1),n=()=>{t.value=!t.value};return(e,r)=>(Rt(),Mt("div",_E,[qt("button",{class:"tl-flex tl-items-center tl-justify-between tl-w-full tl-py-2 tl-px-4 tl-bg-gray-100 tl-border-none tl-text-gray-400 tl-font-bold tl-text-xs tl-font-sans tl-cursor-pointer","aria-expanded":t.value,"aria-haspopup":"true",role:"button","data-folder":e.label,tabindex:"0",onClick:n},[qt("span",null,dn(e.label),1),qt("i",{class:kt(t.value?"i-ic:baseline-keyboard-arrow-up":"i-ic:baseline-keyboard-arrow-down")},null,2)],8,wE),tn(fn,{name:"slide","enter-active-class":"tl-animate-fade-in tl-animate-duration-200 tl-animate-ease-in-out","leave-active-class":"tl-animate-fade-out tl-animate-duration-200 tl-animate-ease-in-out"},{default:un(()=>[pn(qt("div",TE,[(Rt(!0),Mt(Vt,null,hn(e.controls,e=>(Rt(),rn(bE,{key:e.label,control:e,role:"menuitem",onChange:t=>function(e,t){t.value=e}(t,e)},null,8,["control","onChange"]))),128))],512),[[mn,t.value]])]),_:1})]))}}),SE={tabindex:"0",class:"tl-bg-white tl-shadow-xl tl-rounded tl-border-4 tl-border-solid tl-border-black"},AE=Tt({__name:"TresLeches",props:{uuid:{}},setup(e){const t=e,{uuid:n}=Xt(t),{width:r}=Ln(),s=St(null),i=function(e=ET){return Bt(TT,ST),ST[e]}(null==n?void 0:n.value);const o=Yt(()=>{const e={};for(const t in i){const n=i[t],r=n.folder||"default";e[r]||(e[r]=[]),e[r].push(n)}return e});return(e,t)=>(Rt(),rn(Lt(wT),{id:Lt(n),"initial-value":{x:Lt(r)-280-40,y:10},class:kt(["tl-absolute tl-select-none tl-z-24 tl-w-280px tl-font-sans tl-text-xs",e.$attrs.class]),handle:s.value},{default:un(()=>[qt("div",SE,[qt("header",{ref_key:"handle",ref:s,class:"tl-relative tl-cursor-grabbing tl-p-4 tl-flex tl-justify-between tl-text-gray-200 tl-relative"},t[0]||(t[0]=[qt("i",{class:"tl-h-4 tl-w-4 tl-p-1.5 tl-flex tl-items-center tl-line-height-0 tl-rounded-full tl-bg-gray-100 tl-text-xs"},"🍰",-1),qt("div",null,[qt("i",{class:"i-ic-baseline-drag-indicator"}),qt("i",{class:"i-ic-baseline-drag-indicator"}),qt("i",{class:"i-ic-baseline-drag-indicator"})],-1),qt("div",null,null,-1)]),512),(Rt(!0),Mt(Vt,null,hn(o.value,(e,t)=>(Rt(),Mt(Vt,{key:t},["default"!==t?(Rt(),rn(EE,{key:0,label:t,controls:e},null,8,["label","controls"])):Gt("",!0),"default"===t?(Rt(!0),Mt(Vt,{key:1},hn(e,e=>(Rt(),rn(bE,{key:e.label,control:e,onChange:t=>function(e,t){i[Lt(e)].value=t,i[Lt(e)][Lt(e)]=t}(e.key,t)},null,8,["control","onChange"]))),128)):Gt("",!0)],64))),128))])]),_:1},8,["id","initial-value","class","handle"]))}});export{zr as A,Tr as B,ld as C,yw as D,cT as E,Ms as F,sd as G,bw as H,OT as I,Mw as J,Kh as K,Vw as L,td as M,nd as N,Hw as O,mw as P,Nw as Q,Yw as R,uw as S,aw as T,zu as U,Sw as W,Xh as X,qh as Y,Os as _,ed as a,fl as b,Ep as c,wp as d,X_ as e,nT as f,nw as g,yT as h,ad as i,Wh as j,oT as k,mT as l,kw as m,Sl as n,ll as o,jw as p,AE as q,cd as r,id as s,Rw as t,Uu as u,ww as v,Jh as w,ml as x,Al as y,As as z};
