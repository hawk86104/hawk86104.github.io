import{importShared as l}from"./3d-tiles-renderer.DZNovkLO1767148983502.js";import{request as m}from"./index.DTe2qqjO1767148983502.js";import{useTexture$1 as f}from"./customShaderMaterial.vue_vue_type_script_setup_true_lang.B7dQ_CiZ1767148983502.js";import"./index.vue_vue_type_script_setup_true_lang.CjsHShHS1767148983502.js";import{Water as h}from"./Water2.BR5fa8701767148983502.js";import{computeBoundsTree as d,disposeBoundsTree as x,acceleratedRaycast as w}from"./ExtensionUtilities.2O-yyDsQ1767148983502.js";const{BufferAttribute:g,Box3:E,Vector3:G,RepeatWrapping:R,Color:b,Mesh:B,PlaneGeometry:A,Vector2:a,DoubleSide:y,Material:V,MeshBasicMaterial:C,BufferGeometry:c,Matrix4:H}=await l("three"),T=(e,r=!1)=>{e.computeBoundingBox();const{max:o,min:t}=e.boundingBox;e.deleteAttribute("uv");const n=o.x-t.x,u=o.y-t.y,i=[];for(let s=0;s<e.attributes.position.count;s++)r?(i.push((e.attributes.position.getX(s)-(t.x+o.x)/2)/n),i.push((e.attributes.position.getY(s)-(t.y+o.y)/2)/u)):(i.push((e.attributes.position.getX(s)-t.x)/n),i.push((e.attributes.position.getY(s)-t.y)/u));const p=new Float32Array(i);e.setAttribute("uv",new g(p,2))},S=(e,r)=>new Promise((o,t)=>{m(e,{},{method:"get",mergeRequest:!0,responseType:"json"}).then(n=>{r&&o(n[r]),o(n.features)}).catch(n=>{console.error(n),t(n)})}),X=e=>{const r=new THREE.Box3().setFromObject(e),o=new THREE.Vector3;r.getCenter(o),e.children.forEach(t=>{t.position.sub(o)}),e.position.copy(o.negate())},Y=()=>{c.prototype.computeBoundsTree=d,c.prototype.disposeBoundsTree=x,B.prototype.raycast=w},q=async e=>{const r=await f(["./plugins/water/images/Water_1_M_Normal.jpg","./plugins/water/images/Water_2_M_Normal.jpg"]),o=e.geometry.clone();T(o),o.computeBoundsTree();const t=new h(o,{color:new b("#fff"),scale:20,flowDirection:new a(1,1),textureWidth:1024,textureHeight:1024,normalMap0:r[0],normalMap1:r[1]});return t.material.transparent=!0,t.material.depthWrite=!0,t.material.depthTest=!0,t.material.side=y,t.material.uniforms.config.value.w=20,t.material.uniforms.reflectivity.value=.46,t};function D(e){const r=[];for(let t=0;t<e.length;t++)r.push(new a(e[t].x,e[t].y));const o=new a;for(let t=0;t<r.length;t++)o.add(r[t]);o.divideScalar(r.length);for(let t=0;t<r.length;t++)r[t].sub(o);return{points:r,centerPoint:o}}export{X as adjustGroupCenter,D as getcenterPoint,Y as initMeshBvh,S as loadGeojson,T as resetUV,q as setThreeWater2};
