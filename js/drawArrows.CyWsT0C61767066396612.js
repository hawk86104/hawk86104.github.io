import{i as e}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{F as t,K as n}from"./@tresjs.B1f7s3pS1767066396612.js";import{P as a}from"./tweakpane.CqZAnw7f1767066396612.js";const{defineComponent:o}=await e("vue"),{onMounted:r,watchEffect:i,ref:l}=await e("vue"),s=await e("three"),c=o({__name:"drawArrows",setup(e){const{camera:n,scene:o}=t(),c=l(new s.Raycaster),u=new s.Vector2,w=[];l(null);const d=new s.PlaneGeometry(200,200),m=new s.MeshBasicMaterial({color:65280,side:s.DoubleSide}),p=new s.Mesh(d,m);p.rotation.set(0,0,Math.PI/2),o.value.add(p);let v="";let h=function(e){e.preventDefault(),window.removeEventListener("click",f,!1),window.removeEventListener("contextmenu",h,!1)},f=function(e){u.x=e.clientX/window.innerWidth*2-1,u.y=-e.clientY/window.innerHeight*2+1,c.value.setFromCamera(u,n.value);const t=c.value.intersectObject(p);if(t.length>0){const e=t[0].point;if(w.push(new s.Vector3(e.x,e.y,0)),"line"===v)M(t[0].normal)}},M=function(e){if(2==w.length){const t=new s.CatmullRomCurve3(w),n=new s.TubeGeometry(t,20,2,8,!1),a=new s.MeshBasicMaterial({color:16711680}),r=new s.Mesh(n,a);o.value.add(r);const i=e,l=C(t,i,Math.PI/5);o.value.add(l);const c=C(t,i,-Math.PI/5);o.value.add(c);const u=b(w[1]);o.value.add(u),w.length=0}},b=function(e){const t=new s.SphereGeometry(1.8,32,32),n=new s.MeshBasicMaterial({color:16711680}),a=new s.Mesh(t,n);return a.position.copy(e),a},C=function(e,t,n){const a=new s.CatmullRomCurve3([e.getPointAt(.8),e.getPointAt(1)]),o=new s.TubeGeometry(a,30,2,8,!1),r=new s.MeshBasicMaterial({color:16711680}),i=new s.Mesh(o,r).clone(),l=new s.Group;return l.add(i),l.position.copy(w[1]),i.position.sub(w[1]),l.rotation.set(Math.abs(t.x)*n,Math.abs(t.y)*n,Math.abs(t.z)*n),l};const P=function(){new a({title:"箭头",expanded:!0}).addFolder({title:"参数(鼠标间断点两个点，分别作为箭头的起点)，点击鼠标右键移除绘制"}).addButton({title:"绘制箭头",label:"激活"}).on("click",()=>{window.removeEventListener("click",f,!1),window.addEventListener("contextmenu",h,!1),v="line",window.addEventListener("click",f,!1)})};return r(()=>{P()}),i(()=>{}),(e,t)=>null}}),{defineComponent:u}=await e("vue"),{createElementVNode:w,unref:d,normalizeProps:m,guardReactiveProps:p,createVNode:v,Suspense:h,withCtx:f,openBlock:M,createBlock:b,resolveComponent:C,mergeProps:P}=await e("vue"),{reactive:y}=await e("vue"),g=u({__name:"drawArrows",setup(e){const t=y({windowSize:!0,alpha:!0,antialias:!0}),a=y({enableDamping:!0,enableZoom:!0,enablePan:!0,enableRotate:!0,makeDefault:!0});return(e,o)=>{const r=C("TresCanvas");return M(),b(r,P({clearColor:"#201919"},t),{default:f(()=>[o[0]||(o[0]=w("TresPerspectiveCamera",{fov:60,near:.1,far:2e3,position:[0,0,200],"look-at":[0,0,0]},null,-1)),o[1]||(o[1]=w("TresAmbientLight",{intensity:2},null,-1)),v(d(n),m(p(a)),null,16),(M(),b(h,null,{default:f(()=>[v(c)]),_:1}))]),_:1},16)}}});export{g as default};
