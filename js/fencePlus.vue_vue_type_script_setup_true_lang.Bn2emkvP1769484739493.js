import{importShared as t,mergeGeometries as e}from"./3d-tiles-renderer.qyEDeaaW1769484739493.js";import{useLoop as o}from"./index.CuW8EyFk1769484739493.js";const{defineComponent:n}=await t("vue"),{unref:r,normalizeProps:a,guardReactiveProps:i,createElementVNode:l,openBlock:s,createElementBlock:u}=await t("vue"),c=["geometry"],f=await t("three"),{watch:m}=await t("vue"),v=n({__name:"fencePlus",props:{width:{default:100},height:{default:100},depth:{default:100},color:{default:"#ffff00"},opacity:{default:1},thickness:{default:.99},room:{default:.7},num:{default:8},speed:{default:.15}},setup(t){const n=t,v={side:f.DoubleSide,transparent:!0,depthWrite:!1,depthTest:!0,blending:f.NormalBlending,vertexShader:"\n\t\tprecision highp float;\n\t\tprecision highp int;\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t}\n",fragmentShader:"\n\t\t\t\tprecision highp float;\n\t\t\t\tprecision highp int;\n\t\t\t\tuniform float time;\n\t\t\t\tuniform float opacity;\n\t\t\t\tuniform vec3 color;\n\t\t\t\tuniform float num;\n\t\t\t\tuniform float thickness;\n\t\t\t\tuniform float speed;\n\t\t\t\tuniform float room;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 fragColor = vec4(0.);\n\t\t\t\t\tfloat sinnum = sin((vUv.y - time * speed) * 10. * num);\n\n\t\t\t\t\tvec4 wcolor = vec4(mix(color, vec3(1., 1., 1.), 0.9),1.0);\n\n\t\t\t\t\tvec3 fade = mix(color, vec3(1., 1., 1.), vUv.y);\n                    fragColor = mix(fragColor, vec4(fade, 1.), 0.85);\n                    gl_FragColor = vec4(fragColor.rgb, fragColor.a * opacity * (1. - vUv.y));\n\n\t\t\t\t\tif(vUv.y < room){\n\t\t\t\t\t\tfloat alpha = smoothstep(1.0 - thickness - 0.1, 1.0 - thickness, sinnum);\n\t\t\t\t\t\tfragColor = mix(gl_FragColor, wcolor, alpha);\n\t\t\t\t\t\tfragColor.a = fragColor.a * opacity;\n\t\t\t\t\t\tgl_FragColor = fragColor;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t",uniforms:{time:{type:"pv2",value:0},color:{type:"uvs",value:new f.Color(n.color)},opacity:{value:n.opacity},num:{value:n.num},thickness:{value:n.thickness},speed:{value:n.speed},room:{value:n.room}}};let p=null;function h(t,o,n){const r=[],a=(t,e)=>{const o=new f.PlaneGeometry(t,e,1,1),n=[];return n.push(0,1),n.push(1,1),n.push(0,0),n.push(1,0),o.setAttribute("uv",new f.Float32BufferAttribute(n,2)),o},i=a(t,n);i.rotateY(Math.PI),i.translate(0,n/2,-o/2),r.push(i);const l=a(t,n);l.translate(0,n/2,o/2),r.push(l);const s=a(o,n);s.rotateY(Math.PI/2),s.translate(-t/2,n/2,0),r.push(s);const u=a(o,n);u.rotateY(-Math.PI/2),u.translate(t/2,n/2,0),r.push(u);return e(r,!0)}p=h(n.width,n.depth,n.height);const{onBeforeRender:d}=o();return d(({delta:t})=>{v.uniforms.time.value+=t}),m(()=>[n.color,n.opacity,n.num,n.thickness,n.speed,n.room],([t,e,o,n,r,a])=>{v.uniforms.color.value=new f.Color(t),v.uniforms.opacity.value=e,v.uniforms.num.value=o,v.uniforms.thickness.value=n,v.uniforms.speed.value=r,v.uniforms.room.value=a}),m(()=>[n.width,n.depth,n.height],([t,e,o])=>{p=h(t,e,o)}),(t,e)=>(s(),u("TresMesh",{renderOrder:2e3,geometry:r(p)},[l("TresShaderMaterial",a(i(v)),null,16)],8,c))}});export{v as _sfc_main};
