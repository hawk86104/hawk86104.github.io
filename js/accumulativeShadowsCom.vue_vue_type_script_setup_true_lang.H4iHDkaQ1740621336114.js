import{_ as t,a as n}from"./three.sXv6UbbL1740621336114.js";import{m as e}from"./@tresjs.Td0X-dew1740621336114.js";import{d as o,P as a}from"./@pmndrs.S4rKZ8vm1740621336114.js";import{d as r,b as s,w as i,a2 as c,o as u,H as l,N as f,aj as p,ak as h}from"./@vue.NRI7TcgI1740621336114.js";const d=M;!function(t,n){const e=M,o=g();for(;;)try{if(474137===parseInt(e(359))/1+parseInt(e(296))/2*(-parseInt(e(377))/3)+parseInt(e(319))/4*(-parseInt(e(370))/5)+-parseInt(e(351))/6*(-parseInt(e(369))/7)+-parseInt(e(329))/8+-parseInt(e(340))/9*(-parseInt(e(379))/10)+-parseInt(e(345))/11)break;o.push(o.shift())}catch(a){o.push(o.shift())}}();const m=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[M(324)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();!function(){m(this,(function(){const t=M,n=new RegExp(t(343)),e=new RegExp(t(327),"i"),o=I(t(360));n[t(364)](o+t(326))&&e[t(364)](o+"input")?I():o("0")}))()}();const w=function(){let t=!0;return function(n,e){const o=t?function(){if(e){const t=e[M(324)](n,arguments);return e=null,t}}:function(){};return t=!1,o}}();function g(){const t=["acos","238266DkOUFv","amount","stateObject","function *\\( *\\)","value","4315267LCVotq","add","ambient","string","return (function() ","rotate-x","5442RuFAYm","frames","near","set","shadows render end","material","abs","random","939449DrdMFh","init","blendWindow","prototype","gPlane","test","opacity","shadows plm update","info","progressiveLightMap2","7231MWCUSJ","5gTrCsA","position","right","lightPosition","bind","MathUtils","color","15zDnjwr","exception","310FiksqH","TresSoftShadowMaterial","warn","clear","remove","action","68308kjbPIx","while (true) {}","far","trace","constructor","DirectionalLight","finish","call","texture","height","shadow","update","blend","size","randFloatSpread","Group","radius","Vector3","log","console","__proto__","alphaTest","length","3596356cfkVFs","error","bias","cos","counter","apply","camera","chain","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","mapSize","6086248pBqvyy","prepare","top","toString","debu","TresMesh",'{}.constructor("return this")( )',"children","configure","gger"];return(g=function(){return t})()}function M(t,n){const e=g();return(M=function(t,n){return e[t-=291]})(t,n)}w(void 0,(function(){const t=M,n=function(){const t=M;let n;try{n=Function(t(349)+t(335)+");")()}catch(e){n=window}return n}(),e=n.console=n[t(315)]||{},o=[t(314),t(292),t(367),t(320),t(378),"table",t(299)];for(let a=0;a<o[t(318)];a++){const n=w[t(300)][t(362)][t(374)](w),r=o[a],s=e[r]||n;n[t(316)]=w[t(374)](w),n[t(332)]=s[t(332)][t(374)](s),e[r]=n}}))();const b=[d(350)],y=r({__name:"accumulativeShadowsCom",props:{opacity:{default:.8},alphaTest:{default:.9},color:{default:"#000000"},blend:{default:2},lightPosition:{default:{x:3,y:5,z:3}},frames:{default:60},blendWindow:{default:100},ambient:{default:.5}},setup(r){const m=d,w=r;let g=s();const{extend:M,scene:y,renderer:I,camera:x}=e();M({SoftShadowMaterial:o});const z={position:(new(t[m(313)])).set(w.lightPosition.x,w.lightPosition.y,w[m(373)].z),radius:1,amount:8,intensity:Math.PI,bias:.001,mapSize:1024,size:8,near:.5,far:200},P=new a(I[m(344)],y[m(344)],z[m(328)]),S={map:P[m(368)][m(304)],transparent:!0,depthWrite:!1,toneMapped:!0,blend:w.blend,alphaTest:w[m(317)],opacity:w[m(365)],color:w.color},v=new(t[m(311)]);for(let n=0;n<z.amount;n++){const n=new(t[m(301)])(16777215,z.intensity/z[m(341)]);n.castShadow=!0,n[m(306)].bias=z[m(321)],n.shadow.camera[m(353)]=z[m(353)],n[m(306)].camera[m(298)]=z[m(298)],n[m(306)][m(325)][m(372)]=z[m(309)]/2,n[m(306)].camera.left=-z[m(309)]/2,n[m(306)].camera[m(331)]=z[m(309)]/2,n[m(306)][m(325)].bottom=-z[m(309)]/2,n.shadow[m(328)].width=z.mapSize,n[m(306)].mapSize[m(305)]=z[m(328)],v[m(346)](n)}const _=()=>{const e=m,o=z[e(371)][e(318)]();for(let a=0;a<v.children[e(318)];a++){const r=v[e(336)][a];if(Math[e(358)]()>w[e(347)])r[e(371)][e(354)](z.position.x+t[e(375)][e(310)](z[e(312)]),z[e(371)].y+n[e(310)](z.radius),z.position.z+t[e(375)][e(310)](z[e(312)]));else{let t=Math[e(339)](2*Math[e(358)]()-1)-Math.PI/2,n=2*Math.PI*Math[e(358)]();r[e(371)][e(354)](Math.cos(t)*Math[e(322)](n)*o,Math[e(357)](Math.cos(t)*Math.sin(n)*o),Math.sin(t)*o)}}},j=(t=1)=>{const n=m;y.value[n(346)](v),P[n(330)]();for(let e=0;e<t;e++)_(),P[n(307)](x[n(344)],w.blendWindow),console[n(314)](n(366),e);y[n(344)][n(294)](v),P[n(302)]()};i((()=>g.value),(t=>{const n=m;t&&(P[n(337)](t),P[n(293)](),console.log("shadows render start"),j(w.frames),console[n(314)](n(355)))}));const k=()=>{const t=m;P.clear(),j(w[t(352)])};return c((()=>{const t=m;g[t(344)]&&(w[t(365)]&&(g[t(344)][t(356)][t(365)]=w[t(365)]),w[t(317)]&&(g.value[t(356)][t(317)]=w[t(317)]),w[t(376)]&&g[t(344)][t(356)][t(376)][t(354)](w[t(376)]),w[t(308)]&&(g[t(344)][t(356)][t(308)]=w[t(308)]))})),i((()=>w.lightPosition),(t=>{const n=m;t&&(console.log(w[n(373)]),z[n(371)].set(t.x,t.y,t.z),k())}),{deep:!0}),i((()=>[w[m(352)],w[m(361)],w[m(347)]]),(()=>{k()})),(t,n)=>{const e=m;return u(),l(e(334),{"receive-shadow":"",ref_key:e(363),ref:g,scale:10,"rotate-x":-Math.PI/2},[n[0]||(n[0]=f("TresPlaneGeometry",{args:[1,1]},null,-1)),f(e(291),p(h(S)),null,16)],8,b)}}});function I(t){function n(t){const e=M;if(typeof t===e(348))return function(t){}[e(300)](e(297))[e(324)](e(323));1!==(""+t/t)[e(318)]||t%20==0?function(){return!0}[e(300)](e(333)+e(338))[e(303)](e(295)):function(){return!1}[e(300)](e(333)+e(338))[e(324)](e(342)),n(++t)}try{if(t)return n;n(0)}catch(e){}}export{y as _};
