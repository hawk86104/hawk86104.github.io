import{a5 as t,C as n,ca as o,cb as e,cc as r,cd as i,k as u,bR as c,aa as s,bS as a}from"./three.BsQyBKrV1719803971187.js";import{f as l,r as f,d as p}from"./@tresjs.rn1P_YDI1719803971187.js";import{C as d}from"./three-custom-shader-material.rzwTEM2R1719803971187.js";import"./object-hash.4kGk0kP-1719803971187.js";import"./@amap.cIAWtN1R1719803971187.js";import"./glsl-tokenizer.m00Vcg5f1719803971187.js";import{d as h,b as m,a2 as y,w as g,o as w,D as v,u as b,r as _,a3 as I,e as C,f as x,g as M,J as T,j,aj as O,ak as A,F as R,I as S,G as B,m as D}from"./@vue.CpOXM7bB1719803971187.js";function F(){const t=["gger","info","debu","exception","LANDMASS","1319444JhybdM","2445075Mdzqzw","traverse","action","while (true) {}","console","7290750camJph","return (function() ","1315806VGifGv","string","CITY_UNTRIANGULATED","64QIYgby","chain","trace","4740085yicndD","apply","test","table","bind","prototype","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","length","init","constructor","1444578OIoYUe","name","4jegTKR","46494rgroHJ","warn","function *\\( *\\)","toString","call","counter"];return(F=function(){return t})()}function G(t,n){const o=F();return(G=function(t,n){return o[t-=256]})(t,n)}!function(t,n){const o=G,e=F();for(;;)try{if(658777===parseInt(o(291))/1+parseInt(o(272))/2+parseInt(o(269))/3*(-parseInt(o(271))/4)+parseInt(o(259))/5+parseInt(o(289))/6+-parseInt(o(283))/7+-parseInt(o(256))/8*(parseInt(o(284))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(260)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){P(this,(function(){const t=G,n=new RegExp(t(274)),o=new RegExp(t(265),"i"),e=H(t(267));n.test(e+t(257))&&o[t(261)](e+"input")?H():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[G(260)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=G,n=function(){const t=G;let n;try{n=Function(t(290)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(288)]=n[t(288)]||{},e=["log",t(273),t(279),"error",t(281),t(262),t(258)];for(let r=0;r<e[t(266)];r++){const n=z[t(268)][t(264)][t(263)](z),i=e[r],u=o[i]||n;n.__proto__=z.bind(z),n[t(275)]=u[t(275)][t(263)](u),o[i]=n}}))();const L=async()=>{const t=G,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(285)]((n=>{const i=t;n.name===i(293)&&(o=n),n.name===i(282)&&(e=n),"ROADS"===n[i(270)]&&(r=n)})),{model:n,city:o,land:e,roads:r}};function H(t){function n(t){const o=G;if(typeof t===o(292))return function(t){}[o(268)](o(287)).apply(o(277));1!==(""+t/t).length||t%20==0?function(){return!0}[o(268)](o(280)+o(278))[o(276)](o(286)):function(){return!1}[o(268)](o(280)+o(278))[o(260)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const k=$;!function(t,n){const o=$,e=Z();for(;;)try{if(142636===parseInt(o(467))/1+-parseInt(o(432))/2*(parseInt(o(475))/3)+parseInt(o(448))/4*(-parseInt(o(481))/5)+parseInt(o(478))/6*(parseInt(o(474))/7)+parseInt(o(418))/8+-parseInt(o(464))/9*(-parseInt(o(476))/10)+-parseInt(o(457))/11*(-parseInt(o(468))/12))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(451)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){E(this,(function(){const t=$,n=new RegExp(t(442)),o=new RegExp(t(428),"i"),e=N("init");n.test(e+t(466))&&o[t(431)](e+t(452))?N():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[$(451)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();W(void 0,(function(){const t=$;let n;try{n=Function(t(423)+t(417)+");")()}catch(r){n=window}const o=n[t(445)]=n[t(445)]||{},e=[t(458),t(434),t(470),"error","exception","table",t(462)];for(let i=0;i<e[t(484)];i++){const n=W[t(456)].prototype[t(479)](W),r=e[i],u=o[r]||n;n[t(440)]=W.bind(W),n.toString=u[t(469)][t(479)](u),o[r]=n}}))();const J=[k(449)];function Z(){const t=["80fbfbro","DoubleSide","276822OsAifz","bind","dispose","50zIdcQW","clone","bulidingsColor","length","#ffff00",'{}.constructor("return this")( )',"292560HBnVHi","__csm","uGradient","isArray","forEach","return (function() ","renderOrder","opacity","setStyle","material","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uOpacity","boundingBox","test","1112YDGPjo","debu","warn","primitive","action","computeBoundingBox","topColor","model","__proto__","gger","function *\\( *\\)","gradient","call","console","computeBoundingSphere","side","47084JbenKL","object","Color","apply","input","stateObject","value","string","constructor","91949JQTuLG","log","counter","while (true) {}","buildingsModelCustomShader","trace","uniforms","31671iLsyxN","#112233","chain","177054geOHyt","168nuCojk","toString","info","uColor","landColor","land","28QKPwcA","1527Psjrpp"];return(Z=function(){return t})()}function $(t,n){const o=Z();return($=function(t,n){return o[t-=417]})(t,n)}const K=h({__name:k(461),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:k(465)},topColor:{default:k(485)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=k,r=o,i=m(0),u=r[e(439)].city;u[e(424)]=1001;const c=r.model[e(473)];(()=>{const o=e,{geometry:c}=u;c[o(437)](),c[o(446)]();const{max:s,min:a}=c[o(430)];if(u.material[o(419)])return;const l=new d({baseMaterial:u[o(427)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(450)])(r.bulidingsColor)},uOpacity:{value:r.opacity},uLightColor:{value:new n("#ffffff")},uTopColor:{value:new(t[o(450)])(r[o(438)])},uTime:i,uGradient:{value:r.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(477)]});u[o(427)][o(480)](),u.material=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(454)]+=t})),y((()=>{const n=e;r[n(483)]&&u[n(427)][n(463)][n(471)][n(454)].setStyle(r[n(483)]),r[n(472)]&&((n,o)=>{const i=e;let u;"cu"===n||"land"===n&&(u=Array[i(421)](c[i(427)])?c[i(427)]:[c.material],u[i(422)]((n=>{const e=i;n[o][e(426)](r[e(472)]),n[e(447)]=t[e(477)]})))})(n(473),"color"),r.opacity&&(u[n(427)][n(463)][n(429)][n(454)]=r[n(425)])})),g(r,((t,n)=>{const o=e;u[o(427)][o(463)][o(420)].value=t[o(443)]}));const a=r.model.model[e(482)]();return(t,n)=>{const o=e;return w(),v(o(435),{object:b(a)},null,8,J)}}});function N(t){function n(t){const o=$;if(typeof t===o(455))return function(t){}[o(456)](o(460))[o(451)](o(459));1!==(""+t/t)[o(484)]||t%20==0?function(){return!0}.constructor(o(433)+o(441))[o(444)](o(436)):function(){return!1}[o(456)](o(433)+o(441))[o(451)](o(453)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function V(t,n){const o=q();return(V=function(t,n){return o[t-=477]})(t,n)}const Y=V;!function(t,n){const o=V,e=q();for(;;)try{if(255978===-parseInt(o(477))/1+parseInt(o(479))/2*(parseInt(o(522))/3)+parseInt(o(514))/4*(-parseInt(o(503))/5)+-parseInt(o(519))/6*(-parseInt(o(497))/7)+parseInt(o(495))/8+-parseInt(o(483))/9+parseInt(o(515))/10*(-parseInt(o(509))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(523)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Q(this,(function(){const t=V,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(524),"i"),e=nt(t(507));n[t(508)](e+t(518))&&o.test(e+t(501))?nt():e("0")}))()}();const U=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[V(523)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function q(){const t=["object","innerWidth","log","debu","material","bind",'{}.constructor("return this")( )',"return (function() ","Shader","call","248357WiaFfJ","uColor","9938XVcorF","counter","gger","uOpacity","3092094Kcsrcf","action"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","table","trace","value","prototype","string","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","primitive","color","opacity","4052560RfyrGP","warn","5642VWtpOr","buildingsLines","constructor","applyMatrix4","input","exception","110TmqPcJ","geometry","fromEdgesGeometry","linewidth","init","test","1010185pRDFui","matrix","Wireframe","#FFF","info","17548RIKJxr","10ciAFgq","uniforms","builds","chain","318NfhbhP","set","resolution","294gjOUDw","apply","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","length","width","stateObject","console","renderOrder","__proto__"];return(q=function(){return t})()}U(void 0,(function(){const t=V;let n;try{n=Function(t(538)+t(537)+");")()}catch(r){n=window}const o=n.console=n[t(528)]||{},e=[t(533),t(496),t(513),"error",t(502),t(486),t(487)];for(let i=0;i<e[t(525)];i++){const n=U[t(499)][t(489)][t(536)](U),r=e[i],u=o[r]||n;n[t(530)]=U[t(536)](U),n.toString=u.toString.bind(u),o[r]=n}}))();const X=[Y(531)],tt=h({__name:Y(498),props:{builds:{},width:{default:1},color:{default:Y(512)},opacity:{default:1},style:{default:Y(511)}},setup(t){const c=Y,s=t;let a=null,l=null;if(s.style===c(511)){const t=new o(s[c(517)][c(504)]);let n=(new e)[c(505)](t),u=new r({color:s[c(493)],linewidth:s[c(526)],opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u[c(521)][c(520)](window[c(532)],window.innerHeight),a=new i(n,u),a[c(500)](s[c(517)][c(510)].clone())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(493)])},uOpacity:{value:s.opacity}},vertexShader:c(491),fragmentShader:c(485)};const t=new o(s[c(517)].geometry),e=new u(l);a=new LineSegments(t,e),a[c(500)](s[c(517)][c(510)].clone()),a[c(535)].linewidth=s[c(526)],a[c(529)]=1e3}return y((()=>{const t=c;s.style===t(539)&&(s[t(493)]&&(l[t(516)][t(478)][t(488)]=new n(s[t(493)])),s[t(494)]&&(l[t(516)][t(482)].value=s.opacity)),"Wireframe"===s.style&&(s[t(493)]&&(a.material[t(493)]=new n(s[t(493)])),s[t(494)]&&(a[t(535)].opacity=s[t(494)])),s[t(526)]&&(a[t(535)][t(506)]=s.width)})),(t,n)=>{const o=c;return w(),v(o(492),{object:b(a)},null,8,X)}}});function nt(t){function n(t){const o=V;if(typeof t===o(490))return function(t){}[o(499)]("while (true) {}")[o(523)](o(480));1!==(""+t/t)[o(525)]||t%20==0?function(){return!0}[o(499)](o(534)+o(481))[o(540)](o(484)):function(){return!1}[o(499)](o(534)+"gger")[o(523)](o(527)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=at;!function(t,n){const o=at,e=ft();for(;;)try{if(736191===-parseInt(o(143))/1+parseInt(o(161))/2+parseInt(o(152))/3+-parseInt(o(135))/4+parseInt(o(127))/5*(-parseInt(o(163))/6)+parseInt(o(158))/7*(-parseInt(o(159))/8)+parseInt(o(134))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(148)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=at,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(128),"i"),e=pt(t(142));n[t(156)](e+t(139))&&o.test(e+t(138))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[at(148)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=at;let n;try{n=Function(t(157)+t(162)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(124),"warn",t(144),t(170),t(164),t(155),"trace"];for(let i=0;i<e[t(132)];i++){const n=rt[t(141)][t(153)][t(125)](rt),r=e[i],u=o[r]||n;n[t(147)]=rt[t(125)](rt),n[t(166)]=u[t(166)].bind(u),o[r]=n}}))();const it=T("TresAmbientLight",{color:ot(137)},null,-1),ut=T(ot(129),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(t,n){const o=ft();return(at=function(t,n){return o[t-=124]})(t,n)}const lt=h({__name:ot(172),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(126),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(168)]}),u=_({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r[n(149)]&&([o,e]=I((()=>L())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,D({ref_key:e(133),ref:d},i,{"window-size":""}),{default:M((()=>[T("TresPerspectiveCamera",{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(b(p),O(A(u)),null,16),it,ut,r[e(149)]&&b(l)?(w(),v(R,{key:0},[j(K,{model:b(l)},null,8,[e(151)]),j(tt,{builds:b(l)[e(167)],color:e(145)},null,8,[e(160)])],64)):S("",!0),B(t[e(154)],e(130)),r[e(169)]?(w(),v(e(140),ct)):S("",!0),r[e(150)]?(w(),v("TresGridHelper",st)):S("",!0)])),_:3},16)}}});function ft(){const t=["builds","356974vwtKnw",'{}.constructor("return this")( )',"6BHbihC","exception","stateObject","toString","city","disableRender","showAxesHelper","error","while (true) {}","pagesShow","log","bind","#000000","3075265TaEDVh","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","TresDirectionalLight","ability","gger","length","tcRef","16861401iFeYAA","129588eBsANd","call","#ffffff","input","chain","TresAxesHelper","constructor","init","577073WxIOGh","info","#000","debu","__proto__","apply","showBuildings","showGridHelper","model","2276052ZANPDI","prototype","$slots","table","test","return (function() ","133YjJucO","357872QKMuFt"];return(ft=function(){return t})()}function pt(t){function n(t){const o=at;if("string"==typeof t)return function(t){}[o(141)](o(171))[o(148)]("counter");1!==(""+t/t)[o(132)]||t%20==0?function(){return!0}[o(141)](o(146)+"gger")[o(136)]("action"):function(){return!1}.constructor(o(146)+o(131)).apply(o(165)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{K as _,tt as a,lt as b,L as l};
