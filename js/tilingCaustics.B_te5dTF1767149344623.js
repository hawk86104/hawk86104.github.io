import{importShared as e}from"./3d-tiles-renderer.de6b_qgz1767149344623.js";import{_l as n,Kk as t}from"./index.Btae5S5d1767149344623.js";import{Pane as o}from"./tweakpane.BbuIEN141767149344623.js";const{defineComponent:r}=await e("vue"),{createElementVNode:i,normalizeProps:a,guardReactiveProps:l,openBlock:s,createElementBlock:d}=await e("vue"),p=["rotation-x"],{watch:c}=await e("vue"),u=await e("three"),v=r({__name:"tilingCaustics",props:{speed:{default:.478},backgroundColor:{},color:{default:"#fff"},flowSpeed:{default:{x:.01,y:.01}},brightness:{default:1.5}},setup(e){const t=e,o={uniforms:{resolution:{type:"v2",value:{x:1,y:1}},backgroundColor:{type:"c",value:new u.Color(t.color)},color:{type:"c",value:new u.Color("#fff")},speed:{type:"f",value:t.speed},flowSpeed:{type:"v2",value:t.flowSpeed},brightness:{type:"f",value:t.brightness},time:{type:"f",value:.1}},vertexShader:"varying vec2 vUv;\n\nvoid main(){\n\t\n\t\n\tvUv=uv;\n\t\n\t\n\t\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n}",fragmentShader:"#define TAU 6.28318530718\n#define MAX_ITER 5\n\nuniform vec2 resolution;\nuniform vec3 backgroundColor;\nuniform vec3 color;\nuniform float speed;\nuniform vec2 flowSpeed;\nuniform float brightness;\nuniform float time;\n\nvarying vec2 vUv;\n\nvoid main(){\n\tvec2 uv=(vUv.xy+(time*flowSpeed))*resolution;\n\t\n\tvec2 p=mod(uv*TAU,TAU)-250.;\n\tvec2 i=vec2(p);\n\t\n\tfloat c=1.;\n\tfloat inten=.005;\n\t\n\tfor(int n=0;n<MAX_ITER;n++){\n\t\tfloat t=time*speed*(1.-(3.5/float(n+1)));\n\t\ti=p+vec2(cos(t-i.x)+sin(t+i.y),sin(t-i.y)+cos(t+i.x));\n\t\tc+=1./length(vec2(p.x/(sin(i.x+t)/inten),p.y/(cos(i.y+t)/inten)));\n\t}\n\t\n\tc/=float(MAX_ITER);\n\tc=1.17-pow(c,brightness);\n\t\n\tvec3 rgb=vec3(pow(abs(c),8.));\n\t\n\tgl_FragColor=vec4(rgb*color+backgroundColor,length(rgb)+.1);\n}",side:u.DoubleSide,transparent:!0,depthWrite:!1,depthTest:!0},{onBeforeRender:r}=n();return r(({delta:e})=>{o.uniforms.time.value+=e}),c(()=>t,()=>{o.uniforms.speed.value=t.speed,o.uniforms.brightness.value=t.brightness,o.uniforms.backgroundColor.value=new u.Color(t.color)},{deep:!0}),(e,n)=>(s(),d("TresMesh",{"rotation-x":-Math.PI/2,"position-y":1},[n[0]||(n[0]=i("TresPlaneGeometry",{args:[10,10]},null,-1)),i("TresShaderMaterial",a(l(o)),null,16)],8,p))}}),{defineComponent:f}=await e("vue"),{createElementVNode:m,unref:g,createVNode:w,normalizeProps:b,guardReactiveProps:x,resolveComponent:h,mergeProps:y,withCtx:C,openBlock:T,createBlock:k}=await e("vue"),{reactive:S}=await e("vue"),_=f({__name:"tilingCaustics",setup(e){const n={clearColor:"#222"},r=S({color:"#fff",speed:.1,brightness:1.5,flowSpeed:{x:.01,y:.01}}),i=new o({title:"参数",expanded:!0});return i.addBinding(r,"color",{label:"颜色"}),i.addBinding(r,"speed",{label:"速度",min:.1,max:1,step:.1}),i.addBinding(r,"brightness",{label:"亮度",min:.1,max:2,step:.1}),i.addBinding(r,"flowSpeed",{label:"流动速度",picker:"inline",expanded:!0,x:{min:.01,step:.02,max:.6,inverted:!0},y:{min:.01,step:.02,max:.6,inverted:!0}}),(e,o)=>{const i=h("TresCanvas");return T(),k(i,y(n,{"window-size":""}),{default:C(()=>[o[0]||(o[0]=m("TresPerspectiveCamera",{position:[10,10,10]},null,-1)),o[1]||(o[1]=m("TresAmbientLight",{intensity:1},null,-1)),w(g(t)),o[2]||(o[2]=m("TresGridHelper",{args:[10,10]},null,-1)),w(v,b(x({...r})),null,16)]),_:1},16)}}});export{_ as default};
