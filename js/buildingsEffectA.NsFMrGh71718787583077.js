import{b as t,l as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.dTztdH3O1718787583077.js";import{r as o}from"./@tresjs.yMGhEK7G1718787583077.js";import{C as e}from"./three-custom-shader-material.JsHLV5bd1718787583077.js";import"./object-hash.qNEzwKzz1718787583077.js";import{Y as r,a5 as i,C as u,ca as c,k as a,a$ as s}from"./three.OZpCYxlY1718787583077.js";import"./@amap.SdFHYHOw1718787583077.js";import"./glsl-tokenizer.gaAYmyHH1718787583077.js";import{d as l,a2 as f,w as p,o as d,D as m,u as g,a3 as v,r as h,f as y,g as C,j as w,m as _}from"./@vue.CpOXM7bB1718787583077.js";import{P as b}from"./tweakpane.qqn77PB81718787583077.js";import"./@vueuse.jAwx0y-e1718787583077.js";import"./glsl-token-string.I-C2eR7Z1718787583077.js";import"./glsl-token-functions.9MA3WN5r1718787583077.js";import"./jszip.b_9tpgnb1718787583077.js";const x=S;!function(t,n){const o=S,e=T();for(;;)try{if(718153===parseInt(o(445))/1+-parseInt(o(475))/2+-parseInt(o(484))/3+parseInt(o(463))/4+-parseInt(o(469))/5*(-parseInt(o(433))/6)+parseInt(o(486))/7*(-parseInt(o(439))/8)+parseInt(o(446))/9*(-parseInt(o(482))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const I=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){I(this,(function(){const t=S,n=new RegExp(t(456)),o=new RegExp(t(473),"i"),e=P(t(461));n.test(e+t(447))&&o[t(441)](e+"input")?P():e("0")}))()}();const j=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[S(480)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();j(void 0,(function(){const t=S;let n;try{n=Function(t(452)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n[t(492)]||{},e=["log",t(466),t(464),"error",t(432),"table",t(460)];for(let i=0;i<e[t(468)];i++){const n=j[t(472)][t(467)][t(490)](j),r=e[i],u=o[r]||n;n[t(489)]=j[t(490)](j),n.toString=u[t(444)][t(490)](u),o[r]=n}}))();const M=[x(470)];function S(t,n){const o=T();return(S=function(t,n){return o[t-=428]})(t,n)}function T(){const t=["bModel","warn","prototype","length","2857310ddjjbt","object","setStyle","constructor","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","#e523ff","306550JZhThX","uColor","action","landColor","computeBoundingSphere","apply","stateObject","96930gPnRir","__csm","712284IgLdPl","bulidingsColor","3325Qzxoud","string","city","__proto__","bind","Color","console","dispose","children","call","opacity","DoubleSide","topColor","exception","6sIpVeu","color","computeBoundingBox","uTime","gger","isArray","4280OcRfMt","uniforms","test","material","while (true) {}","toString","223733bXbibJ","387BnrQRm","chain","land","model","debu","primitive","return (function() ","forEach","#ffff00","boundingBox","function *\\( *\\)","side","value","\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t","trace","init","gradient","3938340tKXYGe","info"];return(T=function(){return t})()}const O=l({__name:x(465),props:{model:{},bulidingsColor:{default:x(474)},landColor:{default:"#112233"},topColor:{default:x(454)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,c=t,a=c[n(449)][n(488)];c[n(449)].model[n(494)][0].material=new r({color:n(454)}),a.renderOrder=1001;const s=c[n(449)][n(448)];(()=>{const t=n,{geometry:o}=a;o[t(435)](),o[t(479)]();const{max:r,min:s}=o[t(455)];if(a.material[t(483)])return;const l=new e({baseMaterial:a[t(442)],vertexShader:"\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t",fragmentShader:t(459),silent:!0,uniforms:{uMax:{value:r},uMin:{value:s},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(491)])(c.bulidingsColor)},uOpacity:{value:c[t(429)]},uLightColor:{value:new u("#ffffff")},uTopColor:{value:new u(c[t(431)])},uTime:{value:0},uGradient:{value:c[t(462)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(430)]});a[t(442)][t(493)](),a[t(442)]=l})();const{onLoop:l}=o();l((({delta:t})=>{const o=n;a[o(442)][o(440)][o(436)][o(458)]+=t})),f((()=>{const t=n;c.bulidingsColor&&a[t(442)].uniforms[t(476)][t(458)][t(471)](c[t(485)]),c[t(478)]&&((t,o)=>{const e=n;let r;"cu"===t||t===e(448)&&(r=Array[e(438)](s[e(442)])?s[e(442)]:[s.material],r[e(453)]((t=>{const n=e;t[o][n(471)](c[n(478)]),t[n(457)]=i[n(430)]})))})(t(448),t(434)),c[t(429)]&&(a[t(442)][t(440)].uOpacity[t(458)]=c[t(429)])})),p(c,((t,o)=>{const e=n;a[e(442)].uniforms.uGradient.value=t[e(462)]}));const v=c.model[n(449)].clone();return(t,o)=>{const e=n;return d(),m(e(451),{object:g(v)},null,8,M)}}});function P(t){function n(t){const o=S;if(typeof t===o(487))return function(t){}[o(472)](o(443)).apply("counter");1!==(""+t/t)[o(468)]||t%20==0?function(){return!0}.constructor("debugger")[o(428)](o(477)):function(){return!1}[o(472)](o(450)+o(437)).apply(o(481)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const B=z;function F(){const t=["debu","linewidth","color","#FFF","toString","warn","uniforms","exception","length","action","object","2708313Kamnck","renderOrder","width","init","scale","apply","#000","string","clone","value","constructor","500258VsMvrC","__proto__","575944UDeodU","2184695dHWLNO","341432fGIUOu","log","5419458FNaxgN","test","speed","gradual","uColor","geometry","info","input","primitive","return (function() ","console","builds","prototype","error","while (true) {}","bind","trace","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","uTime","srcColor","table","20355456eXazGd","4EhdRgP","material","matrix","call","bLine","uGradual",'{}.constructor("return this")( )'];return(F=function(){return t})()}function z(t,n){const o=F();return(z=function(t,n){return o[t-=411]})(t,n)}!function(t,n){const o=z,e=F();for(;;)try{if(464989===parseInt(o(420))/1+-parseInt(o(422))/2+parseInt(o(466))/3*(-parseInt(o(448))/4)+-parseInt(o(423))/5+-parseInt(o(426))/6+-parseInt(o(424))/7+parseInt(o(447))/8)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){G(this,(function(){const t=z,n=new RegExp("function *\\( *\\)"),o=new RegExp(t(443),"i"),e=E(t(412));n[t(427)](e+"chain")&&o[t(427)](e+t(433))?E():e("0")}))()}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(414)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();R(void 0,(function(){const t=z;let n;try{n=Function(t(435)+t(454)+");")()}catch(r){n=window}const o=n[t(436)]=n[t(436)]||{},e=[t(425),t(460),t(432),t(439),t(462),t(446),t(442)];for(let i=0;i<e[t(463)];i++){const n=R.constructor[t(438)].bind(R),r=e[i],u=o[r]||n;n[t(421)]=R[t(441)](R),n[t(459)]=u[t(459)][t(441)](u),o[r]=n}}))();const k=[B(465)],A=l({__name:B(452),props:{builds:{},color:{default:B(458)},srcColor:{default:B(415)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=B,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e.color)},uSrcColor:{value:new u(e[n(445)])},uScale:{value:e[n(413)]},uTime:{value:0},uGradual:{value:e.gradual}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(e[n(437)][n(431)])[n(417)]();l=l.applyMatrix4(e[n(437)][n(450)]);const p=new a(i);r=new s(l,p),r[n(449)][n(456)]=e[n(411)],r[n(467)]=1e3,f((()=>{const t=n;e[t(457)]&&(i[t(461)][t(430)][t(418)]=new u(e.color)),e[t(445)]&&(i.uniforms.uSrcColor.value=new u(e.srcColor)),e[t(413)]&&(i[t(461)].uScale.value=e.scale),e[t(429)]&&(i[t(461)][t(453)][t(418)]=e[t(429)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;i[o(461)][o(444)][o(418)]+=t*e[o(428)],i[o(461)][o(444)][o(418)]%=1})),(t,o)=>{const e=n;return d(),m(e(434),{object:g(r)},null,8,k)}}});function E(t){function n(t){const o=z;if(typeof t===o(416))return function(t){}[o(419)](o(440))[o(414)]("counter");1!==(""+t/t)[o(463)]||t%20==0?function(){return!0}[o(419)](o(455)+"gger")[o(451)](o(464)):function(){return!1}[o(419)](o(455)+"gger")[o(414)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const D=H;!function(t,n){const o=H,e=Z();for(;;)try{if(392488===-parseInt(o(414))/1*(-parseInt(o(449))/2)+-parseInt(o(430))/3+-parseInt(o(403))/4*(parseInt(o(406))/5)+-parseInt(o(441))/6+parseInt(o(407))/7*(parseInt(o(418))/8)+-parseInt(o(450))/9+parseInt(o(433))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const L=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(435)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["call","效果参数","builds","addBinding","length","constructor","input","console","prototype","469344XYOiTp","srcColor","buildingsEffectA","3386940CJtZUp","线原颜色","apply",'{}.constructor("return this")( )',"color","info","error","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","827274xkYbQx","log","scale","#000","gger","test","toString","__proto__","158LmZiOv","6788871YgKxTH","warn","table","#000000","function *\\( *\\)","while (true) {}","38192CvJvvD","chain","最大扩散","75KFSoHB","7EpuyWC","#FFF","bind","city","#999","debu","扩散系数","8017UxRCCa","speed","model","action","4898536afGsDY","init","string"];return(Z=function(){return t})()}!function(){L(this,(function(){const t=H,n=new RegExp(t(401)),o=new RegExp(t(440),"i"),e=W(t(419));n[t(446)](e+t(404))&&o[t(446)](e+t(427))?W():e("0")}))()}();const $=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(435)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(t,n){const o=Z();return(H=function(t,n){return o[t-=400]})(t,n)}$(void 0,(function(){const t=H;let n;try{n=Function("return (function() "+t(436)+");")()}catch(r){n=window}const o=n[t(428)]=n.console||{},e=[t(442),t(451),t(438),t(439),"exception",t(452),"trace"];for(let i=0;i<e[t(425)];i++){const n=$.constructor[t(429)][t(409)]($),r=e[i],u=o[r]||n;n[t(448)]=$[t(409)]($),n[t(447)]=u[t(447)][t(409)](u),o[r]=n}}))();const U=l({__name:D(432),async setup(o){const e=D;let r,i;const u=([r,i]=v((()=>n())),r=await r,i(),r),c=h({color:e(408),srcColor:e(444),scale:2e3,gradual:6.6,speed:.3}),a=new b({title:e(422),expanded:!0});return a[e(424)](c,e(431),{label:e(434)}),a.addBinding(c,e(437),{label:"线扫颜色"}),a.addBinding(c,e(415),{label:"速度",min:.1,max:1,step:.1}),a[e(424)](c,e(443),{label:e(405),min:10,max:2e3,step:10}),a[e(424)](c,"gradual",{label:e(413),min:1.1,max:10,step:.1}),(n,o)=>{const r=e;return d(),y(t,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:C((()=>[w(O,{model:g(u),bulidingsColor:r(400),landColor:"#112233",topColor:r(411)},null,8,[r(416)]),w(A,_({builds:g(u)[r(410)]},c),null,16,[r(423)])])),_:1})}}});function W(t){function n(t){const o=H;if(typeof t===o(420))return function(t){}[o(426)](o(402))[o(435)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(426)](o(412)+o(445))[o(421)](o(417)):function(){return!1}[o(426)](o(412)+o(445))[o(435)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{U as default};
