import{f as e,n as a}from"./ncFileReader.tzMp_RC71763540743861.js";import{u as l}from"./rawData.Bm5IktqG1763540743861.js";import{u as t}from"./ncReader.Bsw5PghC1763540743861.js";import{u as n}from"./colorList.DbCLsRg71763540743861.js";import{g as s,a as i}from"./generalVolume.Bzkkd-tQ1763540743861.js";import{P as r}from"./tweakpane.CqZAnw7f1763540743861.js";import{d as u,a as o,a8 as m,c as d,w as v,H as p,o as c,J as x,I as f,ac as g,ao as b,u as h}from"./@vue.Co_gxueH1763540743861.js";import{bL as y,be as w,af as T,b1 as B,f as E,au as j,aE as F,aG as k,r as S,bK as _}from"./three.rXKzP9fQ1763540743861.js";const z=["scale","visible"],C=["object"],D=u({__name:"volumeMesh",async setup(u){let D,L;const R=o(1),H=o(1),A=o(1),G=n(),M=t(),I=new y(new w(new T(1,1,1)),new B({color:10066329})),J=M.netCDFHeader.variables.filter(e=>3==e.dimensions.length),q=o(J[0].name),K=l(),P=async()=>{const l=await e(M.netCDFHeader,q.value),t=a(l);console.log(t),K.setDataTypeFromJSdata(t.data),K.xExtent=t.xLength,K.yExtent=t.yLength,K.zExtent=t.zLength,K.setArrayBuffer(t.data),H.value=K.yExtent/K.xExtent,A.value=K.zExtent/K.xExtent};[D,L]=m(()=>P()),await D,L();const U=d(()=>!(R.value<=.01&&R.value>=-.01)&&(!(H.value<=.01&&H.value>=-.01)&&!(A.value<=.01&&A.value>=-.01))),V=()=>{const e=new F(K.byteArray,K.xExtent,K.yExtent,K.zExtent);return e.format=k,e.type=K.getThreeType(),e.minFilter=S,e.magFilter=S,e.wrapS=_,e.wrapT=_,e.wrapR=_,e.needsUpdate=!0,e},N={uniforms:{dataTexture:{value:V()},colorTexture:{value:G.updateTransferFunction()},samplingRate:{value:4},threshold:{value:.5},alphaScale:{value:1},invertColor:{value:!1},composeType:{value:1},u_clim:{value:new E(.093,-.001)}},vertexShader:i,fragmentShader:s,side:j,transparent:!0},O=o(!0),Q=new r;return Q.addBlade({view:"list",label:"气象要素",options:J.map(e=>({text:e.name,value:e.name})),value:q.value}).on("change",async e=>{q.value=e.value,await P(),N.uniforms.dataTexture.value=V()}),Q.addBinding(N.uniforms.u_clim.value,"x",{label:"clim1",min:.01,max:.6,step:.001}),Q.addBinding(N.uniforms.u_clim.value,"y",{label:"clim2",min:-.1,max:.03,step:.001}),Q.addBinding(R,"value",{label:"x轴缩放",min:-2,max:2,step:.01}),Q.addBinding(H,"value",{label:"y轴缩放",min:-2,max:2,step:.01}),Q.addBinding(A,"value",{label:"z轴缩放",min:-2,max:2,step:.01}),Q.addBlade({view:"list",label:"模式",options:[{text:"maximumIntensity",value:1},{text:"thresholding",value:2},{text:"emissionAbsorption",value:3}],value:N.uniforms.composeType.value}).on("change",e=>{N.uniforms.composeType.value=e.value}),Q.addBinding(N.uniforms.samplingRate,"value",{label:"体积采样率",min:0,max:5,step:.01}),Q.addBinding(N.uniforms.threshold,"value",{label:"体绘制的阈值",min:0,max:1,step:.01}),Q.addBinding(N.uniforms.alphaScale,"value",{label:"透明度",min:0,max:1,step:.01}),Q.addBinding(N.uniforms.invertColor,"value",{label:"是否反色"}),Q.addBinding(O,"value",{label:"显示边框"}),Q.addButton({title:"清空数据"}).on("click",()=>{M.netCDFHeader=null,Q.dispose()}),v(()=>G.colorsStops,()=>{N.uniforms.colorTexture.value=G.updateTransferFunction()},{deep:!0,immediate:!0}),(e,a)=>(c(),p("TresGroup",null,[x("TresMesh",{scale:[R.value,H.value,A.value],visible:U.value},[a[0]||(a[0]=x("TresBoxGeometry",{args:[1,1,1]},null,-1)),x("TresShaderMaterial",g(b(N)),null,16),O.value?(c(),p("primitive",{key:0,object:h(I)},null,8,C)):f("",!0)],8,z)]))}});export{D as _};
