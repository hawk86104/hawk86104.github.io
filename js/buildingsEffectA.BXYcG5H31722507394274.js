import{l as t,b as n}from"./pagesShow.vue_vue_type_script_setup_true_lang.DbPHC6ub1722507394274.js";import{$ as o}from"./@tresjs.bNNpPzYW1722507394274.js";import{C as e}from"./three-custom-shader-material.CeVv8ptL1722507394274.js";import"./object-hash.rImj7O_Q1722507394274.js";import{Y as r,a6 as i,C as u,ca as c,k as a,a_ as s}from"./three.Brogx0uK1722507394274.js";import"./@amap.B-BVafMU1722507394274.js";import"./glsl-tokenizer.D7fhDZQE1722507394274.js";import{d as l,a1 as f,w as p,o as d,D as m,u as g,a4 as v,r as h,f as y,g as w,j as _,m as C}from"./@vue.CFXy4cc91722507394274.js";import{P as b}from"./tweakpane.BCjFYDHx1722507394274.js";import"./@vueuse.CY5GWLAn1722507394274.js";import"./glsl-token-string.Bg9nzJXZ1722507394274.js";import"./glsl-token-functions.B8rjVA3n1722507394274.js";import"./jszip.BxDgYeH81722507394274.js";const x=j;function I(){const t=["413182nVVVyf","6663426eBQAVv","__csm","log","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","chain","bulidingsColor","computeBoundingSphere","counter","#ffff00","computeBoundingBox","bind","error","__proto__","table","model","opacity","init","object","test","5808hatwva","bModel","console","primitive","10880499AgdnTN","function *\\( *\\)","material","trace","clone","2782982vVpSVZ","uOpacity","length","toString","while (true) {}","stateObject","uGradient","DoubleSide","land","string","apply","value","debu","#112233","dispose","gger","setStyle","3ZdOpkc","gradient","forEach","warn","action","Color","input","prototype","3560172mQDbXu","72GsQIvN","uniforms","color","topColor","side","renderOrder","\n\t\tvarying vec4 vPosition;\n\t\tvoid main() {\n\t\t\tvPosition = modelMatrix * vec4(position,1.0);\n\t\t\tcsm_Position = position * vec3(1.0);\n\t\t}\n\t\t","landColor","children","constructor","#e523ff","6968040bdMLAK","#ffffff"];return(I=function(){return t})()}!function(t,n){const o=j,e=I();for(;;)try{if(851514===parseInt(o(245))/1+-parseInt(o(206))/2*(-parseInt(o(223))/3)+parseInt(o(231))/4+-parseInt(o(243))/5+parseInt(o(246))/6+-parseInt(o(269))/7+parseInt(o(265))/8*(-parseInt(o(232))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const M=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[j(216)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){M(this,(function(){const t=j,n=new RegExp(t(270)),o=new RegExp(t(249),"i"),e=A(t(262));n[t(264)](e+t(250))&&o[t(264)](e+t(229))?A():e("0")}))()}();const S=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function j(t,n){const o=I();return(j=function(t,n){return o[t-=204]})(t,n)}S(void 0,(function(){const t=j;let n;try{n=Function('return (function() {}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(267)]=n[t(267)]||{},e=[t(248),t(226),"info",t(257),"exception",t(259),t(204)];for(let i=0;i<e.length;i++){const n=S.constructor[t(230)].bind(S),r=e[i],u=o[r]||n;n[t(258)]=S[t(256)](S),n[t(209)]=u[t(209)][t(256)](u),o[r]=n}}))();const T=[x(263)],P=l({__name:x(266),props:{model:{},bulidingsColor:{default:x(242)},landColor:{default:x(219)},topColor:{default:x(254)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(t){const n=x,u=t,c=u[n(260)].city;u[n(260)][n(260)][n(240)][0][n(271)]=new r({color:"#ffff00"}),c[n(237)]=1001;const a=u.model[n(214)];(()=>{const t=n,{geometry:o}=c;o[t(255)](),o[t(252)]();const{max:r,min:a}=o.boundingBox;if(c[t(271)][t(247)])return;const s=new e({baseMaterial:c[t(271)],vertexShader:t(238),fragmentShader:"\n\t\tuniform mat4 modelMatrix;\n\t\tvarying vec4 vPosition;\n\t\tuniform vec3 uMax; \n\t\tuniform vec3 uMin; \n\t\tuniform float uOpacity;  \n\t\tuniform float uBorderWidth; \n\t\tuniform vec3 uLightColor;\n\t\tuniform vec3 uColor;\n\t\tuniform float uCircleTime; \n\t\tuniform float uTime; \n\t\tuniform vec3 uTopColor;\t\t\t\t\t//顶部颜色\n\t\tuniform bool uGradient;\n\t\tvec4 uMax_world;\n\t\tvec4 uMin_world;\n\t\tvoid main() {\n\t\t\t// 转世界坐标\n\t\t\tuMax_world =  modelMatrix * vec4(uMax,1.0);\n\t\t\tuMin_world =  modelMatrix * vec4(uMin,1.0);\n\t\t\tvec3 distColor = uColor;\n\t\t\tfloat residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n\t\t\tfloat rate = residue / uCircleTime;\n\t\t\tfloat lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n\t\t\tif (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n\t\t\t\tcsm_DiffuseColor = vec4(uLightColor, uOpacity);\n\t\t\t} else {\n\t\t\t\tcsm_DiffuseColor = vec4(distColor, uOpacity);\n\t\t\t}\n\n\t\t\t//根据高度计算颜色\n\t\t\tif(uGradient){\n\t\t\t\tfloat rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n\t\t\t\tvec3 outColor = mix(csm_DiffuseColor.xyz, uTopColor, rateHight*2.0);\n\t\t\t\tcsm_DiffuseColor = vec4(outColor, uOpacity);\n\t\t\t}\n    }\n\t\t",silent:!0,uniforms:{uMax:{value:r},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(i[t(228)])(u[t(251)])},uOpacity:{value:u[t(261)]},uLightColor:{value:new(i[t(228)])(t(244))},uTopColor:{value:new(i[t(228)])(u[t(235)])},uTime:{value:0},uGradient:{value:u[t(224)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:i[t(213)]});c[t(271)][t(220)](),c.material=s})();const{onLoop:s}=o();s((({delta:t})=>{const o=n;c[o(271)][o(233)].uTime[o(217)]+=t})),f((()=>{const t=n;u[t(251)]&&c[t(271)][t(233)].uColor[t(217)][t(222)](u.bulidingsColor),u.landColor&&((t,o)=>{const e=n;let r;"cu"===t||"land"===t&&(r=Array.isArray(a[e(271)])?a[e(271)]:[a.material],r[e(225)]((t=>{const n=e;t[o][n(222)](u[n(239)]),t[n(236)]=i[n(213)]})))})(t(214),t(234)),u.opacity&&(c.material[t(233)][t(207)][t(217)]=u[t(261)])})),p(u,((t,o)=>{const e=n;c[e(271)][e(233)][e(212)][e(217)]=t[e(224)]}));const l=u[n(260)][n(260)][n(205)]();return(t,o)=>{const e=n;return d(),m(e(268),{object:g(l)},null,8,T)}}});function A(t){function n(t){const o=j;if(typeof t===o(215))return function(t){}[o(241)](o(210))[o(216)](o(253));1!==(""+t/t)[o(208)]||t%20==0?function(){return!0}[o(241)](o(218)+o(221)).call(o(227)):function(){return!1}[o(241)](o(218)+o(221)).apply(o(211)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const O=z;function F(){const t=["289278JZpmcs","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","bLine","chain","gradual","gger",'{}.constructor("return this")( )',"434840HTspXb","debu","width","color","apply","warn","log","exception","226802aTzxAR","test","linewidth","length","prototype","input","console","bind","scale","#000","action","constructor","uniforms","init","renderOrder","uColor","4480392cDgqEr","916190jaAmgH","info","trace","431736sghQtm","matrix","clone","uTime","primitive","srcColor","value","object","applyMatrix4","material","530673WUeSpI","uScale","function *\\( *\\)","error","string"];return(F=function(){return t})()}function z(t,n){const o=F();return(z=function(t,n){return o[t-=188]})(t,n)}!function(t,n){const o=z,e=F();for(;;)try{if(194276===-parseInt(o(233))/1+-parseInt(o(198))/2+parseInt(o(228))/3+-parseInt(o(190))/4+-parseInt(o(215))/5+parseInt(o(218))/6+parseInt(o(214))/7)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const B=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(194)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){B(this,(function(){const t=z,n=new RegExp(t(230)),o=new RegExp(t(234),"i"),e=G(t(211));n[t(199)](e+t(236))&&o.test(e+t(203))?G():e("0")}))()}();const R=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[z(194)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();R(void 0,(function(){const t=z;let n;try{n=Function("return (function() "+t(189)+");")()}catch(r){n=window}const o=n[t(204)]=n[t(204)]||{},e=[t(196),t(195),t(216),t(231),t(197),"table",t(217)];for(let i=0;i<e.length;i++){const n=R.constructor[t(202)][t(205)](R),r=e[i],u=o[r]||n;n.__proto__=R[t(205)](R),n.toString=u.toString[t(205)](u),o[r]=n}}))();const k=[O(225)],E=l({__name:O(235),props:{builds:{},color:{default:"#FFF"},srcColor:{default:O(207)},scale:{default:2e3},gradual:{default:10},speed:{default:.5}},setup(t){const n=O,e=t;let r=null;const i={transparent:!0,uniforms:{uColor:{value:new u(e[n(193)])},uSrcColor:{value:new u(e[n(223)])},uScale:{value:e[n(206)]},uTime:{value:0},uGradual:{value:e[n(237)]}},vertexShader:"varying vec3 vPosition;\nvoid main(){\n\tvPosition=position;\n\tvec4 viewPosition=modelViewMatrix*vec4(position,1.);\n\tgl_Position=projectionMatrix*viewPosition;\n}",fragmentShader:"uniform float uScale;//最大扩散\nuniform float uGradual;//建变系数\nuniform float uTime;\nuniform vec3 uColor;//扩散颜色\nuniform vec3 uSrcColor;//原始颜色\nvarying vec3 vPosition;\n\nvoid main(){\n\tfloat dis=distance(vPosition.xz,vec2(.0,.0));\n\tif(dis>uScale){\n\t\tdiscard;\n\t}\n\tfloat opacity=smoothstep(uScale/uGradual*uTime,uScale*uTime,dis);\n\topacity*=step(dis,uScale*uTime);\n\t\n\tif(opacity<.3){\n\t\tgl_FragColor=vec4(uSrcColor,1.-opacity);\n\t}else{\n\t\tgl_FragColor=vec4(uColor,opacity);\n\t}\n\t// gl_FragColor=vec4(uColor,opacity);\n}\n"};let l=new c(e.builds.geometry)[n(220)]();l=l[n(226)](e.builds[n(219)]);const p=new a(i);r=new s(l,p),r[n(227)][n(200)]=e[n(192)],r[n(212)]=1e3,f((()=>{const t=n;e[t(193)]&&(i[t(210)][t(213)][t(224)]=new u(e[t(193)])),e[t(223)]&&(i[t(210)].uSrcColor[t(224)]=new u(e[t(223)])),e[t(206)]&&(i.uniforms[t(229)][t(224)]=e[t(206)]),e[t(237)]&&(i.uniforms.uGradual[t(224)]=e[t(237)])}));const{onLoop:v}=o();return v((({delta:t})=>{const o=n;i.uniforms[o(221)][o(224)]+=t*e.speed,i.uniforms[o(221)].value%=1})),(t,o)=>{const e=n;return d(),m(e(222),{object:g(r)},null,8,k)}}});function G(t){function n(t){const o=z;if(typeof t===o(232))return function(t){}.constructor("while (true) {}")[o(194)]("counter");1!==(""+t/t)[o(201)]||t%20==0?function(){return!0}[o(209)]("debu"+o(188)).call(o(208)):function(){return!1}[o(209)](o(191)+o(188))[o(194)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const L=V;!function(t,n){const o=V,e=H();for(;;)try{if(493952===-parseInt(o(148))/1*(parseInt(o(141))/2)+-parseInt(o(138))/3+-parseInt(o(154))/4+parseInt(o(136))/5*(parseInt(o(133))/6)+parseInt(o(134))/7+parseInt(o(161))/8+-parseInt(o(172))/9*(-parseInt(o(159))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const Z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){Z(this,(function(){const t=V,n=new RegExp(t(163)),o=new RegExp(t(157),"i"),e=U("init");n[t(165)](e+t(176))&&o.test(e+"input")?U():e("0")}))()}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function H(){const t=["builds","#112233","stateObject","log","46SlPbUR","效果参数","console","buildingsEffectA","#FFF","return (function() ","2886800NWMHFz","string","prototype","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","线扫颜色","180800PpXaqn","bind","7196736RHxKXj","gradual","function *\\( *\\)","最大扩散","test","#000",'{}.constructor("return this")( )',"toString","call","city","扩散系数","189JueLfx","counter","model","#999","chain","gger","length","warn","constructor","scale","addBinding","exception","87324deuNXL","2840117ubUVUp","apply","65duIfIx","srcColor","388107oUzUlF","speed","__proto__","23008reHRTy","debu","color"];return(H=function(){return t})()}function V(t,n){const o=H();return(V=function(t,n){return o[t-=132]})(t,n)}D(void 0,(function(){const t=V,n=function(){const t=V;let n;try{n=Function(t(153)+t(167)+");")()}catch(o){n=window}return n}(),o=n[t(150)]=n[t(150)]||{},e=[t(147),t(179),"info","error",t(132),"table","trace"];for(let r=0;r<e.length;r++){const n=D[t(180)][t(156)][t(160)](D),i=e[r],u=o[i]||n;n[t(140)]=D.bind(D),n.toString=u[t(168)][t(160)](u),o[i]=n}}))();const $=l({__name:L(151),async setup(o){const e=L;let r,i;const u=([r,i]=v((()=>t())),r=await r,i(),r),c=h({color:e(152),srcColor:e(166),scale:2e3,gradual:6.6,speed:.3}),a=new b({title:e(149),expanded:!0});return a[e(182)](c,e(137),{label:"线原颜色"}),a[e(182)](c,e(143),{label:e(158)}),a.addBinding(c,e(139),{label:"速度",min:.1,max:1,step:.1}),a[e(182)](c,e(181),{label:e(164),min:10,max:2e3,step:10}),a[e(182)](c,e(162),{label:e(171),min:1.1,max:10,step:.1}),(t,o)=>{const r=e;return d(),y(n,{showAxesHelper:!1,autoRotate:!1,showBuildings:!1},{ability:w((()=>[_(P,{model:g(u),bulidingsColor:"#000000",landColor:r(145),topColor:r(175)},null,8,[r(174)]),_(E,C({builds:g(u)[r(170)]},c),null,16,[r(144)])])),_:1})}}});function U(t){function n(t){const o=V;if(typeof t===o(155))return function(t){}[o(180)]("while (true) {}").apply(o(173));1!==(""+t/t)[o(178)]||t%20==0?function(){return!0}[o(180)](o(142)+o(177))[o(169)]("action"):function(){return!1}[o(180)](o(142)+o(177))[o(135)](o(146)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{$ as default};
