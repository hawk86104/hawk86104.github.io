import{B as e}from"./three-custom-shader-material.C6taB_aY1763540743861.js";import{am as t,ae as n,ei as a,M as r}from"./three.rXKzP9fQ1763540743861.js";import{u as i}from"./colorList.DbCLsRg71763540743861.js";import{u as s}from"./rawData.Bm5IktqG1763540743861.js";import{d as o,r as l,a as m,w as d,H as p,o as h,J as c,u}from"./@vue.Co_gxueH1763540743861.js";const x=["visible"],g=["scale"],w=["object"],f=["object"],T=o({__name:"nc2003MapsurfaceSection",props:{paneControl:{}},setup(o){const T=o,b=i(),v=s(),S=(()=>{const e=new a(v.xExtent,v.yExtent,v.zExtent,v.dataType[v.selectDataType].title,v.byteArray);return e.spacing=[1,1,1],e.RASDimensions=[Math.floor(e.xLength),Math.floor(e.yLength),Math.floor(e.zLength)],e.matrix=new r,e.inverseMatrix=new r,e.inverseMatrix.copy(e.matrix).invert(),e.lowerThreshold=-1.11,e.upperThreshold=3,e.windowLow=-1.15,e.windowHigh=.09,e})(v.byteArray),L=l({x:Math.floor(S.RASDimensions[0]/2),z:Math.floor(0)}),y=S.extractSlice("x",L.x);y.geometryNeedsUpdate=!0;const M=S.extractSlice("z",L.z);M.geometryNeedsUpdate=!0;const z={vertexShader:"\n\tvoid main() {\n\t\tcsm_Position = position * vec3(1.0);\n\t}\n\t",fragmentShader:"\n\t\t\tuniform sampler2D eTexture;     //纹理图像\n\t\t\tvoid main() {\n\t\t\t\t\tcsm_DiffuseColor = texture2D( eTexture, vec2(csm_DiffuseColor.r,0.5));\n\t\t\t}\n\t",uniforms:{eTexture:{value:b.updateTransferFunction()}},silent:!0,flatShading:!0,side:n,transparent:!0,depthWrite:!1,depthTest:!0,blending:t};y.mesh.material=new e({baseMaterial:y.mesh.material,...z}),M.mesh.material=new e({baseMaterial:M.mesh.material,...z});const A=T.paneControl;A.addBinding(L,"x",{label:"x剖面",min:-1,max:S.RASDimensions[0],step:.1}),A.addBinding(L,"z",{label:"z剖面",min:-1,max:S.RASDimensions[2],step:.1}),A.addBinding(S,"lowerThreshold",{label:"lowerThreshold",min:-3,max:1,step:.01}).on("change",()=>{S.repaintAllSlices()}),A.addBinding(S,"upperThreshold",{label:"upperThreshold",min:-1,max:6,step:.01}).on("change",()=>{S.repaintAllSlices()}),A.addBinding(S,"windowLow",{label:"windowLow",min:-2,max:2,step:.01}).on("change",()=>{S.repaintAllSlices()}),A.addBinding(S,"windowHigh",{label:"windowHigh",min:-.1,max:1,step:.001}).on("change",()=>{S.repaintAllSlices()});const D=m(!1);return A.addBinding(D,"value",{label:"显示剖面"}),d(()=>L,e=>{y.index=e.x,y.repaint.call(y),M.index=e.z,M.repaint.call(M)},{deep:!0}),d(()=>b.colorsStops,()=>{y.mesh.material.uniforms.eTexture.value=b.updateTransferFunction(),M.mesh.material.uniforms.eTexture.value=b.updateTransferFunction()},{deep:!0,immediate:!0}),(e,t)=>(h(),p("TresGroup",{visible:D.value},[c("TresGroup",{scale:[1/u(S).xLength,1/u(S).xLength*u(S).xLength/u(S).yLength,1/u(S).xLength*u(S).xLength/u(S).zLength]},[c("primitive",{object:u(y).mesh,renderOrder:99993},null,8,w),c("primitive",{object:u(M).mesh,renderOrder:99992},null,8,f)],8,g)],8,x))}});export{T as _};
