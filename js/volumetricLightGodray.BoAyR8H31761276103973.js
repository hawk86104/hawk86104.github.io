import{F as e,_ as a,C as s,K as r,o as l}from"./@tresjs.B_KjVy0E1761276103973.js";import"./vanilla.esm.5.5.0.CRlEbOMK1761276103973.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.Dr9gcEbl1761276103973.js";import"./Resource.CSaxGSPI1761276103973.js";import{bs as n,b3 as o,bt as u,A as i,y as p,a4 as m,o as c}from"./three.Bhn4-0ry1761276103973.js";import{a as f,w as v,A as d,d as h,G as g,o as _,I as b,u as M,L as T,ac as j,h as y,e as w,F as x,a3 as S,ad as k,r as G,s as P,b as R,H as C,a9 as A,aa as B,ap as z}from"./@vue.CKlgtJke1761276103973.js";import{E as D,R as L,b as $,a as F}from"./postprocessing.CeTFUAN_1761276103973.js";import"./@vueuse.wtfleElW1761276103973.js";import"./object-hash.1qNYTrnD1761276103973.js";import"./@amap.fjyZdsU91761276103973.js";import"./jszip.y_yjJ09m1761276103973.js";import"./utils.CNife3_q1761276103973.js";const I=["object"],E=h({__name:"index",props:{resolution:{default:256},near:{default:.1},far:{default:1e3},envMap:{default:null},fog:{default:null},frames:{default:1/0}},setup(s,{expose:r}){const l=s,{fbo:t,camera:i,update:p}=function({resolution:a=256,near:s=.1,far:r=1e3,envMap:l,fog:t}={}){const{renderer:i,scene:p}=e(),m=f(null),c=f(a),h=f(s),g=f(r),_=f(null);let b,M;return v(()=>c,e=>{m.value?.dispose(),m.value=new n(e.value),m.value.texture.type=o},{immediate:!0}),v([h,g,m],([e,a,s])=>{s&&(_.value=new u(e,a,s))},{immediate:!0}),d(()=>{m.value?.dispose()}),{fbo:m,camera:_,update:()=>{b=p.value.fog,M=p.value.background,p.value.background=l||M,p.value.fog=t||b,_.value?.update(i,p.value),p.value.fog=b,p.value.background=M}}}({resolution:l.resolution,near:l.near,far:l.far,envMap:l.envMap,fog:l.fog}),{onBeforeRender:m}=a();let c=0;const h=f(null);return m(()=>{h.value&&(l.frames===1/0||c<l.frames)&&(h.value.visible=!1,p(),h.value.visible=!0,c++)}),r({texture:t.value?.texture}),(e,a)=>(_(),g("TresGroup",null,[b("primitive",{object:M(i)},null,8,I),b("TresGroup",{ref_key:"rgRef",ref:h},[T(e.$slots,"default")],512)]))}}),H=["map"],K=["envMap"],U=h({__name:"screen",async setup(e){let a,r;const l=f();l.value=([a,r]=j(()=>s("./plugins/visualArts/video/vlg.mp4",{loop:!0})),a=await a,r(),a),l.value.colorSpace=i;const t=f(),n=f();v(t,e=>{n.value=e.texture});const o=f();return(e,a)=>(_(),g(x,null,[b("TresMesh",{ref_key:"tmSceen",ref:o,position:[0,0,-16]},[a[0]||(a[0]=b("TresPlaneGeometry",{args:[16,10]},null,-1)),b("TresMeshBasicMaterial",{map:l.value},null,8,H),a[1]||(a[1]=b("TresMesh",{scale:[16.05,10.05,1],position:[0,0,-.01]},[b("TresPlaneGeometry"),b("TresMeshBasicMaterial",{color:"black"})],-1))],512),y(M(E),{ref_key:"cubeCameraRef",ref:t,position:[-3,-1,-5],resolution:256},{default:w(()=>[b("TresMesh",null,[a[2]||(a[2]=b("TresSphereGeometry",{args:[2,32,32]},null,-1)),b("TresMeshStandardMaterial",{metalness:1,roughness:.1,envMap:n.value},null,8,K)])]),_:1},512)],64))}}),Z=h({__name:"effectComposer",props:{screen:{}},setup(s){const r=s,{camera:l,renderer:t,scene:n,sizes:u}=e();let i=null,f=null;const v=[];S(()=>{if(u.width.value){const e=l.value;((e,a,s)=>{i=new D(s,{frameBufferType:o,multisampling:8});const r=new L(e,a);i.addPass(r)})(n.value,e,t,u.width.value,u.height.value),(e=>{const a=new p({color:16768426,transparent:!0,fog:!1}),s=new m(.75,32,32),l=new c(s,a);l.frustumCulled=!1,l.matrixAutoUpdate=!1;const t=new $(e,k(r.screen),{blur:!0,decay:.9,exposure:.34});v.push(t)})(e),f=new F(e,...v),i.addPass(f)}});const{onRender:d}=a();return d(()=>{i&&i.render()}),(e,a)=>null}}),q=["rotation"],J=h({__name:"volumetricLightGodray",setup(e){const a={clearColor:"#050505",antialias:!1,renderMode:"manual",windowSize:!0},s=G({enableDamping:!0}),n=f(null),o=f(null);return v(()=>n,e=>{P(()=>{e&&void 0!==e.value.$refs.tmSceen&&(o.value=e.value.$refs.tmSceen)})},{deep:!0}),(e,u)=>(_(),R(M(l),A(B(a)),{default:w(()=>[u[1]||(u[1]=b("TresPerspectiveCamera",{position:[0,0,30],fov:45,near:.1,far:1e3},null,-1)),y(M(r),A(B(s)),null,16),u[2]||(u[2]=b("TresAmbientLight",{intensity:.5},null,-1)),(_(),R(z,null,{default:w(()=>[y(U,{ref_key:"screenRef",ref:n},null,512)]),_:1})),b("TresMesh",{position:[0,-5.02,0],receiveShadow:"",rotation:[-Math.PI/2,0,0]},[u[0]||(u[0]=b("TresPlaneGeometry",{args:[50,50]},null,-1)),y(M(t),{blur:[300,50],resolution:1024,mixBlur:1,mixStrength:100,roughness:1,depthScale:1.2,minDepthThreshold:.4,maxDepthThreshold:1.4,color:"#202020",metalness:.8})],8,q),o.value?(_(),R(Z,{key:0,screen:o.value},null,8,["screen"])):C("",!0)]),_:1},16))}});export{J as default};
