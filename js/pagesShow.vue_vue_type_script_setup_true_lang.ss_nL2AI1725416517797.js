import{a6 as t,C as n,cb as o,cc as e,cd as r,ce as i,k as u,bS as c,ab as s,ad as a}from"./three.VTQVqxMx1725416517797.js";import{f as l,$ as f,d as p}from"./@tresjs.5lh7VmqZ1725416517797.js";import{C as d}from"./three-custom-shader-material.R9Qrt3ei1725416517797.js";import"./object-hash.UdqO8HjX1725416517797.js";import"./@amap.LUDXTi4z1725416517797.js";import"./glsl-tokenizer.dGVPr_M11725416517797.js";import{d as m,b as h,a2 as y,w as g,o as w,E as b,u as v,r as _,a5 as I,e as C,f as x,g as M,L as O,j as T,aj as j,ak as S,F as B,J as A,H as L,m as R}from"./@vue._6MD2XyK1725416517797.js";!function(t,n){const o=k,e=W();for(;;)try{if(386515===-parseInt(o(397))/1*(-parseInt(o(400))/2)+-parseInt(o(398))/3*(parseInt(o(374))/4)+parseInt(o(388))/5*(-parseInt(o(394))/6)+parseInt(o(383))/7*(parseInt(o(361))/8)+parseInt(o(376))/9+parseInt(o(377))/10*(-parseInt(o(392))/11)+-parseInt(o(379))/12*(-parseInt(o(393))/13))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){D(this,(function(){const t=k,n=new RegExp(t(381)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=H("init");n[t(401)](e+t(395))&&o[t(401)](e+t(372))?H():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[k(380)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function W(){const t=["72BmPsjH","while (true) {}","1708182FxreeX","15830qbDBsP",'{}.constructor("return this")( )',"11607732oBOsCq","apply","function *\\( *\\)","counter","163569WGRUFI","warn","console","exception","return (function() ","4405dXLnVx","constructor","toString","gger","1540dEyzpp","13prmfrc","4542mOCvLw","chain","length","2MPzaqD","108417XclEpf","action","44068hpIWdD","test","248IcZGgc","trace","info","debu","bind","name","string","error","__proto__","prototype","LANDMASS","input","traverse"];return(W=function(){return t})()}function k(t,n){const o=W();return(k=function(t,n){return o[t-=361]})(t,n)}E(void 0,(function(){const t=k;let n;try{n=Function(t(387)+t(378)+");")()}catch(r){n=window}const o=n[t(385)]=n[t(385)]||{},e=["log",t(384),t(363),t(368),t(386),"table",t(362)];for(let i=0;i<e[t(396)];i++){const n=E[t(389)][t(370)][t(365)](E),r=e[i],u=o[r]||n;n[t(369)]=E[t(365)](E),n[t(390)]=u[t(390)][t(365)](u),o[r]=n}}))();const z=async()=>{const t=k,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(373)]((n=>{const i=t;"CITY_UNTRIANGULATED"===n[i(366)]&&(o=n),n[i(366)]===i(371)&&(e=n),"ROADS"===n[i(366)]&&(r=n)})),{model:n,city:o,land:e,roads:r}};function H(t){function n(t){const o=k;if(typeof t===o(367))return function(t){}[o(389)](o(375)).apply(o(382));1!==(""+t/t)[o(396)]||t%20==0?function(){return!0}[o(389)]("debu"+o(391)).call(o(399)):function(){return!1}[o(389)](o(364)+"gger")[o(380)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const P=N;!function(t,n){const o=N,e=Z();for(;;)try{if(409723===parseInt(o(491))/1*(parseInt(o(504))/2)+-parseInt(o(479))/3+-parseInt(o(489))/4*(-parseInt(o(466))/5)+parseInt(o(482))/6+-parseInt(o(474))/7+-parseInt(o(465))/8+parseInt(o(459))/9*(parseInt(o(515))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const F=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(473)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){F(this,(function(){const t=N,n=new RegExp(t(495)),o=new RegExp(t(509),"i"),e=U(t(507));n[t(510)](e+t(472))&&o[t(510)](e+t(468))?U():e("0")}))()}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(473)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function N(t,n){const o=Z();return(N=function(t,n){return o[t-=459]})(t,n)}function Z(){const t=["debu","__proto__","gger","city","primitive","1699444hvWllf","material","1rjKnqL","toString","topColor","setStyle","function *\\( *\\)","bind","prototype","DoubleSide","computeBoundingSphere","while (true) {}",'{}.constructor("return this")( )',"opacity","Color","22834vLuiuz","land","table","init","#e523ff","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","test","bulidingsColor","dispose","info","computeBoundingBox","50cbJTCb","warn","value","constructor","3244842YbWBws","side","uOpacity","console","#ffff00","color","5700288nNOWJy","5Xvqcin","isArray","input","boundingBox","length","uGradient","chain","apply","3454948jOHbSt","call","forEach","model","gradient","2029407cXUSUO","#ffffff","buildingsModelCustomShader","319944OumNHj","uniforms"];return(Z=function(){return t})()}G(void 0,(function(){const t=N,n=function(){const t=N;let n;try{n=Function("return (function() "+t(501)+");")()}catch(o){n=window}return n}(),o=n.console=n[t(462)]||{},e=["log",t(516),t(513),"error","exception",t(506),"trace"];for(let r=0;r<e.length;r++){const n=G[t(518)][t(497)].bind(G),i=e[r],u=o[i]||n;n[t(485)]=G[t(496)](G),n[t(492)]=u[t(492)].bind(u),o[i]=n}}))();const $=["object"],q=m({__name:P(481),props:{model:{},bulidingsColor:{default:P(508)},landColor:{default:"#112233"},topColor:{default:P(463)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=P,r=o,i=h(0),u=r[e(477)][e(487)];u.renderOrder=1001;const c=r[e(477)][e(505)];(()=>{const o=e,{geometry:c}=u;c[o(514)](),c[o(499)]();const{max:s,min:a}=c[o(469)];if(u[o(490)].__csm)return;const l=new d({baseMaterial:u[o(490)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new n(r[o(511)])},uOpacity:{value:r[o(502)]},uLightColor:{value:new n(o(480))},uTopColor:{value:new(t[o(503)])(r[o(493)])},uTime:i,uGradient:{value:r[o(478)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(498)]});u[o(490)][o(512)](),u[o(490)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(517)]+=t})),y((()=>{const n=e;r.bulidingsColor&&u[n(490)].uniforms.uColor[n(517)].setStyle(r[n(511)]),r.landColor&&((n,o)=>{const i=e;let u;"cu"===n||n===i(505)&&(u=Array[i(467)](c[i(490)])?c.material:[c.material],u[i(476)]((n=>{const e=i;n[o][e(494)](r.landColor),n[e(460)]=t[e(498)]})))})(n(505),n(464)),r[n(502)]&&(u[n(490)][n(483)][n(461)][n(517)]=r[n(502)])})),g(r,((t,n)=>{const o=e;u[o(490)][o(483)][o(471)][o(517)]=t[o(478)]}));const a=r[e(477)].model.clone();return(t,n)=>{const o=e;return w(),b(o(488),{object:v(a)},null,8,$)}}});function U(t){function n(t){const o=N;if("string"==typeof t)return function(t){}[o(518)](o(500))[o(473)]("counter");1!==(""+t/t)[o(470)]||t%20==0?function(){return!0}[o(518)](o(484)+o(486))[o(475)]("action"):function(){return!1}.constructor("debugger")[o(473)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}const X=Q;!function(t,n){const o=Q,e=V();for(;;)try{if(431415===-parseInt(o(245))/1+parseInt(o(226))/2+-parseInt(o(254))/3*(-parseInt(o(241))/4)+parseInt(o(225))/5*(-parseInt(o(217))/6)+-parseInt(o(237))/7+-parseInt(o(250))/8*(-parseInt(o(231))/9)+parseInt(o(257))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=Q,n=new RegExp(t(264)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=nt(t(222));n[t(247)](e+"chain")&&o.test(e+t(228))?nt():e("0")}))()}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(214)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function V(){const t=["793387IfylNm","linewidth","test","applyMatrix4","material","2296ahdPlN","Shader","resolution","style","61023okmAWc","uniforms","prototype","8387620egZoov","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","string","clone","info","exception","#FFF","function *\\( *\\)","gger","table","value","width","stateObject","warn","apply","counter","builds","543288czwElN","matrix","__proto__","return (function() ","geometry","init","color","fromEdgesGeometry","10TKbWJb","785988HsGbNd","log","input","constructor","uColor","3744lKOoqo","Wireframe","console","primitive","debu","innerWidth","5027456oIkOtk","action","opacity","call","152jMkxgp","buildingsLines","bind","innerHeight"];return(V=function(){return t})()}K(void 0,(function(){const t=Q;let n;try{n=Function(t(220)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(233)]=n[t(233)]||{},e=[t(227),t(270),t(261),"error",t(262),t(266),"trace"];for(let i=0;i<e.length;i++){const n=K[t(229)][t(256)].bind(K),r=e[i],u=o[r]||n;n[t(219)]=K[t(243)](K),n.toString=u.toString.bind(u),o[r]=n}}))();const Y=["object"];function Q(t,n){const o=V();return(Q=function(t,n){return o[t-=214]})(t,n)}const tt=m({__name:X(242),props:{builds:{},width:{default:1},color:{default:X(263)},opacity:{default:1},style:{default:"Wireframe"}},setup(t){const c=X,s=t;let a=null,l=null;if(s[c(253)]===c(232)){const t=new o(s[c(216)][c(221)]);let n=(new e)[c(224)](t),u=new r({color:s[c(223)],linewidth:s[c(268)],opacity:s[c(239)],transparent:!0,depthWrite:!0,depthTest:!0});u[c(252)].set(window[c(236)],window[c(244)]),a=new i(n,u),a[c(248)](s.builds.matrix[c(260)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[c(223)])},uOpacity:{value:s.opacity}},vertexShader:c(258),fragmentShader:" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const t=new o(s[c(216)][c(221)]),e=new u(l);a=new LineSegments(t,e),a[c(248)](s[c(216)][c(218)][c(260)]()),a[c(249)].linewidth=s[c(268)],a.renderOrder=1e3}return y((()=>{const t=c;s[t(253)]===t(251)&&(s[t(223)]&&(l[t(255)][t(230)][t(267)]=new n(s.color)),s.opacity&&(l[t(255)].uOpacity[t(267)]=s[t(239)])),"Wireframe"===s[t(253)]&&(s.color&&(a[t(249)][t(223)]=new n(s[t(223)])),s[t(239)]&&(a[t(249)][t(239)]=s.opacity)),s[t(268)]&&(a[t(249)][t(246)]=s[t(268)])})),(t,n)=>{const o=c;return w(),b(o(234),{object:v(a)},null,8,Y)}}});function nt(t){function n(t){const o=Q;if(typeof t===o(259))return function(t){}.constructor("while (true) {}").apply(o(215));1!==(""+t/t).length||t%20==0?function(){return!0}[o(229)]("debu"+o(265))[o(240)](o(238)):function(){return!1}[o(229)](o(235)+"gger").apply(o(269)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=it;!function(t,n){const o=it,e=lt();for(;;)try{if(488379===-parseInt(o(157))/1*(-parseInt(o(189))/2)+-parseInt(o(140))/3+parseInt(o(185))/4+-parseInt(o(165))/5*(parseInt(o(191))/6)+-parseInt(o(159))/7*(parseInt(o(162))/8)+parseInt(o(184))/9*(parseInt(o(153))/10)+parseInt(o(168))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(147)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=it,n=new RegExp("function *\\( *\\)"),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=pt(t(176));n[t(139)](e+t(164))&&o[t(139)](e+t(148))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[it(147)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function it(t,n){const o=lt();return(it=function(t,n){return o[t-=139]})(t,n)}rt(void 0,(function(){const t=it,n=function(){const t=it;let n;try{n=Function(t(163)+t(175)+");")()}catch(o){n=window}return n}(),o=n[t(141)]=n.console||{},e=[t(152),t(180),t(150),t(179),t(151),t(181),t(167)];for(let r=0;r<e[t(171)];r++){const n=rt[t(178)][t(145)][t(177)](rt),i=e[r],u=o[i]||n;n[t(187)]=rt[t(177)](rt),n[t(142)]=u.toString.bind(u),o[i]=n}}))();const ut=O("TresAmbientLight",{color:ot(193)},null,-1),ct=O(ot(182),{position:[100,100,0],intensity:.5,color:ot(193)},null,-1),st={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]};function lt(){const t=["prototype","model","apply","input","autoRotate","info","exception","log","10bmcHwe","pagesShow","#000000","showBuildings","2tDMxDl","tcRef","6246499sqZDqx","string","$slots","8lUULYo","return (function() ","chain","905JfIyNL","gger","trace","11282634IOSEcP","city","action","length","showGridHelper","ability","#000",'{}.constructor("return this")( )',"init","bind","constructor","error","warn","table","TresDirectionalLight","counter","8415774gmVmTq","2720068dTWDcN","showAxesHelper","__proto__","builds","180182uSipFI","disableRender","25176ztjouD","debu","#ffffff","test","2042301fjElpH","console","toString","TresPerspectiveCamera","call"];return(lt=function(){return t})()}const ft=m({__name:ot(154),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(155),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r[n(190)]}),u=_({autoRotate:r[n(149)],enableDamping:!0});let l=null;r.showBuildings&&([o,e]=I((()=>z())),o=await o,e(),l=o);const f=h(),d=h();return(t,o)=>{const e=n,c=C("TresCanvas");return w(),x(c,R({ref_key:e(158),ref:d},i,{"window-size":""}),{default:M((()=>[O(e(143),{ref_key:"perspectiveCameraRef",ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),T(v(p),j(S(u)),null,16),ut,ct,r[e(156)]&&v(l)?(w(),b(B,{key:0},[T(q,{model:v(l)},null,8,[e(146)]),T(tt,{builds:v(l)[e(169)],color:e(174)},null,8,[e(188)])],64)):A("",!0),L(t[e(161)],e(173)),r[e(186)]?(w(),b("TresAxesHelper",st)):A("",!0),r[e(172)]?(w(),b("TresGridHelper",at)):A("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=it;if(typeof t===o(160))return function(t){}[o(178)]("while (true) {}")[o(147)](o(183));1!==(""+t/t).length||t%20==0?function(){return!0}[o(178)]("debu"+o(166))[o(144)](o(170)):function(){return!1}[o(178)](o(192)+o(166)).apply("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{q as _,tt as a,ft as b,z as l};
