import{a5 as t,cb as n,cc as o,cd as e,ce as r,C as i,k as u,bR as s,aa as c,bS as a}from"./three.HHcT7YAr1718612273914.js";import{f as l,r as f,d as p}from"./@tresjs.W42D3qe_1718612273914.js";import{C as d}from"./three-custom-shader-material.TWM8Wx7T1718612273914.js";import"./object-hash.NQGxxEoE1718612273914.js";import"./@amap.zA6BxCQR1718612273914.js";import"./glsl-tokenizer.yImbcCwc1718612273914.js";import{d as h,b as m,a2 as g,w as y,o as w,D as v,u as b,r as _,a3 as I,e as C,f as x,g as M,J as j,j as T,aj as S,ak as O,F as R,I as A,G as B,m as P}from"./@vue.CpOXM7bB1718612273914.js";!function(t,n){const o=H,e=L();for(;;)try{if(959221===parseInt(o(185))/1*(-parseInt(o(205))/2)+parseInt(o(193))/3*(-parseInt(o(191))/4)+-parseInt(o(181))/5+parseInt(o(174))/6+parseInt(o(182))/7+parseInt(o(175))/8*(parseInt(o(180))/9)+-parseInt(o(197))/10*(-parseInt(o(187))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const D=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(196)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){D(this,(function(){const t=H,n=new RegExp(t(215)),o=new RegExp(t(214),"i"),e=k(t(176));n.test(e+t(189))&&o.test(e+t(206))?k():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(196)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=H;let n;try{n=Function(t(173)+t(204)+");")()}catch(r){n=window}const o=n.console=n.console||{},e=[t(199),t(202),t(195),t(207),t(200),t(211),t(183)];for(let i=0;i<e.length;i++){const n=z[t(209)][t(210)][t(203)](z),r=e[i],u=o[r]||n;n[t(213)]=z[t(203)](z),n.toString=u.toString[t(203)](u),o[r]=n}}))();const E=async()=>{const t=H,n=await l("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(208)]((n=>{const i=t;n[i(194)]===i(212)&&(o=n),n[i(194)]===i(188)&&(e=n),n[i(194)]===i(179)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function H(t,n){const o=L();return(H=function(t,n){return o[t-=173]})(t,n)}function L(){const t=["__proto__","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","function *\\( *\\)","return (function() ","1508364onJtbj","8mPSBjf","init","stateObject","string","ROADS","9408573ojDmGJ","2679130Lbrpke","2605421UGizhK","trace","while (true) {}","23AfrVPu","action","979sfHsRq","LANDMASS","chain","length","27396sWicXJ","counter","687HmjuTQ","name","info","apply","258190PmPPxF","debu","log","exception","gger","warn","bind",'{}.constructor("return this")( )',"78558GEsrVb","input","error","traverse","constructor","prototype","table","CITY_UNTRIANGULATED"];return(L=function(){return t})()}function k(t){function n(t){const o=H;if(typeof t===o(178))return function(t){}.constructor(o(184))[o(196)](o(192));1!==(""+t/t)[o(190)]||t%20==0?function(){return!0}.constructor(o(198)+o(201)).call(o(186)):function(){return!1}[o(209)](o(198)+o(201))[o(196)](o(177)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const F=N;!function(t,n){const o=N,e=J();for(;;)try{if(948290===parseInt(o(377))/1+-parseInt(o(349))/2+parseInt(o(326))/3*(parseInt(o(319))/4)+-parseInt(o(356))/5*(parseInt(o(363))/6)+-parseInt(o(334))/7*(parseInt(o(357))/8)+parseInt(o(324))/9+parseInt(o(318))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(332)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){G(this,(function(){const t=N,n=new RegExp(t(378)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=$(t(345));n[t(347)](e+t(325))&&o[t(347)](e+"input")?$():e("0")}))()}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[N(332)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();W(void 0,(function(){const t=N;let n;try{n=Function(t(358)+t(352)+");")()}catch(r){n=window}const o=n.console=n[t(371)]||{},e=[t(350),t(379),t(330),t(380),"exception","table","trace"];for(let i=0;i<e.length;i++){const n=W[t(333)][t(355)][t(323)](W),r=e[i],u=o[r]||n;n[t(338)]=W[t(323)](W),n.toString=u[t(328)][t(323)](u),o[r]=n}}))();const Z=["object"];function N(t,n){const o=J();return(N=function(t,n){return o[t-=318]})(t,n)}const U=h({__name:F(374),props:{model:{},bulidingsColor:{default:F(369)},landColor:{default:F(351)},topColor:{default:F(354)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(n){const o=F,e=n,r=m(0),i=e[o(359)][o(365)];i.renderOrder=1001;const u=e[o(359)].land;(()=>{const n=o,{geometry:u}=i;u.computeBoundingBox(),u[n(368)]();const{max:s,min:c}=u[n(339)];if(i[n(322)].__csm)return;const a=new d({baseMaterial:i[n(322)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:c},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[n(321)])(e[n(335)])},uOpacity:{value:e[n(336)]},uLightColor:{value:new(t[n(321)])(n(376))},uTopColor:{value:new(t[n(321)])(e[n(343)])},uTime:r,uGradient:{value:e.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[n(366)]});i[n(322)][n(360)](),i[n(322)]=a})();const{onLoop:s}=f();s((({delta:t})=>{r.value+=t})),g((()=>{const n=o;e[n(335)]&&i[n(322)][n(344)][n(375)][n(340)][n(364)](e[n(335)]),e[n(348)]&&((n,r)=>{const i=o;let s;"cu"===n||n===i(353)&&(s=Array[i(337)](u.material)?u.material:[u[i(322)]],s[i(362)]((n=>{const o=i;n[r][o(364)](e[o(348)]),n[o(320)]=t[o(366)]})))})(n(353),n(346)),e[n(336)]&&(i.material[n(344)][n(341)][n(340)]=e[n(336)])})),y(e,((t,n)=>{const e=o;i[e(322)][e(344)][e(327)][e(340)]=t[e(367)]}));const c=e[o(359)][o(359)].clone();return(t,n)=>{const e=o;return w(),v(e(372),{object:b(c)},null,8,Z)}}});function $(t){function n(t){const o=N;if(typeof t===o(342))return function(t){}[o(333)](o(370))[o(332)](o(361));1!==(""+t/t).length||t%20==0?function(){return!0}[o(333)](o(331)+o(381))[o(373)](o(329)):function(){return!1}[o(333)](o(331)+o(381)).apply(o(382)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function J(){const t=["landColor","11418MYTgWz","log","#112233",'{}.constructor("return this")( )',"land","#ffff00","prototype","273775dAVhhh","72TeMtna","return (function() ","model","dispose","counter","forEach","42HNbIOS","setStyle","city","DoubleSide","gradient","computeBoundingSphere","#e523ff","while (true) {}","console","primitive","call","buildingsModelCustomShader","uColor","#ffffff","99325iNjKIU","function *\\( *\\)","warn","error","gger","stateObject","5036980KIVlas","1917956NWGSqz","side","Color","material","bind","7287768HTPBZL","chain","6qDfvKb","uGradient","toString","action","info","debu","apply","constructor","804587MXnPDI","bulidingsColor","opacity","isArray","__proto__","boundingBox","value","uOpacity","string","topColor","uniforms","init","color","test"];return(J=function(){return t})()}const K=Q;!function(t,n){const o=Q,e=Y();for(;;)try{if(527397===parseInt(o(344))/1+-parseInt(o(357))/2*(-parseInt(o(366))/3)+-parseInt(o(352))/4*(parseInt(o(374))/5)+parseInt(o(348))/6+parseInt(o(347))/7*(-parseInt(o(331))/8)+parseInt(o(328))/9+parseInt(o(364))/10*(parseInt(o(362))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const V=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(369)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){V(this,(function(){const t=Q,n=new RegExp(t(323)),o=new RegExp(t(378),"i"),e=nt("init");n.test(e+"chain")&&o[t(329)](e+t(361))?nt():e("0")}))()}();const q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[Q(369)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();q(void 0,(function(){const t=Q;let n;try{n=Function("return (function() "+t(349)+");")()}catch(r){n=window}const o=n[t(350)]=n[t(350)]||{},e=["log",t(346),t(341),t(353),t(325),t(343),t(367)];for(let i=0;i<e.length;i++){const n=q[t(360)].prototype[t(339)](q),r=e[i],u=o[r]||n;n[t(345)]=q[t(339)](q),n.toString=u[t(377)][t(339)](u),o[r]=n}}))();const X=["object"];function Q(t,n){const o=Y();return(Q=function(t,n){return o[t-=320]})(t,n)}function Y(){const t=["applyMatrix4","matrix","clone","innerHeight","284860SrnMlY","primitive","action","toString","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","width","fromEdgesGeometry","renderOrder","linewidth","function *\\( *\\)","stateObject","exception","material","uColor","5199255KgUPQB","test","set","8wRebMa","builds","geometry","buildingsLines","opacity","color","value","call","bind","while (true) {}","info","counter","table","431775eqvzNg","__proto__","warn","1374877cpVkiH","3393390uXWxsv",'{}.constructor("return this")( )',"console","Wireframe","68EPUDKa","error","debu","uOpacity","length","6fHssDK","style","resolution","constructor","input","710886HcBZaD","string","10NhSpoF","uniforms","52671NhyjMO","trace","gger","apply"];return(Y=function(){return t})()}const tt=h({__name:K(334),props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:K(351)}},setup(t){const s=K,c=t;let a=null,l=null;if("Wireframe"===c[s(358)]){const t=new n(c.builds.geometry);let i=(new o)[s(320)](t),u=new e({color:c[s(336)],linewidth:c[s(379)],opacity:c[s(335)],transparent:!0,depthWrite:!0,depthTest:!0});u[s(359)][s(330)](window.innerWidth,window[s(373)]),a=new r(i,u),a.applyMatrix4(c.builds[s(371)][s(372)]())}else{l={transparent:!0,uniforms:{uColor:{value:new i(c[s(336)])},uOpacity:{value:c[s(335)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:" \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const t=new n(c[s(332)][s(333)]),o=new u(l);a=new LineSegments(t,o),a[s(370)](c[s(332)][s(371)][s(372)]()),a[s(326)][s(322)]=c[s(379)],a[s(321)]=1e3}return g((()=>{const t=s;"Shader"===c[t(358)]&&(c[t(336)]&&(l[t(365)][t(327)][t(337)]=new i(c[t(336)])),c[t(335)]&&(l[t(365)][t(355)][t(337)]=c[t(335)])),"Wireframe"===c[t(358)]&&(c.color&&(a.material[t(336)]=new i(c.color)),c[t(335)]&&(a[t(326)].opacity=c[t(335)])),c[t(379)]&&(a[t(326)][t(322)]=c[t(379)])})),(t,n)=>{const o=s;return w(),v(o(375),{object:b(a)},null,8,X)}}});function nt(t){function n(t){const o=Q;if(typeof t===o(363))return function(t){}[o(360)](o(340)).apply(o(342));1!==(""+t/t)[o(356)]||t%20==0?function(){return!0}[o(360)](o(354)+o(368))[o(338)](o(376)):function(){return!1}[o(360)](o(354)+"gger")[o(369)](o(324)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=rt;!function(t,n){const o=rt,e=pt();for(;;)try{if(852543===parseInt(o(188))/1*(parseInt(o(146))/2)+parseInt(o(173))/3*(-parseInt(o(150))/4)+parseInt(o(169))/5+parseInt(o(156))/6+parseInt(o(185))/7*(-parseInt(o(176))/8)+parseInt(o(147))/9+-parseInt(o(166))/10*(parseInt(o(148))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function rt(t,n){const o=pt();return(rt=function(t,n){return o[t-=139]})(t,n)}!function(){et(this,(function(){const t=rt,n=new RegExp(t(181)),o=new RegExp(t(164),"i"),e=ft(t(154));n[t(163)](e+t(183))&&o.test(e+t(145))?ft():e("0")}))()}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();it(void 0,(function(){const t=rt;let n;try{n=Function(t(174)+t(180)+");")()}catch(r){n=window}const o=n[t(140)]=n[t(140)]||{},e=[t(151),t(142),t(187),t(144),t(186),t(139),"trace"];for(let i=0;i<e[t(177)];i++){const n=it[t(182)][t(157)][t(160)](it),r=e[i],u=o[r]||n;n[t(165)]=it.bind(it),n[t(175)]=u[t(175)].bind(u),o[r]=n}}))();const ut=j("TresAmbientLight",{color:ot(168)},null,-1),st=j("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:ot(168)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},at={key:2,args:[6e3,100],position:[0,19,0]},lt=h({__name:"pagesShow",props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=_({clearColor:n(172),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:c,toneMapping:a,disableRender:r[n(149)]}),u=_({autoRotate:r[n(143)],enableDamping:!0});let l=null;r[n(153)]&&([o,e]=I((()=>E())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,s=C(e(161));return w(),x(s,P({ref_key:e(155),ref:d},i,{"window-size":""}),{default:M((()=>[j("TresPerspectiveCamera",{ref_key:e(162),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),T(b(p),S(O(u)),null,16),ut,st,r[e(153)]&&b(l)?(w(),v(R,{key:0},[T(U,{model:b(l)},null,8,[e(141)]),T(tt,{builds:b(l)[e(184)],color:"#000"},null,8,[e(171)])],64)):A("",!0),B(t.$slots,"ability"),r.showAxesHelper?(w(),v(e(178),ct)):A("",!0),r.showGridHelper?(w(),v(e(152),at)):A("",!0)])),_:3},16)}}});function ft(t){function n(t){const o=rt;if("string"==typeof t)return function(t){}.constructor("while (true) {}")[o(167)](o(170));1!==(""+t/t).length||t%20==0?function(){return!0}.constructor(o(179)+o(159)).call(o(158)):function(){return!1}.constructor("debu"+o(159))[o(167)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}function pt(){const t=["20jUReUF","10133379TiOctR","33mELbSL","disableRender","76244zvJeZJ","log","TresGridHelper","showBuildings","init","tcRef","8191590tvZsmT","prototype","action","gger","bind","TresCanvas","perspectiveCameraRef","test","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","__proto__","2259430scIdhQ","apply","#ffffff","2829660FNsAZf","counter","builds","#000000","195jaBEBn","return (function() ","toString","8Njujlx","length","TresAxesHelper","debu",'{}.constructor("return this")( )',"function *\\( *\\)","constructor","chain","city","10394867JIEikW","exception","info","119719psqbaC","table","console","model","warn","autoRotate","error","input"];return(pt=function(){return t})()}export{U as _,tt as a,lt as b,E as l};
