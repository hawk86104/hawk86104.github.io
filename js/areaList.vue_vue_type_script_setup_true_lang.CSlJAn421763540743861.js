import{F as e}from"./@tresjs.BCHtwiaC1763540743861.js";import{_ as o}from"./Line2.vue_vue_type_script_setup_true_lang.CHVMnI-f1763540743861.js";import{i as r,y as t}from"./index.Crdf3MNx1763540743861.js";import{c as s,g as n}from"./utils.D7CR8Ywg1763540743861.js";import{_ as a}from"./iconText.vue_vue_type_script_setup_true_lang.BJmpbuqr1763540743861.js";import{_ as i}from"./selectPanel.vue_vue_type_style_index_0_lang.CFOANz7D1763540743861.js";import"./index.d2-zW_AZ1763540743861.js";import{u as p}from"./commonData.BQ6HGNAS1763540743861.js";import{_ as l}from"./rippleMesh.vue_vue_type_script_setup_true_lang.DiD_IFD51763540743861.js";import{d as c,a9 as u,a as m,q as f,W as d,H as h,o as g,J as y,b as _,I as v,F as x,X as j,h as w,u as P,m as b}from"./@vue.Co_gxueH1763540743861.js";import{f as E,bS as T,bb as M,h as C}from"./three.rXKzP9fQ1763540743861.js";const I=["rotate-x"],k=["groupChildrenIndex"],O=["args"],X=["color"],S=["rotate-x","geometry"],Y=c({__name:"areaList",setup(c){const Y=p(),F={resolution:518,mix:.3,sharpMix:1,blurDepthScale:.2,roughness:1,metalness:.2,normalMap:r.getItem("waterdudv.jpg"),normalScale:new E(.001,.001),reflectorOffset:0},L={digital:"#0099ff",clothes:"#ff33ff",catering:"#E2C166",car:"#00ffff",gift:"#ff6600",empty:"#666666",other:"#eeeeee"},G=(e,o)=>H[o].prop["area-color"]?H[o].prop["area-color"]:e&&L[e]||L.other,D={depth:.4,bevelEnabled:!1},H=[];Y.areasPrimary.forEach(e=>{if(e?.geometry&&"Polygon"===e?.geometry.type){s(e,Y.centerPos),e.properties.centerXY=n(e,Y.centerPos);const o=new T;e.geometry.coordinates.forEach(e=>{for(let r=0;r<e.length;r++){const[t,s]=e[r];0===r&&o.moveTo(t,-s),o.lineTo(t,-s)}});const r=[];o.getPoints().forEach(e=>{r.push([e.x,e.y,D.depth+.02])}),H.push({shape:o,prop:u(e.properties),linePos:r,jid:e.id})}}),console.log(H);const J=Y.buildingsPrimary,N=new T;J[0].geometry.coordinates.forEach(e=>{for(let o=0;o<e.length;o++){const[r,t]=e[o];0===o&&N.moveTo(r,-t),N.lineTo(r,-t)}});const W=new M(N,{depth:.1,bevelEnabled:!1}),q=m(-1),R=m(null),{camera:U}=e(),$=m(new C);function z(e){var o=new E;o.x=e.clientX/window.innerWidth*2-1,o.y=-e.clientY/window.innerHeight*2+1,$.value.setFromCamera(o,U.value);var r=$.value.intersectObjects(R.value.children.filter(e=>e.hasOwnProperty("groupChildrenIndex")));if(r.length>0){const e=r[0].object.groupChildrenIndex;q.value!==e?q.value=e:q.value=-1}}f(()=>{document.addEventListener("click",z,!1)}),d(()=>{document.removeEventListener("click",z,!1)});const A=e=>{const o=[];return H[e].linePos.forEach(e=>{o.push({x:e[0],y:-e[1]})}),o};return(e,r)=>(g(),h("TresGroup",null,[y("TresGroup",{"rotate-x":-Math.PI/2,position:[0,.15,0],ref_key:"tgRef",ref:R},[(g(),h(x,null,j(H,(e,r)=>(g(),h(x,{key:`${r}`},[y("TresMesh",{"render-order":1,groupChildrenIndex:r},[y("TresExtrudeGeometry",{args:[e.shape,D]},null,8,O),y("TresMeshStandardMaterial",{color:G(e.prop.type,r),roughness:0,metalness:1,polygonOffset:"",polygonOffsetFactor:1,polygonOffsetUnits:1,opacity:.78,transparent:""},null,8,X)],8,k),w(o,{points:e.linePos,"line-width":1.6,color:"#ffffff",opacity:.5},null,8,["points"]),w(a,{position:[e.prop.centerXY.x,-e.prop.centerXY.y,D.depth],showName:e.prop.name,icon:e.prop.icon,iconColor:e.prop["icon-color"]},null,8,["position","showName","icon","iconColor"]),q.value===r?(g(),_(i,{key:0,color:G(e.prop.type,r),itemProp:e.prop,jid:e.jid,position:[e.prop.centerXY.x,-e.prop.centerXY.y,D.depth+.68]},null,8,["color","itemProp","jid","position"])):v("",!0)],64))),64))],8,I),-1!==q.value?(g(),_(P(l),{key:0,name:"rippleMesh",renderOrder:999,"position-y":.14,positionSrc:A(q.value),height:.789,color:G(H[q.value].prop.type,q.value),opacity:1,num:5,scale:1.08},null,8,["positionSrc","color"])):v("",!0),y("TresMesh",{"rotate-x":-Math.PI/2,"render-order":2,scale:1.02,position:[0,0,0],geometry:P(W)},[w(t,b({color:"black"},F),null,16)],8,S)]))}});export{Y as _};
