import{a6 as t,C as n,Z as o,cb as e,cc as r,cd as i,ce as u,k as c,bS as s,ab as a,ad as l}from"./three.LOnTLfxo1723628107012.js";import{f,$ as p,d}from"./@tresjs.SUe87xao1723628107012.js";import{C as h}from"./three-custom-shader-material.n4KbnW0V1723628107012.js";import"./object-hash.eRIADBNa1723628107012.js";import"./@amap.XsUkMUkF1723628107012.js";import"./glsl-tokenizer.ZmKauzU31723628107012.js";import{d as m,b as y,a1 as g,w,o as v,D as b,u as _,r as C,a4 as I,e as x,f as M,g as S,J as j,j as T,aj as A,ak as O,F as R,I as B,G as k,m as F}from"./@vue.9bHx4gg21723628107012.js";!function(t,n){const o=L,e=Z();for(;;)try{if(761414===-parseInt(o(233))/1*(-parseInt(o(268))/2)+-parseInt(o(246))/3+-parseInt(o(272))/4+-parseInt(o(243))/5+-parseInt(o(273))/6+-parseInt(o(266))/7*(-parseInt(o(249))/8)+parseInt(o(248))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const G=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(256)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function Z(){const t=["ROADS","counter","function *\\( *\\)","traverse","apply","return (function() ","LANDMASS","constructor","stateObject","toString","init","log","bind","gger","1507079yeCCap","table","2iSmRID","debu","call","trace","3438172SceONV","9076836vyupxH","string","31891GAnvZZ","name","prototype","CITY_UNTRIANGULATED","info","error","input","test","exception","while (true) {}","4184465TjLWMG","length","warn","4257498dRFzgR","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","46283706YAkyND","8qJCFhC","console","action"];return(Z=function(){return t})()}!function(){G(this,(function(){const t=L,n=new RegExp(t(254)),o=new RegExp(t(247),"i"),e=P(t(262));n[t(240)](e+"chain")&&o[t(240)](e+t(239))?P():e("0")}))()}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(256)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();z(void 0,(function(){const t=L,n=function(){const t=L;let n;try{n=Function(t(257)+'{}.constructor("return this")( ));')()}catch(o){n=window}return n}(),o=n[t(250)]=n.console||{},e=[t(263),t(245),t(237),t(238),t(241),t(267),t(271)];for(let r=0;r<e[t(244)];r++){const n=z[t(259)][t(235)].bind(z),i=e[r],u=o[i]||n;n.__proto__=z[t(264)](z),n.toString=u[t(261)][t(264)](u),o[i]=n}}))();const D=async()=>{const t=L,n=await f("./plugins/digitalCity/model/shanghai.FBX");let o=null,e=null,r=null;return n[t(255)]((n=>{const i=t;n[i(234)]===i(236)&&(o=n),n[i(234)]===i(258)&&(e=n),n.name===i(252)&&(r=n)})),{model:n,city:o,land:e,roads:r}};function L(t,n){const o=Z();return(L=function(t,n){return o[t-=232]})(t,n)}function P(t){function n(t){const o=L;if(typeof t===o(232))return function(t){}.constructor(o(242))[o(256)](o(253));1!==(""+t/t).length||t%20==0?function(){return!0}[o(259)](o(269)+o(265))[o(270)](o(251)):function(){return!1}[o(259)]("debugger")[o(256)](o(260)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const E=H;function H(t,n){const o=$();return(H=function(t,n){return o[t-=151]})(t,n)}!function(t,n){const o=H,e=$();for(;;)try{if(473383===parseInt(o(159))/1*(-parseInt(o(173))/2)+-parseInt(o(179))/3+-parseInt(o(200))/4+parseInt(o(214))/5+-parseInt(o(208))/6*(parseInt(o(166))/7)+-parseInt(o(209))/8+parseInt(o(191))/9)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const W=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();function $(){const t=["bind","chain","toString","__proto__","land","function *\\( *\\)","4dYznjG","#112233","counter","while (true) {}","__csm","#ffff00","dispose","3853038ZnSfLV","table","uOpacity","landColor","boundingBox","init","call","346686kcFmcR","string","log","bulidingsColor","opacity","DoubleSide","440247HaTqkj","error","uniforms","prototype","side","gger","isArray","#ffffff","test","return (function() ","#e523ff","stateObject","20030076ljVsIC","console","model","buildingsModelCustomShader","input","renderOrder","object","apply","length","2964880gfqGZs","setStyle",'{}.constructor("return this")( )',"constructor","computeBoundingSphere","info","debu","computeBoundingBox","6iWwkmH","3212056jtKUsu","uColor","gradient","exception","material","3905505ePgrGx","value","Color","city","uGradient"];return($=function(){return t})()}!function(){W(this,(function(){const t=H,n=new RegExp(t(158)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=U(t(171));n[t(187)](e+t(154))&&o[t(187)](e+t(195))?U():e("0")}))()}();const N=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[H(198)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();N(void 0,(function(){const t=H;let n;try{n=Function(t(188)+t(202)+");")()}catch(r){n=window}const o=n[t(192)]=n[t(192)]||{},e=[t(175),"warn",t(205),t(180),t(212),t(167),"trace"];for(let i=0;i<e[t(199)];i++){const n=N.constructor[t(182)][t(153)](N),r=e[i],u=o[r]||n;n[t(156)]=N.bind(N),n[t(155)]=u.toString.bind(u),o[r]=n}}))();const Y=[E(197)],q=m({__name:E(194),props:{model:{},bulidingsColor:{default:E(189)},landColor:{default:E(160)},topColor:{default:E(164)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(e){const r=E,i=e,u=y(0),c=i[r(193)][r(151)];c[r(196)]=1001;const s=i[r(193)].land;(()=>{const e=r,{geometry:s}=c;s[e(207)](),s[e(204)]();const{max:a,min:l}=s[e(170)];if(c[e(213)][e(163)])return;const f=new h({baseMaterial:c[e(213)],vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:a},uMin:{value:l},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[e(216)])(i[e(176)])},uOpacity:{value:i[e(177)]},uLightColor:{value:new n(e(186))},uTopColor:{value:new(t[e(216)])(i.topColor)},uTime:u,uGradient:{value:i[e(211)]}},depthWrite:!0,depthTest:!0,transparent:!0,side:o});c.material[e(165)](),c[e(213)]=f})();const{onLoop:a}=p();a((({delta:t})=>{u.value+=t})),g((()=>{const n=r;i.bulidingsColor&&c[n(213)][n(181)][n(210)][n(215)][n(201)](i[n(176)]),i[n(169)]&&((n,o)=>{const e=r;let u;"cu"===n||n===e(157)&&(u=Array[e(185)](s.material)?s[e(213)]:[s[e(213)]],u.forEach((n=>{const r=e;n[o][r(201)](i[r(169)]),n[r(183)]=t[r(178)]})))})(n(157),"color"),i.opacity&&(c[n(213)][n(181)][n(168)].value=i.opacity)})),w(i,((t,n)=>{const o=r;c.material[o(181)][o(152)][o(215)]=t.gradient}));const l=i[r(193)][r(193)].clone();return(t,n)=>(v(),b("primitive",{object:_(l)},null,8,Y))}});function U(t){function n(t){const o=H;if(typeof t===o(174))return function(t){}[o(203)](o(162))[o(198)](o(161));1!==(""+t/t)[o(199)]||t%20==0?function(){return!0}[o(203)]("debu"+o(184))[o(172)]("action"):function(){return!1}[o(203)](o(206)+o(184))[o(198)](o(190)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const V=tt;function K(){const t=["uColor","input","info","buildingsLines","length","counter","style","constructor","27uPRNli","955980hecGGK","exception","Wireframe","renderOrder","clone","test","226325BAYsYO","linewidth","2347713dmfuxP","stateObject","11295697PMZvcw","debu","innerHeight","uniforms","998mrfEYh","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","gger","toString","warn","value","innerWidth","applyMatrix4","material","opacity","apply","action","primitive","4517108CxzbEO","fromEdgesGeometry","6OMmivF","object","while (true) {}","console","uOpacity","2359944gRFmal","width","geometry","chain","__proto__","580DglQxC","prototype","#FFF"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","matrix","color","function *\\( *\\)","table","builds","1730yZFkWh"];return(K=function(){return t})()}!function(t,n){const o=tt,e=K();for(;;)try{if(936514===-parseInt(o(127))/1*(-parseInt(o(151))/2)+-parseInt(o(145))/3+parseInt(o(164))/4+parseInt(o(137))/5+-parseInt(o(166))/6*(-parseInt(o(147))/7)+-parseInt(o(171))/8*(parseInt(o(136))/9)+parseInt(o(118))/10*(-parseInt(o(143))/11))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const J=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){J(this,(function(){const t=tt,n=new RegExp(t(124)),o=new RegExp(t(152),"i"),e=ot("init");n[t(142)](e+t(174))&&o[t(142)](e+t(129))?ot():e("0")}))()}();const Q=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[tt(161)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();Q(void 0,(function(){const t=tt,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n[t(169)]=n.console||{},e=["log",t(155),t(130),"error",t(138),t(125),"trace"];for(let r=0;r<e[t(132)];r++){const n=Q[t(135)][t(119)].bind(Q),i=e[r],u=o[i]||n;n[t(175)]=Q.bind(Q),n.toString=u[t(154)].bind(u),o[i]=n}}))();const X=[V(167)];function tt(t,n){const o=K();return(tt=function(t,n){return o[t-=118]})(t,n)}const nt=m({__name:V(131),props:{builds:{},width:{default:1},color:{default:V(120)},opacity:{default:1},style:{default:V(139)}},setup(t){const o=V,s=t;let a=null,l=null;if(s[o(134)]===o(139)){const t=new e(s[o(126)][o(173)]);let n=(new r)[o(165)](t),c=new i({color:s[o(123)],linewidth:s[o(172)],opacity:s[o(160)],transparent:!0,depthWrite:!0,depthTest:!0});c.resolution.set(window[o(157)],window[o(149)]),a=new u(n,c),a[o(158)](s[o(126)][o(122)].clone())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s[o(123)])},uOpacity:{value:s[o(160)]}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:o(121)};const t=new e(s[o(126)].geometry),r=new c(l);a=new LineSegments(t,r),a[o(158)](s.builds.matrix[o(141)]()),a[o(159)].linewidth=s.width,a[o(140)]=1e3}return g((()=>{const t=o;"Shader"===s[t(134)]&&(s[t(123)]&&(l[t(150)][t(128)][t(156)]=new n(s[t(123)])),s[t(160)]&&(l[t(150)][t(170)][t(156)]=s[t(160)])),s[t(134)]===t(139)&&(s.color&&(a.material[t(123)]=new n(s.color)),s.opacity&&(a[t(159)][t(160)]=s[t(160)])),s.width&&(a[t(159)][t(144)]=s[t(172)])})),(t,n)=>{const e=o;return v(),b(e(163),{object:_(a)},null,8,X)}}});function ot(t){function n(t){const o=tt;if("string"==typeof t)return function(t){}.constructor(o(168))[o(161)](o(133));1!==(""+t/t).length||t%20==0?function(){return!0}[o(135)](o(148)+o(153)).call(o(162)):function(){return!1}[o(135)](o(148)+"gger")[o(161)](o(146)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const et=rt;function rt(t,n){const o=ft();return(rt=function(t,n){return o[t-=190]})(t,n)}!function(t,n){const o=rt,e=ft();for(;;)try{if(404629===-parseInt(o(218))/1*(-parseInt(o(205))/2)+-parseInt(o(196))/3*(parseInt(o(219))/4)+-parseInt(o(200))/5*(parseInt(o(244))/6)+parseInt(o(239))/7*(-parseInt(o(193))/8)+-parseInt(o(221))/9*(-parseInt(o(242))/10)+parseInt(o(233))/11*(-parseInt(o(191))/12)+-parseInt(o(198))/13*(-parseInt(o(238))/14))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const it=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){it(this,(function(){const t=rt,n=new RegExp(t(211)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=dt(t(199));n.test(e+"chain")&&o[t(192)](e+t(203))?dt():e("0")}))()}();const ut=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();ut(void 0,(function(){const t=rt;let n;try{n=Function("return (function() "+t(230)+");")()}catch(r){n=window}const o=n.console=n[t(206)]||{},e=[t(224),"warn",t(213),t(197),t(247),t(241),t(214)];for(let i=0;i<e[t(216)];i++){const n=ut[t(226)][t(246)][t(237)](ut),r=e[i],u=o[r]||n;n[t(215)]=ut.bind(ut),n[t(223)]=u[t(223)].bind(u),o[r]=n}}))();const ct=j("TresAmbientLight",{color:et(208)},null,-1),st=j(et(228),{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),at={key:1,args:[1e3],position:[0,19,0]},lt={key:2,args:[6e3,100],position:[0,19,0]};function ft(){const t=["test","40728eqilKS","TresPerspectiveCamera","autoRotate","1089SqruEP","error","13jUjZXA","init","135KyWctL","pagesShow","showAxesHelper","input","TresCanvas","700034UBGtAM","console","showBuildings","#ffffff","counter","call","function *\\( *\\)","perspectiveCameraRef","info","trace","__proto__","length","string","1eIuzzr","4612NwklYB","action","9eUsAdB","builds","toString","log","TresGridHelper","constructor","ability","TresDirectionalLight","TresAxesHelper",'{}.constructor("return this")( )',"model","disableRender","2050862KIVsYP","while (true) {}","tcRef","apply","bind","24398682mFkcqr","329UZRshD","debu","table","60myMQFi","gger","104670VxqStd","showGridHelper","prototype","exception","stateObject","36LaONVD"];return(ft=function(){return t})()}const pt=m({__name:et(201),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=et;let o,e;const r=t,i=C({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:s,outputColorSpace:a,toneMapping:l,disableRender:r[n(232)]}),u=C({autoRotate:r[n(195)],enableDamping:!0});let c=null;r[n(207)]&&([o,e]=I((()=>D())),o=await o,e(),c=o);const f=y(),p=y();return(t,o)=>{const e=n,s=x(e(204));return v(),M(s,F({ref_key:e(235),ref:p},i,{"window-size":""}),{default:S((()=>[j(e(194),{ref_key:e(212),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),T(_(d),A(O(u)),null,16),ct,st,r[e(207)]&&_(c)?(v(),b(R,{key:0},[T(q,{model:_(c)},null,8,[e(231)]),T(nt,{builds:_(c).city,color:"#000"},null,8,[e(222)])],64)):B("",!0),k(t.$slots,e(227)),r[e(202)]?(v(),b(e(229),at)):B("",!0),r[e(245)]?(v(),b(e(225),lt)):B("",!0)])),_:3},16)}}});function dt(t){function n(t){const o=rt;if(typeof t===o(217))return function(t){}.constructor(o(234))[o(236)](o(209));1!==(""+t/t)[o(216)]||t%20==0?function(){return!0}.constructor(o(240)+o(243))[o(210)](o(220)):function(){return!1}[o(226)](o(240)+o(243))[o(236)](o(190)),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{q as _,nt as a,pt as b,D as l};
