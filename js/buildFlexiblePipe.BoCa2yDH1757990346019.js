import{ao as n,ap as e,b as o,bL as t,V as l}from"./three.DHXbQd-f1757990346019.js";class c extends t{constructor(n,e,o,t,l,c){super(),this.center=n.clone(),this.xAxis=e.clone().normalize(),this.yAxis=o.clone().normalize(),this.radius=t,this.startAngle=l,this.deltaAngle=c}getPoint(n,e){const o=this.startAngle+this.deltaAngle*n,t=Math.cos(o),c=Math.sin(o);return(e||new l).copy(this.xAxis).multiplyScalar(t*this.radius).addScaledVector(this.yAxis,c*this.radius).add(this.center)}}function a(t,l,a=16){const s=1e-6,i=new n;if(t.length<2)return i;let d=t[0].clone();const r=(n,e)=>n.distanceToSquared(e)<1e-8;for(let n=1;n<t.length-1;n++){const a=t[n-1].clone(),h=t[n].clone(),u=t[n+1].clone(),m=a.clone().sub(h),M=u.clone().sub(h),g=m.length(),f=M.length();if(g<s||f<s){r(d,h)||i.add(new e(d.clone(),h.clone())),d=h.clone();continue}const p=m.clone().normalize(),w=M.clone().normalize(),x=o.clamp(p.dot(w),-1,1),z=Math.acos(x);if(z<1e-4){r(d,h)||i.add(new e(d.clone(),h.clone())),d=h.clone();continue}const A=l/Math.tan(z/2),b=Math.min(g,f)-1e-6,y=Math.min(A,Math.max(0,b));if(y<=1e-6){r(d,h)||i.add(new e(d.clone(),h.clone())),d=h.clone();continue}const S=y*Math.tan(z/2),P=p.clone().add(w);if(P.length()<1e-6){r(d,h)||i.add(new e(d.clone(),h.clone())),d=h.clone();continue}const I=P.clone().normalize(),q=S/Math.sin(z/2),T=h.clone().add(I.multiplyScalar(q)),V=h.clone().add(p.clone().multiplyScalar(y)),j=h.clone().add(w.clone().multiplyScalar(y)),L=V.clone().sub(T);let k=L.clone().normalize();const v=m.clone().cross(M);if(v.length()<1e-7){r(d,h)||i.add(new e(d.clone(),h.clone())),d=h.clone();continue}const B=v.clone().normalize().cross(k).normalize(),C=Math.atan2(L.dot(B),L.dot(k)),D=j.clone().sub(T);let E=Math.atan2(D.dot(B),D.dot(k))-C;for(;E<=-Math.PI;)E+=2*Math.PI;for(;E>Math.PI;)E-=2*Math.PI;r(d,V)||i.add(new e(d.clone(),V.clone()));const F=new c(T,k,B,S,C,E);i.add(F),d=j.clone()}const h=t[t.length-1].clone();return!d.equals(h)&&d.distanceToSquared(h)>1e-8&&i.add(new e(d.clone(),h.clone())),i}export{a as b};
