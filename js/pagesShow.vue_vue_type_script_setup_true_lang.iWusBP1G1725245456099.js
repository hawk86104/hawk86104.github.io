import{a6 as t,C as n,cb as o,cc as e,cd as r,ce as i,k as u,bS as c,ab as s,ad as a}from"./three.KG2-8r0_1725245456099.js";import{f as l,$ as f,d as p}from"./@tresjs.j5vdYITq1725245456099.js";import{C as d}from"./three-custom-shader-material.1acQuOMU1725245456099.js";import"./object-hash.ycpyO56T1725245456099.js";import"./@amap.jyJWu-u51725245456099.js";import"./glsl-tokenizer.FsI169p21725245456099.js";import{d as h,b as m,a1 as y,w as g,o as w,D as v,u as _,r as b,a4 as C,e as I,f as x,g as M,J as S,j,aj as T,ak as O,F as k,I as A,G as B,m as R}from"./@vue.Q1VpS3901725245456099.js";function D(){const t=["debu","3crkByU","constructor","name","apply","__proto__","2610460LDujjV","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","385QZnoer","bind","LANDMASS","while (true) {}","table","2273356VCJskJ","function *\\( *\\)","25358IoZZak","trace","stateObject","4143897SUWopy","warn","info","length","init","exception","ROADS","10543260DAEHuh","input","call","prototype","error","2829516cPolBj","test","counter","gger","action","83tkXktx","toString","console","37640cwSnEh"];return(D=function(){return t})()}function L(t,n){const o=D();return(L=function(t,n){return o[t-=195]})(t,n)}!function(t,n){const o=L,e=D();for(;;)try{if(625028===-parseInt(o(224))/1*(-parseInt(o(204))/2)+parseInt(o(229))/3*(-parseInt(o(202))/4)+parseInt(o(195))/5+parseInt(o(219))/6+-parseInt(o(197))/7*(parseInt(o(227))/8)+parseInt(o(207))/9+-parseInt(o(214))/10)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const z=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(232)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){z(this,(function(){const t=L,n=new RegExp(t(203)),o=new RegExp(t(196),"i"),e=Z(t(211));n[t(220)](e+"chain")&&o[t(220)](e+t(215))?Z():e("0")}))()}();const E=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[L(232)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();E(void 0,(function(){const t=L,n=function(){let t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(n){t=window}return t}(),o=n.console=n[t(226)]||{},e=["log",t(208),t(209),t(218),t(212),t(201),t(205)];for(let r=0;r<e[t(210)];r++){const n=E[t(230)][t(217)][t(198)](E),i=e[r],u=o[i]||n;n[t(233)]=E[t(198)](E),n[t(225)]=u[t(225)][t(198)](u),o[i]=n}}))();const G=async()=>{const t=await l("./plugins/digitalCity/model/shanghai.FBX");let n=null,o=null,e=null;return t.traverse((t=>{const r=L;"CITY_UNTRIANGULATED"===t[r(231)]&&(n=t),t[r(231)]===r(199)&&(o=t),t.name===r(213)&&(e=t)})),{model:t,city:n,land:o,roads:e}};function Z(t){function n(t){const o=L;if("string"==typeof t)return function(t){}[o(230)](o(200))[o(232)](o(221));1!==(""+t/t)[o(210)]||t%20==0?function(){return!0}[o(230)]("debugger")[o(216)](o(223)):function(){return!1}.constructor(o(228)+o(222)).apply(o(206)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const F=W;!function(t,n){const o=W,e=$();for(;;)try{if(488791===parseInt(o(246))/1+parseInt(o(212))/2*(-parseInt(o(222))/3)+-parseInt(o(217))/4+-parseInt(o(242))/5*(-parseInt(o(238))/6)+parseInt(o(243))/7*(parseInt(o(256))/8)+parseInt(o(241))/9*(-parseInt(o(236))/10)+-parseInt(o(223))/11)break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const H=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(231)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){H(this,(function(){const t=W,n=new RegExp(t(211)),o=new RegExp(t(230),"i"),e=J(t(221));n[t(228)](e+"chain")&&o[t(228)](e+"input")?J():e("0")}))()}();const P=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[W(231)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();P(void 0,(function(){const t=W;let n;try{n=Function(t(210)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n.console=n.console||{},e=[t(233),t(249),"info",t(245),"exception",t(254),t(240)];for(let i=0;i<e.length;i++){const n=P[t(253)].prototype.bind(P),r=e[i],u=o[r]||n;n.__proto__=P[t(225)](P),n.toString=u.toString[t(225)](u),o[r]=n}}))();const U=[F(235)];function W(t,n){const o=$();return(W=function(t,n){return o[t-=203]})(t,n)}function $(){const t=["gger","land","test","action","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","apply","clone","log","stateObject","object","5965530HHoTLL","uGradient","42KNIkda","counter","trace","9ppPtto","115790MGhIzS","4513733Opkqsf","Color","error","914789hoejOJ","computeBoundingSphere","call","warn","side","#ffffff","color","constructor","table","uniforms","8WiVUIi","opacity","debu","city","uOpacity","#ffff00","DoubleSide","buildingsModelCustomShader","bulidingsColor","dispose","material","length","return (function() ","function *\\( *\\)","2ujKTKo","while (true) {}","primitive","setStyle","boundingBox","324204rrcYot","landColor","value","model","init","1316373eSgjwj","1281808VyYwzi","__csm","bind"];return($=function(){return t})()}const N=h({__name:F(205),props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:"#112233"},topColor:{default:F(203)},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(o){const e=F,r=o,i=m(0),u=r[e(220)][e(259)];u.renderOrder=1001;const c=r[e(220)][e(227)];(()=>{const o=e,{geometry:c}=u;c.computeBoundingBox(),c[o(247)]();const{max:s,min:a}=c[o(216)];if(u[o(208)][o(224)])return;const l=new d({baseMaterial:u.material,vertexShader:"varying vec4 vPosition;\nvoid main(){\n\tvPosition=modelMatrix*vec4(position,1.);\n\tcsm_Position=position*vec3(1.);\n}",fragmentShader:"uniform mat4 modelMatrix;\nvarying vec4 vPosition;\nuniform vec3 uMax;\nuniform vec3 uMin;\nuniform float uOpacity;\nuniform float uBorderWidth;\nuniform vec3 uLightColor;\nuniform vec3 uColor;\nuniform float uCircleTime;\nuniform float uTime;\nuniform vec3 uTopColor;\nuniform bool uGradient;\nvec4 uMax_world;\nvec4 uMin_world;\nvoid main(){\n\t\n\tuMax_world=modelMatrix*vec4(uMax,1.);\n\tuMin_world=modelMatrix*vec4(uMin,1.);\n\tvec3 distColor=uColor;\n\tfloat residue=uTime-floor(uTime/uCircleTime)*uCircleTime;\n\tfloat rate=residue/uCircleTime;\n\tfloat lightOffset=rate*(uMax_world.y-uMin_world.y);\n\t\n\tif(uMin_world.y+lightOffset<vPosition.y&&uMin_world.y+lightOffset+uBorderWidth>vPosition.y){\n\t\tcsm_DiffuseColor=vec4(uLightColor,uOpacity);\n\t}else{\n\t\tcsm_DiffuseColor=vec4(distColor,uOpacity);\n\t}\n\t\n\t\n\tif(uGradient){\n\t\tfloat rateHight=(vPosition.y-uMin_world.y)/(uMax_world.y-uMin_world.y);\n\t\tvec3 outColor=mix(csm_DiffuseColor.xyz,uTopColor,rateHight*2.);\n\t\tcsm_DiffuseColor=vec4(outColor,uOpacity);\n\t}\n}",silent:!0,uniforms:{uMax:{value:s},uMin:{value:a},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new(t[o(244)])(r[o(206)])},uOpacity:{value:r[o(257)]},uLightColor:{value:new n(o(251))},uTopColor:{value:new n(r.topColor)},uTime:i,uGradient:{value:r.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:t[o(204)]});u.material[o(207)](),u[o(208)]=l})();const{onLoop:s}=f();s((({delta:t})=>{i[e(219)]+=t})),y((()=>{const n=e;r[n(206)]&&u[n(208)][n(255)].uColor[n(219)][n(215)](r[n(206)]),r.landColor&&((n,o)=>{const i=e;let u;"cu"===n||"land"===n&&(u=Array.isArray(c.material)?c[i(208)]:[c[i(208)]],u.forEach((n=>{const e=i;n[o].setStyle(r[e(218)]),n[e(250)]=t[e(204)]})))})(n(227),n(252)),r[n(257)]&&(u.material.uniforms[n(260)].value=r.opacity)})),g(r,((t,n)=>{const o=e;u[o(208)][o(255)][o(237)].value=t.gradient}));const a=r[e(220)][e(220)][e(232)]();return(t,n)=>{const o=e;return w(),v(o(214),{object:_(a)},null,8,U)}}});function J(t){function n(t){const o=W;if("string"==typeof t)return function(t){}[o(253)](o(213))[o(231)](o(239));1!==(""+t/t)[o(209)]||t%20==0?function(){return!0}.constructor(o(258)+o(226))[o(248)](o(229)):function(){return!1}.constructor(o(258)+o(226))[o(231)](o(234)),n(++t)}try{if(t)return n;n(0)}catch(o){}}function V(){const t=["uColor","call","__proto__","gger","innerHeight","13droyyj","657776BOZuyO",'{}.constructor("return this")( )',"Shader","renderOrder","6oaFgOg","linewidth","150874MQfdNF"," \n        uniform vec3 uColor;\n\t\t\t\tuniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      ","material","table","function *\\( *\\)","while (true) {}","log","builds","matrix","stateObject","width","object","opacity","clone","fromEdgesGeometry","applyMatrix4","27580GicMbM","return (function() ","4297790NlrvKN","innerWidth","warn","console","\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ","5958akeQNA","trace","input","bind","constructor","uniforms","test","toString","7451157YCGIhU","primitive","value","string","set","\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","color","length","2177622wucYSJ","geometry","style","Wireframe","apply","chain","info","5851256DyTeAU","uOpacity"];return(V=function(){return t})()}const Y=tt;!function(t,n){const o=tt,e=V();for(;;)try{if(600640===-parseInt(o(293))/1*(parseInt(o(300))/2)+parseInt(o(298))/3*(parseInt(o(294))/4)+parseInt(o(258))/5+parseInt(o(279))/6+-parseInt(o(271))/7+-parseInt(o(286))/8+-parseInt(o(263))/9*(-parseInt(o(256))/10))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const K=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[tt(283)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){K(this,(function(){const t=tt,n=new RegExp(t(244)),o=new RegExp(t(276),"i"),e=nt("init");n.test(e+t(284))&&o[t(269)](e+t(265))?nt():e("0")}))()}();const X=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[tt(283)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();X(void 0,(function(){const t=tt;let n;try{n=Function(t(257)+t(295)+");")()}catch(r){n=window}const o=n[t(261)]=n[t(261)]||{},e=[t(246),t(260),t(285),"error","exception",t(303),t(264)];for(let i=0;i<e[t(278)];i++){const n=X.constructor.prototype[t(266)](X),r=e[i],u=o[r]||n;n[t(290)]=X[t(266)](X),n.toString=u[t(270)][t(266)](u),o[r]=n}}))();const q=[Y(251)],Q=h({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:Y(282)}},setup(t){const c=Y,s=t;let a=null,l=null;if(s.style===c(282)){const t=new o(s[c(247)][c(280)]);let n=(new e)[c(254)](t),u=new r({color:s[c(277)],linewidth:s.width,opacity:s.opacity,transparent:!0,depthWrite:!0,depthTest:!0});u.resolution[c(275)](window[c(259)],window[c(292)]),a=new i(n,u),a[c(255)](s[c(247)][c(248)][c(253)]())}else{l={transparent:!0,uniforms:{uColor:{value:new n(s.color)},uOpacity:{value:s[c(252)]}},vertexShader:c(262),fragmentShader:c(301)};const t=new o(s[c(247)][c(280)]),e=new u(l);a=new LineSegments(t,e),a[c(255)](s[c(247)][c(248)][c(253)]()),a[c(302)].linewidth=s[c(250)],a[c(297)]=1e3}return y((()=>{const t=c;s.style===t(296)&&(s[t(277)]&&(l.uniforms[t(288)][t(273)]=new n(s[t(277)])),s[t(252)]&&(l[t(268)][t(287)].value=s.opacity)),"Wireframe"===s[t(281)]&&(s[t(277)]&&(a[t(302)][t(277)]=new n(s[t(277)])),s[t(252)]&&(a.material[t(252)]=s[t(252)])),s[t(250)]&&(a[t(302)][t(299)]=s[t(250)])})),(t,n)=>{const o=c;return w(),v(o(272),{object:_(a)},null,8,q)}}});function tt(t,n){const o=V();return(tt=function(t,n){return o[t-=244]})(t,n)}function nt(t){function n(t){const o=tt;if(typeof t===o(274))return function(t){}[o(267)](o(245))[o(283)]("counter");1!==(""+t/t).length||t%20==0?function(){return!0}[o(267)]("debu"+o(291))[o(289)]("action"):function(){return!1}[o(267)]("debu"+o(291))[o(283)](o(249)),n(++t)}try{if(t)return n;n(0)}catch(o){}}const ot=lt;!function(t,n){const o=lt,e=at();for(;;)try{if(152765===-parseInt(o(318))/1+parseInt(o(298))/2+parseInt(o(311))/3+parseInt(o(321))/4+parseInt(o(304))/5*(parseInt(o(325))/6)+-parseInt(o(303))/7+parseInt(o(328))/8*(parseInt(o(299))/9))break;e.push(e.shift())}catch(r){e.push(e.shift())}}();const et=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o.apply(n,arguments);return o=null,t}}:function(){};return t=!1,e}}();!function(){et(this,(function(){const t=lt,n=new RegExp(t(320)),o=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),e=pt(t(306));n[t(300)](e+t(312))&&o[t(300)](e+t(309))?pt():e("0")}))()}();const rt=function(){let t=!0;return function(n,o){const e=t?function(){if(o){const t=o[lt(322)](n,arguments);return o=null,t}}:function(){};return t=!1,e}}();rt(void 0,(function(){const t=lt;let n;try{n=Function(t(301)+'{}.constructor("return this")( ));')()}catch(r){n=window}const o=n[t(296)]=n.console||{},e=[t(323),t(295),t(324),t(317),"exception","table",t(333)];for(let i=0;i<e[t(293)];i++){const n=rt.constructor.prototype[t(326)](rt),r=e[i],u=o[r]||n;n[t(302)]=rt[t(326)](rt),n[t(297)]=u[t(297)][t(326)](u),o[r]=n}}))();const it=S(ot(310),{color:"#ffffff"},null,-1),ut=S(ot(292),{position:[100,100,0],intensity:.5,color:ot(285)},null,-1),ct={key:1,args:[1e3],position:[0,19,0]},st={key:2,args:[6e3,100],position:[0,19,0]};function at(){const t=["tcRef","gger","input","TresAmbientLight","109725haBSmS","chain","showBuildings","TresPerspectiveCamera","action","model","error","300714UagBlk","constructor","function *\\( *\\)","516252fMUtrv","apply","log","info","67644GdEOgw","bind","TresAxesHelper","480ZnkZUq","counter","showGridHelper","debu","$slots","trace","#000","#000000","#ffffff","builds","while (true) {}","pagesShow","TresCanvas","call","string","TresDirectionalLight","length","ability","warn","console","toString","5372gkRPrJ","38646SRfDUj","test","return (function() ","__proto__","1780345elzBqD","125rXXsAt","perspectiveCameraRef","init"];return(at=function(){return t})()}function lt(t,n){const o=at();return(lt=function(t,n){return o[t-=283]})(t,n)}const ft=h({__name:ot(288),props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0},showAxesHelper:{type:Boolean,default:!0},showGridHelper:{type:Boolean,default:!0},disableRender:{type:Boolean,default:!1}},async setup(t){const n=ot;let o,e;const r=t,i=b({clearColor:n(284),shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:c,outputColorSpace:s,toneMapping:a,disableRender:r.disableRender}),u=b({autoRotate:r.autoRotate,enableDamping:!0});let l=null;r[n(313)]&&([o,e]=C((()=>G())),o=await o,e(),l=o);const f=m(),d=m();return(t,o)=>{const e=n,c=I(e(289));return w(),x(c,R({ref_key:e(307),ref:d},i,{"window-size":""}),{default:M((()=>[S(e(314),{ref_key:e(305),ref:f,position:[600,750,-1221],fov:45,near:1,far:1e5},null,512),j(_(p),T(O(u)),null,16),it,ut,r.showBuildings&&_(l)?(w(),v(k,{key:0},[j(N,{model:_(l)},null,8,[e(316)]),j(Q,{builds:_(l).city,color:e(283)},null,8,[e(286)])],64)):A("",!0),B(t[e(332)],e(294)),r.showAxesHelper?(w(),v(e(327),ct)):A("",!0),r[e(330)]?(w(),v("TresGridHelper",st)):A("",!0)])),_:3},16)}}});function pt(t){function n(t){const o=lt;if(typeof t===o(291))return function(t){}[o(319)](o(287)).apply(o(329));1!==(""+t/t)[o(293)]||t%20==0?function(){return!0}[o(319)](o(331)+o(308))[o(290)](o(315)):function(){return!1}[o(319)](o(331)+"gger")[o(322)]("stateObject"),n(++t)}try{if(t)return n;n(0)}catch(o){}}export{N as _,Q as a,ft as b,G as l};
