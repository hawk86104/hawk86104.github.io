import{i as t}from"./3d-tiles-renderer.CbgZh8zU1767066396612.js";import{a as e,o as n}from"./evtd.C4K_ichY1767066396612.js";import{b as o,d as r,D as l,j as i,a as s}from"./seemly.D2hUckm91767066396612.js";import{u as a}from"./@css-render.BiajLyKA1767066396612.js";import{d as u,u as d,o as f,i as c}from"./vooks.ChBcAxqT1767066396612.js";import{z as h}from"./vdirs.C5CTZdWU1767066396612.js";import{R as p}from"./@juggle.Vc7cP4_P1767066396612.js";import{C as m}from"./css-render.CWAKDC2V1767066396612.js";const{Fragment:v,createTextVNode:g,Comment:b}=await t("vue");function w(t,e,n="default"){const o=e[n];if(void 0===o)throw new Error(`[vueuc/${t}]: slot[${n}] is empty.`);return o()}function y(t,e=!0,n=[]){return t.forEach(t=>{if(null!==t)if("object"==typeof t)if(Array.isArray(t))y(t,e,n);else if(t.type===v){if(null===t.children)return;Array.isArray(t.children)&&y(t.children,e,n)}else t.type!==b&&n.push(t);else"string"!=typeof t&&"number"!=typeof t||n.push(g(String(t)))}),n}function x(t,e,n="default"){const o=e[n];if(void 0===o)throw new Error(`[vueuc/${t}]: slot[${n}] is empty.`);const r=y(o());if(1===r.length)return r[0];throw new Error(`[vueuc/${t}]: slot[${n}] should have exactly one child.`)}let R=null;function S(){if(null===R&&(R=document.getElementById("v-binder-view-measurer"),null===R)){R=document.createElement("div"),R.id="v-binder-view-measurer";const{style:t}=R;t.position="fixed",t.left="0",t.right="0",t.top="0",t.bottom="0",t.pointerEvents="none",t.visibility="hidden",document.body.appendChild(R)}return R.getBoundingClientRect()}function $(t){const e=t.getBoundingClientRect(),n=S();return{left:e.left-n.left,top:e.top-n.top,bottom:n.height+n.top-e.bottom,right:n.width+n.left-e.right,width:e.width,height:e.height}}function T(t){if(null===t)return null;const e=function(t){return 9===t.nodeType?null:t.parentNode}(t);if(null===e)return null;if(9===e.nodeType)return document;if(1===e.nodeType){const{overflow:t,overflowX:n,overflowY:o}=getComputedStyle(e);if(/(auto|scroll|overlay)/.test(t+o+n))return e}return T(e)}const{defineComponent:M,provide:C,ref:z,inject:I,getCurrentInstance:E,onBeforeUnmount:B}=await t("vue"),F=M({name:"Binder",props:{syncTargetWithParent:Boolean,syncTarget:{type:Boolean,default:!0}},setup(t){var r;C("VBinder",null===(r=E())||void 0===r?void 0:r.proxy);const l=I("VBinder",null),i=z(null);let s=[];const a=()=>{for(const t of s)e("scroll",t,d,!0);s=[]},u=new Set,d=()=>{o(f)},f=()=>{u.forEach(t=>t())},c=new Set,h=()=>{c.forEach(t=>t())};return B(()=>{e("resize",window,h),a()}),{targetRef:i,setTargetRef:e=>{i.value=e,l&&t.syncTargetWithParent&&l.setTargetRef(e)},addScrollListener:t=>{0===u.size&&(()=>{let t=i.value;for(;t=T(t),null!==t;)s.push(t);for(const e of s)n("scroll",e,d,!0)})(),u.has(t)||u.add(t)},removeScrollListener:t=>{u.has(t)&&u.delete(t),0===u.size&&a()},addResizeListener:t=>{0===c.size&&n("resize",window,h),c.has(t)||c.add(t)},removeResizeListener:t=>{c.has(t)&&c.delete(t),0===c.size&&e("resize",window,h)}}},render(){return w("binder",this.$slots)}}),{defineComponent:W,inject:L,withDirectives:A}=await t("vue"),k=W({name:"Target",setup(){const{setTargetRef:t,syncTarget:e}=L("VBinder");return{syncTarget:e,setTargetDirective:{mounted:t,updated:t}}},render(){const{syncTarget:t,setTargetDirective:e}=this;return t?A(x("follower",this.$slots),[[e]]):x("follower",this.$slots)}});function N(t,e){console.error(`[vueuc/${t}]: ${e}`)}const{c:j}=m(),X="vueuc-style";function Y(t){return t&-t}class H{constructor(t,e){this.l=t,this.min=e;const n=new Array(t+1);for(let o=0;o<t+1;++o)n[o]=0;this.ft=n}add(t,e){if(0===e)return;const{l:n,ft:o}=this;for(t+=1;t<=n;)o[t]+=e,t+=Y(t)}get(t){return this.sum(t+1)-this.sum(t)}sum(t){if(void 0===t&&(t=this.l),t<=0)return 0;const{ft:e,min:n,l:o}=this;if(t>o)throw new Error("[FinweckTree.sum]: `i` is larger than length.");let r=t*n;for(;t>0;)r+=e[t],t-=Y(t);return r}getBound(t){let e=0,n=this.l;for(;n>e;){const o=Math.floor((e+n)/2),r=this.sum(o);if(r>t)n=o;else{if(!(r<t))return o;if(e===o)return this.sum(e+1)<=t?e+1:o;e=o}}return e}}function O(t){return"string"==typeof t?document.querySelector(t):t()||null}const{Teleport:D,h:P,toRef:V,computed:U,defineComponent:q}=await t("vue"),K=q({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup:t=>({showTeleport:u(V(t,"show")),mergedTo:U(()=>{const{to:e}=t;return null!=e?e:"body"})}),render(){return this.showTeleport?this.disabled?w("lazy-teleport",this.$slots):P(D,{disabled:this.disabled,to:this.mergedTo},w("lazy-teleport",this.$slots)):null}}),_={top:"bottom",bottom:"top",left:"right",right:"left"},G={start:"end",center:"center",end:"start"},J={top:"height",bottom:"height",left:"width",right:"width"},Q={"bottom-start":"top left",bottom:"top center","bottom-end":"top right","top-start":"bottom left",top:"bottom center","top-end":"bottom right","right-start":"top left",right:"center left","right-end":"bottom left","left-start":"top right",left:"center right","left-end":"bottom right"},Z={"bottom-start":"bottom left",bottom:"bottom center","bottom-end":"bottom right","top-start":"top left",top:"top center","top-end":"top right","right-start":"top right",right:"center right","right-end":"bottom right","left-start":"top left",left:"center left","left-end":"bottom left"},tt={"bottom-start":"right","bottom-end":"left","top-start":"right","top-end":"left","right-start":"bottom","right-end":"top","left-start":"bottom","left-end":"top"},et={top:!0,bottom:!1,left:!0,right:!1},nt={top:"end",bottom:"start",left:"end",right:"start"};const{h:ot,defineComponent:rt,inject:lt,nextTick:it,watch:st,toRef:at,ref:ut,onMounted:dt,onBeforeUnmount:ft,withDirectives:ct}=await t("vue"),ht=j([j(".v-binder-follower-container",{position:"absolute",left:"0",right:"0",top:"0",height:"0",pointerEvents:"none",zIndex:"auto"}),j(".v-binder-follower-content",{position:"absolute",zIndex:"auto"},[j("> *",{pointerEvents:"all"})])]),pt=rt({name:"Follower",inheritAttrs:!1,props:{show:Boolean,enabled:{type:Boolean,default:void 0},placement:{type:String,default:"bottom"},syncTrigger:{type:Array,default:["resize","scroll"]},to:[String,Object],flip:{type:Boolean,default:!0},internalShift:Boolean,x:Number,y:Number,width:String,minWidth:String,containerClass:String,teleportDisabled:Boolean,zindexable:{type:Boolean,default:!0},zIndex:Number,overlap:Boolean},setup(t){const e=lt("VBinder"),n=d(()=>void 0!==t.enabled?t.enabled:t.show),o=ut(null),r=ut(null),l=()=>{const{syncTrigger:n}=t;n.includes("scroll")&&e.addScrollListener(u),n.includes("resize")&&e.addResizeListener(u)},i=()=>{e.removeScrollListener(u),e.removeResizeListener(u)};dt(()=>{n.value&&(u(),l())});const s=a();ht.mount({id:"vueuc/binder",head:!0,anchorMetaName:X,ssr:s}),ft(()=>{i()}),f(()=>{n.value&&u()});const u=()=>{if(!n.value)return;const l=o.value;if(null===l)return;const i=e.targetRef,{x:s,y:a,overlap:u}=t,d=void 0!==s&&void 0!==a?function(t,e){const n=S();return{top:e,left:t,height:0,width:0,right:n.width-t,bottom:n.height-e}}(s,a):$(i);l.style.setProperty("--v-target-width",`${Math.round(d.width)}px`),l.style.setProperty("--v-target-height",`${Math.round(d.height)}px`);const{width:f,minWidth:c,placement:h,internalShift:p,flip:m}=t;l.setAttribute("v-placement",h),u?l.setAttribute("v-overlap",""):l.removeAttribute("v-overlap");const{style:v}=l;v.width="target"===f?`${d.width}px`:void 0!==f?f:"",v.minWidth="target"===c?`${d.width}px`:void 0!==c?c:"";const g=$(l),b=$(r.value),{left:w,top:y,placement:x}=function(t,e,n,o,r,l){if(!r||l)return{placement:t,top:0,left:0};const[i,s]=t.split("-");let a=null!=s?s:"center",u={top:0,left:0};const d=(t,r,l)=>{let i=0,s=0;const a=n[t]-e[r]-e[t];return a>0&&o&&(l?s=et[r]?a:-a:i=et[r]?a:-a),{left:i,top:s}},f="left"===i||"right"===i;if("center"!==a){const o=tt[t],r=_[o],l=J[o];if(n[l]>e[l]){if(e[o]+e[l]<n[l]){const t=(n[l]-e[l])/2;e[o]<t||e[r]<t?e[o]<e[r]?(a=G[s],u=d(l,r,f)):u=d(l,o,f):a="center"}}else n[l]<e[l]&&e[r]<0&&e[o]>e[r]&&(a=G[s])}else{const t="bottom"===i||"top"===i?"left":"top",o=_[t],r=J[t],l=(n[r]-e[r])/2;(e[t]<l||e[o]<l)&&(e[t]>e[o]?(a=nt[t],u=d(r,t,f)):(a=nt[o],u=d(r,o,f)))}let c=i;return e[i]<n[J[i]]&&e[i]<e[_[i]]&&(c=_[i]),{placement:"center"!==a?`${c}-${a}`:c,left:u.left,top:u.top}}(h,d,g,p,m,u),R=function(t,e){return e?Z[t]:Q[t]}(x,u),{left:T,top:M,transform:C}=function(t,e,n,o,r,l){if(l)switch(t){case"bottom-start":case"left-end":return{top:`${Math.round(n.top-e.top+n.height)}px`,left:`${Math.round(n.left-e.left)}px`,transform:"translateY(-100%)"};case"bottom-end":case"right-end":return{top:`${Math.round(n.top-e.top+n.height)}px`,left:`${Math.round(n.left-e.left+n.width)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top-start":case"left-start":return{top:`${Math.round(n.top-e.top)}px`,left:`${Math.round(n.left-e.left)}px`,transform:""};case"top-end":case"right-start":return{top:`${Math.round(n.top-e.top)}px`,left:`${Math.round(n.left-e.left+n.width)}px`,transform:"translateX(-100%)"};case"top":return{top:`${Math.round(n.top-e.top)}px`,left:`${Math.round(n.left-e.left+n.width/2)}px`,transform:"translateX(-50%)"};case"right":return{top:`${Math.round(n.top-e.top+n.height/2)}px`,left:`${Math.round(n.left-e.left+n.width)}px`,transform:"translateX(-100%) translateY(-50%)"};case"left":return{top:`${Math.round(n.top-e.top+n.height/2)}px`,left:`${Math.round(n.left-e.left)}px`,transform:"translateY(-50%)"};default:return{top:`${Math.round(n.top-e.top+n.height)}px`,left:`${Math.round(n.left-e.left+n.width/2)}px`,transform:"translateX(-50%) translateY(-100%)"}}switch(t){case"bottom-start":return{top:`${Math.round(n.top-e.top+n.height+o)}px`,left:`${Math.round(n.left-e.left+r)}px`,transform:""};case"bottom-end":return{top:`${Math.round(n.top-e.top+n.height+o)}px`,left:`${Math.round(n.left-e.left+n.width+r)}px`,transform:"translateX(-100%)"};case"top-start":return{top:`${Math.round(n.top-e.top+o)}px`,left:`${Math.round(n.left-e.left+r)}px`,transform:"translateY(-100%)"};case"top-end":return{top:`${Math.round(n.top-e.top+o)}px`,left:`${Math.round(n.left-e.left+n.width+r)}px`,transform:"translateX(-100%) translateY(-100%)"};case"right-start":return{top:`${Math.round(n.top-e.top+o)}px`,left:`${Math.round(n.left-e.left+n.width+r)}px`,transform:""};case"right-end":return{top:`${Math.round(n.top-e.top+n.height+o)}px`,left:`${Math.round(n.left-e.left+n.width+r)}px`,transform:"translateY(-100%)"};case"left-start":return{top:`${Math.round(n.top-e.top+o)}px`,left:`${Math.round(n.left-e.left+r)}px`,transform:"translateX(-100%)"};case"left-end":return{top:`${Math.round(n.top-e.top+n.height+o)}px`,left:`${Math.round(n.left-e.left+r)}px`,transform:"translateX(-100%) translateY(-100%)"};case"top":return{top:`${Math.round(n.top-e.top+o)}px`,left:`${Math.round(n.left-e.left+n.width/2+r)}px`,transform:"translateY(-100%) translateX(-50%)"};case"right":return{top:`${Math.round(n.top-e.top+n.height/2+o)}px`,left:`${Math.round(n.left-e.left+n.width+r)}px`,transform:"translateY(-50%)"};case"left":return{top:`${Math.round(n.top-e.top+n.height/2+o)}px`,left:`${Math.round(n.left-e.left+r)}px`,transform:"translateY(-50%) translateX(-100%)"};default:return{top:`${Math.round(n.top-e.top+n.height+o)}px`,left:`${Math.round(n.left-e.left+n.width/2+r)}px`,transform:"translateX(-50%)"}}}(x,b,d,y,w,u);l.setAttribute("v-placement",x),l.style.setProperty("--v-offset-left",`${Math.round(w)}px`),l.style.setProperty("--v-offset-top",`${Math.round(y)}px`),l.style.transform=`translateX(${T}) translateY(${M}) ${C}`,l.style.setProperty("--v-transform-origin",R),l.style.transformOrigin=R};st(n,t=>{t?(l(),h()):i()});const h=()=>{it().then(u).catch(t=>console.error(t))};["placement","x","y","internalShift","flip","width","overlap","minWidth"].forEach(e=>{st(at(t,e),u)}),["teleportDisabled"].forEach(e=>{st(at(t,e),h)}),st(at(t,"syncTrigger"),t=>{t.includes("resize")?e.addResizeListener(u):e.removeResizeListener(u),t.includes("scroll")?e.addScrollListener(u):e.removeScrollListener(u)});const p=c(),m=d(()=>{const{to:e}=t;if(void 0!==e)return e;p.value});return{VBinder:e,mergedEnabled:n,offsetContainerRef:r,followerRef:o,mergedTo:m,syncPosition:u}},render(){return ot(K,{show:this.show,to:this.mergedTo,disabled:this.teleportDisabled},{default:()=>{var t,e;const n=ot("div",{class:["v-binder-follower-container",this.containerClass],ref:"offsetContainerRef"},[ot("div",{class:"v-binder-follower-content",ref:"followerRef"},null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t))]);return this.zindexable?ct(n,[[h,{enabled:this.mergedEnabled,zIndex:this.zIndex}]]):n}})}});const mt=new class{constructor(){this.handleResize=this.handleResize.bind(this),this.observer=new("undefined"!=typeof window&&window.ResizeObserver||p)(this.handleResize),this.elHandlersMap=new Map}handleResize(t){for(const e of t){const t=this.elHandlersMap.get(e.target);void 0!==t&&t(e)}}registerHandler(t,e){this.elHandlersMap.set(t,e),this.observer.observe(t)}unregisterHandler(t){this.elHandlersMap.has(t)&&(this.elHandlersMap.delete(t),this.observer.unobserve(t))}},{defineComponent:vt,renderSlot:gt,getCurrentInstance:bt,onMounted:wt,onBeforeUnmount:yt}=await t("vue"),xt=vt({name:"ResizeObserver",props:{onResize:Function},setup(t){let e=!1;const n=bt().proxy;function o(e){const{onResize:n}=t;void 0!==n&&n(e)}wt(()=>{const t=n.$el;void 0!==t?t.nextElementSibling===t.nextSibling||3!==t.nodeType||""===t.nodeValue?null!==t.nextElementSibling&&(mt.registerHandler(t.nextElementSibling,o),e=!0):N("resize-observer","$el can not be observed (it may be a text node)."):N("resize-observer","$el does not exist.")}),yt(()=>{e&&mt.unregisterHandler(n.$el.nextElementSibling)})},render(){return gt(this.$slots,"default")}});let Rt,St;function $t(){return"undefined"==typeof document?1:(void 0===St&&(St="chrome"in window?window.devicePixelRatio:1),St)}const Tt="VVirtualListXScroll",{computed:Mt,provide:Ct,ref:zt}=await t("vue");const{defineComponent:It,inject:Et}=await t("vue"),Bt=It({name:"VirtualListRow",props:{index:{type:Number,required:!0},item:{type:Object,required:!0}},setup(){const{startIndexRef:t,endIndexRef:e,columnsRef:n,getLeft:o,renderColRef:r,renderItemWithColsRef:l}=Et(Tt);return{startIndex:t,endIndex:e,columns:n,renderCol:r,renderItemWithCols:l,getLeft:o}},render(){const{startIndex:t,endIndex:e,columns:n,renderCol:o,renderItemWithCols:r,getLeft:l,item:i}=this;if(null!=r)return r({itemIndex:this.index,startColIndex:t,endColIndex:e,allColumns:n,item:i,getLeft:l});if(null!=o){const r=[];for(let s=t;s<=e;++s){const t=n[s];r.push(o({column:t,left:l(s),item:i}))}return r}return null}}),{mergeProps:Ft,computed:Wt,defineComponent:Lt,ref:At,onMounted:kt,h:Nt,onActivated:jt,onDeactivated:Xt,toRef:Yt}=await t("vue"),Ht=j(".v-vl",{maxHeight:"inherit",height:"100%",overflow:"auto",minWidth:"1px"},[j("&:not(.v-vl--show-scrollbar)",{scrollbarWidth:"none"},[j("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",{width:0,height:0,display:"none"})])]),Ot=Lt({name:"VirtualList",inheritAttrs:!1,props:{showScrollbar:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},renderCol:Function,renderItemWithCols:Function,items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},itemResizable:Boolean,itemsStyle:[String,Object],visibleItemsTag:{type:[String,Object],default:"div"},visibleItemsProps:Object,ignoreItemResize:Boolean,onScroll:Function,onWheel:Function,onResize:Function,defaultScrollKey:[Number,String],defaultScrollIndex:Number,keyField:{type:String,default:"key"},paddingTop:{type:[Number,String],default:0},paddingBottom:{type:[Number,String],default:0}},setup(t){const e=a();Ht.mount({id:"vueuc/virtual-list",head:!0,anchorMetaName:X,ssr:e}),kt(()=>{const{defaultScrollIndex:e,defaultScrollKey:n}=t;null!=e?x({index:e}):null!=n&&x({key:n})});let n=!1,i=!1;jt(()=>{n=!1,i?x({top:b.value,left:f.value}):i=!0}),Xt(()=>{n=!0,i||(i=!0)});const s=d(()=>{if(null==t.renderCol&&null==t.renderItemWithCols)return;if(0===t.columns.length)return;let e=0;return t.columns.forEach(t=>{e+=t.width}),e}),u=Wt(()=>{const e=new Map,{keyField:n}=t;return t.items.forEach((t,o)=>{e.set(t[n],o)}),e}),{scrollLeftRef:f,listWidthRef:c}=function({columnsRef:t,renderColRef:e,renderItemWithColsRef:n}){const o=zt(0),r=zt(0),l=Mt(()=>{const e=t.value;if(0===e.length)return null;const n=new H(e.length,0);return e.forEach((t,e)=>{n.add(e,t.width)}),n}),i=d(()=>{const t=l.value;return null!==t?Math.max(t.getBound(r.value)-1,0):0}),s=d(()=>{const e=l.value;return null!==e?Math.min(e.getBound(r.value+o.value)+1,t.value.length-1):0});return Ct(Tt,{startIndexRef:i,endIndexRef:s,columnsRef:t,renderColRef:e,renderItemWithColsRef:n,getLeft:t=>{const e=l.value;return null!==e?e.sum(t):0}}),{listWidthRef:o,scrollLeftRef:r}}({columnsRef:Yt(t,"columns"),renderColRef:Yt(t,"renderCol"),renderItemWithColsRef:Yt(t,"renderItemWithCols")}),h=At(null),p=At(void 0),m=new Map,v=Wt(()=>{const{items:e,itemSize:n,keyField:o}=t,r=new H(e.length,n);return e.forEach((t,e)=>{const n=t[o],l=m.get(n);void 0!==l&&r.add(e,l)}),r}),g=At(0),b=At(0),w=d(()=>Math.max(v.value.getBound(b.value-r(t.paddingTop))-1,0)),y=Wt(()=>{const{value:e}=p;if(void 0===e)return[];const{items:n,itemSize:o}=t,r=w.value,l=Math.min(r+Math.ceil(e/o+1),n.length-1),i=[];for(let t=r;t<=l;++t)i.push(n[t]);return i}),x=(t,e)=>{if("number"==typeof t)return void T(t,e,"auto");const{left:n,top:o,index:r,key:l,position:i,behavior:s,debounce:a=!0}=t;if(void 0!==n||void 0!==o)T(n,o,s);else if(void 0!==r)$(r,s,a);else if(void 0!==l){const t=u.value.get(l);void 0!==t&&$(t,s,a)}else"bottom"===i?T(0,Number.MAX_SAFE_INTEGER,s):"top"===i&&T(0,0,s)};let R,S=null;function $(e,n,o){const{value:l}=v,i=l.sum(e)+r(t.paddingTop);if(o){R=e,null!==S&&window.clearTimeout(S),S=window.setTimeout(()=>{R=void 0,S=null},16);const{scrollTop:t,offsetHeight:o}=h.value;if(i>t){const r=l.get(e);i+r<=t+o||h.value.scrollTo({left:0,top:i+r-o,behavior:n})}else h.value.scrollTo({left:0,top:i,behavior:n})}else h.value.scrollTo({left:0,top:i,behavior:n})}function T(t,e,n){h.value.scrollTo({left:t,top:e,behavior:n})}const M=!("undefined"!=typeof document&&(void 0===Rt&&(Rt="matchMedia"in window&&window.matchMedia("(pointer:coarse)").matches),Rt));let C=!1;function z(){const{value:t}=h;null!=t&&(b.value=t.scrollTop,f.value=t.scrollLeft)}function I(t){let e=t;for(;null!==e;){if("none"===e.style.display)return!0;e=e.parentElement}return!1}return{listHeight:p,listStyle:{overflow:"auto"},keyToIndex:u,itemsStyle:Wt(()=>{const{itemResizable:e}=t,n=l(v.value.sum());return g.value,[t.itemsStyle,{boxSizing:"content-box",width:l(s.value),height:e?"":n,minHeight:e?n:"",paddingTop:l(t.paddingTop),paddingBottom:l(t.paddingBottom)}]}),visibleItemsStyle:Wt(()=>(g.value,{transform:`translateY(${l(v.value.sum(w.value))})`})),viewportItems:y,listElRef:h,itemsElRef:At(null),scrollTo:x,handleListResize:function(e){if(n)return;if(I(e.target))return;if(null==t.renderCol&&null==t.renderItemWithCols){if(e.contentRect.height===p.value)return}else if(e.contentRect.height===p.value&&e.contentRect.width===c.value)return;p.value=e.contentRect.height,c.value=e.contentRect.width;const{onResize:o}=t;void 0!==o&&o(e)},handleListScroll:function(e){var n;null===(n=t.onScroll)||void 0===n||n.call(t,e),M&&C||z()},handleListWheel:function(e){var n;if(null===(n=t.onWheel)||void 0===n||n.call(t,e),M){const t=h.value;if(null!=t){if(0===e.deltaX){if(0===t.scrollTop&&e.deltaY<=0)return;if(t.scrollTop+t.offsetHeight>=t.scrollHeight&&e.deltaY>=0)return}e.preventDefault(),t.scrollTop+=e.deltaY/$t(),t.scrollLeft+=e.deltaX/$t(),z(),C=!0,o(()=>{C=!1})}}},handleItemResize:function(e,o){var r,l,i;if(n)return;if(t.ignoreItemResize)return;if(I(o.target))return;const{value:s}=v,a=u.value.get(e),d=s.get(a),f=null!==(i=null===(l=null===(r=o.borderBoxSize)||void 0===r?void 0:r[0])||void 0===l?void 0:l.blockSize)&&void 0!==i?i:o.contentRect.height;if(f===d)return;0===f-t.itemSize?m.delete(e):m.set(e,f-t.itemSize);const c=f-d;if(0===c)return;s.add(a,c);const p=h.value;if(null!=p){if(void 0===R){const t=s.sum(a);p.scrollTop>t&&p.scrollBy(0,c)}else if(a<R)p.scrollBy(0,c);else if(a===R){f+s.sum(a)>p.scrollTop+p.offsetHeight&&p.scrollBy(0,c)}z()}g.value++}}},render(){const{itemResizable:t,keyField:e,keyToIndex:n,visibleItemsTag:o}=this;return Nt(xt,{onResize:this.handleListResize},{default:()=>{var r,l;return Nt("div",Ft(this.$attrs,{class:["v-vl",this.showScrollbar&&"v-vl--show-scrollbar"],onScroll:this.handleListScroll,onWheel:this.handleListWheel,ref:"listElRef"}),[0!==this.items.length?Nt("div",{ref:"itemsElRef",class:"v-vl-items",style:this.itemsStyle},[Nt(o,Object.assign({class:"v-vl-visible-items",style:this.visibleItemsStyle},this.visibleItemsProps),{default:()=>{const{renderCol:o,renderItemWithCols:r}=this;return this.viewportItems.map(l=>{const i=l[e],s=n.get(i),a=null!=o?Nt(Bt,{index:s,item:l}):void 0,u=null!=r?Nt(Bt,{index:s,item:l}):void 0,d=this.$slots.default({item:l,renderedCols:a,renderedItemWithCols:u,index:s})[0];return t?Nt(xt,{key:i,onResize:t=>this.handleItemResize(i,t)},{default:()=>d}):(d.key=i,d)})}})]):null===(l=(r=this.$slots).empty)||void 0===l?void 0:l.call(r)])}})}}),{defineComponent:Dt,h:Pt,ref:Vt}=await t("vue"),Ut=j(".v-x-scroll",{overflow:"auto",scrollbarWidth:"none"},[j("&::-webkit-scrollbar",{width:0,height:0})]),qt=Dt({name:"XScroll",props:{disabled:Boolean,onScroll:Function},setup(){const t=Vt(null);const e=a();Ut.mount({id:"vueuc/x-scroll",head:!0,anchorMetaName:X,ssr:e});const n={scrollTo(...e){var n;null===(n=t.value)||void 0===n||n.scrollTo(...e)}};return Object.assign({selfRef:t,handleWheel:function(t){t.currentTarget.offsetWidth<t.currentTarget.scrollWidth&&0!==t.deltaY&&(t.currentTarget.scrollLeft+=t.deltaY+t.deltaX,t.preventDefault())}},n)},render(){return Pt("div",{ref:"selfRef",onScroll:this.onScroll,onWheel:this.disabled?void 0:this.handleWheel,class:"v-x-scroll"},this.$slots)}}),{defineComponent:Kt,renderSlot:_t,h:Gt,onMounted:Jt,ref:Qt,nextTick:Zt}=await t("vue"),te="v-hidden",ee=j("[v-hidden]",{display:"none!important"}),ne=Kt({name:"Overflow",props:{getCounter:Function,getTail:Function,updateCounter:Function,onUpdateCount:Function,onUpdateOverflow:Function},setup(t,{slots:e}){const n=Qt(null),o=Qt(null);function r(r){const{value:l}=n,{getCounter:i,getTail:s}=t;let a;if(a=void 0!==i?i():o.value,!l||!a)return;a.hasAttribute(te)&&a.removeAttribute(te);const{children:u}=l;if(r.showAllItemsBeforeCalculate)for(const t of u)t.hasAttribute(te)&&t.removeAttribute(te);const d=l.offsetWidth,f=[],c=e.tail?null==s?void 0:s():null;let h=c?c.offsetWidth:0,p=!1;const m=l.children.length-(e.tail?1:0);for(let e=0;e<m-1;++e){if(e<0)continue;const n=u[e];if(p){n.hasAttribute(te)||n.setAttribute(te,"");continue}n.hasAttribute(te)&&n.removeAttribute(te);const o=n.offsetWidth;if(h+=o,f[e]=o,h>d){const{updateCounter:n}=t;for(let o=e;o>=0;--o){const r=m-1-o;void 0!==n?n(r):a.textContent=`${r}`;const l=a.offsetWidth;if(h-=f[o],h+l<=d||0===o){p=!0,e=o-1,c&&(-1===e?(c.style.maxWidth=d-l+"px",c.style.boxSizing="border-box"):c.style.maxWidth="");const{onUpdateCount:n}=t;n&&n(r);break}}}}const{onUpdateOverflow:v}=t;p?void 0!==v&&v(!0):(void 0!==v&&v(!1),a.setAttribute(te,""))}const l=a();return ee.mount({id:"vueuc/overflow",head:!0,anchorMetaName:X,ssr:l}),Jt(()=>r({showAllItemsBeforeCalculate:!1})),{selfRef:n,counterRef:o,sync:r}},render(){const{$slots:t}=this;return Zt(()=>this.sync({showAllItemsBeforeCalculate:!1})),Gt("div",{class:"v-overflow",ref:"selfRef"},[_t(t,"default"),t.counter?t.counter():Gt("span",{style:{display:"inline-block"},ref:"counterRef"}),t.tail?t.tail():null])}});function oe(t){return t instanceof HTMLElement}function re(t){for(let e=0;e<t.childNodes.length;e++){const n=t.childNodes[e];if(oe(n)&&(ie(n)||re(n)))return!0}return!1}function le(t){for(let e=t.childNodes.length-1;e>=0;e--){const n=t.childNodes[e];if(oe(n)&&(ie(n)||le(n)))return!0}return!1}function ie(t){if(!function(t){if(t.tabIndex>0||0===t.tabIndex&&null!==t.getAttribute("tabIndex"))return!0;if(t.getAttribute("disabled"))return!1;switch(t.nodeName){case"A":return!!t.href&&"ignore"!==t.rel;case"INPUT":return"hidden"!==t.type&&"file"!==t.type;case"SELECT":case"TEXTAREA":return!0;default:return!1}}(t))return!1;try{t.focus({preventScroll:!0})}catch(e){}return document.activeElement===t}const{h:se,defineComponent:ae,ref:ue,Fragment:de,onMounted:fe,onBeforeUnmount:ce,watch:he}=await t("vue");let pe=[];const me=ae({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:[String,Function],finalFocusTo:[String,Function],returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(t){const o=i(),r=ue(null),l=ue(null);let a=!1,u=!1;const d="undefined"==typeof document?null:document.activeElement;function f(){return pe[pe.length-1]===o}function c(e){var n;"Escape"===e.code&&f()&&(null===(n=t.onEsc)||void 0===n||n.call(t,e))}function h(t){if(!u&&f()){const e=p();if(null===e)return;if(e.contains(s(t)))return;v("first")}}function p(){const t=r.value;if(null===t)return null;let e=t;for(;!(e=e.nextSibling,null===e||e instanceof Element&&"DIV"===e.tagName););return e}function m(){var e;if(t.disabled)return;if(document.removeEventListener("focus",h,!0),pe=pe.filter(t=>t!==o),f())return;const{finalFocusTo:n}=t;void 0!==n?null===(e=O(n))||void 0===e||e.focus({preventScroll:!0}):t.returnFocusOnDeactivated&&d instanceof HTMLElement&&(u=!0,d.focus({preventScroll:!0}),u=!1)}function v(e){if(f()&&t.active){const t=r.value,n=l.value;if(null!==t&&null!==n){const o=p();if(null==o||o===n)return u=!0,t.focus({preventScroll:!0}),void(u=!1);u=!0;const r="first"===e?re(o):le(o);u=!1,r||(u=!0,t.focus({preventScroll:!0}),u=!1)}}}return fe(()=>{he(()=>t.active,r=>{r?(!function(){var e;if(t.disabled)return;if(pe.push(o),t.autoFocus){const{initialFocusTo:n}=t;void 0===n?v("first"):null===(e=O(n))||void 0===e||e.focus({preventScroll:!0})}a=!0,document.addEventListener("focus",h,!0)}(),n("keydown",document,c)):(e("keydown",document,c),a&&m())},{immediate:!0})}),ce(()=>{e("keydown",document,c),a&&m()}),{focusableStartRef:r,focusableEndRef:l,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:function(t){if(u)return;const e=p();null!==e&&(null!==t.relatedTarget&&e.contains(t.relatedTarget)?v("last"):v("first"))},handleEndFocus:function(t){u||(null!==t.relatedTarget&&t.relatedTarget===r.value?v("last"):v("first"))}}},render(){const{default:t}=this.$slots;if(void 0===t)return null;if(this.disabled)return t();const{active:e,focusableStyle:n}=this;return se(de,null,[se("div",{"aria-hidden":"true",tabindex:e?"0":"-1",ref:"focusableStartRef",style:n,onFocus:this.handleStartFocus}),t(),se("div",{"aria-hidden":"true",style:n,ref:"focusableEndRef",tabindex:e?"0":"-1",onFocus:this.handleEndFocus})])}});export{F as B,me as F,K as L,xt as V,Ot as a,pt as b,k as c,ne as d,qt as e,mt as r};
