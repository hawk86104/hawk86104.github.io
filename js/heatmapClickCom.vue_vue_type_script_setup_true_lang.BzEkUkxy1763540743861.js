import{u as t}from"./index.Crdf3MNx1763540743861.js";import{h as e}from"./heatmap.js-fix.CoSu5NRz1763540743861.js";import{d as a,a8 as n,a6 as s,H as o,o as i,a9 as r,u as l}from"./@vue.Co_gxueH1763540743861.js";import{y as u,q as p,ae as d,k as c}from"./three.rXKzP9fQ1763540743861.js";const m=["object"],v=a({__name:"heatmapClickCom",props:{show2dCanvas:{type:Boolean,default:!0},radius:{default:20}},async setup(a){let v,h;const y=a,{nodes:g}=([v,h]=n(()=>t("https://opensource.cdn.icegl.cn/model/heatmap/test.glb")),v=await v,h(),v);g.mesh_0.position.set(-5088.96,-3.08,39374.7),g.mesh_0.scale.setScalar(.01);let x=null,f=null,b=null;f=new u((b=document.createElement("heatmap-canvas"),b.style.position="absolute",b.style.top="40px",b.style.left="0",document.body.appendChild(b),x=e.create({container:b,width:256,height:256,blur:"0.8",radius:y.radius}),x._renderer.canvas.style.border="1px solid #5384ff",x._renderer.canvas.onclick=function(t){x.addData({x:t.layerX,y:t.layerY,value:1,radius:y.radius}),x.setDataMax(1),f&&(f.needsUpdate=!0)},x)._renderer.canvas);const _=new p({vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\tvUv = uv;\n\t}\n\t",fragmentShader:"\n\tuniform sampler2D heightMap;\n\tuniform float uOpacity;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_FragColor = vec4(texture2D(heightMap, vUv.xy).rgb, uOpacity);\n\t}\n\t",uniforms:{uOpacity:{value:1},heightMap:{type:"t",value:f}},depthWrite:!0,depthTest:!0,transparent:!0,side:d});g.mesh_0.material=_;return(t=>{t.computeBoundingBox();const{max:e,min:a}=t.boundingBox;t.deleteAttribute("uv");const n=e.x-a.x,s=e.z-a.z,o=[];for(let r=0;r<t.attributes.position.count;r++)o.push((t.attributes.position.getX(r)-a.x)/n),o.push((t.attributes.position.getZ(r)-a.z)/s);const i=new Float32Array(o);t.setAttribute("uv",new c(i,2))})(g.mesh_0.geometry),s(()=>{b.style.display=""+(y.show2dCanvas?"block":"none")}),(t,e)=>(i(),o("primitive",{object:r(l(g).mesh_0)},null,8,m))}});export{v as _};
