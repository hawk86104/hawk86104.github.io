import{ar as Q,as as F,at as D,au as U,av as z,aw as I,ax as O,a1 as M,o as y,c as V,L as A,ay as Z,az as ee,aA as te,l as E,aB as $,aC as G,a4 as L,aD as T,aE as k,aF as ae,aG as oe,ak as J,x as N,a9 as Y,a6 as q,aH as re,aI as j,a2 as ne,aq as se,r as ie,a as w,E as B,aa as le,ab as ue,G as ce,ah as me,ai as pe,Y as f,aJ as de,ag as fe,_ as ve}from"./vendor.KwxG0fE31716451028207.js";/* empty css                                                                                 */import{l as ge}from"./bubbleLoading.XZVSVYV91716451028207.js";import{m as xe}from"./BufferGeometryUtils.YkayGn8D1716451028207.js";import{O as he,l as _e}from"./util.BuHM_k0q1716451028207.js";import{R as we,E as Pe}from"./EffectComposer.5-JSrvqn1716451028207.js";import{U as ye}from"./UnrealBloomPass.QVFMJGPd1716451028207.js";import"./Pass.IF3sfO8d1716451028207.js";var Me="varying vec2 vUv;\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  vUv = uv;\n}",be="uniform sampler2D uTextureA;\nuniform sampler2D uTextureB;\nprecision mediump float; \nuniform float uTime;\nuniform float uScroll;\nvarying vec2 vUv;\n\nmat3 rotationMatrix3(vec3 axis, float angle) {\n  axis = normalize(axis);\n  float s = sin(angle);\n  float c = cos(angle);\n  float oc = 1. - c;\n\n  return mat3(oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s,\n              oc * axis.z * axis.x + axis.y * s,\n              oc * axis.x * axis.y + axis.z * s, oc * axis.y * axis.y + c,\n              oc * axis.y * axis.z - axis.x * s,\n              oc * axis.z * axis.x - axis.y * s,\n              oc * axis.y * axis.z + axis.x * s, oc * axis.z * axis.z + c);\n}\n\nvoid main() {\n  vec3 textureA = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureA, vUv).xyz;\n  \n\n  vec3 textureB = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\n                  texture2D(uTextureB, vUv).xyz;\n  \n\n  float t = uScroll;\n  vec3 pos = mix(textureA, textureB, t);\n\n  gl_FragColor = vec4(pos, 1.);\n}";const C=o=>{let t=o.attributes.position.count,r=Math.ceil(Math.sqrt(t)),a=Math.ceil(t/r),s=new Float32Array(r*a*4);function c(e){let m=Math.floor(e.length/3);for(let i=m-1;i>0;i--){const l=Math.floor(Math.random()*(i+1));for(let u=0;u<3;u++){let v=e[i*3+u];e[i*3+u]=e[l*3+u],e[l*3+u]=v}}return e}c(o.attributes.position.array);for(let e=0;e<t;e++){const p=o.attributes.position.array[e*3+0],m=o.attributes.position.array[e*3+1],i=o.attributes.position.array[e*3+2],l=0;s[e*4+0]=p,s[e*4+1]=m,s[e*4+2]=i,s[e*4+3]=l}let n=new Q(s,r,a,F,D);return n.needsUpdate=!0,n},Se=()=>new O({uniforms:{uTextureA:{value:null},uTextureB:{value:null},uTime:{value:0},uScroll:{value:0}},vertexShader:Me,fragmentShader:be}),Te=()=>{const o=Se(),t=new U;return t.setAttribute("position",new z(new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]),3)),t.setAttribute("uv",new z(new Float32Array([0,1,1,1,1,0,0,1,1,0,0,0]),2)),new I(t,o)};var Be="uniform sampler2D\n    uPositions; \nuniform float uSize;\nuniform float uPixelRatio;\nvarying vec3 vPos;\nvarying vec2 vUv;\nvoid main() {\n  vec3 pos = texture2D(uPositions, position.xy).xyz;\n\n  float customSize = uSize;\n\n  vec4 modelPosition = modelMatrix * vec4(pos, 1.0);\n  vec4 viewPosition = viewMatrix * modelPosition;\n  vec4 projectionPosition = projectionMatrix * viewPosition;\n\n  gl_Position = projectionPosition;\n  gl_PointSize = customSize * uPixelRatio;\n  gl_PointSize *= (1.0 / -viewPosition.z);\n\n  vPos = pos;\n}",Ce="precision mediump float;\nvarying vec3 vPos;\nuniform vec3 uColor; \nvoid main() {\n\n  float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n  float strength = 0.05 / distanceToCenter - 0.1;\n\n  \n\n  gl_FragColor = vec4(uColor, strength * length(vPos));\n}";const ze=["object"],Ae=M({__name:"particalMesh",props:{progress:{default:0},width:{default:256},height:{default:256}},setup(o,{expose:t}){const r=o,a=()=>new O({uniforms:{uPositions:{value:null},uSize:{value:12},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uColor:{value:new ee("#ffaa00")}},vertexShader:Be,fragmentShader:Ce,transparent:!0,depthWrite:!1,blending:te});let c=((n,e)=>{const p=n*e;let m=new Float32Array(p*3);for(let l=0;l<p;l++){let u=l*3;m[u+0]=l%n/n,m[u+1]=l/n/e}const i=new U;return i.setAttribute("position",new z(m,3)),new Z(i,a())})(r.width,r.height);return t({particles:c}),(n,e)=>(y(),V("primitive",{object:A(c)},null,8,ze))}}),Fe="./plugins/medical/model/brainparts.OBJ",Le=M({__name:"particalFBO",props:{progress:{default:0},width:{default:256},height:{default:256},color:{default:"#ffaa00"}},async setup(o){let t,r;const a=o,s=E(),c=new $(a.width,a.height,{minFilter:G,magFilter:G,generateMipmaps:!1,colorSpace:L,depthBuffer:!1,stencilBuffer:!1,format:F,type:D}),n=h=>{const S=[];return h.traverse(_=>{_ instanceof I&&(_.geometry.deleteAttribute("uv"),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("tangent"),S.push(_.geometry))}),xe(S)},e=new he,p=([t,r]=T(()=>_e(Fe,e)),t=await t,r(),t),m=n(p);m.scale(.01,.01,.01);const i=C(m),l=([t,r]=T(()=>k("https://opensource-1314935952.cos.ap-nanjing.myqcloud.com/model/eCommerce/guanYu.glb",{draco:!0,decoderPath:"./draco/"})),t=await t,r(),t).scene,u=n(l.children[0]);u.rotateX(Math.PI/2),u.translate(0,-.9,0);const v=C(u),P=([t,r]=T(()=>k("./plugins/industry4/model/modelDraco.glb",{draco:!0,decoderPath:"./draco/"})),t=await t,r(),t).scene,g=n(P.children[0]);g.rotateX(-Math.PI/2),g.rotateY(Math.PI/3),g.translate(0,0,0);const b=C(g),d=Te(),R=new ae,H=new oe(-1,1,1,-1,1/Math.pow(2,53),1);R.add(d);const{onBeforeLoop:X}=Y(),{camera:K,renderer:x}=J();return X(({elapsed:h})=>{x.value&&K.value&&s.value&&(x.value.setRenderTarget(c),x.value.clear(),x.value.render(R,H),x.value.setRenderTarget(null),a.progress<1/2?(d.material.uniforms.uTextureA.value=v,d.material.uniforms.uTextureB.value=i,d.material.uniforms.uScroll.value=a.progress*2):(d.material.uniforms.uTextureA.value=i,d.material.uniforms.uTextureB.value=b,d.material.uniforms.uScroll.value=(a.progress-1/2)*2),d.material.uniforms.uTime.value=h,s.value.particles.material.uniforms.uPositions.value=c.texture,s.value.particles.material.uniforms.uColor.value.setStyle(a.color))}),(h,S)=>(y(),N(Ae,{ref_key:"pMesh",ref:s,progress:h.progress},null,8,["progress"]))}}),Re=M({__name:"particalPass",props:{use:{type:Boolean,default:!0}},setup(o){const t=o,{camera:r,renderer:a,scene:s,sizes:c}=J(),n={threshold:0,strength:.472,radius:1.61};let e=null;const p=(i,l,u,v,P)=>{const g=new we(i,l),b=new ye(new re(v,P),n.strength,n.radius,n.threshold),d=new $(v,P,{generateMipmaps:!1,minFilter:j,magFilter:j,format:F,colorSpace:L,samples:0});e=new Pe(u,d),e.addPass(g),e.addPass(b)};q(()=>{c.width.value&&p(s.value,r.value,a.value,c.width.value,c.height.value)});const{onLoop:m}=Y();return m(()=>{t.use?e&&e.render():a.value&&r.value&&a.value.render(s.value,r.value)}),(i,l)=>null}}),W=o=>(me("data-v-94cc0516"),o=o(),pe(),o),Ge=W(()=>f("TresPerspectiveCamera",{position:[0,0,-4],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),ke=W(()=>f("main",null,[f("section",null,[f("h1",null,"关羽 - GuanYu")]),f("section",null,[f("h1",{style:{"margin-left":"-11em","margin-bottom":"-10em"}},"大脑 - Brain")]),f("section",null,[f("h1",{style:{"margin-left":"11em","margin-bottom":"-10em"}},"设备 - Device")])],-1)),je=M({__name:"scrollPartical",setup(o){const t=E(0);q(()=>{console.log("jaime ~ progress:",t.value)});const r={clearColor:"#000",outputColorSpace:L,windowSize:!0,disableRender:!0,powerPreference:"high-performance",antialias:!1,alpha:!1,useLegacyLights:!1,physicallyCorrectLights:!0},a=ne({pass:!0,color:"#ffaa00"}),s=new se({title:"参数",expanded:!0});return s.addBinding(a,"pass",{label:"后处理"}),s.addBinding(a,"color",{label:"颜色"}),(c,n)=>{const e=ie("TresCanvas");return y(),V(ce,null,[w(A(ge),{styleNum:4}),w(e,le(ue(r)),{default:B(()=>[Ge,w(Re,{use:a.pass},null,8,["use"]),w(A(de),{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=p=>t.value=p),distance:10,"smooth-scroll":.1,"html-scroll":""},{default:B(()=>[(y(),N(fe,null,{default:B(()=>[w(Le,{progress:t.value,color:a.color},null,8,["progress","color"])]),_:1}))]),_:1},8,["modelValue"])]),_:1},16),ke],64)}}}),Ne=ve(je,[["__scopeId","data-v-94cc0516"]]);export{Ne as default};
